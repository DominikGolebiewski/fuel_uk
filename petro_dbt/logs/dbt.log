[0m21:00:20.944754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8eaa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8fd2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e92fb1a0>]}


============================== 21:00:20.951955 | f918d5aa-2af2-4fe0-b7ab-caae99178f6b ==============================
[0m21:00:20.951955 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:00:20.952631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:21.098081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f918d5aa-2af2-4fe0-b7ab-caae99178f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8d13a70>]}
[0m21:00:21.111536 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dtlheftm'
[0m21:00:21.112018 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:00:21.155754 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:00:21.156396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:00:21.166432 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:00:21.170132 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:00:21.402208 [info ] [MainThread]: Installed from version 1.2.0
[0m21:00:21.402744 [info ] [MainThread]: Up to date!
[0m21:00:21.403302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f918d5aa-2af2-4fe0-b7ab-caae99178f6b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8c343b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8bef410>]}
[0m21:00:21.404681 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50804603, "process_user_time": 1.591879, "process_kernel_time": 0.124616, "process_mem_max_rss": "93076", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m21:00:21.405295 [debug] [MainThread]: Command `dbt deps` succeeded at 21:00:21.405188 after 0.51 seconds
[0m21:00:21.405748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8eaa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e992caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ea0491f0>]}
[0m21:00:21.406251 [debug] [MainThread]: Flushing usage events
[0m21:00:23.183919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc1a81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dd3d3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc392000>]}


============================== 21:00:23.186764 | 00c5cfc1-e684-49c0-906a-b29bb090025b ==============================
[0m21:00:23.186764 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:00:23.187445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:00:23.415213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc0e4e90>]}
[0m21:00:23.474418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dda0f440>]}
[0m21:00:23.475204 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:00:23.490414 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:00:23.491149 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:00:23.491712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d57772c0>]}
[0m21:00:24.708884 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:00:24.709588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d5469220>]}
[0m21:00:24.900557 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:00:24.906640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d5220ef0>]}
[0m21:00:25.063637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d543c380>]}
[0m21:00:25.064219 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:00:25.064727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d52214f0>]}
[0m21:00:25.066451 [info ] [MainThread]: 
[0m21:00:25.067153 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:00:25.071859 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:00:25.106617 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:00:25.107072 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:00:25.107491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:25.533862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.535472 [debug] [ThreadPool]: On list_petro: Close
[0m21:00:25.537697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:00:25.538306 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:00:25.545170 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.545622 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:00:25.546028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:25.551669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.553004 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.553420 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:00:25.554355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.554771 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.555167 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:00:25.555787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.556728 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:00:25.557140 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:00:25.557531 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:00:25.558081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.558543 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:00:25.560517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:00:25.565802 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:00:25.566260 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:00:25.566658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:25.571509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.571938 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:00:25.572351 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:00:25.591753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:00:25.596342 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:00:25.597519 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:00:25.597944 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:00:25.601025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d53af7a0>]}
[0m21:00:25.601552 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:25.601958 [debug] [MainThread]: On master: BEGIN
[0m21:00:25.602392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:25.607369 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:25.607801 [debug] [MainThread]: On master: COMMIT
[0m21:00:25.608202 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:25.608598 [debug] [MainThread]: On master: COMMIT
[0m21:00:25.609227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:25.609645 [debug] [MainThread]: On master: Close
[0m21:00:25.611134 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:00:25.611651 [info ] [MainThread]: 
[0m21:00:25.629868 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:00:25.630538 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:00:25.631196 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:00:25.631652 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:00:25.657029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:00:25.657774 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:00:25.691987 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:00:25.692737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:00:37.006438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.006974 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:00:37.007589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.008051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.008503 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:00:37.009185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.011890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.012361 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:00:37.013045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.033594 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:00:37.034080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.034556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:00:37.035771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.040484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:00:37.040979 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:00:37.042078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.044400 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:00:37.069529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dcc73530>]}
[0m21:00:37.070303 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.44s]
[0m21:00:37.071194 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:00:37.072178 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:00:37.072782 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:00:37.073387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:00:37.073844 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:00:37.078684 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:00:37.079322 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:00:37.112254 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.112768 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240621210037106502"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:00:37.113242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:37.127681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.134525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.134996 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:00:37.135576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.136030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.136477 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240621210037106502'
      
      
      order by ordinal_position

  
[0m21:00:37.162344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.167218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.167710 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:00:37.181680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.190310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.190798 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:00:37.199027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.216831 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:00:37.217530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.218011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240621210037106502"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240621210037106502"
    )
  
[0m21:00:37.228272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.230000 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:00:37.230512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:00:37.230950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:00:37.239013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:00:37.239881 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:00:37.337164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c5cfc1-e684-49c0-906a-b29bb090025b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a9155d60>]}
[0m21:00:37.337921 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m21:00:37.338838 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:00:37.340252 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:37.340736 [debug] [MainThread]: On master: BEGIN
[0m21:00:37.341178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:37.346468 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:37.346950 [debug] [MainThread]: On master: COMMIT
[0m21:00:37.347400 [debug] [MainThread]: Using duckdb connection "master"
[0m21:00:37.347832 [debug] [MainThread]: On master: COMMIT
[0m21:00:37.348517 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:00:37.348985 [debug] [MainThread]: On master: Close
[0m21:00:37.350436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:37.350885 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:00:37.351305 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:00:37.351781 [info ] [MainThread]: 
[0m21:00:37.352310 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.28 seconds (12.28s).
[0m21:00:37.353306 [debug] [MainThread]: Command end result
[0m21:00:37.380681 [info ] [MainThread]: 
[0m21:00:37.381296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:37.381810 [info ] [MainThread]: 
[0m21:00:37.382373 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:00:37.383343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.24889, "process_user_time": 4.636834, "process_kernel_time": 0.333185, "process_mem_max_rss": "267884", "process_in_blocks": "1184", "process_out_blocks": "106080"}
[0m21:00:37.383989 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:37.383881 after 14.25 seconds
[0m21:00:37.384482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dc8a5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70dffbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a92ff530>]}
[0m21:00:37.384977 [debug] [MainThread]: Flushing usage events
[0m21:03:40.897075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6c7e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6de24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d90d1970>]}


============================== 21:03:41.039058 | 4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5 ==============================
[0m21:03:41.039058 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:41.039749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:41.183577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d72db620>]}
[0m21:03:41.204192 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jpugovjm'
[0m21:03:41.204674 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:03:41.292975 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:03:41.293739 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:03:41.343759 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:03:41.347649 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:03:41.419490 [info ] [MainThread]: Installed from version 1.2.0
[0m21:03:41.420074 [info ] [MainThread]: Up to date!
[0m21:03:41.420722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ee9d8e9-8ad0-4fa2-8c2f-ebde5674a0c5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d69d8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d7c9d160>]}
[0m21:03:41.422186 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5743885, "process_user_time": 1.673774, "process_kernel_time": 0.107344, "process_mem_max_rss": "93412", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m21:03:41.422796 [debug] [MainThread]: Command `dbt deps` succeeded at 21:03:41.422691 after 0.58 seconds
[0m21:03:41.423247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d70a1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d72db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04d6cc6030>]}
[0m21:03:41.423685 [debug] [MainThread]: Flushing usage events
[0m21:03:48.252082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d4d39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83380>]}


============================== 21:03:48.254974 | 1aec2a5c-ad67-4921-bdce-de02a192cc9c ==============================
[0m21:03:48.254974 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:48.255634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:03:48.493316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca128a0>]}
[0m21:03:48.556995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d40c2c0>]}
[0m21:03:48.557920 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:03:48.573248 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:03:48.672329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:48.672812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:48.678739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:03:48.708459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97cab5490>]}
[0m21:03:48.811461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb975664b60>]}
[0m21:03:48.812056 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:03:48.812606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb975894890>]}
[0m21:03:48.814353 [info ] [MainThread]: 
[0m21:03:48.815109 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:48.819888 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:03:48.858279 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:03:48.858777 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:03:48.859191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:49.407276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m21:03:49.408875 [debug] [ThreadPool]: On list_petro: Close
[0m21:03:49.411079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:03:49.411674 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:03:49.418628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.419080 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:03:49.419505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:49.425044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.426498 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.426921 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:03:49.427589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.428007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.428404 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:03:49.428984 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.429945 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:49.430358 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:49.430757 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:49.431403 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.431838 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:03:49.434039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:03:49.439375 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:49.439801 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:03:49.440190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:49.445060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.445520 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:49.445932 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:03:49.465484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:49.471882 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:03:49.473069 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:03:49.473539 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:03:49.477087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97e09d010>]}
[0m21:03:49.477646 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:49.478046 [debug] [MainThread]: On master: BEGIN
[0m21:03:49.478427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:49.483864 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:49.484302 [debug] [MainThread]: On master: COMMIT
[0m21:03:49.484700 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:49.485084 [debug] [MainThread]: On master: COMMIT
[0m21:03:49.485743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:49.486160 [debug] [MainThread]: On master: Close
[0m21:03:49.487675 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:03:49.488187 [info ] [MainThread]: 
[0m21:03:49.497351 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:03:49.497998 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:03:49.498743 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:03:49.499201 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:03:49.525169 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:03:49.525842 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:03:49.560427 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:03:49.561093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:03:57.942719 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.943251 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:03:57.944049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.944517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.944968 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:03:57.945850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.948538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.949008 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:03:57.949746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.970495 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:57.970989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.971442 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:57.972624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.977398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:57.977898 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:03:57.979033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:57.981351 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:03:58.006795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97d7872c0>]}
[0m21:03:58.007594 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.51s]
[0m21:03:58.008394 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:03:58.009419 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:03:58.009992 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:03:58.010603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:03:58.011066 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:03:58.027087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:03:58.027753 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:03:58.061144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.061699 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240621210358055298"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:03:58.062193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:58.076717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.083942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.084424 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:03:58.085036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.085526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.085980 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240621210358055298'
      
      
      order by ordinal_position

  
[0m21:03:58.112161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.117199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.117746 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:03:58.126067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.134711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.135209 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:03:58.144268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.162221 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:03:58.162913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.163430 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240621210358055298"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240621210358055298"
    )
  
[0m21:03:58.173120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.174931 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:58.175394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:58.175843 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:58.184638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:58.185578 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:03:58.289503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aec2a5c-ad67-4921-bdce-de02a192cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94918ae70>]}
[0m21:03:58.290341 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m21:03:58.291215 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:03:58.292567 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.293054 [debug] [MainThread]: On master: BEGIN
[0m21:03:58.293538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:58.298790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:58.299279 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.299731 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:58.300169 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.300734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:58.301201 [debug] [MainThread]: On master: Close
[0m21:03:58.302630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:58.303083 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:03:58.303503 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:03:58.303976 [info ] [MainThread]: 
[0m21:03:58.304538 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m21:03:58.305627 [debug] [MainThread]: Command end result
[0m21:03:58.333134 [info ] [MainThread]: 
[0m21:03:58.333820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:58.334371 [info ] [MainThread]: 
[0m21:03:58.334934 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:03:58.335956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.135513, "process_user_time": 3.377523, "process_kernel_time": 0.335753, "process_mem_max_rss": "280980", "process_in_blocks": "1200", "process_out_blocks": "105520"}
[0m21:03:58.336600 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:58.336490 after 10.14 seconds
[0m21:03:58.337097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97cef2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ca83320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94a31fc80>]}
[0m21:03:58.337616 [debug] [MainThread]: Flushing usage events
[0m21:04:00.088300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cce1b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd4584d0>]}


============================== 21:04:00.091191 | 6d0ff847-f120-4914-a5f6-f2722a0cfeb4 ==============================
[0m21:04:00.091191 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:04:00.091844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:00.237635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d0ff847-f120-4914-a5f6-f2722a0cfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd5f0da0>]}
[0m21:04:00.254043 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21470842, "process_user_time": 1.465699, "process_kernel_time": 0.091855, "process_mem_max_rss": "92004", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:04:00.254629 [debug] [MainThread]: Command `dbt clean` succeeded at 21:04:00.254526 after 0.22 seconds
[0m21:04:00.255073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd2f78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd45b500>]}
[0m21:04:00.255512 [debug] [MainThread]: Flushing usage events
[0m15:09:37.490422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104326750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037ff170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046130b0>]}


============================== 15:09:37.493033 | fed66eda-7429-4c22-9306-2773c8f8ba2e ==============================
[0m15:09:37.493033 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:09:37.493378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:37.701277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed66eda-7429-4c22-9306-2773c8f8ba2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d39e0>]}
[0m15:09:37.732645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed66eda-7429-4c22-9306-2773c8f8ba2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410b710>]}
[0m15:09:37.733444 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:09:37.744055 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils
[0m15:09:37.745972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29012808, "process_user_time": 0.71857, "process_kernel_time": 0.133344, "process_mem_max_rss": "107872256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:37.746444 [debug] [MainThread]: Command `dbt run` failed at 15:09:37.746379 after 0.29 seconds
[0m15:09:37.746752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041faba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104799580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104798b00>]}
[0m15:09:37.746985 [debug] [MainThread]: Flushing usage events
[0m15:11:48.316480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106682660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e14560>]}


============================== 15:11:48.319149 | 77f6d568-f934-4241-9a39-46acf7cc7213 ==============================
[0m15:11:48.319149 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:11:48.319485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:11:48.526884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77f6d568-f934-4241-9a39-46acf7cc7213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052410d0>]}
[0m15:11:48.551648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77f6d568-f934-4241-9a39-46acf7cc7213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527eae0>]}
[0m15:11:48.552292 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:11:48.562108 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/dbt_packages/dbt_utils
[0m15:11:48.564109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.28322184, "process_user_time": 0.708596, "process_kernel_time": 0.1308, "process_mem_max_rss": "111247360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:48.564589 [debug] [MainThread]: Command `dbt run` failed at 15:11:48.564524 after 0.28 seconds
[0m15:11:48.564849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cead80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b59a90>]}
[0m15:11:48.565067 [debug] [MainThread]: Flushing usage events
[0m15:11:54.543031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed6de0>]}


============================== 15:11:54.545602 | 3b954267-3675-4fc1-b015-363c1e0e1a6b ==============================
[0m15:11:54.545602 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:11:54.545929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:54.616551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b954267-3675-4fc1-b015-363c1e0e1a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c25910>]}
[0m15:11:54.631811 [debug] [MainThread]: Set downloads directory='/var/folders/dk/sk1h93cx0q3c33j8g4dmjgv00000gn/T/dbt-downloads-xyw8jbi1'
[0m15:11:54.632064 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:11:55.702442 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:11:55.704402 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:11:56.434403 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:11:56.438891 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:11:59.160325 [info ] [MainThread]: Installed from version 1.2.0
[0m15:11:59.161137 [info ] [MainThread]: Up to date!
[0m15:11:59.161602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b954267-3675-4fc1-b015-363c1e0e1a6b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f92ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f92a80>]}
[0m15:11:59.163820 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.652415, "process_user_time": 0.705097, "process_kernel_time": 0.138505, "process_mem_max_rss": "97337344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:59.164473 [debug] [MainThread]: Command `dbt deps` succeeded at 15:11:59.164339 after 4.65 seconds
[0m15:11:59.164866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a24170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10027eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033acbf0>]}
[0m15:11:59.165072 [debug] [MainThread]: Flushing usage events
[0m15:13:09.032599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106402e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106277170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3290>]}


============================== 15:13:09.035383 | e664f550-bc85-44c4-ad5a-c7c71702bd6f ==============================
[0m15:13:09.035383 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:13:09.035752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:13:09.247374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e16a0>]}
[0m15:13:09.272326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ca300>]}
[0m15:13:09.272923 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:13:09.284722 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m15:13:09.285285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:13:09.285512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a5400>]}
[0m15:13:09.885184 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:13:09.885535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40e60>]}
[0m15:13:09.969854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m15:13:09.972457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af02c0>]}
[0m15:13:10.050179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4fb90>]}
[0m15:13:10.050476 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m15:13:10.050654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d05400>]}
[0m15:13:10.051470 [info ] [MainThread]: 
[0m15:13:10.051739 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:13:10.053922 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m15:13:10.083910 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m15:13:10.084159 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m15:13:10.084318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:10.104530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.105947 [debug] [ThreadPool]: On list_petro: Close
[0m15:13:10.107472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m15:13:10.107760 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m15:13:10.111347 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.111593 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m15:13:10.111755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.116361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.117148 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.117315 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m15:13:10.117520 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.117660 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.117795 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m15:13:10.118653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.119073 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m15:13:10.119212 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m15:13:10.119339 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m15:13:10.119516 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.119659 [debug] [ThreadPool]: On create_petro_main: Close
[0m15:13:10.120848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m15:13:10.123664 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m15:13:10.123885 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m15:13:10.124044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.127868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.128149 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m15:13:10.128325 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m15:13:10.148635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:10.153407 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m15:13:10.154334 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m15:13:10.154491 [debug] [ThreadPool]: On list_petro_main: Close
[0m15:13:10.156347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f321b0>]}
[0m15:13:10.156569 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.156714 [debug] [MainThread]: On master: BEGIN
[0m15:13:10.156839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:10.160194 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:10.160373 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.160518 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.160646 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.160814 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:10.160952 [debug] [MainThread]: On master: Close
[0m15:13:10.161762 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m15:13:10.161990 [info ] [MainThread]: 
[0m15:13:10.164565 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m15:13:10.164948 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m15:13:10.165197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m15:13:10.165372 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m15:13:10.178046 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m15:13:10.178794 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m15:13:10.195526 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m15:13:10.196250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:24.320349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.321075 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m15:13:24.321459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.321663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.321859 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m15:13:24.322487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.324161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.324364 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m15:13:24.324670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.335159 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m15:13:24.335377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.335549 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m15:13:24.335890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.338125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m15:13:24.338312 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m15:13:24.338844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.339989 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m15:13:24.360459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f840e0>]}
[0m15:13:24.360904 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.19s]
[0m15:13:24.361260 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m15:13:24.361753 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m15:13:24.362036 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m15:13:24.362327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m15:13:24.362523 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m15:13:24.364774 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m15:13:24.365217 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m15:13:24.383701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.384018 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622151324380798"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m15:13:24.384219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:24.394708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.399847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.400114 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m15:13:24.400402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.400567 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.400732 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622151324380798'
      
      
      order by ordinal_position

  
[0m15:13:24.424555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.427473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.427686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m15:13:24.434920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.439018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.439269 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m15:13:24.446567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.454429 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m15:13:24.454898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.455092 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622151324380798"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622151324380798"
    )
  
[0m15:13:24.462596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.463477 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m15:13:24.463659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m15:13:24.463816 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m15:13:24.469542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:24.469995 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m15:13:24.541486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e664f550-bc85-44c4-ad5a-c7c71702bd6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcbba40>]}
[0m15:13:24.541958 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m15:13:24.542270 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m15:13:24.543125 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:24.543443 [debug] [MainThread]: On master: BEGIN
[0m15:13:24.543659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:24.547559 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:24.547855 [debug] [MainThread]: On master: COMMIT
[0m15:13:24.548021 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:24.548172 [debug] [MainThread]: On master: COMMIT
[0m15:13:24.548386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:24.548548 [debug] [MainThread]: On master: Close
[0m15:13:24.549479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:24.549632 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m15:13:24.549802 [info ] [MainThread]: 
[0m15:13:24.549978 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.50 seconds (14.50s).
[0m15:13:24.550370 [debug] [MainThread]: Command end result
[0m15:13:24.566291 [info ] [MainThread]: 
[0m15:13:24.566589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:24.566761 [info ] [MainThread]: 
[0m15:13:24.566935 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:13:24.568379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.570353, "process_user_time": 3.690199, "process_kernel_time": 0.826286, "process_mem_max_rss": "211435520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:13:24.568669 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:24.568627 after 15.57 seconds
[0m15:13:24.568846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdd3620>]}
[0m15:13:24.569020 [debug] [MainThread]: Flushing usage events
[0m13:48:02.872110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a59e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a69b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a59e300>]}


============================== 13:48:02.879532 | 26a57913-33c6-45d9-888a-204e0fdddd7c ==============================
[0m13:48:02.879532 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:48:02.880223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:03.025567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26a57913-33c6-45d9-888a-204e0fdddd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5afc75c0>]}
[0m13:48:03.039315 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ss59q2_3'
[0m13:48:03.039799 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:48:03.084575 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:48:03.085337 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:48:03.095997 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:48:03.099769 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:48:03.255041 [info ] [MainThread]: Installed from version 1.2.0
[0m13:48:03.255669 [info ] [MainThread]: Up to date!
[0m13:48:03.256219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '26a57913-33c6-45d9-888a-204e0fdddd7c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5b5bc9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5b5bc9b0>]}
[0m13:48:03.282582 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45893046, "process_user_time": 1.595321, "process_kernel_time": 0.149315, "process_mem_max_rss": "93660", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m13:48:03.283384 [debug] [MainThread]: Command `dbt deps` succeeded at 13:48:03.283254 after 0.46 seconds
[0m13:48:03.283883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a69b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a9eac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5a2e4e90>]}
[0m13:48:03.284346 [debug] [MainThread]: Flushing usage events
[0m13:48:04.929008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12e671d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a16471a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a14c18830>]}


============================== 13:48:04.932050 | 1285590a-ff38-43b1-acd3-650ae6316bae ==============================
[0m13:48:04.932050 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:48:04.932757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:05.173976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a153519a0>]}
[0m13:48:05.233939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12d2a900>]}
[0m13:48:05.234870 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:48:05.250792 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:48:05.251580 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:48:05.252152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12dd3590>]}
[0m13:48:06.473572 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:48:06.474274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12c9ce60>]}
[0m13:48:06.668814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m13:48:06.674075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0c024e30>]}
[0m13:48:06.838632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0be638f0>]}
[0m13:48:06.839229 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m13:48:06.839727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0be47200>]}
[0m13:48:06.841479 [info ] [MainThread]: 
[0m13:48:06.842202 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:48:06.847077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m13:48:06.883244 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m13:48:06.883771 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m13:48:06.884187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:07.361283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.362821 [debug] [ThreadPool]: On list_petro: Close
[0m13:48:07.365062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m13:48:07.365629 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m13:48:07.372382 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.372829 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m13:48:07.373286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:07.378714 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.380079 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.380499 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m13:48:07.381357 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.381795 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.382192 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m13:48:07.382739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.383669 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:48:07.384085 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:48:07.384479 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:48:07.385109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.385539 [debug] [ThreadPool]: On create_petro_main: Close
[0m13:48:07.387826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m13:48:07.393329 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:48:07.393763 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m13:48:07.394158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:07.399494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.399947 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:48:07.400367 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m13:48:07.421052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:48:07.426051 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m13:48:07.427320 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m13:48:07.427746 [debug] [ThreadPool]: On list_petro_main: Close
[0m13:48:07.431370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0be95fa0>]}
[0m13:48:07.431921 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:07.432340 [debug] [MainThread]: On master: BEGIN
[0m13:48:07.432752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:07.438170 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:48:07.438617 [debug] [MainThread]: On master: COMMIT
[0m13:48:07.439031 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:07.439428 [debug] [MainThread]: On master: COMMIT
[0m13:48:07.440067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:48:07.440497 [debug] [MainThread]: On master: Close
[0m13:48:07.442251 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:48:07.442767 [info ] [MainThread]: 
[0m13:48:07.452082 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m13:48:07.452720 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m13:48:07.453433 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m13:48:07.453896 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m13:48:07.479487 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m13:48:07.480339 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m13:48:07.514726 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m13:48:07.515608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:50:30.195058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.195637 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m13:50:30.196583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.197262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.197747 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m13:50:30.198619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.201611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.202112 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m13:50:30.202971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.223833 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:50:30.224338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.224798 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:50:30.226062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.230935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:50:30.231421 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m13:50:30.232686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.235083 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m13:50:30.261136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0bfe43b0>]}
[0m13:50:30.261982 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 142.81s]
[0m13:50:30.262886 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m13:50:30.263919 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m13:50:30.264494 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m13:50:30.265199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m13:50:30.265678 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m13:50:30.270819 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m13:50:30.271480 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m13:50:30.305241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.305842 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622135030299232"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m13:50:30.306350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:30.323409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.331555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.332105 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m13:50:30.332908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.333423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.333888 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622135030299232'
      
      
      order by ordinal_position

  
[0m13:50:30.360782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.366447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.366966 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:50:30.381424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.390629 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.391172 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:50:30.400633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.419069 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m13:50:30.419855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.420362 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622135030299232"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622135030299232"
    )
  
[0m13:50:30.432863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.434801 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:50:30.435277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:50:30.435725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:50:30.444346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:50:30.445308 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m13:50:30.562363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1285590a-ff38-43b1-acd3-650ae6316bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69e00c3620>]}
[0m13:50:30.563210 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m13:50:30.563981 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m13:50:30.565328 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:30.565831 [debug] [MainThread]: On master: BEGIN
[0m13:50:30.566290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:30.571778 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:50:30.572288 [debug] [MainThread]: On master: COMMIT
[0m13:50:30.572744 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:30.573266 [debug] [MainThread]: On master: COMMIT
[0m13:50:30.573987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:50:30.574460 [debug] [MainThread]: On master: Close
[0m13:50:30.576132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:30.576591 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m13:50:30.577057 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m13:50:30.577557 [info ] [MainThread]: 
[0m13:50:30.578110 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 23.74 seconds (143.74s).
[0m13:50:30.579122 [debug] [MainThread]: Command end result
[0m13:50:30.606704 [info ] [MainThread]: 
[0m13:50:30.607401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:30.607927 [info ] [MainThread]: 
[0m13:50:30.608461 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:50:30.609494 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 145.72975, "process_user_time": 4.790523, "process_kernel_time": 0.290696, "process_mem_max_rss": "267828", "process_in_blocks": "1184", "process_out_blocks": "107024"}
[0m13:50:30.610149 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:30.610040 after 145.73 seconds
[0m13:50:30.610657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12fe1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a13148da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69e0161b50>]}
[0m13:50:30.611155 [debug] [MainThread]: Flushing usage events
[0m13:50:32.401985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd37ad850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd2984b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd2c27a70>]}


============================== 13:50:32.404866 | dc83d47b-f8b6-4298-85e4-235e985099a8 ==============================
[0m13:50:32.404866 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:50:32.405654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:32.550954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc83d47b-f8b6-4298-85e4-235e985099a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd2c25700>]}
[0m13:50:32.569046 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21620041, "process_user_time": 1.406766, "process_kernel_time": 0.13226, "process_mem_max_rss": "92160", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:50:32.569664 [debug] [MainThread]: Command `dbt clean` succeeded at 13:50:32.569556 after 0.22 seconds
[0m13:50:32.570130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd4b1d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd261ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd26bd370>]}
[0m13:50:32.570580 [debug] [MainThread]: Flushing usage events
[0m14:05:22.048919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d923e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dd7a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4dd78860>]}


============================== 14:05:22.056871 | bf4b2954-f21c-454a-aeac-93659c33bd01 ==============================
[0m14:05:22.056871 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:22.057593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:22.209644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf4b2954-f21c-454a-aeac-93659c33bd01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4de03320>]}
[0m14:05:22.223440 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zc7qqx8u'
[0m14:05:22.223913 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:22.316534 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:22.317345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:22.329167 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:22.333058 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:22.486762 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:22.487382 [info ] [MainThread]: Up to date!
[0m14:05:22.488001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bf4b2954-f21c-454a-aeac-93659c33bd01', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d7b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4e27d0a0>]}
[0m14:05:22.489456 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48974532, "process_user_time": 1.59689, "process_kernel_time": 0.136075, "process_mem_max_rss": "93524", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:05:22.490084 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:22.489975 after 0.49 seconds
[0m14:05:22.490608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4e3e3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d7b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4d923d70>]}
[0m14:05:22.491069 [debug] [MainThread]: Flushing usage events
[0m14:05:24.128871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84401cf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8440286cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844105c9b0>]}


============================== 14:05:24.132122 | efb0c34b-50ff-417e-9837-dd88c9566f79 ==============================
[0m14:05:24.132122 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.132811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.378766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843ffc2870>]}
[0m14:05:24.439329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844000d100>]}
[0m14:05:24.440270 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:24.479639 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:24.480399 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:24.480969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843ffc3a10>]}
[0m14:05:25.700506 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:25.701323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843947a390>]}
[0m14:05:25.896585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:25.901864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843ffb0d40>]}
[0m14:05:26.040551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843913f470>]}
[0m14:05:26.041156 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:26.041695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8439158b00>]}
[0m14:05:26.043528 [info ] [MainThread]: 
[0m14:05:26.044310 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:26.049410 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:26.086618 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:26.087130 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:26.087541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:26.801583 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:26.803198 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:26.805402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:26.805977 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:26.812869 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.813316 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:26.813724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.819611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.821040 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.821455 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:26.822115 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.822563 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.822962 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:26.823541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.824476 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:26.824890 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:26.825279 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:26.825827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.826301 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:26.828857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:26.834510 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:26.834954 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:26.835349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.840711 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.841139 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:26.841559 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:26.861346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:26.866306 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:26.867515 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:26.867937 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:26.871489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843913faa0>]}
[0m14:05:26.872029 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.872429 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.872806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:26.878070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.878544 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.878942 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.879325 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.879951 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.880366 [debug] [MainThread]: On master: Close
[0m14:05:26.881980 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:26.882559 [info ] [MainThread]: 
[0m14:05:26.892123 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:26.892784 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:26.893557 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:26.894020 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:26.919676 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:26.920500 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:26.954890 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:26.955784 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:38.313032 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.313637 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:38.314670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.315149 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.315600 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:38.316378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.319426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.319903 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:38.320631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.341828 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.342464 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.342931 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:38.344678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.349844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:38.350369 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:38.351628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.354099 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:38.380458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840cb03dd0>]}
[0m14:05:38.381330 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.49s]
[0m14:05:38.382272 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:38.383305 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:38.383896 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:38.384589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:38.385075 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:38.390388 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:38.391085 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:38.425319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.425969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622140538419200"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:38.426512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:38.442074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.449982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.450540 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:38.451230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.451693 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.452147 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622140538419200'
      
      
      order by ordinal_position

  
[0m14:05:38.479787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.485703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.486310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:38.494916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.504388 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.504965 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:38.514638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.533504 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:38.534362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.534860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622140538419200"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622140538419200"
    )
  
[0m14:05:38.547208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.549333 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:38.549831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:38.550339 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:38.559846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:38.560850 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:38.685294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb0c34b-50ff-417e-9837-dd88c9566f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840caae090>]}
[0m14:05:38.686169 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m14:05:38.686976 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:38.688457 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:38.688948 [debug] [MainThread]: On master: BEGIN
[0m14:05:38.689414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:38.694999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:38.695493 [debug] [MainThread]: On master: COMMIT
[0m14:05:38.695946 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:38.696384 [debug] [MainThread]: On master: COMMIT
[0m14:05:38.696947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:38.697416 [debug] [MainThread]: On master: Close
[0m14:05:38.699058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:38.699516 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:38.699940 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:38.700439 [info ] [MainThread]: 
[0m14:05:38.701010 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.66 seconds (12.66s).
[0m14:05:38.702071 [debug] [MainThread]: Command end result
[0m14:05:38.730592 [info ] [MainThread]: 
[0m14:05:38.731340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:38.731903 [info ] [MainThread]: 
[0m14:05:38.732476 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:38.733559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.654432, "process_user_time": 4.813725, "process_kernel_time": 0.323309, "process_mem_max_rss": "274504", "process_in_blocks": "1184", "process_out_blocks": "107104"}
[0m14:05:38.734251 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:38.734114 after 14.66 seconds
[0m14:05:38.734781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84342467b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84405f4d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844013f6e0>]}
[0m14:05:38.735284 [debug] [MainThread]: Flushing usage events
[0m14:05:40.570780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246eb10>]}


============================== 14:05:40.573651 | 81f8f104-bd44-4d0b-9ee1-e2a2749a72be ==============================
[0m14:05:40.573651 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:40.574369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:40.724535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81f8f104-bd44-4d0b-9ee1-e2a2749a72be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c42bb6d20>]}
[0m14:05:40.741317 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21956562, "process_user_time": 1.43797, "process_kernel_time": 0.108148, "process_mem_max_rss": "92124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:40.741930 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:40.741826 after 0.22 seconds
[0m14:05:40.742422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4246ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c41adf680>]}
[0m14:05:40.742870 [debug] [MainThread]: Flushing usage events
[0m23:25:24.084505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d3a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7110>]}


============================== 23:25:24.087361 | 7b8fee30-4d72-46c3-84ab-007b1cb39f55 ==============================
[0m23:25:24.087361 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:25:24.087706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:25:24.291283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77e30>]}
[0m23:25:24.316246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db2900>]}
[0m23:25:24.316873 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m23:25:24.328806 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:25:24.395738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:25:24.396000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:25:24.398950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m23:25:24.413147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080fb200>]}
[0m23:25:24.462738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801b9b0>]}
[0m23:25:24.463030 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m23:25:24.463207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6cb60>]}
[0m23:25:24.464078 [info ] [MainThread]: 
[0m23:25:24.464380 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:25:24.466460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m23:25:24.496435 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m23:25:24.496677 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m23:25:24.496829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:24.513114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.514140 [debug] [ThreadPool]: On list_petro: Close
[0m23:25:24.515549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m23:25:24.515774 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m23:25:24.519006 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.519180 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m23:25:24.519319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:24.523037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.523944 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.524108 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m23:25:24.524291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.524429 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.524564 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m23:25:24.525408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.525810 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:25:24.525946 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:25:24.526070 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:25:24.526244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.526382 [debug] [ThreadPool]: On create_petro_main: Close
[0m23:25:24.527584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m23:25:24.530230 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:25:24.530415 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m23:25:24.530559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:24.534104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.534348 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:25:24.534512 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m23:25:24.553004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:25:24.557476 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m23:25:24.558440 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m23:25:24.558593 [debug] [ThreadPool]: On list_petro_main: Close
[0m23:25:24.560550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593ed50>]}
[0m23:25:24.560822 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:24.560978 [debug] [MainThread]: On master: BEGIN
[0m23:25:24.561116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:25:24.564518 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:24.564705 [debug] [MainThread]: On master: COMMIT
[0m23:25:24.564853 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:24.564992 [debug] [MainThread]: On master: COMMIT
[0m23:25:24.565177 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:24.565319 [debug] [MainThread]: On master: Close
[0m23:25:24.566120 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:25:24.566297 [info ] [MainThread]: 
[0m23:25:24.568008 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m23:25:24.568278 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m23:25:24.568506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m23:25:24.568675 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m23:25:24.581338 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m23:25:24.582216 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m23:25:24.598371 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m23:25:24.598874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:34.226950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.227500 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m23:25:34.227931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.228175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.228406 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m23:25:34.229078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.230915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.231156 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m23:25:34.231513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.243319 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:25:34.243555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.243745 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:25:34.244115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.246731 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:25:34.246944 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m23:25:34.247446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.248744 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m23:25:34.269740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797d730>]}
[0m23:25:34.270147 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.70s]
[0m23:25:34.270454 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m23:25:34.270850 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m23:25:34.271118 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m23:25:34.271331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m23:25:34.271506 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m23:25:34.278959 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m23:25:34.279426 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m23:25:34.295242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.295579 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622232534292421"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m23:25:34.295799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:34.306353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.310918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.311205 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m23:25:34.311550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.311773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.311961 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622232534292421'
      
      
      order by ordinal_position

  
[0m23:25:34.335688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.339348 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.339610 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:25:34.348170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.353324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.353697 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:25:34.362878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.372857 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m23:25:34.373487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.373706 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622232534292421"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622232534292421"
    )
  
[0m23:25:34.385357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.386485 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:25:34.386695 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:25:34.386869 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:25:34.395350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:25:34.396101 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m23:25:34.471562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8fee30-4d72-46c3-84ab-007b1cb39f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3adbb0>]}
[0m23:25:34.471977 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.20s]
[0m23:25:34.472300 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m23:25:34.473033 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:34.473193 [debug] [MainThread]: On master: BEGIN
[0m23:25:34.473330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:25:34.476762 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:34.476945 [debug] [MainThread]: On master: COMMIT
[0m23:25:34.477089 [debug] [MainThread]: Using duckdb connection "master"
[0m23:25:34.477221 [debug] [MainThread]: On master: COMMIT
[0m23:25:34.477395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:25:34.477535 [debug] [MainThread]: On master: Close
[0m23:25:34.478346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:34.478534 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m23:25:34.478759 [info ] [MainThread]: 
[0m23:25:34.478959 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m23:25:34.479384 [debug] [MainThread]: Command end result
[0m23:25:34.495957 [info ] [MainThread]: 
[0m23:25:34.496282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:25:34.496452 [info ] [MainThread]: 
[0m23:25:34.496625 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:25:34.498504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.448308, "process_user_time": 2.847289, "process_kernel_time": 1.129004, "process_mem_max_rss": "200294400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:25:34.498900 [debug] [MainThread]: Command `dbt run` succeeded at 23:25:34.498853 after 10.45 seconds
[0m23:25:34.499122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d3a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f80e0>]}
[0m23:25:34.499303 [debug] [MainThread]: Flushing usage events
[0m23:27:17.532882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10217c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403b1a0>]}


============================== 23:27:17.535623 | 4a1f0b10-ed61-49b9-a046-ad5e29b07e7f ==============================
[0m23:27:17.535623 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:27:17.535963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:27:17.730839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a8f140>]}
[0m23:27:17.755780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035d91c0>]}
[0m23:27:17.756440 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m23:27:17.768364 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:27:17.842748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:17.843025 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:17.845923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m23:27:17.859751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440a600>]}
[0m23:27:17.905905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104319610>]}
[0m23:27:17.906195 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m23:27:17.906372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104531040>]}
[0m23:27:17.907192 [info ] [MainThread]: 
[0m23:27:17.907485 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:27:17.909598 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m23:27:17.939243 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m23:27:17.939497 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m23:27:17.939657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:17.955507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.956840 [debug] [ThreadPool]: On list_petro: Close
[0m23:27:17.958222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m23:27:17.958492 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m23:27:17.961782 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.961971 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m23:27:17.962120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:17.965897 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.966603 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.966756 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m23:27:17.966942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.967083 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.967219 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m23:27:17.967954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.968391 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:27:17.968541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m23:27:17.968686 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m23:27:17.968877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.969026 [debug] [ThreadPool]: On create_petro_main: Close
[0m23:27:17.970120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m23:27:17.972704 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:27:17.972871 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m23:27:17.973002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:17.976205 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.976395 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m23:27:17.976553 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m23:27:17.994614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m23:27:17.998915 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m23:27:17.999921 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m23:27:18.000084 [debug] [ThreadPool]: On list_petro_main: Close
[0m23:27:18.002174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10431a5d0>]}
[0m23:27:18.002399 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:18.002537 [debug] [MainThread]: On master: BEGIN
[0m23:27:18.002667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:18.006070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:18.006254 [debug] [MainThread]: On master: COMMIT
[0m23:27:18.006399 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:18.006528 [debug] [MainThread]: On master: COMMIT
[0m23:27:18.006701 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:18.006843 [debug] [MainThread]: On master: Close
[0m23:27:18.007702 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m23:27:18.007893 [info ] [MainThread]: 
[0m23:27:18.010794 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m23:27:18.011092 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m23:27:18.011323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m23:27:18.011496 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m23:27:18.023601 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m23:27:18.024479 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m23:27:18.040538 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m23:27:18.041154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:23.815456 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.815795 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m23:27:23.816166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.816396 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.816620 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m23:27:23.817271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.819191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.819445 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m23:27:23.819845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.831818 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:27:23.832065 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.832261 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m23:27:23.832651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.835415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m23:27:23.835636 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m23:27:23.836135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.837352 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m23:27:23.857617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a24ad0>]}
[0m23:27:23.858004 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 5.85s]
[0m23:27:23.858319 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m23:27:23.858735 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m23:27:23.859003 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m23:27:23.859229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m23:27:23.859408 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m23:27:23.866803 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m23:27:23.867530 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m23:27:23.883825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.884104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622232723881223"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m23:27:23.884293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:23.894631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.899285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.899523 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m23:27:23.899836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.900010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.900181 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622232723881223'
      
      
      order by ordinal_position

  
[0m23:27:23.923942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.927147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.927405 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:27:23.936151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.940492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.940755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m23:27:23.949191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.957226 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m23:27:23.957976 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.958176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622232723881223"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622232723881223"
    )
  
[0m23:27:23.966119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.967008 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:27:23.967199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m23:27:23.967354 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m23:27:23.972733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m23:27:23.973165 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m23:27:24.048521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a1f0b10-ed61-49b9-a046-ad5e29b07e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12719e240>]}
[0m23:27:24.048947 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.19s]
[0m23:27:24.049251 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m23:27:24.049820 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:24.050012 [debug] [MainThread]: On master: BEGIN
[0m23:27:24.050160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:24.055637 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:24.055859 [debug] [MainThread]: On master: COMMIT
[0m23:27:24.056158 [debug] [MainThread]: Using duckdb connection "master"
[0m23:27:24.056384 [debug] [MainThread]: On master: COMMIT
[0m23:27:24.056765 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m23:27:24.057048 [debug] [MainThread]: On master: Close
[0m23:27:24.058749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:24.059018 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m23:27:24.059554 [info ] [MainThread]: 
[0m23:27:24.059909 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m23:27:24.060385 [debug] [MainThread]: Command end result
[0m23:27:24.076952 [info ] [MainThread]: 
[0m23:27:24.077296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:24.077486 [info ] [MainThread]: 
[0m23:27:24.077665 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:27:24.079797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.584207, "process_user_time": 2.837844, "process_kernel_time": 1.169798, "process_mem_max_rss": "210436096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:27:24.080178 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:24.080132 after 6.58 seconds
[0m23:27:24.080374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040adb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aec440>]}
[0m23:27:24.080569 [debug] [MainThread]: Flushing usage events
[0m21:29:00.982754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eff2ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef98d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef98cc80>]}


============================== 21:29:00.989637 | bcac8110-35a9-49a3-bb74-874deb3e44eb ==============================
[0m21:29:00.989637 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:00.990422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m21:29:01.135062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcac8110-35a9-49a3-bb74-874deb3e44eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef915910>]}
[0m21:29:01.148296 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-10b7qqmu'
[0m21:29:01.148770 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:29:01.221818 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:29:01.222471 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:29:01.245152 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:29:01.248821 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:29:01.319243 [info ] [MainThread]: Installed from version 1.2.0
[0m21:29:01.319789 [info ] [MainThread]: Up to date!
[0m21:29:01.320381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bcac8110-35a9-49a3-bb74-874deb3e44eb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eff2ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef8c2f00>]}
[0m21:29:01.321809 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38735923, "process_user_time": 1.571707, "process_kernel_time": 0.107161, "process_mem_max_rss": "93396", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m21:29:01.322425 [debug] [MainThread]: Command `dbt deps` succeeded at 21:29:01.322320 after 0.39 seconds
[0m21:29:01.322873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55efbc2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ef4f2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eff2ed20>]}
[0m21:29:01.323313 [debug] [MainThread]: Flushing usage events
[0m21:29:02.882443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e83248200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80f13bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80f12540>]}


============================== 21:29:02.885154 | c0ff1444-ceb4-42bb-8df8-f349f625605e ==============================
[0m21:29:02.885154 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:02.885850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:03.117793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e809533e0>]}
[0m21:29:03.176885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e808f6870>]}
[0m21:29:03.177657 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m21:29:03.192879 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:29:03.193611 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:29:03.194200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e82688230>]}
[0m21:29:04.397405 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:29:04.398239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e79c7dd60>]}
[0m21:29:04.586705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:29:04.591627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e79d041a0>]}
[0m21:29:04.714562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e815519a0>]}
[0m21:29:04.715116 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m21:29:04.715653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80f2a930>]}
[0m21:29:04.717361 [info ] [MainThread]: 
[0m21:29:04.718086 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:29:04.722954 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:29:04.758087 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:29:04.758636 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m21:29:04.759044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:05.284124 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m21:29:05.285693 [debug] [ThreadPool]: On list_petro: Close
[0m21:29:05.287980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:29:05.288564 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:29:05.295448 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.295895 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m21:29:05.296298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:05.301827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.303154 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.303574 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:29:05.304109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.304512 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.304901 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:29:05.305468 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.306424 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:29:05.306836 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:29:05.307228 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:29:05.307802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.308279 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:29:05.310434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:29:05.315724 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:29:05.316149 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:29:05.316533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:05.321396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.321860 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:29:05.322275 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m21:29:05.342271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:29:05.346959 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:29:05.348122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:29:05.348539 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:29:05.351549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e82689670>]}
[0m21:29:05.352066 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:05.352464 [debug] [MainThread]: On master: BEGIN
[0m21:29:05.352841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:05.357798 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:05.358232 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.358626 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:05.359008 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.359648 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:05.360067 [debug] [MainThread]: On master: Close
[0m21:29:05.361468 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:29:05.362002 [info ] [MainThread]: 
[0m21:29:05.371057 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:29:05.371656 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:29:05.372312 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m21:29:05.372757 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:29:05.398576 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:29:05.399329 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:29:05.433705 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:29:05.434425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:14.625821 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.626357 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:29:14.626965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.627435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.627879 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:29:14.628562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.631217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.631682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:29:14.632373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.652822 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:29:14.653304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.653778 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:29:14.654930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.659595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:29:14.660074 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m21:29:14.661196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.663503 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:29:14.689005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e822c2570>]}
[0m21:29:14.689754 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.32s]
[0m21:29:14.690527 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:29:14.691504 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:29:14.692082 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:29:14.692662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:29:14.693124 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:29:14.697858 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:29:14.698494 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:29:14.731910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.732458 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622212914726033"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:29:14.732946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:14.749640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.756845 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.757349 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:29:14.758125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.758586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.759066 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622212914726033'
      
      
      order by ordinal_position

  
[0m21:29:14.785799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.791168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.791656 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:29:14.800235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.808939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.809436 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m21:29:14.817547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.835449 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:29:14.836159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.836646 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622212914726033"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622212914726033"
    )
  
[0m21:29:14.845849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.847556 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:29:14.848017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:29:14.848450 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:29:14.856936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:29:14.857878 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:29:14.993826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0ff1444-ceb4-42bb-8df8-f349f625605e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e4d4e80b0>]}
[0m21:29:14.994639 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m21:29:14.995375 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:29:14.996738 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:14.997225 [debug] [MainThread]: On master: BEGIN
[0m21:29:14.997669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:15.003052 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:15.003531 [debug] [MainThread]: On master: COMMIT
[0m21:29:15.003973 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:15.004397 [debug] [MainThread]: On master: COMMIT
[0m21:29:15.004949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:29:15.005409 [debug] [MainThread]: On master: Close
[0m21:29:15.006755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:15.007197 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m21:29:15.007612 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:29:15.008074 [info ] [MainThread]: 
[0m21:29:15.008669 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m21:29:15.009851 [debug] [MainThread]: Command end result
[0m21:29:15.037202 [info ] [MainThread]: 
[0m21:29:15.037922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:15.038527 [info ] [MainThread]: 
[0m21:29:15.039137 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:29:15.040216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.206544, "process_user_time": 4.680707, "process_kernel_time": 0.311514, "process_mem_max_rss": "282052", "process_in_blocks": "1184", "process_out_blocks": "108632"}
[0m21:29:15.040873 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:15.040763 after 12.21 seconds
[0m21:29:15.041383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e83248200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e80a73740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e79ecb650>]}
[0m21:29:15.041918 [debug] [MainThread]: Flushing usage events
[0m21:29:16.672399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca445ef380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca445ef2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca44e701d0>]}


============================== 21:29:16.675184 | eb376c2d-6d86-4c48-8754-8569d6f316b7 ==============================
[0m21:29:16.675184 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:16.675834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:16.817476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb376c2d-6d86-4c48-8754-8569d6f316b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4503d9a0>]}
[0m21:29:16.834002 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21008946, "process_user_time": 1.411492, "process_kernel_time": 0.111643, "process_mem_max_rss": "92148", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:29:16.834582 [debug] [MainThread]: Command `dbt clean` succeeded at 21:29:16.834479 after 0.21 seconds
[0m21:29:16.835023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca4488f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca448c4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca456036e0>]}
[0m21:29:16.835460 [debug] [MainThread]: Flushing usage events
[0m22:06:09.742657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e531ed8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e52855580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5162bd40>]}


============================== 22:06:09.789746 | 93ff7505-44b7-4915-9cb7-bd9e1dee6efa ==============================
[0m22:06:09.789746 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:09.790472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:09.933024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ff7505-44b7-4915-9cb7-bd9e1dee6efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e520a5b80>]}
[0m22:06:09.946333 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5vp294jm'
[0m22:06:09.946797 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:10.006981 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:10.007654 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:10.017706 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:10.021545 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:10.068027 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:10.068570 [info ] [MainThread]: Up to date!
[0m22:06:10.069170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93ff7505-44b7-4915-9cb7-bd9e1dee6efa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e51625520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5138f8c0>]}
[0m22:06:10.084090 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38966253, "process_user_time": 1.566005, "process_kernel_time": 0.115852, "process_mem_max_rss": "93244", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m22:06:10.084699 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:10.084596 after 0.39 seconds
[0m22:06:10.085169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e517d7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e553bbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e51f430b0>]}
[0m22:06:10.085614 [debug] [MainThread]: Flushing usage events
[0m22:06:11.661192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46395a4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639c66cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463aaab3e0>]}


============================== 22:06:11.664082 | 156ace07-4859-4a70-bec2-f7b2bd5d3ed2 ==============================
[0m22:06:11.664082 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:11.664826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:11.890486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46395a5100>]}
[0m22:06:11.949285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a604800>]}
[0m22:06:11.950037 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m22:06:11.964833 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:11.965573 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:11.966121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639457f20>]}
[0m22:06:13.189916 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:13.190668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4632ba6f30>]}
[0m22:06:13.380217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:13.385082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46328cfcb0>]}
[0m22:06:13.523254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639467b60>]}
[0m22:06:13.523827 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:13.524315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463269aba0>]}
[0m22:06:13.526024 [info ] [MainThread]: 
[0m22:06:13.526716 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:13.531374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:13.566296 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:13.566752 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m22:06:13.567157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:14.028870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.030449 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:14.032805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:14.033441 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:14.040309 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.040760 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m22:06:14.041198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:14.046592 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.047915 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.048331 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:14.049204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.049616 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.050014 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:14.050646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.051588 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:14.052015 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:14.052407 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:14.052954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.053419 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:14.055528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:14.060827 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:14.061292 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:14.061711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:14.066555 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.066980 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:14.067390 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m22:06:14.087188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:14.091899 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:14.093068 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:14.093524 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:14.096579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463269bf20>]}
[0m22:06:14.097100 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.097545 [debug] [MainThread]: On master: BEGIN
[0m22:06:14.097997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:14.103054 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.103482 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.103877 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.104260 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.104891 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.105339 [debug] [MainThread]: On master: Close
[0m22:06:14.106831 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:14.107376 [info ] [MainThread]: 
[0m22:06:14.122803 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:14.123407 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:14.124133 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:14.124585 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:14.150198 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:14.150941 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:14.185585 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:14.186321 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:21.662714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.663249 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:21.664034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.664508 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.664964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:21.665699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.668372 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.668841 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:21.669590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.690287 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.690798 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.691251 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.692302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.697040 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.697553 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:21.698665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.700967 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:21.726539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a067410>]}
[0m22:06:21.727276 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.60s]
[0m22:06:21.728064 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:21.729058 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:21.729668 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:21.730280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:21.730750 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:21.735575 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:21.736233 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:21.769681 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.770197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240622220621763818"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:21.770683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:21.785052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.791967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.792454 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:21.793076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.793557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.794011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240622220621763818'
      
      
      order by ordinal_position

  
[0m22:06:21.826267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.831132 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.831621 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.840128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.848512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.849009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.858052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.875974 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:21.876655 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.877163 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240622220621763818"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240622220621763818"
    )
  
[0m22:06:21.888287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.890022 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.890483 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.890919 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.899535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.900399 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:22.040657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '156ace07-4859-4a70-bec2-f7b2bd5d3ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46065d0d10>]}
[0m22:06:22.041493 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m22:06:22.042265 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:22.043682 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.044178 [debug] [MainThread]: On master: BEGIN
[0m22:06:22.044628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:22.049942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.050426 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.050876 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.051308 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.051995 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.052462 [debug] [MainThread]: On master: Close
[0m22:06:22.053891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:22.054343 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:22.054766 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:22.055247 [info ] [MainThread]: 
[0m22:06:22.055854 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m22:06:22.056974 [debug] [MainThread]: Command end result
[0m22:06:22.084552 [info ] [MainThread]: 
[0m22:06:22.085257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:22.085872 [info ] [MainThread]: 
[0m22:06:22.086482 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:22.087579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.475895, "process_user_time": 4.714553, "process_kernel_time": 0.312169, "process_mem_max_rss": "281976", "process_in_blocks": "1184", "process_out_blocks": "108640"}
[0m22:06:22.088234 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:22.088123 after 10.48 seconds
[0m22:06:22.088736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a7cf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4632654530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639a418e0>]}
[0m22:06:22.089276 [debug] [MainThread]: Flushing usage events
[0m22:06:23.706844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fdc16bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fdc16b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fdc17c80>]}


============================== 22:06:23.709561 | d6f4023d-19ad-44c3-ae46-0c6d2ecbe8d4 ==============================
[0m22:06:23.709561 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:23.710296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:23.850267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6f4023d-19ad-44c3-ae46-0c6d2ecbe8d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fe1b5c10>]}
[0m22:06:23.866690 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20847084, "process_user_time": 1.414527, "process_kernel_time": 0.104186, "process_mem_max_rss": "92248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:23.867280 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:23.867177 after 0.21 seconds
[0m22:06:23.867730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fd4a7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fd4a4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69fd02dac0>]}
[0m22:06:23.868172 [debug] [MainThread]: Flushing usage events
[0m06:02:10.216111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af219b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee71b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee71b6b0>]}


============================== 06:02:10.223290 | 0403180a-75f1-4c0d-b8ce-7f65668a4a69 ==============================
[0m06:02:10.223290 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.223965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.362641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0403180a-75f1-4c0d-b8ce-7f65668a4a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aef4d8aa0>]}
[0m06:02:10.375995 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-niwqi81k'
[0m06:02:10.376456 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.498711 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.499341 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.563712 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.567463 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.701618 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.702118 [info ] [MainThread]: Up to date!
[0m06:02:10.702709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0403180a-75f1-4c0d-b8ce-7f65668a4a69', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee87af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee3c6e70>]}
[0m06:02:10.704103 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53657216, "process_user_time": 1.557671, "process_kernel_time": 0.107562, "process_mem_max_rss": "93644", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m06:02:10.704698 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.704594 after 0.54 seconds
[0m06:02:10.705134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af21bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aee87af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af1539bb0>]}
[0m06:02:10.705569 [debug] [MainThread]: Flushing usage events
[0m06:02:12.330110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe08d5b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09850cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe09852000>]}


============================== 06:02:12.332878 | 1b304f64-eb2f-49f8-a398-8f57932b18d4 ==============================
[0m06:02:12.332878 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.333618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.561144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe08b34770>]}
[0m06:02:12.620178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe091876e0>]}
[0m06:02:12.620928 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m06:02:12.636153 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.636879 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.637438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe08a461e0>]}
[0m06:02:13.845663 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.846462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01fb49e0>]}
[0m06:02:14.035549 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.040466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe020c50a0>]}
[0m06:02:14.171347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01d011f0>]}
[0m06:02:14.171890 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.172432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01eecef0>]}
[0m06:02:14.174128 [info ] [MainThread]: 
[0m06:02:14.174856 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.179555 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.214408 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.214917 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m06:02:14.215331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.716271 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:14.717841 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.720024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.720611 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.727540 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.727992 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m06:02:14.728409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.733932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.735379 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.735803 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.736350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.736762 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.737155 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.737727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.738689 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.739109 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.739507 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.740116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.740541 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.742661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.747966 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.748405 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.748795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.753661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.754089 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.754528 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m06:02:14.774587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.779286 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.780475 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.780903 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.783946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe01eab320>]}
[0m06:02:14.784477 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.784882 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.785262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.790255 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.790730 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.791133 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.791523 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.792166 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.792581 [debug] [MainThread]: On master: Close
[0m06:02:14.794018 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.794589 [info ] [MainThread]: 
[0m06:02:14.804036 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.804640 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.805386 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.805846 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.831265 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.832016 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.866103 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.866852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.772403 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.772934 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.773556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.774030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.774485 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.775359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.778005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.778476 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.779198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.799851 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.800340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.800795 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.801922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.806640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.807124 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.808623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.810950 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.836388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd5e2e960>]}
[0m06:02:23.837103 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.03s]
[0m06:02:23.837883 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.838887 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.839474 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.840058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.840521 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.845260 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.845911 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.878774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.879293 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623060223872931"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.879784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.893993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.900799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.901279 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.901867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.902334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.902830 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623060223872931'
      
      
      order by ordinal_position

  
[0m06:02:23.929203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.934006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.934527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.942907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.951217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.951717 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.960145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.978045 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.978749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.979242 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623060223872931"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623060223872931"
    )
  
[0m06:02:23.988851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.990610 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.991084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.991530 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.000097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.001033 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:24.147387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b304f64-eb2f-49f8-a398-8f57932b18d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd5d67fe0>]}
[0m06:02:24.148164 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:24.148948 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:24.150330 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.150859 [debug] [MainThread]: On master: BEGIN
[0m06:02:24.151316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:24.156647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.157129 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.157573 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.158003 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.158725 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.159192 [debug] [MainThread]: On master: Close
[0m06:02:24.160581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:24.161024 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:24.161441 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:24.161911 [info ] [MainThread]: 
[0m06:02:24.162549 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m06:02:24.163675 [debug] [MainThread]: Command end result
[0m06:02:24.191457 [info ] [MainThread]: 
[0m06:02:24.192142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:24.192755 [info ] [MainThread]: 
[0m06:02:24.193366 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:24.194463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.913357, "process_user_time": 4.674241, "process_kernel_time": 0.303366, "process_mem_max_rss": "268800", "process_in_blocks": "1184", "process_out_blocks": "109120"}
[0m06:02:24.195158 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:24.195047 after 11.91 seconds
[0m06:02:24.195654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe0cbbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdd65a51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbde889d100>]}
[0m06:02:24.196151 [debug] [MainThread]: Flushing usage events
[0m06:02:25.889204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f39b6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f43ca930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f43caff0>]}


============================== 06:02:25.891976 | efd07a2c-8d4c-46d5-b64e-ee02f04a6cfd ==============================
[0m06:02:25.891976 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.892697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.035070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efd07a2c-8d4c-46d5-b64e-ee02f04a6cfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f3845880>]}
[0m06:02:26.051567 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21105623, "process_user_time": 1.410436, "process_kernel_time": 0.099889, "process_mem_max_rss": "92288", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:26.052151 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:26.052047 after 0.21 seconds
[0m06:02:26.052597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f5e2d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f37dac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89f6ee9c40>]}
[0m06:02:26.053039 [debug] [MainThread]: Flushing usage events
[0m13:56:00.489779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112827170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e2f020>]}


============================== 13:56:00.492526 | 7dd3d873-9664-410d-b441-18792474801c ==============================
[0m13:56:00.492526 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:56:00.492875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/WWW/Local/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:00.689703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a79cd0>]}
[0m13:56:00.714524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d2d80>]}
[0m13:56:00.715153 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:56:00.727832 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:56:00.795680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:00.795930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:00.798863 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m13:56:00.812528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a34050>]}
[0m13:56:00.859594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135dac0>]}
[0m13:56:00.859886 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m13:56:00.860078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113865b20>]}
[0m13:56:00.860894 [info ] [MainThread]: 
[0m13:56:00.861199 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:56:00.863280 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m13:56:00.893700 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m13:56:00.893968 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m13:56:00.894131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:00.914475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.916049 [debug] [ThreadPool]: On list_petro: Close
[0m13:56:00.918196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m13:56:00.918495 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m13:56:00.922330 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.922559 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m13:56:00.922702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:00.926584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.927472 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.927628 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m13:56:00.927822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.927962 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.928098 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m13:56:00.928663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.929151 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:56:00.929313 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m13:56:00.929458 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m13:56:00.929692 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.929846 [debug] [ThreadPool]: On create_petro_main: Close
[0m13:56:00.931050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m13:56:00.933720 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:56:00.933885 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m13:56:00.934017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:00.937422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.937604 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m13:56:00.937759 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m13:56:00.958877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:00.962748 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m13:56:00.963693 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m13:56:00.963856 [debug] [ThreadPool]: On list_petro_main: Close
[0m13:56:00.965866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a18c80>]}
[0m13:56:00.966094 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:00.966236 [debug] [MainThread]: On master: BEGIN
[0m13:56:00.966374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:00.969646 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:00.969822 [debug] [MainThread]: On master: COMMIT
[0m13:56:00.969966 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:00.970100 [debug] [MainThread]: On master: COMMIT
[0m13:56:00.970325 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:00.970502 [debug] [MainThread]: On master: Close
[0m13:56:00.971326 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:56:00.971538 [info ] [MainThread]: 
[0m13:56:00.973263 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m13:56:00.973530 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m13:56:00.973750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m13:56:00.973916 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m13:56:00.986331 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m13:56:00.987205 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m13:56:01.003723 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m13:56:01.004755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:20.995750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:20.996395 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m13:56:20.996847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:20.997080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:20.997307 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m13:56:20.997984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:20.999866 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:21.000108 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m13:56:21.000477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.012298 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:56:21.012550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:21.012740 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m13:56:21.013108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.015727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m13:56:21.015944 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m13:56:21.016479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.018178 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m13:56:21.038883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f521370>]}
[0m13:56:21.039435 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 20.06s]
[0m13:56:21.039842 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m13:56:21.040613 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m13:56:21.040927 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m13:56:21.041159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m13:56:21.041339 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m13:56:21.051967 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m13:56:21.053844 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m13:56:21.076410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.076796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623135621073585"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m13:56:21.077037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:21.088821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.094141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.094461 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m13:56:21.094807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.094987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.095166 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623135621073585'
      
      
      order by ordinal_position

  
[0m13:56:21.118412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.121283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.121513 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:56:21.129026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.132965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.133207 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m13:56:21.140504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.148491 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m13:56:21.148977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.149177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623135621073585"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623135621073585"
    )
  
[0m13:56:21.159133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.160152 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:56:21.160416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m13:56:21.160632 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m13:56:21.165279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:21.165835 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m13:56:21.256095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd3d873-9664-410d-b441-18792474801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9c78f0>]}
[0m13:56:21.256534 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.21s]
[0m13:56:21.256839 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m13:56:21.257507 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.257717 [debug] [MainThread]: On master: BEGIN
[0m13:56:21.257869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:21.261400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:21.261592 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.261745 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:21.261885 [debug] [MainThread]: On master: COMMIT
[0m13:56:21.262060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:21.262206 [debug] [MainThread]: On master: Close
[0m13:56:21.262966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:21.263161 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m13:56:21.263368 [info ] [MainThread]: 
[0m13:56:21.263565 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 20.40 seconds (20.40s).
[0m13:56:21.263991 [debug] [MainThread]: Command end result
[0m13:56:21.292322 [info ] [MainThread]: 
[0m13:56:21.292687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:21.292870 [info ] [MainThread]: 
[0m13:56:21.293068 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:56:21.296161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.856356, "process_user_time": 2.826022, "process_kernel_time": 1.142126, "process_mem_max_rss": "182501376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:56:21.296731 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:21.296671 after 20.86 seconds
[0m13:56:21.297005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f74d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11279c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be3650>]}
[0m13:56:21.297216 [debug] [MainThread]: Flushing usage events
[0m11:58:03.241061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca8d42000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca7028e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6f20aa0>]}


============================== 11:58:03.248191 | 1eb90afa-de04-46a2-8f11-f965027fdde1 ==============================
[0m11:58:03.248191 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:58:03.248843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:03.387580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eb90afa-de04-46a2-8f11-f965027fdde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca76fb290>]}
[0m11:58:03.400796 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q8q_a93p'
[0m11:58:03.401262 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:58:03.475793 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:58:03.476414 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:58:03.499793 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:58:03.503426 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:58:03.573185 [info ] [MainThread]: Installed from version 1.2.0
[0m11:58:03.573685 [info ] [MainThread]: Up to date!
[0m11:58:03.574214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1eb90afa-de04-46a2-8f11-f965027fdde1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6f20aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca7c9d5e0>]}
[0m11:58:03.575485 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3823983, "process_user_time": 1.540696, "process_kernel_time": 0.133096, "process_mem_max_rss": "93492", "process_in_blocks": "5672", "process_out_blocks": "3840"}
[0m11:58:03.576100 [debug] [MainThread]: Command `dbt deps` succeeded at 11:58:03.575997 after 0.38 seconds
[0m11:58:03.576545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca7303380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6ae6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ca6cc69f0>]}
[0m11:58:03.576977 [debug] [MainThread]: Flushing usage events
[0m11:58:05.165675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfee55b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd2cf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd2cf4d0>]}


============================== 11:58:05.168396 | bf957561-8e59-4507-a382-a636972b80b0 ==============================
[0m11:58:05.168396 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:58:05.169085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:58:05.392148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfe25bfe0>]}
[0m11:58:05.449554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfee55b50>]}
[0m11:58:05.450290 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:58:05.473658 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m11:58:05.474371 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:58:05.474936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd0861e0>]}
[0m11:58:06.670941 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:58:06.671598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df5ecbbc0>]}
[0m11:58:06.856672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m11:58:06.861302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df60c92e0>]}
[0m11:58:06.990655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df5c37260>]}
[0m11:58:06.991229 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m11:58:06.991678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df5c4ce60>]}
[0m11:58:06.993523 [info ] [MainThread]: 
[0m11:58:06.994244 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:06.998955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m11:58:07.033522 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m11:58:07.033982 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m11:58:07.034397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:07.579526 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m11:58:07.581201 [debug] [ThreadPool]: On list_petro: Close
[0m11:58:07.583387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m11:58:07.584013 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m11:58:07.590857 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.591308 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m11:58:07.591750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:07.597130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.598449 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.598862 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m11:58:07.599728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.600148 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.600546 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m11:58:07.601103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.602031 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m11:58:07.602446 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m11:58:07.602834 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m11:58:07.603493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.603969 [debug] [ThreadPool]: On create_petro_main: Close
[0m11:58:07.605940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m11:58:07.611216 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m11:58:07.611645 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m11:58:07.612074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:07.616975 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.617400 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m11:58:07.617811 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m11:58:07.637819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:07.642517 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m11:58:07.643720 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m11:58:07.644145 [debug] [ThreadPool]: On list_petro_main: Close
[0m11:58:07.647446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfd3ddb20>]}
[0m11:58:07.648031 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:07.648439 [debug] [MainThread]: On master: BEGIN
[0m11:58:07.648825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:07.653862 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:07.654298 [debug] [MainThread]: On master: COMMIT
[0m11:58:07.654695 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:07.655092 [debug] [MainThread]: On master: COMMIT
[0m11:58:07.655773 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:07.656199 [debug] [MainThread]: On master: Close
[0m11:58:07.657626 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:58:07.658119 [info ] [MainThread]: 
[0m11:58:07.667133 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m11:58:07.667771 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m11:58:07.668404 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m11:58:07.668858 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m11:58:07.694087 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m11:58:07.694834 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m11:58:07.728838 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m11:58:07.729568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:20.335240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.335801 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m11:58:20.336428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.336900 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.337355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m11:58:20.338047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.340760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.341236 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m11:58:20.342068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.362734 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m11:58:20.363224 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.363678 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m11:58:20.365395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.370101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m11:58:20.370579 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m11:58:20.371669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.373983 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m11:58:20.399880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfea8a720>]}
[0m11:58:20.400593 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.73s]
[0m11:58:20.401466 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m11:58:20.402433 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m11:58:20.403000 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m11:58:20.403668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m11:58:20.404174 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m11:58:20.408917 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m11:58:20.409552 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m11:58:20.442294 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.442816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623115820436510"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m11:58:20.443300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:20.459677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.466558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.467033 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m11:58:20.467619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.468102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.468555 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623115820436510'
      
      
      order by ordinal_position

  
[0m11:58:20.495043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.499946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.500439 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m11:58:20.508992 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.517430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.517927 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m11:58:20.526518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.544346 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m11:58:20.545037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.545534 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623115820436510"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623115820436510"
    )
  
[0m11:58:20.557811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.559509 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m11:58:20.560010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m11:58:20.560447 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m11:58:20.571229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:20.572157 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m11:58:20.730632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf957561-8e59-4507-a382-a636972b80b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc9c15640>]}
[0m11:58:20.731428 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m11:58:20.732266 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m11:58:20.733591 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:20.734080 [debug] [MainThread]: On master: BEGIN
[0m11:58:20.734532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:20.739903 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:20.740397 [debug] [MainThread]: On master: COMMIT
[0m11:58:20.740851 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:20.741291 [debug] [MainThread]: On master: COMMIT
[0m11:58:20.741957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:20.742431 [debug] [MainThread]: On master: Close
[0m11:58:20.743973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:20.744437 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m11:58:20.744862 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m11:58:20.745339 [info ] [MainThread]: 
[0m11:58:20.745910 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.75 seconds (13.75s).
[0m11:58:20.746956 [debug] [MainThread]: Command end result
[0m11:58:20.774554 [info ] [MainThread]: 
[0m11:58:20.775231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:20.775816 [info ] [MainThread]: 
[0m11:58:20.776381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:58:20.777407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.660628, "process_user_time": 4.667923, "process_kernel_time": 0.277183, "process_mem_max_rss": "276412", "process_in_blocks": "1184", "process_out_blocks": "109656"}
[0m11:58:20.778070 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:20.777957 after 15.66 seconds
[0m11:58:20.778576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e00dbbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df4971220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dc9baa660>]}
[0m11:58:20.779075 [debug] [MainThread]: Flushing usage events
[0m11:58:22.396565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f4261e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88ffb61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88fb1ad20>]}


============================== 11:58:22.399237 | 001014b8-5f70-43ea-9342-46f2c47cca55 ==============================
[0m11:58:22.399237 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:58:22.399979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:22.547161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '001014b8-5f70-43ea-9342-46f2c47cca55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f05b9b0>]}
[0m11:58:22.563649 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21528837, "process_user_time": 1.396306, "process_kernel_time": 0.112346, "process_mem_max_rss": "92296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:58:22.564278 [debug] [MainThread]: Command `dbt clean` succeeded at 11:58:22.564176 after 0.22 seconds
[0m11:58:22.564731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa892bbbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88ed820c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f3774a0>]}
[0m11:58:22.565171 [debug] [MainThread]: Flushing usage events
[0m14:05:29.796131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9ea67d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9ee85b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9f4a6f60>]}


============================== 14:05:29.803199 | 2af7c019-afb8-4289-8b7b-019084e56bdf ==============================
[0m14:05:29.803199 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.803872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.948789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2af7c019-afb8-4289-8b7b-019084e56bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa01f2030>]}
[0m14:05:29.962120 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x27b7apb'
[0m14:05:29.962588 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:30.034077 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:30.034720 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:30.044487 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:30.048221 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:30.109828 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:30.110333 [info ] [MainThread]: Up to date!
[0m14:05:30.110835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2af7c019-afb8-4289-8b7b-019084e56bdf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e881970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e83ffe0>]}
[0m14:05:30.112250 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.36413231, "process_user_time": 1.489832, "process_kernel_time": 0.191208, "process_mem_max_rss": "93560", "process_in_blocks": "5672", "process_out_blocks": "3848"}
[0m14:05:30.112845 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:30.112741 after 0.36 seconds
[0m14:05:30.113313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9ebc41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9fb93fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e993d70>]}
[0m14:05:30.113748 [debug] [MainThread]: Flushing usage events
[0m14:05:31.691401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d21eda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d25f6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d25f70e0>]}


============================== 14:05:31.694415 | c68646c2-0eb3-4fe2-812a-11c3169b7cd1 ==============================
[0m14:05:31.694415 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.695131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.930002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d1fe6a80>]}
[0m14:05:31.988327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d2613b90>]}
[0m14:05:31.989188 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:05:32.004814 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:32.005594 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:32.006140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d339c170>]}
[0m14:05:33.209653 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:33.210378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb4a4140>]}
[0m14:05:33.399606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:33.404509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb2191c0>]}
[0m14:05:33.533715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb3a0230>]}
[0m14:05:33.534319 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:33.534855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29cb37c9b0>]}
[0m14:05:33.536609 [info ] [MainThread]: 
[0m14:05:33.537362 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:33.542145 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:33.577596 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:33.578096 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"petro"'
    
  
  
[0m14:05:33.578506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:34.131404 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:34.132949 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:34.135358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:34.135951 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:34.142804 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.143263 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where database_name='petro'
        and type='sqlite'
    
  
[0m14:05:34.143678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.149251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.150572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.150980 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:34.151623 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.152028 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.152410 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:34.152991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.153961 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.154372 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.154761 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.155296 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.155718 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:34.157860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:34.163067 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.163493 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:34.163877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.168890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.169355 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.169770 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'petro'
  
[0m14:05:34.189891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.194471 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:34.195642 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:34.196062 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:34.199612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d228b290>]}
[0m14:05:34.200135 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.200539 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.200925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:34.206016 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.206445 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.206849 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.207237 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.207861 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.208282 [debug] [MainThread]: On master: Close
[0m14:05:34.210014 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:34.210510 [info ] [MainThread]: 
[0m14:05:34.219894 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:34.220506 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:34.221258 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:34.221714 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:34.246784 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:34.247536 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:34.281507 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:34.282275 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:49.959786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.960314 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:49.960955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.961465 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.961918 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:49.962602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.965281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.965757 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:49.966585 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.987406 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:49.987904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.988354 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:49.989615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.994309 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:49.994794 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:49.995956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:49.998291 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:50.023681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29c85113a0>]}
[0m14:05:50.024400 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 15.80s]
[0m14:05:50.025197 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:50.026184 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:50.026769 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:50.027343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:50.027818 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:50.032572 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:50.033250 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:50.066179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.066696 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20240623140550060382"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:50.067192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:50.083496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.090343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.090820 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:50.091471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.091933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.092385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20240623140550060382'
      
      
      order by ordinal_position

  
[0m14:05:50.124600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.129429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.129926 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:50.138615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.147176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.147681 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and table_schema = 'main'
      
      
      and table_catalog = 'petro'
      
      order by ordinal_position

  
[0m14:05:50.156039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.173814 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:50.174497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.174977 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20240623140550060382"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20240623140550060382"
    )
  
[0m14:05:50.186742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.188430 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:50.188896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:50.189398 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:50.198699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:50.199553 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:50.371415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68646c2-0eb3-4fe2-812a-11c3169b7cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b1abdd0>]}
[0m14:05:50.372233 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:50.372984 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:50.374421 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.374911 [debug] [MainThread]: On master: BEGIN
[0m14:05:50.375369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:50.380840 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.381374 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.381832 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.382266 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.382953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.383426 [debug] [MainThread]: On master: Close
[0m14:05:50.384959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:50.385456 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:50.385881 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:50.386362 [info ] [MainThread]: 
[0m14:05:50.386970 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 16.85 seconds (16.85s).
[0m14:05:50.388079 [debug] [MainThread]: Command end result
[0m14:05:50.415657 [info ] [MainThread]: 
[0m14:05:50.416389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:50.416998 [info ] [MainThread]: 
[0m14:05:50.417639 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:50.418721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.775753, "process_user_time": 4.772354, "process_kernel_time": 0.284498, "process_mem_max_rss": "275324", "process_in_blocks": "1184", "process_out_blocks": "109664"}
[0m14:05:50.419376 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:50.419265 after 18.78 seconds
[0m14:05:50.419882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d21eda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d2573860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b1e05c0>]}
[0m14:05:50.420383 [debug] [MainThread]: Flushing usage events
[0m14:05:52.023911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8611d55eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf200>]}


============================== 14:05:52.026652 | 600daa58-0ff4-4ca3-ad25-57516a1cc326 ==============================
[0m14:05:52.026652 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:52.027394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:52.168653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '600daa58-0ff4-4ca3-ad25-57516a1cc326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860ff63ce0>]}
[0m14:05:52.184747 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20914142, "process_user_time": 1.453116, "process_kernel_time": 0.064049, "process_mem_max_rss": "92168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:52.185360 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:52.185253 after 0.21 seconds
[0m14:05:52.185806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86104d2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86101cf200>]}
[0m14:05:52.186256 [debug] [MainThread]: Flushing usage events
