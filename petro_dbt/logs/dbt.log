[0m06:02:09.649918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad8e7b0>]}
[0m06:02:09.651722 [info ] [MainThread]: 
[0m06:02:09.652425 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.657165 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.692544 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.693029 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:09.693441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.261445 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.263007 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.265159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.265719 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.272928 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.273363 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.273763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.280185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.281687 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.282088 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.282625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.283017 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.283390 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.283977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.284929 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.285331 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.285703 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.286238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.286642 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.288539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.295660 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.296071 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.296485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.302644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.303059 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.303459 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.327573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.329185 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.330451 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.330870 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.334493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303b80dd0>]}
[0m06:02:10.335038 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.335437 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.335813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.342252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.342680 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343067 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.343443 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343976 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.344414 [debug] [MainThread]: On master: Close
[0m06:02:10.345736 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.346281 [info ] [MainThread]: 
[0m06:02:10.372933 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.373536 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.374273 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.374721 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.400593 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.401345 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.436877 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.437661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:18.192676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.193188 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:18.193857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.194307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.194739 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:18.195442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.198374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.198855 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:18.199531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.220328 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.220827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.221263 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.223188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.228133 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.228625 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:18.229823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.232119 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:18.261362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93034fe930>]}
[0m06:02:18.262116 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.89s]
[0m06:02:18.262874 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:18.263886 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:18.264490 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:18.265076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:18.265531 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:18.270840 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:18.271496 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:18.305170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.305686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027060218299187"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:18.306159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:18.320021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.327426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.327886 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:18.328570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.329034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.329476 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027060218299187'
      
      
      order by ordinal_position

  
[0m06:02:18.349766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.356284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.356796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.360937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.368443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.368929 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.371629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.389509 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:18.390200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.390664 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027060218299187"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027060218299187"
    )
  
[0m06:02:18.422636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.424602 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.425070 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.425492 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.433663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.434559 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:18.626046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b79650d0>]}
[0m06:02:18.626860 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:18.627614 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:18.629128 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.629594 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.630015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:18.637134 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.637802 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.638440 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.639067 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.639938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.640626 [debug] [MainThread]: On master: Close
[0m06:02:18.642446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:18.642881 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:18.643278 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:18.643731 [info ] [MainThread]: 
[0m06:02:18.644274 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m06:02:18.645340 [debug] [MainThread]: Command end result
[0m06:02:18.673207 [info ] [MainThread]: 
[0m06:02:18.673854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:18.674389 [info ] [MainThread]: 
[0m06:02:18.674937 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:18.675949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.988357, "process_user_time": 5.635993, "process_kernel_time": 0.319999, "process_mem_max_rss": "291348", "process_in_blocks": "3808", "process_out_blocks": "116200"}
[0m06:02:18.676626 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:18.676515 after 10.99 seconds
[0m06:02:18.677137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303398590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad60f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9302a747d0>]}
[0m06:02:18.677620 [debug] [MainThread]: Flushing usage events
[0m06:02:20.358883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b792570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c3b60>]}


============================== 06:02:20.361679 | 4262b812-ebd9-4f29-9045-c1575eadd653 ==============================
[0m06:02:20.361679 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.362399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.503733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4262b812-ebd9-4f29-9045-c1575eadd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b6f6b40>]}
[0m06:02:20.520439 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20978114, "process_user_time": 1.4195, "process_kernel_time": 0.087969, "process_mem_max_rss": "92276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:20.521010 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:20.520908 after 0.21 seconds
[0m06:02:20.521433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97ba5f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b1070>]}
[0m06:02:20.521850 [debug] [MainThread]: Flushing usage events
[0m14:05:16.133926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa339460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa45a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa33bf20>]}


============================== 14:05:16.141725 | 78023bc8-b36b-4e15-8dbb-9e1204979c39 ==============================
[0m14:05:16.141725 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.142500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.286222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa00b260>]}
[0m14:05:16.299845 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-099ghjmk'
[0m14:05:16.300322 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.326602 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.327230 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.338031 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.341870 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.557757 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.558339 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.558902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1a2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea9f03d10>]}
[0m14:05:16.559370 [info ] [MainThread]: 
[0m14:05:16.559857 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.561652 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47698292, "process_user_time": 1.583668, "process_kernel_time": 0.134611, "process_mem_max_rss": "93512", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:16.562249 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.562145 after 0.48 seconds
[0m14:05:16.562742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa3371d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1dc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab1b6b40>]}
[0m14:05:16.563165 [debug] [MainThread]: Flushing usage events
[0m14:05:18.540090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7320>]}


============================== 14:05:18.543201 | cefd4d58-25b2-4a5b-9398-c93bead4f291 ==============================
[0m14:05:18.543201 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.543966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.793095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2298e660>]}
[0m14:05:18.853624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29865af0>]}
[0m14:05:18.856407 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.931958 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.932772 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.933327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e298b3800>]}
[0m14:05:20.175385 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:20.176098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227d0350>]}
[0m14:05:20.363487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:20.369172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227331d0>]}
[0m14:05:20.510975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2218fb90>]}
[0m14:05:20.511585 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:20.512131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e222e19a0>]}
[0m14:05:20.514002 [info ] [MainThread]: 
[0m14:05:20.514805 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:20.519774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:20.556651 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:20.557188 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:20.557627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.007736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.009411 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:21.011778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:21.012363 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:21.019736 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.020177 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:21.020622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.027359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.028853 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.029264 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:21.029826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.030221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.030640 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:21.031213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.032133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.032551 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.032925 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.033465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.033873 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:21.036016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:21.043578 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.043991 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:21.044366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.050268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.050726 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.051125 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:21.075283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.077179 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:21.078596 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:21.079048 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:21.083255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2bf11340>]}
[0m14:05:21.083816 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.084226 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.084617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:21.091686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.092129 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.092543 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.092930 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.093567 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.093987 [debug] [MainThread]: On master: Close
[0m14:05:21.095895 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:21.096411 [info ] [MainThread]: 
[0m14:05:21.106564 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:21.107237 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:21.107981 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:21.108445 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:21.135946 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:21.136902 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:21.174126 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:21.175093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:30.068868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.069469 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.070311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.070822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.071273 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.072130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.075574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.076049 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.076828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.100428 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.101171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.101686 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.114045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.120552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.121056 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:30.145156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.149021 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.208242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e221b8a70>]}
[0m14:05:30.209234 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.10s]
[0m14:05:30.210238 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.211494 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.212410 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.213314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.213879 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.223198 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.224161 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.268421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.269063 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027140530261605"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.269580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.287902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.296323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.296837 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.297567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.298034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.298505 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027140530261605'
      
      
      order by ordinal_position

  
[0m14:05:30.323366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.334147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.334937 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.339807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.351373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.351860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.354832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.373289 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.374027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.374561 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027140530261605"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027140530261605"
    )
  
[0m14:05:30.411051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.413283 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.413799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.414246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.561348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.562508 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:30.754709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d56b40>]}
[0m14:05:30.755538 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.54s]
[0m14:05:30.756296 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:30.757739 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.758217 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.758757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:30.765582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.766063 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.766542 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.766967 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.767586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.768038 [debug] [MainThread]: On master: Close
[0m14:05:30.769509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:30.769940 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:30.770339 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:30.770884 [info ] [MainThread]: 
[0m14:05:30.771481 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m14:05:30.772614 [debug] [MainThread]: Command end result
[0m14:05:30.801005 [info ] [MainThread]: 
[0m14:05:30.801753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:30.802365 [info ] [MainThread]: 
[0m14:05:30.803009 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:30.804135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.313357, "process_user_time": 5.773754, "process_kernel_time": 0.323874, "process_mem_max_rss": "302296", "process_in_blocks": "3808", "process_out_blocks": "116696"}
[0m14:05:30.804785 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:30.804673 after 12.31 seconds
[0m14:05:30.805288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29eb4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d9f7a0>]}
[0m14:05:30.805783 [debug] [MainThread]: Flushing usage events
[0m14:05:32.764828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962660>]}


============================== 14:05:32.767764 | 71eccba0-e1bc-4284-8aef-e2ee42a7aeeb ==============================
[0m14:05:32.767764 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.768481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.908977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71eccba0-e1bc-4284-8aef-e2ee42a7aeeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fb3b200>]}
[0m14:05:32.925760 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20939516, "process_user_time": 1.402786, "process_kernel_time": 0.107906, "process_mem_max_rss": "92196", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:32.926347 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:32.926246 after 0.21 seconds
[0m14:05:32.926826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57406c8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fa0fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9aa060>]}
[0m14:05:32.927248 [debug] [MainThread]: Flushing usage events
[0m22:06:37.818970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd1479340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd185d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3822270>]}


============================== 22:06:37.826466 | 90ac5466-6416-4b1c-85b1-1e85a1d0e0ad ==============================
[0m22:06:37.826466 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.827200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.979993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd147bd40>]}
[0m22:06:37.994808 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mnavaskj'
[0m22:06:37.995340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:38.062625 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:38.063472 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:38.098596 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:38.102810 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:38.462267 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:38.462926 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:38.463490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12afc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12ac3e0>]}
[0m22:06:38.463984 [info ] [MainThread]: 
[0m22:06:38.464510 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:38.466498 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6955928, "process_user_time": 1.603294, "process_kernel_time": 0.140288, "process_mem_max_rss": "93640", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:38.467094 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:38.466989 after 0.70 seconds
[0m22:06:38.467535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd18ea360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd11efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd117e7e0>]}
[0m22:06:38.467969 [debug] [MainThread]: Flushing usage events
[0m22:06:40.277643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219afef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219cb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219af6b0>]}


============================== 22:06:40.280812 | 33dad61b-4949-4309-8e77-a24b0795d7a0 ==============================
[0m22:06:40.280812 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:40.281603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:40.546518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa320ef8410>]}
[0m22:06:40.609342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321abfef0>]}
[0m22:06:40.612131 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:40.632020 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:40.632875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:40.633460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321c05af0>]}
[0m22:06:41.875403 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.876121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31987a000>]}
[0m22:06:42.059627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:42.065035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319f3ad80>]}
[0m22:06:42.193864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3197a8440>]}
[0m22:06:42.194451 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:42.194931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319817ce0>]}
[0m22:06:42.196701 [info ] [MainThread]: 
[0m22:06:42.197466 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:42.202403 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:42.238996 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:42.239516 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:42.239922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.932482 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:42.934054 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.936259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.936887 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.944032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.944502 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.944898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.951491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.953061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.953476 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.954021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.954423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.954799 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.955418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.956386 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.956786 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.957159 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.957699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.958106 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.960208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.967557 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.967981 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.968397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.974563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.974999 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.975403 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.999698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:43.001525 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:43.002845 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:43.003264 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:43.007359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3215ff860>]}
[0m22:06:43.007903 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.008343 [debug] [MainThread]: On master: BEGIN
[0m22:06:43.008740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:43.016047 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.016639 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.017044 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.017436 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.018005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.018436 [debug] [MainThread]: On master: Close
[0m22:06:43.020478 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:43.021041 [info ] [MainThread]: 
[0m22:06:43.030895 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:43.031554 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:43.032269 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:43.032768 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:43.060219 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:43.061163 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:43.098459 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:43.099537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:54.141664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.142226 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.142945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.143402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.143843 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.144705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.147879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.148383 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.149198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.171129 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.171738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.172198 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.175132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.180832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.181370 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:54.182898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.185439 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.216838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31970bb00>]}
[0m22:06:54.217685 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.18s]
[0m22:06:54.218484 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.219513 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.220082 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.220817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.221283 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.226786 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.227500 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.262615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.263238 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027220654256372"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.263725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.279952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.288496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.289063 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.289882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.290335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.290781 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027220654256372'
      
      
      order by ordinal_position

  
[0m22:06:54.312563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.319878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.320447 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.323597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.331691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.332216 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.335620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.354596 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.355433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.355923 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027220654256372"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027220654256372"
    )
  
[0m22:06:54.389710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.391779 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.392246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.392704 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.402481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.403507 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:55.415250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de439610>]}
[0m22:06:55.416103 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 1.19s]
[0m22:06:55.416903 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:55.418423 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.418930 [debug] [MainThread]: On master: BEGIN
[0m22:06:55.419397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:55.426669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.427244 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.427692 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.428122 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.428761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.429217 [debug] [MainThread]: On master: Close
[0m22:06:55.430946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:55.431384 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:55.431787 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:55.432256 [info ] [MainThread]: 
[0m22:06:55.432907 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.23 seconds (13.23s).
[0m22:06:55.434057 [debug] [MainThread]: Command end result
[0m22:06:55.462748 [info ] [MainThread]: 
[0m22:06:55.463515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:55.464121 [info ] [MainThread]: 
[0m22:06:55.464761 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:55.465895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.238665, "process_user_time": 6.932973, "process_kernel_time": 0.301608, "process_mem_max_rss": "356188", "process_in_blocks": "3808", "process_out_blocks": "130560"}
[0m22:06:55.466559 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:55.466442 after 15.24 seconds
[0m22:06:55.467080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3214d7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32160c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de4d2f60>]}
[0m22:06:55.467567 [debug] [MainThread]: Flushing usage events
[0m22:06:57.437108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375f860>]}


============================== 22:06:57.440420 | f3b777d2-4608-4fbe-ac6d-442a18d0d0d2 ==============================
[0m22:06:57.440420 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:57.441225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:57.601557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b777d2-4608-4fbe-ac6d-442a18d0d0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e2c5f710>]}
[0m22:06:57.619386 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23291159, "process_user_time": 1.489889, "process_kernel_time": 0.100126, "process_mem_max_rss": "91996", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:57.620025 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:57.619911 after 0.23 seconds
[0m22:06:57.620553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e32497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e31f3980>]}
[0m22:06:57.621025 [debug] [MainThread]: Flushing usage events
[0m06:02:18.359027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1569605d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15695a1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567f94fe0>]}


============================== 06:02:18.367875 | c20095a7-de61-4d0b-86b7-e546f68a3dc1 ==============================
[0m06:02:18.367875 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.368546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.506673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20095a7-de61-4d0b-86b7-e546f68a3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156704ae70>]}
[0m06:02:18.520055 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8g6ssrag'
[0m06:02:18.520511 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:18.585227 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:18.585906 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:18.609355 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:18.613273 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:18.686458 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:18.686971 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:18.687480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c20095a7-de61-4d0b-86b7-e546f68a3dc1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1566f04e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567235280>]}
[0m06:02:18.687964 [info ] [MainThread]: 
[0m06:02:18.688445 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:18.712703 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4020372, "process_user_time": 1.556321, "process_kernel_time": 0.132709, "process_mem_max_rss": "93536", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:18.713299 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:18.713195 after 0.40 seconds
[0m06:02:18.713734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156761d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156709fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15673b4a70>]}
[0m06:02:18.714163 [debug] [MainThread]: Flushing usage events
[0m06:02:20.269689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b2ee120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10898fdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10898fcb00>]}


============================== 06:02:20.272646 | 73826b8e-2dee-4ff6-966e-395ab8ee36d9 ==============================
[0m06:02:20.272646 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.273297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.510547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088d69880>]}
[0m06:02:20.569138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10892c8320>]}
[0m06:02:20.571617 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:20.593170 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:20.593909 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:20.594447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081d2fb90>]}
[0m06:02:21.818318 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:21.818975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088df49b0>]}
[0m06:02:21.998149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:22.003079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081bf06e0>]}
[0m06:02:22.133076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10816a3200>]}
[0m06:02:22.133654 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:22.134137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108172ba70>]}
[0m06:02:22.135823 [info ] [MainThread]: 
[0m06:02:22.136482 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:22.141288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:22.176435 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:22.176876 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:22.177277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:22.540197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.541832 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:22.544257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:22.544854 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:22.552162 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.552602 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:22.552993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.559537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.561020 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.561434 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:22.561976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.562368 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.562746 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:22.563306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.564247 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.564653 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.565029 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.565550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.565956 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:22.568074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.574509 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.574922 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.575292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.581009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.581414 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.581804 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:22.603795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.605251 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.606439 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.606838 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.610088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108c4268a0>]}
[0m06:02:22.610603 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.610991 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.611358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.617832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.618254 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.618652 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.619028 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.619553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.620001 [debug] [MainThread]: On master: Close
[0m06:02:22.621406 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.621949 [info ] [MainThread]: 
[0m06:02:22.636945 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:22.637537 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:22.638262 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:22.638716 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:22.665045 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:22.665809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:22.701619 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:22.702361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:29.756974 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.757477 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:29.758127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.758592 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.759029 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:29.759760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.762599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.763053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:29.763755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.784649 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.785127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.785568 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.787100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.792068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.792535 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:29.793668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.795986 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:29.825065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088cc2060>]}
[0m06:02:29.825768 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.19s]
[0m06:02:29.826537 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:29.827490 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:29.828079 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:29.828652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:29.829115 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:29.834081 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:29.834728 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.868053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.868559 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028060229862204"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.869037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.883587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.890959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.891434 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.892079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.892520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.892970 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028060229862204'
      
      
      order by ordinal_position

  
[0m06:02:29.915824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.921889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.922385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.925185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.932645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.933121 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.936011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.953642 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.954335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.954797 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028060229862204"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028060229862204"
    )
  
[0m06:02:29.984503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.986490 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.986946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.987370 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.995603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.996522 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:30.136153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10422ec8c0>]}
[0m06:02:30.136968 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:30.137720 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:30.139189 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.139666 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.140141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:30.146992 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.147469 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.147950 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.148377 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.148956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.149409 [debug] [MainThread]: On master: Close
[0m06:02:30.150854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:30.151291 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:30.151743 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:30.152241 [info ] [MainThread]: 
[0m06:02:30.152753 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m06:02:30.153745 [debug] [MainThread]: Command end result
[0m06:02:30.181928 [info ] [MainThread]: 
[0m06:02:30.182587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:30.183093 [info ] [MainThread]: 
[0m06:02:30.183612 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:30.184681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.96344, "process_user_time": 4.969685, "process_kernel_time": 0.314839, "process_mem_max_rss": "297320", "process_in_blocks": "3808", "process_out_blocks": "112624"}
[0m06:02:30.185331 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:30.185219 after 9.96 seconds
[0m06:02:30.185826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b2ee120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088f3a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104214e510>]}
[0m06:02:30.186313 [debug] [MainThread]: Flushing usage events
[0m06:02:31.831184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e627140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e6269c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d7d2570>]}


============================== 06:02:31.834361 | 2ee77072-d821-4900-9789-821437692a7a ==============================
[0m06:02:31.834361 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.835114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.993074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ee77072-d821-4900-9789-821437692a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d562240>]}
[0m06:02:32.009945 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22726344, "process_user_time": 1.442231, "process_kernel_time": 0.095882, "process_mem_max_rss": "92276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:32.010536 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:32.010433 after 0.23 seconds
[0m06:02:32.010980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d611bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d57bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e5c5070>]}
[0m06:02:32.011409 [debug] [MainThread]: Flushing usage events
[0m14:05:43.781127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d9c3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e491160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333dc9c770>]}


============================== 14:05:43.799641 | 454ab71b-5d52-4fe9-a35a-634712aa6b74 ==============================
[0m14:05:43.799641 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:43.800427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:43.961611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '454ab71b-5d52-4fe9-a35a-634712aa6b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d3e8230>]}
[0m14:05:43.976818 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wktfb13p'
[0m14:05:43.977353 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:44.104878 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:44.105759 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:44.179463 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:44.183914 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:44.360156 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:44.360838 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:44.361424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '454ab71b-5d52-4fe9-a35a-634712aa6b74', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d3e8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d54bdd0>]}
[0m14:05:44.361927 [info ] [MainThread]: 
[0m14:05:44.362433 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:44.390756 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.661077, "process_user_time": 1.735637, "process_kernel_time": 0.107977, "process_mem_max_rss": "93768", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:44.391570 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:44.391446 after 0.66 seconds
[0m14:05:44.392072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333ec21640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d8c9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d861730>]}
[0m14:05:44.392542 [debug] [MainThread]: Flushing usage events
[0m14:05:46.156727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6426540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6e3e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e8795d00>]}


============================== 14:05:46.159939 | ca1f2f26-aca7-4c38-9221-1bfdeee532f7 ==============================
[0m14:05:46.159939 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:46.160693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.425161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e61f8aa0>]}
[0m14:05:46.487802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e64f26c0>]}
[0m14:05:46.490644 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:46.516229 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:46.517081 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:46.517629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df342b40>]}
[0m14:05:47.829796 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:47.830516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dedb0b60>]}
[0m14:05:48.026393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:48.032360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ded3e660>]}
[0m14:05:48.199016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77deb6c7a0>]}
[0m14:05:48.199639 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:48.200193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dec256a0>]}
[0m14:05:48.202160 [info ] [MainThread]: 
[0m14:05:48.202970 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:48.208117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:48.247755 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:48.248342 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:48.248820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:48.768037 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:48.769813 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:48.772266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:48.772943 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:48.780676 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.781206 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:48.781624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.788873 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.790570 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.790992 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:48.791579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.791981 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.792396 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:48.793019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.794009 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.794436 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.794828 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.795396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.795823 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:48.798396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:48.806394 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.806841 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:48.807246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.814053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.814530 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.814952 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:48.839235 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.841053 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:48.842431 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:48.842878 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:48.847005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6d6c6e0>]}
[0m14:05:48.847601 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.848029 [debug] [MainThread]: On master: BEGIN
[0m14:05:48.848428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:48.855524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.856006 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.856417 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.856869 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.857473 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.857912 [debug] [MainThread]: On master: Close
[0m14:05:48.859999 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:48.860565 [info ] [MainThread]: 
[0m14:05:48.879979 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:48.880705 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:48.881552 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:48.882035 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:48.909454 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:48.910364 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:48.948134 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:48.949183 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:56.930571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.931174 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:56.932051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.932549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.933060 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:56.933960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.937499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.937981 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:56.938789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.961034 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.961640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.962109 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.963776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.969644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.970155 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:56.971552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.974183 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:57.006216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77decc08c0>]}
[0m14:05:57.007157 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.12s]
[0m14:05:57.007987 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:57.009092 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:57.009714 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:57.010389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:57.010883 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:57.016725 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:57.017547 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:57.053973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.054602 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028140557047475"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:57.055105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:57.071428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.079986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.080502 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:57.081243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.081711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.082157 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028140557047475'
      
      
      order by ordinal_position

  
[0m14:05:57.105092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.112743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.113364 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:57.117315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.126028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.126562 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:57.129934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.149054 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:57.149908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.150420 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028140557047475"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028140557047475"
    )
  
[0m14:05:57.183889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.186207 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:57.186761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.187250 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:57.196562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.197629 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:57.337692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f779b420d40>]}
[0m14:05:57.338585 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:05:57.339395 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:57.340971 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.341583 [debug] [MainThread]: On master: BEGIN
[0m14:05:57.342121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:57.349793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.350375 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.350839 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.351288 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.351913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.352399 [debug] [MainThread]: On master: Close
[0m14:05:57.354457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:57.354918 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:57.355341 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:57.355854 [info ] [MainThread]: 
[0m14:05:57.356484 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m14:05:57.357739 [debug] [MainThread]: Command end result
[0m14:05:57.388195 [info ] [MainThread]: 
[0m14:05:57.389036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:57.389584 [info ] [MainThread]: 
[0m14:05:57.390138 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:57.391288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.286792, "process_user_time": 5.839365, "process_kernel_time": 0.391421, "process_mem_max_rss": "281868", "process_in_blocks": "3808", "process_out_blocks": "112616"}
[0m14:05:57.391992 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:57.391870 after 11.29 seconds
[0m14:05:57.392522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e69639e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e69a21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e61f8560>]}
[0m14:05:57.393075 [debug] [MainThread]: Flushing usage events
[0m14:05:59.320466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fd5ffec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fda0bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fda0a870>]}


============================== 14:05:59.323774 | 46d2110e-44fd-4b6b-8cbf-c6fa57daab8a ==============================
[0m14:05:59.323774 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:59.324510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:59.488817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d2110e-44fd-4b6b-8cbf-c6fa57daab8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcf0bce0>]}
[0m14:05:59.507518 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23926263, "process_user_time": 1.571253, "process_kernel_time": 0.08396, "process_mem_max_rss": "92252", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:59.508167 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:59.508051 after 0.24 seconds
[0m14:05:59.508643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcf5f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fce5f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcef2ed0>]}
[0m14:05:59.509163 [debug] [MainThread]: Flushing usage events
[0m22:05:38.658088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54406d3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5441648440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544073f830>]}


============================== 22:05:38.665394 | b1329918-f83e-4a5d-bf4e-a180b24ce659 ==============================
[0m22:05:38.665394 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.666087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.803293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1329918-f83e-4a5d-bf4e-a180b24ce659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fbbae70>]}
[0m22:05:38.816893 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u8ddbmzd'
[0m22:05:38.817357 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:38.869130 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:38.869807 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:38.892432 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:38.896331 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:38.994011 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:38.994622 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:38.995248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b1329918-f83e-4a5d-bf4e-a180b24ce659', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fb4b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fa4d6d0>]}
[0m22:05:38.995751 [info ] [MainThread]: 
[0m22:05:38.996285 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:38.998117 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3881039, "process_user_time": 1.530194, "process_kernel_time": 0.149385, "process_mem_max_rss": "93508", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:38.998722 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:38.998618 after 0.39 seconds
[0m22:05:38.999162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544016c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5440af9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544073f830>]}
[0m22:05:38.999586 [debug] [MainThread]: Flushing usage events
[0m22:05:40.611452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002fa97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9003e21910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9003e230e0>]}


============================== 22:05:40.614428 | edb8cd76-1e0e-46db-bcb7-e9820d35e989 ==============================
[0m22:05:40.614428 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.615175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.853051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002da64b0>]}
[0m22:05:40.912515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002e45370>]}
[0m22:05:40.915132 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:40.937314 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:40.938057 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:40.938576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90039b6de0>]}
[0m22:05:42.172007 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:42.172654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb8f35c0>]}
[0m22:05:42.352392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:42.357589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb92b020>]}
[0m22:05:42.481000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb8d83b0>]}
[0m22:05:42.481565 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:42.482071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb6920c0>]}
[0m22:05:42.483770 [info ] [MainThread]: 
[0m22:05:42.484453 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:42.489232 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:42.524802 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:42.525271 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:42.525668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.138197 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:43.139806 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:43.141963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:43.142515 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:43.149724 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.150154 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:43.150544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.157071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.158565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.158965 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:43.159582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.160003 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.160381 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:43.160952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.161880 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.162288 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.162663 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.163199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.163603 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:43.165716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:43.173081 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.173502 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:43.173870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.180152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.180561 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.180958 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:43.204925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.206515 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:43.207763 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:43.208166 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:43.212047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb7dbdd0>]}
[0m22:05:43.212590 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.212990 [debug] [MainThread]: On master: BEGIN
[0m22:05:43.213368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:43.219974 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.220406 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.220800 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.221173 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.221712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.222119 [debug] [MainThread]: On master: Close
[0m22:05:43.223732 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:43.224229 [info ] [MainThread]: 
[0m22:05:43.233892 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:43.234510 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:43.235146 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:43.235585 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:43.261552 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:43.262395 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:43.297929 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:43.298749 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:50.066806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.067328 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:50.068038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.068496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.068943 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:50.069651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.072575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.073034 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:50.073717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.094460 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:50.094943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.095388 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:50.097609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.102648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.103115 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:50.104532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.106880 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:50.137412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900445a150>]}
[0m22:05:50.138216 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.90s]
[0m22:05:50.138984 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:50.139990 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:50.140560 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:50.141139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:50.141598 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:50.146942 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:50.147619 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:50.181636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.182168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028220550175642"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:50.182641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:50.198174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.206275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.206756 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:50.207427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.207917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.208361 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028220550175642'
      
      
      order by ordinal_position

  
[0m22:05:50.229210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.235641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.236176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:50.239370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.247207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.247684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:50.250561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.268531 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:50.269300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.269774 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028220550175642"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028220550175642"
    )
  
[0m22:05:50.298689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.300704 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:50.301159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.301580 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:50.309703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.310596 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:50.451578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc12d0200>]}
[0m22:05:50.452426 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m22:05:50.453170 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:50.454649 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.455117 [debug] [MainThread]: On master: BEGIN
[0m22:05:50.455545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:50.462423 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.462901 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.463328 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.463776 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.464359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.464799 [debug] [MainThread]: On master: Close
[0m22:05:50.466280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:50.466715 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:50.467117 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:50.467569 [info ] [MainThread]: 
[0m22:05:50.468189 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m22:05:50.469276 [debug] [MainThread]: Command end result
[0m22:05:50.496958 [info ] [MainThread]: 
[0m22:05:50.497662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:50.498267 [info ] [MainThread]: 
[0m22:05:50.498858 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:50.499994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.936945, "process_user_time": 5.479856, "process_kernel_time": 0.311991, "process_mem_max_rss": "287164", "process_in_blocks": "3808", "process_out_blocks": "113160"}
[0m22:05:50.500666 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:50.500553 after 9.94 seconds
[0m22:05:50.501161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90038fc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc0216090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffa4807a0>]}
[0m22:05:50.501664 [debug] [MainThread]: Flushing usage events
[0m22:05:52.196621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d254ca900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2539fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d26915550>]}


============================== 22:05:52.199505 | e335a262-b8c2-4cbc-974f-c79ee515e094 ==============================
[0m22:05:52.199505 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.200259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.348253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e335a262-b8c2-4cbc-974f-c79ee515e094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d251026c0>]}
[0m22:05:52.365379 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21789801, "process_user_time": 1.404242, "process_kernel_time": 0.136023, "process_mem_max_rss": "92388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:52.365981 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:52.365877 after 0.22 seconds
[0m22:05:52.366432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d251026c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d24d4b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d24e5cc50>]}
[0m22:05:52.366873 [debug] [MainThread]: Flushing usage events
[0m06:02:05.874699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618a92420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618a90e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61874de20>]}


============================== 06:02:05.893234 | 1fc0631d-75df-47e4-9d2e-ae5618b5a5d6 ==============================
[0m06:02:05.893234 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.893872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.033358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fc0631d-75df-47e4-9d2e-ae5618b5a5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61831d580>]}
[0m06:02:06.047041 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_msqsnw1'
[0m06:02:06.047532 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:06.108637 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:06.109380 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.119567 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.123504 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.170299 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.170888 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:06.171461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1fc0631d-75df-47e4-9d2e-ae5618b5a5d6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61808bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61808bbf0>]}
[0m06:02:06.171932 [info ] [MainThread]: 
[0m06:02:06.172387 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:06.179134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35275716, "process_user_time": 1.568156, "process_kernel_time": 0.130002, "process_mem_max_rss": "93900", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:06.179878 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.179770 after 0.35 seconds
[0m06:02:06.180319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618d545c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618587bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6197d06e0>]}
[0m06:02:06.180753 [debug] [MainThread]: Flushing usage events
[0m06:02:07.742006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470265a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8ec380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8ed2b0>]}


============================== 06:02:07.744856 | b76403ca-1e77-4730-8cf1-a90ddf729293 ==============================
[0m06:02:07.744856 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.745555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.977242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f63b590>]}
[0m06:02:08.036224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470adbec0>]}
[0m06:02:08.038637 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:08.074822 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.075554 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.076085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f692e70>]}
[0m06:02:09.311566 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:09.312222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f63afc0>]}
[0m06:02:09.493636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:09.498648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64682e9d60>]}
[0m06:02:09.617822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64680588c0>]}
[0m06:02:09.618375 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:09.618874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64682cb470>]}
[0m06:02:09.620603 [info ] [MainThread]: 
[0m06:02:09.621293 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.626211 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.661656 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.662104 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:09.662508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.226649 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.228280 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.230511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.231101 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.238472 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.238909 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.239334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.245839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.247352 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.247765 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.248324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.248721 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.249098 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.249676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.250597 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.250999 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.251405 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.251946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.252352 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.254399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.261642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.262062 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.262437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.268396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.268819 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.269280 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.294420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.296101 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.297382 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.297807 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.301642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6468041250>]}
[0m06:02:10.302177 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.302582 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.302961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.309589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.310030 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.310424 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.310805 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.311367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.311778 [debug] [MainThread]: On master: Close
[0m06:02:10.313471 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.313965 [info ] [MainThread]: 
[0m06:02:10.329825 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.330458 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.331130 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.331634 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.358185 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.359029 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.396225 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.397147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:19.112879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.113397 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:19.114027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.114478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.114914 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:19.115747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.118575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.119026 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:19.119820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.140907 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.141441 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.141882 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.143101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.148206 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.148679 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:19.150171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.152637 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:19.182112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470d2f920>]}
[0m06:02:19.182869 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.85s]
[0m06:02:19.183673 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:19.184677 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:19.185242 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:19.185807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:19.186260 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:19.191587 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:19.192257 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:19.226190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.226699 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029060219220278"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:19.227186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:19.241483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.249053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.249520 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:19.250117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.250569 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.251006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029060219220278'
      
      
      order by ordinal_position

  
[0m06:02:19.271620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.277827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.278304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.281510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.290225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.290913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.295071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.320612 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:19.321525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.322196 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029060219220278"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029060219220278"
    )
  
[0m06:02:19.361662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.364610 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.365231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.365863 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.374679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.375971 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.524689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64248bf920>]}
[0m06:02:19.525518 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:19.526258 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.527631 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.528104 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.528529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.535183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.535692 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.536133 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.536557 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.537150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.537609 [debug] [MainThread]: On master: Close
[0m06:02:19.538946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.539438 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.539848 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.540305 [info ] [MainThread]: 
[0m06:02:19.540816 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m06:02:19.541815 [debug] [MainThread]: Command end result
[0m06:02:19.570216 [info ] [MainThread]: 
[0m06:02:19.570846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.571401 [info ] [MainThread]: 
[0m06:02:19.571939 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.572962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.879456, "process_user_time": 5.548978, "process_kernel_time": 0.387509, "process_mem_max_rss": "291988", "process_in_blocks": "3808", "process_out_blocks": "114152"}
[0m06:02:19.573638 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.573523 after 11.88 seconds
[0m06:02:19.574145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6471bd8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646fd3c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8a76b0>]}
[0m06:02:19.574643 [debug] [MainThread]: Flushing usage events
[0m06:02:21.187484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccce570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539cccdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccce3f0>]}


============================== 06:02:21.190278 | 1b9b4c32-9f56-4c57-9946-8b2f5078bbad ==============================
[0m06:02:21.190278 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.191018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.335199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b9b4c32-9f56-4c57-9946-8b2f5078bbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccfef60>]}
[0m06:02:21.351940 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21317771, "process_user_time": 1.417532, "process_kernel_time": 0.099826, "process_mem_max_rss": "92252", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:21.352514 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:21.352410 after 0.21 seconds
[0m06:02:21.352952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539cca58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ca5fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539c97ae10>]}
[0m06:02:21.353369 [debug] [MainThread]: Flushing usage events
[0m14:05:10.367174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae49f647d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a3334d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a332ba0>]}


============================== 14:05:10.451220 | 292209e1-b5ab-4cce-9172-a518335c84bd ==============================
[0m14:05:10.451220 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.451882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.600081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '292209e1-b5ab-4cce-9172-a518335c84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a57dd60>]}
[0m14:05:10.614301 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pa36i0j9'
[0m14:05:10.614790 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:10.668567 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:10.669285 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:10.683746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:10.687715 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:10.741294 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:10.741936 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:10.742547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '292209e1-b5ab-4cce-9172-a518335c84bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae498acc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae498ac5c0>]}
[0m14:05:10.743008 [info ] [MainThread]: 
[0m14:05:10.743523 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:10.753908 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43490958, "process_user_time": 1.555751, "process_kernel_time": 0.154387, "process_mem_max_rss": "93584", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:10.754633 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:10.754508 after 0.44 seconds
[0m14:05:10.755088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae49cc61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4ab5e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a8f9fa0>]}
[0m14:05:10.755517 [debug] [MainThread]: Flushing usage events
[0m14:05:12.355713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60e8fca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60dfb2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60e3cfe00>]}


============================== 14:05:12.358735 | fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd ==============================
[0m14:05:12.358735 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.359404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.598903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60dcb7740>]}
[0m14:05:12.659096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60ddf55e0>]}
[0m14:05:12.661748 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:12.688183 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:12.688919 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:12.689445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6113e20f0>]}
[0m14:05:13.949441 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:13.950152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606df2b40>]}
[0m14:05:14.134732 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:14.140036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60680a6f0>]}
[0m14:05:14.297145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60688aab0>]}
[0m14:05:14.297773 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:14.298269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606603740>]}
[0m14:05:14.300008 [info ] [MainThread]: 
[0m14:05:14.300725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:14.305735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:14.342693 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:14.343190 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:14.343600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.986012 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.987583 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.989812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.990369 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.997462 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.997923 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:14.998316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.004695 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.006227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.006642 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:15.007194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.007586 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.007958 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:15.008517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.009431 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.009878 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.010257 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.010794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.011209 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:15.013263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:15.020534 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.020948 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:15.021324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.028039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.028459 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.028853 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:15.052772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.054443 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:15.055705 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:15.056121 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:15.059729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606730c20>]}
[0m14:05:15.060280 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.060676 [debug] [MainThread]: On master: BEGIN
[0m14:05:15.061074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:15.067638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.068068 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.068458 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.068834 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.069414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.069870 [debug] [MainThread]: On master: Close
[0m14:05:15.071293 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:15.071829 [info ] [MainThread]: 
[0m14:05:15.087772 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:15.088393 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:15.089135 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:15.089610 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.115770 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.116579 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.152099 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.152921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:22.230115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.230647 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:22.231293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.231740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.232177 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:22.232904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.235896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.236351 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:22.237141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.258084 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.258584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.259032 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.260280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.265344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.265829 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:22.267171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.269533 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:22.300366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606691eb0>]}
[0m14:05:22.301208 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.21s]
[0m14:05:22.302130 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:22.303163 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:22.303731 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:22.304417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:22.304877 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:22.310315 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:22.310997 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:22.344927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.345495 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029140522338961"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:22.346002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:22.363044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.371204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.371692 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:22.372368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.372812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.373243 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029140522338961'
      
      
      order by ordinal_position

  
[0m14:05:22.394917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.402421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.402957 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.406005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.413906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.414393 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.417309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.435559 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:22.436339 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.436818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029140522338961"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029140522338961"
    )
  
[0m14:05:22.471605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.473776 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.474292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.474743 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.483075 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.484011 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:22.639918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bf18a870>]}
[0m14:05:22.640804 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:22.641779 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:22.643471 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.643952 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.644386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:22.651501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.652000 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.652436 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.652851 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.653459 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.653958 [debug] [MainThread]: On master: Close
[0m14:05:22.655819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:22.656257 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:22.656661 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:22.657124 [info ] [MainThread]: 
[0m14:05:22.657749 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m14:05:22.658894 [debug] [MainThread]: Command end result
[0m14:05:22.687959 [info ] [MainThread]: 
[0m14:05:22.688675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:22.689275 [info ] [MainThread]: 
[0m14:05:22.689903 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:22.691037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.384087, "process_user_time": 5.714859, "process_kernel_time": 0.401391, "process_mem_max_rss": "294364", "process_in_blocks": "3808", "process_out_blocks": "114152"}
[0m14:05:22.691689 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:22.691574 after 10.38 seconds
[0m14:05:22.692197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60df49f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60efaa570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60f3534a0>]}
[0m14:05:22.692687 [debug] [MainThread]: Flushing usage events
[0m14:05:24.418543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb815610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cc2f5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ca8fc7d0>]}


============================== 14:05:24.421379 | 4fd3362d-e9d3-472c-a9cb-212b66df31cc ==============================
[0m14:05:24.421379 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.422053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.564935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd3362d-e9d3-472c-a9cb-212b66df31cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9fad580>]}
[0m14:05:24.581814 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21180631, "process_user_time": 1.422238, "process_kernel_time": 0.087891, "process_mem_max_rss": "91988", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:24.582399 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:24.582296 after 0.21 seconds
[0m14:05:24.582837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9fd21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9d62b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9d7bfe0>]}
[0m14:05:24.583273 [debug] [MainThread]: Flushing usage events
[0m22:05:57.746303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12f22bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ef7f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12f9c8140>]}


============================== 22:05:57.772972 | 25706527-9c62-458e-9755-fb3b7007d402 ==============================
[0m22:05:57.772972 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:57.773618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.913991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25706527-9c62-458e-9755-fb3b7007d402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ed95fd0>]}
[0m22:05:57.927147 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2bglhr2j'
[0m22:05:57.927603 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:58.029304 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:58.029996 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:58.062140 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:58.066049 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:58.449277 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:58.449838 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:58.450371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '25706527-9c62-458e-9755-fb3b7007d402', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ecc3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ed06e70>]}
[0m22:05:58.450858 [info ] [MainThread]: 
[0m22:05:58.451336 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:58.470990 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.77256787, "process_user_time": 1.507564, "process_kernel_time": 0.183946, "process_mem_max_rss": "93800", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:58.471681 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:58.471577 after 0.77 seconds
[0m22:05:58.472119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12f22bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12efc5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ee25b50>]}
[0m22:05:58.472550 [debug] [MainThread]: Flushing usage events
[0m22:06:00.193745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf3451f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290d3d0>]}


============================== 22:06:00.196518 | cdb16e28-fbc7-4be0-8730-f3c8f8873f08 ==============================
[0m22:06:00.196518 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:00.197220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:00.428046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf299faa0>]}
[0m22:06:00.486932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf29ab770>]}
[0m22:06:00.489358 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:00.531852 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:00.532567 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:00.533102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290fa40>]}
[0m22:06:01.754999 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:01.755671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf2894230>]}
[0m22:06:01.936875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:01.941954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf3f57290>]}
[0m22:06:02.060270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdeb2bf260>]}
[0m22:06:02.060822 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:02.061367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdeb3e9040>]}
[0m22:06:02.063134 [info ] [MainThread]: 
[0m22:06:02.063850 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:02.068770 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:02.103990 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:02.104437 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:02.104834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:03.431608 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:03.433174 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:03.435366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:03.435930 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:03.443130 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.443562 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:03.443952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:03.450291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.451743 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.452145 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:03.452693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.453089 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.453465 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:03.454040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.455004 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:03.455423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.455800 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:03.456328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.456728 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:03.458574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:03.465594 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:03.466006 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:03.466373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:03.472197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.472615 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:03.473007 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:03.496246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.497674 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:03.498880 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:03.499284 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:03.502422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdeb3e8a70>]}
[0m22:06:03.502973 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.503362 [debug] [MainThread]: On master: BEGIN
[0m22:06:03.503726 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:03.509965 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.510387 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.510811 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.511184 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.511711 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.512107 [debug] [MainThread]: On master: Close
[0m22:06:03.513560 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:03.514073 [info ] [MainThread]: 
[0m22:06:03.534610 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:03.535257 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:03.535915 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:03.536356 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:03.562357 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:03.563141 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:03.598710 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:03.599446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:16.244279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.244797 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:16.245426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.245886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.246322 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:16.247094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.249980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.250433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:16.251128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.271958 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:16.272437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.272871 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:16.274123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.279058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.279519 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:16.281142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.283479 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:16.316156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdace13680>]}
[0m22:06:16.316871 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.78s]
[0m22:06:16.317746 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:16.318735 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:16.319310 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:16.319981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:16.320440 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:16.325682 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:16.326327 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:16.359941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.360452 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029220616353997"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:16.360915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:16.375828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.383734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.384218 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:16.384933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.385382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.385817 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029220616353997'
      
      
      order by ordinal_position

  
[0m22:06:16.406606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.413028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.413520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:16.416559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.424050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.424520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:16.427361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.445234 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:16.445927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.446397 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029220616353997"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029220616353997"
    )
  
[0m22:06:16.476121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.478088 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:16.478551 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.479023 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:16.488004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.488891 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:16.641202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda7fc45c0>]}
[0m22:06:16.641963 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m22:06:16.642858 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:16.644383 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.644853 [debug] [MainThread]: On master: BEGIN
[0m22:06:16.645282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:16.652138 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.652615 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.653050 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.653472 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.654057 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.654518 [debug] [MainThread]: On master: Close
[0m22:06:16.655998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:16.656439 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:16.656840 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:16.657315 [info ] [MainThread]: 
[0m22:06:16.657902 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.59 seconds (14.59s).
[0m22:06:16.659053 [debug] [MainThread]: Command end result
[0m22:06:16.686672 [info ] [MainThread]: 
[0m22:06:16.687362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:16.687956 [info ] [MainThread]: 
[0m22:06:16.688556 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:16.689650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.543995, "process_user_time": 6.293094, "process_kernel_time": 0.307272, "process_mem_max_rss": "280620", "process_in_blocks": "3808", "process_out_blocks": "114176"}
[0m22:06:16.690297 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:16.690186 after 16.54 seconds
[0m22:06:16.690818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf2ae2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdacf0acf0>]}
[0m22:06:16.691318 [debug] [MainThread]: Flushing usage events
[0m22:06:18.560099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b2435670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b14997c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b4913410>]}


============================== 22:06:18.562811 | 14f338cd-18cf-44db-bf88-63698db3d5d7 ==============================
[0m22:06:18.562811 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.563527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.698287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f338cd-18cf-44db-bf88-63698db3d5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b2b0b260>]}
[0m22:06:18.714595 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20253853, "process_user_time": 1.419757, "process_kernel_time": 0.096254, "process_mem_max_rss": "92260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:18.715201 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:18.715098 after 0.20 seconds
[0m22:06:18.715639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b1db6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b12d2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b1a1e480>]}
[0m22:06:18.716057 [debug] [MainThread]: Flushing usage events
[0m07:11:15.198521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c4f2b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c3cd6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c6001a00>]}


============================== 07:11:15.233989 | 87a3f4fb-973d-4c9c-85fa-8639e458323e ==============================
[0m07:11:15.233989 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:11:15.234689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:11:15.380805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a3f4fb-973d-4c9c-85fa-8639e458323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c45c9c40>]}
[0m07:11:15.394188 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-34hfxtla'
[0m07:11:15.394651 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:11:15.428105 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:11:15.428817 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:11:15.439299 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:11:15.443124 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:11:15.669528 [info ] [MainThread]: Installed from version 1.2.0
[0m07:11:15.670134 [info ] [MainThread]: Updated version available: 1.3.0
[0m07:11:15.670682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '87a3f4fb-973d-4c9c-85fa-8639e458323e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c3e3d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c39c44a0>]}
[0m07:11:15.671143 [info ] [MainThread]: 
[0m07:11:15.671630 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m07:11:15.684543 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5342621, "process_user_time": 1.596632, "process_kernel_time": 0.113754, "process_mem_max_rss": "93684", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m07:11:15.685218 [debug] [MainThread]: Command `dbt deps` succeeded at 07:11:15.685110 after 0.54 seconds
[0m07:11:15.685654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c4491640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c4492840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c45c9c40>]}
[0m07:11:15.686082 [debug] [MainThread]: Flushing usage events
[0m07:11:17.473514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d8bd4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d8bd47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d8541d30>]}


============================== 07:11:17.476323 | cdf66772-a414-4a00-9847-d689f5777c4d ==============================
[0m07:11:17.476323 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:11:17.476985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:11:17.711988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1320f80>]}
[0m07:11:17.771175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d82797f0>]}
[0m07:11:17.773668 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m07:11:17.825154 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:11:17.825872 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:11:17.826410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1226900>]}
[0m07:11:19.047705 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:11:19.048374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1254b90>]}
[0m07:11:19.231174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m07:11:19.236418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0b194f0>]}
[0m07:11:19.358842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0de5310>]}
[0m07:11:19.359415 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m07:11:19.359942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0c04a70>]}
[0m07:11:19.361723 [info ] [MainThread]: 
[0m07:11:19.362460 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:11:19.367372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m07:11:19.403287 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m07:11:19.403747 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m07:11:19.404146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:19.783536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.785139 [debug] [ThreadPool]: On list_petro: Close
[0m07:11:19.787306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m07:11:19.787867 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m07:11:19.795096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.795535 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m07:11:19.795929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:11:19.802298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.803832 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.804248 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m07:11:19.804837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.805239 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.805623 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m07:11:19.806200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.807137 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:11:19.807541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.807920 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:11:19.808478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.808942 [debug] [ThreadPool]: On create_petro_main: Close
[0m07:11:19.811193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m07:11:19.818616 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:11:19.819033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m07:11:19.819414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:11:19.825556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.825980 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:11:19.826379 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m07:11:19.849803 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.851395 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m07:11:19.852684 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m07:11:19.853104 [debug] [ThreadPool]: On list_petro_main: Close
[0m07:11:19.856694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0df8ad0>]}
[0m07:11:19.857240 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:19.857639 [debug] [MainThread]: On master: BEGIN
[0m07:11:19.858015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:11:19.864509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:19.864978 [debug] [MainThread]: On master: COMMIT
[0m07:11:19.865380 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:19.865763 [debug] [MainThread]: On master: COMMIT
[0m07:11:19.866313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:19.866728 [debug] [MainThread]: On master: Close
[0m07:11:19.868271 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m07:11:19.868832 [info ] [MainThread]: 
[0m07:11:19.885848 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m07:11:19.886469 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m07:11:19.887156 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m07:11:19.887596 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m07:11:19.913624 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m07:11:19.914496 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m07:11:19.950443 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m07:11:19.951242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:11:29.906241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.906767 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m07:11:29.907428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.907885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.908327 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m07:11:29.909293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.912242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.912731 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m07:11:29.913417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.934306 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:11:29.934811 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.935261 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:11:29.936658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.941710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.942182 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m07:11:29.943387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.945769 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m07:11:29.976502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d08bbb60>]}
[0m07:11:29.977340 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.09s]
[0m07:11:29.978104 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m07:11:29.979135 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m07:11:29.979699 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m07:11:29.980277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m07:11:29.980754 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m07:11:29.986109 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m07:11:29.986766 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m07:11:30.020860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.021385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241030071130014858"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m07:11:30.021870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:11:30.036782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.044877 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.045373 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m07:11:30.046028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.046482 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.046915 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241030071130014858'
      
      
      order by ordinal_position

  
[0m07:11:30.067865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.074853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.075361 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m07:11:30.078576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.086296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.086778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m07:11:30.089657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.107669 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m07:11:30.108438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.108941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241030071130014858"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241030071130014858"
    )
  
[0m07:11:30.139863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.141962 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:11:30.142438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.142880 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:11:30.151647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.152600 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m07:11:30.318028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18923cba70>]}
[0m07:11:30.318847 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m07:11:30.319603 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m07:11:30.321078 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:30.321557 [debug] [MainThread]: On master: BEGIN
[0m07:11:30.321989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:11:30.328838 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:30.329323 [debug] [MainThread]: On master: COMMIT
[0m07:11:30.329761 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:30.330182 [debug] [MainThread]: On master: COMMIT
[0m07:11:30.330761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:30.331210 [debug] [MainThread]: On master: Close
[0m07:11:30.332805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:11:30.333243 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m07:11:30.333648 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m07:11:30.334118 [info ] [MainThread]: 
[0m07:11:30.334720 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m07:11:30.335857 [debug] [MainThread]: Command end result
[0m07:11:30.363905 [info ] [MainThread]: 
[0m07:11:30.364618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:11:30.365263 [info ] [MainThread]: 
[0m07:11:30.365871 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:11:30.366969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.94198, "process_user_time": 5.388263, "process_kernel_time": 0.358412, "process_mem_max_rss": "297756", "process_in_blocks": "3808", "process_out_blocks": "114672"}
[0m07:11:30.367625 [debug] [MainThread]: Command `dbt run` succeeded at 07:11:30.367511 after 12.94 seconds
[0m07:11:30.368149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18dc167d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1891ac92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d88a3e00>]}
[0m07:11:30.368673 [debug] [MainThread]: Flushing usage events
[0m07:11:32.303395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f02202d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f01d79640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f022011f0>]}


============================== 07:11:32.306376 | 2f9347f4-2d38-4d45-b71f-73cb8db84ab3 ==============================
[0m07:11:32.306376 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:11:32.307044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:11:32.446961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f9347f4-2d38-4d45-b71f-73cb8db84ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f02b37f20>]}
[0m07:11:32.463275 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20883814, "process_user_time": 1.457047, "process_kernel_time": 0.06387, "process_mem_max_rss": "92156", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:11:32.463856 [debug] [MainThread]: Command `dbt clean` succeeded at 07:11:32.463754 after 0.21 seconds
[0m07:11:32.464288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f01daa360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0198aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0244e240>]}
[0m07:11:32.464747 [debug] [MainThread]: Flushing usage events
[0m14:05:31.318715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e931f84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e93c41c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91a6d070>]}


============================== 14:05:31.337988 | 772986b1-c385-433d-a285-388cd31a4cd3 ==============================
[0m14:05:31.337988 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.338724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.483950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '772986b1-c385-433d-a285-388cd31a4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e919317c0>]}
[0m14:05:31.502058 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x1q6uvtx'
[0m14:05:31.502768 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:31.575977 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:31.576884 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:31.605729 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:31.610171 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:31.685858 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:31.686514 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:31.687173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '772986b1-c385-433d-a285-388cd31a4cd3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91620d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91622a80>]}
[0m14:05:31.687652 [info ] [MainThread]: 
[0m14:05:31.688137 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:31.736188 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46638042, "process_user_time": 1.566557, "process_kernel_time": 0.165538, "process_mem_max_rss": "93772", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:31.736965 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:31.736853 after 0.47 seconds
[0m14:05:31.737451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91b9a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e93c41c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e919317c0>]}
[0m14:05:31.738137 [debug] [MainThread]: Flushing usage events
[0m14:05:33.321146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979cb66510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b1d5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b1d59a0>]}


============================== 14:05:33.323859 | 533fe736-a419-4f65-a286-321973f941b4 ==============================
[0m14:05:33.323859 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.324589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.555308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979bfbd280>]}
[0m14:05:33.614592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b235580>]}
[0m14:05:33.617041 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:33.644784 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:33.645482 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:33.646043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979a8c4440>]}
[0m14:05:34.870868 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:34.871529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9793715a60>]}
[0m14:05:35.053715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:35.059081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97932a83b0>]}
[0m14:05:35.193511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97933bfad0>]}
[0m14:05:35.194095 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:35.194601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979311daf0>]}
[0m14:05:35.196348 [info ] [MainThread]: 
[0m14:05:35.197080 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:35.201963 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:35.237376 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:35.237876 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:35.238281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:35.759731 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:35.761323 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:35.763475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:35.764058 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:35.771331 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.771780 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:35.772187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.778513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.779962 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.780387 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:35.780993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.781401 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.781822 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:35.782423 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.783343 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:35.783758 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.784144 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:35.784694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.785119 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:35.787941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:35.794587 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:35.795007 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:35.795379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.801489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.801942 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:35.802364 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:35.824658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.826316 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:35.827567 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:35.827980 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:35.831554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97933f4e00>]}
[0m14:05:35.832078 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.832477 [debug] [MainThread]: On master: BEGIN
[0m14:05:35.832851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:35.839372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.839804 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.840202 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.840578 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.841112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.841517 [debug] [MainThread]: On master: Close
[0m14:05:35.842899 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:35.843408 [info ] [MainThread]: 
[0m14:05:35.875738 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:35.876351 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:35.877026 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:35.877481 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:35.903921 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:35.904693 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:35.940700 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:35.941474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:43.507498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.508036 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:43.508738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.509190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.509661 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:43.510509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.513489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.513978 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:43.514686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.535678 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:43.536212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.536675 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:43.538839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.544191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.544672 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:43.546018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.548455 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:43.578943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97753affb0>]}
[0m14:05:43.579818 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.70s]
[0m14:05:43.580611 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:43.581649 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:43.582234 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:43.582851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:43.583327 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:43.588748 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:43.589459 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:43.623802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.624397 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241030140543617789"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:43.624876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:43.639954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.648077 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.648589 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:43.649254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.649737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.650189 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241030140543617789'
      
      
      order by ordinal_position

  
[0m14:05:43.671578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.678654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.679177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:43.682513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.690591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.691091 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:43.694278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.712758 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:43.713591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.714122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241030140543617789"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241030140543617789"
    )
  
[0m14:05:43.744897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.746998 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:43.747478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.747907 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:43.757025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.758054 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:43.934847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975c249340>]}
[0m14:05:43.935672 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m14:05:43.936519 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:43.938240 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.938720 [debug] [MainThread]: On master: BEGIN
[0m14:05:43.939156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:43.946303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.946830 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.947279 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.947710 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.948314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.948770 [debug] [MainThread]: On master: Close
[0m14:05:43.950524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:43.950965 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:43.951383 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:43.951876 [info ] [MainThread]: 
[0m14:05:43.952430 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.75 seconds (8.75s).
[0m14:05:43.953484 [debug] [MainThread]: Command end result
[0m14:05:43.981922 [info ] [MainThread]: 
[0m14:05:43.982651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:43.983205 [info ] [MainThread]: 
[0m14:05:43.983771 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:43.984841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.711764, "process_user_time": 5.053734, "process_kernel_time": 0.341146, "process_mem_max_rss": "293228", "process_in_blocks": "3808", "process_out_blocks": "114664"}
[0m14:05:43.985499 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:43.985384 after 10.71 seconds
[0m14:05:43.986058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979aad5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97931c36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9793778ce0>]}
[0m14:05:43.986555 [debug] [MainThread]: Flushing usage events
[0m14:05:45.767052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dcb3e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dcb3f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dcb3f3e0>]}


============================== 14:05:45.770041 | 0a2fed02-361e-46a6-b20a-3f32bd5c472e ==============================
[0m14:05:45.770041 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:45.770721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:45.924937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a2fed02-361e-46a6-b20a-3f32bd5c472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8de063140>]}
[0m14:05:45.942147 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22490598, "process_user_time": 1.439913, "process_kernel_time": 0.135991, "process_mem_max_rss": "92392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:45.942761 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:45.942652 after 0.23 seconds
[0m14:05:45.943225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e05bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dc9f78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dc983650>]}
[0m14:05:45.943667 [debug] [MainThread]: Flushing usage events
[0m22:05:32.794375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2d4e74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2d8e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2d8e7770>]}


============================== 22:05:32.801468 | a933c01e-a343-4572-b32d-fd2451372a03 ==============================
[0m22:05:32.801468 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:32.802123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:32.939746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a933c01e-a343-4572-b32d-fd2451372a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2ce0ba10>]}
[0m22:05:32.952884 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qzgos0nv'
[0m22:05:32.953334 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:33.061691 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:33.062296 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:33.085334 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:33.089129 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:33.159277 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:33.159851 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:33.160354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a933c01e-a343-4572-b32d-fd2451372a03', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2cefbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2cf535c0>]}
[0m22:05:33.160790 [info ] [MainThread]: 
[0m22:05:33.161247 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:33.162867 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41637897, "process_user_time": 1.548966, "process_kernel_time": 0.116072, "process_mem_max_rss": "93764", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:05:33.163482 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:33.163375 after 0.42 seconds
[0m22:05:33.163909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c30dbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2ce949e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2cefbd40>]}
[0m22:05:33.164323 [debug] [MainThread]: Flushing usage events
[0m22:05:34.748591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608b05d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608ec0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608136930>]}


============================== 22:05:34.751354 | 57ca03ca-2167-4b8c-8d10-a26d604438f3 ==============================
[0m22:05:34.751354 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:34.752057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:34.985796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608000ef0>]}
[0m22:05:35.045579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6607fe6090>]}
[0m22:05:35.048225 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:35.079159 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:35.079927 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:35.080466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6607ec7860>]}
[0m22:05:36.320608 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:36.321298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6607e50c50>]}
[0m22:05:36.505043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:36.510331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660083c830>]}
[0m22:05:36.632646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660089cd40>]}
[0m22:05:36.633190 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:36.633669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600891f40>]}
[0m22:05:36.635367 [info ] [MainThread]: 
[0m22:05:36.636038 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:36.640869 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:36.675557 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:36.675999 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:36.676458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:37.229363 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:37.230861 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:37.232848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:37.233393 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:37.240440 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.240870 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:37.241256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:37.247813 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.249236 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.249640 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:37.250182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.250597 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.250969 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:37.251571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.252479 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:37.252875 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.253246 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:37.253791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.254198 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:37.256121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:37.262653 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:37.263068 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:37.263502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:37.269467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.269877 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:37.270271 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:37.292316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.293817 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:37.295009 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:37.295439 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:37.298745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600891340>]}
[0m22:05:37.299251 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.299681 [debug] [MainThread]: On master: BEGIN
[0m22:05:37.300048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:37.306271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.306697 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.307083 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.307505 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.308032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.308441 [debug] [MainThread]: On master: Close
[0m22:05:37.309909 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:37.310442 [info ] [MainThread]: 
[0m22:05:37.319718 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:37.320305 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:37.321022 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:37.321464 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:37.347257 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:37.348018 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:37.383655 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:37.384385 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:44.510440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.510952 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:44.511604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.512060 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.512500 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:44.513219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.516091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.516549 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:44.517237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.538239 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:44.538728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.539164 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:44.541283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.546241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.546714 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:44.548312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.550613 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:44.580629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c1c8f710>]}
[0m22:05:44.581334 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.26s]
[0m22:05:44.582203 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:44.583143 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:44.583741 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:44.584401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:44.584854 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:44.589850 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:44.590498 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:44.623987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.624488 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241030220544618078"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:44.624962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:44.639291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.646688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.647152 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:44.647777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.648229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.648666 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241030220544618078'
      
      
      order by ordinal_position

  
[0m22:05:44.669402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.675536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.676032 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:44.679631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.687186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.687703 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:44.690459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.708090 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:44.708772 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.709314 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241030220544618078"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241030220544618078"
    )
  
[0m22:05:44.741712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.743723 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:44.744185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.744614 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:44.756578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.757481 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:44.926557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c143bf80>]}
[0m22:05:44.927389 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:05:44.928256 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:44.929783 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.930263 [debug] [MainThread]: On master: BEGIN
[0m22:05:44.930689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:44.937543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.938010 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.938443 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.938859 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.939458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.939912 [debug] [MainThread]: On master: Close
[0m22:05:44.941338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:44.941767 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:44.942170 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:44.942623 [info ] [MainThread]: 
[0m22:05:44.943168 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m22:05:44.944227 [debug] [MainThread]: Command end result
[0m22:05:44.971878 [info ] [MainThread]: 
[0m22:05:44.972508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:44.973045 [info ] [MainThread]: 
[0m22:05:44.973596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:44.974614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.27466, "process_user_time": 5.08905, "process_kernel_time": 0.2689, "process_mem_max_rss": "286544", "process_in_blocks": "3808", "process_out_blocks": "114696"}
[0m22:05:44.975261 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:44.975150 after 10.28 seconds
[0m22:05:44.975778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66081370b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c142ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600b31370>]}
[0m22:05:44.976263 [debug] [MainThread]: Flushing usage events
[0m22:05:46.584643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034b3e8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034a1f2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034a1f2510>]}


============================== 22:05:46.587402 | e7756a84-6256-4e5b-acf6-d96d48fd696b ==============================
[0m22:05:46.587402 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:46.588064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:46.725969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7756a84-6256-4e5b-acf6-d96d48fd696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034b20d940>]}
[0m22:05:46.741959 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2059205, "process_user_time": 1.385844, "process_kernel_time": 0.112474, "process_mem_max_rss": "92012", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:46.742524 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:46.742421 after 0.21 seconds
[0m22:05:46.742967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034b3e8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034a107ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034dfbbd10>]}
[0m22:05:46.743419 [debug] [MainThread]: Flushing usage events
[0m06:02:01.986404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0825b244d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08243dd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08243dd310>]}


============================== 06:02:02.006284 | 35459be1-507c-48e0-9371-9a69039d33f6 ==============================
[0m06:02:02.006284 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:02.006904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.142201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35459be1-507c-48e0-9371-9a69039d33f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0827bbbd10>]}
[0m06:02:02.155510 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ft1eyf1u'
[0m06:02:02.155979 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:02.277965 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:02.278582 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:02.304997 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:02.308819 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:02.382360 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:02.382851 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:02.383340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35459be1-507c-48e0-9371-9a69039d33f6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0823f6d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0823f6f9e0>]}
[0m06:02:02.383771 [info ] [MainThread]: 
[0m06:02:02.384216 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:02.390664 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45213374, "process_user_time": 1.483572, "process_kernel_time": 0.184943, "process_mem_max_rss": "93608", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:02.391248 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:02.391145 after 0.45 seconds
[0m06:02:02.391677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08243dd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0824b5ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08245c9bb0>]}
[0m06:02:02.392099 [debug] [MainThread]: Flushing usage events
[0m06:02:03.943982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1519e5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150439640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1501424b0>]}


============================== 06:02:03.946672 | aa4d2281-1e50-4130-9028-1638e6de0f08 ==============================
[0m06:02:03.946672 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.947334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.183135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14fe2fe90>]}
[0m06:02:04.242109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1532a0560>]}
[0m06:02:04.244554 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:04.269189 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:04.269902 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:04.270440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14fdd4ad0>]}
[0m06:02:05.490512 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.491191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb148b59bb0>]}
[0m06:02:05.670467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.675383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb148988ce0>]}
[0m06:02:05.795687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1488a0260>]}
[0m06:02:05.796224 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:05.796734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14892f590>]}
[0m06:02:05.798413 [info ] [MainThread]: 
[0m06:02:05.799091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.804012 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.838929 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.839369 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:05.839759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:06.360715 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:06.362322 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:06.364431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:06.365038 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:06.372167 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.372598 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:06.373025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.379354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.380811 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.381257 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:06.381852 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.382241 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.382612 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:06.383231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.384138 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.384538 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.384949 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.385486 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.385883 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:06.387824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:06.394942 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.395351 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:06.395715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.401660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.402063 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.402447 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:06.425850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.427285 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.428484 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.428935 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.432240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb148ad2e70>]}
[0m06:02:06.432743 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.433167 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.433533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.439796 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.440215 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.440599 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.441063 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.441624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.442021 [debug] [MainThread]: On master: Close
[0m06:02:06.443450 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.443947 [info ] [MainThread]: 
[0m06:02:06.458742 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.459329 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.459975 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:06.460402 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.485959 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.486678 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.521833 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.522572 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:14.879463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.879979 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:14.880613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.881095 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.881525 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:14.882220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.885071 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.885532 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:14.886211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.907127 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:14.907601 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.908032 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:14.909447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.914291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.914749 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:14.916342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.918669 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:14.948431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb109452390>]}
[0m06:02:14.949170 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.49s]
[0m06:02:14.949935 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:14.950920 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:14.951546 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:14.952215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:14.952667 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:14.957734 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:14.958376 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:14.991704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:14.992197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241031060214985881"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:14.992666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:15.006712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.013936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.014402 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:15.014984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.015426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.015858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241031060214985881'
      
      
      order by ordinal_position

  
[0m06:02:15.036555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.042846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.043335 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.046386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.053911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.054386 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.057337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.075043 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:15.075717 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.076178 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241031060214985881"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241031060214985881"
    )
  
[0m06:02:15.108527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.110499 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.110954 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.111374 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.119452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.120328 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:15.300105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1093946e0>]}
[0m06:02:15.300899 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:15.301757 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:15.303195 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.303659 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.304085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:15.310875 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.311338 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.311771 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.312191 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.312832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.313319 [debug] [MainThread]: On master: Close
[0m06:02:15.314710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:15.315137 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:15.315530 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:15.315976 [info ] [MainThread]: 
[0m06:02:15.316555 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.52 seconds (9.52s).
[0m06:02:15.317692 [debug] [MainThread]: Command end result
[0m06:02:15.345269 [info ] [MainThread]: 
[0m06:02:15.345900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:15.346431 [info ] [MainThread]: 
[0m06:02:15.346978 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:15.347988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.452166, "process_user_time": 5.543529, "process_kernel_time": 0.299758, "process_mem_max_rss": "299564", "process_in_blocks": "3808", "process_out_blocks": "115184"}
[0m06:02:15.348630 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:15.348510 after 11.45 seconds
[0m06:02:15.349198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150b286b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1405874d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1093811f0>]}
[0m06:02:15.349678 [debug] [MainThread]: Flushing usage events
[0m06:02:16.970623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d85f85e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d862fcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d85ee7140>]}


============================== 06:02:16.973353 | c4d4a696-e598-4cba-9999-7b567f7ee9dd ==============================
[0m06:02:16.973353 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.973984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.108624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d4a696-e598-4cba-9999-7b567f7ee9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d85bbd580>]}
[0m06:02:17.124601 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20221986, "process_user_time": 1.383761, "process_kernel_time": 0.108294, "process_mem_max_rss": "92376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:17.125200 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:17.125097 after 0.20 seconds
[0m06:02:17.125626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8631f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8705b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8609bc80>]}
[0m06:02:17.126045 [debug] [MainThread]: Flushing usage events
[0m14:05:12.585509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee23681f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee22098c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee220987a0>]}


============================== 14:05:12.592857 | cb83d02c-2efc-4e50-93da-4ebfb92ac636 ==============================
[0m14:05:12.592857 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.593570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.734086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb83d02c-2efc-4e50-93da-4ebfb92ac636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2136a690>]}
[0m14:05:12.747329 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ffqantpp'
[0m14:05:12.747778 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:12.794977 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:12.795628 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:12.828058 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:12.832045 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:13.046322 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:13.046896 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:13.047428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cb83d02c-2efc-4e50-93da-4ebfb92ac636', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee21058770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee21050740>]}
[0m14:05:13.047891 [info ] [MainThread]: 
[0m14:05:13.048362 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:13.049963 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5126817, "process_user_time": 1.559167, "process_kernel_time": 0.148683, "process_mem_max_rss": "93780", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m14:05:13.050565 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:13.050459 after 0.51 seconds
[0m14:05:13.051005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee23681f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee210738c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee215c7bf0>]}
[0m14:05:13.051444 [debug] [MainThread]: Flushing usage events
[0m14:05:14.896621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13ec7e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a14e214c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a142c4bf0>]}


============================== 14:05:14.899523 | bf2d6929-e44b-4a94-b22b-c4285fb0f905 ==============================
[0m14:05:14.899523 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.900163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:15.139888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1328ddc0>]}
[0m14:05:15.199482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1350a030>]}
[0m14:05:15.202119 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:15.235901 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:15.236665 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:15.237294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a132ba990>]}
[0m14:05:16.461048 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:16.461721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07d9e750>]}
[0m14:05:16.642721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:16.647935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13ff4770>]}
[0m14:05:16.793510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0c1adeb0>]}
[0m14:05:16.794098 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:16.794624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07d23d10>]}
[0m14:05:16.796380 [info ] [MainThread]: 
[0m14:05:16.797119 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:16.802119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:16.838024 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:16.838507 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:16.838966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:17.257459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.259013 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:17.261257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:17.261874 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:17.269008 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.269475 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:17.269885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:17.276417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.277975 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.278382 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:17.278970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.279367 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.279746 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:17.280323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.281245 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:17.281683 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.282055 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:17.282593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.282997 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:17.285098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:17.292487 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:17.292915 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:17.293289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:17.299650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.300118 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:17.300523 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:17.324251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.325967 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:17.327228 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:17.327638 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:17.331422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07de8110>]}
[0m14:05:17.331950 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.332354 [debug] [MainThread]: On master: BEGIN
[0m14:05:17.332731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:17.339425 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.339871 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.340265 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.340644 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.341174 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.341634 [debug] [MainThread]: On master: Close
[0m14:05:17.343134 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:17.343631 [info ] [MainThread]: 
[0m14:05:17.353212 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:17.353879 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:17.354580 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:17.355016 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:17.381433 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:17.382306 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:17.418959 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:17.419883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:25.631404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.631956 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:25.632625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.633091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.633568 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:25.634297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.637324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.637831 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:25.638545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.659588 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:25.660083 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.660536 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:25.662832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.667908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.668372 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:25.669730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.672090 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:25.702279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07d3bb00>]}
[0m14:05:25.703073 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.35s]
[0m14:05:25.703979 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:25.705005 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:25.705612 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:25.706299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:25.706755 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:25.712102 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:25.712784 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:25.746943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.747469 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241031140525740986"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:25.747949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:25.764752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.772632 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.773118 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:25.773755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.774201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.774633 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241031140525740986'
      
      
      order by ordinal_position

  
[0m14:05:25.795579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.802228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.802720 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:25.805904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.813619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.814104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:25.816955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.834985 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:25.835722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.836200 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241031140525740986"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241031140525740986"
    )
  
[0m14:05:25.868880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.870949 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:25.871418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.871849 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:25.880608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.881580 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.062825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d0816510>]}
[0m14:05:26.063692 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:26.064582 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.066105 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.066586 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.067014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.074362 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.074869 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.075307 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.075730 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.076326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.076783 [debug] [MainThread]: On master: Close
[0m14:05:26.078698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.079134 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:26.079536 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.080006 [info ] [MainThread]: 
[0m14:05:26.080597 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m14:05:26.081803 [debug] [MainThread]: Command end result
[0m14:05:26.110722 [info ] [MainThread]: 
[0m14:05:26.111448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.112040 [info ] [MainThread]: 
[0m14:05:26.112639 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.113773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.26582, "process_user_time": 5.358878, "process_kernel_time": 0.324174, "process_mem_max_rss": "292860", "process_in_blocks": "3808", "process_out_blocks": "115168"}
[0m14:05:26.114427 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.114315 after 11.27 seconds
[0m14:05:26.114923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13abbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13841bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0c1eb830>]}
[0m14:05:26.115410 [debug] [MainThread]: Flushing usage events
[0m14:05:28.063396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2602cd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe262215910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe26027bf80>]}


============================== 14:05:28.066329 | 1f7360ab-b46d-477c-9cfb-b51f8446c6ec ==============================
[0m14:05:28.066329 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.066990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.207716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f7360ab-b46d-477c-9cfb-b51f8446c6ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25fe364b0>]}
[0m14:05:28.224098 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20950903, "process_user_time": 1.40454, "process_kernel_time": 0.128049, "process_mem_max_rss": "92328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:28.224702 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.224597 after 0.21 seconds
[0m14:05:28.225158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe261387590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25fca7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe262215910>]}
[0m14:05:28.225634 [debug] [MainThread]: Flushing usage events
[0m22:05:50.547394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cabc9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cab85340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb336ab0>]}


============================== 22:05:50.555050 | 896cb817-78f7-4e3c-9afc-9303f170ab11 ==============================
[0m22:05:50.555050 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.555747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.690793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '896cb817-78f7-4e3c-9afc-9303f170ab11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca857800>]}
[0m22:05:50.703982 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-71b2j33o'
[0m22:05:50.704422 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:50.791180 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:50.791782 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:50.802869 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:50.806665 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:50.979886 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:50.980385 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:50.980888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '896cb817-78f7-4e3c-9afc-9303f170ab11', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca90e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca90f2c0>]}
[0m22:05:50.981365 [info ] [MainThread]: 
[0m22:05:50.981836 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:50.983609 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48344803, "process_user_time": 1.596709, "process_kernel_time": 0.112049, "process_mem_max_rss": "93812", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:05:50.984180 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:50.984081 after 0.48 seconds
[0m22:05:50.984603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52caf8fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cdfe5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb6ff530>]}
[0m22:05:50.985015 [debug] [MainThread]: Flushing usage events
[0m22:05:52.688488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce1101d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce2015610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce0bcaf90>]}


============================== 22:05:52.691204 | 2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93 ==============================
[0m22:05:52.691204 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.691839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.921719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce057f860>]}
[0m22:05:52.980437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce05616d0>]}
[0m22:05:52.983002 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:52.999221 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:52.999980 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:53.000514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce047a1b0>]}
[0m22:05:54.235856 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:54.236849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd912e900>]}
[0m22:05:54.416701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:54.421806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8fda180>]}
[0m22:05:54.541379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8e01fd0>]}
[0m22:05:54.541933 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:54.542428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8ea3410>]}
[0m22:05:54.544137 [info ] [MainThread]: 
[0m22:05:54.544857 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:54.549760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:54.585012 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:54.585480 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:54.585877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.085357 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.086992 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:55.089326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:55.089916 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:55.097309 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.097748 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:55.098160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.104581 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.106102 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.106515 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:55.107064 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.107460 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.107841 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:55.108450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.109414 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.109824 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.110205 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.110759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.111164 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:55.113144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:55.120446 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.120860 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:55.121265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.127175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.127590 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.127987 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:55.151447 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.152912 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:55.154166 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:55.154571 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:55.157964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce1ca4e30>]}
[0m22:05:55.158506 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.158897 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.159270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:55.165585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.166009 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.166401 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.166776 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.167314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.167716 [debug] [MainThread]: On master: Close
[0m22:05:55.169219 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:55.169755 [info ] [MainThread]: 
[0m22:05:55.179060 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:55.179654 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:55.180379 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:55.180831 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:55.206934 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:55.207688 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:55.243703 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:55.244432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:02.881780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.882313 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:02.882945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.883403 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.883860 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:02.884583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.887553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.888011 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:02.888702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.909748 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:02.910235 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.910677 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:02.912512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.917504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.917977 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:02.919106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.921429 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:02.951395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8e01280>]}
[0m22:06:02.952144 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.77s]
[0m22:06:02.952908 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:02.953941 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:02.954515 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:02.955096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:02.955548 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:02.960698 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:02.961403 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:02.995306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:02.995818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241031220602989380"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:02.996307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:03.010495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.018043 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.018518 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:03.019125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.019578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.020017 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241031220602989380'
      
      
      order by ordinal_position

  
[0m22:06:03.041815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.048007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.048499 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.051540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.059123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.059607 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.062429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.080486 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:03.081203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.081682 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241031220602989380"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241031220602989380"
    )
  
[0m22:06:03.112576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.114746 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.115249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.115688 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.124226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.125148 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:03.322167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c99a25940>]}
[0m22:06:03.322988 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:03.323745 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:03.325246 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.325734 [debug] [MainThread]: On master: BEGIN
[0m22:06:03.326178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:03.333008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.333557 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.333996 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.334418 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.335003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.335457 [debug] [MainThread]: On master: Close
[0m22:06:03.336860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:03.337339 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:03.337753 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:03.338216 [info ] [MainThread]: 
[0m22:06:03.338810 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m22:06:03.339915 [debug] [MainThread]: Command end result
[0m22:06:03.369171 [info ] [MainThread]: 
[0m22:06:03.369999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:03.370651 [info ] [MainThread]: 
[0m22:06:03.371319 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:03.372444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.732155, "process_user_time": 5.594649, "process_kernel_time": 0.303276, "process_mem_max_rss": "299264", "process_in_blocks": "3808", "process_out_blocks": "116744"}
[0m22:06:03.373084 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:03.372974 after 10.73 seconds
[0m22:06:03.373611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce41bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce0802690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd90a0350>]}
[0m22:06:03.374094 [debug] [MainThread]: Flushing usage events
[0m22:06:05.124654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81959d63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8195cea6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81959d6390>]}


============================== 22:06:05.128356 | e32a2e0d-9351-43a4-be55-5e36bfad6a5e ==============================
[0m22:06:05.128356 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.129195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:05.275400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e32a2e0d-9351-43a4-be55-5e36bfad6a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8198d13410>]}
[0m22:06:05.291799 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23422936, "process_user_time": 1.426607, "process_kernel_time": 0.123879, "process_mem_max_rss": "91956", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:05.292360 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:05.292259 after 0.23 seconds
[0m22:06:05.292789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81959d6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8195ab2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8198d13410>]}
[0m22:06:05.293236 [debug] [MainThread]: Flushing usage events
[0m06:02:04.993052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04473c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a055046e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a044713d0>]}


============================== 06:02:05.000317 | 69dd1be5-e3d3-455a-9ffd-bf5bd6f4a8e0 ==============================
[0m06:02:05.000317 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.000922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:05.140503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69dd1be5-e3d3-455a-9ffd-bf5bd6f4a8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a048e1e80>]}
[0m06:02:05.154002 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-972_4mpt'
[0m06:02:05.154464 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:05.314249 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:05.314946 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:05.324576 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:05.328536 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:05.371412 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:05.371996 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:05.372594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69dd1be5-e3d3-455a-9ffd-bf5bd6f4a8e0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a043168a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04c75970>]}
[0m06:02:05.373208 [info ] [MainThread]: 
[0m06:02:05.373743 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:05.375448 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43069765, "process_user_time": 1.564496, "process_kernel_time": 0.141491, "process_mem_max_rss": "93540", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:05.376075 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:05.375968 after 0.43 seconds
[0m06:02:05.376514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04c260c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04858770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04d87530>]}
[0m06:02:05.376942 [debug] [MainThread]: Flushing usage events
[0m06:02:06.927941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079d2c47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079d101a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079cf05b50>]}


============================== 06:02:06.930959 | b5f6ec7f-4054-438d-a628-8c3493bafe55 ==============================
[0m06:02:06.930959 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.931719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.170972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c303590>]}
[0m06:02:07.231571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c3873e0>]}
[0m06:02:07.234233 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:07.270207 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:07.270970 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:07.271505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c2c6060>]}
[0m06:02:08.514687 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:08.515383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07953132f0>]}
[0m06:02:08.699580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:08.705094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0794d72270>]}
[0m06:02:08.866522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0794ca87d0>]}
[0m06:02:08.867122 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:08.867652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0794c0d6a0>]}
[0m06:02:08.869472 [info ] [MainThread]: 
[0m06:02:08.870216 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:08.875178 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:08.911466 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:08.912010 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:08.912417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:09.416364 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:09.417919 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:09.420165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:09.420722 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:09.427938 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.428366 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:09.428758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.435010 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.436462 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.436868 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:09.437396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.437788 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.438162 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:09.438715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.439622 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.440072 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.440456 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.441008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.441425 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:09.443335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:09.450397 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.450812 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:09.451191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.457126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.457545 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.457941 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:09.481142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.482612 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:09.483822 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:09.484268 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:09.487625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07951acd40>]}
[0m06:02:09.488176 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.488579 [debug] [MainThread]: On master: BEGIN
[0m06:02:09.488962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:09.495141 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.495565 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.496011 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.496389 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.496922 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.497330 [debug] [MainThread]: On master: Close
[0m06:02:09.498617 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:09.499114 [info ] [MainThread]: 
[0m06:02:09.508468 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:09.509069 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:09.509729 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:09.510172 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:09.536755 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:09.537521 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:09.573846 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:09.574598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:15.403486 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.404014 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:15.404644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.405090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.405520 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:15.406204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.409094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.409551 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:15.410234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.431128 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.431608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.432080 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.433506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.438423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.438893 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:15.440044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.442370 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:15.472469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0755781100>]}
[0m06:02:15.473223 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 5.96s]
[0m06:02:15.474097 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:15.475084 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:15.475643 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:15.476352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:15.476842 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:15.482053 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:15.482709 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:15.516714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.517223 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241101060215510750"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:15.517695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:15.532942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.540542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.541021 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:15.541626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.542071 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.542511 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241101060215510750'
      
      
      order by ordinal_position

  
[0m06:02:15.563990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.570192 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.570680 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.575213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.582750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.583230 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.587424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.605900 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:15.606618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.607093 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241101060215510750"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241101060215510750"
    )
  
[0m06:02:15.638292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.640380 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.640843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.641271 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.649177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.650144 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:15.850414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075552a930>]}
[0m06:02:15.851264 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:15.852180 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:15.853601 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.854071 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.854497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:15.861398 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.861879 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.862317 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.862743 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.863326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.863787 [debug] [MainThread]: On master: Close
[0m06:02:15.865260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:15.865702 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:15.866103 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:15.866569 [info ] [MainThread]: 
[0m06:02:15.867163 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m06:02:15.868320 [debug] [MainThread]: Command end result
[0m06:02:15.896956 [info ] [MainThread]: 
[0m06:02:15.897647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:15.898236 [info ] [MainThread]: 
[0m06:02:15.898845 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:15.899975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.021043, "process_user_time": 5.706056, "process_kernel_time": 0.281681, "process_mem_max_rss": "301804", "process_in_blocks": "3808", "process_out_blocks": "116720"}
[0m06:02:15.900626 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:15.900513 after 9.02 seconds
[0m06:02:15.901117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c5b2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07949a17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c9d7e00>]}
[0m06:02:15.901611 [debug] [MainThread]: Flushing usage events
[0m06:02:17.628215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452c33da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845226ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845226e8a0>]}


============================== 06:02:17.631022 | 32bee49d-3509-4c81-9b35-2dbab30d16ea ==============================
[0m06:02:17.631022 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.631698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.771062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32bee49d-3509-4c81-9b35-2dbab30d16ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8451ade6f0>]}
[0m06:02:17.787571 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20873599, "process_user_time": 1.400191, "process_kernel_time": 0.116015, "process_mem_max_rss": "92160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:17.788206 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:17.788099 after 0.21 seconds
[0m06:02:17.788657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452c33da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845224f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8453e21d00>]}
[0m06:02:17.789089 [debug] [MainThread]: Flushing usage events
[0m14:05:05.291813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48b2ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a49238e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48627830>]}


============================== 14:05:05.299424 | 745946be-bb89-43aa-bf37-4278c0a7748d ==============================
[0m14:05:05.299424 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.300223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.446470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '745946be-bb89-43aa-bf37-4278c0a7748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a4804dfa0>]}
[0m14:05:05.460507 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y0rizk24'
[0m14:05:05.461061 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:05.498907 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:05.499668 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:05.511187 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:05.515260 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:05.725801 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:05.726494 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:05.727211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '745946be-bb89-43aa-bf37-4278c0a7748d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a481e7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a481e7c80>]}
[0m14:05:05.727746 [info ] [MainThread]: 
[0m14:05:05.728300 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:05.730197 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4872031, "process_user_time": 1.611376, "process_kernel_time": 0.112515, "process_mem_max_rss": "93596", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m14:05:05.730823 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:05.730710 after 0.49 seconds
[0m14:05:05.731287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48173350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48b2ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48b2ede0>]}
[0m14:05:05.731743 [debug] [MainThread]: Flushing usage events
[0m14:05:07.588077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61fd21550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e88fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e3fac30>]}


============================== 14:05:07.591124 | 49f7080f-8fb1-4611-9f8b-b26c5584d473 ==============================
[0m14:05:07.591124 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:07.591894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:07.833700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e2b7aa0>]}
[0m14:05:07.892764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61f4aed50>]}
[0m14:05:07.895414 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:07.911356 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:07.912099 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:07.912639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6172302f0>]}
[0m14:05:09.148575 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:09.149309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e2b72f0>]}
[0m14:05:09.333538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:09.338696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616b40860>]}
[0m14:05:09.464655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e6fc7a0>]}
[0m14:05:09.465245 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:09.465758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616bae840>]}
[0m14:05:09.467452 [info ] [MainThread]: 
[0m14:05:09.468157 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:09.472850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:09.507949 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:09.508409 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:09.508871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:10.138564 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:10.140177 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:10.142555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:10.143151 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:10.150534 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.150988 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:10.151394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:10.157811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.159311 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.159733 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:10.160456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.160891 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.161296 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:10.161959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.162881 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:10.163283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.163664 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:10.164265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.164676 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:10.166734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:10.174091 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:10.174540 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:10.174913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:10.181450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.181907 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:10.182307 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:10.207452 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.209153 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:10.210434 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:10.210853 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:10.214788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61f9119a0>]}
[0m14:05:10.215379 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:10.215790 [debug] [MainThread]: On master: BEGIN
[0m14:05:10.216165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:10.222884 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:10.223322 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.223718 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:10.224098 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.224671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:10.225129 [debug] [MainThread]: On master: Close
[0m14:05:10.226677 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:10.227188 [info ] [MainThread]: 
[0m14:05:10.236730 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:10.237391 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:10.238050 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:10.238490 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:10.265137 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:10.266030 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:10.302603 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:10.303557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:20.860589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.861140 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:20.861791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.862241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.862673 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:20.863392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.866346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.866806 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:20.867503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.888297 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.888855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.889296 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.901520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.906827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.907296 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:20.908910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.911353 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:20.942575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616df7830>]}
[0m14:05:20.943387 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.70s]
[0m14:05:20.944179 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:20.945202 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:20.945781 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:20.946393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:20.946855 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:20.952172 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:20.952866 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:20.986754 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.987316 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241101140520980721"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:20.987796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:21.003735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.011824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.012313 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:21.012967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.013418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.013851 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241101140520980721'
      
      
      order by ordinal_position

  
[0m14:05:21.034686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.041432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.041925 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.044715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.052389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.052887 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.055996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.074142 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:21.074920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.075408 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241101140520980721"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241101140520980721"
    )
  
[0m14:05:21.108384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.110461 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.110951 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.111388 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.121425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.122361 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:21.771691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d74674a0>]}
[0m14:05:21.772515 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.83s]
[0m14:05:21.773408 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:21.774864 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.775340 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.775773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:21.782546 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.783035 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.783473 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.783896 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.784482 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.784991 [debug] [MainThread]: On master: Close
[0m14:05:21.786464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.786897 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:21.787299 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:21.787758 [info ] [MainThread]: 
[0m14:05:21.788357 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.32 seconds (12.32s).
[0m14:05:21.789518 [debug] [MainThread]: Command end result
[0m14:05:21.817232 [info ] [MainThread]: 
[0m14:05:21.817931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:21.818528 [info ] [MainThread]: 
[0m14:05:21.819120 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:21.820214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.280946, "process_user_time": 6.644992, "process_kernel_time": 0.36673, "process_mem_max_rss": "363868", "process_in_blocks": "3808", "process_out_blocks": "131536"}
[0m14:05:21.820888 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:21.820747 after 14.28 seconds
[0m14:05:21.821384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e494bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e21e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d7457c80>]}
[0m14:05:21.821873 [debug] [MainThread]: Flushing usage events
[0m14:05:23.752115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ab5fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752aafaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752b8f8260>]}


============================== 14:05:23.755023 | 61fbd707-4de4-44f4-a33c-00e585185648 ==============================
[0m14:05:23.755023 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.755656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.912025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61fbd707-4de4-44f4-a33c-00e585185648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752bfc8650>]}
[0m14:05:23.928866 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22524585, "process_user_time": 1.440011, "process_kernel_time": 0.084, "process_mem_max_rss": "92128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:23.929458 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:23.929358 after 0.23 seconds
[0m14:05:23.929893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752b8f8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752a61ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752a618fe0>]}
[0m14:05:23.930325 [debug] [MainThread]: Flushing usage events
[0m22:05:42.232615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834fc13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83716dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd835ee5100>]}


============================== 22:05:42.240308 | 2cb9c6a7-8d64-4bfe-a41a-c8206efeb61b ==============================
[0m22:05:42.240308 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.241054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.383012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cb9c6a7-8d64-4bfe-a41a-c8206efeb61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd836315760>]}
[0m22:05:42.396685 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-re6v8gi2'
[0m22:05:42.397151 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:42.430559 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:42.431271 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:42.440645 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:42.444515 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:42.647989 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:42.648633 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:42.649328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2cb9c6a7-8d64-4bfe-a41a-c8206efeb61b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834c911f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834c93050>]}
[0m22:05:42.649789 [info ] [MainThread]: 
[0m22:05:42.650303 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:42.651909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46755692, "process_user_time": 1.5731, "process_kernel_time": 0.136095, "process_mem_max_rss": "93736", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:05:42.652543 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:42.652438 after 0.47 seconds
[0m22:05:42.652980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd835aa8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834b03f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8353945c0>]}
[0m22:05:42.653398 [debug] [MainThread]: Flushing usage events
[0m22:05:44.518340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be0a4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be1706b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be3bae40>]}


============================== 22:05:44.521201 | dac8e806-ee3c-45c8-b95e-abb1e46c0c53 ==============================
[0m22:05:44.521201 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.521923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.757152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bdec5100>]}
[0m22:05:44.816305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b6f21880>]}
[0m22:05:44.818918 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:44.834670 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:44.835391 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:44.835923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b6e5a780>]}
[0m22:05:46.063951 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:46.064614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b685e510>]}
[0m22:05:46.245913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:46.251353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b68f5bb0>]}
[0m22:05:46.383865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b67edb80>]}
[0m22:05:46.384474 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:46.384992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b687b7d0>]}
[0m22:05:46.386773 [info ] [MainThread]: 
[0m22:05:46.387522 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:46.392487 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:46.428594 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:46.429103 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:46.429503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:46.876662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.878208 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:46.880633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:46.881188 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:46.888393 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.888828 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:46.889221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.895622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.897099 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.897512 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:46.898108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.898517 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.898901 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:46.899504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.900460 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.900879 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.901264 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.901802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.902215 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:46.904088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:46.911157 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.911574 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:46.911949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.917929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.918346 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.918741 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:46.942315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.943935 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:46.945232 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:46.945639 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:46.949475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf5b9400>]}
[0m22:05:46.950013 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.950406 [debug] [MainThread]: On master: BEGIN
[0m22:05:46.950780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:46.957380 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.957820 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.958213 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.958601 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.959129 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.959542 [debug] [MainThread]: On master: Close
[0m22:05:46.960985 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:46.961492 [info ] [MainThread]: 
[0m22:05:46.971519 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:46.972205 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:46.972898 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:46.973339 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:46.999473 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:47.000323 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:47.036218 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:47.037077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:55.562160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.562685 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:55.563341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.563813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.564275 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:55.564997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.567879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.568394 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:55.569081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.589735 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:55.590236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.590685 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:55.592170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.597188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.597655 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:55.598962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.601348 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:55.631410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90732809e0>]}
[0m22:05:55.632289 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.66s]
[0m22:05:55.633069 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:55.634058 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:55.634623 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:55.635209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:55.635665 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:55.641083 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:55.641761 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:55.675538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.676122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241101220555669595"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:55.676627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:55.692356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.700164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.700638 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:55.701262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.701712 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.702145 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241101220555669595'
      
      
      order by ordinal_position

  
[0m22:05:55.723138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.729685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.730183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:55.734761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.742536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.743013 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:55.745956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.764000 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:55.764774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.765246 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241101220555669595"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241101220555669595"
    )
  
[0m22:05:55.795718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.797812 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:55.798277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.798711 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:55.808281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.809228 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:55.968891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b69707a0>]}
[0m22:05:55.969759 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:05:55.970519 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:55.972140 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.972623 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.973055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:55.980146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.980653 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.981088 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.981516 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.982108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.982563 [debug] [MainThread]: On master: Close
[0m22:05:55.984351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:55.984793 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:55.985196 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:55.985675 [info ] [MainThread]: 
[0m22:05:55.986220 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.60 seconds (9.60s).
[0m22:05:55.987247 [debug] [MainThread]: Command end result
[0m22:05:56.015540 [info ] [MainThread]: 
[0m22:05:56.016254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:56.016774 [info ] [MainThread]: 
[0m22:05:56.017292 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:56.018337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.547948, "process_user_time": 5.506517, "process_kernel_time": 0.306581, "process_mem_max_rss": "278320", "process_in_blocks": "3808", "process_out_blocks": "114176"}
[0m22:05:56.018987 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:56.018875 after 11.55 seconds
[0m22:05:56.019493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be3ba2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a5f3f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be4c80e0>]}
[0m22:05:56.019984 [debug] [MainThread]: Flushing usage events
[0m22:05:57.997255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec656acf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec66f1d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6567e5a0>]}


============================== 22:05:58.000315 | 1de55447-30d0-4e4c-a4fe-a57c1c4f56a9 ==============================
[0m22:05:58.000315 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:58.001064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:58.151679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1de55447-30d0-4e4c-a4fe-a57c1c4f56a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec654b4ce0>]}
[0m22:05:58.168353 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22000042, "process_user_time": 1.448446, "process_kernel_time": 0.108033, "process_mem_max_rss": "92212", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:58.168945 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:58.168841 after 0.22 seconds
[0m22:05:58.169381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec66208140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6549f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6575a300>]}
[0m22:05:58.169820 [debug] [MainThread]: Flushing usage events
[0m06:02:09.929212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f4879cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f485ba780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f4879de80>]}


============================== 06:02:09.936338 | 785e5a75-c4b0-4128-b9d4-86c53d4f39ff ==============================
[0m06:02:09.936338 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.936990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.071983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '785e5a75-c4b0-4128-b9d4-86c53d4f39ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f486ba720>]}
[0m06:02:10.085115 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k6v538hr'
[0m06:02:10.085581 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.168308 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.168988 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.180181 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.184185 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.233548 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.234099 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:10.234686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '785e5a75-c4b0-4128-b9d4-86c53d4f39ff', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47d5b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47b93e60>]}
[0m06:02:10.235135 [info ] [MainThread]: 
[0m06:02:10.235663 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:10.237281 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35559773, "process_user_time": 1.542609, "process_kernel_time": 0.139873, "process_mem_max_rss": "93696", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m06:02:10.237867 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.237766 after 0.36 seconds
[0m06:02:10.238296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f48166840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f48deac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47d5b230>]}
[0m06:02:10.238717 [debug] [MainThread]: Flushing usage events
[0m06:02:11.771254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe2b10>]}


============================== 06:02:11.773919 | de4c2218-d05e-42d4-942d-a1f4f3e337d6 ==============================
[0m06:02:11.773919 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.774550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.007521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454ea8530>]}
[0m06:02:12.066105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45604fec0>]}
[0m06:02:12.068485 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:12.116495 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.117307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.117948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44dfbdd60>]}
[0m06:02:13.329823 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.330474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d85f380>]}
[0m06:02:13.509895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.514899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44ddec9e0>]}
[0m06:02:13.633800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d809d00>]}
[0m06:02:13.634344 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:13.634874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d8e43e0>]}
[0m06:02:13.636534 [info ] [MainThread]: 
[0m06:02:13.637271 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:13.641907 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:13.676295 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:13.676741 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:13.677170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.151735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.153350 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.155534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.156094 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.163234 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.163666 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:14.164057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.170514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.171958 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.172373 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.172977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.173422 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.173805 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.174399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.175323 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.175722 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.176102 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.176652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.177057 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.179000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.185934 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.186341 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.186714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.192375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.192790 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.193226 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:14.216471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.217920 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.219126 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.219530 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.222715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d70e840>]}
[0m06:02:14.223226 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.223620 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.223990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.230397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.230823 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.231265 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.231645 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.232235 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.232640 [debug] [MainThread]: On master: Close
[0m06:02:14.234248 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.234748 [info ] [MainThread]: 
[0m06:02:14.243661 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.244247 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.244877 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.245359 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.270754 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.271491 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.306665 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.307388 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.563749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.564250 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.564877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.565365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.565802 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.566509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.569345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.569799 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.570483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.591083 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.591559 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.592002 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.593238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.598143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.598608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.600029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.602328 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.631606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d9c4380>]}
[0m06:02:20.632299 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.39s]
[0m06:02:20.633060 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.634053 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.634610 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.635207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.635665 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.640581 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.641266 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:20.674368 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.674866 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241102060220668525"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:20.675331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:20.689776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.697208 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.697676 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:20.698303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.698748 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.699178 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241102060220668525'
      
      
      order by ordinal_position

  
[0m06:02:20.721198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.727198 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.727677 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.730492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.737955 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.738423 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.741115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.758817 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:20.759492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.759969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241102060220668525"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241102060220668525"
    )
  
[0m06:02:20.789962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.791855 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.792319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.792747 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.801082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.801998 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:20.960186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44df847a0>]}
[0m06:02:20.960940 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:20.961842 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:20.963200 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.963668 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.964105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:20.970817 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.971290 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.971726 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.972141 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.972743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.973228 [debug] [MainThread]: On master: Close
[0m06:02:20.974736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:20.975166 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:20.975568 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:20.976027 [info ] [MainThread]: 
[0m06:02:20.976569 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m06:02:20.977621 [debug] [MainThread]: Command end result
[0m06:02:21.005344 [info ] [MainThread]: 
[0m06:02:21.005981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.006514 [info ] [MainThread]: 
[0m06:02:21.007061 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.008065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.284931, "process_user_time": 5.409922, "process_kernel_time": 0.322208, "process_mem_max_rss": "294952", "process_in_blocks": "3808", "process_out_blocks": "114648"}
[0m06:02:21.008704 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.008592 after 9.29 seconds
[0m06:02:21.009208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45507fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4122c8830>]}
[0m06:02:21.009690 [debug] [MainThread]: Flushing usage events
[0m06:02:22.613335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a2bdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58ab67080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a2bdd30>]}


============================== 06:02:22.616015 | d98ad81c-143f-4b53-aa0d-07964270d717 ==============================
[0m06:02:22.616015 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.616732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.751854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd98ad81c-143f-4b53-aa0d-07964270d717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5899cad50>]}
[0m06:02:22.768078 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20298095, "process_user_time": 1.381521, "process_kernel_time": 0.123777, "process_mem_max_rss": "92196", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:22.768640 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:22.768537 after 0.20 seconds
[0m06:02:22.769076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc589808c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a48b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5897cc7a0>]}
[0m06:02:22.769547 [debug] [MainThread]: Flushing usage events
[0m14:04:51.675244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0d769250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0b182cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ca28860>]}


============================== 14:04:51.682616 | 6b5feb64-1a56-4aec-ad7d-7c565a8298d4 ==============================
[0m14:04:51.682616 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:51.683291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:51.821889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b5feb64-1a56-4aec-ad7d-7c565a8298d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0b139400>]}
[0m14:04:51.835063 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r2ef8ipp'
[0m14:04:51.835518 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:51.897474 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:51.898059 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:51.907735 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:51.911537 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:52.117431 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:52.117988 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:52.118512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b5feb64-1a56-4aec-ad7d-7c565a8298d4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ae7a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ae7a720>]}
[0m14:04:52.118966 [info ] [MainThread]: 
[0m14:04:52.119432 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:52.125278 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49795356, "process_user_time": 1.5226, "process_kernel_time": 0.162569, "process_mem_max_rss": "93508", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:04:52.125865 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:52.125763 after 0.50 seconds
[0m14:04:52.126290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0af2fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0afa3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0b543890>]}
[0m14:04:52.126703 [debug] [MainThread]: Flushing usage events
[0m14:04:53.893055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200f358890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ee1b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200f359bb0>]}


============================== 14:04:53.895872 | b090d282-05c8-4230-b986-1233940ce519 ==============================
[0m14:04:53.895872 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:53.896600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:54.136053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200e864e60>]}
[0m14:04:54.196393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200f190620>]}
[0m14:04:54.198921 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:54.214532 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:54.215243 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:54.215776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ea56270>]}
[0m14:04:55.447626 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:55.448290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200738abd0>]}
[0m14:04:55.629886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:55.635069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2007761580>]}
[0m14:04:55.756378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2007102750>]}
[0m14:04:55.756933 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:55.757481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2007279fd0>]}
[0m14:04:55.759209 [info ] [MainThread]: 
[0m14:04:55.759937 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:55.764712 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:55.800203 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:55.800675 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:55.801070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:56.400450 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:56.402014 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:56.404047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:56.404614 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:56.411747 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.412174 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:56.412566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:56.419273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.420666 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.421065 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:56.421660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.422052 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.422431 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:56.423021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.423931 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:56.424327 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.424697 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:56.425245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.425644 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:56.427436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:56.434409 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:56.434819 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:56.435186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:56.441127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.441577 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:56.441972 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:56.465054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.466514 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:56.467695 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:56.468124 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:56.471345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2005fa28d0>]}
[0m14:04:56.471861 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:56.472259 [debug] [MainThread]: On master: BEGIN
[0m14:04:56.472634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:56.478810 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:56.479239 [debug] [MainThread]: On master: COMMIT
[0m14:04:56.479626 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:56.480010 [debug] [MainThread]: On master: COMMIT
[0m14:04:56.480543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:56.480948 [debug] [MainThread]: On master: Close
[0m14:04:56.482558 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:56.483082 [info ] [MainThread]: 
[0m14:04:56.492661 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:56.493281 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:56.493937 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:56.494380 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:56.520280 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:56.521032 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:56.557052 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:56.557833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:06.895637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.896148 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:06.896777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.897259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.897707 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:06.898446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.901969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.902590 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:06.903422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.929564 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:06.930221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.930770 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:06.932021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.936932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.937432 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:06.938607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.940922 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:06.970671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ff06240>]}
[0m14:05:06.971433 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.48s]
[0m14:05:06.972384 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:06.973606 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:06.974185 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:06.974879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:06.975336 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:06.980652 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:06.981347 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:07.015942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.016456 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241102140507009980"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:07.016940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:07.032256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.040221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.040695 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:07.041353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.041800 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.042233 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241102140507009980'
      
      
      order by ordinal_position

  
[0m14:05:07.063383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.069969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.070461 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:07.073528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.081197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.081683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:07.084411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.102439 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:07.103151 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.103628 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241102140507009980"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241102140507009980"
    )
  
[0m14:05:07.134902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.136857 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:07.137365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.137817 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:07.145513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.146415 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:07.310585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc3b7c8f0>]}
[0m14:05:07.311409 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:07.312174 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:07.313671 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.314162 [debug] [MainThread]: On master: BEGIN
[0m14:05:07.314602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:07.321290 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.321768 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.322213 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.322640 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.323237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.323696 [debug] [MainThread]: On master: Close
[0m14:05:07.325014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:07.325510 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:07.325930 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:07.326398 [info ] [MainThread]: 
[0m14:05:07.326947 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.57 seconds (11.57s).
[0m14:05:07.327982 [debug] [MainThread]: Command end result
[0m14:05:07.356488 [info ] [MainThread]: 
[0m14:05:07.357167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:07.357717 [info ] [MainThread]: 
[0m14:05:07.358272 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:07.359305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.515763, "process_user_time": 5.674154, "process_kernel_time": 0.28471, "process_mem_max_rss": "291952", "process_in_blocks": "3808", "process_out_blocks": "114640"}
[0m14:05:07.359969 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:07.359857 after 13.52 seconds
[0m14:05:07.360467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ffbc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc811ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20073dd940>]}
[0m14:05:07.360962 [debug] [MainThread]: Flushing usage events
[0m14:05:09.227647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7d64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772e628f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7b2540>]}


============================== 14:05:09.230512 | 4376a041-977e-4c72-8442-5e24e84b13e9 ==============================
[0m14:05:09.230512 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:09.231319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:09.402820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4376a041-977e-4c72-8442-5e24e84b13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772e104a10>]}
[0m14:05:09.419209 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.24267696, "process_user_time": 1.404137, "process_kernel_time": 0.135626, "process_mem_max_rss": "92156", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:09.419787 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:09.419678 after 0.24 seconds
[0m14:05:09.420217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772df93860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772e104a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7b0560>]}
[0m14:05:09.420647 [debug] [MainThread]: Flushing usage events
[0m22:06:20.006241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06148d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc063668440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06148d400>]}


============================== 22:06:20.013622 | 35c5634e-10bd-4a4a-86aa-2a36a90c453c ==============================
[0m22:06:20.013622 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:20.014286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:20.152981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35c5634e-10bd-4a4a-86aa-2a36a90c453c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0614b03e0>]}
[0m22:06:20.166336 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xbrengfd'
[0m22:06:20.166820 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:20.256328 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:20.256940 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:20.279108 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:20.282976 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:20.352894 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:20.353407 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:20.353937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35c5634e-10bd-4a4a-86aa-2a36a90c453c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06107bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06103f680>]}
[0m22:06:20.354383 [info ] [MainThread]: 
[0m22:06:20.354858 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:20.356397 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3983425, "process_user_time": 1.611859, "process_kernel_time": 0.073081, "process_mem_max_rss": "93680", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:20.356965 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:20.356863 after 0.40 seconds
[0m22:06:20.357388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc061aad160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0618686e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0614b03e0>]}
[0m22:06:20.357805 [debug] [MainThread]: Flushing usage events
[0m22:06:21.960411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d32ec7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d6213410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2f96570>]}


============================== 22:06:21.963156 | 912133c3-7dac-409e-ab03-c2c3f5c562d9 ==============================
[0m22:06:21.963156 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.963829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:22.194966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2db5100>]}
[0m22:06:22.253988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d6213410>]}
[0m22:06:22.256406 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:22.341631 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:22.342361 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:22.342905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2c38470>]}
[0m22:06:23.570235 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:23.570918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cbdc3470>]}
[0m22:06:23.751047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:23.756027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cb7064e0>]}
[0m22:06:23.874893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cb7e10a0>]}
[0m22:06:23.875446 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:23.875954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cb71ca40>]}
[0m22:06:23.877618 [info ] [MainThread]: 
[0m22:06:23.878295 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:23.883132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:23.919653 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:23.920100 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:23.920499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:24.407723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.409268 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:24.411564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:24.412131 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:24.419272 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.419708 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:24.420104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.426303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.427738 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.428152 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:24.428689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.429082 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.429460 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:24.430024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.430978 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.431387 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.431778 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.432311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.432713 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:24.434532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:24.441551 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.441963 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:24.442344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.448058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.448474 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.448874 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:24.472018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.473517 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:24.474778 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:24.475184 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:24.478568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d34c9730>]}
[0m22:06:24.479129 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.479526 [debug] [MainThread]: On master: BEGIN
[0m22:06:24.479900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:24.486196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.486663 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.487066 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.487447 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.488003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.488416 [debug] [MainThread]: On master: Close
[0m22:06:24.489917 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:24.490406 [info ] [MainThread]: 
[0m22:06:24.500428 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:24.501409 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:24.502388 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:24.502935 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:24.528863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:24.529625 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:24.565220 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:24.565951 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:30.832527 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.833077 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:30.833704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.834158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.834595 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:30.835377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.838185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.838673 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:30.839350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.860182 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.860665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.861106 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.863077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.867993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.868461 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:30.869595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.871918 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:30.901085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388c2c1a00>]}
[0m22:06:30.901800 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.40s]
[0m22:06:30.902721 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:30.903695 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:30.904263 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:30.904928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:30.905387 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:30.910345 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:30.911025 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:30.944746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.945264 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241102220630938766"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:30.945738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.960021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.967507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.967971 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:30.968558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.969004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.969449 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241102220630938766'
      
      
      order by ordinal_position

  
[0m22:06:30.989683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.995728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.996214 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.999360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.006810 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.007282 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:31.009945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.027858 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:31.028536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.029009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241102220630938766"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241102220630938766"
    )
  
[0m22:06:31.059190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.061179 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.061638 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.062066 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.071293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.072233 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:31.241388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388c243cb0>]}
[0m22:06:31.242194 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:06:31.242979 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:31.244434 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.244934 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.245596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:31.252390 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.252867 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.253306 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.253740 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.254318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.254819 [debug] [MainThread]: On master: Close
[0m22:06:31.256285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:31.256729 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:31.257139 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:31.257604 [info ] [MainThread]: 
[0m22:06:31.258142 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m22:06:31.259177 [debug] [MainThread]: Command end result
[0m22:06:31.287299 [info ] [MainThread]: 
[0m22:06:31.287919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:31.288426 [info ] [MainThread]: 
[0m22:06:31.288945 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:31.289936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.377785, "process_user_time": 5.462315, "process_kernel_time": 0.342639, "process_mem_max_rss": "290648", "process_in_blocks": "3808", "process_out_blocks": "114672"}
[0m22:06:31.290581 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:31.290471 after 9.38 seconds
[0m22:06:31.291121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2f96480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a5916540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a59f94c0>]}
[0m22:06:31.291604 [debug] [MainThread]: Flushing usage events
[0m22:06:32.914970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d9e5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9ca71e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9ca71d30>]}


============================== 22:06:32.917689 | 7ee3cd1d-106d-47a1-bc73-17cf6ccb94c1 ==============================
[0m22:06:32.917689 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:32.918425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:33.055249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ee3cd1d-106d-47a1-bc73-17cf6ccb94c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d01c0b0>]}
[0m22:06:33.071740 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20546384, "process_user_time": 1.398796, "process_kernel_time": 0.095917, "process_mem_max_rss": "92180", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:33.072310 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:33.072207 after 0.21 seconds
[0m22:06:33.072745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9c170f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d1c9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9c11c500>]}
[0m22:06:33.073176 [debug] [MainThread]: Flushing usage events
[0m06:02:13.091116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342a81460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342bce1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342edb0e0>]}


============================== 06:02:13.098493 | 52aede50-c798-4277-9122-14f1a7110e1b ==============================
[0m06:02:13.098493 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.099155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.242479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52aede50-c798-4277-9122-14f1a7110e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342e957f0>]}
[0m06:02:13.256349 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3czfyp_v'
[0m06:02:13.256827 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.298178 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.298909 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.309948 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.313788 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.542158 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.542761 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:13.543311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '52aede50-c798-4277-9122-14f1a7110e1b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3428b4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34287b4d0>]}
[0m06:02:13.543782 [info ] [MainThread]: 
[0m06:02:13.544233 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.545799 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50323534, "process_user_time": 1.592267, "process_kernel_time": 0.104279, "process_mem_max_rss": "93768", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m06:02:13.546393 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.546290 after 0.50 seconds
[0m06:02:13.546837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342e8ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3432bc140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342e957f0>]}
[0m06:02:13.547312 [debug] [MainThread]: Flushing usage events
[0m06:02:15.367547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cab37500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cab36ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cab36f30>]}


============================== 06:02:15.370432 | fcd65862-d22f-44ea-969e-3bc4a9e41c7f ==============================
[0m06:02:15.370432 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:15.371105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.607972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cba2a870>]}
[0m06:02:15.667730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cbbc4590>]}
[0m06:02:15.670391 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:15.686594 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.687385 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.687925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ca8b0140>]}
[0m06:02:16.921508 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.922227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c34da000>]}
[0m06:02:17.103353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:17.108634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c34bf140>]}
[0m06:02:17.238989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c34858b0>]}
[0m06:02:17.239578 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:17.240079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c3294380>]}
[0m06:02:17.241802 [info ] [MainThread]: 
[0m06:02:17.242512 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:17.247468 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:17.283611 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:17.284104 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:17.284515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.768683 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.770292 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.772632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.773251 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.780689 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.781140 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.781547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.788099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.789605 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.790014 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.790562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.790960 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.791376 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.791948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.792882 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.793285 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.793667 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.794207 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.794619 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.796794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.803579 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.803993 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.804371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.810607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.811021 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.811446 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.833329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.834946 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.836270 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.836678 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.840296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c218ca40>]}
[0m06:02:17.840821 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.841214 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.841589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.848162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.848601 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.848995 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.849375 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.849909 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.850325 [debug] [MainThread]: On master: Close
[0m06:02:17.851812 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.852310 [info ] [MainThread]: 
[0m06:02:17.861912 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.862558 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.863268 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:17.863713 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.890240 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.890988 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.927312 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.928135 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:29.057568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.058124 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:29.058826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.059328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.059766 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:29.060500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.063480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.063941 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:29.064625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.085762 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.086243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.086682 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.087925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.092989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.093457 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:29.094825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.097221 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:29.126837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c33fcf80>]}
[0m06:02:29.127647 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.26s]
[0m06:02:29.128430 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:29.129413 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:29.129977 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:29.130549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:29.131012 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:29.136419 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:29.137098 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.171643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.172196 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241103060229165603"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.172688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.188257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.196389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.196896 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.197568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.198026 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.198479 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241103060229165603'
      
      
      order by ordinal_position

  
[0m06:02:29.220364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.226995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.227515 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.230770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.238642 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.239125 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.242116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.260321 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.261043 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.261516 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241103060229165603"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241103060229165603"
    )
  
[0m06:02:29.294029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.296130 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.296631 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.297074 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.306458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.307436 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:29.491387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe080159490>]}
[0m06:02:29.492220 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:29.492972 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:29.494485 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.494969 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.495451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:29.502454 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.502939 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.503431 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.503862 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.504506 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.504961 [debug] [MainThread]: On master: Close
[0m06:02:29.506479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:29.506921 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:29.507367 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:29.507834 [info ] [MainThread]: 
[0m06:02:29.508372 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.27 seconds (12.27s).
[0m06:02:29.509370 [debug] [MainThread]: Command end result
[0m06:02:29.537185 [info ] [MainThread]: 
[0m06:02:29.537906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:29.538500 [info ] [MainThread]: 
[0m06:02:29.539094 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:29.540217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.220985, "process_user_time": 5.122275, "process_kernel_time": 0.346799, "process_mem_max_rss": "293356", "process_in_blocks": "3808", "process_out_blocks": "115152"}
[0m06:02:29.540859 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:29.540748 after 14.22 seconds
[0m06:02:29.541375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ce5bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe081341940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cb4cb680>]}
[0m06:02:29.541865 [debug] [MainThread]: Flushing usage events
[0m06:02:31.455312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b4e67620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b5075ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b4e66690>]}


============================== 06:02:31.458261 | 142e5287-c8c6-4cfe-a17a-edc6976be168 ==============================
[0m06:02:31.458261 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.458974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.603338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '142e5287-c8c6-4cfe-a17a-edc6976be168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b53d26f0>]}
[0m06:02:31.620244 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21368173, "process_user_time": 1.417774, "process_kernel_time": 0.10783, "process_mem_max_rss": "92228", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:31.620828 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:31.620725 after 0.21 seconds
[0m06:02:31.621266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b5e2c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b4e66510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b6462f30>]}
[0m06:02:31.621692 [debug] [MainThread]: Flushing usage events
[0m14:04:47.087650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d357d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d3827e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d3965070>]}


============================== 14:04:47.095216 | ac2919ac-830a-4970-bb66-1542c1b40a12 ==============================
[0m14:04:47.095216 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.095957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.241029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2919ac-830a-4970-bb66-1542c1b40a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d357f7a0>]}
[0m14:04:47.255273 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7avzfb1s'
[0m14:04:47.255742 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:47.365785 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:47.366551 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:47.397157 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:47.401146 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:47.763042 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:47.763608 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:47.764220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ac2919ac-830a-4970-bb66-1542c1b40a12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d33028d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d3302cc0>]}
[0m14:04:47.764673 [info ] [MainThread]: 
[0m14:04:47.765185 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:47.789317 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7526818, "process_user_time": 1.661102, "process_kernel_time": 0.100308, "process_mem_max_rss": "93620", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:04:47.789997 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:47.789893 after 0.75 seconds
[0m14:04:47.790504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d35c2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d324f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d324df70>]}
[0m14:04:47.790969 [debug] [MainThread]: Flushing usage events
[0m14:04:49.674098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526da01ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526f4259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d109640>]}


============================== 14:04:49.677085 | 5cc27099-a5ff-4a04-900a-4b7330874407 ==============================
[0m14:04:49.677085 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:49.677846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.924176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d03ed80>]}
[0m14:04:49.988258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265f11b20>]}
[0m14:04:49.991003 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:50.007350 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:50.008086 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:50.008633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526cefbb60>]}
[0m14:04:51.254831 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:51.255505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265d37380>]}
[0m14:04:51.450535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:51.456000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52658ebb60>]}
[0m14:04:51.582181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52659d5dc0>]}
[0m14:04:51.582774 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:51.583316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52657b32c0>]}
[0m14:04:51.585050 [info ] [MainThread]: 
[0m14:04:51.585781 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:51.590584 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:51.626928 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:51.627396 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:51.627816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:52.190992 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:52.192610 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:52.194864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:52.195456 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:52.202868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.203302 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:52.203703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.210131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.211643 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.212047 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:52.212659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.213057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.213433 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:52.214000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.214954 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.215366 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.215748 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.216276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.216682 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:52.218634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:52.225745 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.226156 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:52.226559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.232175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.232598 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.233001 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:52.256225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.257652 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:52.258895 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:52.259306 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:52.262548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526e5ace30>]}
[0m14:04:52.263076 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.263470 [debug] [MainThread]: On master: BEGIN
[0m14:04:52.263842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:52.270184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.270647 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.271037 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.271415 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.271985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.272390 [debug] [MainThread]: On master: Close
[0m14:04:52.273997 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:52.274536 [info ] [MainThread]: 
[0m14:04:52.283898 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:52.284508 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:52.285189 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:52.285644 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:52.312622 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:52.313388 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:52.350629 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:52.351372 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:05.238268 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.238824 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:05.239483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.239952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.240407 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:05.241113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.243975 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.244433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:05.245107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.266979 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:05.267480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.267953 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:05.269409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.274498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.274985 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:05.276352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.278709 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:05.307874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f522a30f9e0>]}
[0m14:05:05.308663 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.02s]
[0m14:05:05.309574 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:05.310586 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:05.311150 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:05.311807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:05.312259 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:05.317221 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:05.317874 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:05.351512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.352041 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241103140505345535"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:05.352532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:05.367068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.374581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.375049 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:05.375645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.376090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.376527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241103140505345535'
      
      
      order by ordinal_position

  
[0m14:05:05.397248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.403588 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.404084 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:05.407519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.415004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.415478 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:05.418219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.436909 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:05.437613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.438086 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241103140505345535"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241103140505345535"
    )
  
[0m14:05:05.470477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.472447 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:05.472911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.473334 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:05.482096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.483026 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:05.668595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f522a36e2a0>]}
[0m14:05:05.669446 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:05.670213 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:05.671660 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.672185 [debug] [MainThread]: On master: BEGIN
[0m14:05:05.672637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:05.679330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.679790 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.680219 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.680634 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.681201 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.681650 [debug] [MainThread]: On master: Close
[0m14:05:05.683028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:05.683463 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:05.683912 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:05.684367 [info ] [MainThread]: 
[0m14:05:05.684897 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.10 seconds (14.10s).
[0m14:05:05.685887 [debug] [MainThread]: Command end result
[0m14:05:05.713938 [info ] [MainThread]: 
[0m14:05:05.714577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:05.715099 [info ] [MainThread]: 
[0m14:05:05.715630 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:05.716635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.094795, "process_user_time": 5.616873, "process_kernel_time": 0.299194, "process_mem_max_rss": "297624", "process_in_blocks": "3808", "process_out_blocks": "115152"}
[0m14:05:05.717293 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:05.717179 after 16.10 seconds
[0m14:05:05.717792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526f4259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d4fc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526580c2c0>]}
[0m14:05:05.718281 [debug] [MainThread]: Flushing usage events
[0m14:05:07.676126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c544620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c3371a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c4aa450>]}


============================== 14:05:07.678901 | f4fdb7f4-ddc7-4b89-9ee0-b88436b70c0d ==============================
[0m14:05:07.678901 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:07.679534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:07.821418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4fdb7f4-ddc7-4b89-9ee0-b88436b70c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c2e2e70>]}
[0m14:05:07.838175 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21326722, "process_user_time": 1.44353, "process_kernel_time": 0.124303, "process_mem_max_rss": "91996", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:07.838809 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:07.838701 after 0.21 seconds
[0m14:05:07.839257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c7bf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c3369c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53db61e80>]}
[0m14:05:07.839696 [debug] [MainThread]: Flushing usage events
[0m22:06:02.406512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00e83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f013b6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00cb2540>]}


============================== 22:06:02.427473 | 45b4c90b-ac99-4044-86a8-cea3e0e25a53 ==============================
[0m22:06:02.427473 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:02.428204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:02.577784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45b4c90b-ac99-4044-86a8-cea3e0e25a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00439190>]}
[0m22:06:02.591810 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hc86e2ec'
[0m22:06:02.592307 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:02.782126 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:02.782957 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:02.851506 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:02.855723 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:03.240764 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:03.241393 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:03.241959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '45b4c90b-ac99-4044-86a8-cea3e0e25a53', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00174b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00198a10>]}
[0m22:06:03.242434 [info ] [MainThread]: 
[0m22:06:03.242950 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:03.276993 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.92011005, "process_user_time": 1.659421, "process_kernel_time": 0.126733, "process_mem_max_rss": "93272", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:03.277732 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:03.277609 after 0.92 seconds
[0m22:06:03.278218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00e83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00174b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00176240>]}
[0m22:06:03.278693 [debug] [MainThread]: Flushing usage events
[0m22:06:05.225739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6273a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb63b1a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6273a600>]}


============================== 22:06:05.228696 | 5f3375ed-83f4-4373-8016-5b1343c314d8 ==============================
[0m22:06:05.228696 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.229451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:05.473803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb624feb40>]}
[0m22:06:05.534994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6273b170>]}
[0m22:06:05.537659 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:05.605719 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:05.606503 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:05.607076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b50ff50>]}
[0m22:06:06.863239 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:06.863946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b08a300>]}
[0m22:06:07.050814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:07.056373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae026f0>]}
[0m22:06:07.196455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae03260>]}
[0m22:06:07.197065 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:07.197595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae389e0>]}
[0m22:06:07.199460 [info ] [MainThread]: 
[0m22:06:07.200183 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:07.205286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:07.241836 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:07.242361 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:07.242790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:07.895967 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:07.897504 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:07.899727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:07.900292 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:07.907517 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.907997 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:07.908395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:07.914885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.916444 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.916848 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:07.917445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.917879 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.918259 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:07.918879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.919814 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:07.920213 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.920589 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:07.921183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.921605 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:07.923832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:07.931202 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:07.931637 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:07.932013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:07.938230 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.938648 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:07.939100 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:07.962285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.963966 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:07.965255 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:07.965689 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:07.969465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae87c50>]}
[0m22:06:07.970010 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.970405 [debug] [MainThread]: On master: BEGIN
[0m22:06:07.970811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:07.977241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.977697 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.978089 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.978466 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.979112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.979533 [debug] [MainThread]: On master: Close
[0m22:06:07.981049 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:07.981562 [info ] [MainThread]: 
[0m22:06:07.995018 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:07.995685 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:07.996373 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:07.996833 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:08.023487 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:08.024342 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:08.061049 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:08.061958 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:23.413181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.413703 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:23.414371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.414840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.415275 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:23.415999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.419036 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.419492 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:23.420224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.441575 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:23.442166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.442624 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:23.445131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.450794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.451317 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:23.452986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.455485 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:23.485518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b0a6ab0>]}
[0m22:06:23.486327 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 15.49s]
[0m22:06:23.487233 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:23.488269 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:23.488835 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:23.489515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:23.489974 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:23.495378 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:23.496052 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:23.530640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.531263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241103220623524547"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:23.531740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:23.546317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.554357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.554877 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:23.555579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.556033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.556475 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241103220623524547'
      
      
      order by ordinal_position

  
[0m22:06:23.577414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.585073 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.585681 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:23.589240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.598029 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.598653 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:23.602027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.620788 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:23.621598 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.622109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241103220623524547"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241103220623524547"
    )
  
[0m22:06:23.653143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.655353 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:23.655892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.656377 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:23.666385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.667565 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:23.856255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb13900590>]}
[0m22:06:23.857162 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:23.858077 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:23.859758 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.860276 [debug] [MainThread]: On master: BEGIN
[0m22:06:23.860705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:23.867783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.868317 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.868752 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.869170 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.869847 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.870302 [debug] [MainThread]: On master: Close
[0m22:06:23.872084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:23.872519 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:23.872933 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:23.873402 [info ] [MainThread]: 
[0m22:06:23.873930 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 16.67 seconds (16.67s).
[0m22:06:23.874976 [debug] [MainThread]: Command end result
[0m22:06:23.903641 [info ] [MainThread]: 
[0m22:06:23.904355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:23.904869 [info ] [MainThread]: 
[0m22:06:23.905384 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:23.906412 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.73013, "process_user_time": 5.888711, "process_kernel_time": 0.342181, "process_mem_max_rss": "295324", "process_in_blocks": "3808", "process_out_blocks": "116720"}
[0m22:06:23.907089 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:23.906975 after 18.73 seconds
[0m22:06:23.907594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb661bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb182664e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b0a4e60>]}
[0m22:06:23.908080 [debug] [MainThread]: Flushing usage events
[0m22:06:25.916681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d42bab950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d433a8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d43309280>]}


============================== 22:06:25.919635 | 0a9b469d-6bb7-467e-a409-cce609170678 ==============================
[0m22:06:25.919635 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:25.920373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.066211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a9b469d-6bb7-467e-a409-cce609170678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4266f980>]}
[0m22:06:26.083405 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2158262, "process_user_time": 1.431461, "process_kernel_time": 0.119954, "process_mem_max_rss": "92376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:26.084004 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:26.083898 after 0.22 seconds
[0m22:06:26.084444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d44c15dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d438d2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d426fdbe0>]}
[0m22:06:26.084875 [debug] [MainThread]: Flushing usage events
[0m06:02:12.614348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750da867b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d4e7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d48eb70>]}


============================== 06:02:12.622064 | 1ae96c92-0028-4679-bbdf-87e0d01fd870 ==============================
[0m06:02:12.622064 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.622849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.771297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ae96c92-0028-4679-bbdf-87e0d01fd870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750ce9a750>]}
[0m06:02:12.785239 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6n__ac87'
[0m06:02:12.785728 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:12.831023 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:12.831672 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:12.843184 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:12.847088 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.997740 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.998389 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:12.999091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1ae96c92-0028-4679-bbdf-87e0d01fd870', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750cc4bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750cc4bc20>]}
[0m06:02:12.999572 [info ] [MainThread]: 
[0m06:02:13.000111 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.001866 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4384962, "process_user_time": 1.594374, "process_kernel_time": 0.142779, "process_mem_max_rss": "93576", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:13.002477 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.002371 after 0.44 seconds
[0m06:02:13.002956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d9dfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d23b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d2391f0>]}
[0m06:02:13.003394 [debug] [MainThread]: Flushing usage events
[0m06:02:14.696480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da55dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da55ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da55d5b0>]}


============================== 06:02:14.699547 | 6e0b30ee-2e98-44e5-964d-c2a2f6d6392a ==============================
[0m06:02:14.699547 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.700206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.940562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d2b34b90>]}
[0m06:02:15.000258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d9a370e0>]}
[0m06:02:15.002993 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:15.018783 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.019546 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.020070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d9b7aff0>]}
[0m06:02:16.247075 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.247700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d25df380>]}
[0m06:02:16.430705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.436093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d291ac00>]}
[0m06:02:16.564426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d24b9460>]}
[0m06:02:16.564994 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:16.565474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d234bbf0>]}
[0m06:02:16.567211 [info ] [MainThread]: 
[0m06:02:16.567915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.572603 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.608708 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.609195 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.609608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.057181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.058790 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.061049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.061599 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.068758 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.069188 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.069576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.076075 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.077541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.077945 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.078498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.078936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.079313 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.079880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.080800 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.081192 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.081560 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.082157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.082574 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.084672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.091923 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.092333 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.092703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.098841 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.099250 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.099639 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.123144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.124714 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.125932 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.126327 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.129844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d2423a10>]}
[0m06:02:17.130360 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.130781 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.131166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.137620 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.138059 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.138445 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.138857 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.139447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.139851 [debug] [MainThread]: On master: Close
[0m06:02:17.141452 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.141947 [info ] [MainThread]: 
[0m06:02:17.151928 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.152542 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.153206 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:17.153641 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.179537 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.180310 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.216113 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.216905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:24.655862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.656384 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:24.657031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.657487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.657919 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:24.658625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.661512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.661963 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:24.662734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.683556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.684035 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.684468 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.685777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.690721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.691208 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:24.692352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.694672 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:24.724142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84933c1cd0>]}
[0m06:02:24.724902 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.57s]
[0m06:02:24.725779 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:24.726809 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:24.727438 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:24.728113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:24.728563 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:24.733762 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:24.734420 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:24.768270 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.768835 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241104060224762235"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:24.769305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:24.786556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.794614 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.795129 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:24.795767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.796209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.796639 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241104060224762235'
      
      
      order by ordinal_position

  
[0m06:02:24.822978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.829673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.830168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.833158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.840892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.841383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.844396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.862541 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:24.863351 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.863835 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241104060224762235"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241104060224762235"
    )
  
[0m06:02:24.897188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.899272 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.899727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.900147 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.909483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.910379 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:25.103326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8492e46b10>]}
[0m06:02:25.104403 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:25.105381 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:25.106850 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.107316 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.107750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:25.114779 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.115263 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.115695 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.116109 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.116725 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.117174 [debug] [MainThread]: On master: Close
[0m06:02:25.118794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:25.119229 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:25.119628 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:25.120082 [info ] [MainThread]: 
[0m06:02:25.120665 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m06:02:25.121776 [debug] [MainThread]: Command end result
[0m06:02:25.149997 [info ] [MainThread]: 
[0m06:02:25.150784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:25.151378 [info ] [MainThread]: 
[0m06:02:25.151973 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:25.153085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.5054865, "process_user_time": 5.537707, "process_kernel_time": 0.376115, "process_mem_max_rss": "301460", "process_in_blocks": "3808", "process_out_blocks": "116696"}
[0m06:02:25.153729 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:25.153616 after 10.51 seconds
[0m06:02:25.154224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84dbf7dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da03c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d25bd1c0>]}
[0m06:02:25.154713 [debug] [MainThread]: Flushing usage events
[0m06:02:26.940397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4326709220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4325c1e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4325c1c860>]}


============================== 06:02:26.943338 | 7253273c-a5ea-4a00-97f3-65cd194a0604 ==============================
[0m06:02:26.943338 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.944085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.090336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7253273c-a5ea-4a00-97f3-65cd194a0604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f432575fc20>]}
[0m06:02:27.107697 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21862893, "process_user_time": 1.466848, "process_kernel_time": 0.095924, "process_mem_max_rss": "92152", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:27.108311 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:27.108195 after 0.22 seconds
[0m06:02:27.108770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43287bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4324ec0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4324beb290>]}
[0m06:02:27.109213 [debug] [MainThread]: Flushing usage events
[0m14:05:18.773590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978e49a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978ce3c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978ce3cf80>]}


============================== 14:05:18.790519 | f3de81ee-c081-45d9-a940-1fbe67adde03 ==============================
[0m14:05:18.790519 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.791279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.927918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3de81ee-c081-45d9-a940-1fbe67adde03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978ce94d70>]}
[0m14:05:18.941414 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f_mcs2p2'
[0m14:05:18.941870 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:19.039840 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:19.040488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:19.064011 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:19.067801 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:19.140852 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:19.141356 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:19.141875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3de81ee-c081-45d9-a940-1fbe67adde03', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978da07830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978c28fb00>]}
[0m14:05:19.142328 [info ] [MainThread]: 
[0m14:05:19.142797 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:19.151455 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42592555, "process_user_time": 1.5428, "process_kernel_time": 0.149825, "process_mem_max_rss": "93792", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:19.152132 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:19.152028 after 0.43 seconds
[0m14:05:19.152586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978c66a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97901bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97901bbd40>]}
[0m14:05:19.153002 [debug] [MainThread]: Flushing usage events
[0m14:05:20.742051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8c55850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8f48b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8c57c50>]}


============================== 14:05:20.744880 | 83d04a3e-2fc7-413b-bf01-8b87665c6015 ==============================
[0m14:05:20.744880 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:20.745608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.985014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff1b94080>]}
[0m14:05:21.043771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ffa7d7920>]}
[0m14:05:21.046264 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:21.073215 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:21.073980 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:21.074503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff1a12120>]}
[0m14:05:22.303560 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:22.304215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff148ee40>]}
[0m14:05:22.483350 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:22.488458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff196b710>]}
[0m14:05:22.612192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff13bc710>]}
[0m14:05:22.612728 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:22.613206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff137caa0>]}
[0m14:05:22.614860 [info ] [MainThread]: 
[0m14:05:22.615536 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:22.620264 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:22.655348 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:22.655789 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:22.656213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:23.357105 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:23.358648 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:23.360840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:23.361430 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:23.368650 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.369085 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:23.369480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.375651 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.377135 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.377545 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:23.378084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.378475 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.378850 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:23.379419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.380373 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:23.380782 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.381163 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:23.381701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.382103 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:23.384075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:23.390684 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:23.391111 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:23.391501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.397415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.397825 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:23.398223 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:23.419972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.421470 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:23.422687 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:23.423094 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:23.426355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff130baa0>]}
[0m14:05:23.426863 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.427252 [debug] [MainThread]: On master: BEGIN
[0m14:05:23.427614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:23.433794 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.434217 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.434615 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.434987 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.435507 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.435906 [debug] [MainThread]: On master: Close
[0m14:05:23.437271 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:23.437760 [info ] [MainThread]: 
[0m14:05:23.452761 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:23.453357 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:23.454013 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:23.454446 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:23.480247 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:23.480989 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:23.517243 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:23.518054 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:30.730358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.730877 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.731504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.731957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.732433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.733136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.735981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.736462 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.737133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.757920 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.758401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.758844 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.761097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.766027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.766503 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:30.768346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.770651 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.802733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fadf0c290>]}
[0m14:05:30.803447 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.35s]
[0m14:05:30.804245 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.805236 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.805817 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.806388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.806841 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.811890 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.812573 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.846704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.847224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241104140530840770"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.847699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.861879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.869570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.870032 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.870624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.871068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.871499 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241104140530840770'
      
      
      order by ordinal_position

  
[0m14:05:30.891972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.898223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.898709 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.901542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.909136 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.909612 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.912671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.930760 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.931451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.931932 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241104140530840770"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241104140530840770"
    )
  
[0m14:05:30.963534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.965544 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.966017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.966447 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.976400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.977303 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:31.649384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fadf101d0>]}
[0m14:05:31.650233 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.84s]
[0m14:05:31.651033 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:31.652507 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.652985 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.653417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:31.659987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.660499 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.660939 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.661375 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.661953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.662404 [debug] [MainThread]: On master: Close
[0m14:05:31.663965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:31.664451 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:31.664861 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:31.665333 [info ] [MainThread]: 
[0m14:05:31.665875 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.05 seconds (9.05s).
[0m14:05:31.666910 [debug] [MainThread]: Command end result
[0m14:05:31.694894 [info ] [MainThread]: 
[0m14:05:31.695579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:31.696193 [info ] [MainThread]: 
[0m14:05:31.696800 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:31.697897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.004663, "process_user_time": 5.943849, "process_kernel_time": 0.3893, "process_mem_max_rss": "358632", "process_in_blocks": "3808", "process_out_blocks": "132656"}
[0m14:05:31.698539 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:31.698427 after 11.01 seconds
[0m14:05:31.699029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8c55850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff13881a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faebec710>]}
[0m14:05:31.699509 [debug] [MainThread]: Flushing usage events
[0m14:05:33.350566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b1980e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83bec8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b96c2f0>]}


============================== 14:05:33.353441 | f7e8d24d-c08b-4f0e-b167-4559fa1e2f51 ==============================
[0m14:05:33.353441 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.354160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.496572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e8d24d-c08b-4f0e-b167-4559fa1e2f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83af02900>]}
[0m14:05:33.513656 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21192129, "process_user_time": 1.417222, "process_kernel_time": 0.099804, "process_mem_max_rss": "92120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:33.514250 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:33.514145 after 0.21 seconds
[0m14:05:33.514684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b237c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83af27ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83af43890>]}
[0m14:05:33.515112 [debug] [MainThread]: Flushing usage events
[0m22:05:35.092821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd931f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd32f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd2fd070>]}


============================== 22:05:35.153181 | 285d845e-7a49-4900-8f66-4ac27f9495c6 ==============================
[0m22:05:35.153181 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.153857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.296748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '285d845e-7a49-4900-8f66-4ac27f9495c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd1792b0>]}
[0m22:05:35.310198 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ojz9cll9'
[0m22:05:35.310669 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:35.408302 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:35.408952 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:35.422877 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:35.426762 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:35.600707 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:35.601353 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:35.601978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '285d845e-7a49-4900-8f66-4ac27f9495c6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddcf3ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddcf3fe60>]}
[0m22:05:35.602445 [info ] [MainThread]: 
[0m22:05:35.602994 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:35.613089 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.56825286, "process_user_time": 1.595094, "process_kernel_time": 0.100194, "process_mem_max_rss": "93748", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:05:35.613776 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:35.613671 after 0.57 seconds
[0m22:05:35.614228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd299ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd983d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddcf3fe60>]}
[0m22:05:35.614658 [debug] [MainThread]: Flushing usage events
[0m22:05:37.272038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb660d7e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66034e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66034e5d0>]}


============================== 22:05:37.274862 | d6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e ==============================
[0m22:05:37.274862 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.275597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.516818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65ffeb590>]}
[0m22:05:37.576767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65ffbf290>]}
[0m22:05:37.579373 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:37.629812 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:37.630569 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:37.631164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6615c7830>]}
[0m22:05:38.874651 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:38.875330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6591b1a60>]}
[0m22:05:39.062331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:39.067797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb658b6de50>]}
[0m22:05:39.250231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb658a9c8f0>]}
[0m22:05:39.250869 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:39.251390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb658bd1130>]}
[0m22:05:39.253174 [info ] [MainThread]: 
[0m22:05:39.253883 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:39.259030 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:39.295992 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:39.296522 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:39.296949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:39.909140 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:39.910738 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:39.913178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:39.913780 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:39.921250 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.921697 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:39.922106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.928475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.929981 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.930406 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:39.931050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.931454 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.931835 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:39.932461 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.933403 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.933804 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.934177 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.934706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.935169 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:39.937292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:39.944674 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.945094 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:39.945472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.951642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.952057 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.952456 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:39.975837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.977394 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:39.978634 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:39.979100 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:39.982738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6618810a0>]}
[0m22:05:39.983305 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.983704 [debug] [MainThread]: On master: BEGIN
[0m22:05:39.984086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:39.990526 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.990992 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.991396 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.991780 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.992371 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.992786 [debug] [MainThread]: On master: Close
[0m22:05:39.994370 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:39.994922 [info ] [MainThread]: 
[0m22:05:40.036115 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.036794 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.037513 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:40.037959 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.063877 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.064734 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.102956 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.104080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:48.524199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.524721 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:48.525413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.525874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.526311 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:48.527071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.530000 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.530458 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:48.531184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.552110 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.552603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.553131 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.554918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.559956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.560427 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:48.561970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.564373 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:48.595259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb661836240>]}
[0m22:05:48.596086 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.56s]
[0m22:05:48.596893 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:48.597924 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:48.598502 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:48.599149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:48.599609 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:48.604996 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:48.605654 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:48.639851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.640420 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241104220548633884"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:48.640900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:48.655503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.663444 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.663934 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:48.664569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.665021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.665465 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241104220548633884'
      
      
      order by ordinal_position

  
[0m22:05:48.686539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.693284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.693789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.697181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.704918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.705400 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.708405 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.726371 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:48.727143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.727623 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241104220548633884"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241104220548633884"
    )
  
[0m22:05:48.757973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.760131 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.760640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.761094 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.771154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.772207 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:48.945571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6155e6300>]}
[0m22:05:48.946407 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:05:48.947213 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:48.948814 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.949295 [debug] [MainThread]: On master: BEGIN
[0m22:05:48.949730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:48.956659 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.957142 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.957584 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.958012 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.958601 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.959100 [debug] [MainThread]: On master: Close
[0m22:05:48.960903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:48.961342 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:48.961755 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:48.962227 [info ] [MainThread]: 
[0m22:05:48.962780 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.71 seconds (9.71s).
[0m22:05:48.963871 [debug] [MainThread]: Command end result
[0m22:05:48.992353 [info ] [MainThread]: 
[0m22:05:48.993044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:48.993604 [info ] [MainThread]: 
[0m22:05:48.994166 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:48.995272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.772239, "process_user_time": 5.767354, "process_kernel_time": 0.332193, "process_mem_max_rss": "294664", "process_in_blocks": "3808", "process_out_blocks": "114760"}
[0m22:05:48.995933 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:48.995818 after 11.77 seconds
[0m22:05:48.996450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb660d7e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6618809e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66002d280>]}
[0m22:05:48.996950 [debug] [MainThread]: Flushing usage events
[0m22:05:50.779321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea3c54980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea206d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea3c1e300>]}


============================== 22:05:50.782297 | 1284abb4-7818-4c0e-8978-9a75e0d5201c ==============================
[0m22:05:50.782297 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.783010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.949320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1284abb4-7818-4c0e-8978-9a75e0d5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea18b79e0>]}
[0m22:05:50.966227 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23743306, "process_user_time": 1.485748, "process_kernel_time": 0.076089, "process_mem_max_rss": "92388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:50.966819 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:50.966715 after 0.24 seconds
[0m22:05:50.967302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea3c54980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea1cd86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea1cd9730>]}
[0m22:05:50.967737 [debug] [MainThread]: Flushing usage events
[0m06:02:11.348815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e68da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e8d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e68500>]}


============================== 06:02:11.356424 | fed73414-93e1-4e3b-9949-138817aff127 ==============================
[0m06:02:11.356424 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.357110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.505756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed73414-93e1-4e3b-9949-138817aff127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44624f1280>]}
[0m06:02:11.519788 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-037hb3to'
[0m06:02:11.520252 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.592707 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.593342 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.604639 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.608520 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.657363 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.657872 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:11.658391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fed73414-93e1-4e3b-9949-138817aff127', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446224fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446224ffe0>]}
[0m06:02:11.658842 [info ] [MainThread]: 
[0m06:02:11.659322 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:11.662917 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3746829, "process_user_time": 1.613286, "process_kernel_time": 0.135771, "process_mem_max_rss": "93648", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:11.663527 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.663424 after 0.38 seconds
[0m06:02:11.664006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e39f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446252cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462bf5ca0>]}
[0m06:02:11.664428 [debug] [MainThread]: Flushing usage events
[0m06:02:13.295087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452a16540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452d0a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452cc2540>]}


============================== 06:02:13.297936 | 4b681688-2b1b-45d5-b609-69665da476b7 ==============================
[0m06:02:13.297936 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.298682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.538091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b930c80>]}
[0m06:02:13.600172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84532ac830>]}
[0m06:02:13.602686 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:13.622700 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.623419 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.623990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8453aa1280>]}
[0m06:02:14.851237 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.851916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452a9e840>]}
[0m06:02:15.031493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:15.036472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b378f50>]}
[0m06:02:15.158448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b35f6e0>]}
[0m06:02:15.158984 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:15.159488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b294920>]}
[0m06:02:15.161168 [info ] [MainThread]: 
[0m06:02:15.161941 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:15.166618 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:15.202275 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:15.202733 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:15.203148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.680119 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.681697 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.683966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.684547 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.691759 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.692198 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.692584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.698811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.700323 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.700725 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.701261 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.701650 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.702025 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.702605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.703512 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.703957 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.704332 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.704866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.705269 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.707077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.714208 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.714626 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.715001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.720853 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.721260 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.721649 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.745089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.746655 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.747899 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.748312 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.751779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b2ba5d0>]}
[0m06:02:15.752300 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.752696 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.753066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.759392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.759857 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.760248 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.760622 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.761172 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.761577 [debug] [MainThread]: On master: Close
[0m06:02:15.762881 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.763412 [info ] [MainThread]: 
[0m06:02:15.773242 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.773852 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.774585 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.775030 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.801147 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.801897 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.837620 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.838381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.464202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.464716 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.465379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.465836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.466263 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.467025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.469990 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.470443 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.471122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.491620 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.492112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.492542 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.494703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.499663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.500125 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.501442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.503770 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.532921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84208d2ae0>]}
[0m06:02:23.533693 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.76s]
[0m06:02:23.534464 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.535465 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.536064 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.536648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.537104 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.542335 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.542995 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.576768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.577310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241105060223570864"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.577798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.592657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.600402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.600870 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.601477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.601919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.602355 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241105060223570864'
      
      
      order by ordinal_position

  
[0m06:02:23.623295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.629744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.630224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.633072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.640694 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.641170 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.643998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.661942 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.662657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.663124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241105060223570864"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241105060223570864"
    )
  
[0m06:02:23.694185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.696246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.696708 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.697133 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.706572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.707535 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:23.887598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840bbf67b0>]}
[0m06:02:23.888448 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:23.889216 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:23.890621 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.891104 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.891541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:23.898364 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.898841 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.899279 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.899734 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.900323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.900776 [debug] [MainThread]: On master: Close
[0m06:02:23.902328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:23.902764 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:23.903165 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:23.903625 [info ] [MainThread]: 
[0m06:02:23.904274 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m06:02:23.905417 [debug] [MainThread]: Command end result
[0m06:02:23.934314 [info ] [MainThread]: 
[0m06:02:23.935060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:23.935673 [info ] [MainThread]: 
[0m06:02:23.936275 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:23.937379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.692699, "process_user_time": 5.507336, "process_kernel_time": 0.375137, "process_mem_max_rss": "297000", "process_in_blocks": "3808", "process_out_blocks": "115256"}
[0m06:02:23.938048 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:23.937935 after 10.69 seconds
[0m06:02:23.938545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452d0a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8440f537a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452e3c4a0>]}
[0m06:02:23.939034 [debug] [MainThread]: Flushing usage events
[0m06:02:25.608459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a620064e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a616fbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a63999b50>]}


============================== 06:02:25.611334 | 17908328-82f3-490a-ab5d-45f8ee3bef09 ==============================
[0m06:02:25.611334 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.612096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.758420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17908328-82f3-490a-ab5d-45f8ee3bef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a61b83170>]}
[0m06:02:25.775715 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21762906, "process_user_time": 1.391092, "process_kernel_time": 0.148329, "process_mem_max_rss": "91872", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:25.776307 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:25.776202 after 0.22 seconds
[0m06:02:25.776745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a615f1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a61e86b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a62b0da60>]}
[0m06:02:25.777170 [debug] [MainThread]: Flushing usage events
[0m14:05:14.536027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af2cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af2db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af2dc10>]}


============================== 14:05:14.573405 | 262606af-4a34-4d76-9ae1-27c56102b9e5 ==============================
[0m14:05:14.573405 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.574116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:14.717796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '262606af-4a34-4d76-9ae1-27c56102b9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9aff6840>]}
[0m14:05:14.731708 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5r9e4o4a'
[0m14:05:14.732188 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:14.772428 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:14.773155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:14.798831 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:14.802831 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:14.894164 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:14.894896 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:14.895559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '262606af-4a34-4d76-9ae1-27c56102b9e5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a56b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a5dec60>]}
[0m14:05:14.896068 [info ] [MainThread]: 
[0m14:05:14.896604 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:14.898744 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41106024, "process_user_time": 1.586378, "process_kernel_time": 0.139857, "process_mem_max_rss": "93764", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:14.899362 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:14.899254 after 0.41 seconds
[0m14:05:14.899819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a8c5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a56b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9abe7bc0>]}
[0m14:05:14.900265 [debug] [MainThread]: Flushing usage events
[0m14:05:16.585832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3287e02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3295821e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd329582e40>]}


============================== 14:05:16.588878 | 96fbab98-9525-4d6e-8e9a-f6721b8d98fb ==============================
[0m14:05:16.588878 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.589533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.833092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd321511400>]}
[0m14:05:16.892480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3284f97c0>]}
[0m14:05:16.895065 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:17.004678 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:17.005507 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:17.006084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd321434ce0>]}
[0m14:05:18.249057 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:18.249812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320e61100>]}
[0m14:05:18.436493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:18.441862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32144ade0>]}
[0m14:05:18.681548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320fd45f0>]}
[0m14:05:18.682139 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:18.682726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320ee6a80>]}
[0m14:05:18.684480 [info ] [MainThread]: 
[0m14:05:18.685218 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:18.690359 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:18.726627 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:18.727129 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:18.727531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:19.259998 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:19.261547 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:19.263607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:19.264250 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:19.271356 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.271786 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:19.272176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.278519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.280006 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.280442 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:19.280991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.281389 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.281771 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:19.282414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.283327 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:19.283730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.284100 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:19.284704 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.285117 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:19.287104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:19.294231 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:19.294699 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:19.295077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.301000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.301410 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:19.301802 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:19.325269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.326897 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:19.328137 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:19.328544 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:19.332201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320d9aff0>]}
[0m14:05:19.332758 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.333160 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.333541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:19.340305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.340749 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.341141 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.341517 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.342051 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.342501 [debug] [MainThread]: On master: Close
[0m14:05:19.343925 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:19.344434 [info ] [MainThread]: 
[0m14:05:19.388071 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:19.388751 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:19.389465 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:19.389907 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:19.416144 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:19.416894 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:19.453255 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:19.454151 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:26.224003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.224543 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:26.225275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.225739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.226184 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:26.227041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.230169 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.230676 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:26.231454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.252311 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.252807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.253255 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.255642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.260759 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.261244 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:26.262659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.265039 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:26.295312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e15ff9e0>]}
[0m14:05:26.296107 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.90s]
[0m14:05:26.296899 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:26.297881 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:26.298484 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:26.299092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:26.299546 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:26.304957 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:26.305660 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:26.340011 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.340544 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241105140526334003"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:26.341027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.356330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.364213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.364693 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:26.365320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.365777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.366222 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241105140526334003'
      
      
      order by ordinal_position

  
[0m14:05:26.387581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.394862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.395401 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.398398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.406364 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.406911 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.409997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.428447 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:26.429203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.429684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241105140526334003"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241105140526334003"
    )
  
[0m14:05:26.466012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.468069 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.468535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.468964 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.477447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.478397 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.671301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e16403e0>]}
[0m14:05:26.672135 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:26.673007 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.674502 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.674981 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.675413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.682243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.682775 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.683217 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.683649 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.684221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.684671 [debug] [MainThread]: On master: Close
[0m14:05:26.686324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.686805 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:26.687212 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.687677 [info ] [MainThread]: 
[0m14:05:26.688232 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m14:05:26.689280 [debug] [MainThread]: Command end result
[0m14:05:26.717501 [info ] [MainThread]: 
[0m14:05:26.718204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.718776 [info ] [MainThread]: 
[0m14:05:26.719332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.720407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.183106, "process_user_time": 5.700784, "process_kernel_time": 0.312701, "process_mem_max_rss": "297680", "process_in_blocks": "3808", "process_out_blocks": "115760"}
[0m14:05:26.721078 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.720955 after 10.18 seconds
[0m14:05:26.721583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e15fbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd328afc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd328467530>]}
[0m14:05:26.722069 [debug] [MainThread]: Flushing usage events
[0m14:05:28.404737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd7b4a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd48e3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd4814fe0>]}


============================== 14:05:28.407660 | 0dba4e3c-45dd-4478-b028-296cf15c1ed2 ==============================
[0m14:05:28.407660 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.408374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.562931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dba4e3c-45dd-4478-b028-296cf15c1ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd53a7fb0>]}
[0m14:05:28.579854 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22388662, "process_user_time": 1.430672, "process_kernel_time": 0.103903, "process_mem_max_rss": "92120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:28.580473 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.580364 after 0.22 seconds
[0m14:05:28.580923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd81bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd44e7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd45e9d00>]}
[0m14:05:28.581370 [debug] [MainThread]: Flushing usage events
[0m22:05:54.149361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48651c3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865eda060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865343b30>]}


============================== 22:05:54.157295 | 3fde295f-1b91-4f70-9c8f-773c2248c5a3 ==============================
[0m22:05:54.157295 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.157962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.297740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fde295f-1b91-4f70-9c8f-773c2248c5a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865c99dc0>]}
[0m22:05:54.310949 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-skspxlxs'
[0m22:05:54.311383 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:54.452348 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:54.453015 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:54.485167 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:54.489012 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:54.826834 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:54.827377 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:54.827887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3fde295f-1b91-4f70-9c8f-773c2248c5a3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4864ae49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4864ae7c50>]}
[0m22:05:54.828344 [info ] [MainThread]: 
[0m22:05:54.828842 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:54.830468 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7293067, "process_user_time": 1.552266, "process_kernel_time": 0.108297, "process_mem_max_rss": "93680", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:54.831048 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:54.830947 after 0.73 seconds
[0m22:05:54.831483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48687bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48651a2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865219bb0>]}
[0m22:05:54.831883 [debug] [MainThread]: Flushing usage events
[0m22:05:56.528629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec5c70>]}


============================== 22:05:56.531334 | c2c8c150-3144-4779-8307-0ebd15f36244 ==============================
[0m22:05:56.531334 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:56.531997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:56.759343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079423590>]}
[0m22:05:56.817806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90793d93d0>]}
[0m22:05:56.820355 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:56.836494 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:56.837266 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:56.837797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90792bf830>]}
[0m22:05:58.064305 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:58.064949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9072192090>]}
[0m22:05:58.244835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:58.249981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9071d2db20>]}
[0m22:05:58.368748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9071c489e0>]}
[0m22:05:58.369304 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:58.369781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9071de9d30>]}
[0m22:05:58.371450 [info ] [MainThread]: 
[0m22:05:58.372124 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:58.376872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:58.412455 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:58.412962 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:58.413371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:59.042620 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:59.044089 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:59.046201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:59.046764 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:59.053648 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.054040 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:59.054397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.060606 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.062010 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.062412 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:59.062955 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.063358 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.063736 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:59.064304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.065249 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.065651 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.066021 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.066551 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.066951 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:59.068932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:59.075904 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.076320 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:59.076727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.082571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.083025 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.083423 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:59.106917 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.108393 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:59.109658 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:59.110061 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:59.113456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907234ae70>]}
[0m22:05:59.113985 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.114380 [debug] [MainThread]: On master: BEGIN
[0m22:05:59.114748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:59.121310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.121731 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.122122 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.122497 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.123020 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.123419 [debug] [MainThread]: On master: Close
[0m22:05:59.125109 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:59.125603 [info ] [MainThread]: 
[0m22:05:59.135206 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:59.135897 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:59.136572 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:59.137029 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:59.163113 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:59.163868 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:59.199563 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:59.200300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:12.311499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.312034 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:12.312748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.313201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.313690 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:12.314489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.317542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.318004 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:12.318688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.339424 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:12.339909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.340343 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:12.341621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.346684 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.347143 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:12.348357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.350763 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:12.380469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec6540>]}
[0m22:06:12.381355 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.24s]
[0m22:06:12.382179 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:12.383202 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:12.383774 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:12.384398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:12.384893 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:12.390347 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:12.391025 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:12.424747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.425316 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241105220612418769"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:12.425786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:12.441173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.448910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.449385 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:12.450002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.450447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.450881 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241105220612418769'
      
      
      order by ordinal_position

  
[0m22:06:12.472017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.478779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.479282 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:12.482650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.490463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.490940 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:12.494070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.511950 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:12.512725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.513211 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241105220612418769"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241105220612418769"
    )
  
[0m22:06:12.547069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.549189 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:12.549665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.550098 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:12.558397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.559329 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:12.785807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90327e90a0>]}
[0m22:06:12.786721 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.40s]
[0m22:06:12.787601 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:12.789391 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.789900 [debug] [MainThread]: On master: BEGIN
[0m22:06:12.790413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:12.798075 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.798609 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.799065 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.799535 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.800142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.800678 [debug] [MainThread]: On master: Close
[0m22:06:12.802459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:12.802907 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:12.803309 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:12.803896 [info ] [MainThread]: 
[0m22:06:12.804700 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.43 seconds (14.43s).
[0m22:06:12.806316 [debug] [MainThread]: Command end result
[0m22:06:12.857781 [info ] [MainThread]: 
[0m22:06:12.858516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:12.859147 [info ] [MainThread]: 
[0m22:06:12.859711 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:12.861082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.380198, "process_user_time": 5.677478, "process_kernel_time": 0.363582, "process_mem_max_rss": "294552", "process_in_blocks": "3808", "process_out_blocks": "116816"}
[0m22:06:12.861735 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:12.861619 after 16.38 seconds
[0m22:06:12.862306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907998ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907950dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90794fa5d0>]}
[0m22:06:12.863004 [debug] [MainThread]: Flushing usage events
[0m22:06:14.898577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd062780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd965e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd062810>]}


============================== 22:06:14.901449 | e1b4e3d8-5a47-4988-8bc8-0bcde87c0d9f ==============================
[0m22:06:14.901449 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:14.902097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:15.046388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b4e3d8-5a47-4988-8bc8-0bcde87c0d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8300bbbd10>]}
[0m22:06:15.062937 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21310821, "process_user_time": 1.416649, "process_kernel_time": 0.115726, "process_mem_max_rss": "92164", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:15.063523 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:15.063419 after 0.21 seconds
[0m22:06:15.063955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd1adee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fcfabbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fdb007d0>]}
[0m22:06:15.064370 [debug] [MainThread]: Flushing usage events
[0m06:02:25.118227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde38628470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3752ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3752dc40>]}


============================== 06:02:25.125710 | 66f8a0fe-2865-42fb-8d52-02182d002859 ==============================
[0m06:02:25.125710 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.126372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.267404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f8a0fe-2865-42fb-8d52-02182d002859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde379e05f0>]}
[0m06:02:25.281258 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-an1o0rai'
[0m06:02:25.281753 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.404893 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.405616 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.418293 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.422230 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.637285 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.637873 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:25.638409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '66f8a0fe-2865-42fb-8d52-02182d002859', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36dc1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36a4cd70>]}
[0m06:02:25.638878 [info ] [MainThread]: 
[0m06:02:25.639364 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:25.641089 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.571136, "process_user_time": 1.598108, "process_kernel_time": 0.139834, "process_mem_max_rss": "93720", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:25.641682 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.641579 after 0.57 seconds
[0m06:02:25.642135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde37186b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36dc1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36be7890>]}
[0m06:02:25.642555 [debug] [MainThread]: Flushing usage events
[0m06:02:27.412753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef1a55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0efe87bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef301a30>]}


============================== 06:02:27.415513 | b9c75bd4-c779-4d14-8ffc-8f2178b9db36 ==============================
[0m06:02:27.415513 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.416180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.650850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ee6bcef0>]}
[0m06:02:27.709893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ee6bf2f0>]}
[0m06:02:27.712372 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:27.728344 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.729055 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.729592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e7717b90>]}
[0m06:02:28.989420 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.990090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e73623f0>]}
[0m06:02:29.171153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:29.176401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e717f5c0>]}
[0m06:02:29.296861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e70b0560>]}
[0m06:02:29.297406 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:29.297885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e708fa10>]}
[0m06:02:29.299577 [info ] [MainThread]: 
[0m06:02:29.300268 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:29.305044 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.340649 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.341133 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.341538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.952645 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:29.954217 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.956413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.956972 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.964120 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.964568 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:29.964967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.971127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.972577 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.972990 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.973529 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.973925 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.974303 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.974895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.975811 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.976276 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.976655 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.977209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.977610 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.979440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.986452 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.986871 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.987244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.993198 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.993609 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.994014 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:30.017487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.019026 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:30.020289 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:30.020700 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:30.024169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef7a6b70>]}
[0m06:02:30.024704 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.025101 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.025476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:30.031855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.032316 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.032704 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.033082 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.033640 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.034044 [debug] [MainThread]: On master: Close
[0m06:02:30.035521 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:30.036067 [info ] [MainThread]: 
[0m06:02:30.045760 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:30.046358 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:30.047097 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:30.047540 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:30.073322 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:30.074101 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:30.109678 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:30.110417 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:38.537997 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.538538 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.539267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.539736 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.540216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.540947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.543935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.544432 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.545203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.566253 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.566732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.567170 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.568749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.573724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.574193 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:38.575404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.577778 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.607673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0efe5a300>]}
[0m06:02:38.608531 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.56s]
[0m06:02:38.609312 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.610334 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.610905 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.611494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.611956 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.617327 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.617997 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:38.651468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.651988 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241106060238645552"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:38.652504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.667222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.674618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.675087 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:38.675694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.676163 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.676603 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241106060238645552'
      
      
      order by ordinal_position

  
[0m06:02:38.697623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.704176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.704673 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.707514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.715460 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.715940 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.718809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.736720 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:38.737439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.737910 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241106060238645552"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241106060238645552"
    )
  
[0m06:02:38.771652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.773714 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.774207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.774644 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.783509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.784481 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:38.976995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a3b7c650>]}
[0m06:02:38.977825 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:38.978575 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:38.980060 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.980563 [debug] [MainThread]: On master: BEGIN
[0m06:02:38.981003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:38.987888 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.988413 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.988852 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.989273 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.989850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.990325 [debug] [MainThread]: On master: Close
[0m06:02:38.991841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:38.992323 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:38.992724 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:38.993175 [info ] [MainThread]: 
[0m06:02:38.993766 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m06:02:38.994887 [debug] [MainThread]: Command end result
[0m06:02:39.023175 [info ] [MainThread]: 
[0m06:02:39.023851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:39.024467 [info ] [MainThread]: 
[0m06:02:39.025077 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:39.026154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.661576, "process_user_time": 5.544053, "process_kernel_time": 0.312906, "process_mem_max_rss": "294832", "process_in_blocks": "3808", "process_out_blocks": "116792"}
[0m06:02:39.026795 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:39.026686 after 11.66 seconds
[0m06:02:39.027283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef3fd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e7100890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e7100b60>]}
[0m06:02:39.027764 [debug] [MainThread]: Flushing usage events
[0m06:02:40.931510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50c2cff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50b9c6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50b9c5970>]}


============================== 06:02:40.934368 | 42db5966-42ba-4e3d-948e-79fa91632c3a ==============================
[0m06:02:40.934368 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.935093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.078186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42db5966-42ba-4e3d-948e-79fa91632c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bceefc0>]}
[0m06:02:41.094411 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21129295, "process_user_time": 1.438648, "process_kernel_time": 0.091913, "process_mem_max_rss": "92132", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:41.094990 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:41.094887 after 0.21 seconds
[0m06:02:41.095461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50ba62720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f5bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50c2cc680>]}
[0m06:02:41.095901 [debug] [MainThread]: Flushing usage events
[0m14:05:15.825078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f56853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f5aea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f5685400>]}


============================== 14:05:15.842729 | 33e25c7e-3f8a-428b-bd38-81a5fbab4214 ==============================
[0m14:05:15.842729 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:15.843428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:15.986484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e25c7e-3f8a-428b-bd38-81a5fbab4214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f5ab4c20>]}
[0m14:05:15.999931 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cordz5z4'
[0m14:05:16.000392 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.017748 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.018393 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.031184 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.034991 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.084597 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.085108 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.085606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '33e25c7e-3f8a-428b-bd38-81a5fbab4214', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f55289b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f53dfb60>]}
[0m14:05:16.086054 [info ] [MainThread]: 
[0m14:05:16.086512 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.118012 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34073734, "process_user_time": 1.5602, "process_kernel_time": 0.138142, "process_mem_max_rss": "93920", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:16.118717 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.118614 after 0.34 seconds
[0m14:05:16.119202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f56853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f54efad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f53dfb60>]}
[0m14:05:16.119643 [debug] [MainThread]: Flushing usage events
[0m14:05:17.706808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e9d62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e94d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0ea726f0>]}


============================== 14:05:17.709661 | 24172f70-c997-40a7-9995-c516096820b7 ==============================
[0m14:05:17.709661 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.710335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.947926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e64d2e0>]}
[0m14:05:18.007260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e64eb10>]}
[0m14:05:18.009854 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.096102 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.096886 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.097425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e7f5070>]}
[0m14:05:19.322271 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:19.322934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd072a8080>]}
[0m14:05:19.505102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:19.510170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0703d220>]}
[0m14:05:19.733004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0703d580>]}
[0m14:05:19.733596 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:19.734102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd07087170>]}
[0m14:05:19.735806 [info ] [MainThread]: 
[0m14:05:19.736538 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:19.741428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:19.777529 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:19.778023 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:19.778430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:20.346178 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:20.347768 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:20.349979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:20.350567 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:20.357925 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.358367 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:20.358762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:20.364985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.366450 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.366853 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:20.367394 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.367785 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.368159 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:20.368801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.369730 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:20.370136 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.370522 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:20.371066 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.371476 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:20.374172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:20.381005 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:20.381426 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:20.381800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:20.388220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.388666 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:20.389065 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:20.412391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.413955 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:20.415172 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:20.415581 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:20.418958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0716d640>]}
[0m14:05:20.419474 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:20.419857 [debug] [MainThread]: On master: BEGIN
[0m14:05:20.420224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:20.426444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:20.426863 [debug] [MainThread]: On master: COMMIT
[0m14:05:20.427245 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:20.427615 [debug] [MainThread]: On master: COMMIT
[0m14:05:20.428139 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:20.428532 [debug] [MainThread]: On master: Close
[0m14:05:20.429957 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:20.430454 [info ] [MainThread]: 
[0m14:05:20.466258 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:20.466873 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:20.467519 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:20.467953 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:20.493744 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:20.494531 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:20.530509 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:20.531268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:28.066491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.067002 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:28.067650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.068101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.068531 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:28.069296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.072164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.072653 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:28.073329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.094011 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.094488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.094925 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.096150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.101134 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.101598 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:28.102846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.105199 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:28.134453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc4d262d0>]}
[0m14:05:28.135204 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.67s]
[0m14:05:28.136084 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:28.137078 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:28.137642 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:28.138320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:28.138781 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:28.144029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:28.144728 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:28.178019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.178530 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241106140528172194"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:28.178998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:28.193821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.201381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.201852 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:28.202438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.202877 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.203305 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241106140528172194'
      
      
      order by ordinal_position

  
[0m14:05:28.223907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.230156 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.230642 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.233593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.241148 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.241628 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.244628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.262547 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:28.263241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.263710 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241106140528172194"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241106140528172194"
    )
  
[0m14:05:28.297403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.299453 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.299907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.300332 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.310582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.311515 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:29.145768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcbfb9d790>]}
[0m14:05:29.146606 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 1.01s]
[0m14:05:29.147473 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:29.149090 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.149568 [debug] [MainThread]: On master: BEGIN
[0m14:05:29.149996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:29.156951 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.157425 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.157858 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.158277 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.158857 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.159306 [debug] [MainThread]: On master: Close
[0m14:05:29.160925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:29.161361 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:29.161764 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:29.162227 [info ] [MainThread]: 
[0m14:05:29.162773 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m14:05:29.163816 [debug] [MainThread]: Command end result
[0m14:05:29.191820 [info ] [MainThread]: 
[0m14:05:29.192457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:29.193016 [info ] [MainThread]: 
[0m14:05:29.193563 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:29.194597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.536099, "process_user_time": 6.094646, "process_kernel_time": 0.371673, "process_mem_max_rss": "365744", "process_in_blocks": "3808", "process_out_blocks": "133680"}
[0m14:05:29.195253 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:29.195141 after 11.54 seconds
[0m14:05:29.195745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0712d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0ecea540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc4af4e60>]}
[0m14:05:29.196230 [debug] [MainThread]: Flushing usage events
[0m14:05:30.872968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706186690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706636270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e00920>]}


============================== 14:05:30.875854 | 440c7741-2344-4658-b3d4-743037d571a8 ==============================
[0m14:05:30.875854 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.876624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.021011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '440c7741-2344-4658-b3d4-743037d571a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706aa4d10>]}
[0m14:05:31.037844 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21315528, "process_user_time": 1.429201, "process_kernel_time": 0.08407, "process_mem_max_rss": "92268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:31.038428 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:31.038324 after 0.21 seconds
[0m14:05:31.038864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705d64710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e008c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e00920>]}
[0m14:05:31.039299 [debug] [MainThread]: Flushing usage events
[0m22:05:35.984242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f519b018350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199c725a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199c90fe0>]}


============================== 22:05:35.992164 | 59b432ba-8ea5-4ce1-9242-5216517fa8c6 ==============================
[0m22:05:35.992164 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.992923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:36.146462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59b432ba-8ea5-4ce1-9242-5216517fa8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f519958f770>]}
[0m22:05:36.161425 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rdvgq2b3'
[0m22:05:36.162004 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:36.215079 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:36.215859 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:36.227313 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:36.231323 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:36.385363 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:36.386014 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:36.386553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '59b432ba-8ea5-4ce1-9242-5216517fa8c6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199483b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199483fe0>]}
[0m22:05:36.387024 [info ] [MainThread]: 
[0m22:05:36.387497 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:36.397496 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46209285, "process_user_time": 1.620861, "process_kernel_time": 0.120063, "process_mem_max_rss": "93660", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:36.398260 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:36.398134 after 0.46 seconds
[0m22:05:36.398761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51998bbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f519941c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199437a10>]}
[0m22:05:36.399188 [debug] [MainThread]: Flushing usage events
[0m22:05:38.106003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20eade3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea9fbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea9fa540>]}


============================== 22:05:38.108856 | ef8e5f1d-7c53-44f2-b1f1-82ee3175054e ==============================
[0m22:05:38.108856 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.109577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.347876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea2ca9f0>]}
[0m22:05:38.408219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea9a3950>]}
[0m22:05:38.410924 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:38.454235 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:38.454998 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:38.455517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea8a21b0>]}
[0m22:05:39.711797 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:39.712497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea3f72f0>]}
[0m22:05:39.896619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:39.901999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea41aa20>]}
[0m22:05:40.070476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e2ecc230>]}
[0m22:05:40.071087 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:40.071563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e2dbd280>]}
[0m22:05:40.073335 [info ] [MainThread]: 
[0m22:05:40.074081 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:40.079045 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:40.116099 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:40.116627 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:40.117029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:40.487850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.489438 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:40.491732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:40.492292 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:40.499550 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.499993 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:40.500388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.507019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.508611 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.509034 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:40.509612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.510015 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.510396 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:40.511008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.511935 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.512340 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.512723 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.513309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.513752 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:40.515972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:40.523433 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.523877 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:40.524321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.530802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.531237 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.531631 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:40.555615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.557259 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:40.558552 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:40.558965 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:40.562922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e2c87bf0>]}
[0m22:05:40.563465 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.563862 [debug] [MainThread]: On master: BEGIN
[0m22:05:40.564241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:40.570828 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.571266 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.571658 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.572032 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.572578 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.572998 [debug] [MainThread]: On master: Close
[0m22:05:40.574624 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:40.575156 [info ] [MainThread]: 
[0m22:05:40.585497 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.586202 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.586963 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:40.587408 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.613549 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.614427 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.651269 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.652144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:48.155073 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.155594 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:48.156241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.156684 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.157120 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:48.157882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.160850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.161300 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:48.162018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.182877 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.183395 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.183833 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.185847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.191005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.191474 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:48.192869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.195318 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:48.226412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e1b868a0>]}
[0m22:05:48.227248 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.64s]
[0m22:05:48.228033 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:48.229057 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:48.229657 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:48.230278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:48.230734 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:48.236138 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:48.236810 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:48.270772 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.271352 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241106220548264714"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:48.271837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:48.287124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.295180 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.295662 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:48.296296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.296752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.297199 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241106220548264714'
      
      
      order by ordinal_position

  
[0m22:05:48.318708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.325979 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.326506 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.329553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.337488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.338003 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.340833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.359061 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:48.359851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.360328 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241106220548264714"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241106220548264714"
    )
  
[0m22:05:48.392435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.394504 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.394965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.395396 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.404436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.405340 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:48.590152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20a75d6480>]}
[0m22:05:48.590978 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m22:05:48.591760 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:48.593382 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.593903 [debug] [MainThread]: On master: BEGIN
[0m22:05:48.594337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:48.601294 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.601807 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.602247 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.602674 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.603250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.603704 [debug] [MainThread]: On master: Close
[0m22:05:48.605311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:48.605799 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:48.606206 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:48.606677 [info ] [MainThread]: 
[0m22:05:48.607270 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m22:05:48.608546 [debug] [MainThread]: Command end result
[0m22:05:48.638202 [info ] [MainThread]: 
[0m22:05:48.638989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:48.639591 [info ] [MainThread]: 
[0m22:05:48.640193 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:48.641325 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.583901, "process_user_time": 5.386291, "process_kernel_time": 0.319457, "process_mem_max_rss": "290752", "process_in_blocks": "3808", "process_out_blocks": "115792"}
[0m22:05:48.642015 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:48.641899 after 10.58 seconds
[0m22:05:48.642529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea461fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e021ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea2ca570>]}
[0m22:05:48.643020 [debug] [MainThread]: Flushing usage events
[0m22:05:50.444591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b898b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017bc5cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b7b4fe0>]}


============================== 22:05:50.447620 | 0940f7c1-9bcd-4008-8485-a0edd4f2a2cb ==============================
[0m22:05:50.447620 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.448336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.604417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0940f7c1-9bcd-4008-8485-a0edd4f2a2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b32e060>]}
[0m22:05:50.622250 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22670075, "process_user_time": 1.481416, "process_kernel_time": 0.099825, "process_mem_max_rss": "92024", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:50.622871 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:50.622763 after 0.23 seconds
[0m22:05:50.623338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b20a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b274d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b14f440>]}
[0m22:05:50.623783 [debug] [MainThread]: Flushing usage events
[0m06:02:15.640841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b7258a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ba513470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b9599c70>]}


============================== 06:02:15.664102 | 88085911-d50c-4ad5-831e-1e4dc0dbb627 ==============================
[0m06:02:15.664102 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:15.664776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.802959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88085911-d50c-4ad5-831e-1e4dc0dbb627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b7027410>]}
[0m06:02:15.816951 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j38tj8t3'
[0m06:02:15.817440 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:15.862327 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:15.862953 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:15.873126 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:15.876885 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:15.920612 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:15.921199 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:15.921772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '88085911-d50c-4ad5-831e-1e4dc0dbb627', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b705f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b76819a0>]}
[0m06:02:15.922226 [info ] [MainThread]: 
[0m06:02:15.922718 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:15.928641 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.33622625, "process_user_time": 1.589677, "process_kernel_time": 0.104109, "process_mem_max_rss": "93676", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:15.929328 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:15.929223 after 0.34 seconds
[0m06:02:15.929758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ba513470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b7e55e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b7258980>]}
[0m06:02:15.930186 [debug] [MainThread]: Flushing usage events
[0m06:02:17.502274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df7664320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df58e6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df5602f90>]}


============================== 06:02:17.505176 | 886e995d-e821-4c51-88cb-a0a69d13d8b9 ==============================
[0m06:02:17.505176 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.505809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.739724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df53834a0>]}
[0m06:02:17.799992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df6bf2330>]}
[0m06:02:17.802617 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:17.823534 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:17.824272 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:17.824814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df5536a20>]}
[0m06:02:19.053135 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:19.053789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedef8ec0>]}
[0m06:02:19.233618 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:19.238810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedcd7e30>]}
[0m06:02:19.385870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedea01a0>]}
[0m06:02:19.386428 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:19.386993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedd2b470>]}
[0m06:02:19.388679 [info ] [MainThread]: 
[0m06:02:19.389404 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:19.394289 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:19.430037 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:19.430536 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:19.430989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:19.916774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.918316 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:19.920546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:19.921103 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:19.928240 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.928669 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:19.929062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.935430 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.936875 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.937276 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:19.937815 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.938206 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.938581 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:19.939201 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.940112 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.940519 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.940895 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.941409 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.941813 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:19.943808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:19.950863 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.951285 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:19.951655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.957393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.957800 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.958189 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:19.981627 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.983123 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:19.984335 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:19.984729 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:19.987928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dee3ee960>]}
[0m06:02:19.988460 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.988849 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.989216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:19.995614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.996046 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.996438 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.996815 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.997395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.997809 [debug] [MainThread]: On master: Close
[0m06:02:19.999616 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:20.000150 [info ] [MainThread]: 
[0m06:02:20.015060 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:20.015675 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:20.016427 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:20.016877 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:20.043354 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:20.044136 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:20.080330 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:20.081098 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:27.014376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.014920 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:27.015553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.016016 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.016455 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:27.017173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.020030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.020487 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:27.021186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.041934 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.042419 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.042931 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.044200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.049109 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.049586 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:27.050782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.053095 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:27.082708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedec8500>]}
[0m06:02:27.083446 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.07s]
[0m06:02:27.084209 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:27.085196 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:27.085756 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:27.086323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:27.086805 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:27.091934 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:27.092600 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:27.126017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.126533 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241107060227120141"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:27.127027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:27.141604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.149020 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.149493 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:27.150087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.150550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.151017 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241107060227120141'
      
      
      order by ordinal_position

  
[0m06:02:27.171944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.178137 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.178626 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.181681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.189512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.189983 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.192733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.210806 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:27.211480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.211945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241107060227120141"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241107060227120141"
    )
  
[0m06:02:27.248926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.250930 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.251385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.251810 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.261169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.262040 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:27.451577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4daa860440>]}
[0m06:02:27.452408 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:27.453163 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:27.454575 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.455087 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.455515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:27.462232 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.462743 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.463187 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.463608 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.464192 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.464640 [debug] [MainThread]: On master: Close
[0m06:02:27.466046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:27.466480 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:27.466925 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:27.467386 [info ] [MainThread]: 
[0m06:02:27.467941 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m06:02:27.468960 [debug] [MainThread]: Command end result
[0m06:02:27.496751 [info ] [MainThread]: 
[0m06:02:27.497392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:27.497941 [info ] [MainThread]: 
[0m06:02:27.498495 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:27.499559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.045883, "process_user_time": 5.503848, "process_kernel_time": 0.355731, "process_mem_max_rss": "296008", "process_in_blocks": "3808", "process_out_blocks": "116800"}
[0m06:02:27.500205 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:27.500094 after 10.05 seconds
[0m06:02:27.500693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df6031d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4db3fca6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dec195670>]}
[0m06:02:27.501175 [debug] [MainThread]: Flushing usage events
[0m06:02:29.138348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb35ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefc1eec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb9f2180>]}


============================== 06:02:29.141216 | 81c4c674-d8b1-42cc-92d2-e6497a092f8c ==============================
[0m06:02:29.141216 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.141854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.279829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81c4c674-d8b1-42cc-92d2-e6497a092f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefe813470>]}
[0m06:02:29.296248 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20813411, "process_user_time": 1.423048, "process_kernel_time": 0.10393, "process_mem_max_rss": "92136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:29.296819 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:29.296718 after 0.21 seconds
[0m06:02:29.297263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefbd6f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefc323290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb432cf0>]}
[0m06:02:29.297684 [debug] [MainThread]: Flushing usage events
[0m14:05:11.452252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e35fe840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e48d0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e35fe8a0>]}


============================== 14:05:11.459476 | 034a2525-a7ea-4759-8470-0da95ead0dae ==============================
[0m14:05:11.459476 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:11.460143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:11.595099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '034a2525-a7ea-4759-8470-0da95ead0dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e3003800>]}
[0m14:05:11.608291 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jddigt7m'
[0m14:05:11.608740 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:11.670786 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:11.671396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:11.681586 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:11.685342 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:11.820923 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:11.821486 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:11.822047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '034a2525-a7ea-4759-8470-0da95ead0dae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e3217e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e4219970>]}
[0m14:05:11.822484 [info ] [MainThread]: 
[0m14:05:11.823047 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:11.843932 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4396419, "process_user_time": 1.545338, "process_kernel_time": 0.130759, "process_mem_max_rss": "93500", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m14:05:11.844518 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:11.844415 after 0.44 seconds
[0m14:05:11.844941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e48d0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e3077ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e3217e60>]}
[0m14:05:11.845369 [debug] [MainThread]: Flushing usage events
[0m14:05:13.410108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce422f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce423fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce4234a0>]}


============================== 14:05:13.412847 | ad7fc489-224d-42bf-995e-6dca15675f33 ==============================
[0m14:05:13.412847 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:13.413558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:13.644621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce4a3e30>]}
[0m14:05:13.703594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39cfb612e0>]}
[0m14:05:13.706066 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:13.721336 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:13.722047 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:13.722587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ceaba8a0>]}
[0m14:05:14.944773 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:14.945401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c74c2360>]}
[0m14:05:15.126809 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:15.132102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c6d3c3b0>]}
[0m14:05:15.265953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c6d05ac0>]}
[0m14:05:15.266526 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:15.267036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c6e69eb0>]}
[0m14:05:15.268723 [info ] [MainThread]: 
[0m14:05:15.269422 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:15.274122 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:15.309851 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:15.310305 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:15.310708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:15.819763 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:15.821302 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:15.823367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:15.823927 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:15.831184 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.831634 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:15.832028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.838110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.839583 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.839991 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:15.840546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.841008 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.841402 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:15.841969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.842913 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.843325 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.843752 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.844383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.844839 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:15.846656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:15.853617 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.854033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:15.854420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.860197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.860610 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.861007 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:15.884454 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.885885 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:15.887142 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:15.887547 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:15.890754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39cfba8e00>]}
[0m14:05:15.891303 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.891701 [debug] [MainThread]: On master: BEGIN
[0m14:05:15.892073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:15.898223 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.898650 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.899083 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.899474 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.900015 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.900417 [debug] [MainThread]: On master: Close
[0m14:05:15.901940 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:15.902423 [info ] [MainThread]: 
[0m14:05:15.912015 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:15.912614 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:15.913240 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:15.913681 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.939729 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.940482 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.975965 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.976704 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:23.280590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.281096 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:23.281723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.282180 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.282609 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:23.283356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.286188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.286637 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:23.287346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.308102 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.308576 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.309030 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.311543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.316467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.316937 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:23.318605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.321011 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:23.351395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39880f0bc0>]}
[0m14:05:23.352127 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.44s]
[0m14:05:23.352932 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:23.353960 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:23.354530 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:23.355165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:23.355618 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:23.360816 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:23.361471 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:23.395223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.395745 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241107140523389325"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:23.396215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:23.411046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.418506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.418994 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:23.419599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.420046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.420480 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241107140523389325'
      
      
      order by ordinal_position

  
[0m14:05:23.449517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.455716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.456203 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.459099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.466582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.467080 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.469868 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.487739 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:23.488434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.488905 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241107140523389325"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241107140523389325"
    )
  
[0m14:05:23.522897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.524902 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.525359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.525784 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.534802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.535718 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:23.732115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39838715e0>]}
[0m14:05:23.732926 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m14:05:23.733692 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:23.735190 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.735665 [debug] [MainThread]: On master: BEGIN
[0m14:05:23.736098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:23.742666 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.743181 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.743616 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.744034 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.744607 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.745057 [debug] [MainThread]: On master: Close
[0m14:05:23.746384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:23.746823 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:23.747281 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:23.747750 [info ] [MainThread]: 
[0m14:05:23.748294 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m14:05:23.749311 [debug] [MainThread]: Command end result
[0m14:05:23.777329 [info ] [MainThread]: 
[0m14:05:23.777965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:23.778496 [info ] [MainThread]: 
[0m14:05:23.779067 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:23.780096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.417994, "process_user_time": 5.595816, "process_kernel_time": 0.331278, "process_mem_max_rss": "297304", "process_in_blocks": "3808", "process_out_blocks": "116784"}
[0m14:05:23.780747 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:23.780637 after 10.42 seconds
[0m14:05:23.781238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce5f6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ceab8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c5aad250>]}
[0m14:05:23.781731 [debug] [MainThread]: Flushing usage events
[0m14:05:25.488003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561bf975f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561ba9c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561bdd6ab0>]}


============================== 14:05:25.490774 | 608cd604-6b93-40df-b583-736722a1d479 ==============================
[0m14:05:25.490774 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.491444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.637991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '608cd604-6b93-40df-b583-736722a1d479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561b47b9b0>]}
[0m14:05:25.654975 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21483752, "process_user_time": 1.424165, "process_kernel_time": 0.080234, "process_mem_max_rss": "92280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:25.655709 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:25.655604 after 0.22 seconds
[0m14:05:25.656336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561bbcba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561bbca3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561b973aa0>]}
[0m14:05:25.656868 [debug] [MainThread]: Flushing usage events
[0m22:05:40.068530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb9598920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb9147a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb9147e30>]}


============================== 22:05:40.075971 | 651283ab-ff6e-4b2c-b61e-6e7eff22ec50 ==============================
[0m22:05:40.075971 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.076713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.220470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '651283ab-ff6e-4b2c-b61e-6e7eff22ec50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb887d790>]}
[0m22:05:40.234179 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qzh62x6f'
[0m22:05:40.234656 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:40.391427 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:40.392189 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:40.419480 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:40.423366 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:40.468591 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:40.469178 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:40.469727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '651283ab-ff6e-4b2c-b61e-6e7eff22ec50', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb86dc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb8839310>]}
[0m22:05:40.470211 [info ] [MainThread]: 
[0m22:05:40.470696 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:40.472272 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45164326, "process_user_time": 1.590065, "process_kernel_time": 0.111304, "process_mem_max_rss": "93496", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:40.472868 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:40.472763 after 0.45 seconds
[0m22:05:40.473307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb98dc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb8fed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb853e6f0>]}
[0m22:05:40.473730 [debug] [MainThread]: Flushing usage events
[0m22:05:42.161333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02eed2cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02eeca22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ef9f1580>]}


============================== 22:05:42.164235 | ae91fada-c27c-4824-97cb-abf566c11902 ==============================
[0m22:05:42.164235 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.164859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.404347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ee67b590>]}
[0m22:05:42.465865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ee7e57c0>]}
[0m22:05:42.468542 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:42.484157 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:42.484909 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:42.485424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ee6b0710>]}
[0m22:05:43.725704 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:43.726379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e72f0b60>]}
[0m22:05:43.908798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:43.914148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ee6eca10>]}
[0m22:05:44.067952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e72ceb40>]}
[0m22:05:44.068541 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:44.069027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e70a41a0>]}
[0m22:05:44.070816 [info ] [MainThread]: 
[0m22:05:44.071524 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:44.076526 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:44.113185 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:44.113745 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:44.114182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:44.617202 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:44.618780 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:44.620989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:44.621539 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:44.628698 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:44.629130 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:44.629529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:44.635763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.637229 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:44.637633 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:44.638281 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.638674 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:44.639047 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:44.639621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.640600 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:44.640996 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:44.641369 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:44.641949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.642357 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:44.644276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:44.651475 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:44.651893 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:44.652263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:44.658314 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.658724 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:44.659116 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:44.682626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.684196 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:44.685449 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:44.685879 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:44.689379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e70a7530>]}
[0m22:05:44.689938 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.690346 [debug] [MainThread]: On master: BEGIN
[0m22:05:44.690724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:44.697115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.697562 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.697990 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.698366 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.698900 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.699299 [debug] [MainThread]: On master: Close
[0m22:05:44.700736 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:44.701225 [info ] [MainThread]: 
[0m22:05:44.710898 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:44.711495 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:44.712144 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:44.712582 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:44.738739 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:44.739534 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:44.775261 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:44.776113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.449738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.450309 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.451040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.451498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.451935 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.452692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.455769 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.456226 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.456908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.477911 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.478428 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.478863 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.480200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.485297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.485760 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.487055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.489439 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.520561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e7110da0>]}
[0m22:05:51.521399 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.81s]
[0m22:05:51.522338 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.523377 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.523958 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.524562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.525020 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.530453 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.531119 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:51.565008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.565543 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241107220551559086"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:51.566046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:51.581120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.589024 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.589511 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:51.590177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.590624 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.591059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241107220551559086'
      
      
      order by ordinal_position

  
[0m22:05:51.612901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.619971 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.620569 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.623922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.631955 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.632474 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.635686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.654457 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:51.655313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.655802 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241107220551559086"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241107220551559086"
    )
  
[0m22:05:51.693472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.695681 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.696167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.696601 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.707114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.708200 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:52.389705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ac57aea0>]}
[0m22:05:52.390562 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.87s]
[0m22:05:52.391298 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:52.392716 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.393237 [debug] [MainThread]: On master: BEGIN
[0m22:05:52.393678 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:52.400556 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.401035 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.401464 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.401916 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.402558 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.403013 [debug] [MainThread]: On master: Close
[0m22:05:52.404516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:52.404950 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:52.405351 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:52.405810 [info ] [MainThread]: 
[0m22:05:52.406456 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m22:05:52.407579 [debug] [MainThread]: Command end result
[0m22:05:52.436318 [info ] [MainThread]: 
[0m22:05:52.437088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:52.437676 [info ] [MainThread]: 
[0m22:05:52.438317 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:52.439433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.326224, "process_user_time": 6.643873, "process_kernel_time": 0.332795, "process_mem_max_rss": "360160", "process_in_blocks": "3808", "process_out_blocks": "134240"}
[0m22:05:52.440083 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:52.439971 after 10.33 seconds
[0m22:05:52.440582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02eeab2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02eedf8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e72cdeb0>]}
[0m22:05:52.441066 [debug] [MainThread]: Flushing usage events
[0m22:05:54.196487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a5073fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a5072210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a5071a30>]}


============================== 22:05:54.199516 | bf5a78ac-373d-4787-8aa8-ad14506361b1 ==============================
[0m22:05:54.199516 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.200226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.348862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf5a78ac-373d-4787-8aa8-ad14506361b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a4ed5640>]}
[0m22:05:54.365695 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21793306, "process_user_time": 1.432446, "process_kernel_time": 0.100031, "process_mem_max_rss": "92184", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:54.366330 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:54.366227 after 0.22 seconds
[0m22:05:54.366774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a526fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a4abeb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a44e35f0>]}
[0m22:05:54.367203 [debug] [MainThread]: Flushing usage events
[0m06:02:09.968720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fd35c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc400313410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fd3c8440>]}


============================== 06:02:09.976414 | b77b6c74-5749-412a-abb5-6b1d65749d57 ==============================
[0m06:02:09.976414 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.977165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.120192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b77b6c74-5749-412a-abb5-6b1d65749d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fcc475f0>]}
[0m06:02:10.133439 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5wdw7f4u'
[0m06:02:10.133890 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.188833 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.189423 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.201508 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.205353 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.379778 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.380337 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:10.380939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b77b6c74-5749-412a-abb5-6b1d65749d57', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fcdaac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fcd8a1e0>]}
[0m06:02:10.381397 [info ] [MainThread]: 
[0m06:02:10.381911 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:10.384011 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46458668, "process_user_time": 1.587035, "process_kernel_time": 0.114773, "process_mem_max_rss": "93580", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:10.384593 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.384491 after 0.47 seconds
[0m06:02:10.385068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fd752360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fdbdb440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fd3c59d0>]}
[0m06:02:10.385486 [debug] [MainThread]: Flushing usage events
[0m06:02:12.023398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e28c1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e1ff50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e42adbe0>]}


============================== 06:02:12.026217 | cd6f45cf-79ef-4bc4-a45b-18ddd71c569c ==============================
[0m06:02:12.026217 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.026931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.260184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e1da1a00>]}
[0m06:02:12.319315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3968320>]}
[0m06:02:12.321778 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:12.346567 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.347283 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.347813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e1d1a1b0>]}
[0m06:02:13.583219 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.583868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6da800170>]}
[0m06:02:13.766264 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.771746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6dadd2b10>]}
[0m06:02:13.898785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6da694470>]}
[0m06:02:13.899343 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:13.899855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6da67b5c0>]}
[0m06:02:13.901631 [info ] [MainThread]: 
[0m06:02:13.902368 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:13.907286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:13.942698 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:13.943149 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:13.943547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.272359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.273970 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.276239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.276856 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.284017 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.284447 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:14.284879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.290991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.292394 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.292842 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.293436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.293831 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.294205 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.294759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.295677 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.296082 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.296465 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.297056 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.297465 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.299252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.306230 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.306662 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.307046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.312811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.313218 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.313820 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:14.351253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.352820 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.354058 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.354466 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.357909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e225e180>]}
[0m06:02:14.358432 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.358829 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.359195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.365403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.365825 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.366215 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.366589 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.367130 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.367534 [debug] [MainThread]: On master: Close
[0m06:02:14.368852 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.369408 [info ] [MainThread]: 
[0m06:02:14.407060 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.407655 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.408382 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.408848 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.434742 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.435488 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.471481 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.472225 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:21.982107 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.982611 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:21.983277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.983733 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.984173 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:21.984940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.987781 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.988246 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:21.988944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.009701 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.010190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.010638 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.013960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.018898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.019366 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:22.021500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.023790 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:22.053356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e44095b0>]}
[0m06:02:22.054065 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.64s]
[0m06:02:22.054836 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:22.055797 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:22.056350 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:22.056960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:22.057408 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:22.062405 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:22.063054 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:22.097285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.097848 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241108060222091320"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:22.098325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:22.114211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.122450 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.122961 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:22.123703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.124160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.124600 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241108060222091320'
      
      
      order by ordinal_position

  
[0m06:02:22.146299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.153210 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.153711 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.156622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.164397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.164915 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.167876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.186310 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:22.187074 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.187551 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241108060222091320"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241108060222091320"
    )
  
[0m06:02:22.222244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.224277 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.224770 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.225203 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.234873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.235867 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:22.437539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa696fa60f0>]}
[0m06:02:22.438364 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:22.439094 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:22.440610 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.441134 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.441567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:22.448259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.448760 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.449200 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.449625 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.450196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.450647 [debug] [MainThread]: On master: Close
[0m06:02:22.452155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:22.452612 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:22.453086 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:22.453556 [info ] [MainThread]: 
[0m06:02:22.454167 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m06:02:22.455309 [debug] [MainThread]: Command end result
[0m06:02:22.483357 [info ] [MainThread]: 
[0m06:02:22.484042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:22.484731 [info ] [MainThread]: 
[0m06:02:22.485334 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:22.486415 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.511561, "process_user_time": 5.511014, "process_kernel_time": 0.292159, "process_mem_max_rss": "301976", "process_in_blocks": "3808", "process_out_blocks": "116792"}
[0m06:02:22.487060 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:22.486950 after 10.51 seconds
[0m06:02:22.487553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e1f6e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa696f5e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e23b4a70>]}
[0m06:02:22.488036 [debug] [MainThread]: Flushing usage events
[0m06:02:24.183575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15bd368a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15c1be1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15be82390>]}


============================== 06:02:24.186470 | e5350ec6-dd00-444e-8bd1-b2ac7b05be3d ==============================
[0m06:02:24.186470 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.187214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.329309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5350ec6-dd00-444e-8bd1-b2ac7b05be3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15c3b17f0>]}
[0m06:02:24.346019 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21138436, "process_user_time": 1.449978, "process_kernel_time": 0.075894, "process_mem_max_rss": "91976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:24.346609 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:24.346503 after 0.21 seconds
[0m06:02:24.347048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15be82390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15bce3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15cd4a030>]}
[0m06:02:24.347468 [debug] [MainThread]: Flushing usage events
[0m14:05:03.536883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa66899e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6681e92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6681e9250>]}


============================== 14:05:03.544640 | 9c585040-95cb-4496-a737-a843da610496 ==============================
[0m14:05:03.544640 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:03.545310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:03.683168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c585040-95cb-4496-a737-a843da610496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa668eec650>]}
[0m14:05:03.696615 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l8gvcf_a'
[0m14:05:03.697064 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:03.782788 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:03.783413 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:03.806328 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:03.810172 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:03.881996 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:03.882514 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:03.883046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c585040-95cb-4496-a737-a843da610496', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6680152b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa667dafda0>]}
[0m14:05:03.883520 [info ] [MainThread]: 
[0m14:05:03.884029 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:03.886693 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3979453, "process_user_time": 1.55859, "process_kernel_time": 0.123255, "process_mem_max_rss": "93484", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:03.887280 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:03.887175 after 0.40 seconds
[0m14:05:03.887716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa669af0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa66b600170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa668ad1790>]}
[0m14:05:03.888230 [debug] [MainThread]: Flushing usage events
[0m14:05:05.567422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cad419bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cacce66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cacf4c980>]}


============================== 14:05:05.570266 | 3536305c-bb86-4a40-8718-ea272933472e ==============================
[0m14:05:05.570266 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.571004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.803884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2caca93ad0>]}
[0m14:05:05.863014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cacabf050>]}
[0m14:05:05.865587 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:05.881177 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:05.881896 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:05.882443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca5a402c0>]}
[0m14:05:07.112012 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:07.112683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca55d4ec0>]}
[0m14:05:07.294013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:07.299207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca593aa20>]}
[0m14:05:07.427172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca53bcbc0>]}
[0m14:05:07.427752 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:07.428259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca5316e40>]}
[0m14:05:07.429945 [info ] [MainThread]: 
[0m14:05:07.430651 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:07.435669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:07.472179 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:07.472680 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:07.473093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:08.066941 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:08.068530 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:08.070480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:08.071036 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:08.079575 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:08.080046 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:08.080448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:08.087147 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.088673 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:08.089078 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:08.089611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.090001 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:08.090375 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:08.090978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.091905 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:08.092366 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:08.092738 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:08.093271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.093668 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:08.095549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:08.101169 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:08.101578 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:08.101947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:08.107594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.108047 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:08.108449 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:08.131649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.133099 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:08.134324 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:08.134725 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:08.137829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca538e720>]}
[0m14:05:08.138343 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:08.138740 [debug] [MainThread]: On master: BEGIN
[0m14:05:08.139110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:08.145417 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:08.145841 [debug] [MainThread]: On master: COMMIT
[0m14:05:08.146231 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:08.146607 [debug] [MainThread]: On master: COMMIT
[0m14:05:08.147137 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:08.147547 [debug] [MainThread]: On master: Close
[0m14:05:08.149003 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:08.149534 [info ] [MainThread]: 
[0m14:05:08.159181 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:08.159767 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:08.160517 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:08.160961 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:08.186539 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:08.187293 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:08.223388 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:08.224162 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:15.866563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.867087 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:15.867746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.868227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.868663 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:15.869364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.872272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.872743 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:15.873429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.893984 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:15.894472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.894911 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:15.896840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.901782 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.902246 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:15.903651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.906014 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:15.938012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c87f49100>]}
[0m14:05:15.938810 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.78s]
[0m14:05:15.939599 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:15.940628 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:15.941196 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:15.941800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:15.942257 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:15.947569 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:15.948277 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:15.982135 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:15.982706 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241108140515976229"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:15.983179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:15.997616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.005632 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.006183 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:16.006839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.007286 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.007722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241108140515976229'
      
      
      order by ordinal_position

  
[0m14:05:16.028826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.035809 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.036346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:16.039348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.047100 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.047575 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:16.050740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.068845 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:16.069621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.070109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241108140515976229"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241108140515976229"
    )
  
[0m14:05:16.103926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.105938 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:16.106386 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.106811 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:16.115361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.116350 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:16.311177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c65f12150>]}
[0m14:05:16.312020 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:16.312872 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:16.314317 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:16.314814 [debug] [MainThread]: On master: BEGIN
[0m14:05:16.315281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:16.322164 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:16.322644 [debug] [MainThread]: On master: COMMIT
[0m14:05:16.323079 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:16.323500 [debug] [MainThread]: On master: COMMIT
[0m14:05:16.324092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:16.324551 [debug] [MainThread]: On master: Close
[0m14:05:16.326058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:16.326496 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:16.326900 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:16.327360 [info ] [MainThread]: 
[0m14:05:16.327887 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.90 seconds (8.90s).
[0m14:05:16.328920 [debug] [MainThread]: Command end result
[0m14:05:16.356716 [info ] [MainThread]: 
[0m14:05:16.357369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:16.357876 [info ] [MainThread]: 
[0m14:05:16.358392 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:16.359384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.839843, "process_user_time": 5.447297, "process_kernel_time": 0.359689, "process_mem_max_rss": "293804", "process_in_blocks": "3808", "process_out_blocks": "116792"}
[0m14:05:16.360055 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:16.359908 after 10.84 seconds
[0m14:05:16.360550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2caccc3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cadbba360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca55fc260>]}
[0m14:05:16.361030 [debug] [MainThread]: Flushing usage events
[0m14:05:18.027730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359a60e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359a83a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359d813410>]}


============================== 14:05:18.030725 | 9f8c6f55-af3c-4edb-aa59-1a4c69a0b2b7 ==============================
[0m14:05:18.030725 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.031478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.179579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f8c6f55-af3c-4edb-aa59-1a4c69a0b2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359afee5a0>]}
[0m14:05:18.196603 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21709374, "process_user_time": 1.402203, "process_kernel_time": 0.131831, "process_mem_max_rss": "92024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:18.197190 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:18.197086 after 0.22 seconds
[0m14:05:18.197625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359b2b85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359ba5b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359a3cbc50>]}
[0m14:05:18.198049 [debug] [MainThread]: Flushing usage events
[0m22:05:38.825441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa2dcce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa2fc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cad213470>]}


============================== 22:05:38.875987 | c398911c-ac94-4cf9-ae21-86d012eb656d ==============================
[0m22:05:38.875987 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.876753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:39.017091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c398911c-ac94-4cf9-ae21-86d012eb656d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca9d27410>]}
[0m22:05:39.030491 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u4gyf1sm'
[0m22:05:39.030949 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:39.103076 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:39.103700 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:39.115777 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:39.119606 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:39.271760 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:39.272374 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:39.272911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c398911c-ac94-4cf9-ae21-86d012eb656d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca9cf7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca9cf7e30>]}
[0m22:05:39.273386 [info ] [MainThread]: 
[0m22:05:39.273867 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:39.275583 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49857712, "process_user_time": 1.592262, "process_kernel_time": 0.095775, "process_mem_max_rss": "93512", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:39.276171 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:39.276067 after 0.50 seconds
[0m22:05:39.276642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa1e1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa90a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caadaeb40>]}
[0m22:05:39.277070 [debug] [MainThread]: Flushing usage events
[0m22:05:40.903650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78bf6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78bf6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78bf69f0>]}


============================== 22:05:40.906463 | 28b46b92-6040-40fd-b097-6f246274f560 ==============================
[0m22:05:40.906463 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.907189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.140247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78a43aa0>]}
[0m22:05:41.209107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff79468470>]}
[0m22:05:41.211693 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:41.243924 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:41.244680 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:41.245218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78c90d40>]}
[0m22:05:42.471331 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:42.471965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff79ddb530>]}
[0m22:05:42.651736 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:42.656885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff71bb43b0>]}
[0m22:05:42.793751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff714e0290>]}
[0m22:05:42.794300 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:42.794788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff713d7d10>]}
[0m22:05:42.796478 [info ] [MainThread]: 
[0m22:05:42.797175 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:42.801824 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:42.837436 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:42.837878 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:42.838282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.376977 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:43.378648 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:43.380679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:43.381268 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:43.389435 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.389877 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:43.390269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.396470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.397918 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.398324 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:43.398922 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.399320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.399707 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:43.400343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.401275 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.401672 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.402058 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.402599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.403012 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:43.404991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:43.410640 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.411063 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:43.411440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.417151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.417574 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.417972 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:43.439858 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.441459 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:43.442704 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:43.443114 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:43.447104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff79581a90>]}
[0m22:05:43.447626 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.448026 [debug] [MainThread]: On master: BEGIN
[0m22:05:43.448455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:43.454883 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.455317 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.455717 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.456100 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.456728 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.457135 [debug] [MainThread]: On master: Close
[0m22:05:43.458604 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:43.459133 [info ] [MainThread]: 
[0m22:05:43.480574 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:43.481196 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:43.481940 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:43.482387 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:43.508191 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:43.508996 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:43.544833 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:43.545680 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.344316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.344822 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.345490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.345950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.346382 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.347088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.349962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.350422 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.351099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.371578 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.372057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.372534 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.374706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.379587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.380051 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.381207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.383499 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.412733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff79b2dca0>]}
[0m22:05:51.413438 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.93s]
[0m22:05:51.414314 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.415304 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.415863 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.416548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.417000 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.421985 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.422636 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:51.456461 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.456974 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241108220551450634"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:51.457450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:51.472128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.479429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.479893 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:51.480495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.480947 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.481379 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241108220551450634'
      
      
      order by ordinal_position

  
[0m22:05:51.502177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.508302 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.508788 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.513037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.520720 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.521253 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.524518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.542379 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:51.543078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.543544 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241108220551450634"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241108220551450634"
    )
  
[0m22:05:51.582460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.584457 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.584914 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.585333 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.595012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.595913 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:52.281567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff31e8dd60>]}
[0m22:05:52.282442 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.86s]
[0m22:05:52.283208 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:52.284674 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.285151 [debug] [MainThread]: On master: BEGIN
[0m22:05:52.285581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:52.292244 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.292728 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.293167 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.293592 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.294170 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.294626 [debug] [MainThread]: On master: Close
[0m22:05:52.295937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:52.296417 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:52.296832 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:52.297293 [info ] [MainThread]: 
[0m22:05:52.297841 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.50 seconds (9.50s).
[0m22:05:52.298871 [debug] [MainThread]: Command end result
[0m22:05:52.326585 [info ] [MainThread]: 
[0m22:05:52.327290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:52.327892 [info ] [MainThread]: 
[0m22:05:52.328513 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:52.329597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.473636, "process_user_time": 6.072802, "process_kernel_time": 0.311221, "process_mem_max_rss": "360004", "process_in_blocks": "3808", "process_out_blocks": "135264"}
[0m22:05:52.330243 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:52.330128 after 11.47 seconds
[0m22:05:52.330733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff7146a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff32fdf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff71416180>]}
[0m22:05:52.331225 [debug] [MainThread]: Flushing usage events
[0m22:05:53.999767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c303a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c263e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c279b830>]}


============================== 22:05:54.002503 | a99c3b02-a464-455b-b4c8-073e5fae4589 ==============================
[0m22:05:54.002503 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.003213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.139621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a99c3b02-a464-455b-b4c8-073e5fae4589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c225e510>]}
[0m22:05:54.156451 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20452245, "process_user_time": 1.371849, "process_kernel_time": 0.111662, "process_mem_max_rss": "92128", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:54.157022 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:54.156918 after 0.21 seconds
[0m22:05:54.157450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c257a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c2df9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c27e2210>]}
[0m22:05:54.157871 [debug] [MainThread]: Flushing usage events
[0m06:02:06.323260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e663963c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6626f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e66a2cce0>]}


============================== 06:02:06.337993 | 7d473249-fe07-482c-afb3-c81017f8a927 ==============================
[0m06:02:06.337993 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.338721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.474205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d473249-fe07-482c-afb3-c81017f8a927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6608a7b0>]}
[0m06:02:06.487387 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-crq6j1iy'
[0m06:02:06.487903 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:06.559772 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:06.560370 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.572707 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.576563 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.789324 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.789821 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:06.790333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7d473249-fe07-482c-afb3-c81017f8a927', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e666a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e65f784a0>]}
[0m06:02:06.790775 [info ] [MainThread]: 
[0m06:02:06.791273 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:06.797642 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5223003, "process_user_time": 1.500268, "process_kernel_time": 0.167138, "process_mem_max_rss": "93540", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m06:02:06.798315 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.798213 after 0.52 seconds
[0m06:02:06.798742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e66a2ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e662bc8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e662a62a0>]}
[0m06:02:06.799160 [debug] [MainThread]: Flushing usage events
[0m06:02:08.628627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657a92420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6583c1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6583c3320>]}


============================== 06:02:08.631359 | a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb ==============================
[0m06:02:08.631359 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.632083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.861323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb650971c40>]}
[0m06:02:08.919971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6587c0320>]}
[0m06:02:08.922319 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:08.942189 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.942887 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.943408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6509702f0>]}
[0m06:02:10.174321 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:10.174988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb659da9970>]}
[0m06:02:10.355054 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:10.360064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6503e0140>]}
[0m06:02:10.485874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6503d2d80>]}
[0m06:02:10.486403 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:10.486909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6501b2450>]}
[0m06:02:10.488597 [info ] [MainThread]: 
[0m06:02:10.489259 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:10.494129 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:10.528853 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:10.529299 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:10.529704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:11.059349 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:11.060936 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:11.063049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:11.063645 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:11.072294 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.072741 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:11.073143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.079269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.080762 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.081169 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:11.081709 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.082110 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.082489 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:11.083061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.084020 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.084436 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.084814 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.085355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.085762 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:11.087716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:11.093362 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.093773 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:11.094151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.099995 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.100407 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.100803 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:11.124007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.125430 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:11.126639 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:11.127045 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:11.130328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6502170e0>]}
[0m06:02:11.130846 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.131242 [debug] [MainThread]: On master: BEGIN
[0m06:02:11.131676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:11.138095 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.138521 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.138910 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.139286 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.139841 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.140243 [debug] [MainThread]: On master: Close
[0m06:02:11.141626 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:11.142107 [info ] [MainThread]: 
[0m06:02:11.155812 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:11.156393 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:11.157028 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:11.157464 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:11.183338 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:11.184106 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:11.219809 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:11.220534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.862460 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.862984 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.863661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.864124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.864565 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.865295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.868284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.868750 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.869429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.890191 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.890666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.891104 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.892918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.897862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.898333 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.899634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.901969 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.932142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62c169550>]}
[0m06:02:20.932873 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.77s]
[0m06:02:20.933658 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.934636 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.935202 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.935808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.936262 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.941416 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.942073 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:20.975908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.976412 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241109060220969925"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:20.976880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:20.991004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.998415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.998879 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:20.999467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.999939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.000377 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241109060220969925'
      
      
      order by ordinal_position

  
[0m06:02:21.020806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.026949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.027434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.030731 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.038265 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.038744 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.041755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.059931 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.060630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.061101 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241109060220969925"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241109060220969925"
    )
  
[0m06:02:21.097472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.099497 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.099998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.100427 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.109809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.110735 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.319630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb614d0f0b0>]}
[0m06:02:21.320442 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:21.321300 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.322765 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.323248 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.323724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.330396 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.330873 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.331308 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.331767 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.332392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.332841 [debug] [MainThread]: On master: Close
[0m06:02:21.334239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.334670 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.335073 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.335525 [info ] [MainThread]: 
[0m06:02:21.336169 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.85 seconds (10.85s).
[0m06:02:21.337322 [debug] [MainThread]: Command end result
[0m06:02:21.364968 [info ] [MainThread]: 
[0m06:02:21.365665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.366264 [info ] [MainThread]: 
[0m06:02:21.366866 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.367951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.787818, "process_user_time": 5.58164, "process_kernel_time": 0.342627, "process_mem_max_rss": "296336", "process_in_blocks": "3808", "process_out_blocks": "116792"}
[0m06:02:21.368604 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.368492 after 12.79 seconds
[0m06:02:21.369094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657ac6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6579f6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6509374d0>]}
[0m06:02:21.369575 [debug] [MainThread]: Flushing usage events
[0m06:02:23.267401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eb8e26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ebb52300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ee913410>]}


============================== 06:02:23.270191 | bebe304b-2f36-4941-8728-b22c42e2dcd1 ==============================
[0m06:02:23.270191 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.270918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.407921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bebe304b-2f36-4941-8728-b22c42e2dcd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ebb53d40>]}
[0m06:02:23.424563 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20534755, "process_user_time": 1.375793, "process_kernel_time": 0.119634, "process_mem_max_rss": "92148", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:23.425143 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:23.425039 after 0.21 seconds
[0m06:02:23.425587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eb8e26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eb99f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eba6af30>]}
[0m06:02:23.426016 [debug] [MainThread]: Flushing usage events
[0m14:04:50.529711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559ba75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559ba7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559ba7b00>]}


============================== 14:04:50.537223 | aebab7e6-dc6a-4b92-923d-162bbbf757ca ==============================
[0m14:04:50.537223 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:50.537897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:50.680900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aebab7e6-dc6a-4b92-923d-162bbbf757ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559cd5b80>]}
[0m14:04:50.694369 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0_7yaaya'
[0m14:04:50.694831 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:50.780687 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:50.781410 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:50.821121 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:50.824934 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:50.868422 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:50.868915 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:50.869426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aebab7e6-dc6a-4b92-923d-162bbbf757ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05599e73b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05598ef2f0>]}
[0m14:04:50.869874 [info ] [MainThread]: 
[0m14:04:50.870341 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:50.872781 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3912747, "process_user_time": 1.499297, "process_kernel_time": 0.17019, "process_mem_max_rss": "93512", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:04:50.873347 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:50.873248 after 0.39 seconds
[0m14:04:50.873766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559bcbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559a1eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f055b2be5d0>]}
[0m14:04:50.874180 [debug] [MainThread]: Flushing usage events
[0m14:04:52.411141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f3cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5fa5a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f5dd070>]}


============================== 14:04:52.413942 | 05ade806-c04f-49ac-a4bc-1ea5596fd653 ==============================
[0m14:04:52.413942 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:52.414605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:52.651377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5fb6bd40>]}
[0m14:04:52.711297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda6010a960>]}
[0m14:04:52.713857 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:52.729345 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:52.730070 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:52.730613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda58026570>]}
[0m14:04:53.967422 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:53.968090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda57a51100>]}
[0m14:04:54.151027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:54.156195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda57a25a60>]}
[0m14:04:54.280935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda579852b0>]}
[0m14:04:54.281481 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:54.281965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda57935370>]}
[0m14:04:54.283660 [info ] [MainThread]: 
[0m14:04:54.284389 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:54.289086 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:54.324266 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:54.324714 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:54.325116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:54.841762 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:54.843282 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:54.845309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:54.845870 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:54.854419 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:54.854854 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:54.855247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:54.861379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.862795 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:54.863196 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:54.863734 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.864166 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:54.864556 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:54.865112 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.866022 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:54.866427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:54.866801 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:54.867334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.867732 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:54.869662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:54.875249 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:54.875660 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:54.876074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:54.881781 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.882191 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:54.882580 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:54.905474 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.906906 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:54.908129 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:54.908535 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:54.911810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda57986840>]}
[0m14:04:54.912361 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:54.912764 [debug] [MainThread]: On master: BEGIN
[0m14:04:54.913141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:54.919327 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:54.919758 [debug] [MainThread]: On master: COMMIT
[0m14:04:54.920204 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:54.920586 [debug] [MainThread]: On master: COMMIT
[0m14:04:54.921117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:54.921521 [debug] [MainThread]: On master: Close
[0m14:04:54.922945 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:54.923478 [info ] [MainThread]: 
[0m14:04:54.933492 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:54.934100 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:54.934830 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:54.935273 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:54.960944 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:54.961688 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:54.997226 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:54.997964 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:01.357941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.358452 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:01.359077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.359535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.359993 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:01.360686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.363550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.364057 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:01.364768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.385541 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:01.386022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.386460 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:01.387639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.392561 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.393033 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:01.394128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.396484 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:01.425862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda144dffb0>]}
[0m14:05:01.426593 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.49s]
[0m14:05:01.427484 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:01.428489 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:01.429053 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:01.429731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:01.430201 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:01.435316 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:01.436009 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:01.469639 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.470153 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241109140501463725"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:01.470630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:01.485258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.492646 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.493116 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:01.493713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.494175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.494618 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241109140501463725'
      
      
      order by ordinal_position

  
[0m14:05:01.514956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.521027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.521520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:01.524557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.532028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.532506 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:01.535286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.553277 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:01.553970 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.554445 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241109140501463725"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241109140501463725"
    )
  
[0m14:05:01.588857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.590834 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:01.591298 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.591725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:01.601666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.602558 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:02.295021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda144f80e0>]}
[0m14:05:02.295840 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.87s]
[0m14:05:02.296743 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:02.298020 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:02.298492 [debug] [MainThread]: On master: BEGIN
[0m14:05:02.298925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:02.305503 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:02.305980 [debug] [MainThread]: On master: COMMIT
[0m14:05:02.306417 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:02.306844 [debug] [MainThread]: On master: COMMIT
[0m14:05:02.307422 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:02.307916 [debug] [MainThread]: On master: Close
[0m14:05:02.309223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:02.309663 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:02.310075 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:02.310538 [info ] [MainThread]: 
[0m14:05:02.311126 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.03 seconds (8.03s).
[0m14:05:02.312284 [debug] [MainThread]: Command end result
[0m14:05:02.340015 [info ] [MainThread]: 
[0m14:05:02.340703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:02.341297 [info ] [MainThread]: 
[0m14:05:02.341904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:02.342978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.980723, "process_user_time": 6.473965, "process_kernel_time": 0.41289, "process_mem_max_rss": "368636", "process_in_blocks": "3808", "process_out_blocks": "135216"}
[0m14:05:02.343624 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:02.343511 after 9.98 seconds
[0m14:05:02.344148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f395670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f6c2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f6ec9e0>]}
[0m14:05:02.344643 [debug] [MainThread]: Flushing usage events
[0m14:05:03.989183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8bc1a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8afd51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8d2eddc0>]}


============================== 14:05:03.992101 | 1c651672-44ac-4e89-aaa7-0ab782849755 ==============================
[0m14:05:03.992101 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:03.992747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.138232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c651672-44ac-4e89-aaa7-0ab782849755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8b3f9a00>]}
[0m14:05:04.155061 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21418615, "process_user_time": 1.436826, "process_kernel_time": 0.08805, "process_mem_max_rss": "92400", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:04.155667 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:04.155545 after 0.21 seconds
[0m14:05:04.156158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8bcf1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8aca7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8c425070>]}
[0m14:05:04.156592 [debug] [MainThread]: Flushing usage events
[0m22:05:20.406907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ff30a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fd6a2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fd6a0da0>]}


============================== 22:05:20.441809 | 1eeab9f8-9247-4e95-b237-7fc1e50b942d ==============================
[0m22:05:20.441809 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:20.442549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:20.582626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eeab9f8-9247-4e95-b237-7fc1e50b942d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fc957950>]}
[0m22:05:20.596220 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zbbo4j92'
[0m22:05:20.596701 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:20.674991 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:20.675741 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:20.688278 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:20.692194 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.861992 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.862612 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:20.863250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1eeab9f8-9247-4e95-b237-7fc1e50b942d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fc9c4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fca9ec30>]}
[0m22:05:20.863765 [info ] [MainThread]: 
[0m22:05:20.864289 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:20.865941 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5068396, "process_user_time": 1.579013, "process_kernel_time": 0.107932, "process_mem_max_rss": "93912", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:20.866531 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.866429 after 0.51 seconds
[0m22:05:20.866963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fcc57350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fc9c60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fd051730>]}
[0m22:05:20.867387 [debug] [MainThread]: Flushing usage events
[0m22:05:22.545628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053bec5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053bec6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053d8e5d30>]}


============================== 22:05:22.548401 | 5bc92653-f410-49b8-b6d6-03a4e2c5fd6e ==============================
[0m22:05:22.548401 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.549042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.784155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053ca5f1a0>]}
[0m22:05:22.843225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053c3effb0>]}
[0m22:05:22.845734 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:22.861703 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.862443 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.862980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053b27ecc0>]}
[0m22:05:24.104102 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:24.104769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052fd1a540>]}
[0m22:05:24.286187 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:24.291648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05341e7110>]}
[0m22:05:24.443148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05341ab530>]}
[0m22:05:24.443786 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:24.444267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052fd051c0>]}
[0m22:05:24.446008 [info ] [MainThread]: 
[0m22:05:24.446725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:24.451879 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:24.487931 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:24.488435 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:24.488838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.927116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.928719 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.930951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.931515 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.940159 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.940587 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:24.940970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.947141 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.948601 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.949004 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.949594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.949984 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.950355 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.950924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.951864 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.952263 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.952638 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.953174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.953590 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.955410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.960945 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.961351 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.961723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.967450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.967887 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.968283 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:24.991326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.992775 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.993963 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.994365 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.997736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052fc9e7e0>]}
[0m22:05:24.998281 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.998682 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.999054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:25.005287 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.005723 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.006116 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.006503 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.007061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.007472 [debug] [MainThread]: On master: Close
[0m22:05:25.009009 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:25.009534 [info ] [MainThread]: 
[0m22:05:25.024856 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:25.025457 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:25.026186 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:25.026630 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:25.052413 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:25.053164 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:25.088873 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:25.089617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:03.618921 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.619454 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:03.620118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.620575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.621009 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:03.621701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.624607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.625087 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:03.625814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.646505 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:03.646981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.647419 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:03.648858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.653739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.654207 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:03.655947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.658259 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:03.689382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053ca5e210>]}
[0m22:06:03.690140 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 38.66s]
[0m22:06:03.691022 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:03.692020 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:03.692584 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:03.693257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:03.693722 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:03.698897 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:03.699586 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:03.733003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.733507 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241109220603727098"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:03.733979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:03.748249 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.755688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.756161 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:03.756754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.757205 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.757640 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241109220603727098'
      
      
      order by ordinal_position

  
[0m22:06:03.778529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.784722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.785205 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.788320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.795828 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.796294 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.799149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.816940 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:03.817635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.818110 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241109220603727098"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241109220603727098"
    )
  
[0m22:06:03.856241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.858261 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.858743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.859178 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.870200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.871108 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:04.567769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04f8854680>]}
[0m22:06:04.568617 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.87s]
[0m22:06:04.569390 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:04.570801 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:04.571275 [debug] [MainThread]: On master: BEGIN
[0m22:06:04.571756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:04.578554 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:04.579070 [debug] [MainThread]: On master: COMMIT
[0m22:06:04.579516 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:04.579997 [debug] [MainThread]: On master: COMMIT
[0m22:06:04.580582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:04.581035 [debug] [MainThread]: On master: Close
[0m22:06:04.582495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:04.582933 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:04.583340 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:04.583871 [info ] [MainThread]: 
[0m22:06:04.584392 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 40.14 seconds (40.14s).
[0m22:06:04.585381 [debug] [MainThread]: Command end result
[0m22:06:04.613040 [info ] [MainThread]: 
[0m22:06:04.613657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:04.614156 [info ] [MainThread]: 
[0m22:06:04.614664 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:04.615672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 42.118546, "process_user_time": 6.537428, "process_kernel_time": 0.332072, "process_mem_max_rss": "376100", "process_in_blocks": "3808", "process_out_blocks": "135264"}
[0m22:06:04.616309 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:04.616202 after 42.12 seconds
[0m22:06:04.616797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053efbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053b98bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05341ee810>]}
[0m22:06:04.617274 [debug] [MainThread]: Flushing usage events
[0m22:06:06.295920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3f479880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3d1d65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3dd810a0>]}


============================== 22:06:06.298729 | e10033c9-1dd7-4794-8b8a-550b6b4d95f0 ==============================
[0m22:06:06.298729 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:06.299474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:06.438612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e10033c9-1dd7-4794-8b8a-550b6b4d95f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3d13b350>]}
[0m22:06:06.456307 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20816721, "process_user_time": 1.37967, "process_kernel_time": 0.115637, "process_mem_max_rss": "92268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:06.456880 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:06.456777 after 0.21 seconds
[0m22:06:06.457311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3dd810a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3ce4d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3d2dc8c0>]}
[0m22:06:06.457742 [debug] [MainThread]: Flushing usage events
[0m06:02:07.274847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2f326180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2f327e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2f82a1b0>]}


============================== 06:02:07.289619 | 7a6d831a-357f-445b-9549-4f57c320ce66 ==============================
[0m06:02:07.289619 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.290404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.438582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a6d831a-357f-445b-9549-4f57c320ce66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba30164410>]}
[0m06:02:07.452500 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u1an8qs1'
[0m06:02:07.452994 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.495090 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.495787 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.506227 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.510098 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.752502 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.753138 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:07.753751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7a6d831a-357f-445b-9549-4f57c320ce66', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ec93d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ec92db0>]}
[0m06:02:07.754229 [info ] [MainThread]: 
[0m06:02:07.754823 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:07.760606 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53457224, "process_user_time": 1.605205, "process_kernel_time": 0.128096, "process_mem_max_rss": "93348", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m06:02:07.761333 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.761208 after 0.54 seconds
[0m06:02:07.761776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ef15370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ed20cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ef5d7f0>]}
[0m06:02:07.762203 [debug] [MainThread]: Flushing usage events
[0m06:02:09.601616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabccb064b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc302540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabccc375f0>]}


============================== 06:02:09.604628 | 335ea2b4-af6a-4731-b7c9-654823e6765c ==============================
[0m06:02:09.604628 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.605358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.852601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc3c57f0>]}
[0m06:02:09.912694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc012ab0>]}
[0m06:02:09.915360 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:09.938546 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.939301 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.939834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc03a1b0>]}
[0m06:02:11.169963 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.170642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc50e8440>]}
[0m06:02:11.354403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.359872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc4fcafc0>]}
[0m06:02:11.494764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc4b7b7d0>]}
[0m06:02:11.495357 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:11.495890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc4a0caa0>]}
[0m06:02:11.497744 [info ] [MainThread]: 
[0m06:02:11.498540 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.503619 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.540044 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.540556 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.540967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.031913 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.033509 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.035987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.036583 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.045487 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.045936 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.046330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.052924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.054631 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.055109 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.055706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.056111 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.056496 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.057095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.058037 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.058434 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.058852 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.059392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.059803 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.062566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.069067 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.069497 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.069877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.076288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.076717 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.077115 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.101088 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.102742 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.104014 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.104429 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.108370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabce741d90>]}
[0m06:02:12.108918 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.109321 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.109699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.116321 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.116770 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.117169 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.117554 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.118155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.118612 [debug] [MainThread]: On master: Close
[0m06:02:12.120374 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.120921 [info ] [MainThread]: 
[0m06:02:12.157054 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.157730 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.158555 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:12.159016 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.186029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.186900 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.225206 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.226126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.891615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.892181 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.892986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.893456 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.893899 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.894701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.897902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.898380 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.899202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.920547 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.921130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.921579 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.924242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.929601 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.930074 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.931440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.933955 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.964347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabce6096a0>]}
[0m06:02:20.965200 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.80s]
[0m06:02:20.966017 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.967110 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.967710 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.968313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.968780 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.974239 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.974980 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:21.009452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.010055 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241110060221003356"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:21.010587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:21.025578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.033928 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.034453 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:21.035213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.035666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.036107 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241110060221003356'
      
      
      order by ordinal_position

  
[0m06:02:21.057617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.064861 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.065405 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.068904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.077145 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.077665 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.080915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.099543 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.100362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.100847 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241110060221003356"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241110060221003356"
    )
  
[0m06:02:21.138530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.140619 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.141084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.141512 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.152935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.154066 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.870172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab895f02c0>]}
[0m06:02:21.871051 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.90s]
[0m06:02:21.871812 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.873303 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.873809 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.874248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.881424 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.881946 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.882397 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.882884 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.883493 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.883951 [debug] [MainThread]: On master: Close
[0m06:02:21.885982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.886424 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.886886 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.887362 [info ] [MainThread]: 
[0m06:02:21.887967 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m06:02:21.889153 [debug] [MainThread]: Command end result
[0m06:02:21.918461 [info ] [MainThread]: 
[0m06:02:21.919283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.919913 [info ] [MainThread]: 
[0m06:02:21.920526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.921668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.370506, "process_user_time": 6.691383, "process_kernel_time": 0.366869, "process_mem_max_rss": "377236", "process_in_blocks": "3808", "process_out_blocks": "135208"}
[0m06:02:21.922324 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.922209 after 12.37 seconds
[0m06:02:21.922869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc7b8980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabccc35f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc663f20>]}
[0m06:02:21.923379 [debug] [MainThread]: Flushing usage events
[0m06:02:23.969098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68384464e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6838447ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68384465a0>]}


============================== 06:02:23.972250 | 145f60a3-f508-406a-80b1-88a8ebba7d58 ==============================
[0m06:02:23.972250 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.973019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.129755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '145f60a3-f508-406a-80b1-88a8ebba7d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6838f31fa0>]}
[0m06:02:24.147739 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22895674, "process_user_time": 1.465179, "process_kernel_time": 0.115777, "process_mem_max_rss": "92388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:24.148377 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:24.148264 after 0.23 seconds
[0m06:02:24.148855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683883a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68392f1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68382d2210>]}
[0m06:02:24.149308 [debug] [MainThread]: Flushing usage events
[0m14:04:45.952315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e4ff0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e4ff8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e4fd8e0>]}


============================== 14:04:45.968530 | 8a1c1fbc-2e20-40d2-90de-86c214da8b0c ==============================
[0m14:04:45.968530 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:45.969191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:46.113044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a1c1fbc-2e20-40d2-90de-86c214da8b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773dedf7a0>]}
[0m14:04:46.126783 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ulq2gpew'
[0m14:04:46.127346 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:46.223502 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:46.224220 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:46.247407 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:46.251278 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:46.333193 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:46.333821 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:46.334432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8a1c1fbc-2e20-40d2-90de-86c214da8b0c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773df1fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773df53920>]}
[0m14:04:46.334929 [info ] [MainThread]: 
[0m14:04:46.335455 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:46.371216 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46791857, "process_user_time": 1.614835, "process_kernel_time": 0.104964, "process_mem_max_rss": "93492", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:04:46.371914 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:46.371808 after 0.47 seconds
[0m14:04:46.372357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e4fd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e918710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e96d700>]}
[0m14:04:46.372801 [debug] [MainThread]: Flushing usage events
[0m14:04:48.007923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b7bba000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b95a60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b730d070>]}


============================== 14:04:48.010848 | 45d64d9a-f735-425a-98ea-d052c8eaffad ==============================
[0m14:04:48.010848 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:48.011510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:48.256598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b709e9c0>]}
[0m14:04:48.316199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b01332f0>]}
[0m14:04:48.318887 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:48.339398 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:48.340145 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:48.340685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b0029b50>]}
[0m14:04:49.574891 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:49.575579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16afbc0080>]}
[0m14:04:49.761284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:49.767794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16af93c6b0>]}
[0m14:04:49.905686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16af97c710>]}
[0m14:04:49.906269 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:49.906833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16af98f1d0>]}
[0m14:04:49.908669 [info ] [MainThread]: 
[0m14:04:49.909419 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:49.914391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:49.950729 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:49.951293 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:49.951696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:50.479315 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:50.480848 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:50.482953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:50.483517 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:50.492086 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.492522 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:50.492924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:50.499262 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.500748 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.501166 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:50.501703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.502096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.502469 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:50.503070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.503980 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:50.504377 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.504749 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:50.505340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.505746 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:50.508152 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro_main'
[0m14:04:50.513974 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:50.514382 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:50.514756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:50.522292 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.522713 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:50.523135 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:50.546378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.547918 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:50.549184 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:50.549595 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:50.553111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b7269dc0>]}
[0m14:04:50.553651 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:50.554055 [debug] [MainThread]: On master: BEGIN
[0m14:04:50.554428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:50.561190 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:50.561610 [debug] [MainThread]: On master: COMMIT
[0m14:04:50.561997 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:50.562370 [debug] [MainThread]: On master: COMMIT
[0m14:04:50.562914 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:50.563316 [debug] [MainThread]: On master: Close
[0m14:04:50.564719 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:50.565249 [info ] [MainThread]: 
[0m14:04:50.578497 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:50.579142 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:50.579731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_petro_main, now model.petro.stg_petro)
[0m14:04:50.580168 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:50.606518 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:50.607422 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:50.643841 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:50.644726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:57.947546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.948084 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:57.948748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.949203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.949637 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:57.950367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.953376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.953828 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:57.954545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.975506 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:57.976020 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.976495 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:57.978898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.984030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.984499 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:57.986615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.989027 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:58.021414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16afb305f0>]}
[0m14:04:58.022241 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.44s]
[0m14:04:58.023149 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:58.024133 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:58.024701 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:58.025389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:58.025846 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:58.031200 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:58.031855 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:58.065807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.066382 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241110140458059849"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:58.066895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:58.081436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.089430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.089916 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:58.090578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.091046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.091483 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241110140458059849'
      
      
      order by ordinal_position

  
[0m14:04:58.112925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.119940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.120442 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:58.123448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.131280 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.131772 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:58.134720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.152834 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:58.153612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.154098 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241110140458059849"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241110140458059849"
    )
  
[0m14:04:58.192195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.194245 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:58.194711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.195167 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:58.209038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.210073 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:58.409637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167423b9b0>]}
[0m14:04:58.410471 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m14:04:58.411251 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:58.412618 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.413089 [debug] [MainThread]: On master: BEGIN
[0m14:04:58.413519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:58.420230 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.420710 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.421143 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.421565 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.422158 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.422608 [debug] [MainThread]: On master: Close
[0m14:04:58.424168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:58.424603 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:58.425008 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:58.425469 [info ] [MainThread]: 
[0m14:04:58.426016 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m14:04:58.427082 [debug] [MainThread]: Command end result
[0m14:04:58.455133 [info ] [MainThread]: 
[0m14:04:58.455875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:58.456475 [info ] [MainThread]: 
[0m14:04:58.457081 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:58.458179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.499041, "process_user_time": 5.527343, "process_kernel_time": 0.354007, "process_mem_max_rss": "302932", "process_in_blocks": "3808", "process_out_blocks": "117288"}
[0m14:04:58.458844 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:58.458703 after 10.50 seconds
[0m14:04:58.459350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b95a60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b712c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16afbedf70>]}
[0m14:04:58.460095 [debug] [MainThread]: Flushing usage events
[0m14:05:00.145258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee486a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee63097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee3e86ae0>]}


============================== 14:05:00.148175 | 8847e53d-a10d-47ef-9c44-e2c411f2773b ==============================
[0m14:05:00.148175 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:00.148837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:00.291921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8847e53d-a10d-47ef-9c44-e2c411f2773b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee4388c80>]}
[0m14:05:00.308647 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21214902, "process_user_time": 1.428047, "process_kernel_time": 0.103712, "process_mem_max_rss": "92396", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:00.309239 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:00.309135 after 0.21 seconds
[0m14:05:00.309693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee3eab260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee3dc1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee3d57f50>]}
[0m14:05:00.310127 [debug] [MainThread]: Flushing usage events
[0m22:05:22.942568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241072dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24117abec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24117a9b80>]}


============================== 22:05:22.950611 | f962e772-7c5d-4bf5-a5b2-5f1353be28f6 ==============================
[0m22:05:22.950611 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.951382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:23.110176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f962e772-7c5d-4bf5-a5b2-5f1353be28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2411621640>]}
[0m22:05:23.124488 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6sebl8rf'
[0m22:05:23.125017 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:23.241845 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:23.242575 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:23.255206 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:23.259208 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:23.490881 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:23.491520 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:23.492068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f962e772-7c5d-4bf5-a5b2-5f1353be28f6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241053c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241053f050>]}
[0m22:05:23.492535 [info ] [MainThread]: 
[0m22:05:23.493018 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:23.494763 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6015157, "process_user_time": 1.625958, "process_kernel_time": 0.138463, "process_mem_max_rss": "93648", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:23.495362 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:23.495255 after 0.60 seconds
[0m22:05:23.495801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2411ced880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2410401ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24104026f0>]}
[0m22:05:23.496227 [debug] [MainThread]: Flushing usage events
[0m22:05:25.391620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc39f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc39f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc39f0e0>]}


============================== 22:05:25.394745 | 0d83f569-b54f-4d43-a7c7-34ab21386646 ==============================
[0m22:05:25.394745 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.395446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:25.645668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dbfdb590>]}
[0m22:05:25.706861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc3e2360>]}
[0m22:05:25.709670 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:25.725794 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:25.726600 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:25.727143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc3476b0>]}
[0m22:05:26.973141 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:26.973890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d4c40080>]}
[0m22:05:27.162330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:27.168088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d4cd3230>]}
[0m22:05:27.328369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d4c40230>]}
[0m22:05:27.328990 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:27.329538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d4a3e420>]}
[0m22:05:27.331426 [info ] [MainThread]: 
[0m22:05:27.332183 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:27.337521 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:27.374931 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:27.375471 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:27.375885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:27.893538 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:27.895122 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:27.897293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:27.897876 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:27.906907 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.907427 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:27.907826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:27.914678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.916457 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.916899 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:27.917575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.917973 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.918357 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:27.918938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.919886 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:27.920286 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.920670 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:27.921249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.921668 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:27.924126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:27.930282 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:27.930750 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:27.931155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:27.937646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.938139 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:27.938555 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:27.962317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.964103 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:27.965435 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:27.965849 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:27.970131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dd88d130>]}
[0m22:05:27.970687 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:27.971089 [debug] [MainThread]: On master: BEGIN
[0m22:05:27.971491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:27.978384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:27.978907 [debug] [MainThread]: On master: COMMIT
[0m22:05:27.979306 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:27.979691 [debug] [MainThread]: On master: COMMIT
[0m22:05:27.980240 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:27.980657 [debug] [MainThread]: On master: Close
[0m22:05:27.982991 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:27.983530 [info ] [MainThread]: 
[0m22:05:27.994074 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:27.994751 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:27.995526 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:27.995970 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:28.023259 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:28.024154 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:28.061807 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:28.062722 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:37.554075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.554640 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:37.555409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.555868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.556308 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:37.557074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.560278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.560749 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:37.561576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.582915 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.583494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.583940 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.586145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.591589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.592093 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:37.593452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.595894 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:37.626949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f999a465550>]}
[0m22:05:37.627787 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.63s]
[0m22:05:37.628582 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:37.629630 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:37.630208 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:37.630847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:37.631299 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:37.636791 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:37.637567 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:37.672162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.672768 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241110220537665875"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:37.673291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:37.687970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.696155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.696686 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:37.697444 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.697893 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.698330 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241110220537665875'
      
      
      order by ordinal_position

  
[0m22:05:37.719380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.726589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.727139 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:37.730519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.738833 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.739364 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:37.742673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.761367 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:37.762196 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.762685 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241110220537665875"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241110220537665875"
    )
  
[0m22:05:37.795668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.797767 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:37.798241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.798676 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:37.806569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.807583 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:37.852421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9999517830>]}
[0m22:05:37.853312 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.22s]
[0m22:05:37.854192 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:37.855693 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.856173 [debug] [MainThread]: On master: BEGIN
[0m22:05:37.856604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:37.863572 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.864106 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.864545 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.864974 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.865660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.866129 [debug] [MainThread]: On master: Close
[0m22:05:37.867940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:37.868380 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:37.868785 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:37.869313 [info ] [MainThread]: 
[0m22:05:37.869884 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.54 seconds (10.54s).
[0m22:05:37.870943 [debug] [MainThread]: Command end result
[0m22:05:37.899961 [info ] [MainThread]: 
[0m22:05:37.900687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:37.901248 [info ] [MainThread]: 
[0m22:05:37.901803 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:37.902911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.560802, "process_user_time": 5.487418, "process_kernel_time": 0.314819, "process_mem_max_rss": "288552", "process_in_blocks": "3808", "process_out_blocks": "108104"}
[0m22:05:37.903577 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:37.903466 after 12.56 seconds
[0m22:05:37.904078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc711ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc316a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99994eeb40>]}
[0m22:05:37.904573 [debug] [MainThread]: Flushing usage events
[0m22:05:39.950659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f204feaf1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20521913a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f204ff24fe0>]}


============================== 22:05:39.953768 | 1f0c1f09-41a2-4925-b6b0-c1c2a70ad1e2 ==============================
[0m22:05:39.953768 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:39.954533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.112860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f0c1f09-41a2-4925-b6b0-c1c2a70ad1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f204fdabf20>]}
[0m22:05:40.131167 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2307221, "process_user_time": 1.441697, "process_kernel_time": 0.132155, "process_mem_max_rss": "92160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:40.131775 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:40.131667 after 0.23 seconds
[0m22:05:40.132231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2050b94950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2051860320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f204fdabf20>]}
[0m22:05:40.132667 [debug] [MainThread]: Flushing usage events
[0m06:02:04.494858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f54d868a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f5661f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f558adaf0>]}


============================== 06:02:04.501663 | 8bd4b2c6-62fe-4995-adb7-dbfc4a21295c ==============================
[0m06:02:04.501663 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:04.502301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.638480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bd4b2c6-62fe-4995-adb7-dbfc4a21295c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f5572ddc0>]}
[0m06:02:04.651463 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bh4y7oa1'
[0m06:02:04.651909 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:04.770030 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:04.770736 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:04.847911 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:04.851882 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:04.923805 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:04.924333 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:04.924901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8bd4b2c6-62fe-4995-adb7-dbfc4a21295c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f54cf7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f54cf7320>]}
[0m06:02:04.925336 [info ] [MainThread]: 
[0m06:02:04.925847 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:04.927470 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48067597, "process_user_time": 1.502616, "process_kernel_time": 0.148654, "process_mem_max_rss": "93776", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:04.928039 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:04.927939 after 0.48 seconds
[0m06:02:04.928464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f553d6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f5572ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f557b1640>]}
[0m06:02:04.928889 [debug] [MainThread]: Flushing usage events
[0m06:02:06.501583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc29d9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc2317ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc299dc10>]}


============================== 06:02:06.504288 | a56c9828-c5b9-47b0-b680-688dd5c71c1b ==============================
[0m06:02:06.504288 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.505009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.738785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc20a75c0>]}
[0m06:02:06.798679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc3b391f0>]}
[0m06:02:06.801076 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:06.816451 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:06.817156 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:06.817695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc2076c30>]}
[0m06:02:08.045327 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:08.045964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba9b8560>]}
[0m06:02:08.228047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:08.233128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbad629f0>]}
[0m06:02:08.372661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba9e5190>]}
[0m06:02:08.373193 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:08.373676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba8ff110>]}
[0m06:02:08.375359 [info ] [MainThread]: 
[0m06:02:08.376027 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:08.380631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:08.415443 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:08.415883 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:08.416282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:08.866027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.867781 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:08.870716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:08.871530 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:08.880071 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.880497 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:08.880884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:08.887004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.888473 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.888877 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:08.889429 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.889823 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.890205 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:08.890776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.891716 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:08.892125 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.892500 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:08.893033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.893442 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:08.895292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:08.900800 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:08.901211 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:08.901583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:08.907313 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.907723 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:08.908116 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:08.930882 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.932316 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:08.933496 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:08.933890 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:08.937080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba786ff0>]}
[0m06:02:08.937592 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:08.937983 [debug] [MainThread]: On master: BEGIN
[0m06:02:08.938348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:08.944376 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:08.944792 [debug] [MainThread]: On master: COMMIT
[0m06:02:08.945181 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:08.945565 [debug] [MainThread]: On master: COMMIT
[0m06:02:08.946093 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:08.946494 [debug] [MainThread]: On master: Close
[0m06:02:08.947951 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:08.948452 [info ] [MainThread]: 
[0m06:02:08.957780 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:08.958360 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:08.959012 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:08.959499 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:08.984787 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:08.985528 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:09.020764 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:09.021488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:16.349253 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.350056 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:16.350997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.351488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.351918 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:16.352633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.355491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.355941 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:16.356613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.377205 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:16.377688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.378135 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:16.440314 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.445227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.445690 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:16.483359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.485643 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:16.515173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc355a4b0>]}
[0m06:02:16.515872 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.56s]
[0m06:02:16.516627 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:16.517620 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:16.518180 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:16.518748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:16.519232 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:16.524241 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:16.524884 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:16.558300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.558804 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241111060216552457"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:16.559299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:16.572698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.579935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.580398 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:16.581022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.581473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.581914 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241111060216552457'
      
      
      order by ordinal_position

  
[0m06:02:16.603499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.609409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.609894 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:16.614180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.621641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.622124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:16.626330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.644279 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:16.644947 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.645429 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241111060216552457"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241111060216552457"
    )
  
[0m06:02:16.678354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.680338 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:16.680799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.681225 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:16.688366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.689258 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:16.737560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7705b2c0>]}
[0m06:02:16.738265 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.22s]
[0m06:02:16.739150 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:16.740634 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.741090 [debug] [MainThread]: On master: BEGIN
[0m06:02:16.741519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:16.747865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.748330 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.748761 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.749177 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.749747 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.750193 [debug] [MainThread]: On master: Close
[0m06:02:16.751658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:16.752095 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:16.752502 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:16.752955 [info ] [MainThread]: 
[0m06:02:16.753494 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m06:02:16.754507 [debug] [MainThread]: Command end result
[0m06:02:16.782012 [info ] [MainThread]: 
[0m06:02:16.782647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:16.783206 [info ] [MainThread]: 
[0m06:02:16.783753 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:16.784757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.332499, "process_user_time": 5.225873, "process_kernel_time": 0.30811, "process_mem_max_rss": "277932", "process_in_blocks": "3808", "process_out_blocks": "109104"}
[0m06:02:16.785396 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:16.785286 after 10.33 seconds
[0m06:02:16.785882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc2db87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc59bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba8fda30>]}
[0m06:02:16.786362 [debug] [MainThread]: Flushing usage events
[0m06:02:18.379558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87eddf5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87eccc0c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec4ba6f0>]}


============================== 06:02:18.382207 | cae8370f-392f-4676-ba38-b79d8a9fe7f1 ==============================
[0m06:02:18.382207 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.382854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.516956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cae8370f-392f-4676-ba38-b79d8a9fe7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f01bbd10>]}
[0m06:02:18.532895 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20142232, "process_user_time": 1.38019, "process_kernel_time": 0.108014, "process_mem_max_rss": "92112", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:18.533448 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:18.533348 after 0.20 seconds
[0m06:02:18.533871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec54eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec3d70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ed0bbd70>]}
[0m06:02:18.534284 [debug] [MainThread]: Flushing usage events
[0m14:05:16.614014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f5edaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280fb61640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280fe96120>]}


============================== 14:05:16.621830 | e2cc433d-89c1-4981-a268-3496b7d182c2 ==============================
[0m14:05:16.621830 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.622505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.760507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2cc433d-89c1-4981-a268-3496b7d182c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f8a1670>]}
[0m14:05:16.774180 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ilny5kei'
[0m14:05:16.774635 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.867266 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.867998 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.890228 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.894177 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.971498 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.972107 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.972674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e2cc433d-89c1-4981-a268-3496b7d182c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f618680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f463110>]}
[0m14:05:16.973139 [info ] [MainThread]: 
[0m14:05:16.973610 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.975435 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40969405, "process_user_time": 1.585343, "process_kernel_time": 0.103305, "process_mem_max_rss": "93640", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:16.976025 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.975920 after 0.41 seconds
[0m14:05:16.976463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f5eb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2812fbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f89bb30>]}
[0m14:05:16.976948 [debug] [MainThread]: Flushing usage events
[0m14:05:18.596620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d9c196d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d88aebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d8ca1d30>]}


============================== 14:05:18.599493 | 3cbd51f9-f165-4511-bbee-0796e5c41787 ==============================
[0m14:05:18.599493 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.600199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.843294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d985f440>]}
[0m14:05:18.903261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0da0b77a0>]}
[0m14:05:18.905861 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.922068 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.922821 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.923384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d9225a90>]}
[0m14:05:20.180554 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:20.181255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0fc8800>]}
[0m14:05:20.364364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:20.369685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d805d370>]}
[0m14:05:20.491026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0fa80e0>]}
[0m14:05:20.491581 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:20.492108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0a952b0>]}
[0m14:05:20.493867 [info ] [MainThread]: 
[0m14:05:20.494565 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:20.499505 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:20.535851 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:20.536353 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:20.536800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.086035 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:21.087566 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:21.089653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:21.090216 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:21.099061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.099550 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:21.099943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.106683 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.108299 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.108760 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:21.109312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.109701 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.110072 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:21.110669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.111976 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.112532 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.112960 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.113542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.113953 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:21.116407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:21.123094 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.123535 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:21.123906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.130485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.130958 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.131356 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:21.154965 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.156715 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:21.157966 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:21.158371 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:21.162258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d08a3ce0>]}
[0m14:05:21.162805 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.163204 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.163583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:21.170163 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.170597 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.170990 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.171366 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.171907 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.172311 [debug] [MainThread]: On master: Close
[0m14:05:21.173906 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:21.174430 [info ] [MainThread]: 
[0m14:05:21.184654 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:21.185276 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:21.186017 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:21.186463 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:21.212602 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:21.213443 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:21.249643 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:21.250523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:28.024415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.024977 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:28.025673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.026129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.026562 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:28.027298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.030272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.030733 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:28.031414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.052374 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.052910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.053350 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.055605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.060676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.061151 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:28.062643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.065041 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:28.095316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0b3cfb0>]}
[0m14:05:28.096136 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.91s]
[0m14:05:28.097042 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:28.098041 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:28.098611 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:28.099301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:28.099759 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:28.105248 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:28.105939 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:28.140088 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.140690 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241111140528134102"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:28.141173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:28.156143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.164168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.164694 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:28.165352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.165802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.166239 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241111140528134102'
      
      
      order by ordinal_position

  
[0m14:05:28.187789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.194676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.195175 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.198301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.205962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.206438 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.209245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.227374 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:28.228094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.228599 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241111140528134102"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241111140528134102"
    )
  
[0m14:05:28.264244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.266294 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.266751 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.267179 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.275196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.276283 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:28.326002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0913617f0>]}
[0m14:05:28.326820 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.23s]
[0m14:05:28.327681 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:28.329239 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.329716 [debug] [MainThread]: On master: BEGIN
[0m14:05:28.330146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:28.337229 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.337850 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.338292 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.338715 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.339307 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.339758 [debug] [MainThread]: On master: Close
[0m14:05:28.341480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:28.341920 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:28.342325 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:28.342795 [info ] [MainThread]: 
[0m14:05:28.343391 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.85 seconds (7.85s).
[0m14:05:28.344547 [debug] [MainThread]: Command end result
[0m14:05:28.373316 [info ] [MainThread]: 
[0m14:05:28.374089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:28.374704 [info ] [MainThread]: 
[0m14:05:28.375311 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:28.376407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.828882, "process_user_time": 5.414613, "process_kernel_time": 0.319681, "process_mem_max_rss": "291200", "process_in_blocks": "3808", "process_out_blocks": "109096"}
[0m14:05:28.377098 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:28.376984 after 9.83 seconds
[0m14:05:28.377601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d912e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0da62a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0ff7ef0>]}
[0m14:05:28.378091 [debug] [MainThread]: Flushing usage events
[0m14:05:30.091316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1299fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1299d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1321a180>]}


============================== 14:05:30.094361 | 6bab8285-69d2-4821-bcb8-156a3338a2b0 ==============================
[0m14:05:30.094361 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.095125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:30.242174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bab8285-69d2-4821-bcb8-156a3338a2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c12d4c770>]}
[0m14:05:30.264887 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22295587, "process_user_time": 1.453322, "process_kernel_time": 0.099816, "process_mem_max_rss": "92392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:30.265787 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:30.265643 after 0.22 seconds
[0m14:05:30.266530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c12393410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1299fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1299eb40>]}
[0m14:05:30.267149 [debug] [MainThread]: Flushing usage events
[0m22:05:25.942905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3f424200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3db79c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3db79a60>]}


============================== 22:05:25.971106 | 1b6460e1-a816-42e0-bea4-d2266fe913d0 ==============================
[0m22:05:25.971106 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.971776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:26.111563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b6460e1-a816-42e0-bea4-d2266fe913d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3db75580>]}
[0m22:05:26.125296 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fei3dr1g'
[0m22:05:26.125774 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:26.307527 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:26.308244 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:26.339421 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:26.343356 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:26.700176 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:26.700723 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:26.701302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1b6460e1-a816-42e0-bea4-d2266fe913d0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d845a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d845220>]}
[0m22:05:26.701763 [info ] [MainThread]: 
[0m22:05:26.702255 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:26.727429 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.83252406, "process_user_time": 1.60043, "process_kernel_time": 0.104288, "process_mem_max_rss": "93456", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:05:26.728043 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:26.727940 after 0.83 seconds
[0m22:05:26.728468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3dfa8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d9ec4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d9807d0>]}
[0m22:05:26.728868 [debug] [MainThread]: Flushing usage events
[0m22:05:28.433481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e0de180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e88ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e681d60>]}


============================== 22:05:28.436439 | 43ea7bc3-3505-4882-9707-320302d1383d ==============================
[0m22:05:28.436439 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:28.437194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:28.665935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e9068a0>]}
[0m22:05:28.723862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097f8dc590>]}
[0m22:05:28.726343 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:28.759790 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:28.760506 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:28.761064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097d653950>]}
[0m22:05:29.983097 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:29.983738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09760162d0>]}
[0m22:05:30.176251 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:30.181468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0976057620>]}
[0m22:05:30.312156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09761af560>]}
[0m22:05:30.312725 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:30.313291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09760bd3a0>]}
[0m22:05:30.315003 [info ] [MainThread]: 
[0m22:05:30.315729 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:30.320517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:30.356088 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:30.356540 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:30.357026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:30.992727 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:30.994296 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:30.996528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:30.997133 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:31.005254 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.005691 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:31.006087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:31.012448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.013934 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.014378 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:31.014927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.015322 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.015700 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:31.016244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.017120 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:31.017492 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.017873 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:31.018412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.018815 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:31.020868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:31.026407 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:31.026813 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:31.027186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:31.032915 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.033329 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:31.033721 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:31.057341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.058770 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:31.059970 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:31.060379 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:31.063577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0974d50140>]}
[0m22:05:31.064078 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:31.064469 [debug] [MainThread]: On master: BEGIN
[0m22:05:31.064836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:31.071209 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:31.071630 [debug] [MainThread]: On master: COMMIT
[0m22:05:31.072010 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:31.072384 [debug] [MainThread]: On master: COMMIT
[0m22:05:31.072957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:31.073356 [debug] [MainThread]: On master: Close
[0m22:05:31.074737 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:31.075233 [info ] [MainThread]: 
[0m22:05:31.093407 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:31.094006 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:31.094676 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:31.095122 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:31.121282 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:31.122027 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:31.157474 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:31.158219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:42.547820 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.548338 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:42.549026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.549473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.549903 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:42.550641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.553584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.554041 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:42.554773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.575625 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.576103 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.576536 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.577816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.582741 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.583208 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:42.584456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.586816 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:42.616052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e172360>]}
[0m22:05:42.616773 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.52s]
[0m22:05:42.617573 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:42.618550 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:42.619112 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:42.619714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:42.620164 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:42.625381 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:42.626049 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:42.658508 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.659019 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241111220542652744"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:42.659494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:42.673914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.681315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.681788 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:42.682380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.682820 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.683252 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241111220542652744'
      
      
      order by ordinal_position

  
[0m22:05:42.705122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.711171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.711656 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.716218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.723682 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.724168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.726886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.744392 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:42.745057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.745519 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241111220542652744"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241111220542652744"
    )
  
[0m22:05:42.776715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.778619 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.779068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.779485 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.787542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.788413 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:42.843952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0939a43320>]}
[0m22:05:42.844681 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.22s]
[0m22:05:42.845461 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:42.846840 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.847307 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.847739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:42.854293 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.854759 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.855197 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.855619 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.856225 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.856673 [debug] [MainThread]: On master: Close
[0m22:05:42.858021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:42.858449 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:42.858860 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:42.859313 [info ] [MainThread]: 
[0m22:05:42.859832 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m22:05:42.860826 [debug] [MainThread]: Command end result
[0m22:05:42.888439 [info ] [MainThread]: 
[0m22:05:42.889084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:42.889596 [info ] [MainThread]: 
[0m22:05:42.890115 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:42.891093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.506494, "process_user_time": 4.786452, "process_kernel_time": 0.312682, "process_mem_max_rss": "284300", "process_in_blocks": "3808", "process_out_blocks": "109128"}
[0m22:05:42.891742 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:42.891632 after 14.51 seconds
[0m22:05:42.892225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0976118560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097d78bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0976182330>]}
[0m22:05:42.892708 [debug] [MainThread]: Flushing usage events
[0m22:05:44.669181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23d1e0deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfe9d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfe9fda0>]}


============================== 22:05:44.671834 | f26a8edc-1fe1-4357-807c-87481273e699 ==============================
[0m22:05:44.671834 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.672542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.806356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f26a8edc-1fe1-4357-807c-87481273e699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfad63c0>]}
[0m22:05:44.822424 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19968787, "process_user_time": 1.369118, "process_kernel_time": 0.104085, "process_mem_max_rss": "92176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:44.822989 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:44.822886 after 0.20 seconds
[0m22:05:44.823421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23d0291ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfba20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfba2ab0>]}
[0m22:05:44.823844 [debug] [MainThread]: Flushing usage events
[0m06:02:17.446152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e9cd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f304050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e9cdd60>]}


============================== 06:02:17.453823 | c528ab05-81a6-4a70-ab53-3b245d77f70b ==============================
[0m06:02:17.453823 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.454595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.595465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c528ab05-81a6-4a70-ab53-3b245d77f70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2dffb8c0>]}
[0m06:02:17.608939 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kvi6nfsi'
[0m06:02:17.609388 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:17.672669 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:17.673392 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:17.686329 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:17.690254 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:17.864585 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:17.865183 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:17.865727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c528ab05-81a6-4a70-ab53-3b245d77f70b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e03bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f12a060>]}
[0m06:02:17.866190 [info ] [MainThread]: 
[0m06:02:17.866675 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:17.868403 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47084993, "process_user_time": 1.537233, "process_kernel_time": 0.163281, "process_mem_max_rss": "93640", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:17.868995 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:17.868890 after 0.47 seconds
[0m06:02:17.869431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e25c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e5fd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e074800>]}
[0m06:02:17.869861 [debug] [MainThread]: Flushing usage events
[0m06:02:19.514636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c6f6f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c718ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c6f6f230>]}


============================== 06:02:19.517492 | e92634c8-0694-4a55-8ec7-95b9a2114e1c ==============================
[0m06:02:19.517492 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.518257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:19.758177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bff600b0>]}
[0m06:02:19.817794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c91c0320>]}
[0m06:02:19.820396 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:19.845371 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:19.846112 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:19.846661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bffb8050>]}
[0m06:02:21.078759 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:21.079419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf9af380>]}
[0m06:02:21.262452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:21.267769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf8ec8c0>]}
[0m06:02:21.389937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf9ff590>]}
[0m06:02:21.390503 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:21.391065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf712c60>]}
[0m06:02:21.392790 [info ] [MainThread]: 
[0m06:02:21.393486 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:21.398212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:21.433857 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:21.434322 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:21.434807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:21.968263 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:21.969837 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:21.971996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:21.972558 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:21.981216 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.981653 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:21.982056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:21.988382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.989843 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.990242 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:21.990822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.991221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.991598 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:21.992163 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.993084 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.993492 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.993873 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.994471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.994929 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:21.996793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.002440 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.002884 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.003261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.009124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.009536 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.009932 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:22.033257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.034743 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.035956 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.036360 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.039785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3be5b26c0>]}
[0m06:02:22.040302 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.040697 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.041066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.047662 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.048091 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.048485 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.048867 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.049436 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.049841 [debug] [MainThread]: On master: Close
[0m06:02:22.051172 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.051661 [info ] [MainThread]: 
[0m06:02:22.061154 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:22.061756 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:22.062427 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:22.062927 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:22.089409 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:22.090179 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:22.126348 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:22.127115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:29.610647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.611203 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:29.611826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.612287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.612723 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:29.613428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.616344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.616800 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:29.617483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.638394 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.638907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.639354 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.641150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.646161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.646703 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:29.647859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.650195 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:29.681616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c7a0a570>]}
[0m06:02:29.682373 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.62s]
[0m06:02:29.683320 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:29.684332 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:29.684899 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:29.685570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:29.686032 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:29.691252 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:29.691901 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.725538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.726043 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241112060229719694"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.726527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.741103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.748891 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.749369 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.749985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.750436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.750900 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241112060229719694'
      
      
      order by ordinal_position

  
[0m06:02:29.772000 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.778416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.778961 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.781716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.789281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.789758 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.792987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.810595 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.811306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.811777 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241112060229719694"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241112060229719694"
    )
  
[0m06:02:29.848890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.850935 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.851397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.851825 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.859064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.859969 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:29.921517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37ff96cf0>]}
[0m06:02:29.922331 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.24s]
[0m06:02:29.923228 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:29.924574 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.925047 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.925481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:29.932103 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.932587 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.933029 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.933456 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.934113 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.934587 [debug] [MainThread]: On master: Close
[0m06:02:29.936004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:29.936447 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:29.936853 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:29.937318 [info ] [MainThread]: 
[0m06:02:29.937847 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.54 seconds (8.54s).
[0m06:02:29.938958 [debug] [MainThread]: Command end result
[0m06:02:29.966554 [info ] [MainThread]: 
[0m06:02:29.967215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:29.967734 [info ] [MainThread]: 
[0m06:02:29.968257 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:29.969249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.5028105, "process_user_time": 5.365373, "process_kernel_time": 0.323359, "process_mem_max_rss": "295596", "process_in_blocks": "3808", "process_out_blocks": "109624"}
[0m06:02:29.969893 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:29.969782 after 10.50 seconds
[0m06:02:29.970389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bff834a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf711c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c6f6f230>]}
[0m06:02:29.970927 [debug] [MainThread]: Flushing usage events
[0m06:02:31.708155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636968ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636992f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636bc5ed50>]}


============================== 06:02:31.710943 | dad52457-a907-4f28-84c4-6a32add6026b ==============================
[0m06:02:31.710943 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.711642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.855309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dad52457-a907-4f28-84c4-6a32add6026b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6369753110>]}
[0m06:02:31.872159 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21244165, "process_user_time": 1.381834, "process_kernel_time": 0.144191, "process_mem_max_rss": "91980", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:31.872750 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:31.872644 after 0.21 seconds
[0m06:02:31.873197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6369a05460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636995bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6369aaf0e0>]}
[0m06:02:31.873630 [debug] [MainThread]: Flushing usage events
[0m14:05:23.298014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecb731cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecda99d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecc498980>]}


============================== 14:05:23.305962 | 2f6684ec-cc50-4e9c-828f-7e9921082d2b ==============================
[0m14:05:23.305962 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.306744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.453283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f6684ec-cc50-4e9c-828f-7e9921082d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecc7dbd40>]}
[0m14:05:23.466957 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3f8dgcju'
[0m14:05:23.467442 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:23.525994 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:23.526709 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:23.539855 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:23.543728 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:23.713985 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:23.714606 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:23.715236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f6684ec-cc50-4e9c-828f-7e9921082d2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecb465be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecb4b3980>]}
[0m14:05:23.715714 [info ] [MainThread]: 
[0m14:05:23.716232 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:23.724416 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47449955, "process_user_time": 1.597636, "process_kernel_time": 0.121033, "process_mem_max_rss": "93672", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:23.725017 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:23.724911 after 0.48 seconds
[0m14:05:23.725530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecda99d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecbfa7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eccc21880>]}
[0m14:05:23.725978 [debug] [MainThread]: Flushing usage events
[0m14:05:25.364836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cc74c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ce2edb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cc74c440>]}


============================== 14:05:25.367730 | 36e6ca87-5ce2-4597-871a-bfd91e8052e5 ==============================
[0m14:05:25.367730 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.368479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.617556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cbc3bd40>]}
[0m14:05:25.678051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cbdd1d90>]}
[0m14:05:25.680774 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:25.720050 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:25.720852 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:25.721390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c4d14050>]}
[0m14:05:27.040013 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:27.040723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c4d14320>]}
[0m14:05:27.236096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:27.241834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c4df1400>]}
[0m14:05:27.390742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c48a5c10>]}
[0m14:05:27.391335 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:27.391851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c463d580>]}
[0m14:05:27.393731 [info ] [MainThread]: 
[0m14:05:27.394479 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:27.399579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:27.436305 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:27.436857 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:27.437292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:27.984719 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:27.986328 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:27.988578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:27.989163 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:27.997436 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.997876 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:27.998273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.004612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.006085 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.006489 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:28.007098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.007494 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.007870 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:28.008506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.009446 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.009852 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.010237 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.010780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.011190 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:28.013271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:28.019047 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.019466 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:28.019846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.025745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.026162 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.026560 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:28.048742 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.050412 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:28.051686 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:28.052103 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:28.056180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cd4a93a0>]}
[0m14:05:28.056751 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.057150 [debug] [MainThread]: On master: BEGIN
[0m14:05:28.057524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:28.064270 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.064819 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.065222 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.065602 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.066197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.066615 [debug] [MainThread]: On master: Close
[0m14:05:28.068211 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:28.068757 [info ] [MainThread]: 
[0m14:05:28.090297 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:28.090927 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:28.091586 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:28.092020 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:28.117913 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:28.118687 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:28.154387 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:28.155272 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:35.714840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.715408 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:35.716123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.716623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.717075 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:35.717874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.721049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.721513 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:35.722219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.743358 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:35.743891 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.744369 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:35.746550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.751806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.752319 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:35.753644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.756102 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:35.786089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cd45e540>]}
[0m14:05:35.786933 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.69s]
[0m14:05:35.787746 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:35.788794 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:35.789393 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:35.790003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:35.790457 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:35.795962 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:35.796695 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:35.831299 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.831891 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241112140535825255"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:35.832397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:35.846982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.854985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.855470 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:35.856106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.856591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.857030 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241112140535825255'
      
      
      order by ordinal_position

  
[0m14:05:35.878025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.884818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.885310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:35.888130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.896027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.896552 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:35.899483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.917583 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:35.918334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.918815 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241112140535825255"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241112140535825255"
    )
  
[0m14:05:35.952816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.954871 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:35.955339 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.955766 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:35.963960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.964939 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:36.030208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28d20a690>]}
[0m14:05:36.031069 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.24s]
[0m14:05:36.031865 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:36.033463 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:36.033953 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.034388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:36.041318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:36.041804 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.042241 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:36.042665 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.043261 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:36.043726 [debug] [MainThread]: On master: Close
[0m14:05:36.045377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:36.045820 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:36.046228 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:36.046698 [info ] [MainThread]: 
[0m14:05:36.047297 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m14:05:36.048495 [debug] [MainThread]: Command end result
[0m14:05:36.076875 [info ] [MainThread]: 
[0m14:05:36.077614 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:36.078211 [info ] [MainThread]: 
[0m14:05:36.078809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:36.079911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.764102, "process_user_time": 4.974925, "process_kernel_time": 0.334582, "process_mem_max_rss": "281804", "process_in_blocks": "3808", "process_out_blocks": "110128"}
[0m14:05:36.080597 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:36.080483 after 10.76 seconds
[0m14:05:36.081095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cc059bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28e1bab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c48dcce0>]}
[0m14:05:36.081582 [debug] [MainThread]: Flushing usage events
[0m14:05:37.972362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f153620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f5afc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f46c350>]}


============================== 14:05:37.975323 | c3f46b5d-b60a-466c-8873-45dd45c140fd ==============================
[0m14:05:37.975323 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:37.976051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:38.133359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f46b5d-b60a-466c-8873-45dd45c140fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f0a6cf0>]}
[0m14:05:38.150699 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22837326, "process_user_time": 1.51242, "process_kernel_time": 0.095773, "process_mem_max_rss": "92112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:38.151308 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:38.151203 after 0.23 seconds
[0m14:05:38.151771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f373da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9403a3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f318d70>]}
[0m14:05:38.152225 [debug] [MainThread]: Flushing usage events
[0m22:05:29.053427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f038b85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f038b8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f038b8140>]}


============================== 22:05:29.077950 | d5613411-2be5-4a47-9867-88acff4e89c4 ==============================
[0m22:05:29.077950 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:29.078681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:29.220489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5613411-2be5-4a47-9867-88acff4e89c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f039f38c0>]}
[0m22:05:29.234056 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-aby2bwmd'
[0m22:05:29.234512 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:29.286515 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:29.287148 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:29.301916 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:29.305826 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:29.371890 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:29.372496 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:29.373155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd5613411-2be5-4a47-9867-88acff4e89c4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f037147a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f0361c590>]}
[0m22:05:29.373627 [info ] [MainThread]: 
[0m22:05:29.374162 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:29.385576 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38109642, "process_user_time": 1.629056, "process_kernel_time": 0.076236, "process_mem_max_rss": "93564", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:05:29.386180 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:29.386075 after 0.38 seconds
[0m22:05:29.386626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f03e29c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f03a31880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f038babd0>]}
[0m22:05:29.387064 [debug] [MainThread]: Flushing usage events
[0m22:05:30.988003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2432b6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2436c1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2436c0950>]}


============================== 22:05:30.990870 | bbbdc3f1-4c2d-4442-83dc-a42160e1019a ==============================
[0m22:05:30.990870 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:30.991567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:31.220896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc242e0fb90>]}
[0m22:05:31.279788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc243680320>]}
[0m22:05:31.282205 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:31.311208 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:31.311960 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:31.312493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc242ba24b0>]}
[0m22:05:32.538229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:32.538909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc23b58f9e0>]}
[0m22:05:32.718698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:32.723989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc23ba5e8a0>]}
[0m22:05:32.874068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc23b40a480>]}
[0m22:05:32.874643 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:32.875148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc242bbc590>]}
[0m22:05:32.876941 [info ] [MainThread]: 
[0m22:05:32.877681 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:32.882631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:32.918972 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:32.919465 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:32.919893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:33.449648 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:33.451169 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:33.453227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:33.453786 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:33.461706 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.462142 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:33.462533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.468860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.470305 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.470712 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:33.471247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.471642 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.472056 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:33.472622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.473525 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.473936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.474306 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.474844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.475251 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:33.477654 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro_main'
[0m22:05:33.483567 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.484027 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:33.484405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:33.492034 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.492452 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.492848 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:33.518269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.519839 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:33.521067 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:33.521483 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:33.525200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2452abad0>]}
[0m22:05:33.525731 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.526120 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.526504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:33.533580 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.534016 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.534411 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.534793 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.535374 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.535816 [debug] [MainThread]: On master: Close
[0m22:05:33.537486 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:33.537972 [info ] [MainThread]: 
[0m22:05:33.552794 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:33.553410 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:33.553999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_petro_main, now model.petro.stg_petro)
[0m22:05:33.554459 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:33.580434 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:33.581194 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:33.616989 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:33.617770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:41.257043 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.257570 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:41.258264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.258730 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.259172 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:41.259914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.262797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.263255 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:41.263965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.284738 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:41.285217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.285658 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:41.287258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.292191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.292667 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:41.294980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.297325 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:41.326546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc24425a840>]}
[0m22:05:41.327271 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.77s]
[0m22:05:41.328101 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:41.329078 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:41.329645 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:41.330231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:41.330722 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:41.335893 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:41.336553 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:41.370127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.370640 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241112220541364268"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:41.371115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:41.385308 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.392766 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.393237 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:41.393844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.394299 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.394742 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241112220541364268'
      
      
      order by ordinal_position

  
[0m22:05:41.415898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.422113 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.422615 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:41.425369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.432871 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.433350 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:41.436364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.454236 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:41.454950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.455431 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241112220541364268"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241112220541364268"
    )
  
[0m22:05:41.489097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.491116 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:41.491577 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.492035 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:41.499848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.500742 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:41.570581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f3fdfd70>]}
[0m22:05:41.571382 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.24s]
[0m22:05:41.572164 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:41.573452 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.573927 [debug] [MainThread]: On master: BEGIN
[0m22:05:41.574362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:41.581027 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.581516 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.581958 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.582392 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.582976 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.583429 [debug] [MainThread]: On master: Close
[0m22:05:41.584993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:41.585453 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:41.585899 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:41.586357 [info ] [MainThread]: 
[0m22:05:41.586952 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m22:05:41.588112 [debug] [MainThread]: Command end result
[0m22:05:41.615597 [info ] [MainThread]: 
[0m22:05:41.616298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:41.616889 [info ] [MainThread]: 
[0m22:05:41.617491 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:41.618558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.680231, "process_user_time": 4.768944, "process_kernel_time": 0.312323, "process_mem_max_rss": "274720", "process_in_blocks": "3808", "process_out_blocks": "110160"}
[0m22:05:41.619197 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:41.619089 after 10.68 seconds
[0m22:05:41.619686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2432b6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc242a0ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc23b510cb0>]}
[0m22:05:41.620234 [debug] [MainThread]: Flushing usage events
[0m22:05:43.264912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb285dcdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2860b0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb285dccc50>]}


============================== 22:05:43.267666 | 6d1f809d-bfbe-41e4-87a5-1a33043299bb ==============================
[0m22:05:43.267666 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:43.268426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:43.412796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d1f809d-bfbe-41e4-87a5-1a33043299bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb285229f10>]}
[0m22:05:43.429827 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21292807, "process_user_time": 1.390445, "process_kernel_time": 0.124218, "process_mem_max_rss": "92056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:43.430416 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:43.430312 after 0.21 seconds
[0m22:05:43.430858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28554e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2858c1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28532f0e0>]}
[0m22:05:43.431288 [debug] [MainThread]: Flushing usage events
[0m06:02:07.457542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144cf15d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144d6ce510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144d6cce30>]}


============================== 06:02:07.465259 | 302df935-0ca9-4e1a-af82-87eab44f7488 ==============================
[0m06:02:07.465259 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.465910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.607230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '302df935-0ca9-4e1a-af82-87eab44f7488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144cd76600>]}
[0m06:02:07.621143 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6ahpvji3'
[0m06:02:07.621618 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.726890 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.727616 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.791416 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.795440 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.945989 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.946603 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:07.947130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '302df935-0ca9-4e1a-af82-87eab44f7488', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144ccfbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144cd3fad0>]}
[0m06:02:07.947602 [info ] [MainThread]: 
[0m06:02:07.948062 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:07.977136 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5683222, "process_user_time": 1.595437, "process_kernel_time": 0.120259, "process_mem_max_rss": "93564", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:07.977787 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.977682 after 0.57 seconds
[0m06:02:07.978286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144dfa53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144de500e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144f27dcd0>]}
[0m06:02:07.978727 [debug] [MainThread]: Flushing usage events
[0m06:02:09.646859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda16fcb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda2615370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda16fef30>]}


============================== 06:02:09.649747 | dac827e8-8482-448a-b1b5-6f922fdbd0db ==============================
[0m06:02:09.649747 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.650447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.890265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda0b7b650>]}
[0m06:02:09.950575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda0bbb890>]}
[0m06:02:09.953228 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:09.969095 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.969828 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.970389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda119b8f0>]}
[0m06:02:11.216154 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.216814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd999e3d40>]}
[0m06:02:11.400076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.405255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd999e3560>]}
[0m06:02:11.571645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd999f27b0>]}
[0m06:02:11.572243 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:11.572780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9948f710>]}
[0m06:02:11.574538 [info ] [MainThread]: 
[0m06:02:11.575258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.580226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.616718 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.617205 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.617620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.072373 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.073990 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.076429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.077031 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.086218 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.086671 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.087072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.093686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.095282 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.095697 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.096260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.096676 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.097063 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.097643 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.098603 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.099013 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.099405 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.100006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.100423 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.102488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.108460 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.108907 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.109296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.115543 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.116029 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.116439 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.140252 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.141864 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.143159 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.143579 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.147159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda22a50d0>]}
[0m06:02:12.147697 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.148098 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.148628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.155553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.156009 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.156408 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.156789 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.157384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.157804 [debug] [MainThread]: On master: Close
[0m06:02:12.159402 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.159916 [info ] [MainThread]: 
[0m06:02:12.169923 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.170592 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.171281 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:12.171731 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.198306 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.199077 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.235251 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.236046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:19.574322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.574852 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:19.575564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.576022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.576458 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:19.577198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.580176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.580638 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:19.581367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.602556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.603053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.603501 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.605883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.610911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.611383 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:19.613112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.615477 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:19.646373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda225a450>]}
[0m06:02:19.647210 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.47s]
[0m06:02:19.648097 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:19.649102 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:19.649674 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:19.650387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:19.650861 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:19.656304 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:19.656974 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:19.691206 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.691733 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241113060219685142"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:19.692228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:19.707469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.715762 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.716321 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:19.717011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.717465 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.717907 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241113060219685142'
      
      
      order by ordinal_position

  
[0m06:02:19.739228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.745710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.746231 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.749397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.757072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.757558 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.760385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.778667 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:19.779375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.779853 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241113060219685142"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241113060219685142"
    )
  
[0m06:02:19.813939 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.816035 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.816512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.816950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.825280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.826259 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.909254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd560ae270>]}
[0m06:02:19.910072 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m06:02:19.910966 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.912463 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.912941 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.913376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.920203 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.920694 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.921141 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.921568 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.922226 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.922688 [debug] [MainThread]: On master: Close
[0m06:02:19.924208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.924660 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.925075 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.925541 [info ] [MainThread]: 
[0m06:02:19.926187 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.35 seconds (8.35s).
[0m06:02:19.927323 [debug] [MainThread]: Command end result
[0m06:02:19.955587 [info ] [MainThread]: 
[0m06:02:19.956320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.956920 [info ] [MainThread]: 
[0m06:02:19.957530 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.958675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.360856, "process_user_time": 5.429172, "process_kernel_time": 0.322643, "process_mem_max_rss": "285428", "process_in_blocks": "3808", "process_out_blocks": "110648"}
[0m06:02:19.959358 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.959244 after 10.36 seconds
[0m06:02:19.959871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda1c79bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9948f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd55f40140>]}
[0m06:02:19.960367 [debug] [MainThread]: Flushing usage events
[0m06:02:21.671384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7e989fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7e989c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7e989f40>]}


============================== 06:02:21.674260 | 27d491af-2252-43c5-9daf-41b970f212df ==============================
[0m06:02:21.674260 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.674919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.818745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27d491af-2252-43c5-9daf-41b970f212df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7de04470>]}
[0m06:02:21.835395 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21288227, "process_user_time": 1.416838, "process_kernel_time": 0.100059, "process_mem_max_rss": "92236", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:21.836003 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:21.835898 after 0.21 seconds
[0m06:02:21.836444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7e989eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf819bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7ef11e80>]}
[0m06:02:21.836874 [debug] [MainThread]: Flushing usage events
[0m14:05:09.603496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105ab84170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105ab852e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105ab84200>]}


============================== 14:05:09.654146 | 5f2d7208-f902-42e5-a889-9302e33ebf6b ==============================
[0m14:05:09.654146 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:09.654845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:09.793883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f2d7208-f902-42e5-a889-9302e33ebf6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105abf4650>]}
[0m14:05:09.807694 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g557xvbp'
[0m14:05:09.808167 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:09.894990 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:09.895650 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:09.917198 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:09.921084 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:09.989992 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:09.990623 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:09.991207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5f2d7208-f902-42e5-a889-9302e33ebf6b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105abdc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105bc29eb0>]}
[0m14:05:09.991672 [info ] [MainThread]: 
[0m14:05:09.992132 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:10.011590 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45677763, "process_user_time": 1.620101, "process_kernel_time": 0.104782, "process_mem_max_rss": "93588", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m14:05:10.012249 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:10.012141 after 0.46 seconds
[0m14:05:10.012718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105b5295b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105c2219d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105aba77a0>]}
[0m14:05:10.013168 [debug] [MainThread]: Flushing usage events
[0m14:05:11.598280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4706f6d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470660a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4706609e80>]}


============================== 14:05:11.601170 | 3b5ed487-b290-41e1-a1d8-2cdf9533b057 ==============================
[0m14:05:11.601170 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:11.601831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:11.840277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4707b2b4d0>]}
[0m14:05:11.900192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4707388c20>]}
[0m14:05:11.902929 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:11.918884 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:11.919659 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:11.920187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46ff447b90>]}
[0m14:05:13.148265 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:13.148946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fef87e30>]}
[0m14:05:13.331340 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:13.336707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fefb6a50>]}
[0m14:05:13.524304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fefa1670>]}
[0m14:05:13.524906 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:13.525413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fee98c20>]}
[0m14:05:13.527170 [info ] [MainThread]: 
[0m14:05:13.527899 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:13.532731 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:13.568727 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:13.569235 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:13.569651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.270880 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.272469 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.274715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.275273 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.283867 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.284298 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:14.284722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.291197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.292751 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.293152 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:14.293766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.294163 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.294537 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:14.295114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.296026 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.296432 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.296863 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.297401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.297811 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:14.299786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:14.305614 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.306027 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:14.306397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.312413 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.312862 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.313258 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:14.336562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.338156 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:14.339387 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:14.339790 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:14.343256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4707b71490>]}
[0m14:05:14.343772 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.344176 [debug] [MainThread]: On master: BEGIN
[0m14:05:14.344549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:14.351005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.351440 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.351831 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.352203 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.352755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.353161 [debug] [MainThread]: On master: Close
[0m14:05:14.354621 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:14.355156 [info ] [MainThread]: 
[0m14:05:14.365087 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:14.365698 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:14.366438 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:14.366877 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:14.392641 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:14.393426 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:14.428821 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:14.429598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:21.250746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.251268 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:21.251923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.252379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.252836 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:21.253542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.256469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.256953 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:21.257643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.278259 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:21.278734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.279168 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:21.280988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.285936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.286405 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:21.287573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.289937 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:21.318928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d7f0aa80>]}
[0m14:05:21.319660 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.95s]
[0m14:05:21.320526 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:21.321633 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:21.322202 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:21.322893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:21.323349 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:21.328624 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:21.329289 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:21.363105 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.363645 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241113140521357100"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:21.364118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:21.379517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.387367 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.387840 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:21.388458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.388924 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.389359 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241113140521357100'
      
      
      order by ordinal_position

  
[0m14:05:21.411592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.418535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.419035 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.422030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.429525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.430002 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.432795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.450580 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:21.451273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.451741 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241113140521357100"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241113140521357100"
    )
  
[0m14:05:21.484894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.486897 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.487360 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.487780 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.495876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.496800 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:21.586147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bf2409e0>]}
[0m14:05:21.586993 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m14:05:21.587742 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:21.589317 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.589793 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.590223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:21.596934 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.597527 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.597986 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.598408 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.599037 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.599493 [debug] [MainThread]: On master: Close
[0m14:05:21.601298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.601734 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:21.602135 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:21.602595 [info ] [MainThread]: 
[0m14:05:21.603145 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m14:05:21.604195 [debug] [MainThread]: Command end result
[0m14:05:21.634074 [info ] [MainThread]: 
[0m14:05:21.634976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:21.635561 [info ] [MainThread]: 
[0m14:05:21.636104 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:21.637155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.088455, "process_user_time": 5.652616, "process_kernel_time": 0.293277, "process_mem_max_rss": "296936", "process_in_blocks": "3808", "process_out_blocks": "111152"}
[0m14:05:21.637796 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:21.637687 after 10.09 seconds
[0m14:05:21.638295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470754b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bf75b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4706a68170>]}
[0m14:05:21.638783 [debug] [MainThread]: Flushing usage events
[0m14:05:23.317717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a85c3c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a86b45c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a8603b530>]}


============================== 14:05:23.320520 | caf68d7a-b156-40af-8a60-0f6ae856c7ff ==============================
[0m14:05:23.320520 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.321187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.461480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caf68d7a-b156-40af-8a60-0f6ae856c7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a85d0e360>]}
[0m14:05:23.478375 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2087948, "process_user_time": 1.405301, "process_kernel_time": 0.111785, "process_mem_max_rss": "92168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:23.478956 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:23.478853 after 0.21 seconds
[0m14:05:23.479394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a863b3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a85a4ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a85d0e360>]}
[0m14:05:23.479820 [debug] [MainThread]: Flushing usage events
[0m22:05:28.963895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770b88470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770650f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770667050>]}


============================== 22:05:28.979120 | 06fb6858-7662-4cc0-81df-d637162b40dd ==============================
[0m22:05:28.979120 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:28.979795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:29.118653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06fb6858-7662-4cc0-81df-d637162b40dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770a8a630>]}
[0m22:05:29.131977 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mgdrfgn5'
[0m22:05:29.132447 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:29.196493 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:29.197135 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:29.222848 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:29.226684 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:29.297166 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:29.297679 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:29.298199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '06fb6858-7662-4cc0-81df-d637162b40dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37702ed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770370b60>]}
[0m22:05:29.298660 [info ] [MainThread]: 
[0m22:05:29.299136 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:29.304905 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38960716, "process_user_time": 1.628909, "process_kernel_time": 0.099323, "process_mem_max_rss": "93652", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:29.305498 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:29.305393 after 0.39 seconds
[0m22:05:29.305931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770667050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37708c2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377161b380>]}
[0m22:05:29.306357 [debug] [MainThread]: Flushing usage events
[0m22:05:30.890595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792edd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792a50e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792a52180>]}


============================== 22:05:30.893427 | 436822b1-7665-4cd8-b81d-e898cd04780c ==============================
[0m22:05:30.893427 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:30.894097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:31.124749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37929057c0>]}
[0m22:05:31.183958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37928c0320>]}
[0m22:05:31.186434 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:31.225339 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:31.226051 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:31.226587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37928900e0>]}
[0m22:05:32.454828 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:32.455484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3793f9a630>]}
[0m22:05:32.636374 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:32.641493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378b739100>]}
[0m22:05:32.797354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378b3bbb90>]}
[0m22:05:32.797922 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:32.798414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378b19f560>]}
[0m22:05:32.800140 [info ] [MainThread]: 
[0m22:05:32.800839 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:32.805703 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:32.841474 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:32.841923 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:32.842316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:33.209023 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.210553 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:33.212763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:33.213331 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:33.221843 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.222280 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:33.222677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.228940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.230439 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.230854 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:33.231406 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.231842 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.232232 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:33.232800 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.233731 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.234132 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.234511 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.235051 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.235462 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:33.237440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:33.243144 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.243589 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:33.243983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.249896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.250323 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.250724 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:33.276081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.277705 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:33.278963 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:33.279381 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:33.283008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3789fb2360>]}
[0m22:05:33.283589 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.284008 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.284387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:33.290910 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.291341 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.291786 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.292175 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.292718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.293128 [debug] [MainThread]: On master: Close
[0m22:05:33.294797 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:33.295325 [info ] [MainThread]: 
[0m22:05:33.305669 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:33.306356 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:33.307015 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:33.307465 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:33.333502 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:33.334295 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:33.369851 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:33.370624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:39.901458 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.901967 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:39.902619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.903076 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.903513 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:39.904245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.907082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.907538 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:39.908256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.929108 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:39.929597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.930041 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:39.932164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.937129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.937606 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:39.938796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.941142 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:39.970437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3794f659a0>]}
[0m22:05:39.971193 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.66s]
[0m22:05:39.972004 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:39.972996 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:39.973561 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:39.974139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:39.974599 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:39.979794 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:39.980450 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:40.014245 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.014767 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241113220540008356"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:40.015248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:40.029636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.037004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.037472 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:40.038060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.038525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.038968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241113220540008356'
      
      
      order by ordinal_position

  
[0m22:05:40.061006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.067108 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.067618 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:40.070812 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.078333 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.078816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:40.081832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.099661 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:40.100340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.100816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241113220540008356"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241113220540008356"
    )
  
[0m22:05:40.136418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.138409 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:40.138874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.139302 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:40.147676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.148557 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:40.233427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374bfe0530>]}
[0m22:05:40.234190 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m22:05:40.234929 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:40.236391 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.236868 [debug] [MainThread]: On master: BEGIN
[0m22:05:40.237302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:40.244035 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.244522 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.244962 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.245391 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.245978 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.246441 [debug] [MainThread]: On master: Close
[0m22:05:40.248002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:40.248448 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:40.248860 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:40.249326 [info ] [MainThread]: 
[0m22:05:40.249880 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m22:05:40.250914 [debug] [MainThread]: Command end result
[0m22:05:40.278399 [info ] [MainThread]: 
[0m22:05:40.279039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:40.279595 [info ] [MainThread]: 
[0m22:05:40.280149 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:40.281157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.442213, "process_user_time": 5.206948, "process_kernel_time": 0.363368, "process_mem_max_rss": "293184", "process_in_blocks": "3808", "process_out_blocks": "111184"}
[0m22:05:40.281803 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:40.281693 after 9.44 seconds
[0m22:05:40.282294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3794e0a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792ab1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792f08bf0>]}
[0m22:05:40.282780 [debug] [MainThread]: Flushing usage events
[0m22:05:41.944825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1752f05e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1752683650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1752eab920>]}


============================== 22:05:41.947662 | e1ab6e5c-0a3f-4aca-b480-b2f8444d8216 ==============================
[0m22:05:41.947662 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:41.948407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.090445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1ab6e5c-0a3f-4aca-b480-b2f8444d8216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17525d6e70>]}
[0m22:05:42.107305 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21326675, "process_user_time": 1.445142, "process_kernel_time": 0.120094, "process_mem_max_rss": "92168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:42.107992 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:42.107849 after 0.21 seconds
[0m22:05:42.108547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1752683650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1753a0dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175253b290>]}
[0m22:05:42.108993 [debug] [MainThread]: Flushing usage events
[0m06:02:26.320203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067da77740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dd8e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dd8e240>]}


============================== 06:02:26.327545 | eeccea30-b464-4457-90e3-5f9ef9ada99b ==============================
[0m06:02:26.327545 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.328305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.466966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eeccea30-b464-4457-90e3-5f9ef9ada99b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dadfb90>]}
[0m06:02:26.480285 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qx4j1dn6'
[0m06:02:26.480748 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:26.515963 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:26.516563 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:26.528538 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:26.532415 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:27.001173 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:27.001785 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:27.002394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'eeccea30-b464-4457-90e3-5f9ef9ada99b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067d75d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067d606210>]}
[0m06:02:27.002856 [info ] [MainThread]: 
[0m06:02:27.003364 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:27.025914 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.75383484, "process_user_time": 1.576191, "process_kernel_time": 0.135672, "process_mem_max_rss": "93756", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:27.026512 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:27.026409 after 0.75 seconds
[0m06:02:27.026948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067e490a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dea04a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dea1880>]}
[0m06:02:27.027386 [debug] [MainThread]: Flushing usage events
[0m06:02:28.806974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f8782e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f8b72300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f8b70fb0>]}


============================== 06:02:28.809859 | 9229ab49-a5b9-412a-9e78-551204169ba6 ==============================
[0m06:02:28.809859 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:28.810583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.045768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9753140>]}
[0m06:02:29.105367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f957a7e0>]}
[0m06:02:29.107992 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:29.153318 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:29.154081 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:29.154625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f1007b90>]}
[0m06:02:30.383892 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:30.384556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0b4ac90>]}
[0m06:02:30.567534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:30.572786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0be3260>]}
[0m06:02:30.716078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f095c770>]}
[0m06:02:30.716628 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:30.717198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0a0d250>]}
[0m06:02:30.718909 [info ] [MainThread]: 
[0m06:02:30.719634 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:30.724623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:30.760215 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:30.760665 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:30.761089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:31.452863 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:31.454429 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:31.456506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:31.457097 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:31.465623 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.466051 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:31.466440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.472610 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.474109 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.474507 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:31.475081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.475474 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.475853 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:31.476463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.477427 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.477836 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.478235 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.478772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.479184 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:31.481097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:31.486745 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.487160 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:31.487538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.493341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.493757 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.494152 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:31.516851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.518462 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:31.519714 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:31.520130 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:31.523731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f093e4b0>]}
[0m06:02:31.524259 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.524655 [debug] [MainThread]: On master: BEGIN
[0m06:02:31.525068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:31.531387 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.531818 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.532205 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.532581 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.533142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.533555 [debug] [MainThread]: On master: Close
[0m06:02:31.534896 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:31.535422 [info ] [MainThread]: 
[0m06:02:31.562498 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:31.563097 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:31.563844 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:31.564288 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:31.590274 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:31.591014 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:31.626572 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:31.627300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:45.890641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.891184 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:45.891910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.892386 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.892823 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:45.893675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.896560 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.897073 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:45.897767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.918737 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:45.919217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.919655 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:45.921933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.926860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.927335 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:45.928537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.930870 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:45.960540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f093f620>]}
[0m06:02:45.961315 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.40s]
[0m06:02:45.962092 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:45.963051 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:45.963611 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:45.964218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:45.964675 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:45.969840 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:45.970492 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:46.004055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.004572 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241114060245998198"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:46.005071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:46.020052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.027667 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.028138 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:46.028745 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.029223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.029672 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241114060245998198'
      
      
      order by ordinal_position

  
[0m06:02:46.052418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.058786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.059266 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:46.062352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.069948 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.070434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:46.073193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.091313 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:46.092028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.092499 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241114060245998198"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241114060245998198"
    )
  
[0m06:02:46.125246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.127246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:46.127699 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.128119 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:46.136684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.137595 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:46.229566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b11e0f50>]}
[0m06:02:46.230327 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.27s]
[0m06:02:46.231196 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:46.232684 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:46.233200 [debug] [MainThread]: On master: BEGIN
[0m06:02:46.233639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:46.240779 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:46.241297 [debug] [MainThread]: On master: COMMIT
[0m06:02:46.241733 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:46.242158 [debug] [MainThread]: On master: COMMIT
[0m06:02:46.242744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:46.243209 [debug] [MainThread]: On master: Close
[0m06:02:46.244694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:46.245211 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:46.245624 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:46.246126 [info ] [MainThread]: 
[0m06:02:46.246722 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.53 seconds (15.53s).
[0m06:02:46.247843 [debug] [MainThread]: Command end result
[0m06:02:46.275724 [info ] [MainThread]: 
[0m06:02:46.276421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:46.277035 [info ] [MainThread]: 
[0m06:02:46.277637 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:46.278704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.520178, "process_user_time": 5.584928, "process_kernel_time": 0.289916, "process_mem_max_rss": "297056", "process_in_blocks": "3808", "process_out_blocks": "111168"}
[0m06:02:46.279343 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:46.279234 after 17.52 seconds
[0m06:02:46.279832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8fbbbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f8253770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c00caab0>]}
[0m06:02:46.280313 [debug] [MainThread]: Flushing usage events
[0m06:02:48.176332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda10e6df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda105f2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda1050e1b0>]}


============================== 06:02:48.179033 | 09883b42-763f-4889-8785-27d9d1af4529 ==============================
[0m06:02:48.179033 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:48.179683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:48.315980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09883b42-763f-4889-8785-27d9d1af4529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda11a2b0b0>]}
[0m06:02:48.332425 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20411718, "process_user_time": 1.401532, "process_kernel_time": 0.087845, "process_mem_max_rss": "92244", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:48.333059 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:48.332952 after 0.20 seconds
[0m06:02:48.333490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda113fbef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda113f9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda10372db0>]}
[0m06:02:48.333928 [debug] [MainThread]: Flushing usage events
[0m14:05:23.857426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed38ef650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed3b3ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed3505070>]}


============================== 14:05:23.908842 | d1246452-b161-46af-9100-1d2a52f41138 ==============================
[0m14:05:23.908842 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.909577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.049153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1246452-b161-46af-9100-1d2a52f41138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed452d0d0>]}
[0m14:05:24.062450 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jp0zysu6'
[0m14:05:24.062889 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:24.131553 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:24.132289 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:24.164362 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:24.168467 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:24.550471 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:24.551057 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:24.551652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd1246452-b161-46af-9100-1d2a52f41138', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed2ebf650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed2ebf620>]}
[0m14:05:24.552103 [info ] [MainThread]: 
[0m14:05:24.552654 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:24.577734 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.76840174, "process_user_time": 1.53829, "process_kernel_time": 0.136202, "process_mem_max_rss": "93140", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m14:05:24.578447 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:24.578320 after 0.77 seconds
[0m14:05:24.578948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed3a72330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed38ed730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed441bc20>]}
[0m14:05:24.579393 [debug] [MainThread]: Flushing usage events
[0m14:05:26.327028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e3bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e3b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e39760>]}


============================== 14:05:26.329744 | c22ac58d-29b0-4797-85a1-84f250a5e56a ==============================
[0m14:05:26.329744 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.330449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.559816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc484d130>]}
[0m14:05:26.618789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc5758320>]}
[0m14:05:26.621340 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:26.637322 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:26.638079 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:26.638621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd9a4da0>]}
[0m14:05:27.848288 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:27.849094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd21f9e0>]}
[0m14:05:28.027486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:28.032490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd7cc110>]}
[0m14:05:28.166808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd39f3b0>]}
[0m14:05:28.167337 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:28.167804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd134e00>]}
[0m14:05:28.169449 [info ] [MainThread]: 
[0m14:05:28.170112 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:28.174676 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:28.209535 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:28.209974 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:28.210371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:28.804918 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:28.806453 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:28.808429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:28.808990 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:28.815988 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.816466 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:28.816864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.823382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.824834 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.825237 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:28.825826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.826220 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.826592 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:28.827154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.828054 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.828495 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.828881 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.829425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.829834 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:28.831753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:28.837565 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.837978 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:28.838350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.844078 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.844520 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.844930 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:28.868287 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.869737 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:28.870939 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:28.871341 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:28.874533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb7f85790>]}
[0m14:05:28.875034 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.875423 [debug] [MainThread]: On master: BEGIN
[0m14:05:28.875793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:28.882066 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.882486 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.882874 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.883250 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.883782 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.884180 [debug] [MainThread]: On master: Close
[0m14:05:28.885493 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:28.885985 [info ] [MainThread]: 
[0m14:05:28.895451 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:28.896038 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:28.896707 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:28.897143 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:28.922669 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:28.923427 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:28.958642 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:28.959392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:40.609967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.610745 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:40.611628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.612276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.612947 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:40.613896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.617306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.617770 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:40.618550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.639230 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:40.639706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.640143 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:40.641393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.646334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.646799 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:40.648127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.650499 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:40.680894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd8b2000>]}
[0m14:05:40.681609 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.78s]
[0m14:05:40.682487 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:40.683471 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:40.684023 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:40.684713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:40.685170 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:40.690116 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:40.690757 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:40.724178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.724715 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241114140540718343"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:40.725183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:40.739483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.746895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.747358 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:40.747951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.748420 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.748864 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241114140540718343'
      
      
      order by ordinal_position

  
[0m14:05:40.769825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.776449 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.776939 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:40.780083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.787669 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.788147 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:40.791848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.809939 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:40.810635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.811105 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241114140540718343"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241114140540718343"
    )
  
[0m14:05:40.848840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.850771 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:40.851222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.851643 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:40.860131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.861032 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:40.958059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7d41c080>]}
[0m14:05:40.958812 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.27s]
[0m14:05:40.959665 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:40.961005 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:40.961483 [debug] [MainThread]: On master: BEGIN
[0m14:05:40.961913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:40.969046 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:40.969522 [debug] [MainThread]: On master: COMMIT
[0m14:05:40.969955 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:40.970378 [debug] [MainThread]: On master: COMMIT
[0m14:05:40.971008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:40.971458 [debug] [MainThread]: On master: Close
[0m14:05:40.972788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:40.973223 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:40.973620 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:40.974082 [info ] [MainThread]: 
[0m14:05:40.974669 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.80 seconds (12.80s).
[0m14:05:40.975772 [debug] [MainThread]: Command end result
[0m14:05:41.003565 [info ] [MainThread]: 
[0m14:05:41.004199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:41.004751 [info ] [MainThread]: 
[0m14:05:41.005294 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:41.006294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.726929, "process_user_time": 5.437077, "process_kernel_time": 0.319124, "process_mem_max_rss": "288776", "process_in_blocks": "3808", "process_out_blocks": "111136"}
[0m14:05:41.006926 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:41.006818 after 14.73 seconds
[0m14:05:41.007421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc83bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e39760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e3b470>]}
[0m14:05:41.007904 [debug] [MainThread]: Flushing usage events
[0m14:05:42.828539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c62470b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c6621640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c6247140>]}


============================== 14:05:42.831537 | e2f14679-947f-4f61-a4ed-6c7bd3acb322 ==============================
[0m14:05:42.831537 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:42.832434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:42.991423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2f14679-947f-4f61-a4ed-6c7bd3acb322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c7333590>]}
[0m14:05:43.007694 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2312623, "process_user_time": 1.385493, "process_kernel_time": 0.127768, "process_mem_max_rss": "92260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:43.008269 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:43.008167 after 0.23 seconds
[0m14:05:43.008776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c8152150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5c7bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c7333590>]}
[0m14:05:43.009203 [debug] [MainThread]: Flushing usage events
[0m22:05:42.160283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896cf6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c619640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896cf6a510>]}


============================== 22:05:42.167561 | cc84d3b7-d48e-43f8-926c-d182b827779a ==============================
[0m22:05:42.167561 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.168302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.308900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc84d3b7-d48e-43f8-926c-d182b827779a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c62fec0>]}
[0m22:05:42.322180 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ykaput48'
[0m22:05:42.322625 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:42.360757 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:42.361351 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:42.372349 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:42.376144 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:42.847346 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:42.847954 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:42.848581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc84d3b7-d48e-43f8-926c-d182b827779a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c364980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c660650>]}
[0m22:05:42.849055 [info ] [MainThread]: 
[0m22:05:42.849576 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:42.851062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73878896, "process_user_time": 1.570198, "process_kernel_time": 0.147081, "process_mem_max_rss": "93460", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:42.851705 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:42.851600 after 0.74 seconds
[0m22:05:42.852138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896cf6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c62fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c663800>]}
[0m22:05:42.852557 [debug] [MainThread]: Flushing usage events
[0m22:05:44.622145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcdec1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd55a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd65a5a0>]}


============================== 22:05:44.624946 | 859f9dc2-dd56-41ef-99e6-fb67096186f1 ==============================
[0m22:05:44.624946 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.625665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.858649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcdec1bb0>]}
[0m22:05:44.917604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd20e960>]}
[0m22:05:44.920131 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:44.935595 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:44.936303 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:44.936834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd20fdd0>]}
[0m22:05:46.159242 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:46.159935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc61d03e0>]}
[0m22:05:46.340990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:46.346053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5c44b30>]}
[0m22:05:46.487701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5c458e0>]}
[0m22:05:46.488256 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:46.488727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5c952e0>]}
[0m22:05:46.490408 [info ] [MainThread]: 
[0m22:05:46.491102 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:46.495989 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:46.532145 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:46.532627 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:46.533033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:47.066412 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:47.068094 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:47.070282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:47.070893 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:47.078293 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.078736 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:47.079144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:47.085713 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.087216 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.087674 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:47.088286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.088692 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.089076 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:47.089650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.090595 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:47.091011 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.091446 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:47.092026 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.092446 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:47.094652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:47.100483 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:47.100898 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:47.101283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:47.107131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.107588 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:47.107985 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:47.132084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.133704 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:47.134967 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:47.135427 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:47.138872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5cdb0b0>]}
[0m22:05:47.139456 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:47.139858 [debug] [MainThread]: On master: BEGIN
[0m22:05:47.140231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:47.147183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:47.147641 [debug] [MainThread]: On master: COMMIT
[0m22:05:47.148030 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:47.148402 [debug] [MainThread]: On master: COMMIT
[0m22:05:47.148923 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:47.149322 [debug] [MainThread]: On master: Close
[0m22:05:47.150948 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:47.151494 [info ] [MainThread]: 
[0m22:05:47.161104 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:47.161714 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:47.162386 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:47.162822 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:47.189329 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:47.190202 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:47.225951 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:47.226719 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:56.838158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.838682 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:56.839373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.839827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.840257 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:56.841006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.844081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.844540 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:56.845222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.866127 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:56.866615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.867054 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:56.868553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.873508 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.873972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:56.875139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.877493 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:56.906995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcea5e330>]}
[0m22:05:56.907786 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.74s]
[0m22:05:56.908669 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:56.909648 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:56.910205 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:56.910876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:56.911362 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:56.916679 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:56.917342 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:56.950907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:56.951453 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241114220556945028"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:56.951937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:56.967039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.974665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:56.975135 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:56.975781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.976222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:56.976650 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241114220556945028'
      
      
      order by ordinal_position

  
[0m22:05:57.007908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.014222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:57.014702 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:57.017926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.025433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:57.025910 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:57.030219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.048173 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:57.048872 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:57.049339 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241114220556945028"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241114220556945028"
    )
  
[0m22:05:57.083464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.085495 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:57.085977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:57.086437 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:57.095141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.096108 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:57.198841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b865f8260>]}
[0m22:05:57.199722 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m22:05:57.200613 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:57.202148 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.202639 [debug] [MainThread]: On master: BEGIN
[0m22:05:57.203072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:57.210034 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.210510 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.210943 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.211410 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.211997 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.212461 [debug] [MainThread]: On master: Close
[0m22:05:57.214169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:57.214605 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:57.215017 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:57.215539 [info ] [MainThread]: 
[0m22:05:57.216077 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m22:05:57.217081 [debug] [MainThread]: Command end result
[0m22:05:57.246268 [info ] [MainThread]: 
[0m22:05:57.246954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:57.247510 [info ] [MainThread]: 
[0m22:05:57.248034 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:57.249081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.675212, "process_user_time": 5.512611, "process_kernel_time": 0.27603, "process_mem_max_rss": "286444", "process_in_blocks": "3808", "process_out_blocks": "111680"}
[0m22:05:57.249750 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:57.249639 after 12.68 seconds
[0m22:05:57.250253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd98baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5d2ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc61e67e0>]}
[0m22:05:57.250741 [debug] [MainThread]: Flushing usage events
[0m22:05:59.175875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d852e7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d859eae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d866f1c70>]}


============================== 22:05:59.178780 | a94fdfd2-a106-4937-a791-20ecb0ca3767 ==============================
[0m22:05:59.178780 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:59.179492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:59.322309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a94fdfd2-a106-4937-a791-20ecb0ca3767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d85701e50>]}
[0m22:05:59.338566 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2116017, "process_user_time": 1.411667, "process_kernel_time": 0.10427, "process_mem_max_rss": "92060", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:59.339146 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:59.339038 after 0.21 seconds
[0m22:05:59.339633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d852e7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d86263200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d870f9f40>]}
[0m22:05:59.340051 [debug] [MainThread]: Flushing usage events
[0m06:02:09.966997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7844320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7a82f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe78440b0>]}


============================== 06:02:10.034873 | e85f4b51-7b5d-4dcf-893d-978d9b76871b ==============================
[0m06:02:10.034873 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.035547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.171708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e85f4b51-7b5d-4dcf-893d-978d9b76871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7bb1640>]}
[0m06:02:10.184898 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-aji4bxr7'
[0m06:02:10.185340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.321809 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.322484 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.355687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.359597 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.744814 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.745446 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:10.746058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e85f4b51-7b5d-4dcf-893d-978d9b76871b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7a35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe8932db0>]}
[0m06:02:10.746535 [info ] [MainThread]: 
[0m06:02:10.747085 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:10.783397 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8642106, "process_user_time": 1.576648, "process_kernel_time": 0.099035, "process_mem_max_rss": "93516", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:10.784006 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.783899 after 0.86 seconds
[0m06:02:10.784462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7a37ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7a35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7e1d430>]}
[0m06:02:10.784897 [debug] [MainThread]: Flushing usage events
[0m06:02:12.517769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b73032c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b68671a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b7506d20>]}


============================== 06:02:12.520610 | 4754fd98-e186-4bb7-b08b-a655ef73009d ==============================
[0m06:02:12.520610 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.521325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.751390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b6ee57f0>]}
[0m06:02:12.810123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b6dfb050>]}
[0m06:02:12.812623 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:12.845365 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.846083 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.846623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b6a3ed80>]}
[0m06:02:14.070307 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.070990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af6b13a0>]}
[0m06:02:14.251900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.257208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af150f80>]}
[0m06:02:14.377847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af5adc70>]}
[0m06:02:14.378412 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.378894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af096630>]}
[0m06:02:14.380586 [info ] [MainThread]: 
[0m06:02:14.381265 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.386127 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.421651 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.422108 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:14.422501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.037471 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:15.039073 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.041237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.041802 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.048969 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.049403 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.049817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.056062 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.057511 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.057912 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.058451 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.058843 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.059273 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.059875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.060785 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.061179 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.061548 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.062084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.062490 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.064367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.070013 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.070432 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.070807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.076669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.077079 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.077472 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.100922 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.102368 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.103616 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.104022 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.107300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b7ead340>]}
[0m06:02:15.107808 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.108194 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.108555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.114802 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.115274 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.115675 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.116048 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.116585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.116994 [debug] [MainThread]: On master: Close
[0m06:02:15.118731 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.119286 [info ] [MainThread]: 
[0m06:02:15.164347 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.164990 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.165748 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.166195 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.192718 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.193482 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.229642 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.230384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:28.016002 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.016531 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:28.017177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.017632 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.018073 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:28.018803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.021705 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.022164 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:28.022870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.043772 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.044257 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.044699 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.049294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.054264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.054733 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:28.056032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.058362 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:28.088416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b7302600>]}
[0m06:02:28.089182 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.92s]
[0m06:02:28.089951 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:28.090993 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:28.091568 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:28.092171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:28.092633 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:28.097900 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:28.098550 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:28.132453 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.132967 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241115060228126485"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:28.133445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:28.148555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.156008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.156477 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:28.157126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.157575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.158018 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241115060228126485'
      
      
      order by ordinal_position

  
[0m06:02:28.179030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.185174 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.185675 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.188930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.196609 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.197089 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.199924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.217927 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:28.218620 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.219128 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241115060228126485"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241115060228126485"
    )
  
[0m06:02:28.253371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.255423 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:28.255885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.256361 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:28.264518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.265419 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:28.377725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06ba5af30>]}
[0m06:02:28.378526 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m06:02:28.379328 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:28.380927 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.381414 [debug] [MainThread]: On master: BEGIN
[0m06:02:28.381847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:28.388687 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.389159 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.389594 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.390014 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.390579 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.391083 [debug] [MainThread]: On master: Close
[0m06:02:28.392521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:28.392956 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:28.393370 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:28.393831 [info ] [MainThread]: 
[0m06:02:28.394370 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.01 seconds (14.01s).
[0m06:02:28.395411 [debug] [MainThread]: Command end result
[0m06:02:28.423180 [info ] [MainThread]: 
[0m06:02:28.423782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:28.424274 [info ] [MainThread]: 
[0m06:02:28.424777 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:28.425761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.956129, "process_user_time": 5.450622, "process_kernel_time": 0.368989, "process_mem_max_rss": "292296", "process_in_blocks": "3808", "process_out_blocks": "112168"}
[0m06:02:28.426399 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:28.426290 after 15.96 seconds
[0m06:02:28.426894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b6dfac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af124800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af10c1a0>]}
[0m06:02:28.427444 [debug] [MainThread]: Flushing usage events
[0m06:02:30.299282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8af19790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f89bf9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8a007230>]}


============================== 06:02:30.302039 | 9e4ad980-53b3-4d58-b957-a270205ff90d ==============================
[0m06:02:30.302039 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:30.302688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:30.439946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e4ad980-53b3-4d58-b957-a270205ff90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8947be00>]}
[0m06:02:30.456665 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20594522, "process_user_time": 1.449128, "process_kernel_time": 0.091818, "process_mem_max_rss": "92412", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:30.457259 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:30.457155 after 0.21 seconds
[0m06:02:30.457705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f896d6d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f89780c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f89562960>]}
[0m06:02:30.458133 [debug] [MainThread]: Flushing usage events
[0m14:05:35.139852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b49b2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b4c5ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b4c1a600>]}


============================== 14:05:35.156217 | 35778c99-d289-42e5-9d4f-8fc7ced7d2d3 ==============================
[0m14:05:35.156217 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:35.156905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.304681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35778c99-d289-42e5-9d4f-8fc7ced7d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b48f1190>]}
[0m14:05:35.318190 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pzit68t5'
[0m14:05:35.318641 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:35.367174 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:35.367818 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:35.379351 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:35.383189 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:35.538246 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:35.538793 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:35.539297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35778c99-d289-42e5-9d4f-8fc7ced7d2d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b45e0c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b46859d0>]}
[0m14:05:35.539789 [info ] [MainThread]: 
[0m14:05:35.540247 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:35.567769 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4760477, "process_user_time": 1.568583, "process_kernel_time": 0.142598, "process_mem_max_rss": "93524", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:35.568485 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:35.568375 after 0.48 seconds
[0m14:05:35.568939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b49b2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b4973800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b5042360>]}
[0m14:05:35.569376 [debug] [MainThread]: Flushing usage events
[0m14:05:37.198839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e07560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e07a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e07680>]}


============================== 14:05:37.201608 | 51746001-b8ac-4c2b-9ffd-893f059b0ed6 ==============================
[0m14:05:37.201608 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:37.202285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:37.440062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe349f5d2b0>]}
[0m14:05:37.498899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe351dc8a40>]}
[0m14:05:37.501433 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:37.527658 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:37.528383 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:37.528911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350ec8050>]}
[0m14:05:38.755645 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:38.756287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3498a4440>]}
[0m14:05:38.936330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:38.941375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3498ec110>]}
[0m14:05:39.109779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3499fa480>]}
[0m14:05:39.110368 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:39.110846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34974cb60>]}
[0m14:05:39.112614 [info ] [MainThread]: 
[0m14:05:39.113320 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:39.118110 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:39.153592 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:39.154032 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:39.154442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:39.723773 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:39.725360 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:39.727487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:39.728108 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:39.735240 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.735711 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:39.736116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:39.742517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.744067 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.744475 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:39.745069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.745464 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.745838 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:39.746399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.747314 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:39.747754 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.748127 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:39.748666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.749073 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:39.751116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:39.756746 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:39.757153 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:39.757517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:39.763199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.763606 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:39.764038 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:39.787453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.788914 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:39.790127 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:39.790534 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:39.793864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe349710c80>]}
[0m14:05:39.794375 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.794767 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.795132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:39.801574 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.802006 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.802401 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.802784 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.803310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.803760 [debug] [MainThread]: On master: Close
[0m14:05:39.805257 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:39.805759 [info ] [MainThread]: 
[0m14:05:39.823835 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:39.824444 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:39.825106 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:39.825554 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:39.851600 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:39.852373 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:39.888414 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:39.889207 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:47.752635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.753165 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:47.753816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.754287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.754737 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:47.755539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.758509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.758979 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:47.759704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.780444 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:47.780924 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.781369 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:47.783262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.788211 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.788685 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:47.789892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.792269 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:47.821769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3519c68d0>]}
[0m14:05:47.822506 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.00s]
[0m14:05:47.823386 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:47.824423 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:47.824994 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:47.825669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:47.826133 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:47.831346 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:47.832057 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:47.866006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.866519 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241115140547860105"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:47.866989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:47.881542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.889051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.889528 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:47.890139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.890594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.891045 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241115140547860105'
      
      
      order by ordinal_position

  
[0m14:05:47.911963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.918356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.918849 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:47.921679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.929335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.929816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:47.932645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.950696 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:47.951451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.951987 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241115140547860105"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241115140547860105"
    )
  
[0m14:05:47.984550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.986663 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:47.987158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.987597 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:47.999746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:48.000681 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:48.111335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30a16b800>]}
[0m14:05:48.112176 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m14:05:48.113061 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:48.114443 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.114946 [debug] [MainThread]: On master: BEGIN
[0m14:05:48.115387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:48.122198 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.122671 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.123106 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.123528 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.124138 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.124588 [debug] [MainThread]: On master: Close
[0m14:05:48.126204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:48.126636 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:48.127038 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:48.127489 [info ] [MainThread]: 
[0m14:05:48.128054 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.01 seconds (9.01s).
[0m14:05:48.129043 [debug] [MainThread]: Command end result
[0m14:05:48.156966 [info ] [MainThread]: 
[0m14:05:48.157568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:48.158066 [info ] [MainThread]: 
[0m14:05:48.158579 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:48.159568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.00877, "process_user_time": 5.518457, "process_kernel_time": 0.32696, "process_mem_max_rss": "293740", "process_in_blocks": "3808", "process_out_blocks": "112160"}
[0m14:05:48.160251 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:48.160142 after 11.01 seconds
[0m14:05:48.160738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe351f58110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30b003740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3499e8650>]}
[0m14:05:48.161218 [debug] [MainThread]: Flushing usage events
[0m14:05:49.893928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36313f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe364b9a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe363f9de20>]}


============================== 14:05:49.896884 | aab219f2-8279-470f-80b3-b85617a4635e ==============================
[0m14:05:49.896884 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:49.897629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:50.039054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aab219f2-8279-470f-80b3-b85617a4635e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3633ade50>]}
[0m14:05:50.055746 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21065614, "process_user_time": 1.418729, "process_kernel_time": 0.091917, "process_mem_max_rss": "92260", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:50.056346 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:50.056241 after 0.21 seconds
[0m14:05:50.056794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3628e2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36268bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362cdaf00>]}
[0m14:05:50.057227 [debug] [MainThread]: Flushing usage events
[0m22:06:02.411751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61baa2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61a2fef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff619b65040>]}


============================== 22:06:02.419453 | 811dbf86-e491-483c-9b1c-579575570a0d ==============================
[0m22:06:02.419453 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:02.420121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:02.562496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '811dbf86-e491-483c-9b1c-579575570a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61992fd70>]}
[0m22:06:02.575747 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jrn0hx1f'
[0m22:06:02.576194 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:02.658220 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:02.658828 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:02.685496 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:02.690454 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:02.761221 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:02.761810 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:02.762414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '811dbf86-e491-483c-9b1c-579575570a0d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6197f1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61986bd40>]}
[0m22:06:02.762889 [info ] [MainThread]: 
[0m22:06:02.763440 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:02.806670 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44377574, "process_user_time": 1.576055, "process_kernel_time": 0.125921, "process_mem_max_rss": "93384", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:06:02.807286 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:02.807181 after 0.44 seconds
[0m22:06:02.807769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff619c998e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61a3e2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff619dc7f80>]}
[0m22:06:02.808223 [debug] [MainThread]: Flushing usage events
[0m22:06:04.398784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a021229c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a028f2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a02221ee0>]}


============================== 22:06:04.401690 | 3b1f2142-1491-49c8-84a7-bc610f9b882d ==============================
[0m22:06:04.401690 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:04.402358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:04.635756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a01e35400>]}
[0m22:06:04.694938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a01f60b60>]}
[0m22:06:04.697425 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:04.713285 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:04.714006 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:04.714531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a01f41a00>]}
[0m22:06:05.946848 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:05.947526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fab87380>]}
[0m22:06:06.128201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:06.133278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fab05370>]}
[0m22:06:06.270406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19faa59ac0>]}
[0m22:06:06.270981 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:06.271511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19faad2cf0>]}
[0m22:06:06.273237 [info ] [MainThread]: 
[0m22:06:06.273940 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:06.278875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:06.314211 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:06.314666 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:06.315066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:06.924925 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:06.926499 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:06.928820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:06.929408 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:06.936553 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.936984 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:06.937374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:06.943611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.945061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.945462 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:06.946053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.946448 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.946821 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:06.947432 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.948349 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:06.948759 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.949132 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:06.949677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.950079 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:06.952005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:06.957513 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:06.957923 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:06.958297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:06.964151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.964578 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:06.964972 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:06.988557 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.990110 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:06.991365 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:06.991791 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:06.995559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f973b470>]}
[0m22:06:06.996080 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:06.996473 [debug] [MainThread]: On master: BEGIN
[0m22:06:06.996842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:07.003237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.003697 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.004084 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.004457 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.004990 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.005393 [debug] [MainThread]: On master: Close
[0m22:06:07.006946 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:07.007488 [info ] [MainThread]: 
[0m22:06:07.017249 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:07.017855 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:07.018496 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:07.018947 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:07.044988 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:07.045751 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:07.081928 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:07.082772 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:14.087022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.087575 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:14.088222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.088683 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.089124 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:14.089850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.092754 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.093213 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:14.093907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.114664 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:14.115164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.115631 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:14.116871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.121749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.122217 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:14.123580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.125883 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:14.156692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19bbb32390>]}
[0m22:06:14.157477 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.14s]
[0m22:06:14.158354 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:14.159396 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:14.159967 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:14.160639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:14.161106 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:14.166317 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:14.166971 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:14.200698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.201210 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241115220614194825"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:14.201694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:14.217495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.225153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.225642 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:14.226240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.226696 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.227132 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241115220614194825'
      
      
      order by ordinal_position

  
[0m22:06:14.249492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.256241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.256751 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:14.259954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.267531 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.268009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:14.270836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.288767 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:14.289466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.289932 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241115220614194825"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241115220614194825"
    )
  
[0m22:06:14.324899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.326899 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:14.327402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.327840 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:14.335778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.336736 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:14.463266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19bb137560>]}
[0m22:06:14.464119 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m22:06:14.464911 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:14.466430 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.466936 [debug] [MainThread]: On master: BEGIN
[0m22:06:14.467445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:14.474303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.474780 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.475225 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.475697 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.476305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.476752 [debug] [MainThread]: On master: Close
[0m22:06:14.478467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:14.478899 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:14.479299 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:14.479822 [info ] [MainThread]: 
[0m22:06:14.480356 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m22:06:14.481359 [debug] [MainThread]: Command end result
[0m22:06:14.509249 [info ] [MainThread]: 
[0m22:06:14.509871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:14.510380 [info ] [MainThread]: 
[0m22:06:14.510900 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:14.511935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.161415, "process_user_time": 5.536103, "process_kernel_time": 0.391441, "process_mem_max_rss": "292524", "process_in_blocks": "3808", "process_out_blocks": "112704"}
[0m22:06:14.512587 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:14.512477 after 10.16 seconds
[0m22:06:14.513078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a05dbbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a02a71d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19bb167f20>]}
[0m22:06:14.513566 [debug] [MainThread]: Flushing usage events
[0m22:06:16.225698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0662f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c08049a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c060b4440>]}


============================== 22:06:16.228609 | b9e1e41e-40f5-4b95-bf70-9741ece32379 ==============================
[0m22:06:16.228609 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:16.229273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:16.368343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9e1e41e-40f5-4b95-bf70-9741ece32379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c05d6aff0>]}
[0m22:06:16.384741 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20734015, "process_user_time": 1.364068, "process_kernel_time": 0.139597, "process_mem_max_rss": "92372", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:16.385334 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:16.385230 after 0.21 seconds
[0m22:06:16.385772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c05e3cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c05d9e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c06be9be0>]}
[0m22:06:16.386206 [debug] [MainThread]: Flushing usage events
[0m06:02:17.276174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9a1fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9f2a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9f29c40>]}


============================== 06:02:17.297146 | f4b8ba99-9a89-46d9-995f-11dc47e98bf1 ==============================
[0m06:02:17.297146 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.297817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.432699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4b8ba99-9a89-46d9-995f-11dc47e98bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9584170>]}
[0m06:02:17.446039 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_co7evfb'
[0m06:02:17.446485 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:17.579212 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:17.579815 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:17.602152 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:17.606023 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:17.689018 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:17.689569 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:17.690167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f4b8ba99-9a89-46d9-995f-11dc47e98bf1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d94497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9449cd0>]}
[0m06:02:17.690611 [info ] [MainThread]: 
[0m06:02:17.691164 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:17.713913 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48564953, "process_user_time": 1.587725, "process_kernel_time": 0.101516, "process_mem_max_rss": "93768", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m06:02:17.714671 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:17.714542 after 0.49 seconds
[0m06:02:17.715110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9ce4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d94c1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9563d70>]}
[0m06:02:17.715537 [debug] [MainThread]: Flushing usage events
[0m06:02:19.277503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2a116cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2a8fd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2a8fd2e0>]}


============================== 06:02:19.280177 | 4c097125-fa86-46ce-9ffa-b4ea6015f113 ==============================
[0m06:02:19.280177 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.280928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:19.509277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f29ef0380>]}
[0m06:02:19.567641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f29df85c0>]}
[0m06:02:19.570015 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:19.597578 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:19.598292 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:19.598829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f22f03680>]}
[0m06:02:20.820482 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:20.821117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f22a79bb0>]}
[0m06:02:21.001273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:21.006347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f22a42cc0>]}
[0m06:02:21.155420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f22a596d0>]}
[0m06:02:21.155961 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:21.156469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f229f0770>]}
[0m06:02:21.158244 [info ] [MainThread]: 
[0m06:02:21.158954 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:21.163697 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:21.198231 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:21.198669 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:21.199072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:21.790728 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:21.792298 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:21.794443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:21.795021 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:21.802193 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.802632 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:21.803024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:21.809697 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.811172 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.811594 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:21.812204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.812598 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.812972 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:21.813531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.814481 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.814882 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.815260 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.815861 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.816270 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:21.818283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:21.823930 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:21.824341 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:21.824713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:21.830604 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.831013 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:21.831408 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:21.854667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.856130 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:21.857326 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:21.857767 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:21.860978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f229f0230>]}
[0m06:02:21.861482 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.861917 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.862296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:21.868506 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.868938 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.869330 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.869743 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.870288 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.870695 [debug] [MainThread]: On master: Close
[0m06:02:21.872197 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:21.872747 [info ] [MainThread]: 
[0m06:02:21.898267 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:21.898867 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:21.899599 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:21.900042 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:21.925580 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:21.926343 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:21.961726 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:21.962462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:28.894436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.894944 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:28.895596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.896055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.896494 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:28.897269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.900146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.900601 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:28.901297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.922983 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.923466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.923908 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.925012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.929926 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.930396 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:28.931912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.934220 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:28.964714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f216636e0>]}
[0m06:02:28.965421 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.06s]
[0m06:02:28.966236 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:28.967207 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:28.967762 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:28.968352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:28.968799 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:28.973871 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:28.974510 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.007715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.008217 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241116060229001945"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.008689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.022756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.029994 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.030456 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.031048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.031578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.032034 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241116060229001945'
      
      
      order by ordinal_position

  
[0m06:02:29.052986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.059072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.059558 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.062620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.070153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.070634 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.073407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.091203 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.091874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.092342 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241116060229001945"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241116060229001945"
    )
  
[0m06:02:29.126590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.128587 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.129055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.129480 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.137709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.138613 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:29.259390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef019b170>]}
[0m06:02:29.260171 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m06:02:29.260911 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:29.262313 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.262795 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.263241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:29.270043 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.270513 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.270950 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.271370 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.271954 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.272412 [debug] [MainThread]: On master: Close
[0m06:02:29.273870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:29.274305 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:29.274708 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:29.275164 [info ] [MainThread]: 
[0m06:02:29.275752 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.12 seconds (8.12s).
[0m06:02:29.276869 [debug] [MainThread]: Command end result
[0m06:02:29.304754 [info ] [MainThread]: 
[0m06:02:29.305423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:29.306059 [info ] [MainThread]: 
[0m06:02:29.306656 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:29.307728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.078036, "process_user_time": 5.453427, "process_kernel_time": 0.309214, "process_mem_max_rss": "299540", "process_in_blocks": "3808", "process_out_blocks": "112176"}
[0m06:02:29.308365 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:29.308256 after 10.08 seconds
[0m06:02:29.308850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f29df8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2ddbbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee38bacc0>]}
[0m06:02:29.309331 [debug] [MainThread]: Flushing usage events
[0m06:02:30.912445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c70cc800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6741a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c70cfd70>]}


============================== 06:02:30.915133 | 216bdfab-8159-4fc1-b176-d7130e47c0f6 ==============================
[0m06:02:30.915133 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:30.915853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.058363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '216bdfab-8159-4fc1-b176-d7130e47c0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6799640>]}
[0m06:02:31.075042 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21053475, "process_user_time": 1.36596, "process_kernel_time": 0.127809, "process_mem_max_rss": "92036", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:31.075627 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:31.075522 after 0.21 seconds
[0m06:02:31.076071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6f0a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c65b7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c65035c0>]}
[0m06:02:31.076504 [debug] [MainThread]: Flushing usage events
[0m14:04:44.975438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf931ed1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf931ec0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf931ec080>]}


============================== 14:04:44.991035 | fd21bc0f-7611-4875-8b32-995ae42ff9a9 ==============================
[0m14:04:44.991035 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:44.991773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:45.134797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd21bc0f-7611-4875-8b32-995ae42ff9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf933d3c80>]}
[0m14:04:45.148005 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mynwzf16'
[0m14:04:45.148447 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:45.202112 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:45.202731 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:45.226125 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:45.230180 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:45.325761 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:45.326478 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:45.327126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fd21bc0f-7611-4875-8b32-995ae42ff9a9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf932582c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf942f9520>]}
[0m14:04:45.327634 [info ] [MainThread]: 
[0m14:04:45.328226 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:45.343759 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41889602, "process_user_time": 1.594777, "process_kernel_time": 0.143529, "process_mem_max_rss": "93724", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:04:45.344415 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:45.344309 after 0.42 seconds
[0m14:04:45.344926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf93dc15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf932465a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf933d3c80>]}
[0m14:04:45.345383 [debug] [MainThread]: Flushing usage events
[0m14:04:46.965566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c2053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236ba143e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236aa120f0>]}


============================== 14:04:46.968543 | fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21 ==============================
[0m14:04:46.968543 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:46.969309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.213511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236a648380>]}
[0m14:04:47.273181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236a774800>]}
[0m14:04:47.275785 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:47.295380 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:47.296125 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:47.296646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236373d8e0>]}
[0m14:04:48.529176 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:48.529835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23635c8a10>]}
[0m14:04:48.712095 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:48.717482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236a774aa0>]}
[0m14:04:48.866121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23635b66f0>]}
[0m14:04:48.866694 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:48.867221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236317e5a0>]}
[0m14:04:48.869032 [info ] [MainThread]: 
[0m14:04:48.869769 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:48.874518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:48.910362 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:48.910830 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:48.911239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:49.390635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.392142 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:49.394270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:49.394827 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:49.401933 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.402371 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:49.402833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:49.409027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.410440 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.410845 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:49.411379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.411773 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.412153 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:49.412727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.413673 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:49.414081 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.414492 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:49.415043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.415492 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:49.417385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:49.423019 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:49.423438 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:49.423827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:49.429607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.430049 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:49.430458 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:49.451926 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.453477 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:49.454716 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:49.455117 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:49.458624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23635fa420>]}
[0m14:04:49.459146 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:49.459539 [debug] [MainThread]: On master: BEGIN
[0m14:04:49.459911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:49.466975 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:49.467405 [debug] [MainThread]: On master: COMMIT
[0m14:04:49.467889 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:49.468572 [debug] [MainThread]: On master: COMMIT
[0m14:04:49.469323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:49.469953 [debug] [MainThread]: On master: Close
[0m14:04:49.471571 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:49.472081 [info ] [MainThread]: 
[0m14:04:49.486657 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:49.487257 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:49.487935 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:49.488373 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:49.519434 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:49.520217 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:49.555818 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:49.556662 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:57.214409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.214928 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:57.215557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.216007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.216441 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:57.217240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.220114 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.220571 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:57.221335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.242319 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:57.242844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.243294 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:57.245129 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.250221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.250697 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:57.251902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.254334 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:57.283604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236b09a330>]}
[0m14:04:57.284375 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.79s]
[0m14:04:57.285192 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:57.286200 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:57.286774 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:57.287386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:57.287840 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:57.293106 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:57.293772 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:57.327582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.328108 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241116140457321675"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:57.328596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:57.343712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.351538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.352015 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:57.352708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.353195 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.353636 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241116140457321675'
      
      
      order by ordinal_position

  
[0m14:04:57.374229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.380687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.381198 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:57.384042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.391723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.392199 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:57.394995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.412939 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:57.413641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.414116 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241116140457321675"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241116140457321675"
    )
  
[0m14:04:57.446628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.448656 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:57.449154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.449584 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:57.457398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.458316 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:57.593053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f231b712ae0>]}
[0m14:04:57.593868 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m14:04:57.594725 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:57.596158 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.596695 [debug] [MainThread]: On master: BEGIN
[0m14:04:57.597204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:57.603927 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.604410 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.604885 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.605331 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.605965 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.606427 [debug] [MainThread]: On master: Close
[0m14:04:57.607804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:57.608236 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:57.608643 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:57.609162 [info ] [MainThread]: 
[0m14:04:57.609700 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m14:04:57.610724 [debug] [MainThread]: Command end result
[0m14:04:57.638554 [info ] [MainThread]: 
[0m14:04:57.639191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:57.639707 [info ] [MainThread]: 
[0m14:04:57.640230 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:57.641260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.726796, "process_user_time": 5.049144, "process_kernel_time": 0.328074, "process_mem_max_rss": "283404", "process_in_blocks": "3808", "process_out_blocks": "113192"}
[0m14:04:57.641913 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:57.641790 after 10.73 seconds
[0m14:04:57.642406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c2053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236a6ef9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23635ed4f0>]}
[0m14:04:57.642895 [debug] [MainThread]: Flushing usage events
[0m14:04:59.359770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40db9cc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dcb55b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40da8736b0>]}


============================== 14:04:59.362734 | d7b2823d-f636-47ab-a8c7-76427c38dc39 ==============================
[0m14:04:59.362734 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:59.363420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:59.506568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b2823d-f636-47ab-a8c7-76427c38dc39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40db1d3140>]}
[0m14:04:59.523462 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2145698, "process_user_time": 1.499601, "process_kernel_time": 0.067981, "process_mem_max_rss": "92168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:04:59.524065 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:59.523959 after 0.22 seconds
[0m14:04:59.524516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dc8a8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40da670c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40db0538c0>]}
[0m14:04:59.525012 [debug] [MainThread]: Flushing usage events
[0m22:05:22.300458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cfc19e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ce58d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ce024d10>]}


============================== 22:05:22.308115 | f076b89e-1122-4461-8c0d-77a8b8ad9905 ==============================
[0m22:05:22.308115 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.308790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.449654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f076b89e-1122-4461-8c0d-77a8b8ad9905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cd697b90>]}
[0m22:05:22.463142 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-oac3wzps'
[0m22:05:22.463595 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:22.592173 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:22.592877 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:22.602152 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:22.606016 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:22.659407 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:22.659972 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:22.660552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f076b89e-1122-4461-8c0d-77a8b8ad9905', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cda3f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cd628260>]}
[0m22:05:22.661004 [info ] [MainThread]: 
[0m22:05:22.661583 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:22.663591 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4112259, "process_user_time": 1.598572, "process_kernel_time": 0.115033, "process_mem_max_rss": "93692", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:22.664216 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:22.664108 after 0.41 seconds
[0m22:05:22.664647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cfc19e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cd65ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cdc57e30>]}
[0m22:05:22.665070 [debug] [MainThread]: Flushing usage events
[0m22:05:24.202368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbee01670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbde91cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbde90860>]}


============================== 22:05:24.205305 | 5e344863-b0a9-46ba-979d-ddeb62f584ce ==============================
[0m22:05:24.205305 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:24.205980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:24.439753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbfb20380>]}
[0m22:05:24.498277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbe5d2c00>]}
[0m22:05:24.500826 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:24.516465 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:24.517172 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:24.517705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbd37fb90>]}
[0m22:05:25.746229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:25.746872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb61fb890>]}
[0m22:05:25.928380 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:25.933663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb5d1da30>]}
[0m22:05:26.101621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb6199af0>]}
[0m22:05:26.102215 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:26.102743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb5c50da0>]}
[0m22:05:26.104602 [info ] [MainThread]: 
[0m22:05:26.105356 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:26.110280 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:26.146453 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:26.146911 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:26.147316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:26.685984 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:26.687566 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:26.689853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:26.690462 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:26.697756 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:26.698208 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:26.698603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:26.705113 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.706591 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:26.707003 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:26.707599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.707995 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:26.708419 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:26.709001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.709908 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:26.710313 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:26.710688 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:26.711284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.711692 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:26.713629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:26.719343 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:26.719756 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:26.720161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:26.725909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.726320 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:26.726714 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:26.750408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.751935 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:26.753187 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:26.753589 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:26.757636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb5d4a630>]}
[0m22:05:26.758167 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:26.758563 [debug] [MainThread]: On master: BEGIN
[0m22:05:26.758937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:26.765663 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:26.766090 [debug] [MainThread]: On master: COMMIT
[0m22:05:26.766487 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:26.766868 [debug] [MainThread]: On master: COMMIT
[0m22:05:26.767409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:26.767812 [debug] [MainThread]: On master: Close
[0m22:05:26.769283 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:26.769807 [info ] [MainThread]: 
[0m22:05:26.779464 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:26.780107 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:26.780861 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:26.781306 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:26.807382 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:26.808167 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:26.844191 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:26.845059 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:33.280154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.280689 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:33.281331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.281787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.282230 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:33.282947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.285853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.286312 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:33.287015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.307759 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:33.308263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.308706 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:33.310576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.315474 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.315940 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:33.317186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.319469 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:33.349397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbea463f0>]}
[0m22:05:33.350127 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.57s]
[0m22:05:33.351008 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:33.351986 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:33.352586 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:33.353259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:33.353711 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:33.358810 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:33.359462 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:33.393042 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.393552 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241116220533386863"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:33.394021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:33.408441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.416137 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.416612 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:33.417213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.417659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.418095 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241116220533386863'
      
      
      order by ordinal_position

  
[0m22:05:33.439062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.445241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.445725 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.448491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.455942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.456454 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.459175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.477066 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:33.477848 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.478356 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241116220533386863"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241116220533386863"
    )
  
[0m22:05:33.512386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.514380 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.514837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.515265 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.524023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.524958 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:33.654076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7a4cbfe0>]}
[0m22:05:33.654878 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m22:05:33.655626 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:33.656971 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.657456 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.657891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:33.664475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.664947 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.665382 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.665815 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.666392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.666839 [debug] [MainThread]: On master: Close
[0m22:05:33.668171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:33.668617 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:33.669018 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:33.669474 [info ] [MainThread]: 
[0m22:05:33.670019 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.56 seconds (7.56s).
[0m22:05:33.671186 [debug] [MainThread]: Command end result
[0m22:05:33.698586 [info ] [MainThread]: 
[0m22:05:33.699279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:33.699868 [info ] [MainThread]: 
[0m22:05:33.700506 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:33.701578 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.54778, "process_user_time": 5.33626, "process_kernel_time": 0.356284, "process_mem_max_rss": "293148", "process_in_blocks": "3808", "process_out_blocks": "112712"}
[0m22:05:33.702220 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:33.702111 after 9.55 seconds
[0m22:05:33.702710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbee01670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc11bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbd984a40>]}
[0m22:05:33.703195 [debug] [MainThread]: Flushing usage events
[0m22:05:35.368114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563ca1fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563d3688f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563d0f6d20>]}


============================== 22:05:35.370913 | 60e1d421-27dc-489e-9065-d163d7ffda7f ==============================
[0m22:05:35.370913 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.371603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.514236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60e1d421-27dc-489e-9065-d163d7ffda7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563c3c8ad0>]}
[0m22:05:35.530577 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21080424, "process_user_time": 1.408833, "process_kernel_time": 0.107757, "process_mem_max_rss": "92160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:35.531163 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:35.531061 after 0.21 seconds
[0m22:05:35.531600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563c653800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563cdb7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563c2a5fd0>]}
[0m22:05:35.532040 [debug] [MainThread]: Flushing usage events
[0m06:02:10.456811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577846db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5778927440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5778224aa0>]}


============================== 06:02:10.464506 | d380d98a-cc1e-4faf-87a7-ef9519024bda ==============================
[0m06:02:10.464506 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.465169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.608271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd380d98a-cc1e-4faf-87a7-ef9519024bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5777b8e180>]}
[0m06:02:10.621839 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-72ozwhnw'
[0m06:02:10.622318 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.803057 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.803857 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.858834 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.862932 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.998676 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.999322 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:10.999829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd380d98a-cc1e-4faf-87a7-ef9519024bda', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5777939760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57779396d0>]}
[0m06:02:11.000295 [info ] [MainThread]: 
[0m06:02:11.000768 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:11.026694 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6184082, "process_user_time": 1.629121, "process_kernel_time": 0.117232, "process_mem_max_rss": "93916", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m06:02:11.027558 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.027414 after 0.62 seconds
[0m06:02:11.028023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57786d2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5777be9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5777be9a30>]}
[0m06:02:11.028461 [debug] [MainThread]: Flushing usage events
[0m06:02:12.666039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a55cd8b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a5547ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a55204860>]}


============================== 06:02:12.668990 | 7fd5d5f3-20e5-41e0-b19d-db2a67099ed2 ==============================
[0m06:02:12.668990 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.669669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.912835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a4e35b7a0>]}
[0m06:02:12.972708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a4e3ad3a0>]}
[0m06:02:12.975299 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:12.991136 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.991879 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.992415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a4e37be60>]}
[0m06:02:14.241801 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.242519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a4e163e90>]}
[0m06:02:14.427985 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.433430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a4e162ab0>]}
[0m06:02:14.593651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a4ddad1c0>]}
[0m06:02:14.594250 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.594756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a4db0a7b0>]}
[0m06:02:14.596515 [info ] [MainThread]: 
[0m06:02:14.597225 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.602110 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.638082 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.638558 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:14.638988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.143839 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:15.145421 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.147648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.148229 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.155423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.155856 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.156252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.162694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.164192 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.164599 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.165140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.165531 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.165905 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.166465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.167431 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.167842 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.168224 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.168827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.169239 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.171362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.177061 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.177482 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.177867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.183645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.184062 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.184463 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.207963 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.209598 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.210891 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.211314 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.214926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a564ae6f0>]}
[0m06:02:15.215486 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.215900 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.216281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.222960 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.223398 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.223801 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.224196 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.224740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.225150 [debug] [MainThread]: On master: Close
[0m06:02:15.226677 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.227218 [info ] [MainThread]: 
[0m06:02:15.237360 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.237984 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.238637 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.239138 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.265620 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.266419 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.302408 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.303285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.020603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.021180 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.021935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.022427 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.022954 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.023816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.027073 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.027611 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.028418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.051030 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.051572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.052046 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.054150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.059732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.060258 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.061559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.064155 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.096480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a56962360>]}
[0m06:02:23.097332 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.86s]
[0m06:02:23.098124 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.099035 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.099813 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.100442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.100905 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.106627 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.107353 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.141647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.142216 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241117060223135676"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.142696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.157645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.166034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.166570 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.167359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.167817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.168262 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241117060223135676'
      
      
      order by ordinal_position

  
[0m06:02:23.189711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.196823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.197337 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.200873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.208757 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.209249 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.212281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.230438 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.231285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.231763 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241117060223135676"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241117060223135676"
    )
  
[0m06:02:23.264617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.266672 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.267162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.267593 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.275532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.276469 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:23.415814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fd5d5f3-20e5-41e0-b19d-db2a67099ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a1255ab70>]}
[0m06:02:23.416653 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:23.417427 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:23.418876 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.419351 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.419783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:23.426422 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.426923 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.427372 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.427809 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.428390 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.428856 [debug] [MainThread]: On master: Close
[0m06:02:23.430199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:23.430644 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:23.431095 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:23.431557 [info ] [MainThread]: 
[0m06:02:23.432100 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.83 seconds (8.83s).
[0m06:02:23.433132 [debug] [MainThread]: Command end result
[0m06:02:23.460946 [info ] [MainThread]: 
[0m06:02:23.461602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:23.462148 [info ] [MainThread]: 
[0m06:02:23.462705 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:23.463809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.846301, "process_user_time": 5.591178, "process_kernel_time": 0.297018, "process_mem_max_rss": "287224", "process_in_blocks": "3808", "process_out_blocks": "113200"}
[0m06:02:23.464463 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:23.464349 after 10.85 seconds
[0m06:02:23.465010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a55529b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a569acc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a127fac00>]}
[0m06:02:23.465528 [debug] [MainThread]: Flushing usage events
[0m06:02:25.200908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a706dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a66a5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a66a5f40>]}


============================== 06:02:25.203823 | 443043b1-8143-4d0a-9543-1cc4df57c53b ==============================
[0m06:02:25.203823 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.204543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.348216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '443043b1-8143-4d0a-9543-1cc4df57c53b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a66a5f40>]}
[0m06:02:25.364632 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21253833, "process_user_time": 1.429955, "process_kernel_time": 0.095862, "process_mem_max_rss": "92284", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:25.365229 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:25.365125 after 0.21 seconds
[0m06:02:25.365676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a6789ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a7271b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a6af3980>]}
[0m06:02:25.366108 [debug] [MainThread]: Flushing usage events
[0m14:05:03.933069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0522538680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0520ef3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0520ef1640>]}


============================== 14:05:03.972182 | c7fef048-3984-4f05-9a1e-248324ecdce8 ==============================
[0m14:05:03.972182 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:03.972847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.132822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7fef048-3984-4f05-9a1e-248324ecdce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0521b43ef0>]}
[0m14:05:04.147277 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wpok0urm'
[0m14:05:04.147805 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:04.251076 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:04.251814 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:04.264912 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:04.268997 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:04.716615 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:04.717182 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:04.717746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c7fef048-3984-4f05-9a1e-248324ecdce8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0520985130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05209861e0>]}
[0m14:05:04.718204 [info ] [MainThread]: 
[0m14:05:04.718676 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:04.727257 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8432288, "process_user_time": 1.63052, "process_kernel_time": 0.138852, "process_mem_max_rss": "93768", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:04.727851 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:04.727749 after 0.84 seconds
[0m14:05:04.728292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0520ab0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0520a37ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0520a37d10>]}
[0m14:05:04.728730 [debug] [MainThread]: Flushing usage events
[0m14:05:06.658346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7506f92bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750725fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7507fe85c0>]}


============================== 14:05:06.661548 | 158aeb56-9915-40fa-a5d3-e0be08ed8cc2 ==============================
[0m14:05:06.661548 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:06.662330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:06.925953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7506d199d0>]}
[0m14:05:06.995814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7506d6e4e0>]}
[0m14:05:06.998625 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:07.022034 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:07.022871 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:07.023445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7506c56510>]}
[0m14:05:08.288067 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:08.288744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ff783f50>]}
[0m14:05:08.477508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:08.483280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ff8fa1b0>]}
[0m14:05:08.633723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7507880b00>]}
[0m14:05:08.634331 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:08.634861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7506e1f230>]}
[0m14:05:08.636672 [info ] [MainThread]: 
[0m14:05:08.637433 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:08.642738 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:08.679995 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:08.680532 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:08.680940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:09.939187 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:09.940739 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:09.942987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:09.943556 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:09.950807 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:09.951254 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:09.951652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:09.958434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.960057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:09.960484 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:09.961040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.961466 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:09.961846 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:09.962426 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.963364 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:09.963773 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:09.964155 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:09.964692 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.965114 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:09.967206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:09.973193 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:09.973685 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:09.974065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:09.980448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:09.980904 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:09.981318 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:10.003831 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.005605 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:10.006894 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:10.007338 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:10.011261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7506f911c0>]}
[0m14:05:10.011785 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:10.012180 [debug] [MainThread]: On master: BEGIN
[0m14:05:10.012560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:10.019136 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:10.019591 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.019987 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:10.020361 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.020946 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:10.021391 [debug] [MainThread]: On master: Close
[0m14:05:10.022935 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:10.023473 [info ] [MainThread]: 
[0m14:05:10.041710 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:10.042380 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:10.043071 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:10.043514 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:10.070238 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:10.071149 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:10.108259 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:10.109187 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:20.834665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.835225 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:20.835917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.836379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.836818 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:20.837607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.840693 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.841153 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:20.841910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.863005 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.863525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.863975 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.865553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.870726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.871207 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:20.872672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.875127 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:20.906301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75073b6cc0>]}
[0m14:05:20.907138 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.86s]
[0m14:05:20.908042 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:20.909058 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:20.909672 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:20.910369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:20.910834 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:20.916288 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:20.916985 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:20.951651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.952239 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241117140520945573"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:20.952732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:20.968047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.976241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.976744 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:20.977437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.977894 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.978335 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241117140520945573'
      
      
      order by ordinal_position

  
[0m14:05:21.000177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.007542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.008093 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.011286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.019390 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.019891 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.022917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.041369 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:21.042128 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.042615 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241117140520945573"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241117140520945573"
    )
  
[0m14:05:21.078563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.080678 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.081176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.081654 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.090306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.091327 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:21.244304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '158aeb56-9915-40fa-a5d3-e0be08ed8cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74b775dbb0>]}
[0m14:05:21.245133 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:05:21.245948 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:21.247467 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.247946 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.248383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:21.255394 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.255906 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.256355 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.256788 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.257455 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.257924 [debug] [MainThread]: On master: Close
[0m14:05:21.259657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.260100 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:21.260508 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:21.260989 [info ] [MainThread]: 
[0m14:05:21.261589 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.62 seconds (12.62s).
[0m14:05:21.262653 [debug] [MainThread]: Command end result
[0m14:05:21.290789 [info ] [MainThread]: 
[0m14:05:21.291497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:21.292042 [info ] [MainThread]: 
[0m14:05:21.292595 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:21.293688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.686188, "process_user_time": 5.231348, "process_kernel_time": 0.312438, "process_mem_max_rss": "281944", "process_in_blocks": "3808", "process_out_blocks": "114216"}
[0m14:05:21.294337 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:21.294224 after 14.69 seconds
[0m14:05:21.294834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75078c0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ff7044a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ff704710>]}
[0m14:05:21.295330 [debug] [MainThread]: Flushing usage events
[0m14:05:23.361992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb88d97eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb88dcf5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb88d97ee10>]}


============================== 14:05:23.368263 | 37492ce1-ec99-4d6a-b572-aea4012df867 ==============================
[0m14:05:23.368263 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.369806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.516786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37492ce1-ec99-4d6a-b572-aea4012df867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb88ee119a0>]}
[0m14:05:23.533591 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22282866, "process_user_time": 1.512423, "process_kernel_time": 0.095773, "process_mem_max_rss": "92128", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:23.534202 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:23.534093 after 0.22 seconds
[0m14:05:23.534665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb88d723fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb88d721be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8915bbe30>]}
[0m14:05:23.535116 [debug] [MainThread]: Flushing usage events
[0m22:05:24.046283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb50b306e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb50940980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb50940b30>]}


============================== 22:05:24.053723 | ce5efd97-4c62-4dc3-9f9b-3f3c1865d2fe ==============================
[0m22:05:24.053723 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:24.054384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:24.194805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce5efd97-4c62-4dc3-9f9b-3f3c1865d2fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb50805640>]}
[0m22:05:24.208097 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8li1l2pg'
[0m22:05:24.208553 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:24.277149 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:24.277810 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:24.289814 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:24.293702 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:24.341359 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:24.341871 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:24.342385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ce5efd97-4c62-4dc3-9f9b-3f3c1865d2fe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5099b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5099aba0>]}
[0m22:05:24.342826 [info ] [MainThread]: 
[0m22:05:24.343308 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:24.354489 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35592115, "process_user_time": 1.593327, "process_kernel_time": 0.104348, "process_mem_max_rss": "93420", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:24.355168 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:24.355066 after 0.36 seconds
[0m22:05:24.355599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5091fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb50de1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb50805640>]}
[0m22:05:24.356075 [debug] [MainThread]: Flushing usage events
[0m22:05:25.887240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40f144fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40ed2b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40f297da0>]}


============================== 22:05:25.889986 | 5de07535-7b92-409d-b7ef-643f6abad9a1 ==============================
[0m22:05:25.889986 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.890719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:26.126483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40eecf6b0>]}
[0m22:05:26.185054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40f297e00>]}
[0m22:05:26.187464 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:26.202956 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:26.203703 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:26.204209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff407dfbb90>]}
[0m22:05:27.438168 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:27.438835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff407682a20>]}
[0m22:05:27.618469 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:27.623459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff407741df0>]}
[0m22:05:27.769988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4077b60f0>]}
[0m22:05:27.770543 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:27.771096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff407510770>]}
[0m22:05:27.772861 [info ] [MainThread]: 
[0m22:05:27.773584 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:27.778224 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:27.813450 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:27.813896 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:27.814295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:28.345446 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:28.347020 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:28.349198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:28.349776 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:28.357088 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.357522 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:28.357909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:28.364233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.365724 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.366134 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:28.366734 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.367129 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.367501 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:28.368133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.369046 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:28.369445 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:28.369820 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:28.370355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.370758 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:28.372769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:28.378416 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:28.378820 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:28.379186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:28.385041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.385451 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:28.385837 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:28.409008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:28.410440 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:28.411672 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:28.412072 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:28.415295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4120bac00>]}
[0m22:05:28.415858 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:28.416257 [debug] [MainThread]: On master: BEGIN
[0m22:05:28.416623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:28.422841 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:28.423264 [debug] [MainThread]: On master: COMMIT
[0m22:05:28.423682 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:28.424062 [debug] [MainThread]: On master: COMMIT
[0m22:05:28.424592 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:28.424994 [debug] [MainThread]: On master: Close
[0m22:05:28.426749 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:28.427282 [info ] [MainThread]: 
[0m22:05:28.436912 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:28.437504 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:28.438231 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:28.438674 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:28.464556 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:28.465298 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:28.500860 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:28.501578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:35.826861 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.827373 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:35.828080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.828538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.828977 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:35.829720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.832651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.833109 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:35.833798 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.854530 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.855006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.855439 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:35.857342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.862188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:35.862671 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:35.863836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.866100 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:35.895858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c78a41d0>]}
[0m22:05:35.896564 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.46s]
[0m22:05:35.897445 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:35.898391 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:35.898950 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:35.899611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:35.900102 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:35.905082 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:35.905727 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:35.938994 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.939498 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241117220535933140"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:35.939995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:35.954688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.962137 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.962660 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:35.963321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.963798 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.964240 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241117220535933140'
      
      
      order by ordinal_position

  
[0m22:05:35.985596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:35.992091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:35.992580 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:35.995835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.003371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.003875 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:36.006708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.024588 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:36.025276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.025742 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241117220535933140"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241117220535933140"
    )
  
[0m22:05:36.062740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.064707 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:36.065166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:36.065590 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:36.074247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:36.075137 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:36.223656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5de07535-7b92-409d-b7ef-643f6abad9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c78e6ab0>]}
[0m22:05:36.224444 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m22:05:36.225253 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:36.226638 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:36.227107 [debug] [MainThread]: On master: BEGIN
[0m22:05:36.227530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:36.234076 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:36.234540 [debug] [MainThread]: On master: COMMIT
[0m22:05:36.234965 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:36.235376 [debug] [MainThread]: On master: COMMIT
[0m22:05:36.235990 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:36.236436 [debug] [MainThread]: On master: Close
[0m22:05:36.237759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:36.238190 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:36.238589 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:36.239039 [info ] [MainThread]: 
[0m22:05:36.239554 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m22:05:36.240602 [debug] [MainThread]: Command end result
[0m22:05:36.268221 [info ] [MainThread]: 
[0m22:05:36.268849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:36.269351 [info ] [MainThread]: 
[0m22:05:36.269861 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:36.270832 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.431656, "process_user_time": 5.455234, "process_kernel_time": 0.36714, "process_mem_max_rss": "291960", "process_in_blocks": "3808", "process_out_blocks": "114248"}
[0m22:05:36.271485 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:36.271376 after 10.43 seconds
[0m22:05:36.272021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40f265ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40f2c0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40776c290>]}
[0m22:05:36.272511 [debug] [MainThread]: Flushing usage events
[0m22:05:37.872323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5b93f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5b3caf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5b4ad880>]}


============================== 22:05:37.875023 | df95a106-a20f-420f-8647-f057ee438a31 ==============================
[0m22:05:37.875023 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.875790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.015485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df95a106-a20f-420f-8647-f057ee438a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5bea9ac0>]}
[0m22:05:38.032083 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20845532, "process_user_time": 1.379434, "process_kernel_time": 0.123949, "process_mem_max_rss": "92240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:38.032647 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:38.032543 after 0.21 seconds
[0m22:05:38.033086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5d851e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5bea9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5b4a38c0>]}
[0m22:05:38.033511 [debug] [MainThread]: Flushing usage events
[0m06:02:22.493522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f88c3e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8837db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8837c590>]}


============================== 06:02:22.551046 | c23c44a5-58e7-47ef-a9e8-c0525ad5104d ==============================
[0m06:02:22.551046 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.551791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.693889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c23c44a5-58e7-47ef-a9e8-c0525ad5104d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f88b30c80>]}
[0m06:02:22.707492 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o9bfu8tk'
[0m06:02:22.707945 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:22.752198 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:22.752833 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:22.763326 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:22.767223 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:22.812287 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:22.812801 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:22.813310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c23c44a5-58e7-47ef-a9e8-c0525ad5104d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f887acb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f880515b0>]}
[0m06:02:22.813760 [info ] [MainThread]: 
[0m06:02:22.814209 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:22.852906 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40771374, "process_user_time": 1.560249, "process_kernel_time": 0.149557, "process_mem_max_rss": "93548", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:22.853519 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:22.853413 after 0.41 seconds
[0m06:02:22.853959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8b9d3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f880d46b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f883c65a0>]}
[0m06:02:22.854394 [debug] [MainThread]: Flushing usage events
[0m06:02:24.407780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80ca13620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80c7a6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80bc7a5a0>]}


============================== 06:02:24.410549 | 09878d12-7462-4c96-bb2b-38ffd4d9ffb9 ==============================
[0m06:02:24.410549 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.411241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.651427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80cb2a420>]}
[0m06:02:24.710397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc804b55520>]}
[0m06:02:24.712923 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:24.735905 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:24.736620 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:24.737174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80bab8080>]}
[0m06:02:25.964983 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:25.965675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8049306e0>]}
[0m06:02:26.146780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:26.152270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8044e1070>]}
[0m06:02:26.295201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8045f54c0>]}
[0m06:02:26.295767 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:26.296289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8043806b0>]}
[0m06:02:26.298051 [info ] [MainThread]: 
[0m06:02:26.298801 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:26.303708 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:26.339392 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:26.339862 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:26.340260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:26.839877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.841406 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:26.843594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:26.844157 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:26.851335 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.851764 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:26.852156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.858340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.859821 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.860223 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:26.860756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.861148 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.861522 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:26.862138 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.863045 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.863486 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:26.863862 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:26.864419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.864828 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:26.866652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:26.872320 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.872734 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:26.873107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:26.878910 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.879353 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:26.879750 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:26.902875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:26.904404 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:26.905619 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:26.906023 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:26.909532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80baa8b90>]}
[0m06:02:26.910058 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.910457 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.910832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:26.917209 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.917637 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.918032 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.918409 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.918938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.919407 [debug] [MainThread]: On master: Close
[0m06:02:26.920929 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:26.921429 [info ] [MainThread]: 
[0m06:02:26.937285 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:26.937893 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:26.938578 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:26.939018 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:26.965360 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:26.966110 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:27.002298 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:27.003063 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:35.096079 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.096596 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:35.097287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.097741 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.098175 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:35.098886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.101767 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.102223 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:35.102995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.123958 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.124459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.124908 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:35.126783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.131899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:35.132375 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:35.133851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.136229 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:35.167166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fc38f560>]}
[0m06:02:35.167937 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.23s]
[0m06:02:35.168837 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:35.169817 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:35.170380 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:35.171055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:35.171550 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:35.176852 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:35.177521 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:35.211720 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.212240 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241118060235205763"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:35.212726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.227172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.234992 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.235512 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:35.236141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.236593 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.237029 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241118060235205763'
      
      
      order by ordinal_position

  
[0m06:02:35.258196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.264815 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.265305 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.268456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.276232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.276718 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.280171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.298595 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:35.299513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.300063 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241118060235205763"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241118060235205763"
    )
  
[0m06:02:35.338858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.340901 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.341364 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.341793 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.352924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.353872 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:35.506442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09878d12-7462-4c96-bb2b-38ffd4d9ffb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c06fc8f0>]}
[0m06:02:35.507303 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:35.508189 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:35.509627 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.510099 [debug] [MainThread]: On master: BEGIN
[0m06:02:35.510532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:35.517228 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.517705 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.518150 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.518571 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.519167 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.519630 [debug] [MainThread]: On master: Close
[0m06:02:35.521177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:35.521618 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:35.522025 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:35.522485 [info ] [MainThread]: 
[0m06:02:35.523124 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.22 seconds (9.22s).
[0m06:02:35.524278 [debug] [MainThread]: Command end result
[0m06:02:35.552269 [info ] [MainThread]: 
[0m06:02:35.552972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:35.553565 [info ] [MainThread]: 
[0m06:02:35.554167 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:35.555284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.195871, "process_user_time": 5.554115, "process_kernel_time": 0.313859, "process_mem_max_rss": "293888", "process_in_blocks": "3808", "process_out_blocks": "114200"}
[0m06:02:35.555930 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:35.555817 after 11.20 seconds
[0m06:02:35.556427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80c6d95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80bee36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc80c09caa0>]}
[0m06:02:35.556922 [debug] [MainThread]: Flushing usage events
[0m06:02:37.183528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb17c9ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb19fea570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb19eedc10>]}


============================== 06:02:37.186251 | abeede07-9a92-4717-ac65-044df3cfdc4d ==============================
[0m06:02:37.186251 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:37.186979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:37.327634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abeede07-9a92-4717-ac65-044df3cfdc4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb17ad7d40>]}
[0m06:02:37.344479 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2093627, "process_user_time": 1.385932, "process_kernel_time": 0.144201, "process_mem_max_rss": "92124", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:37.345095 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:37.344980 after 0.21 seconds
[0m06:02:37.345538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb19eedc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb17c9ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb19ddbfe0>]}
[0m06:02:37.345974 [debug] [MainThread]: Flushing usage events
[0m14:05:37.010455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1998267230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19980246b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19980244a0>]}


============================== 14:05:37.070617 | f97f1f75-08b9-4b6a-86c7-e590d8433a7f ==============================
[0m14:05:37.070617 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:37.071413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:37.213250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f97f1f75-08b9-4b6a-86c7-e590d8433a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f199905e4b0>]}
[0m14:05:37.226839 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vpdl9nx4'
[0m14:05:37.227308 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:37.280172 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:37.280819 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:37.291666 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:37.295526 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:37.509664 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:37.510253 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:37.510758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f97f1f75-08b9-4b6a-86c7-e590d8433a7f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19980242c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1997f9b9e0>]}
[0m14:05:37.511211 [info ] [MainThread]: 
[0m14:05:37.511660 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:37.534912 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.572876, "process_user_time": 1.636631, "process_kernel_time": 0.088033, "process_mem_max_rss": "93372", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:37.535611 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:37.535506 after 0.57 seconds
[0m14:05:37.536139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1998ff7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f199905e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19992d15b0>]}
[0m14:05:37.536608 [debug] [MainThread]: Flushing usage events
[0m14:05:39.302013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0781f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0921d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec09f3de20>]}


============================== 14:05:39.304786 | 671762fd-21d7-441e-9a67-b0e3b3e4788b ==============================
[0m14:05:39.304786 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:39.305401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:39.538586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec07778170>]}
[0m14:05:39.597715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec07635460>]}
[0m14:05:39.600261 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:39.620868 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:39.621582 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:39.622150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec07679280>]}
[0m14:05:40.853773 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:40.854438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec005f49b0>]}
[0m14:05:41.036013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:41.040996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0050d670>]}
[0m14:05:41.170403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec00592150>]}
[0m14:05:41.170966 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:41.171484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec000455e0>]}
[0m14:05:41.173173 [info ] [MainThread]: 
[0m14:05:41.173839 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:41.178693 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:41.214009 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:41.214449 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:41.214846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:41.789365 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:41.790953 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:41.793061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:41.793617 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:41.800779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.801211 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:41.801601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:41.807742 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.809198 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.809605 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:41.810164 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.810561 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.810935 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:41.811550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.812498 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:41.812913 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.813287 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:41.813844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.814246 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:41.816220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:41.821815 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:41.822223 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:41.822589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:41.828826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.829232 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:41.829621 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:41.852887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.854313 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:41.855516 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:41.855951 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:41.859250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec000d8ef0>]}
[0m14:05:41.859761 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:41.860190 [debug] [MainThread]: On master: BEGIN
[0m14:05:41.860555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:41.866750 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:41.867187 [debug] [MainThread]: On master: COMMIT
[0m14:05:41.867576 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:41.867998 [debug] [MainThread]: On master: COMMIT
[0m14:05:41.868553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:41.868967 [debug] [MainThread]: On master: Close
[0m14:05:41.870269 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:41.870756 [info ] [MainThread]: 
[0m14:05:41.886088 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:41.886693 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:41.887326 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:41.887761 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:41.913844 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:41.914596 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:41.950609 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:41.951341 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:52.932358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:52.932889 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:52.933553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:52.934091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:52.934535 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:52.935289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:52.938216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:52.938673 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:52.939364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:52.960146 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:52.960634 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:52.961079 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:52.962857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:52.967758 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:52.968297 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:52.969764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:52.972075 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:53.002176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec08d4f380>]}
[0m14:05:53.002903 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.11s]
[0m14:05:53.003784 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:53.004790 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:53.005354 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:53.006024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:53.006480 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:53.011487 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:53.012183 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:53.045604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:53.046110 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241118140553039713"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:53.046581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:53.060324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:53.067883 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:53.068371 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:53.069063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:53.069527 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:53.069967 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241118140553039713'
      
      
      order by ordinal_position

  
[0m14:05:53.092226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:53.098504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:53.098994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:53.103436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:53.110955 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:53.111435 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:53.114529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:53.132458 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:53.133166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:53.133634 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241118140553039713"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241118140553039713"
    )
  
[0m14:05:53.167521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:53.169572 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:53.170038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:53.170464 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:53.178839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:53.179762 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:53.358909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '671762fd-21d7-441e-9a67-b0e3b3e4788b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febc042b9e0>]}
[0m14:05:53.359742 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m14:05:53.360531 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:53.362003 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:53.362486 [debug] [MainThread]: On master: BEGIN
[0m14:05:53.362922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:53.369764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:53.370244 [debug] [MainThread]: On master: COMMIT
[0m14:05:53.370683 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:53.371107 [debug] [MainThread]: On master: COMMIT
[0m14:05:53.371699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:53.372194 [debug] [MainThread]: On master: Close
[0m14:05:53.373630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:53.374069 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:53.374470 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:53.374940 [info ] [MainThread]: 
[0m14:05:53.375475 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.20 seconds (12.20s).
[0m14:05:53.376543 [debug] [MainThread]: Command end result
[0m14:05:53.404728 [info ] [MainThread]: 
[0m14:05:53.405362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:53.405868 [info ] [MainThread]: 
[0m14:05:53.406389 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:53.407396 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.153732, "process_user_time": 5.604457, "process_kernel_time": 0.355268, "process_mem_max_rss": "296096", "process_in_blocks": "3808", "process_out_blocks": "115744"}
[0m14:05:53.408071 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:53.407957 after 14.15 seconds
[0m14:05:53.408568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf2d9dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec005f4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec005f76e0>]}
[0m14:05:53.409055 [debug] [MainThread]: Flushing usage events
[0m14:05:55.321100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc20a8acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1fdbc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1f862600>]}


============================== 14:05:55.324019 | 0c26710b-85cc-4bf9-b436-4211b978b720 ==============================
[0m14:05:55.324019 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:55.324961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:55.475652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c26710b-85cc-4bf9-b436-4211b978b720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1f616b40>]}
[0m14:05:55.492378 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23223948, "process_user_time": 1.447716, "process_kernel_time": 0.09998, "process_mem_max_rss": "92128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:55.492957 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:55.492852 after 0.23 seconds
[0m14:05:55.493403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1f88ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc20c49be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2021a1b0>]}
[0m14:05:55.493829 [debug] [MainThread]: Flushing usage events
[0m22:05:50.585483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b1247ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b12bf5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b12085040>]}


============================== 22:05:50.593279 | 04a6d349-3137-40bd-8a7e-7ef2c09aded8 ==============================
[0m22:05:50.593279 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.594013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.736571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04a6d349-3137-40bd-8a7e-7ef2c09aded8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b12548530>]}
[0m22:05:50.750320 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cwyko4nl'
[0m22:05:50.750801 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:50.779873 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:50.780549 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:50.796173 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:50.800180 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:50.974884 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:50.975489 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:50.976054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '04a6d349-3137-40bd-8a7e-7ef2c09aded8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b11801040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b11802030>]}
[0m22:05:50.976539 [info ] [MainThread]: 
[0m22:05:50.977068 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:50.978902 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44162953, "process_user_time": 1.594263, "process_kernel_time": 0.13252, "process_mem_max_rss": "93744", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:05:50.979548 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:50.979439 after 0.44 seconds
[0m22:05:50.980021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b1247f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b1247f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b12548530>]}
[0m22:05:50.980497 [debug] [MainThread]: Flushing usage events
[0m22:05:52.661048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbdf49fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbd8d8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbd7a2870>]}


============================== 22:05:52.664077 | b187c318-7c1d-40b5-98bf-6685ef41604f ==============================
[0m22:05:52.664077 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.664808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.903854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbd453590>]}
[0m22:05:52.963632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbd4797c0>]}
[0m22:05:52.966258 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:52.982378 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:52.983098 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:52.983636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbd4bc230>]}
[0m22:05:54.212155 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:54.212840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb6468800>]}
[0m22:05:54.399016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:54.404288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb63cdbb0>]}
[0m22:05:54.528987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb5e11250>]}
[0m22:05:54.529573 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:54.530050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb5eda420>]}
[0m22:05:54.531724 [info ] [MainThread]: 
[0m22:05:54.532400 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:54.537332 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:54.572969 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:54.573452 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:54.573851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.036439 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.038054 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:55.040234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:55.040797 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:55.047960 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.048392 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:55.048784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.055313 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.056831 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.057267 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:55.057872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.058273 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.058651 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:55.059224 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.060140 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.060541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.060913 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.061495 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.061905 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:55.064118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:55.069903 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.070367 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:55.070748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.076502 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.076914 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.077352 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:55.100666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.102151 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:55.103396 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:55.103802 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:55.107064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb5e941a0>]}
[0m22:05:55.107580 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.107977 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.108358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:55.114867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.115317 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.115715 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.116098 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.116688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.117134 [debug] [MainThread]: On master: Close
[0m22:05:55.118776 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:55.119292 [info ] [MainThread]: 
[0m22:05:55.129396 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:55.130005 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:55.130664 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:55.131106 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:55.157163 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:55.157912 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:55.193620 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:55.194352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:03.238345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.238878 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:03.239529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.239999 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.240437 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:03.241174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.244063 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.244528 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:03.245253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.266248 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:03.266729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.267175 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:03.268530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.273472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.273944 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:03.275180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.277525 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:03.310404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd737cad80>]}
[0m22:06:03.311257 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.18s]
[0m22:06:03.312050 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:03.313089 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:03.313664 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:03.314278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:03.314738 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:03.320140 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:03.320807 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:03.355154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.355748 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241118220603349084"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:03.356224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:03.371726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.379604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.380077 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:03.380695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.381165 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.381604 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241118220603349084'
      
      
      order by ordinal_position

  
[0m22:06:03.402819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.409192 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.409682 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.412593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.420164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.420643 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.423763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.441772 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:03.442470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.442947 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241118220603349084"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241118220603349084"
    )
  
[0m22:06:03.476457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.478519 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.478981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.479410 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.487884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.488832 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:03.654260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b187c318-7c1d-40b5-98bf-6685ef41604f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbd4531a0>]}
[0m22:06:03.655091 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:06:03.655861 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:03.657333 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.657871 [debug] [MainThread]: On master: BEGIN
[0m22:06:03.658310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:03.665152 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.665632 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.666083 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.666509 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.667083 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.667544 [debug] [MainThread]: On master: Close
[0m22:06:03.668982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:03.669461 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:03.669865 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:03.670327 [info ] [MainThread]: 
[0m22:06:03.670851 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.14 seconds (9.14s).
[0m22:06:03.671852 [debug] [MainThread]: Command end result
[0m22:06:03.699636 [info ] [MainThread]: 
[0m22:06:03.700250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:03.700760 [info ] [MainThread]: 
[0m22:06:03.701299 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:03.702284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.097561, "process_user_time": 5.547056, "process_kernel_time": 0.283135, "process_mem_max_rss": "286572", "process_in_blocks": "3808", "process_out_blocks": "114744"}
[0m22:06:03.702936 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:03.702827 after 11.10 seconds
[0m22:06:03.703426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbdf48860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb5f74c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdbdbfc140>]}
[0m22:06:03.703908 [debug] [MainThread]: Flushing usage events
[0m22:06:05.463205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175fd155b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175ed72c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175ed71a90>]}


============================== 22:06:05.466007 | a9737659-7f46-4a3a-a685-36c490a92bd7 ==============================
[0m22:06:05.466007 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.466730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:05.608831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9737659-7f46-4a3a-a685-36c490a92bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e1fd340>]}
[0m22:06:05.625886 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21111153, "process_user_time": 1.422407, "process_kernel_time": 0.111874, "process_mem_max_rss": "92252", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:05.626477 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:05.626373 after 0.21 seconds
[0m22:06:05.626925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175fd155b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175ed71c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175e1fc2f0>]}
[0m22:06:05.627363 [debug] [MainThread]: Flushing usage events
[0m06:02:09.022635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a02965370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a013cec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a01a6cc20>]}


============================== 06:02:09.030248 | 3e8f115b-a634-4534-a037-6a9162177de6 ==============================
[0m06:02:09.030248 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.030956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.175744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e8f115b-a634-4534-a037-6a9162177de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a016ada30>]}
[0m06:02:09.189508 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3ofy5z4m'
[0m06:02:09.189995 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:09.372593 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:09.373370 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:09.446206 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:09.450179 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:09.604239 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:09.604788 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:09.605320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3e8f115b-a634-4534-a037-6a9162177de6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a021491c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a0214aae0>]}
[0m06:02:09.605794 [info ] [MainThread]: 
[0m06:02:09.606277 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:09.608235 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.63440126, "process_user_time": 1.567696, "process_kernel_time": 0.131304, "process_mem_max_rss": "93564", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:09.608830 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:09.608727 after 0.64 seconds
[0m06:02:09.609271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a0153bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a01bc9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a01a6cc20>]}
[0m06:02:09.609717 [debug] [MainThread]: Flushing usage events
[0m06:02:11.217925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c1135580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf821790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf633ec0>]}


============================== 06:02:11.220711 | 9c42b6ec-06c4-4a7d-9644-0cde8e83bb87 ==============================
[0m06:02:11.220711 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.221444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.456891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b878c1a0>]}
[0m06:02:11.515654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bfcce990>]}
[0m06:02:11.518184 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:11.534377 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:11.535140 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:11.535694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b8633d70>]}
[0m06:02:12.765133 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:12.765832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b817c8c0>]}
[0m06:02:12.945517 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:12.950671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b3f59640>]}
[0m06:02:13.103090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b3f23500>]}
[0m06:02:13.103647 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:13.104180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b3fd32c0>]}
[0m06:02:13.105888 [info ] [MainThread]: 
[0m06:02:13.106659 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:13.111491 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:13.147650 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:13.148160 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:13.148567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:13.662571 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:13.664110 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:13.666086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:13.666694 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:13.673788 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.674227 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:13.674680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.680832 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.682239 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.682677 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:13.683222 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.683622 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.684004 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:13.684568 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.685486 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.685901 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.686285 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.686870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.687289 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:13.689152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:13.694667 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.695078 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:13.695450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.701194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.701643 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.702036 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:13.725338 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.726787 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:13.727987 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:13.728392 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:13.731729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b2db35c0>]}
[0m06:02:13.732264 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.732663 [debug] [MainThread]: On master: BEGIN
[0m06:02:13.733038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:13.739141 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.739560 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.739959 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.740338 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.740925 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.741335 [debug] [MainThread]: On master: Close
[0m06:02:13.742848 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:13.743388 [info ] [MainThread]: 
[0m06:02:13.753133 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:13.753729 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:13.754459 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:13.754945 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:13.781006 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:13.781768 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:13.817965 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:13.818729 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:21.006159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.006877 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:21.007596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.008107 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.008630 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:21.009445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.012839 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.013294 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:21.013971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.034784 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.035270 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.035721 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.038207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.043172 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.043639 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:21.046033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.048513 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:21.078964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1799369c0>]}
[0m06:02:21.079774 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.32s]
[0m06:02:21.080558 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:21.081561 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:21.082125 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:21.082726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:21.083184 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:21.088544 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:21.089208 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:21.123420 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.123924 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241119060221117515"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:21.124407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:21.144971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.155084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.155695 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:21.156557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.157112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.157738 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241119060221117515'
      
      
      order by ordinal_position

  
[0m06:02:21.185206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.191525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.192011 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.194725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.202151 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.202652 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.205335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.223407 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.224101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.224571 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241119060221117515"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241119060221117515"
    )
  
[0m06:02:21.256814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.258889 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.259368 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.259807 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.269854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.270787 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.450727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c42b6ec-06c4-4a7d-9644-0cde8e83bb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17878d4f0>]}
[0m06:02:21.451586 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:21.452527 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.454042 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.454567 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.455018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.461853 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.462331 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.462816 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.463246 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.463819 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.464280 [debug] [MainThread]: On master: Close
[0m06:02:21.465820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.466259 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.466714 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.467195 [info ] [MainThread]: 
[0m06:02:21.467729 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m06:02:21.468732 [debug] [MainThread]: Command end result
[0m06:02:21.496574 [info ] [MainThread]: 
[0m06:02:21.497192 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.497696 [info ] [MainThread]: 
[0m06:02:21.498205 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.499220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.32929, "process_user_time": 5.577959, "process_kernel_time": 0.384277, "process_mem_max_rss": "292568", "process_in_blocks": "3808", "process_out_blocks": "114720"}
[0m06:02:21.499862 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.499752 after 10.33 seconds
[0m06:02:21.500353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf613b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b80fc560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b81a72c0>]}
[0m06:02:21.500853 [debug] [MainThread]: Flushing usage events
[0m06:02:23.189569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78e339490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78ba632f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78ba631d0>]}


============================== 06:02:23.192511 | fc383d79-9dce-4c66-9734-d8f163519e34 ==============================
[0m06:02:23.192511 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.193258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.333145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc383d79-9dce-4c66-9734-d8f163519e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78bfcf0b0>]}
[0m06:02:23.349748 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20848872, "process_user_time": 1.42267, "process_kernel_time": 0.079925, "process_mem_max_rss": "92268", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:23.350325 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:23.350223 after 0.21 seconds
[0m06:02:23.350801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78deedf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78bb3b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78bfcf0b0>]}
[0m06:02:23.351232 [debug] [MainThread]: Flushing usage events
[0m14:05:46.132536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeaf22d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb0cedca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeaedda600>]}


============================== 14:05:46.144640 | b1a2cf65-dbad-4a97-b6b2-1fdf4e08f2bb ==============================
[0m14:05:46.144640 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:46.145329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.283987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1a2cf65-dbad-4a97-b6b2-1fdf4e08f2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeae8b7aa0>]}
[0m14:05:46.297552 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fhgyaii9'
[0m14:05:46.298007 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:46.367106 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:46.367815 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:46.380250 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:46.384130 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:46.433983 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:46.434517 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:46.435016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b1a2cf65-dbad-4a97-b6b2-1fdf4e08f2bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeae71c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeae864920>]}
[0m14:05:46.435490 [info ] [MainThread]: 
[0m14:05:46.435944 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:46.437575 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35311213, "process_user_time": 1.55431, "process_kernel_time": 0.143107, "process_mem_max_rss": "93804", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:46.438171 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:46.438068 after 0.35 seconds
[0m14:05:46.438611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeaf438b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeaf329c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeae8b7aa0>]}
[0m14:05:46.439039 [debug] [MainThread]: Flushing usage events
[0m14:05:48.003718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd1c156a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd13e4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd0fbd070>]}


============================== 14:05:48.006474 | 879b98a9-549b-46a6-b491-95b358cc580f ==============================
[0m14:05:48.006474 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:48.007184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:48.243421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd01782c0>]}
[0m14:05:48.302950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd18a4f80>]}
[0m14:05:48.305569 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:48.337716 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:48.338454 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:48.338990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd01fc080>]}
[0m14:05:49.566927 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:49.567581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc9048230>]}
[0m14:05:49.749810 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:49.754998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd04036e0>]}
[0m14:05:49.901449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc8f8cc80>]}
[0m14:05:49.902016 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:49.902504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc8a06240>]}
[0m14:05:49.904188 [info ] [MainThread]: 
[0m14:05:49.904903 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:49.909745 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:49.945481 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:49.945962 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:49.946368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:50.535539 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:50.537144 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:50.539208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:50.539809 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:50.547018 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:50.547460 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:50.547855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:50.554142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.555637 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:50.556041 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:50.556581 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.557016 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:50.557399 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:50.558025 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.558948 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:50.559351 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:50.559731 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:50.560292 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.560700 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:50.562828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:50.568522 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:50.568975 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:50.569371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:50.575283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.575702 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:50.576104 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:50.600965 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.602435 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:50.603653 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:50.604063 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:50.607444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc8ad5160>]}
[0m14:05:50.607976 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.608368 [debug] [MainThread]: On master: BEGIN
[0m14:05:50.608763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:50.615028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.615453 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.615840 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.616219 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.616827 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.617234 [debug] [MainThread]: On master: Close
[0m14:05:50.618613 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:50.619149 [info ] [MainThread]: 
[0m14:05:50.652254 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:50.652886 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:50.653622 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:50.654065 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:50.679982 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:50.680783 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:50.716570 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:50.717356 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:58.063789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.064321 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:58.065098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.065560 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.065996 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:58.066801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.069837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.070303 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:58.071008 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.091915 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:58.092405 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.092883 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:58.094115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.099106 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.099577 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:58.100784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.103118 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:58.132919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd0d02480>]}
[0m14:05:58.133683 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.48s]
[0m14:05:58.134471 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:58.135449 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:58.136007 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:58.136620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:58.137106 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:58.142351 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:58.143038 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:58.176771 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.177281 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241119140558170822"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:58.177754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:58.192616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.200293 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.200793 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:58.201405 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.201852 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.202291 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241119140558170822'
      
      
      order by ordinal_position

  
[0m14:05:58.223221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.229647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.230138 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:58.233328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.241341 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.242105 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:58.246594 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.264905 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:58.265642 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.266122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241119140558170822"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241119140558170822"
    )
  
[0m14:05:58.302319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.304355 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:58.304839 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.305276 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:58.313757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.314704 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:58.498661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879b98a9-549b-46a6-b491-95b358cc580f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8941bd70>]}
[0m14:05:58.499500 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:58.500272 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:58.501815 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:58.502315 [debug] [MainThread]: On master: BEGIN
[0m14:05:58.502742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:58.509613 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:58.510096 [debug] [MainThread]: On master: COMMIT
[0m14:05:58.510530 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:58.510955 [debug] [MainThread]: On master: COMMIT
[0m14:05:58.511604 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:58.512057 [debug] [MainThread]: On master: Close
[0m14:05:58.513677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:58.514125 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:58.514529 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:58.514987 [info ] [MainThread]: 
[0m14:05:58.515520 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m14:05:58.516509 [debug] [MainThread]: Command end result
[0m14:05:58.544626 [info ] [MainThread]: 
[0m14:05:58.545374 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:58.545919 [info ] [MainThread]: 
[0m14:05:58.546456 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:58.547506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.591901, "process_user_time": 5.472654, "process_kernel_time": 0.340538, "process_mem_max_rss": "292344", "process_in_blocks": "3808", "process_out_blocks": "116256"}
[0m14:05:58.548156 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:58.548044 after 10.59 seconds
[0m14:05:58.548666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cd0679bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8945c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c89b070e0>]}
[0m14:05:58.549205 [debug] [MainThread]: Flushing usage events
[0m14:06:00.197865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe149c3df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14935a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14a322b70>]}


============================== 14:06:00.200804 | 477b4cef-6e96-4728-927c-96230284bd84 ==============================
[0m14:06:00.200804 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:00.201536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:00.345751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '477b4cef-6e96-4728-927c-96230284bd84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1492a5580>]}
[0m14:06:00.362364 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21341896, "process_user_time": 1.424265, "process_kernel_time": 0.11202, "process_mem_max_rss": "92172", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:00.362952 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:00.362848 after 0.21 seconds
[0m14:06:00.363392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe149599bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14d1bbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe149275bb0>]}
[0m14:06:00.363830 [debug] [MainThread]: Flushing usage events
[0m22:05:49.798470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272c9aed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272a8733b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272a875d90>]}


============================== 22:05:49.806882 | 342ed839-282d-4a19-a431-747a0a5a4fa4 ==============================
[0m22:05:49.806882 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:49.807644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:49.978776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '342ed839-282d-4a19-a431-747a0a5a4fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272b592ab0>]}
[0m22:05:49.995626 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3s5og9b2'
[0m22:05:49.996218 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:50.058199 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:50.059088 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:50.082332 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:50.086637 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:50.159668 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:50.160263 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:50.160833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '342ed839-282d-4a19-a431-747a0a5a4fa4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272a5e8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272a6dc6e0>]}
[0m22:05:50.161375 [info ] [MainThread]: 
[0m22:05:50.161864 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:50.163610 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41625702, "process_user_time": 1.71275, "process_kernel_time": 0.116595, "process_mem_max_rss": "93756", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:50.164269 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:50.164159 after 0.42 seconds
[0m22:05:50.164735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272b057590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272a5e8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f272a875d90>]}
[0m22:05:50.165235 [debug] [MainThread]: Flushing usage events
[0m22:05:51.920513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c37422a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c13ee0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c36cbd10>]}


============================== 22:05:51.924142 | 7f00014e-273d-497b-aed7-37d8baeea1fe ==============================
[0m22:05:51.924142 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:51.925049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.202594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ba370ec0>]}
[0m22:05:52.268566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c12aeff0>]}
[0m22:05:52.271466 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:52.303732 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:52.304550 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:52.305152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ba370bc0>]}
[0m22:05:53.571825 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:53.572629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c257f530>]}
[0m22:05:53.784958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:53.790804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b9df5280>]}
[0m22:05:53.949617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b9d8e360>]}
[0m22:05:53.950308 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:53.950872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b9b8f980>]}
[0m22:05:53.952712 [info ] [MainThread]: 
[0m22:05:53.953494 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:53.958617 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:53.995270 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:53.995784 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:53.996200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:54.626641 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:54.628248 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:54.630554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:54.631130 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:54.638408 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:54.638872 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:54.639265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:54.646192 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:54.647922 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:54.648348 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:54.649028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:54.649434 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:54.649837 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:54.650441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:54.651418 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:54.651821 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:54.652200 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:54.652743 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:54.653201 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:54.656082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:54.662435 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:54.662953 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:54.663377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:54.670082 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:54.670598 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:54.671046 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:54.694754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:54.696536 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:54.697865 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:54.698286 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:54.702434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b89a2690>]}
[0m22:05:54.703011 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:54.703408 [debug] [MainThread]: On master: BEGIN
[0m22:05:54.703780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:54.710896 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:54.711429 [debug] [MainThread]: On master: COMMIT
[0m22:05:54.711827 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:54.712207 [debug] [MainThread]: On master: COMMIT
[0m22:05:54.712744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:54.713197 [debug] [MainThread]: On master: Close
[0m22:05:54.715091 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:54.715611 [info ] [MainThread]: 
[0m22:05:54.727195 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:54.727853 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:54.728563 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:54.729041 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:54.755708 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:54.756638 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:54.793958 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:54.794875 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:02.989132 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.989668 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:02.990365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.990828 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.991277 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:02.992020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.995084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.995540 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:02.996260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.017452 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:03.018003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.018453 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:03.019824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.025098 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.025576 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:03.027130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.029623 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:03.060915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ba278830>]}
[0m22:06:03.061783 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.33s]
[0m22:06:03.062600 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:03.063629 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:03.064227 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:03.064838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:03.065326 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:03.070752 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:03.071414 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:03.106449 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.107057 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241119220603100256"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:03.107555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:03.124048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.132583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.133175 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:03.133921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.134385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.134829 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241119220603100256'
      
      
      order by ordinal_position

  
[0m22:06:03.156404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.164045 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.164631 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.168060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.176443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.176995 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.180449 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.199375 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:03.200223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.200736 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241119220603100256"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241119220603100256"
    )
  
[0m22:06:03.237407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.239486 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.239996 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.240442 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.249704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.250794 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:03.431413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f00014e-273d-497b-aed7-37d8baeea1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd57e4fe4b0>]}
[0m22:06:03.432266 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:03.433064 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:03.434513 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.435004 [debug] [MainThread]: On master: BEGIN
[0m22:06:03.435449 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:03.442566 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.443110 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.443558 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.443987 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.444597 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.445106 [debug] [MainThread]: On master: Close
[0m22:06:03.446972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:03.447416 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:03.447821 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:03.448296 [info ] [MainThread]: 
[0m22:06:03.448921 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m22:06:03.450094 [debug] [MainThread]: Command end result
[0m22:06:03.479108 [info ] [MainThread]: 
[0m22:06:03.479885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:03.480492 [info ] [MainThread]: 
[0m22:06:03.481110 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:03.482254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.614889, "process_user_time": 5.967328, "process_kernel_time": 0.352669, "process_mem_max_rss": "301416", "process_in_blocks": "3808", "process_out_blocks": "115776"}
[0m22:06:03.482906 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:03.482794 after 11.62 seconds
[0m22:06:03.483407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c16efda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd57ef07bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd57e4d13d0>]}
[0m22:06:03.483899 [debug] [MainThread]: Flushing usage events
[0m22:06:05.361053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03cb3155b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03c9a9cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03c9aff590>]}


============================== 22:06:05.364247 | 95d6a6a5-4a4b-4eb8-8617-2cb1b10ac680 ==============================
[0m22:06:05.364247 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.364952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:05.529798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95d6a6a5-4a4b-4eb8-8617-2cb1b10ac680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03c9a33020>]}
[0m22:06:05.547823 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23746563, "process_user_time": 1.530575, "process_kernel_time": 0.119888, "process_mem_max_rss": "92096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:05.548480 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:05.548351 after 0.24 seconds
[0m22:06:05.548986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03cb3155b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03cac5b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03c9acebd0>]}
[0m22:06:05.549450 [debug] [MainThread]: Flushing usage events
[0m06:02:23.255067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9156183e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe914c59dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe913ebfda0>]}


============================== 06:02:23.282062 | 774b5d84-5880-4536-9f22-2ccdfbd2b021 ==============================
[0m06:02:23.282062 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.282737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.426062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '774b5d84-5880-4536-9f22-2ccdfbd2b021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9142a9640>]}
[0m06:02:23.440042 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8inhpvot'
[0m06:02:23.440525 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:23.476333 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:23.477016 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:23.489293 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:23.493245 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:23.651946 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:23.652532 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:23.653091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '774b5d84-5880-4536-9f22-2ccdfbd2b021', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe913d0a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe913af3e00>]}
[0m06:02:23.653553 [info ] [MainThread]: 
[0m06:02:23.654075 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:23.670521 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4644692, "process_user_time": 1.596013, "process_kernel_time": 0.128001, "process_mem_max_rss": "93768", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:23.671161 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:23.671056 after 0.47 seconds
[0m06:02:23.671604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe914290d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9142a9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe913ebb980>]}
[0m06:02:23.672039 [debug] [MainThread]: Flushing usage events
[0m06:02:25.315649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d15088590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d151f4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d151f5010>]}


============================== 06:02:25.318723 | f1a42d80-1ead-4d55-abf8-fb5076e1a12d ==============================
[0m06:02:25.318723 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.319453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.568881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1473ff20>]}
[0m06:02:25.629648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d14d46300>]}
[0m06:02:25.632315 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:25.653727 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:25.654553 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:25.655108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d14048f20>]}
[0m06:02:26.920709 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:26.921397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0cc801d0>]}
[0m06:02:27.105057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:27.110568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0ca31be0>]}
[0m06:02:27.260414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0cc98c50>]}
[0m06:02:27.261009 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:27.261534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0ca30770>]}
[0m06:02:27.263299 [info ] [MainThread]: 
[0m06:02:27.264019 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:27.269085 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:27.305513 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:27.306032 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:27.306451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:27.811241 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:27.812831 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:27.815234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:27.815838 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:27.823201 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:27.823671 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:27.824078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:27.830650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.832254 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:27.832676 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:27.833250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.833661 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:27.834088 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:27.834732 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.835693 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:27.836105 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:27.836486 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:27.837069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.837488 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:27.840013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:27.846108 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:27.846540 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:27.846932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:27.853305 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.853748 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:27.854195 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:27.877773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.879509 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:27.880812 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:27.881240 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:27.885291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0ca31130>]}
[0m06:02:27.885830 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.886274 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.886656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:27.893243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.893708 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.894164 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.894563 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.895127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.895547 [debug] [MainThread]: On master: Close
[0m06:02:27.897400 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:27.897967 [info ] [MainThread]: 
[0m06:02:27.938363 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:27.939081 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:27.939808 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:27.940261 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:27.966601 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:27.967407 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:28.003645 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:28.004444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:39.678749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.679278 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:39.679925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.680389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.680843 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:39.681570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.684491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.684957 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:39.685641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.706663 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:39.707165 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.707604 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:39.709592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.714641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.715120 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:39.716496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.718866 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:39.750829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0ca83050>]}
[0m06:02:39.751573 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.81s]
[0m06:02:39.752334 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:39.753340 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:39.753901 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:39.754517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:39.754991 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:39.760184 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:39.760843 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:39.794774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.795298 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241120060239788804"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:39.795779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:39.810309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.817908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.818413 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:39.819030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.819480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.819921 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241120060239788804'
      
      
      order by ordinal_position

  
[0m06:02:39.840871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.847270 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.847757 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:39.852090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.859700 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.860180 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:39.863482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.882809 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:39.883526 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.884001 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241120060239788804"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241120060239788804"
    )
  
[0m06:02:39.917284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.919385 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:39.919884 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.920329 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:39.929343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.930321 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:40.112285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1a42d80-1ead-4d55-abf8-fb5076e1a12d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ccd382360>]}
[0m06:02:40.113145 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:40.113970 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:40.115540 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.116029 [debug] [MainThread]: On master: BEGIN
[0m06:02:40.116464 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:40.123429 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.123917 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.124356 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.124785 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.125396 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.125869 [debug] [MainThread]: On master: Close
[0m06:02:40.127866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:40.128308 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:40.128720 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:40.129197 [info ] [MainThread]: 
[0m06:02:40.129788 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.87 seconds (12.87s).
[0m06:02:40.131004 [debug] [MainThread]: Command end result
[0m06:02:40.159905 [info ] [MainThread]: 
[0m06:02:40.160687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:40.161293 [info ] [MainThread]: 
[0m06:02:40.161910 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:40.163086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.89672, "process_user_time": 5.714621, "process_kernel_time": 0.308573, "process_mem_max_rss": "298400", "process_in_blocks": "3808", "process_out_blocks": "116264"}
[0m06:02:40.163755 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:40.163642 after 14.90 seconds
[0m06:02:40.164280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d15088590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cfcf5d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0ccfe7b0>]}
[0m06:02:40.164776 [debug] [MainThread]: Flushing usage events
[0m06:02:41.899646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04fc86fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04fe791e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04fc71bd70>]}


============================== 06:02:41.902621 | cfc6b2f6-3743-4877-9ee8-cb9c85b0915a ==============================
[0m06:02:41.902621 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:41.903299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:42.051308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfc6b2f6-3743-4877-9ee8-cb9c85b0915a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ff713470>]}
[0m06:02:42.068026 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2172563, "process_user_time": 1.433176, "process_kernel_time": 0.100082, "process_mem_max_rss": "92260", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:42.068612 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:42.068510 after 0.22 seconds
[0m06:02:42.069050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04fc86fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04fc2a4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04fc2fb230>]}
[0m06:02:42.069490 [debug] [MainThread]: Flushing usage events
[0m14:05:32.369741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4e25db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4e111e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4bd75dc0>]}


============================== 14:05:32.376888 | 10155c4b-aa5f-43e7-8fa6-ce8a0fcd8acd ==============================
[0m14:05:32.376888 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.377550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.512854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10155c4b-aa5f-43e7-8fa6-ce8a0fcd8acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4bdbd4c0>]}
[0m14:05:32.526392 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o9ngfjbj'
[0m14:05:32.526843 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:32.558242 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:32.558928 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:32.569882 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:32.573714 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:32.786264 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:32.786846 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:32.787380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '10155c4b-aa5f-43e7-8fa6-ce8a0fcd8acd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4baf7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4baf77a0>]}
[0m14:05:32.787837 [info ] [MainThread]: 
[0m14:05:32.788321 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:32.789815 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46760705, "process_user_time": 1.604834, "process_kernel_time": 0.156081, "process_mem_max_rss": "93520", "process_in_blocks": "6304", "process_out_blocks": "3992"}
[0m14:05:32.790440 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:32.790335 after 0.47 seconds
[0m14:05:32.790889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4bb63bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4bbdfa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4bbdf320>]}
[0m14:05:32.791315 [debug] [MainThread]: Flushing usage events
[0m14:05:34.633577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af27cbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af46f17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af46f1df0>]}


============================== 14:05:34.636338 | 777c716d-9d26-4c24-92c4-a9404d6b2279 ==============================
[0m14:05:34.636338 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:34.636984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:34.867377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af2095580>]}
[0m14:05:34.926278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af2fe08f0>]}
[0m14:05:34.928688 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:34.944551 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:34.945265 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:34.945808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aeb14ab40>]}
[0m14:05:36.170312 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:36.170958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aeafa79e0>]}
[0m14:05:36.350928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:36.355881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aeaf8e9c0>]}
[0m14:05:36.494845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aeaf8cef0>]}
[0m14:05:36.495390 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:36.495904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aeaa06180>]}
[0m14:05:36.497534 [info ] [MainThread]: 
[0m14:05:36.498241 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:36.503051 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:36.538015 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:36.538565 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:36.538970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:37.029434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.030999 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:37.033182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:37.033751 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:37.040834 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:37.041266 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:37.041661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:37.047738 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.049139 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:37.049540 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:37.050072 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.050513 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:37.050888 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:37.051482 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.052389 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:37.052797 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:37.053175 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:37.053706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.054107 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:37.055943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:37.061438 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:37.061854 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:37.062260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:37.067983 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.068392 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:37.068786 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:37.091877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.093287 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:37.094516 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:37.094920 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:37.098003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aeaa05130>]}
[0m14:05:37.098569 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:37.098964 [debug] [MainThread]: On master: BEGIN
[0m14:05:37.099329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:37.105313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:37.105728 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.106120 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:37.106537 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.107126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:37.107528 [debug] [MainThread]: On master: Close
[0m14:05:37.108966 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:37.109469 [info ] [MainThread]: 
[0m14:05:37.119024 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:37.119628 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:37.120253 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:37.120691 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:37.146688 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:37.147430 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:37.183492 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:37.184241 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:47.040443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.040949 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:47.041565 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.042017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.042490 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:47.043234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.046057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.046544 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:47.047212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.068136 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:47.068618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.069060 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:47.070227 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.075115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.075581 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:47.076769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.079082 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:47.108433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ae97533b0>]}
[0m14:05:47.109136 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.99s]
[0m14:05:47.109902 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:47.110867 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:47.111427 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:47.111990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:47.112442 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:47.117380 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:47.118017 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:47.151776 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.152292 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241120140547145797"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:47.152773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:47.167392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.174767 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.175233 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:47.175854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.176300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.176733 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241120140547145797'
      
      
      order by ordinal_position

  
[0m14:05:47.197227 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.203372 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.203854 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:47.208087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.215781 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.216259 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:47.218959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.236740 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:47.237440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.237915 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241120140547145797"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241120140547145797"
    )
  
[0m14:05:47.273370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.275424 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:47.275885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.276313 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:47.285068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.285958 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:47.476022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '777c716d-9d26-4c24-92c4-a9404d6b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa73fc3b0>]}
[0m14:05:47.476829 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:47.477575 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:47.479187 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:47.479661 [debug] [MainThread]: On master: BEGIN
[0m14:05:47.480092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:47.486692 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:47.487166 [debug] [MainThread]: On master: COMMIT
[0m14:05:47.487599 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:47.488016 [debug] [MainThread]: On master: COMMIT
[0m14:05:47.488590 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:47.489041 [debug] [MainThread]: On master: Close
[0m14:05:47.490497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:47.490934 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:47.491337 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:47.491797 [info ] [MainThread]: 
[0m14:05:47.492309 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.99 seconds (10.99s).
[0m14:05:47.493306 [debug] [MainThread]: Command end result
[0m14:05:47.520849 [info ] [MainThread]: 
[0m14:05:47.521474 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:47.521979 [info ] [MainThread]: 
[0m14:05:47.522541 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:47.523528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.937942, "process_user_time": 5.587804, "process_kernel_time": 0.25526, "process_mem_max_rss": "292740", "process_in_blocks": "3808", "process_out_blocks": "116768"}
[0m14:05:47.524172 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:47.524062 after 12.94 seconds
[0m14:05:47.524660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af272bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa755ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5af27f4a70>]}
[0m14:05:47.525139 [debug] [MainThread]: Flushing usage events
[0m14:05:49.387192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699ceab650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699c363fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699c9cef30>]}


============================== 14:05:49.389911 | 087fe1fa-b1b9-460a-b4a2-75d90a528835 ==============================
[0m14:05:49.389911 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:49.390592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:49.529541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '087fe1fa-b1b9-460a-b4a2-75d90a528835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699bee1fa0>]}
[0m14:05:49.545693 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20715357, "process_user_time": 1.386003, "process_kernel_time": 0.108156, "process_mem_max_rss": "92264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:49.546305 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:49.546155 after 0.21 seconds
[0m14:05:49.546742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699b9a5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699efb4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699bd2c5c0>]}
[0m14:05:49.547168 [debug] [MainThread]: Flushing usage events
[0m22:05:41.258383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d555db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d4b458e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d2bbef30>]}


============================== 22:05:41.277274 | ea685378-bd80-4757-b5ed-e07f42255c4a ==============================
[0m22:05:41.277274 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:41.277933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.420235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea685378-bd80-4757-b5ed-e07f42255c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d25f40b0>]}
[0m22:05:41.433482 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v8yn8owy'
[0m22:05:41.433927 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:41.446256 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:41.446854 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:41.456844 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:41.460706 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:41.672419 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:41.672980 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:41.673513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ea685378-bd80-4757-b5ed-e07f42255c4a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d2bbef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d3701790>]}
[0m22:05:41.673971 [info ] [MainThread]: 
[0m22:05:41.674445 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:41.702558 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.492113, "process_user_time": 1.554876, "process_kernel_time": 0.15189, "process_mem_max_rss": "93872", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:41.703174 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:41.703068 after 0.49 seconds
[0m22:05:41.703617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d3425670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d25f5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25d26477a0>]}
[0m22:05:41.704099 [debug] [MainThread]: Flushing usage events
[0m22:05:43.538703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6132707770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61326d6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61326d6ae0>]}


============================== 22:05:43.541730 | 162ebec9-2a4c-448b-91dc-1c51530226da ==============================
[0m22:05:43.541730 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:43.542480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:43.782976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61324f78f0>]}
[0m22:05:43.842671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613264d070>]}
[0m22:05:43.845358 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:43.875099 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:43.875921 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:43.876482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612b573140>]}
[0m22:05:45.108968 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:45.109641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612b3d3470>]}
[0m22:05:45.292937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:45.298252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612afcb080>]}
[0m22:05:45.441927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612aff9df0>]}
[0m22:05:45.442493 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:45.442982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612ad97980>]}
[0m22:05:45.444697 [info ] [MainThread]: 
[0m22:05:45.445397 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:45.450129 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:45.485146 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:45.485590 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:45.485989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:45.940940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:45.942500 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:45.944768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:45.945351 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:45.952578 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:45.953016 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:45.953407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:45.959616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:45.961100 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:45.961505 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:45.962037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:45.962431 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:45.962806 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:45.963367 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:45.964319 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:45.964732 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:45.965109 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:45.965677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:45.966085 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:45.967920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:45.973635 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:45.974048 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:45.974435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:45.980200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:45.980605 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:45.980996 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:46.002740 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.004208 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:46.005413 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:46.005817 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:46.009113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6133ba9100>]}
[0m22:05:46.009615 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.010005 [debug] [MainThread]: On master: BEGIN
[0m22:05:46.010378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:46.016585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.017009 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.017397 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.017771 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.018293 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.018695 [debug] [MainThread]: On master: Close
[0m22:05:46.020074 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:46.020608 [info ] [MainThread]: 
[0m22:05:46.055729 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:46.056397 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:46.057150 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:46.057595 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:46.083438 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:46.084261 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:46.119973 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:46.120730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:54.462812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.463384 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:54.464162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.464644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.465095 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:54.465873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.469018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.469481 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:54.470236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.491278 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:54.491813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.492270 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:54.493686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.498817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.499297 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:54.501150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.503569 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:54.534681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ebb3f9e0>]}
[0m22:05:54.535406 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.48s]
[0m22:05:54.536219 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:54.537211 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:54.537790 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:54.538401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:54.538856 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:54.544055 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:54.544724 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:54.578685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.579222 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241120220554572698"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:54.579712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:54.594907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.602609 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.603092 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:54.603705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.604197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.604639 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241120220554572698'
      
      
      order by ordinal_position

  
[0m22:05:54.625408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.631902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.632405 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:54.635503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.643422 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.643948 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:54.646923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.665790 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:54.666628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.667136 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241120220554572698"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241120220554572698"
    )
  
[0m22:05:54.707105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.709176 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:54.709645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.710081 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:54.720391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.721451 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:55.292268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '162ebec9-2a4c-448b-91dc-1c51530226da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60eb444650>]}
[0m22:05:55.293078 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.75s]
[0m22:05:55.293811 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:55.295205 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.295703 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.296199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:55.302805 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.303296 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.303734 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.304234 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.304822 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.305277 [debug] [MainThread]: On master: Close
[0m22:05:55.306797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:55.307229 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:55.307640 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:55.308176 [info ] [MainThread]: 
[0m22:05:55.308775 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.86 seconds (9.86s).
[0m22:05:55.309918 [debug] [MainThread]: Command end result
[0m22:05:55.338035 [info ] [MainThread]: 
[0m22:05:55.338733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:55.339332 [info ] [MainThread]: 
[0m22:05:55.339965 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:55.341072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.851291, "process_user_time": 5.859489, "process_kernel_time": 0.35125, "process_mem_max_rss": "346512", "process_in_blocks": "3808", "process_out_blocks": "128064"}
[0m22:05:55.341715 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:55.341604 after 11.85 seconds
[0m22:05:55.342209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612ae508f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612afab2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612afa9fa0>]}
[0m22:05:55.342697 [debug] [MainThread]: Flushing usage events
[0m22:05:57.233831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959a3c9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9599ec6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959a3c9e50>]}


============================== 22:05:57.236734 | 5665dabb-4d4f-44d3-aac9-5f550ef6246f ==============================
[0m22:05:57.236734 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:57.237377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.416512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5665dabb-4d4f-44d3-aac9-5f550ef6246f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959a7cc5c0>]}
[0m22:05:57.433364 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.24778157, "process_user_time": 1.432803, "process_kernel_time": 0.10806, "process_mem_max_rss": "92228", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:57.433973 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:57.433869 after 0.25 seconds
[0m22:05:57.434418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959a3c9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959987a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959987b050>]}
[0m22:05:57.434861 [debug] [MainThread]: Flushing usage events
[0m06:02:09.377988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2928d9e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2926e19e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2926f3a5a0>]}


============================== 06:02:09.385110 | 561bea4a-90a3-4ad9-a880-d7921d2dd892 ==============================
[0m06:02:09.385110 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.385796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.520194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '561bea4a-90a3-4ad9-a880-d7921d2dd892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2926e19e50>]}
[0m06:02:09.533379 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tu33_r79'
[0m06:02:09.533842 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:09.590402 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:09.591016 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:09.604026 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:09.607765 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:09.747263 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:09.747746 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:09.748224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '561bea4a-90a3-4ad9-a880-d7921d2dd892', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2926b93c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2926b93ef0>]}
[0m06:02:09.748655 [info ] [MainThread]: 
[0m06:02:09.749106 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:09.754849 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42450908, "process_user_time": 1.493607, "process_kernel_time": 0.161908, "process_mem_max_rss": "93468", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:09.755425 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:09.755323 after 0.43 seconds
[0m06:02:09.755851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2927eaf860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2926e5aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2926c72e40>]}
[0m06:02:09.756278 [debug] [MainThread]: Flushing usage events
[0m06:02:11.341265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37ad32270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37ccc01a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37ac96c60>]}


============================== 06:02:11.343958 | 80b68141-1986-4004-b944-da174b9485ca ==============================
[0m06:02:11.343958 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.344617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.574700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37aa7fb90>]}
[0m06:02:11.633007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc373b60320>]}
[0m06:02:11.635367 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:11.654393 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:11.655096 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:11.655617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a9c7a70>]}
[0m06:02:12.873943 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:12.874597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37395ec90>]}
[0m06:02:13.052339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.057213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc373518110>]}
[0m06:02:13.177504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc373594d40>]}
[0m06:02:13.178090 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:13.178585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc373393170>]}
[0m06:02:13.180221 [info ] [MainThread]: 
[0m06:02:13.180892 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:13.185542 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:13.220306 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:13.220747 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:13.221142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:13.728991 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:13.730619 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:13.732895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:13.733479 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:13.740749 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.741185 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:13.741600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.747777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.749249 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.749698 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:13.750299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.750696 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.751141 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:13.751742 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.752665 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.753066 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.753441 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.754023 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.754437 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:13.756378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:13.762023 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.762458 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:13.762833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.768577 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.768982 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.769373 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:13.792227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.793675 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:13.794889 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:13.795302 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:13.798512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3721b2480>]}
[0m06:02:13.799021 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.799411 [debug] [MainThread]: On master: BEGIN
[0m06:02:13.799776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:13.805963 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.806388 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.806775 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.807150 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.807684 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.808082 [debug] [MainThread]: On master: Close
[0m06:02:13.809522 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:13.810037 [info ] [MainThread]: 
[0m06:02:13.819496 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:13.820085 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:13.820712 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:13.821157 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:13.846695 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:13.847445 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:13.883107 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:13.883834 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:21.206368 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.206875 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:21.207500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.207951 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.208380 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:21.209072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.211916 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.212372 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:21.213071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.233792 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.234274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.234718 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:21.236243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.241123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.241623 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:21.242764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.245057 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:21.274173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33009ef90>]}
[0m06:02:21.274871 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.45s]
[0m06:02:21.275741 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:21.276703 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:21.277267 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:21.277951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:21.278408 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:21.283373 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:21.284020 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:21.317178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.317716 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241121060221311320"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:21.318201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:21.332466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.339698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.340165 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:21.340756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.341204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.341666 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241121060221311320'
      
      
      order by ordinal_position

  
[0m06:02:21.362192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.368150 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.368631 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.372890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.380394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.380874 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.383734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.401415 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.402100 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.402571 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241121060221311320"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241121060221311320"
    )
  
[0m06:02:21.435157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.437047 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.437507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.437961 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.446574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.447461 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.540596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80b68141-1986-4004-b944-da174b9485ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3304e1d60>]}
[0m06:02:21.541329 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m06:02:21.542212 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.543606 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.544102 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.544558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.551589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.552060 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.552501 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.552924 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.553560 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.554044 [debug] [MainThread]: On master: Close
[0m06:02:21.555557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.556000 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.556403 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.556868 [info ] [MainThread]: 
[0m06:02:21.557399 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m06:02:21.558447 [debug] [MainThread]: Command end result
[0m06:02:21.586604 [info ] [MainThread]: 
[0m06:02:21.587229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.587734 [info ] [MainThread]: 
[0m06:02:21.588251 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.589251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.295656, "process_user_time": 5.209331, "process_kernel_time": 0.362422, "process_mem_max_rss": "290072", "process_in_blocks": "3808", "process_out_blocks": "111152"}
[0m06:02:21.589923 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.589814 after 10.30 seconds
[0m06:02:21.590412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37e5bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc373b19d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3735efe90>]}
[0m06:02:21.590890 [debug] [MainThread]: Flushing usage events
[0m06:02:23.309678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80afb5b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0ce87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80afb5b140>]}


============================== 06:02:23.312326 | b7259c9c-e119-470f-a429-07be9f8cf44e ==============================
[0m06:02:23.312326 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.312958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.447883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7259c9c-e119-470f-a429-07be9f8cf44e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80afaa4d70>]}
[0m06:02:23.464189 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20271301, "process_user_time": 1.393008, "process_kernel_time": 0.091802, "process_mem_max_rss": "92252", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:23.464753 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:23.464651 after 0.20 seconds
[0m06:02:23.465182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80afe35370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b05f7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0fed280>]}
[0m06:02:23.465650 [debug] [MainThread]: Flushing usage events
[0m14:05:29.742905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2e271af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2e6ce4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2ea4c440>]}


============================== 14:05:29.761061 | ade6f56c-2aca-4ef5-8251-02f46e1a9d38 ==============================
[0m14:05:29.761061 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.761774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.908737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ade6f56c-2aca-4ef5-8251-02f46e1a9d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2e07cb90>]}
[0m14:05:29.922735 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mw031oif'
[0m14:05:29.923235 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:29.967306 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:29.968182 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:29.991288 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:29.995880 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:30.069860 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:30.070519 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:30.071208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ade6f56c-2aca-4ef5-8251-02f46e1a9d38', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2e09cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2e07ddc0>]}
[0m14:05:30.071709 [info ] [MainThread]: 
[0m14:05:30.072249 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:30.079286 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38507816, "process_user_time": 1.614584, "process_kernel_time": 0.157422, "process_mem_max_rss": "93736", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m14:05:30.079997 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:30.079889 after 0.39 seconds
[0m14:05:30.080522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2e2bf620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2ea262d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2ea261b0>]}
[0m14:05:30.081017 [debug] [MainThread]: Flushing usage events
[0m14:05:31.754154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c00392720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0032dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0032d070>]}


============================== 14:05:31.757506 | 9e88e58e-7a50-4658-b231-e9fb73226218 ==============================
[0m14:05:31.757506 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.758226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.027145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c00193d40>]}
[0m14:05:32.088241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c001852b0>]}
[0m14:05:32.091077 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:32.113626 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:32.114395 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:32.114917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf91400e0>]}
[0m14:05:33.368665 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:33.369444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf9058800>]}
[0m14:05:33.555853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:33.561369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf90685c0>]}
[0m14:05:33.699955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf8f9dfd0>]}
[0m14:05:33.700591 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:33.701138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf8b35490>]}
[0m14:05:33.703020 [info ] [MainThread]: 
[0m14:05:33.703793 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:33.708863 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:33.746585 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:33.747090 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:33.747511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:34.328946 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:34.330849 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:34.333041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:34.333684 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:34.341074 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.341558 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:34.341966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.348476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.349966 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.350383 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:34.350931 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.351330 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.351715 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:34.352289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.353203 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.353632 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.354017 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.354553 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.354962 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:34.357098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:34.362974 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.363412 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:34.363793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.370132 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.370556 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.370960 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:34.393772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.395425 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:34.396697 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:34.397105 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:34.400956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c01891160>]}
[0m14:05:34.401546 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.401955 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.402338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:34.409057 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.409548 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.409957 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.410360 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.410920 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.411350 [debug] [MainThread]: On master: Close
[0m14:05:34.412854 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:34.413413 [info ] [MainThread]: 
[0m14:05:34.423629 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:34.424293 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:34.425000 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:34.425515 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:34.452190 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:34.453117 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:34.490028 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:34.490975 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:43.068497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.069062 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:43.069789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.070258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.070711 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:43.071561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.074687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.075163 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:43.075919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.097026 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:43.097553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.098009 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:43.099919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.105053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.105565 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:43.106764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.109158 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:43.139916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c018464e0>]}
[0m14:05:43.140740 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.71s]
[0m14:05:43.141558 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:43.142606 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:43.143216 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:43.143923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:43.144386 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:43.149859 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:43.150523 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:43.184668 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.185255 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241121140543178664"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:43.185750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:43.200931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.208889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.209404 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:43.210042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.210494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.210937 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241121140543178664'
      
      
      order by ordinal_position

  
[0m14:05:43.232099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.239271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.239789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:43.242874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.250701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.251192 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:43.254809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.272959 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:43.273771 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.274262 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241121140543178664"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241121140543178664"
    )
  
[0m14:05:43.310607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.312745 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:43.313273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.313718 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:43.322339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.323302 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:43.420953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e88e58e-7a50-4658-b231-e9fb73226218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb5131100>]}
[0m14:05:43.421866 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m14:05:43.422832 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:43.424404 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.425014 [debug] [MainThread]: On master: BEGIN
[0m14:05:43.425550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:43.433139 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.433674 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.434117 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.434546 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.435137 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.435591 [debug] [MainThread]: On master: Close
[0m14:05:43.437272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:43.437726 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:43.438135 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:43.438602 [info ] [MainThread]: 
[0m14:05:43.439140 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m14:05:43.440152 [debug] [MainThread]: Command end result
[0m14:05:43.468716 [info ] [MainThread]: 
[0m14:05:43.469475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:43.470007 [info ] [MainThread]: 
[0m14:05:43.470537 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:43.471596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.768774, "process_user_time": 5.10425, "process_kernel_time": 0.338425, "process_mem_max_rss": "283768", "process_in_blocks": "3808", "process_out_blocks": "111136"}
[0m14:05:43.472257 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:43.472143 after 11.77 seconds
[0m14:05:43.472762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c00b39460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf8b188c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf8b19010>]}
[0m14:05:43.473299 [debug] [MainThread]: Flushing usage events
[0m14:05:45.191360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3926c07530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392861d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3926d7ad50>]}


============================== 14:05:45.194398 | 325aeb37-5487-4512-a9de-9a9f9dc8deb1 ==============================
[0m14:05:45.194398 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:45.195144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:45.343006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '325aeb37-5487-4512-a9de-9a9f9dc8deb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3926d78980>]}
[0m14:05:45.360454 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21858303, "process_user_time": 1.438284, "process_kernel_time": 0.104165, "process_mem_max_rss": "92340", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:45.361087 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:45.360970 after 0.22 seconds
[0m14:05:45.361604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39269f5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39276add00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39276ae780>]}
[0m14:05:45.362062 [debug] [MainThread]: Flushing usage events
[0m22:05:42.430704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c9e87fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c8739be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c7d21fa0>]}


============================== 22:05:42.438133 | 8ba8c9c7-7661-4e6d-bdee-7dd579ea5346 ==============================
[0m22:05:42.438133 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.438789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.577269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ba8c9c7-7661-4e6d-bdee-7dd579ea5346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c8a390a0>]}
[0m22:05:42.590953 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-macwmj4r'
[0m22:05:42.591407 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:42.658110 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:42.658796 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:42.682209 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:42.686081 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:42.757809 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:42.758400 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:42.758943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8ba8c9c7-7661-4e6d-bdee-7dd579ea5346', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c81052b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c7b2b350>]}
[0m22:05:42.759419 [info ] [MainThread]: 
[0m22:05:42.759950 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:42.761579 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37971905, "process_user_time": 1.588198, "process_kernel_time": 0.117195, "process_mem_max_rss": "93636", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:42.762179 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:42.762071 after 0.38 seconds
[0m22:05:42.762622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c7d03d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c871d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c7a69400>]}
[0m22:05:42.763053 [debug] [MainThread]: Flushing usage events
[0m22:05:44.370685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e48cec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e5cd1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e57764e0>]}


============================== 22:05:44.373440 | d03db177-5fe8-438b-bb22-e1f43a412cc9 ==============================
[0m22:05:44.373440 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.374093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.607061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e571a420>]}
[0m22:05:44.677703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e46efb90>]}
[0m22:05:44.680313 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:44.695680 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:44.696403 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:44.696933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e46ed220>]}
[0m22:05:45.924701 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:45.925366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10dd18a960>]}
[0m22:05:46.107365 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:46.112636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10dd0662d0>]}
[0m22:05:46.241171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10dd0df080>]}
[0m22:05:46.241766 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:46.242290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10dcf822d0>]}
[0m22:05:46.244103 [info ] [MainThread]: 
[0m22:05:46.244841 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:46.249811 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:46.285905 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:46.286415 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:46.286820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:46.876123 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:46.877668 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:46.879777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:46.880341 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:46.887494 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.887956 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:46.888345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.894622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.896072 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.896474 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:46.897013 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.897402 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.897774 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:46.898336 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.899235 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.899676 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.900052 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.900624 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.901032 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:46.902949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:46.908536 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.908949 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:46.909320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.915117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.915572 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.915979 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:46.939346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.940830 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:46.942165 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:46.942568 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:46.945847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e564e420>]}
[0m22:05:46.946391 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.946780 [debug] [MainThread]: On master: BEGIN
[0m22:05:46.947151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:46.953488 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.953925 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.954320 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.954700 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.955248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.955706 [debug] [MainThread]: On master: Close
[0m22:05:46.957054 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:46.957567 [info ] [MainThread]: 
[0m22:05:46.967376 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:46.968013 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:46.968676 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:46.969120 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:46.995135 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:46.995905 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:47.031335 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:47.032126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:55.464588 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.465111 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:55.465767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.466212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.466644 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:55.467401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.470336 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.470787 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:55.471553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.492271 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:55.492755 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.493187 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:55.494394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.499341 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.499839 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:55.501116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.503463 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:55.533281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109d923710>]}
[0m22:05:55.534095 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.56s]
[0m22:05:55.534885 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:55.535918 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:55.536486 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:55.537100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:55.537552 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:55.542833 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:55.543489 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:55.577342 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.577873 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241121220555571420"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:55.578358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:55.595027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.603075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.603599 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:55.604287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.604732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.605166 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241121220555571420'
      
      
      order by ordinal_position

  
[0m22:05:55.626442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.633264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.633758 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:55.636697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.644448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.644926 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:55.649480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.667915 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:55.668685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.669169 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241121220555571420"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241121220555571420"
    )
  
[0m22:05:55.701492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.703592 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:55.704087 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.704513 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:55.712643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.713553 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:55.820647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd03db177-5fe8-438b-bb22-e1f43a412cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109d9c0dd0>]}
[0m22:05:55.821463 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.28s]
[0m22:05:55.822314 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:55.823756 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.824273 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.824751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:55.831740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.832236 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.832678 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.833106 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.833689 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.834144 [debug] [MainThread]: On master: Close
[0m22:05:55.835990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:55.836436 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:55.836848 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:55.837312 [info ] [MainThread]: 
[0m22:05:55.837866 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m22:05:55.838902 [debug] [MainThread]: Command end result
[0m22:05:55.867828 [info ] [MainThread]: 
[0m22:05:55.868565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:55.869131 [info ] [MainThread]: 
[0m22:05:55.869692 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:55.870773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.548066, "process_user_time": 5.51841, "process_kernel_time": 0.351898, "process_mem_max_rss": "293124", "process_in_blocks": "3808", "process_out_blocks": "111168"}
[0m22:05:55.871436 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:55.871322 after 11.55 seconds
[0m22:05:55.871970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e6967920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e4833c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10e4cf0050>]}
[0m22:05:55.872460 [debug] [MainThread]: Flushing usage events
[0m22:05:57.535730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800b1e68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800b521100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800b1e5af0>]}


============================== 22:05:57.538559 | 55535577-39dc-419c-b08c-00d1ebd467a8 ==============================
[0m22:05:57.538559 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:57.539308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.682986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55535577-39dc-419c-b08c-00d1ebd467a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800a5f1580>]}
[0m22:05:57.699854 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21255352, "process_user_time": 1.423338, "process_kernel_time": 0.099673, "process_mem_max_rss": "92092", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:57.700438 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:57.700336 after 0.21 seconds
[0m22:05:57.700880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800a780bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800b18bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800a496b40>]}
[0m22:05:57.701308 [debug] [MainThread]: Flushing usage events
[0m06:02:25.613808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0692a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf05a2af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf06f50c20>]}


============================== 06:02:25.626236 | 08d752cd-3881-4d45-afa6-b7c85290cd72 ==============================
[0m06:02:25.626236 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.626887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.775516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08d752cd-3881-4d45-afa6-b7c85290cd72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf046ea5a0>]}
[0m06:02:25.789389 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hc7vpr8y'
[0m06:02:25.789870 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.829916 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.830656 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.842834 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.846853 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:26.114340 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:26.114916 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:26.115501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '08d752cd-3881-4d45-afa6-b7c85290cd72', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0592ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0592a1e0>]}
[0m06:02:26.116027 [info ] [MainThread]: 
[0m06:02:26.116492 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:26.119724 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5546945, "process_user_time": 1.603798, "process_kernel_time": 0.117747, "process_mem_max_rss": "93468", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:26.120476 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:26.120353 after 0.56 seconds
[0m06:02:26.121008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0692a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf04775160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf04a66300>]}
[0m06:02:26.121454 [debug] [MainThread]: Flushing usage events
[0m06:02:28.036602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ba7d98dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ba81808f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ba7813380>]}


============================== 06:02:28.039514 | 43d03c98-789c-4d60-89be-a4736d8f1130 ==============================
[0m06:02:28.039514 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:28.040214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:28.284678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ba7237ce0>]}
[0m06:02:28.344973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ba882db80>]}
[0m06:02:28.347642 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:28.363997 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:28.364781 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:28.365314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ba7237170>]}
[0m06:02:29.598793 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:29.599465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9bd70230>]}
[0m06:02:29.783308 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:29.788706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ba02c21b0>]}
[0m06:02:29.937652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9bd5d4f0>]}
[0m06:02:29.938238 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:29.938748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9bcbbb30>]}
[0m06:02:29.940550 [info ] [MainThread]: 
[0m06:02:29.941302 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:29.946200 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.982790 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.983303 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.983707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:30.450946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.452526 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:30.454662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:30.455227 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:30.462417 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:30.462848 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:30.463238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:30.469554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.471071 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:30.471473 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:30.472031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.472425 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:30.472800 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:30.473408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.474336 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:30.474741 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:30.475113 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:30.475647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.476097 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:30.478158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:30.484015 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:30.484428 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:30.484816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:30.490881 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.491295 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:30.491703 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:30.515162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.516855 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:30.518096 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:30.518499 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:30.522246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9bb42420>]}
[0m06:02:30.522774 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.523171 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.523547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:30.530149 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.530598 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.530990 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.531370 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.531965 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.532380 [debug] [MainThread]: On master: Close
[0m06:02:30.533958 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:30.534460 [info ] [MainThread]: 
[0m06:02:30.544154 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:30.544792 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:30.545493 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:30.545944 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:30.572329 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:30.573185 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:30.609534 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:30.610435 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:40.050491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:40.051051 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:40.051729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.052231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:40.052674 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:40.053417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.056552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:40.057010 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:40.057704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.078743 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:40.079271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:40.079717 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:40.082176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.087338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:40.087855 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:40.090929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.093372 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:40.124336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9bcbaba0>]}
[0m06:02:40.125168 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.58s]
[0m06:02:40.125949 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:40.126984 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:40.127545 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:40.128158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:40.128617 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:40.134020 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:40.134691 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:40.169092 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:40.169679 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241122060240163045"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:40.170159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:40.185181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.193350 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:40.193852 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:40.194631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.195082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:40.195519 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241122060240163045'
      
      
      order by ordinal_position

  
[0m06:02:40.216885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.223887 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:40.224396 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:40.227321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.235172 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:40.235657 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:40.238490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.256539 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:40.257298 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:40.257768 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241122060240163045"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241122060240163045"
    )
  
[0m06:02:40.291039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.293101 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:40.293577 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:40.294007 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:40.301948 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:40.302907 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:40.416701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43d03c98-789c-4d60-89be-a4736d8f1130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b64440b30>]}
[0m06:02:40.417534 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m06:02:40.418287 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:40.419693 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.420230 [debug] [MainThread]: On master: BEGIN
[0m06:02:40.420659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:40.427333 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.427850 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.428295 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.428721 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.429354 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.429812 [debug] [MainThread]: On master: Close
[0m06:02:40.431298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:40.431733 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:40.432195 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:40.432666 [info ] [MainThread]: 
[0m06:02:40.433233 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m06:02:40.434268 [debug] [MainThread]: Command end result
[0m06:02:40.462447 [info ] [MainThread]: 
[0m06:02:40.463160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:40.463696 [info ] [MainThread]: 
[0m06:02:40.464286 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:40.465322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.477764, "process_user_time": 5.444924, "process_kernel_time": 0.337047, "process_mem_max_rss": "276008", "process_in_blocks": "3808", "process_out_blocks": "111664"}
[0m06:02:40.465967 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:40.465857 after 12.48 seconds
[0m06:02:40.466470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ba0101370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6baadbbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b9bda8620>]}
[0m06:02:40.466962 [debug] [MainThread]: Flushing usage events
[0m06:02:42.428324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe310849e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3107fcf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3107fcbf0>]}


============================== 06:02:42.431267 | 784ce5f9-eb23-4cbd-9099-ce406ab69315 ==============================
[0m06:02:42.431267 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:42.432022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:42.575643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '784ce5f9-eb23-4cbd-9099-ce406ab69315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31035bb90>]}
[0m06:02:42.592621 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21360815, "process_user_time": 1.434486, "process_kernel_time": 0.10389, "process_mem_max_rss": "92132", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:42.593223 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:42.593119 after 0.21 seconds
[0m06:02:42.593668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3139bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe31035bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30fea6630>]}
[0m06:02:42.594109 [debug] [MainThread]: Flushing usage events
[0m14:05:28.520703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd9086c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd92eb62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8fe3ce30>]}


============================== 14:05:28.528734 | 658fa3a2-b93c-40db-9af3-c77d98235905 ==============================
[0m14:05:28.528734 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.529489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.687126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '658fa3a2-b93c-40db-9af3-c77d98235905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd90484500>]}
[0m14:05:28.701413 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uqal5iub'
[0m14:05:28.701992 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:28.754741 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:28.755544 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:28.766491 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:28.770526 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:28.988359 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:28.988986 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:28.989549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '658fa3a2-b93c-40db-9af3-c77d98235905', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8fe5d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8fe5fda0>]}
[0m14:05:28.990072 [info ] [MainThread]: 
[0m14:05:28.990588 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:29.047730 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.57638067, "process_user_time": 1.645934, "process_kernel_time": 0.153297, "process_mem_max_rss": "93500", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:29.048482 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:29.048357 after 0.58 seconds
[0m14:05:29.048962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd9007d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd90f69bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd933135c0>]}
[0m14:05:29.049431 [debug] [MainThread]: Flushing usage events
[0m14:05:30.937854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28b6999a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28b99a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28b0f3890>]}


============================== 14:05:30.940690 | ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101 ==============================
[0m14:05:30.940690 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.941391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.189541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28edbbe30>]}
[0m14:05:31.249647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28b3f9070>]}
[0m14:05:31.252309 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:31.284122 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:31.284920 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:31.285485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28bc9a660>]}
[0m14:05:32.530244 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:32.530943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa283ab0290>]}
[0m14:05:32.715798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:32.721283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa283ab6e40>]}
[0m14:05:32.880334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa283aa1ac0>]}
[0m14:05:32.880925 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:32.881436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa283889ee0>]}
[0m14:05:32.883268 [info ] [MainThread]: 
[0m14:05:32.883980 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:32.889087 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:32.925987 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:32.926507 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:32.926921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:33.271032 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.272592 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:33.274858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:33.275422 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:33.282616 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.283069 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:33.283465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:33.289988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.291617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.292034 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:33.292631 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.293041 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.293419 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:33.294048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.294990 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:33.295399 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.295777 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:33.296312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.296732 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:33.299061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:33.304981 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:33.305394 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:33.305814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:33.311946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.312363 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:33.312779 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:33.335980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.337761 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:33.339085 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:33.339524 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:33.343529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2839289e0>]}
[0m14:05:33.344118 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:33.344525 [debug] [MainThread]: On master: BEGIN
[0m14:05:33.344909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:33.351608 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:33.352099 [debug] [MainThread]: On master: COMMIT
[0m14:05:33.352504 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:33.352892 [debug] [MainThread]: On master: COMMIT
[0m14:05:33.353449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:33.353923 [debug] [MainThread]: On master: Close
[0m14:05:33.355585 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:33.356098 [info ] [MainThread]: 
[0m14:05:33.366053 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:33.366704 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:33.367389 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:33.367843 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:33.394585 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:33.395487 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:33.432665 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:33.433619 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:42.327205 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:42.327766 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:42.328550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.329017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:42.329460 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:42.330296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.333460 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:42.333955 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:42.334668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.356205 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:42.356832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:42.357318 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:42.358806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.364477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:42.364978 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:42.366489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.369040 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:42.399539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa249216a20>]}
[0m14:05:42.400374 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.03s]
[0m14:05:42.401169 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:42.402194 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:42.402799 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:42.403417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:42.403880 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:42.409352 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:42.410110 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:42.444831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:42.445445 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241122140542438739"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:42.445958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:42.461154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.469688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:42.470265 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:42.471161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.471625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:42.472074 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241122140542438739'
      
      
      order by ordinal_position

  
[0m14:05:42.493324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.501064 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:42.501653 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:42.504878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.513110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:42.513669 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:42.516877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.535484 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:42.536284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:42.536769 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241122140542438739"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241122140542438739"
    )
  
[0m14:05:42.574752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.576926 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:42.577459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:42.577974 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:42.587802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:42.588938 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:42.698953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2a2b0-aff6-4c46-8ef3-7b5a79aa0101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa249216a20>]}
[0m14:05:42.699785 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m14:05:42.700572 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:42.702136 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:42.702632 [debug] [MainThread]: On master: BEGIN
[0m14:05:42.703141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:42.710033 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:42.710526 [debug] [MainThread]: On master: COMMIT
[0m14:05:42.710963 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:42.711385 [debug] [MainThread]: On master: COMMIT
[0m14:05:42.711966 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:42.712423 [debug] [MainThread]: On master: Close
[0m14:05:42.714158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:42.714600 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:42.715012 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:42.715482 [info ] [MainThread]: 
[0m14:05:42.716081 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.83 seconds (9.83s).
[0m14:05:42.717227 [debug] [MainThread]: Command end result
[0m14:05:42.746006 [info ] [MainThread]: 
[0m14:05:42.746776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:42.747377 [info ] [MainThread]: 
[0m14:05:42.747983 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:42.749103 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.859964, "process_user_time": 5.488148, "process_kernel_time": 0.280007, "process_mem_max_rss": "291220", "process_in_blocks": "3808", "process_out_blocks": "112176"}
[0m14:05:42.749782 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:42.749667 after 11.86 seconds
[0m14:05:42.750306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28edbbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa283917dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28c1c8320>]}
[0m14:05:42.750810 [debug] [MainThread]: Flushing usage events
[0m14:05:44.805889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4163d05400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4162ce08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4163d04ef0>]}


============================== 14:05:44.808950 | 2c8cdd84-bd67-4fad-ace6-efe21eb42e83 ==============================
[0m14:05:44.808950 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:44.809711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:44.961674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c8cdd84-bd67-4fad-ace6-efe21eb42e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4162d85d90>]}
[0m14:05:44.978548 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22499885, "process_user_time": 1.499833, "process_kernel_time": 0.099988, "process_mem_max_rss": "92228", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:44.979158 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:44.979042 after 0.23 seconds
[0m14:05:44.979607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4163305130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41621ebfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4163361af0>]}
[0m14:05:44.980051 [debug] [MainThread]: Flushing usage events
[0m22:06:25.954111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd7b36180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd7b36870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd7b35f70>]}


============================== 22:06:25.961651 | 8b9d604c-1ff2-42ea-bfe8-c3358bf592d2 ==============================
[0m22:06:25.961651 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:25.962332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.102462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b9d604c-1ff2-42ea-bfe8-c3358bf592d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd7bf6600>]}
[0m22:06:26.115793 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l1r_frta'
[0m22:06:26.116243 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:26.187384 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:26.188019 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:26.198756 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:26.202512 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:26.413465 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:26.414007 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:26.414566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b9d604c-1ff2-42ea-bfe8-c3358bf592d2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd80c04a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd7051730>]}
[0m22:06:26.415021 [info ] [MainThread]: 
[0m22:06:26.415502 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:26.435395 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.529116, "process_user_time": 1.619019, "process_kernel_time": 0.096898, "process_mem_max_rss": "93880", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:06:26.435996 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:26.435895 after 0.53 seconds
[0m22:06:26.436431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdadbbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd89df680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd78f0740>]}
[0m22:06:26.436862 [debug] [MainThread]: Flushing usage events
[0m22:06:28.204301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29912ba7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29912b9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29908f79e0>]}


============================== 22:06:28.207005 | d4d80924-c3b1-421e-a7e8-0e9d2dc60f8b ==============================
[0m22:06:28.207005 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:28.207668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:28.435371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2990633590>]}
[0m22:06:28.493597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2990a3e420>]}
[0m22:06:28.496030 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:28.511290 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:28.511993 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:28.512525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29906b47d0>]}
[0m22:06:29.742633 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:29.743278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29895c81a0>]}
[0m22:06:29.923671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:29.928604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299064d370>]}
[0m22:06:30.074674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29895aabd0>]}
[0m22:06:30.075221 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:30.075754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2989090290>]}
[0m22:06:30.077424 [info ] [MainThread]: 
[0m22:06:30.078129 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:30.082970 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:30.118326 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:30.118804 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:30.119206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:30.482317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.483932 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:30.486266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:30.487177 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:30.495572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.496010 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:30.496409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:30.502503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.503924 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.504333 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:30.504905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.505307 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.505685 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:30.506261 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.507224 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:30.507631 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:30.508014 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:30.508572 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.508990 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:30.510845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:30.516422 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:30.516841 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:30.517219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:30.522863 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.523278 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:30.523675 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:30.546478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:30.547911 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:30.549116 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:30.549526 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:30.552851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29890934a0>]}
[0m22:06:30.553387 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.553783 [debug] [MainThread]: On master: BEGIN
[0m22:06:30.554155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:30.560395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.560825 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.561216 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:30.561594 [debug] [MainThread]: On master: COMMIT
[0m22:06:30.562180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:30.562636 [debug] [MainThread]: On master: Close
[0m22:06:30.564094 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:30.564590 [info ] [MainThread]: 
[0m22:06:30.574096 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:30.574740 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:30.575383 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:30.575825 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:30.601446 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:30.602198 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:30.637710 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:30.638484 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:41.025693 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.026210 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:41.026869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.027329 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.027768 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:41.028474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.031347 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.031811 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:41.032490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.053252 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:41.053740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.054180 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:41.056403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.061265 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:41.061732 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:41.063005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.065286 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:41.095048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2991e5e510>]}
[0m22:06:41.095760 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.52s]
[0m22:06:41.096533 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:41.097502 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:41.098067 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:41.098669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:41.099123 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:41.104092 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:41.104728 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:41.138650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.139166 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241122220641132694"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:41.139639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:41.154072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.161377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.161860 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:41.162471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.162918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.163354 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241122220641132694'
      
      
      order by ordinal_position

  
[0m22:06:41.183835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.189881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.190360 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:41.193238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.200734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.201215 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:41.204379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.222205 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:41.222922 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.223396 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241122220641132694"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241122220641132694"
    )
  
[0m22:06:41.260361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.262431 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:41.262905 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:41.263335 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:41.271968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:41.272958 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:41.389358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4d80924-c3b1-421e-a7e8-0e9d2dc60f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29496ec200>]}
[0m22:06:41.390084 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m22:06:41.390867 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:41.392326 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:41.392806 [debug] [MainThread]: On master: BEGIN
[0m22:06:41.393241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:41.399821 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:41.400291 [debug] [MainThread]: On master: COMMIT
[0m22:06:41.400721 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:41.401143 [debug] [MainThread]: On master: COMMIT
[0m22:06:41.401713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:41.402157 [debug] [MainThread]: On master: Close
[0m22:06:41.403569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:41.404004 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:41.404405 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:41.404859 [info ] [MainThread]: 
[0m22:06:41.405445 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.33 seconds (11.33s).
[0m22:06:41.406632 [debug] [MainThread]: Command end result
[0m22:06:41.434379 [info ] [MainThread]: 
[0m22:06:41.435081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:41.435677 [info ] [MainThread]: 
[0m22:06:41.436298 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:41.437380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.28091, "process_user_time": 5.219381, "process_kernel_time": 0.239238, "process_mem_max_rss": "297216", "process_in_blocks": "3808", "process_out_blocks": "112208"}
[0m22:06:41.438023 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:41.437914 after 13.28 seconds
[0m22:06:41.438542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2990c5e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29497c6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29895ead20>]}
[0m22:06:41.439032 [debug] [MainThread]: Flushing usage events
[0m22:06:43.353369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff13c6e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff131647d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12abf230>]}


============================== 22:06:43.357807 | bffcd3fc-a2b0-4fdc-9e8f-8593c8a3bff5 ==============================
[0m22:06:43.357807 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:43.358652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:43.521450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bffcd3fc-a2b0-4fdc-9e8f-8593c8a3bff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff129b6b70>]}
[0m22:06:43.538478 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.25087488, "process_user_time": 1.476054, "process_kernel_time": 0.112004, "process_mem_max_rss": "92212", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:43.539095 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:43.538989 after 0.25 seconds
[0m22:06:43.539537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12d45c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff133d1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff129b6b70>]}
[0m22:06:43.539970 [debug] [MainThread]: Flushing usage events
[0m06:02:15.860925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da40186e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da5f69c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da458cf50>]}


============================== 06:02:15.878317 | a3143ef7-030e-4ba7-8330-2854d2d537b2 ==============================
[0m06:02:15.878317 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:15.879025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.016000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3143ef7-030e-4ba7-8330-2854d2d537b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3dbdca0>]}
[0m06:02:16.029352 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9i83z56t'
[0m06:02:16.029800 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:16.187199 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:16.187930 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:16.199062 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:16.202909 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:16.374368 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:16.374882 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:16.375428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a3143ef7-030e-4ba7-8330-2854d2d537b2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3faeae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da4d02f00>]}
[0m06:02:16.375887 [info ] [MainThread]: 
[0m06:02:16.376365 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:16.383499 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5708042, "process_user_time": 1.573113, "process_kernel_time": 0.13243, "process_mem_max_rss": "93720", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m06:02:16.384105 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:16.384004 after 0.57 seconds
[0m06:02:16.384539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da458e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3bcb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3da3bc8530>]}
[0m06:02:16.384973 [debug] [MainThread]: Flushing usage events
[0m06:02:18.028154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cca157f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cb1d2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cb1d1100>]}


============================== 06:02:18.030847 | 22383f74-1044-4ca6-ae67-beb99160bbb7 ==============================
[0m06:02:18.030847 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.031506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.261351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cae71010>]}
[0m06:02:18.320290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cd3591f0>]}
[0m06:02:18.322681 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:18.355547 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:18.356246 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:18.356759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cafe2a80>]}
[0m06:02:19.585958 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:19.586610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c3ef8140>]}
[0m06:02:19.768175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:19.773168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c3e5a570>]}
[0m06:02:19.893630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c3d8e810>]}
[0m06:02:19.894177 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:19.894689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c3805e20>]}
[0m06:02:19.896390 [info ] [MainThread]: 
[0m06:02:19.897070 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:19.901872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:19.938592 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:19.939044 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:19.939492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:20.436237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.438058 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:20.440290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:20.440856 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:20.448526 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.448959 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:20.449379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:20.457723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.459146 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.459585 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:20.460186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.460581 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.460962 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:20.461521 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.462431 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:20.462828 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:20.463198 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:20.463768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.464168 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:20.465994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:20.471575 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:20.471991 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:20.472368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:20.478131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.478549 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:20.478945 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:20.501861 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:20.503327 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:20.504516 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:20.504922 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:20.508157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c3d8ebd0>]}
[0m06:02:20.508683 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.509077 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.509447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:20.515516 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.515940 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.516330 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.516709 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.517217 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.517617 [debug] [MainThread]: On master: Close
[0m06:02:20.518892 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:20.519402 [info ] [MainThread]: 
[0m06:02:20.529017 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:20.529616 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:20.530238 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:20.530682 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:20.556528 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:20.557272 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:20.593144 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:20.593872 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:28.775331 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.775843 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:28.776477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.776941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.777383 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:28.778078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.780966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.781433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:28.782118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.802872 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.803376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.803826 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.806911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.811851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.812326 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:28.813878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.816205 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:28.845834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31b0077950>]}
[0m06:02:28.846561 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.31s]
[0m06:02:28.847466 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:28.848433 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:28.848990 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:28.849657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:28.850125 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:28.855108 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:28.855809 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:28.889477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.889985 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241123060228883580"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:28.890461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:28.904917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.912295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.912762 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:28.913417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.913865 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.914304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241123060228883580'
      
      
      order by ordinal_position

  
[0m06:02:28.936160 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.942190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.942675 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.946535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.955442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.955951 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.958652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.976731 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:28.977415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.977892 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241123060228883580"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241123060228883580"
    )
  
[0m06:02:29.009528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.011548 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.012014 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.012450 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.021360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.022244 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:29.151434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22383f74-1044-4ca6-ae67-beb99160bbb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318026b950>]}
[0m06:02:29.152256 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m06:02:29.153010 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:29.154465 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.154940 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.155414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:29.162108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.162582 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.163024 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.163494 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.164085 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.164542 [debug] [MainThread]: On master: Close
[0m06:02:29.165929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:29.166366 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:29.166771 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:29.167227 [info ] [MainThread]: 
[0m06:02:29.167780 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m06:02:29.168766 [debug] [MainThread]: Command end result
[0m06:02:29.196646 [info ] [MainThread]: 
[0m06:02:29.197273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:29.197782 [info ] [MainThread]: 
[0m06:02:29.198299 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:29.199316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.219126, "process_user_time": 5.405926, "process_kernel_time": 0.373644, "process_mem_max_rss": "291412", "process_in_blocks": "3808", "process_out_blocks": "112176"}
[0m06:02:29.199963 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:29.199854 after 11.22 seconds
[0m06:02:29.200452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cd4496d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cb1d2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31cb1d1100>]}
[0m06:02:29.200937 [debug] [MainThread]: Flushing usage events
[0m06:02:30.843601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71f4275f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71de46240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71eb5e420>]}


============================== 06:02:30.846263 | 4a768300-fa4d-4303-87be-50fca0a26a21 ==============================
[0m06:02:30.846263 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:30.846930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:30.994071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a768300-fa4d-4303-87be-50fca0a26a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71db201a0>]}
[0m06:02:31.012257 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21646096, "process_user_time": 1.372389, "process_kernel_time": 0.124035, "process_mem_max_rss": "91976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:31.013142 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:31.012996 after 0.22 seconds
[0m06:02:31.013844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71ddcb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7213d0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71da17ce0>]}
[0m06:02:31.014518 [debug] [MainThread]: Flushing usage events
[0m14:05:00.886814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab34d32510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab355af680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3542d610>]}


============================== 14:05:00.931702 | 4b0d235f-374e-4236-850f-090430512bd5 ==============================
[0m14:05:00.931702 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:00.932413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:01.076108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b0d235f-374e-4236-850f-090430512bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3438aa80>]}
[0m14:05:01.089568 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h1t1c98_'
[0m14:05:01.090045 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:01.151379 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:01.152172 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:01.176115 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:01.180714 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:01.253859 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:01.254382 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:01.254912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4b0d235f-374e-4236-850f-090430512bd5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3436bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab342fffe0>]}
[0m14:05:01.255392 [info ] [MainThread]: 
[0m14:05:01.255875 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:01.305937 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46805492, "process_user_time": 1.645194, "process_kernel_time": 0.148468, "process_mem_max_rss": "93332", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:01.306754 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:01.306634 after 0.47 seconds
[0m14:05:01.307397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab35341bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab34827fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab342bd820>]}
[0m14:05:01.308020 [debug] [MainThread]: Flushing usage events
[0m14:05:02.862565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1a19b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1ad3ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b19f8cc80>]}


============================== 14:05:02.865546 | c9dd95c5-f43f-4054-9489-10f2a39dde6d ==============================
[0m14:05:02.865546 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:02.866209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:03.105516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b19755010>]}
[0m14:05:03.166402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1b2f8440>]}
[0m14:05:03.169082 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:03.191263 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:03.191994 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:03.192545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b121f3500>]}
[0m14:05:04.446116 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:04.446799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b11b40590>]}
[0m14:05:04.634182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:04.639720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b120d8530>]}
[0m14:05:04.771920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b11ab5580>]}
[0m14:05:04.772514 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:04.773045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1ab0d460>]}
[0m14:05:04.774827 [info ] [MainThread]: 
[0m14:05:04.775550 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:04.780365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:04.818635 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:04.819111 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:04.819534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:05.380669 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:05.382254 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:05.384423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:05.385047 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:05.392322 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:05.392786 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:05.393195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:05.399698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.401222 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:05.401631 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:05.402180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.402580 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:05.402964 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:05.403560 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.404556 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:05.405025 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:05.405429 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:05.405988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.406440 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:05.408560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:05.414372 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:05.414796 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:05.415178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:05.420894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.421307 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:05.421705 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:05.445223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:05.446875 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:05.448137 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:05.448545 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:05.452939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b119612e0>]}
[0m14:05:05.453518 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.453936 [debug] [MainThread]: On master: BEGIN
[0m14:05:05.454328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:05.461483 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.461962 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.462400 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.462820 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.463384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.463813 [debug] [MainThread]: On master: Close
[0m14:05:05.465499 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:05.466020 [info ] [MainThread]: 
[0m14:05:05.487841 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:05.488549 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:05.489341 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:05.489862 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:05.516339 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:05.517117 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:05.553605 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:05.554399 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:13.168749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:13.169302 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:13.169966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.170435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:13.170881 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:13.171625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.174628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:13.175094 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:13.175792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.197160 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:13.197665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:13.198113 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:13.199365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.204458 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:13.204962 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:13.206151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.208616 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:13.240868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ad2624ec0>]}
[0m14:05:13.241714 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.75s]
[0m14:05:13.242523 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:13.243613 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:13.244202 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:13.244830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:13.245313 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:13.250676 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:13.251356 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:13.285625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:13.286176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241123140513279597"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:13.286684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:13.302165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.310573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:13.311064 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:13.311712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.312170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:13.312620 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241123140513279597'
      
      
      order by ordinal_position

  
[0m14:05:13.334043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.340880 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:13.341462 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:13.345605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.353442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:13.353939 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:13.357745 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.376011 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:13.376789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:13.377280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241123140513279597"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241123140513279597"
    )
  
[0m14:05:13.417729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.419806 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:13.420273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:13.420747 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:13.429114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:13.430090 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:13.574751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9dd95c5-f43f-4054-9489-10f2a39dde6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ad1ff3800>]}
[0m14:05:13.575731 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:05:13.576564 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:13.578118 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:13.578753 [debug] [MainThread]: On master: BEGIN
[0m14:05:13.579295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:13.586267 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:13.586756 [debug] [MainThread]: On master: COMMIT
[0m14:05:13.587219 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:13.587669 [debug] [MainThread]: On master: COMMIT
[0m14:05:13.588329 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:13.588833 [debug] [MainThread]: On master: Close
[0m14:05:13.590289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:13.590736 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:13.591165 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:13.591636 [info ] [MainThread]: 
[0m14:05:13.592235 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.82 seconds (8.82s).
[0m14:05:13.593403 [debug] [MainThread]: Command end result
[0m14:05:13.621668 [info ] [MainThread]: 
[0m14:05:13.622384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:13.622999 [info ] [MainThread]: 
[0m14:05:13.623615 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:13.624747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.811649, "process_user_time": 5.725506, "process_kernel_time": 0.311646, "process_mem_max_rss": "296632", "process_in_blocks": "3808", "process_out_blocks": "112680"}
[0m14:05:13.625398 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:13.625287 after 10.81 seconds
[0m14:05:13.625894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b197786b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b11be3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b11b93950>]}
[0m14:05:13.626390 [debug] [MainThread]: Flushing usage events
[0m14:05:15.375021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70764daf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707882d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7076584da0>]}


============================== 14:05:15.378022 | 19b726ee-78d6-4822-b796-db30b9ce6685 ==============================
[0m14:05:15.378022 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:15.378792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:15.527145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19b726ee-78d6-4822-b796-db30b9ce6685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707627d5b0>]}
[0m14:05:15.544566 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21994859, "process_user_time": 1.454842, "process_kernel_time": 0.119904, "process_mem_max_rss": "92356", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:15.545224 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:15.545122 after 0.22 seconds
[0m14:05:15.545703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70769e5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707752e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70762f3fe0>]}
[0m14:05:15.546189 [debug] [MainThread]: Flushing usage events
[0m22:05:28.539746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9884ce000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9884cd520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9884cf830>]}


============================== 22:05:28.547316 | 5b70a83e-9741-4c98-93b8-b4488827e4c7 ==============================
[0m22:05:28.547316 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:28.548022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:28.687318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b70a83e-9741-4c98-93b8-b4488827e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb987b6fa10>]}
[0m22:05:28.700737 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-27_iltw9'
[0m22:05:28.701211 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:28.735604 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:28.736272 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:28.749909 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:28.753783 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:28.909933 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:28.910525 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:28.911173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5b70a83e-9741-4c98-93b8-b4488827e4c7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb987a64260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb98811d340>]}
[0m22:05:28.911642 [info ] [MainThread]: 
[0m22:05:28.912174 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:28.913903 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42349595, "process_user_time": 1.616598, "process_kernel_time": 0.123434, "process_mem_max_rss": "94052", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:28.914503 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:28.914399 after 0.42 seconds
[0m22:05:28.914981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb98b9bbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb988a70920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9881039e0>]}
[0m22:05:28.915414 [debug] [MainThread]: Flushing usage events
[0m22:05:30.560240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1072fb01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1070ee2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107107e720>]}


============================== 22:05:30.563119 | 8aace711-aa89-4c06-859e-c72c1876ce7a ==============================
[0m22:05:30.563119 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:30.563781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:30.801451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1070b5cb00>]}
[0m22:05:30.860609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10722b4e90>]}
[0m22:05:30.863285 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:30.879251 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:30.879998 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:30.880546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1069b3d760>]}
[0m22:05:32.123023 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:32.123705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1069b90230>]}
[0m22:05:32.306553 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:32.311713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1069b3df10>]}
[0m22:05:32.465091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10699f0a70>]}
[0m22:05:32.465654 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:32.466169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1069419040>]}
[0m22:05:32.467908 [info ] [MainThread]: 
[0m22:05:32.468608 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:32.473391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:32.511097 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:32.511622 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:32.512033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:32.839436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.841056 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:32.843332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:32.843923 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:32.851157 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:32.851601 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:32.851996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:32.858300 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.859852 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:32.860261 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:32.860851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.861253 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:32.861632 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:32.862206 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.863172 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:32.863574 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:32.863956 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:32.864563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.864980 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:32.867022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:32.872707 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:32.873143 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:32.873521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:32.879199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.879616 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:32.880016 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:32.903360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.904903 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:32.906126 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:32.906541 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:32.909967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107211f620>]}
[0m22:05:32.910493 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:32.910936 [debug] [MainThread]: On master: BEGIN
[0m22:05:32.911317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:32.917745 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:32.918184 [debug] [MainThread]: On master: COMMIT
[0m22:05:32.918576 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:32.919007 [debug] [MainThread]: On master: COMMIT
[0m22:05:32.919542 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:32.919952 [debug] [MainThread]: On master: Close
[0m22:05:32.921517 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:32.922016 [info ] [MainThread]: 
[0m22:05:32.931385 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:32.931989 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:32.932632 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:32.933101 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:32.959360 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:32.960196 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:32.996503 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:32.997386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:40.665584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:40.666113 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:40.666791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.667251 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:40.667683 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:40.668403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.671309 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:40.671765 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:40.672450 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.693161 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:40.693648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:40.694089 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:40.695246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.700286 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:40.700756 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:40.702057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.704441 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:40.734483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107170a960>]}
[0m22:05:40.735341 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.80s]
[0m22:05:40.736125 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:40.737125 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:40.737705 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:40.738313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:40.738805 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:40.744194 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:40.744853 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:40.778915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.779498 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241123220540772883"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:40.780024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:40.799223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.810723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.811441 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:40.812375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.813007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.813665 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241123220540772883'
      
      
      order by ordinal_position

  
[0m22:05:40.838355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.845922 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.846445 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:40.849466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.857057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.857538 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:40.860403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.878341 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:40.879144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.879629 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241123220540772883"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241123220540772883"
    )
  
[0m22:05:40.911406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.913439 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:40.913900 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.914330 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:40.922710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.923620 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:41.056263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aace711-aa89-4c06-859e-c72c1876ce7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102dbd8650>]}
[0m22:05:41.057150 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m22:05:41.058018 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:41.059413 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.059908 [debug] [MainThread]: On master: BEGIN
[0m22:05:41.060346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:41.067040 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.067620 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.068079 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.068494 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.069075 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.069538 [debug] [MainThread]: On master: Close
[0m22:05:41.070925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:41.071365 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:41.071769 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:41.072227 [info ] [MainThread]: 
[0m22:05:41.072765 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.60 seconds (8.60s).
[0m22:05:41.073790 [debug] [MainThread]: Command end result
[0m22:05:41.101899 [info ] [MainThread]: 
[0m22:05:41.102577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:41.103143 [info ] [MainThread]: 
[0m22:05:41.103697 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:41.104723 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.594241, "process_user_time": 5.369708, "process_kernel_time": 0.318952, "process_mem_max_rss": "289616", "process_in_blocks": "3808", "process_out_blocks": "112712"}
[0m22:05:41.105370 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:41.105258 after 10.59 seconds
[0m22:05:41.105870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1070dd7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1070a7a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f106957f0e0>]}
[0m22:05:41.106358 [debug] [MainThread]: Flushing usage events
[0m22:05:42.795625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678c2d7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678b43dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678a1c3c50>]}


============================== 22:05:42.798502 | 33430e55-49c7-4a4f-a883-02013d4f79f1 ==============================
[0m22:05:42.798502 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.799236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.945846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33430e55-49c7-4a4f-a883-02013d4f79f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678a0f3740>]}
[0m22:05:42.962435 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21607682, "process_user_time": 1.405774, "process_kernel_time": 0.112141, "process_mem_max_rss": "92372", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:42.963063 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:42.962959 after 0.22 seconds
[0m22:05:42.963502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678ddbbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f678a1c2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6789f6c980>]}
[0m22:05:42.963939 [debug] [MainThread]: Flushing usage events
[0m06:02:59.778516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4dea6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4dea65a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4d73e3c0>]}


============================== 06:02:59.795338 | 061faba8-0898-4b70-8c84-1e2b4baf7c05 ==============================
[0m06:02:59.795338 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:59.795999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:59.932948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '061faba8-0898-4b70-8c84-1e2b4baf7c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4d55f680>]}
[0m06:02:59.945733 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-z5uacq8a'
[0m06:02:59.946224 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:00.058007 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:00.058747 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:00.093506 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:00.097321 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:00.453107 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:00.453600 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:03:00.454132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '061faba8-0898-4b70-8c84-1e2b4baf7c05', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4e60b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4e60b0b0>]}
[0m06:03:00.454598 [info ] [MainThread]: 
[0m06:03:00.455100 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:00.462601 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7336611, "process_user_time": 1.578204, "process_kernel_time": 0.079909, "process_mem_max_rss": "93900", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m06:03:00.463286 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:00.463185 after 0.73 seconds
[0m06:03:00.463726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4db039e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4d43bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4d73e4b0>]}
[0m06:03:00.464161 [debug] [MainThread]: Flushing usage events
[0m06:03:02.204342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d740ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d740a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d740a000>]}


============================== 06:03:02.207105 | cec2d4fa-29c9-4d86-af01-a45380cb2b94 ==============================
[0m06:03:02.207105 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:02.207768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:02.440489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d68be4b0>]}
[0m06:03:02.499706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d7710320>]}
[0m06:03:02.502024 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:03:02.517368 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:02.518132 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:02.518664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cf93cb00>]}
[0m06:03:03.723126 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:03.723750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cf3a13d0>]}
[0m06:03:03.906525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:03.911766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cf858950>]}
[0m06:03:04.057687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cf3e3c20>]}
[0m06:03:04.058262 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:03:04.058754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cf24a000>]}
[0m06:03:04.060508 [info ] [MainThread]: 
[0m06:03:04.061195 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:04.066041 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:04.102642 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:04.103110 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:04.103524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:05.306269 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:03:05.307852 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:05.310105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:05.310675 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:05.317907 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.318381 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:05.318784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:05.325027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.326510 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.326928 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:05.327527 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.327932 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.328318 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:05.328895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.329857 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:05.330304 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.330694 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:05.331243 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.331657 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:05.333510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:05.339198 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:05.339622 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:05.340023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:05.345777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.346245 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:05.346662 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:05.370211 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.371678 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:05.372889 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:05.373297 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:05.376496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cf249190>]}
[0m06:03:05.376974 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:05.377351 [debug] [MainThread]: On master: BEGIN
[0m06:03:05.377728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:05.384032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:05.384462 [debug] [MainThread]: On master: COMMIT
[0m06:03:05.384867 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:05.385244 [debug] [MainThread]: On master: COMMIT
[0m06:03:05.385744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:05.386178 [debug] [MainThread]: On master: Close
[0m06:03:05.387489 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:05.387981 [info ] [MainThread]: 
[0m06:03:05.397228 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:05.397777 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:05.398471 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:03:05.398923 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:05.424118 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:05.424821 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:05.460114 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:05.460840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:03:16.150896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:16.151412 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:16.152071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.152530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:16.152963 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:16.153685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.156602 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:16.157072 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:16.157771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.178697 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:16.179183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:16.179630 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:16.180830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.185770 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:16.186272 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:03:16.187515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.189813 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:16.219587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cc06c8c0>]}
[0m06:03:16.220353 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.82s]
[0m06:03:16.221229 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:16.222244 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:16.222805 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:16.223473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:16.223946 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:16.229085 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:16.229751 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:16.263789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:16.264357 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241124060316257815"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:16.264849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:16.279699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.287524 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:16.287995 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:16.288601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.289053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:16.289500 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241124060316257815'
      
      
      order by ordinal_position

  
[0m06:03:16.310296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.316608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:16.317110 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:16.320039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.327566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:16.328048 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:16.330820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.349269 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:16.349986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:16.350515 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241124060316257815"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241124060316257815"
    )
  
[0m06:03:16.384532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.386549 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:16.387019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:16.387530 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:16.395441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:16.396341 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:16.576288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec2d4fa-29c9-4d86-af01-a45380cb2b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe78baa5eb0>]}
[0m06:03:16.577099 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:03:16.577962 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:16.579366 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:16.579838 [debug] [MainThread]: On master: BEGIN
[0m06:03:16.580281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:16.586928 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:16.587415 [debug] [MainThread]: On master: COMMIT
[0m06:03:16.587863 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:16.588296 [debug] [MainThread]: On master: COMMIT
[0m06:03:16.588887 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:16.589346 [debug] [MainThread]: On master: Close
[0m06:03:16.590695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:16.591132 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:03:16.591536 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:16.591998 [info ] [MainThread]: 
[0m06:03:16.592585 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.53 seconds (12.53s).
[0m06:03:16.593704 [debug] [MainThread]: Command end result
[0m06:03:16.621318 [info ] [MainThread]: 
[0m06:03:16.622019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:16.622618 [info ] [MainThread]: 
[0m06:03:16.623226 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:16.624304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.469939, "process_user_time": 6.147501, "process_kernel_time": 0.363497, "process_mem_max_rss": "294596", "process_in_blocks": "3808", "process_out_blocks": "113200"}
[0m06:03:16.624952 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:16.624842 after 14.47 seconds
[0m06:03:16.625451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7a0f05700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7da7bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7cf858170>]}
[0m06:03:16.625941 [debug] [MainThread]: Flushing usage events
[0m06:03:18.445568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fb17bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fac305f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fb1a5ca0>]}


============================== 06:03:18.448408 | 3c950392-af59-44b5-b72b-f36d4214eef9 ==============================
[0m06:03:18.448408 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:18.449081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:18.594987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c950392-af59-44b5-b72b-f36d4214eef9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fa662e70>]}
[0m06:03:18.611890 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21915497, "process_user_time": 1.392755, "process_kernel_time": 0.123711, "process_mem_max_rss": "92420", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:18.612472 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:18.612366 after 0.22 seconds
[0m06:03:18.612916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fa9078c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fa591400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fb0b19d0>]}
[0m06:03:18.613358 [debug] [MainThread]: Flushing usage events
[0m14:05:06.627020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c01e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350bca42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c01eed0>]}


============================== 14:05:06.678960 | 068e4fe8-5337-4324-942d-95077e890aa1 ==============================
[0m14:05:06.678960 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:06.679741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:06.823534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '068e4fe8-5337-4324-942d-95077e890aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350b544830>]}
[0m14:05:06.837108 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tjo50718'
[0m14:05:06.837582 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:06.957855 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:06.958589 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:06.990204 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:06.994266 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:07.354291 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:07.354867 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:07.355381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '068e4fe8-5337-4324-942d-95077e890aa1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350b67ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350b5ec410>]}
[0m14:05:07.355854 [info ] [MainThread]: 
[0m14:05:07.356328 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:07.361873 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.783776, "process_user_time": 1.60362, "process_kernel_time": 0.109062, "process_mem_max_rss": "93924", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:07.362480 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:07.362378 after 0.78 seconds
[0m14:05:07.362923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350bdd86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c8a6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1aa780>]}
[0m14:05:07.363357 [debug] [MainThread]: Flushing usage events
[0m14:05:09.165040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc372134b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3720f39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3722d52b0>]}


============================== 14:05:09.167830 | 25b62693-8c65-4fdd-a932-5aa23438bccb ==============================
[0m14:05:09.167830 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:09.168548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:09.402568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc371c10cb0>]}
[0m14:05:09.461578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc371c10cb0>]}
[0m14:05:09.464154 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:09.487399 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:09.488140 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:09.488686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc371c01790>]}
[0m14:05:10.711650 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:10.712334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36aa0c260>]}
[0m14:05:10.894910 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:10.900296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36aacd820>]}
[0m14:05:11.052095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36a9af740>]}
[0m14:05:11.052724 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:11.053253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36a591100>]}
[0m14:05:11.055022 [info ] [MainThread]: 
[0m14:05:11.055766 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:11.060658 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:11.098124 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:11.098607 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:11.099009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:11.645091 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:11.646622 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:11.648693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:11.649251 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:11.656276 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.656746 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:11.657143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:11.663408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.664884 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.665291 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:11.665828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.666231 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.666608 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:11.667193 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.668105 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:11.668506 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:11.668930 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:11.669466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.669869 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:11.671782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:11.677388 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:11.677803 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:11.678175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:11.683663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.684072 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:11.684477 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:11.707772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:11.709483 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:11.710731 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:11.711142 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:11.714813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36a48a570>]}
[0m14:05:11.715346 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:11.715745 [debug] [MainThread]: On master: BEGIN
[0m14:05:11.716119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:11.722597 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:11.723027 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.723414 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:11.723785 [debug] [MainThread]: On master: COMMIT
[0m14:05:11.724305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:11.724745 [debug] [MainThread]: On master: Close
[0m14:05:11.726135 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:11.726634 [info ] [MainThread]: 
[0m14:05:11.736670 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:11.737275 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:11.737936 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:11.738381 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:11.764131 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:11.764906 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:11.800614 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:11.801394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:23.563321 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.563847 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:23.564522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.565016 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.565459 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:23.566181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.569084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.569548 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:23.570230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.591097 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.591581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.592023 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.594015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.599224 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.599694 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:23.601420 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.603738 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:23.633598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc332b38a40>]}
[0m14:05:23.634342 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.89s]
[0m14:05:23.635112 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:23.636109 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:23.636705 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:23.637291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:23.637754 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:23.642933 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:23.643602 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:23.677197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.677721 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241124140523671280"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:23.678201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:23.693413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.701225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.701704 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:23.702319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.702788 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.703228 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241124140523671280'
      
      
      order by ordinal_position

  
[0m14:05:23.723874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.730274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.730760 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.733651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.741167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.741648 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.745832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.763719 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:23.764419 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.764932 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241124140523671280"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241124140523671280"
    )
  
[0m14:05:23.801297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.803347 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.803812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.804245 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.812084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.813013 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:23.969308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25b62693-8c65-4fdd-a932-5aa23438bccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3732b9430>]}
[0m14:05:23.970168 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:05:23.970946 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:23.972324 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.972843 [debug] [MainThread]: On master: BEGIN
[0m14:05:23.973281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:23.979922 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.980404 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.980903 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.981336 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.981905 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.982364 [debug] [MainThread]: On master: Close
[0m14:05:23.983765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:23.984204 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:23.984649 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:23.985121 [info ] [MainThread]: 
[0m14:05:23.985723 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.93 seconds (12.93s).
[0m14:05:23.986841 [debug] [MainThread]: Command end result
[0m14:05:24.014733 [info ] [MainThread]: 
[0m14:05:24.015432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:24.016030 [info ] [MainThread]: 
[0m14:05:24.016655 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:24.017746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.901887, "process_user_time": 5.533565, "process_kernel_time": 0.351845, "process_mem_max_rss": "296320", "process_in_blocks": "3808", "process_out_blocks": "113704"}
[0m14:05:24.018395 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:24.018285 after 14.90 seconds
[0m14:05:24.018894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc372134b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc372da2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc332df6b40>]}
[0m14:05:24.019392 [debug] [MainThread]: Flushing usage events
[0m14:05:25.854591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdcc81f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdca8df080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdca8df0e0>]}


============================== 14:05:25.857464 | 5dd72a9c-aa84-4ea1-8792-866a775c503e ==============================
[0m14:05:25.857464 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.858132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.999135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dd72a9c-aa84-4ea1-8792-866a775c503e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdca90aea0>]}
[0m14:05:26.015628 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21056926, "process_user_time": 1.384981, "process_kernel_time": 0.124087, "process_mem_max_rss": "92512", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:26.016225 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:26.016121 after 0.21 seconds
[0m14:05:26.016703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdca852a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdcb730d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdca6b7050>]}
[0m14:05:26.017139 [debug] [MainThread]: Flushing usage events
[0m22:05:29.544324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5420770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c3f9c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c3984260>]}


============================== 22:05:29.565931 | e6550fa0-73c5-4aff-9b77-04870d2d1adc ==============================
[0m22:05:29.565931 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:29.566632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:29.715699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6550fa0-73c5-4aff-9b77-04870d2d1adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c39eb590>]}
[0m22:05:29.729595 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g2eu34o8'
[0m22:05:29.730091 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:29.789219 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:29.789890 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:29.801110 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:29.805122 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:29.873862 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:29.874431 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:29.874974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e6550fa0-73c5-4aff-9b77-04870d2d1adc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c39a79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c39a4530>]}
[0m22:05:29.875454 [info ] [MainThread]: 
[0m22:05:29.875948 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:29.889000 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39423224, "process_user_time": 1.61996, "process_kernel_time": 0.117741, "process_mem_max_rss": "93828", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:05:29.889711 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:29.889606 after 0.40 seconds
[0m22:05:29.890156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c388d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c3bc2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c38d1d90>]}
[0m22:05:29.890593 [debug] [MainThread]: Flushing usage events
[0m22:05:31.465383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07280da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb070757ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb070f3b020>]}


============================== 22:05:31.468294 | a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7 ==============================
[0m22:05:31.468294 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:31.468930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:31.714659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0693177d0>]}
[0m22:05:31.774049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0693c5490>]}
[0m22:05:31.779252 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:31.807795 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:31.808571 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:31.809118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07050fbc0>]}
[0m22:05:33.036512 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:33.037199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068df8bc0>]}
[0m22:05:33.221348 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:33.226589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb069140c20>]}
[0m22:05:33.446483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068b22c90>]}
[0m22:05:33.447077 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:33.447654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068b8f1d0>]}
[0m22:05:33.449445 [info ] [MainThread]: 
[0m22:05:33.450199 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:33.455255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:33.492863 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:33.493361 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:33.493766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:34.180674 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:34.182226 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:34.184383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:34.184948 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:34.192070 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.192506 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:34.192904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:34.199167 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.200633 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.201041 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:34.201656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.202062 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.202447 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:34.203010 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.203965 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:34.204369 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:34.204745 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:34.205288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.205703 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:34.207648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:34.213296 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:34.213715 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:34.214093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:34.220020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.220435 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:34.220832 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:34.244262 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:34.245814 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:34.247048 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:34.247496 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:34.251186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068b80380>]}
[0m22:05:34.251741 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.252138 [debug] [MainThread]: On master: BEGIN
[0m22:05:34.252514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:34.259484 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.259931 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.260327 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:34.260702 [debug] [MainThread]: On master: COMMIT
[0m22:05:34.261250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:34.261665 [debug] [MainThread]: On master: Close
[0m22:05:34.263401 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:34.263938 [info ] [MainThread]: 
[0m22:05:34.273481 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:34.274093 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:34.274841 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:34.275342 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:34.301974 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:34.302776 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:34.339589 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:34.340412 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:41.626866 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.627414 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:41.628082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.628539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.628977 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:41.629686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.632657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.633123 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:41.633808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.654387 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:41.654872 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.655338 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:41.656700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.661613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.662083 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:41.663326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.665654 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:41.694864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068b22240>]}
[0m22:05:41.695693 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.42s]
[0m22:05:41.696458 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:41.697487 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:41.698057 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:41.698631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:41.699087 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:41.704435 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:41.705101 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:41.738724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.739336 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241124220541732803"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:41.739826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:41.754710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.762469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.762949 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:41.763603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.764050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.764492 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241124220541732803'
      
      
      order by ordinal_position

  
[0m22:05:41.785343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.791945 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.792442 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:41.795950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.803570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.804057 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:41.808298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.826213 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:41.826938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.827458 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241124220541732803"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241124220541732803"
    )
  
[0m22:05:41.863931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.865977 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:41.866442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.866879 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:41.875719 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.876624 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:42.035344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a861cfd9-37cb-4d04-928b-a3a5f6e2c2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02c851e50>]}
[0m22:05:42.036184 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:05:42.037069 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:42.038670 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.039184 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.039633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:42.046581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.047078 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.047567 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.047998 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.048596 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.049061 [debug] [MainThread]: On master: Close
[0m22:05:42.050711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:42.051187 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:42.051609 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:42.052079 [info ] [MainThread]: 
[0m22:05:42.052691 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.60 seconds (8.60s).
[0m22:05:42.053860 [debug] [MainThread]: Command end result
[0m22:05:42.082282 [info ] [MainThread]: 
[0m22:05:42.083022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:42.083646 [info ] [MainThread]: 
[0m22:05:42.084258 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:42.085373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.669682, "process_user_time": 5.83217, "process_kernel_time": 0.296618, "process_mem_max_rss": "296036", "process_in_blocks": "3808", "process_out_blocks": "114248"}
[0m22:05:42.086021 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:42.085909 after 10.67 seconds
[0m22:05:42.086521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb070ddb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068b22e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb068099190>]}
[0m22:05:42.087012 [debug] [MainThread]: Flushing usage events
[0m22:05:43.729323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b855575f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b85fc0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8569e4e0>]}


============================== 22:05:43.732234 | b43dbe81-7830-467c-9fa5-78442d0afa17 ==============================
[0m22:05:43.732234 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:43.732902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:43.879290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b43dbe81-7830-467c-9fa5-78442d0afa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b85a45700>]}
[0m22:05:43.895809 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21540135, "process_user_time": 1.432294, "process_kernel_time": 0.079793, "process_mem_max_rss": "92172", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:43.896399 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:43.896296 after 0.22 seconds
[0m22:05:43.896849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b893bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b854a7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b856fa240>]}
[0m22:05:43.897288 [debug] [MainThread]: Flushing usage events
[0m06:02:19.430661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89614058e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896128dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8961fa4d10>]}


============================== 06:02:19.467757 | 7c3a816e-05e3-4c3e-8f48-66b13587fe38 ==============================
[0m06:02:19.467757 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.468430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:19.616745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c3a816e-05e3-4c3e-8f48-66b13587fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89616bcc50>]}
[0m06:02:19.630541 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-teiqo745'
[0m06:02:19.631028 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:19.645565 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:19.646217 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:19.656852 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:19.660779 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:19.836824 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:19.837447 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:19.838050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7c3a816e-05e3-4c3e-8f48-66b13587fe38', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89610b7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89610b4f20>]}
[0m06:02:19.838516 [info ] [MainThread]: 
[0m06:02:19.839042 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:19.856153 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4741693, "process_user_time": 1.553302, "process_kernel_time": 0.15252, "process_mem_max_rss": "93812", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:19.856772 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:19.856667 after 0.47 seconds
[0m06:02:19.857217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8964f67e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8962164110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8961099370>]}
[0m06:02:19.857653 [debug] [MainThread]: Flushing usage events
[0m06:02:21.455489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff662cd7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff662b7a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff664977740>]}


============================== 06:02:21.458318 | b22cf613-ba28-4b6c-b41b-a658108fb422 ==============================
[0m06:02:21.458318 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.458956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.693264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66297e450>]}
[0m06:02:21.752515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6626ba7e0>]}
[0m06:02:21.755053 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:21.778805 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:21.779589 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:21.780125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65b653710>]}
[0m06:02:23.010282 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:23.010972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65b63d2b0>]}
[0m06:02:23.193436 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:23.198601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65af715e0>]}
[0m06:02:23.337034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65b1fc170>]}
[0m06:02:23.337601 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:23.338108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65af71040>]}
[0m06:02:23.339837 [info ] [MainThread]: 
[0m06:02:23.340534 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:23.345190 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:23.382329 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:23.382814 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:23.383352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:23.877760 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.879365 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:23.881509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:23.882109 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:23.889279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.889719 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:23.890114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:23.896351 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.897787 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.898193 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:23.898735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.899165 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.899569 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:23.900154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.901072 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:23.901490 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:23.901880 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:23.902467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.902877 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:23.904769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:23.910304 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:23.910720 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:23.911095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:23.916899 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.917316 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:23.917713 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:23.941441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:23.943062 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:23.944389 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:23.944810 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:23.948429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65b0e6cf0>]}
[0m06:02:23.948957 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.949353 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.949727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:23.956231 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.956659 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.957052 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.957429 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.958019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.958427 [debug] [MainThread]: On master: Close
[0m06:02:23.960020 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:23.960537 [info ] [MainThread]: 
[0m06:02:23.970046 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:23.970652 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:23.971336 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:23.971790 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:23.997737 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:23.998507 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:24.034453 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:24.035268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:32.048703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.049252 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:32.049937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.050398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.050843 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:32.051661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.054707 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.055197 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:32.055908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.077990 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:32.078521 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.078993 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:32.080718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.085817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.086289 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:32.087630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.090011 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:32.119851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6205f0e00>]}
[0m06:02:32.120609 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.15s]
[0m06:02:32.121378 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:32.122371 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:32.122931 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:32.123536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:32.123996 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:32.129224 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:32.129892 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:32.163687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.164221 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241125060232157689"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:32.164722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:32.178713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.186209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.186680 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:32.187299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.187755 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.188206 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241125060232157689'
      
      
      order by ordinal_position

  
[0m06:02:32.209203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.215425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.215917 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.219012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.226523 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.227004 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.230011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.247966 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:32.248663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.249137 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241125060232157689"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241125060232157689"
    )
  
[0m06:02:32.281731 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.283853 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.284322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.284755 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.293194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.294144 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:32.459992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b22cf613-ba28-4b6c-b41b-a658108fb422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61394fcb0>]}
[0m06:02:32.460834 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:32.461840 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:32.463397 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.463879 [debug] [MainThread]: On master: BEGIN
[0m06:02:32.464317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:32.471001 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.471508 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.471952 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.472377 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.472977 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.473432 [debug] [MainThread]: On master: Close
[0m06:02:32.474758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:32.475237 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:32.475648 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:32.476111 [info ] [MainThread]: 
[0m06:02:32.476663 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.14 seconds (9.14s).
[0m06:02:32.477699 [debug] [MainThread]: Command end result
[0m06:02:32.505695 [info ] [MainThread]: 
[0m06:02:32.506344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:32.506882 [info ] [MainThread]: 
[0m06:02:32.507504 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:32.508602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.10241, "process_user_time": 5.494661, "process_kernel_time": 0.367108, "process_mem_max_rss": "295516", "process_in_blocks": "3808", "process_out_blocks": "114216"}
[0m06:02:32.509264 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:32.509151 after 11.10 seconds
[0m06:02:32.509757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6632342f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff662b4b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65b00b020>]}
[0m06:02:32.510248 [debug] [MainThread]: Flushing usage events
[0m06:02:34.244146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14d0749e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14b7411f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14b002f90>]}


============================== 06:02:34.246901 | 7562e597-995f-48b9-b991-84284d8685e7 ==============================
[0m06:02:34.246901 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:34.247578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:34.386097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7562e597-995f-48b9-b991-84284d8685e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14b07cfe0>]}
[0m06:02:34.402497 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20734718, "process_user_time": 1.393001, "process_kernel_time": 0.11208, "process_mem_max_rss": "92244", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:34.403072 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:34.402972 after 0.21 seconds
[0m06:02:34.403590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14b50a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14bcc09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14ac8b920>]}
[0m06:02:34.404015 [debug] [MainThread]: Flushing usage events
[0m14:05:29.552763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052f148590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052f1480b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052f14b440>]}


============================== 14:05:29.560551 | 3d6a9d79-40e6-4930-8f1f-9edca06815d2 ==============================
[0m14:05:29.560551 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.561247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.707086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d6a9d79-40e6-4930-8f1f-9edca06815d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052f1ac8f0>]}
[0m14:05:29.720682 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lz__wmkf'
[0m14:05:29.721146 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:29.836549 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:29.837322 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:29.848129 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:29.852081 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:29.897703 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:29.898308 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:29.898866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3d6a9d79-40e6-4930-8f1f-9edca06815d2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052f08e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052f0c7260>]}
[0m14:05:29.899329 [info ] [MainThread]: 
[0m14:05:29.899840 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:29.901479 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39715007, "process_user_time": 1.531622, "process_kernel_time": 0.171064, "process_mem_max_rss": "93612", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:29.902076 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:29.901973 after 0.40 seconds
[0m14:05:29.902513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052f761340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052f0813a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052f03c770>]}
[0m14:05:29.902962 [debug] [MainThread]: Flushing usage events
[0m14:05:31.465210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef9feb47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefa0245070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef9f6db140>]}


============================== 14:05:31.468001 | d43232d4-792b-4be4-b06c-373eb7d9ea25 ==============================
[0m14:05:31.468001 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.468672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.703131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef9f982300>]}
[0m14:05:31.762034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef98447f80>]}
[0m14:05:31.764672 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:31.780840 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:31.781613 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:31.782127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef98446870>]}
[0m14:05:32.997644 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:32.998297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef982e1e80>]}
[0m14:05:33.181190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:33.186445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef93d804a0>]}
[0m14:05:33.317281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef981005f0>]}
[0m14:05:33.317860 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:33.318375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef93d80f20>]}
[0m14:05:33.320163 [info ] [MainThread]: 
[0m14:05:33.320935 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:33.325827 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:33.363228 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:33.363710 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:33.364109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:33.905106 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:33.906675 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:33.908757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:33.909316 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:33.916503 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.916935 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:33.917326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:33.923556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.925034 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.925436 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:33.925978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.926373 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.926748 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:33.927328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.928232 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:33.928676 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:33.929055 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:33.929609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.930013 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:33.931867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:33.937464 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:33.937948 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:33.938326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:33.944103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.944562 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:33.944960 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:33.968182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:33.969668 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:33.970882 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:33.971286 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:33.974687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef98156330>]}
[0m14:05:33.975201 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:33.975593 [debug] [MainThread]: On master: BEGIN
[0m14:05:33.975956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:33.982223 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:33.982641 [debug] [MainThread]: On master: COMMIT
[0m14:05:33.983030 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:33.983403 [debug] [MainThread]: On master: COMMIT
[0m14:05:33.983957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:33.984400 [debug] [MainThread]: On master: Close
[0m14:05:33.985885 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:33.986386 [info ] [MainThread]: 
[0m14:05:33.996231 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:33.996847 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:33.997509 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:33.997953 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:34.023819 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:34.024618 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:34.060501 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:34.061294 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:40.434216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.434741 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:40.435421 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.435878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.436355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:40.437080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.439954 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.440468 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:40.441152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.461665 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:40.462139 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.462573 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:40.464324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.469155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.469614 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:40.470825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.473155 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:40.503103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef9819bb30>]}
[0m14:05:40.503863 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.50s]
[0m14:05:40.504662 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:40.505684 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:40.506304 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:40.507046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:40.507512 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:40.512785 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:40.513454 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:40.547542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.548122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241125140540541598"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:40.548630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:40.564215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.572009 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.572516 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:40.573136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.573581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.574016 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241125140540541598'
      
      
      order by ordinal_position

  
[0m14:05:40.604557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.610957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.611439 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:40.614297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.621981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.622469 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:40.625345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.643595 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:40.644436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.644931 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241125140540541598"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241125140540541598"
    )
  
[0m14:05:40.677843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.679938 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:40.680471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.680913 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:40.689409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.690413 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:40.849561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43232d4-792b-4be4-b06c-373eb7d9ea25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c7ceae0>]}
[0m14:05:40.850444 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:40.851370 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:40.852924 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:40.853441 [debug] [MainThread]: On master: BEGIN
[0m14:05:40.853886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:40.860917 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:40.861393 [debug] [MainThread]: On master: COMMIT
[0m14:05:40.861836 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:40.862262 [debug] [MainThread]: On master: COMMIT
[0m14:05:40.862840 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:40.863297 [debug] [MainThread]: On master: Close
[0m14:05:40.864890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:40.865337 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:40.865746 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:40.866227 [info ] [MainThread]: 
[0m14:05:40.866769 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m14:05:40.867781 [debug] [MainThread]: Command end result
[0m14:05:40.896151 [info ] [MainThread]: 
[0m14:05:40.896818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:40.897327 [info ] [MainThread]: 
[0m14:05:40.897860 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:40.898883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.482599, "process_user_time": 5.590574, "process_kernel_time": 0.317281, "process_mem_max_rss": "291428", "process_in_blocks": "3808", "process_out_blocks": "114736"}
[0m14:05:40.899535 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:40.899424 after 9.48 seconds
[0m14:05:40.900042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef9fc0c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef63fd4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef92887050>]}
[0m14:05:40.900566 [debug] [MainThread]: Flushing usage events
[0m14:05:42.575553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4b0b6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4b533ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4bcf6a80>]}


============================== 14:05:42.578306 | 765ca646-fbed-4340-be92-98e95559d594 ==============================
[0m14:05:42.578306 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:42.578974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:42.723780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '765ca646-fbed-4340-be92-98e95559d594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4b5c2090>]}
[0m14:05:42.740602 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21407531, "process_user_time": 1.441367, "process_kernel_time": 0.10381, "process_mem_max_rss": "92172", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:42.741205 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:42.741091 after 0.21 seconds
[0m14:05:42.741657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4cfae0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4a911d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4aa3bfe0>]}
[0m14:05:42.742114 [debug] [MainThread]: Flushing usage events
[0m22:06:08.120983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03740dc200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03740de600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03740dd2b0>]}


============================== 22:06:08.129371 | a8527b91-36e1-4f2e-818e-d562e3f18a4e ==============================
[0m22:06:08.129371 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:08.130146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:08.276813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8527b91-36e1-4f2e-818e-d562e3f18a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0373931ac0>]}
[0m22:06:08.290437 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vo3aau4t'
[0m22:06:08.290910 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:08.430425 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:08.431162 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:08.468457 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:08.472560 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:08.831325 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:08.831921 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:08.832443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a8527b91-36e1-4f2e-818e-d562e3f18a4e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03736861b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f037379c860>]}
[0m22:06:08.832901 [info ] [MainThread]: 
[0m22:06:08.833404 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:08.836366 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.76460266, "process_user_time": 1.595025, "process_kernel_time": 0.119926, "process_mem_max_rss": "93596", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:06:08.836973 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:08.836869 after 0.77 seconds
[0m22:06:08.837415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0376cddc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0373937a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0374690bf0>]}
[0m22:06:08.837853 [debug] [MainThread]: Flushing usage events
[0m22:06:10.657591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b78b6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b748f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b748db20>]}


============================== 22:06:10.660657 | 946b0b4e-9137-410f-9081-8ef64c6f2c24 ==============================
[0m22:06:10.660657 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:10.661381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:10.907852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b83261b0>]}
[0m22:06:10.970770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b0380a40>]}
[0m22:06:10.973538 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:11.014367 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:11.015131 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:11.015675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b72c48f0>]}
[0m22:06:12.258309 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:12.258988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b01d40e0>]}
[0m22:06:12.442735 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:12.447981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b7264aa0>]}
[0m22:06:12.578196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b73efec0>]}
[0m22:06:12.578781 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:12.579271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b89b0ec0>]}
[0m22:06:12.580979 [info ] [MainThread]: 
[0m22:06:12.581693 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:12.586492 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:12.623762 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:12.624260 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:12.624676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:13.143152 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:13.144718 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:13.146816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:13.147384 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:13.154555 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:13.155000 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:13.155399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:13.161639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:13.163116 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:13.163522 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:13.164076 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:13.164474 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:13.164858 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:13.165427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:13.166381 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:13.166797 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:13.167187 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:13.167753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:13.168165 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:13.170054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:13.175614 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:13.176032 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:13.176410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:13.182176 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:13.182606 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:13.183012 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:13.206513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:13.207946 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:13.209161 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:13.209575 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:13.212879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b89b1460>]}
[0m22:06:13.213397 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:13.213790 [debug] [MainThread]: On master: BEGIN
[0m22:06:13.214209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:13.220374 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:13.220813 [debug] [MainThread]: On master: COMMIT
[0m22:06:13.221209 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:13.221586 [debug] [MainThread]: On master: COMMIT
[0m22:06:13.222154 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:13.222563 [debug] [MainThread]: On master: Close
[0m22:06:13.224048 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:13.224585 [info ] [MainThread]: 
[0m22:06:13.235488 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:13.236075 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:13.236805 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:13.237266 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:13.263522 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:13.264280 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:13.300407 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:13.301151 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:27.761138 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:27.761657 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:27.762384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.762850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:27.763292 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:27.764040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.766945 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:27.767411 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:27.768119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.788996 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:27.789504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:27.789975 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:27.791165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.796110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:27.796587 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:27.797825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.800160 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:27.830771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90705427b0>]}
[0m22:06:27.831572 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.59s]
[0m22:06:27.832505 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:27.833527 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:27.834125 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:27.834820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:27.835287 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:27.840631 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:27.841303 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:27.875208 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:27.875732 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241125220627869259"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:27.876211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:27.891462 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.898857 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:27.899330 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:27.899944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.900393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:27.900827 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241125220627869259'
      
      
      order by ordinal_position

  
[0m22:06:27.922020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.928503 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:27.929002 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:27.931918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.939578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:27.940056 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:27.943497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:27.961656 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:27.962393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:27.962870 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241125220627869259"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241125220627869259"
    )
  
[0m22:06:28.001558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:28.003650 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:28.004146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:28.004583 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:28.034157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:28.035408 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:28.209688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '946b0b4e-9137-410f-9081-8ef64c6f2c24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90704f21b0>]}
[0m22:06:28.210555 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:28.211319 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:28.212766 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:28.213240 [debug] [MainThread]: On master: BEGIN
[0m22:06:28.213679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:28.220538 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:28.221057 [debug] [MainThread]: On master: COMMIT
[0m22:06:28.221497 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:28.221971 [debug] [MainThread]: On master: COMMIT
[0m22:06:28.222565 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:28.223033 [debug] [MainThread]: On master: Close
[0m22:06:28.224635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:28.225075 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:28.225484 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:28.226000 [info ] [MainThread]: 
[0m22:06:28.226559 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.64 seconds (15.64s).
[0m22:06:28.227612 [debug] [MainThread]: Command end result
[0m22:06:28.256041 [info ] [MainThread]: 
[0m22:06:28.256765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:28.257316 [info ] [MainThread]: 
[0m22:06:28.257905 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:28.258972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.654047, "process_user_time": 5.451257, "process_kernel_time": 0.356212, "process_mem_max_rss": "287288", "process_in_blocks": "3808", "process_out_blocks": "114760"}
[0m22:06:28.259622 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:28.259512 after 17.65 seconds
[0m22:06:28.260136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90badbbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b7bf8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90abb80b90>]}
[0m22:06:28.260641 [debug] [MainThread]: Flushing usage events
[0m22:06:30.113012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb343d7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb343a5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb34745070>]}


============================== 22:06:30.116135 | 91279af7-9624-4ec9-af32-80986b622237 ==============================
[0m22:06:30.116135 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:30.116850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:30.263478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91279af7-9624-4ec9-af32-80986b622237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb341bcfe0>]}
[0m22:06:30.280358 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22013128, "process_user_time": 1.464046, "process_kernel_time": 0.092002, "process_mem_max_rss": "92268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:30.280956 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:30.280850 after 0.22 seconds
[0m22:06:30.281412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb344e23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb34161dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb341d9970>]}
[0m22:06:30.281847 [debug] [MainThread]: Flushing usage events
[0m06:02:14.665073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa403f6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa407d99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa40ba28d0>]}


============================== 06:02:14.691629 | 1bad7a31-3f7f-44f8-8919-1c8c0a21dc7c ==============================
[0m06:02:14.691629 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.692279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.828999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bad7a31-3f7f-44f8-8919-1c8c0a21dc7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa4085cd70>]}
[0m06:02:14.842264 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sibrda46'
[0m06:02:14.842715 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.897916 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.898526 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.922473 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.926332 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:14.998028 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:14.998537 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:14.999051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1bad7a31-3f7f-44f8-8919-1c8c0a21dc7c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa40138e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa41307050>]}
[0m06:02:14.999492 [info ] [MainThread]: 
[0m06:02:14.999976 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:15.034775 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41868612, "process_user_time": 1.563411, "process_kernel_time": 0.13297, "process_mem_max_rss": "93676", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m06:02:15.035362 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:15.035258 after 0.42 seconds
[0m06:02:15.035794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa43dbbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa40ba2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa40c37b00>]}
[0m06:02:15.036220 [debug] [MainThread]: Flushing usage events
[0m06:02:16.739384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dd64bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dcd76ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dd6a8cb0>]}


============================== 06:02:16.742037 | 94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388 ==============================
[0m06:02:16.742037 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.742678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.971368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dca6bef0>]}
[0m06:02:17.029135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dd873860>]}
[0m06:02:17.031533 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:17.055405 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:17.056113 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:17.056648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dca1deb0>]}
[0m06:02:18.276114 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:18.276779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d59b8800>]}
[0m06:02:18.455904 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:18.460879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d5a616a0>]}
[0m06:02:18.588600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d59df500>]}
[0m06:02:18.589136 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:18.589659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d540d6d0>]}
[0m06:02:18.591316 [info ] [MainThread]: 
[0m06:02:18.591965 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.596752 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.632750 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.633202 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:18.633608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:19.103968 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.105529 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:19.107665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:19.108230 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:19.115336 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.115771 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:19.116171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.122237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.123640 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.124044 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:19.124647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.125048 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.125430 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:19.126041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.126957 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.127359 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.127750 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.128288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.128719 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:19.130573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:19.136053 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.136478 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:19.136860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.142292 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.142703 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.143100 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:19.167828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.169252 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:19.170489 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:19.170901 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:19.174058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d55b10d0>]}
[0m06:02:19.174568 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.174958 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.175330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:19.181414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.181872 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.182264 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.182643 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.183171 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.183576 [debug] [MainThread]: On master: Close
[0m06:02:19.184962 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:19.185446 [info ] [MainThread]: 
[0m06:02:19.205924 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:19.206510 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:19.207129 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:19.207577 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:19.233618 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:19.234409 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:19.270303 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:19.271041 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:27.114339 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.114849 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:27.115513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.115973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.116407 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:27.117149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.119996 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.120455 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:27.121136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.141857 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.142342 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.142796 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.144071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.148914 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.149389 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:27.150560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.152816 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:27.182257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd895ea7890>]}
[0m06:02:27.182957 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.97s]
[0m06:02:27.183710 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:27.184531 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:27.185109 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:27.185982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:27.186455 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:27.191386 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:27.192040 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:27.225546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.226078 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241126060227219674"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:27.226558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:27.241112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.248467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.248934 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:27.249524 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.249998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.250434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241126060227219674'
      
      
      order by ordinal_position

  
[0m06:02:27.271840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.277876 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.278364 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.282745 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.290164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.290645 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.293372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.311075 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:27.311759 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.312228 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241126060227219674"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241126060227219674"
    )
  
[0m06:02:27.344668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.346649 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.347109 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.347545 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.356186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.357068 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:27.526463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94e3c8ed-d86a-49c3-b7d2-ae68c3ee1388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8d5a4ab40>]}
[0m06:02:27.527230 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:27.527964 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:27.529368 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.529910 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.530347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:27.536987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.537455 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.537927 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.538351 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.538970 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.539422 [debug] [MainThread]: On master: Close
[0m06:02:27.540871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:27.541309 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:27.541758 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:27.542224 [info ] [MainThread]: 
[0m06:02:27.542813 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m06:02:27.543928 [debug] [MainThread]: Command end result
[0m06:02:27.571636 [info ] [MainThread]: 
[0m06:02:27.572324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:27.572938 [info ] [MainThread]: 
[0m06:02:27.573542 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:27.575575 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.886217, "process_user_time": 5.314764, "process_kernel_time": 0.314978, "process_mem_max_rss": "302156", "process_in_blocks": "3808", "process_out_blocks": "115264"}
[0m06:02:27.576225 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:27.576114 after 10.89 seconds
[0m06:02:27.576720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8de3139b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dcd15220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8dd19c5c0>]}
[0m06:02:27.577230 [debug] [MainThread]: Flushing usage events
[0m06:02:29.242432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5537de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a548a7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a559b8680>]}


============================== 06:02:29.245076 | d1917a47-2c46-40e1-b812-cc583c396ccd ==============================
[0m06:02:29.245076 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.245816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.381270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1917a47-2c46-40e1-b812-cc583c396ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a54e0cc50>]}
[0m06:02:29.397692 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20431073, "process_user_time": 1.42103, "process_kernel_time": 0.068241, "process_mem_max_rss": "92444", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:29.398263 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:29.398157 after 0.20 seconds
[0m06:02:29.398690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a54345fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a559b8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a548517f0>]}
[0m06:02:29.399113 [debug] [MainThread]: Flushing usage events
[0m14:05:33.198434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a88b52cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a87808e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a86780ce0>]}


============================== 14:05:33.206273 | 3e89e370-a745-4f18-a766-b88d7037b266 ==============================
[0m14:05:33.206273 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.206973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.347408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e89e370-a745-4f18-a766-b88d7037b266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a867cf650>]}
[0m14:05:33.361210 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d5a4zw2y'
[0m14:05:33.361677 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:33.428140 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:33.428936 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:33.451939 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:33.456034 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:33.540061 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:33.540693 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:33.541330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3e89e370-a745-4f18-a766-b88d7037b266', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a864d61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a864c5d60>]}
[0m14:05:33.541825 [info ] [MainThread]: 
[0m14:05:33.542397 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:33.547904 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39800626, "process_user_time": 1.695308, "process_kernel_time": 0.10445, "process_mem_max_rss": "93716", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m14:05:33.548628 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:33.548514 after 0.40 seconds
[0m14:05:33.549109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a86a32210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a8749e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a8749d8e0>]}
[0m14:05:33.549569 [debug] [MainThread]: Flushing usage events
[0m14:05:35.258639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f7e23ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f7e7b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f7e20b60>]}


============================== 14:05:35.261568 | d0e467ef-c8f6-4d14-bab1-495ad795ba86 ==============================
[0m14:05:35.261568 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:35.262291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.499876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f74bc380>]}
[0m14:05:35.558980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f7530320>]}
[0m14:05:35.561588 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:35.577383 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:35.578097 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:35.578646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f74be0f0>]}
[0m14:05:36.826806 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:36.827413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f01a8f80>]}
[0m14:05:37.011719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:37.017145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f02ed280>]}
[0m14:05:37.172453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f015b1d0>]}
[0m14:05:37.173049 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:37.173570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e3d8c4a0>]}
[0m14:05:37.175356 [info ] [MainThread]: 
[0m14:05:37.176137 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:37.181167 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:37.219043 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:37.219552 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:37.220026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:37.842514 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:37.844101 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:37.846281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:37.846854 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:37.853985 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:37.854424 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:37.854823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:37.861011 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.862447 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:37.862852 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:37.863473 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.863922 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:37.864307 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:37.864877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.865872 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:37.866280 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:37.866666 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:37.867208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.867650 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:37.869545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:37.875135 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:37.875558 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:37.875981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:37.881911 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.882339 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:37.882740 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:37.906182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.907705 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:37.908960 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:37.909370 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:37.912975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f7f22480>]}
[0m14:05:37.913492 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:37.913885 [debug] [MainThread]: On master: BEGIN
[0m14:05:37.914255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:37.920689 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:37.921119 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.921509 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:37.921879 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.922404 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:37.922809 [debug] [MainThread]: On master: Close
[0m14:05:37.924224 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:37.924749 [info ] [MainThread]: 
[0m14:05:37.934642 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:37.935266 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:37.936043 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:37.936502 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:37.962747 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:37.963530 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:37.999743 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:38.000523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:45.445064 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.445919 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:45.446934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.447692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.448448 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:45.449590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.454841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.455639 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:45.456768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.494899 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:45.495813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.496628 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:45.499083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.507855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:45.508666 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:45.510853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.514807 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:45.546468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b0e50ef0>]}
[0m14:05:45.547298 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.61s]
[0m14:05:45.548080 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:45.549065 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:45.549629 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:45.550217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:45.550679 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:45.556068 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:45.556737 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:45.590677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.591280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241126140545584597"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:45.591786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:45.605719 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.613766 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.614310 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:45.615048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.615499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.615979 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241126140545584597'
      
      
      order by ordinal_position

  
[0m14:05:45.637033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.644176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.644752 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:45.647819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.655711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.656199 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:45.659099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.677490 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:45.678316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.678803 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241126140545584597"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241126140545584597"
    )
  
[0m14:05:45.711304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.713370 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:45.713830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:45.714259 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:45.722703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:45.723667 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:45.906760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e467ef-c8f6-4d14-bab1-495ad795ba86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b07d46e0>]}
[0m14:05:45.907625 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:45.908392 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:45.909885 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:45.910355 [debug] [MainThread]: On master: BEGIN
[0m14:05:45.910783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:45.917525 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:45.918003 [debug] [MainThread]: On master: COMMIT
[0m14:05:45.918446 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:45.918873 [debug] [MainThread]: On master: COMMIT
[0m14:05:45.919454 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:45.919943 [debug] [MainThread]: On master: Close
[0m14:05:45.921450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:45.921893 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:45.922297 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:45.922771 [info ] [MainThread]: 
[0m14:05:45.923305 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.75 seconds (8.75s).
[0m14:05:45.924419 [debug] [MainThread]: Command end result
[0m14:05:45.952737 [info ] [MainThread]: 
[0m14:05:45.953400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:45.953942 [info ] [MainThread]: 
[0m14:05:45.954493 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:45.955522 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.74659, "process_user_time": 5.762513, "process_kernel_time": 0.335215, "process_mem_max_rss": "293816", "process_in_blocks": "3880", "process_out_blocks": "115256"}
[0m14:05:45.956193 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:45.956082 after 10.75 seconds
[0m14:05:45.956698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f7ae9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d2fcfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f7b0ca10>]}
[0m14:05:45.957183 [debug] [MainThread]: Flushing usage events
[0m14:05:47.642036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2cf9b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2cef17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2cc5e150>]}


============================== 14:05:47.644871 | be44abb0-766b-4cf4-ae84-189b460f5fe1 ==============================
[0m14:05:47.644871 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:47.645581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:47.785119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be44abb0-766b-4cf4-ae84-189b460f5fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2cb0ad20>]}
[0m14:05:47.801478 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20906991, "process_user_time": 1.405911, "process_kernel_time": 0.123816, "process_mem_max_rss": "92384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:47.802060 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:47.801952 after 0.21 seconds
[0m14:05:47.802492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2cb0a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b305bbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2c97c6e0>]}
[0m14:05:47.802921 [debug] [MainThread]: Flushing usage events
[0m22:06:01.695961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21b048ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21b048200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21b048410>]}


============================== 22:06:01.702921 | d78e936f-3e4b-41c2-9857-8963cc409d55 ==============================
[0m22:06:01.702921 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:01.703637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:01.837613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd78e936f-3e4b-41c2-9857-8963cc409d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21bade420>]}
[0m22:06:01.850942 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-anpa_klv'
[0m22:06:01.851399 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:01.966026 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:01.966629 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:01.989527 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:01.993347 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:02.062412 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:02.062913 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:02.063415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd78e936f-3e4b-41c2-9857-8963cc409d55', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21ae08410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21ae083b0>]}
[0m22:06:02.063862 [info ] [MainThread]: 
[0m22:06:02.064335 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:02.065837 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41829905, "process_user_time": 1.540342, "process_kernel_time": 0.128028, "process_mem_max_rss": "93644", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m22:06:02.066417 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:02.066313 after 0.42 seconds
[0m22:06:02.066851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21ebbbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21d31fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21af8a480>]}
[0m22:06:02.067273 [debug] [MainThread]: Flushing usage events
[0m22:06:03.590193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac22a65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac19a3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1a7cfe0>]}


============================== 22:06:03.592844 | 45c716d7-d694-42e6-a819-77e3b1475042 ==============================
[0m22:06:03.592844 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:03.593547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:03.823055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1809220>]}
[0m22:06:03.881207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1933a40>]}
[0m22:06:03.883586 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:03.898763 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:03.899464 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:03.899994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aba73c8f0>]}
[0m22:06:05.119550 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:05.120138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aba5f6b10>]}
[0m22:06:05.300518 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:05.305515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aba1b6030>]}
[0m22:06:05.429939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac2a2c0b0>]}
[0m22:06:05.430486 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:05.430991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aba122000>]}
[0m22:06:05.432646 [info ] [MainThread]: 
[0m22:06:05.433348 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:05.438195 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:05.474587 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:05.475040 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:05.475470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:06.110385 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:06.112004 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:06.114385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:06.114982 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:06.122169 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.122612 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:06.123040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:06.129530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.130976 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.131390 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:06.131989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.132395 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.132778 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:06.133378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.134305 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:06.134716 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.135096 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:06.135657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.136074 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:06.138058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:06.143534 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:06.143955 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:06.144337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:06.149973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.150409 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:06.150814 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:06.174455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.175884 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:06.177091 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:06.177536 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:06.180610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac17aa540>]}
[0m22:06:06.181138 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:06.181579 [debug] [MainThread]: On master: BEGIN
[0m22:06:06.181958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:06.188233 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:06.188660 [debug] [MainThread]: On master: COMMIT
[0m22:06:06.189079 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:06.189501 [debug] [MainThread]: On master: COMMIT
[0m22:06:06.190039 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:06.190444 [debug] [MainThread]: On master: Close
[0m22:06:06.192071 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:06.192558 [info ] [MainThread]: 
[0m22:06:06.201845 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:06.202436 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:06.203059 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:06.203509 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:06.229106 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:06.229879 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:06.265457 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:06.266189 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:15.392832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.393375 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:15.394021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.394485 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.394929 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:15.395644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.398531 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.398994 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:15.399716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.420314 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:15.420796 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.421237 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:15.422640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.427556 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.428027 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:15.429216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.431522 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:15.460518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a82893e00>]}
[0m22:06:15.461224 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.26s]
[0m22:06:15.462058 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:15.463017 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:15.463583 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:15.464146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:15.464605 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:15.469591 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:15.470242 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:15.504310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.504818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241126220615498434"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:15.505292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:15.519452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.526728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.527195 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:15.527794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.528254 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.528695 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241126220615498434'
      
      
      order by ordinal_position

  
[0m22:06:15.549668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.555748 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.556250 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:15.559058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.566603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.567083 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:15.569896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.587724 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:15.588391 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.588872 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241126220615498434"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241126220615498434"
    )
  
[0m22:06:15.622375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.624333 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:15.624796 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.625230 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:15.633642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.634541 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:15.815704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45c716d7-d694-42e6-a819-77e3b1475042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a82a62240>]}
[0m22:06:15.816484 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:06:15.817235 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:15.818718 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:15.819207 [debug] [MainThread]: On master: BEGIN
[0m22:06:15.819649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:15.826375 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:15.826853 [debug] [MainThread]: On master: COMMIT
[0m22:06:15.827289 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:15.827717 [debug] [MainThread]: On master: COMMIT
[0m22:06:15.828296 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:15.828752 [debug] [MainThread]: On master: Close
[0m22:06:15.830209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:15.830656 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:15.831070 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:15.831535 [info ] [MainThread]: 
[0m22:06:15.832129 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.40 seconds (10.40s).
[0m22:06:15.833246 [debug] [MainThread]: Command end result
[0m22:06:15.861057 [info ] [MainThread]: 
[0m22:06:15.861766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:15.862353 [info ] [MainThread]: 
[0m22:06:15.862959 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:15.864040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.322889, "process_user_time": 5.586374, "process_kernel_time": 0.328374, "process_mem_max_rss": "291596", "process_in_blocks": "3880", "process_out_blocks": "115800"}
[0m22:06:15.864696 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:15.864584 after 12.32 seconds
[0m22:06:15.865198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1933dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac213d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1df8380>]}
[0m22:06:15.865738 [debug] [MainThread]: Flushing usage events
[0m22:06:17.465514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f275104a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2751450a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2751453c50>]}


============================== 22:06:17.468178 | 7e3b562a-7bdd-4069-b6bf-61eb483168f8 ==============================
[0m22:06:17.468178 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:17.468875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:17.602681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e3b562a-7bdd-4069-b6bf-61eb483168f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2750dcea50>]}
[0m22:06:17.619307 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20280842, "process_user_time": 1.353571, "process_kernel_time": 0.115792, "process_mem_max_rss": "92296", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:17.619888 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:17.619784 after 0.20 seconds
[0m22:06:17.620324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2750cfb9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2750e2b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2750dcfb00>]}
[0m22:06:17.620754 [debug] [MainThread]: Flushing usage events
[0m06:02:10.981501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6c75610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6ab3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6ab3dd0>]}


============================== 06:02:10.996448 | b7c1e37f-374d-4691-aaf8-8044a8fcbbd3 ==============================
[0m06:02:10.996448 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.997196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.137126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7c1e37f-374d-4691-aaf8-8044a8fcbbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6c75610>]}
[0m06:02:11.150696 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e5oy83sf'
[0m06:02:11.151159 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.199853 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.200480 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.209761 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.213646 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.271504 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.272049 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:11.272628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7c1e37f-374d-4691-aaf8-8044a8fcbbd3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c8a800e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6cd29f0>]}
[0m06:02:11.273079 [info ] [MainThread]: 
[0m06:02:11.273597 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:11.282876 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35079163, "process_user_time": 1.589293, "process_kernel_time": 0.131775, "process_mem_max_rss": "93568", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m06:02:11.283475 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.283371 after 0.35 seconds
[0m06:02:11.283910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c755b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c755b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6deacf0>]}
[0m06:02:11.284338 [debug] [MainThread]: Flushing usage events
[0m06:02:12.875618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca9009eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5caa8f7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca8637dd0>]}


============================== 06:02:12.878479 | 9984f1fb-b3c1-4ed3-a6b4-f5496f953922 ==============================
[0m06:02:12.878479 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.879114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.116389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca84ac650>]}
[0m06:02:13.176222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca84ff590>]}
[0m06:02:13.178726 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:13.199960 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.200670 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.201207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca84fd430>]}
[0m06:02:14.431177 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.431831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca0fd8230>]}
[0m06:02:14.613986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.619330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca0e6e540>]}
[0m06:02:14.754009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca84aca70>]}
[0m06:02:14.754621 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.755154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca8fcc8c0>]}
[0m06:02:14.756916 [info ] [MainThread]: 
[0m06:02:14.757647 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.762509 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.799562 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.800019 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:14.800422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.315012 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:15.316570 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.318631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.319197 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.326305 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.326731 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.327122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.333294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.334774 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.335187 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.335791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.336188 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.336574 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.337147 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.338065 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.338494 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.338873 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.339402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.339812 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.341630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.347206 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.347616 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.348014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.353753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.354201 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.354614 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.377792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.379328 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.380540 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.380944 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.384384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca9bad610>]}
[0m06:02:15.384922 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.385315 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.385689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.391935 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.392362 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.392759 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.393139 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.393668 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.394108 [debug] [MainThread]: On master: Close
[0m06:02:15.395423 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.395922 [info ] [MainThread]: 
[0m06:02:15.413508 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.414146 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.414826 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.415269 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.441265 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.442004 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.478285 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.479061 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:22.062309 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.062821 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:22.063454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.063918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.064361 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:22.065074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.067953 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.068412 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:22.069099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.089964 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.090468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.090912 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.092826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.097735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.098235 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:22.099534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.101858 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:22.131464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c659a27b0>]}
[0m06:02:22.132198 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.72s]
[0m06:02:22.133062 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:22.134035 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:22.134638 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:22.135286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:22.135740 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:22.140780 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:22.141439 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:22.175218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.175732 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241127060222169264"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:22.176206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:22.190514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.197972 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.198455 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:22.199055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.199497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.199931 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241127060222169264'
      
      
      order by ordinal_position

  
[0m06:02:22.220542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.226758 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.227238 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.229920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.237491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.237967 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.240742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.258635 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:22.259323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.259791 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241127060222169264"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241127060222169264"
    )
  
[0m06:02:22.296993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.299047 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.299503 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.299926 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.312155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.313055 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:22.502850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9984f1fb-b3c1-4ed3-a6b4-f5496f953922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c6571ed80>]}
[0m06:02:22.503679 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:22.504442 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:22.505952 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.506482 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.506926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:22.513660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.514169 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.514611 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.515033 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.515605 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.516057 [debug] [MainThread]: On master: Close
[0m06:02:22.517488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:22.517943 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:22.518420 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:22.518892 [info ] [MainThread]: 
[0m06:02:22.519481 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.76 seconds (7.76s).
[0m06:02:22.520570 [debug] [MainThread]: Command end result
[0m06:02:22.548482 [info ] [MainThread]: 
[0m06:02:22.549181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:22.549761 [info ] [MainThread]: 
[0m06:02:22.550376 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:22.551442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.72536, "process_user_time": 5.564289, "process_kernel_time": 0.360277, "process_mem_max_rss": "299416", "process_in_blocks": "3880", "process_out_blocks": "116288"}
[0m06:02:22.552084 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:22.551975 after 9.73 seconds
[0m06:02:22.552570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca8487860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca915aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ca8afcc50>]}
[0m06:02:22.553058 [debug] [MainThread]: Flushing usage events
[0m06:02:24.157427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2813f970b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f281405e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2814c94680>]}


============================== 06:02:24.160159 | 89452d0d-8582-412a-bac7-c2642834a8a2 ==============================
[0m06:02:24.160159 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.160797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.298970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89452d0d-8582-412a-bac7-c2642834a8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2813d204d0>]}
[0m06:02:24.315378 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20730722, "process_user_time": 1.407601, "process_kernel_time": 0.099688, "process_mem_max_rss": "92172", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:24.315968 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:24.315864 after 0.21 seconds
[0m06:02:24.316406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2814c94680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2813d6db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f281426af90>]}
[0m06:02:24.316827 [debug] [MainThread]: Flushing usage events
[0m14:05:45.205131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbe3993d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbda042f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbdde60c0>]}


============================== 14:05:45.228893 | 63e936f4-b0ff-4653-a290-c0705c4da956 ==============================
[0m14:05:45.228893 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:45.229587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:45.374687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63e936f4-b0ff-4653-a290-c0705c4da956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc09135c0>]}
[0m14:05:45.388522 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nmjxawiv'
[0m14:05:45.389024 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:45.425847 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:45.426567 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:45.438052 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:45.441908 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:45.670263 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:45.670841 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:45.671440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '63e936f4-b0ff-4653-a290-c0705c4da956', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbd4abd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbd4a8a10>]}
[0m14:05:45.671916 [info ] [MainThread]: 
[0m14:05:45.672406 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:45.688275 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5324124, "process_user_time": 1.579251, "process_kernel_time": 0.139228, "process_mem_max_rss": "93560", "process_in_blocks": "5784", "process_out_blocks": "3992"}
[0m14:05:45.688914 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:45.688808 after 0.53 seconds
[0m14:05:45.689359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbe3993d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc0fbbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc0fbbe30>]}
[0m14:05:45.689798 [debug] [MainThread]: Flushing usage events
[0m14:05:47.526023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970f1ae300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970d1897f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970e02a060>]}


============================== 14:05:47.528877 | 80261f0e-5692-4b78-86c7-83a3324b4563 ==============================
[0m14:05:47.528877 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:47.529507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:47.768223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970cdefc80>]}
[0m14:05:47.827975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970cc64bf0>]}
[0m14:05:47.830613 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:47.872092 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:47.872882 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:47.873425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9705c3d130>]}
[0m14:05:49.123028 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:49.123743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97057f7800>]}
[0m14:05:49.352789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:49.358214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9705bd68a0>]}
[0m14:05:49.503338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97057de330>]}
[0m14:05:49.503918 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:49.504438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97055711c0>]}
[0m14:05:49.506149 [info ] [MainThread]: 
[0m14:05:49.506821 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:49.511628 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:49.549670 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:49.550200 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:49.550603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:50.086105 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:50.087712 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:50.089771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:50.090336 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:50.097470 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:50.097906 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:50.098301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:50.104949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.106544 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:50.106958 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:50.107607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.108007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:50.108390 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:50.108960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.109882 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:50.110283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:50.110663 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:50.111249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.111691 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:50.113745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:50.119652 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:50.120069 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:50.120456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:50.126467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.126891 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:50.127335 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:50.151650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:50.153336 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:50.154616 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:50.155080 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:50.159527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970e3b1700>]}
[0m14:05:50.160100 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.160520 [debug] [MainThread]: On master: BEGIN
[0m14:05:50.160903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:50.167605 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.168049 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.168443 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:50.168824 [debug] [MainThread]: On master: COMMIT
[0m14:05:50.169360 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:50.169775 [debug] [MainThread]: On master: Close
[0m14:05:50.171491 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:50.171985 [info ] [MainThread]: 
[0m14:05:50.190418 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:50.191095 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:50.191782 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:50.192230 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:50.218809 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:50.219728 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:50.256340 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:50.257223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:00.259818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:00.260376 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:00.261075 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.261541 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:00.261984 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:00.262777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.265892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:00.266353 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:00.267107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.288053 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:00.288601 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:00.289049 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:00.291514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.296749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:00.297244 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:06:00.299073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.301463 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:00.333807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c189a990>]}
[0m14:06:00.334726 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.14s]
[0m14:06:00.335518 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:00.336530 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:00.337104 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:00.337700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:00.338167 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:00.343630 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:00.344300 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:00.378395 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:00.378955 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241127140600372384"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:00.379455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:00.394994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.402976 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:00.403486 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:00.404132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.404577 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:00.405009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241127140600372384'
      
      
      order by ordinal_position

  
[0m14:06:00.426325 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.433409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:00.433913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:00.436909 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.444752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:00.445231 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:00.448108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.466115 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:00.466876 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:00.467408 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241127140600372384"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241127140600372384"
    )
  
[0m14:06:00.506658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.508736 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:00.509205 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:00.509638 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:00.519510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:00.520438 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:00.711827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80261f0e-5692-4b78-86c7-83a3324b4563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c18b1c70>]}
[0m14:06:00.712656 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:06:00.713456 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:00.714953 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:00.715480 [debug] [MainThread]: On master: BEGIN
[0m14:06:00.715921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:00.722716 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:00.723273 [debug] [MainThread]: On master: COMMIT
[0m14:06:00.723722 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:00.724148 [debug] [MainThread]: On master: COMMIT
[0m14:06:00.724751 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:00.725223 [debug] [MainThread]: On master: Close
[0m14:06:00.726843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:00.727326 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:06:00.727734 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:00.728197 [info ] [MainThread]: 
[0m14:06:00.728745 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.22 seconds (11.22s).
[0m14:06:00.729787 [debug] [MainThread]: Command end result
[0m14:06:00.758161 [info ] [MainThread]: 
[0m14:06:00.758915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:00.759530 [info ] [MainThread]: 
[0m14:06:00.760129 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:00.761222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.284607, "process_user_time": 5.698704, "process_kernel_time": 0.400752, "process_mem_max_rss": "298812", "process_in_blocks": "3880", "process_out_blocks": "116792"}
[0m14:06:00.761879 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:00.761767 after 13.29 seconds
[0m14:06:00.762378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970cf573b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970565bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970d2b4e00>]}
[0m14:06:00.762887 [debug] [MainThread]: Flushing usage events
[0m14:06:02.724098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1dff7d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e0c7fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1dfc25ac0>]}


============================== 14:06:02.727018 | 78af432f-6c88-4783-8a06-ea98b6064b94 ==============================
[0m14:06:02.727018 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:02.727794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:02.873631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78af432f-6c88-4783-8a06-ea98b6064b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1dfb87770>]}
[0m14:06:02.890652 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21694608, "process_user_time": 1.429379, "process_kernel_time": 0.108104, "process_mem_max_rss": "92148", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:02.891292 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:02.891186 after 0.22 seconds
[0m14:06:02.891745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e35bbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1df8e3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1dfbf6090>]}
[0m14:06:02.892182 [debug] [MainThread]: Flushing usage events
[0m22:05:46.198957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a36c6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a435d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a36c64b0>]}


============================== 22:05:46.206420 | 8d6da303-17e2-4e68-b09c-1f47af2dbe70 ==============================
[0m22:05:46.206420 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:46.207102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:46.353831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d6da303-17e2-4e68-b09c-1f47af2dbe70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a33764b0>]}
[0m22:05:46.368211 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x3m0y05z'
[0m22:05:46.368735 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:46.448576 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:46.449270 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:46.472008 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:46.475935 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:46.549800 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:46.550409 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:46.550968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8d6da303-17e2-4e68-b09c-1f47af2dbe70', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a2c94260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a2d240b0>]}
[0m22:05:46.551449 [info ] [MainThread]: 
[0m22:05:46.551930 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:46.553695 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40494832, "process_user_time": 1.582001, "process_kernel_time": 0.144182, "process_mem_max_rss": "93960", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m22:05:46.554318 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:46.554210 after 0.41 seconds
[0m22:05:46.554762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a32f9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a334c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a36ee6f0>]}
[0m22:05:46.555201 [debug] [MainThread]: Flushing usage events
[0m22:05:48.152253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa114737b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa11516a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa114737980>]}


============================== 22:05:48.155280 | 96ea7788-ea14-4355-ad13-0806483ccfca ==============================
[0m22:05:48.155280 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:48.155966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:48.400259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1144cb590>]}
[0m22:05:48.460124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa114620590>]}
[0m22:05:48.462760 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:48.479273 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:48.480010 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:48.480576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1145bfce0>]}
[0m22:05:49.713860 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:49.714518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10d34f470>]}
[0m22:05:49.898138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:49.903331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10d3ea1e0>]}
[0m22:05:50.035696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10d3e4920>]}
[0m22:05:50.036284 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:50.036839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10cf295e0>]}
[0m22:05:50.038597 [info ] [MainThread]: 
[0m22:05:50.039325 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:50.044342 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:50.081476 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:50.081942 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:50.082343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:50.761523 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:50.763211 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:50.765556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:50.766166 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:50.773461 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.773912 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:50.774310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:50.780549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.782016 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.782422 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:50.782955 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.783358 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.783739 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:50.784373 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.785296 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:50.785696 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:50.786075 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:50.786641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.787054 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:50.788972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:50.794610 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:50.795023 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:50.795396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:50.801087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.801496 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:50.801889 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:50.826700 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:50.828138 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:50.829399 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:50.829809 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:50.833123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa115cb5040>]}
[0m22:05:50.833642 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.834043 [debug] [MainThread]: On master: BEGIN
[0m22:05:50.834420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:50.840602 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.841033 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.841430 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.841814 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.842350 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.842755 [debug] [MainThread]: On master: Close
[0m22:05:50.844237 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:50.844810 [info ] [MainThread]: 
[0m22:05:50.854558 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:50.855162 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:50.855877 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:50.856322 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:50.882398 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:50.883163 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:50.919193 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:50.919962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:59.388371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:59.388909 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:59.389580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.390048 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:59.390491 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:59.391217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.394195 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:59.394669 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:59.395380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.416425 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:59.416910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:59.417351 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:59.418807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.423732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:59.424216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:59.425519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.427832 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:59.457288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa114fde6f0>]}
[0m22:05:59.458040 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.60s]
[0m22:05:59.458896 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:59.459876 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:59.460466 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:59.461134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:59.461592 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:59.466762 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:59.467420 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:59.501323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.501846 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241127220559495352"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:59.502331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:59.517696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.525576 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.526067 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:59.526694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.527144 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.527591 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241127220559495352'
      
      
      order by ordinal_position

  
[0m22:05:59.548221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.554673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.555170 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:59.558255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.565843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.566332 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:59.569393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.587390 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:59.588087 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.588590 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241127220559495352"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241127220559495352"
    )
  
[0m22:05:59.623855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.625942 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:59.626412 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.626842 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:59.637049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.638022 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:00.247466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96ea7788-ea14-4355-ad13-0806483ccfca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0cd52a720>]}
[0m22:06:00.248295 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.79s]
[0m22:06:00.249091 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:00.250582 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:00.251093 [debug] [MainThread]: On master: BEGIN
[0m22:06:00.251557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:00.258468 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:00.258960 [debug] [MainThread]: On master: COMMIT
[0m22:06:00.259400 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:00.259833 [debug] [MainThread]: On master: COMMIT
[0m22:06:00.260437 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:00.260921 [debug] [MainThread]: On master: Close
[0m22:06:00.262525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:00.262966 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:00.263384 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:00.263854 [info ] [MainThread]: 
[0m22:06:00.264487 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m22:06:00.265611 [debug] [MainThread]: Command end result
[0m22:06:00.294210 [info ] [MainThread]: 
[0m22:06:00.294941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:00.295538 [info ] [MainThread]: 
[0m22:06:00.296138 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:00.297274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.194995, "process_user_time": 6.646123, "process_kernel_time": 0.342665, "process_mem_max_rss": "374384", "process_in_blocks": "3880", "process_out_blocks": "130640"}
[0m22:06:00.297924 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:00.297813 after 12.20 seconds
[0m22:06:00.298422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa114746870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0fc87ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa114bfcc80>]}
[0m22:06:00.298915 [debug] [MainThread]: Flushing usage events
[0m22:06:02.017380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26ae7f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26d19db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26b5ea360>]}


============================== 22:06:02.020514 | 65ba76ba-90cd-43d4-b64b-c49fbf2e85a7 ==============================
[0m22:06:02.020514 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:02.021229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:02.175002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65ba76ba-90cd-43d4-b64b-c49fbf2e85a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26b687bc0>]}
[0m22:06:02.192725 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2286751, "process_user_time": 1.48183, "process_kernel_time": 0.096118, "process_mem_max_rss": "92300", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:02.193324 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:02.193220 after 0.23 seconds
[0m22:06:02.193762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26ae7f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26ab4ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26b687bc0>]}
[0m22:06:02.194193 [debug] [MainThread]: Flushing usage events
[0m06:02:20.278860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7570ff8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75735bf470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75721093a0>]}


============================== 06:02:20.286489 | b5ab479a-cd25-4354-aae5-f05f8b21a19f ==============================
[0m06:02:20.286489 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.287145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.431628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5ab479a-cd25-4354-aae5-f05f8b21a19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7572706060>]}
[0m06:02:20.445345 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2trhpkgx'
[0m06:02:20.445831 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:20.516311 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:20.517044 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:20.542136 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:20.546161 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:20.619003 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:20.619612 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:20.620171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5ab479a-cd25-4354-aae5-f05f8b21a19f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7570eff2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757101a930>]}
[0m06:02:20.620641 [info ] [MainThread]: 
[0m06:02:20.621121 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:20.622817 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39325452, "process_user_time": 1.60308, "process_kernel_time": 0.119931, "process_mem_max_rss": "93632", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m06:02:20.623424 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:20.623320 after 0.39 seconds
[0m06:02:20.623913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75721fb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7572706060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757105a9c0>]}
[0m06:02:20.624347 [debug] [MainThread]: Flushing usage events
[0m06:02:22.252630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f94d0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8d9eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f83ee060>]}


============================== 06:02:22.255574 | af6e7565-262a-49e0-be99-954e7942147b ==============================
[0m06:02:22.255574 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.256308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.505172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8255fd0>]}
[0m06:02:22.565790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f858a780>]}
[0m06:02:22.568469 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:22.584919 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:22.585700 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:22.586221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f1336330>]}
[0m06:02:23.839799 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:23.840473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f0d6f470>]}
[0m06:02:24.027325 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:24.032789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9867e60>]}
[0m06:02:24.168004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f0d65490>]}
[0m06:02:24.168580 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:24.169060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f0c62000>]}
[0m06:02:24.170812 [info ] [MainThread]: 
[0m06:02:24.171525 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:24.176667 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:24.214579 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:24.215097 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:24.215501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:24.754134 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:24.755724 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:24.757786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:24.758348 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:24.765539 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:24.765977 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:24.766377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:24.772779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.774319 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:24.774726 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:24.775273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.775705 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:24.776087 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:24.776652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.777577 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:24.777978 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:24.778357 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:24.778894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.779305 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:24.781440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:24.787261 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:24.787736 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:24.788123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:24.794378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.794837 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:24.795238 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:24.819286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.821031 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:24.822269 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:24.822676 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:24.826759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9501280>]}
[0m06:02:24.827306 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.827745 [debug] [MainThread]: On master: BEGIN
[0m06:02:24.828138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:24.834624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.835071 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.835475 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.835905 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.836436 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.836844 [debug] [MainThread]: On master: Close
[0m06:02:24.838266 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:24.838790 [info ] [MainThread]: 
[0m06:02:24.848671 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:24.849301 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:24.850057 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:24.850515 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:24.876806 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:24.877620 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:24.913655 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:24.914551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:32.210226 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.210768 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:32.211467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.211957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.212395 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:32.213136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.216235 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.216702 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:32.217407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.238567 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:32.239135 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.239635 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:32.242619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.248112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:32.248608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:32.250246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.252770 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:32.284431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ada0f1d0>]}
[0m06:02:32.285309 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.43s]
[0m06:02:32.286106 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:32.287123 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:32.287730 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:32.288382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:32.288844 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:32.294345 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:32.295073 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:32.332159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.333185 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241128060232323667"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:32.334067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:32.353122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.361451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.362018 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:32.362902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.363359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.363857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241128060232323667'
      
      
      order by ordinal_position

  
[0m06:02:32.385503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.392677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.393223 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.396820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.405099 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.405635 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.408953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.428068 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:32.428972 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.429516 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241128060232323667"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241128060232323667"
    )
  
[0m06:02:32.462522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.464600 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.465132 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.465578 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.475003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.476106 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:32.612733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6e7565-262a-49e0-be99-954e7942147b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ad453830>]}
[0m06:02:32.613566 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:32.614317 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:32.615931 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.616416 [debug] [MainThread]: On master: BEGIN
[0m06:02:32.616853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:32.624123 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.624628 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.625069 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.625501 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.626131 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.626596 [debug] [MainThread]: On master: Close
[0m06:02:32.628467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:32.628907 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:32.629314 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:32.629789 [info ] [MainThread]: 
[0m06:02:32.630382 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.46 seconds (8.46s).
[0m06:02:32.631522 [debug] [MainThread]: Command end result
[0m06:02:32.661000 [info ] [MainThread]: 
[0m06:02:32.661794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:32.662409 [info ] [MainThread]: 
[0m06:02:32.663018 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:32.664188 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.461232, "process_user_time": 5.542276, "process_kernel_time": 0.298614, "process_mem_max_rss": "285004", "process_in_blocks": "3880", "process_out_blocks": "112704"}
[0m06:02:32.664842 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:32.664729 after 10.46 seconds
[0m06:02:32.665347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f83ee060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f87359d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8848ef0>]}
[0m06:02:32.665841 [debug] [MainThread]: Flushing usage events
[0m06:02:34.463645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b9d37ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28baf605f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b9e82660>]}


============================== 06:02:34.466623 | 8c5ecf35-431c-4ccc-b750-6d20f9b9deeb ==============================
[0m06:02:34.466623 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:34.467398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:34.619498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c5ecf35-431c-4ccc-b750-6d20f9b9deeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b9b605c0>]}
[0m06:02:34.636924 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22368664, "process_user_time": 1.424822, "process_kernel_time": 0.167626, "process_mem_max_rss": "92476", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:34.637530 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:34.637424 after 0.22 seconds
[0m06:02:34.637992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28bc3f5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ba30a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28b9bbff80>]}
[0m06:02:34.638455 [debug] [MainThread]: Flushing usage events
[0m14:05:28.443944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392aaf4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392aaf5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392aaf5d30>]}


============================== 14:05:28.451271 | 18f6cd64-6c3e-4f59-af67-c30d13fe4339 ==============================
[0m14:05:28.451271 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.451991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.595176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18f6cd64-6c3e-4f59-af67-c30d13fe4339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a954440>]}
[0m14:05:28.608525 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-55c1j12c'
[0m14:05:28.608988 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:28.680696 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:28.681308 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:28.691255 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:28.695191 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:28.742138 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:28.742678 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:28.743311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18f6cd64-6c3e-4f59-af67-c30d13fe4339', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a832690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a7e9880>]}
[0m14:05:28.743780 [info ] [MainThread]: 
[0m14:05:28.744296 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:28.746100 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3513418, "process_user_time": 1.557574, "process_kernel_time": 0.153734, "process_mem_max_rss": "93916", "process_in_blocks": "5784", "process_out_blocks": "3992"}
[0m14:05:28.746701 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:28.746597 after 0.35 seconds
[0m14:05:28.747180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392af52360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a860620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392a860260>]}
[0m14:05:28.747613 [debug] [MainThread]: Flushing usage events
[0m14:05:30.271502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29952b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c288c63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c28390e60>]}


============================== 14:05:30.274241 | f162a22d-9abb-4224-b134-a5319c249722 ==============================
[0m14:05:30.274241 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.274976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:30.508252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29863290>]}
[0m14:05:30.566696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c28178680>]}
[0m14:05:30.569157 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:30.585660 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:30.586382 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:30.586941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c2817b1a0>]}
[0m14:05:31.824878 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:31.825530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c20fd8860>]}
[0m14:05:32.009092 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:32.014216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c20fa1df0>]}
[0m14:05:32.138986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c20fe0d10>]}
[0m14:05:32.139530 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:32.140016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c20aa2a50>]}
[0m14:05:32.141685 [info ] [MainThread]: 
[0m14:05:32.142382 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:32.147270 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:32.184297 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:32.184761 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:32.185169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:32.678148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.679778 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:32.682015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:32.682604 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:32.689904 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.690350 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:32.690746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:32.697045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.698515 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.698943 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:32.699498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.699896 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.700283 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:32.700849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.701772 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:32.702172 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.702542 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:32.703095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.703509 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:32.705547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:32.711237 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:32.711649 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:32.712023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:32.717884 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.718295 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:32.718691 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:32.741945 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.743458 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:32.744650 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:32.745062 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:32.748345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c20a78f80>]}
[0m14:05:32.748881 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.749281 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.749655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:32.755904 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.756338 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.756732 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.757113 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.757690 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.758103 [debug] [MainThread]: On master: Close
[0m14:05:32.759484 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:32.759992 [info ] [MainThread]: 
[0m14:05:32.769524 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:32.770131 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:32.770796 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:32.771296 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:32.797539 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:32.798280 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:32.834254 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:32.835029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:40.169154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.169732 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:40.170498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.171014 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.171474 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:40.172243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.175430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.175898 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:40.176611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.197815 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:40.198385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.198854 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:40.201218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.206462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.206964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:40.208786 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.211273 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:40.241707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c2803a6c0>]}
[0m14:05:40.242539 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.47s]
[0m14:05:40.243355 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:40.244371 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:40.244945 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:40.245581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:40.246046 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:40.251596 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:40.252273 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:40.286490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.287112 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241128140540280392"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:40.287595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:40.302703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.310831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.311357 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:40.312024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.312486 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.312928 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241128140540280392'
      
      
      order by ordinal_position

  
[0m14:05:40.334131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.341643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.342214 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:40.345357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.353472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.353994 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:40.357158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.376812 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:40.377640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.378121 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241128140540280392"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241128140540280392"
    )
  
[0m14:05:40.416032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.418085 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:40.418550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.419003 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:40.427705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.428647 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:40.564313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f162a22d-9abb-4224-b134-a5319c249722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9be145a3c0>]}
[0m14:05:40.565158 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m14:05:40.565918 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:40.567461 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:40.567938 [debug] [MainThread]: On master: BEGIN
[0m14:05:40.568372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:40.575294 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:40.575797 [debug] [MainThread]: On master: COMMIT
[0m14:05:40.576258 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:40.576682 [debug] [MainThread]: On master: COMMIT
[0m14:05:40.577272 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:40.577725 [debug] [MainThread]: On master: Close
[0m14:05:40.579575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:40.580022 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:40.580428 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:40.580915 [info ] [MainThread]: 
[0m14:05:40.581467 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m14:05:40.582528 [debug] [MainThread]: Command end result
[0m14:05:40.611269 [info ] [MainThread]: 
[0m14:05:40.612011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:40.612562 [info ] [MainThread]: 
[0m14:05:40.613119 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:40.614201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.391518, "process_user_time": 5.373617, "process_kernel_time": 0.337105, "process_mem_max_rss": "295880", "process_in_blocks": "3880", "process_out_blocks": "112688"}
[0m14:05:40.614871 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:40.614756 after 10.39 seconds
[0m14:05:40.615413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c28305c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c20582300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c287b8cb0>]}
[0m14:05:40.615921 [debug] [MainThread]: Flushing usage events
[0m14:05:42.282298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b394f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b3cafad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b3a64f80>]}


============================== 14:05:42.285339 | 6c69e710-8509-44e4-9a6f-c73f51a58cfa ==============================
[0m14:05:42.285339 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:42.286039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:42.434434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c69e710-8509-44e4-9a6f-c73f51a58cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b4824200>]}
[0m14:05:42.451108 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21908355, "process_user_time": 1.38412, "process_kernel_time": 0.155563, "process_mem_max_rss": "92352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:42.451699 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:42.451594 after 0.22 seconds
[0m14:05:42.452141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b3a18770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b36d3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87b36d2990>]}
[0m14:05:42.452578 [debug] [MainThread]: Flushing usage events
[0m22:05:41.913405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fc499fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fa2cb290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fa179550>]}


============================== 22:05:41.920759 | 0c5438db-6849-41e1-8291-9b274745774b ==============================
[0m22:05:41.920759 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:41.921491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.060520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c5438db-6849-41e1-8291-9b274745774b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fa134980>]}
[0m22:05:42.074084 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gkzakszy'
[0m22:05:42.074537 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:42.137833 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:42.138446 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:42.148936 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:42.152719 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:42.287723 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:42.288285 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:42.288827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0c5438db-6849-41e1-8291-9b274745774b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fa0afbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f9f5e9f0>]}
[0m22:05:42.289288 [info ] [MainThread]: 
[0m22:05:42.289798 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:42.291385 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42718604, "process_user_time": 1.544945, "process_kernel_time": 0.138648, "process_mem_max_rss": "93796", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m22:05:42.291984 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:42.291882 after 0.43 seconds
[0m22:05:42.292417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fa8de3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fa17b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fa178d10>]}
[0m22:05:42.292844 [debug] [MainThread]: Flushing usage events
[0m22:05:43.981831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20886ce0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2088099f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20892f97c0>]}


============================== 22:05:43.984524 | 44e1233b-ee50-4e1f-9171-a60f2853351e ==============================
[0m22:05:43.984524 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:43.985223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.215780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2088013d70>]}
[0m22:05:44.274686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2087b703e0>]}
[0m22:05:44.277366 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:44.293367 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:44.294131 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:44.294692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2087aca720>]}
[0m22:05:45.516086 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:45.516751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20809f9850>]}
[0m22:05:45.699184 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:45.704313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20809f9820>]}
[0m22:05:45.829302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2080512bd0>]}
[0m22:05:45.829878 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:45.830411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2080480aa0>]}
[0m22:05:45.832120 [info ] [MainThread]: 
[0m22:05:45.832831 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:45.837699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:45.874124 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:45.874580 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:45.874988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:46.444595 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:46.446175 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:46.448164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:46.448734 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:46.455797 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.456236 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:46.456632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.462690 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.464088 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.464494 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:46.465042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.465438 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.465856 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:46.466475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.467393 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.467799 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.468184 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.468768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.469173 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:46.471087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:46.476599 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.477017 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:46.477398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.483445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.483862 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.484263 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:46.507317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.508740 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:46.509972 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:46.510383 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:46.513618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208a0f1700>]}
[0m22:05:46.514187 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.514584 [debug] [MainThread]: On master: BEGIN
[0m22:05:46.514954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:46.521077 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.521504 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.521933 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.522316 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.522845 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.523249 [debug] [MainThread]: On master: Close
[0m22:05:46.524733 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:46.525232 [info ] [MainThread]: 
[0m22:05:46.534683 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:46.535283 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:46.535948 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:46.536404 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:46.562085 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:46.562835 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:46.598495 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:46.599269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:54.714738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.715274 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:54.715919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.716373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.716817 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:54.717525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.720504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.720965 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:54.721658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.742499 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:54.742996 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.743442 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:54.744834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.749876 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:54.750357 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:54.751554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.753916 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:54.782851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2080506390>]}
[0m22:05:54.783569 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.25s]
[0m22:05:54.784331 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:54.785169 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:54.785784 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:54.786608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:54.787068 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:54.792117 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:54.792773 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:54.826184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.826698 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241128220554820248"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:54.827186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:54.841447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.848757 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.849225 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:54.849844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.850306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.850748 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241128220554820248'
      
      
      order by ordinal_position

  
[0m22:05:54.871402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.877488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.878005 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:54.881124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.888606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.889083 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:54.892184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.910197 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:54.910881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.911357 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241128220554820248"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241128220554820248"
    )
  
[0m22:05:54.946330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.948309 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:54.948786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:54.949217 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:54.957028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:54.957966 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:55.102311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44e1233b-ee50-4e1f-9171-a60f2853351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2040863ec0>]}
[0m22:05:55.103119 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m22:05:55.103886 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:55.105348 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.105875 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.106318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:55.112998 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.113478 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.113959 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.114393 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.115014 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.115471 [debug] [MainThread]: On master: Close
[0m22:05:55.116890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:55.117325 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:55.117728 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:55.118236 [info ] [MainThread]: 
[0m22:05:55.118828 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.29 seconds (9.29s).
[0m22:05:55.119927 [debug] [MainThread]: Command end result
[0m22:05:55.147767 [info ] [MainThread]: 
[0m22:05:55.148463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:55.149055 [info ] [MainThread]: 
[0m22:05:55.149663 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:55.150780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.2179365, "process_user_time": 5.494174, "process_kernel_time": 0.357442, "process_mem_max_rss": "294156", "process_in_blocks": "3880", "process_out_blocks": "113760"}
[0m22:05:55.151428 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:55.151317 after 11.22 seconds
[0m22:05:55.151924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2087d69280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208962d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20881c0aa0>]}
[0m22:05:55.152418 [debug] [MainThread]: Flushing usage events
[0m22:05:56.881347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb950533c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95094d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb950ddacf0>]}


============================== 22:05:56.884056 | fdd281a3-cfde-4b3d-9cd0-74a14ec80027 ==============================
[0m22:05:56.884056 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:56.884771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.024137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdd281a3-cfde-4b3d-9cd0-74a14ec80027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9514484a0>]}
[0m22:05:57.040615 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20881072, "process_user_time": 1.420945, "process_kernel_time": 0.087811, "process_mem_max_rss": "92224", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:57.041194 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:57.041092 after 0.21 seconds
[0m22:05:57.041636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95178eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95099fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb951a53a40>]}
[0m22:05:57.042145 [debug] [MainThread]: Flushing usage events
[0m06:02:10.717732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e7e92240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e7dd8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e81e2300>]}


============================== 06:02:10.725238 | 58af9df1-1794-496e-8660-71136b22bdc1 ==============================
[0m06:02:10.725238 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.725895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.873234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58af9df1-1794-496e-8660-71136b22bdc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e87f9f70>]}
[0m06:02:10.887399 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6g70zj2q'
[0m06:02:10.887902 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.950296 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.951071 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.962044 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.966068 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.120491 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.121143 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:11.121763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '58af9df1-1794-496e-8660-71136b22bdc1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e78b4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e78b69f0>]}
[0m06:02:11.122246 [info ] [MainThread]: 
[0m06:02:11.122802 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:11.124750 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4566369, "process_user_time": 1.671668, "process_kernel_time": 0.100946, "process_mem_max_rss": "93656", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m06:02:11.125367 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.125260 after 0.46 seconds
[0m06:02:11.125813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e87fba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e87f9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e78478c0>]}
[0m06:02:11.126268 [debug] [MainThread]: Flushing usage events
[0m06:02:12.805891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b92c2540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b9266570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b8c921b0>]}


============================== 06:02:12.808836 | dbd7e2d5-84a4-495a-99a6-3cff071faf34 ==============================
[0m06:02:12.808836 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.809503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.056748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b8634c80>]}
[0m06:02:13.116253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b860a0f0>]}
[0m06:02:13.118870 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:13.137650 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.138812 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.139650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b877a3f0>]}
[0m06:02:14.386065 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.386719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b1757b90>]}
[0m06:02:14.569962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.575071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b9d57560>]}
[0m06:02:14.708494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b11089b0>]}
[0m06:02:14.709057 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.709566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b11ed130>]}
[0m06:02:14.711282 [info ] [MainThread]: 
[0m06:02:14.711968 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.716816 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.753879 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.754355 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:14.754760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.274026 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:15.275608 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.277675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.278254 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.285693 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.286190 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.286594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.293153 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.294721 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.295132 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.295792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.296195 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.296582 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.297206 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.298134 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.298555 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.298934 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.299524 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.299944 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.301926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.307658 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.308084 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.308465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.314731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.315256 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.315671 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.341164 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.342829 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.344135 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.344563 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.348559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b15b8530>]}
[0m06:02:15.349116 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.349521 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.349921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.356552 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.356997 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.357391 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.357770 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.358309 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.358712 [debug] [MainThread]: On master: Close
[0m06:02:15.360177 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.360676 [info ] [MainThread]: 
[0m06:02:15.370513 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.371135 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.371830 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.372298 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.398505 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.399291 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.435651 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.436485 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.580888 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.581431 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.582086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.582539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.582975 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.583723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.586712 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.587196 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.587910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.611606 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.612121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.612582 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.613846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.618902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.619409 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.620623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.622981 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.652222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8688043680>]}
[0m06:02:23.652993 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.28s]
[0m06:02:23.653763 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.654751 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.655349 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.655947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.656414 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.661739 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.662407 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.696138 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.696674 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241129060223690192"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.697151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.711666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.719460 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.719942 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.720571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.721026 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.721472 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241129060223690192'
      
      
      order by ordinal_position

  
[0m06:02:23.742788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.750743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.751554 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.756160 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.764332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.764840 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.768293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.787359 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.788214 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.788737 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241129060223690192"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241129060223690192"
    )
  
[0m06:02:23.822164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.824245 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.824730 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.825168 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.833273 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.834180 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:23.986117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd7e2d5-84a4-495a-99a6-3cff071faf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8679a67950>]}
[0m06:02:23.986954 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m06:02:23.987754 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:23.989222 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.989708 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.990148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:23.997155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.997683 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.998125 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.998558 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.999204 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.999678 [debug] [MainThread]: On master: Close
[0m06:02:24.001426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:24.001869 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:24.002278 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:24.002754 [info ] [MainThread]: 
[0m06:02:24.003375 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.29 seconds (9.29s).
[0m06:02:24.004515 [debug] [MainThread]: Command end result
[0m06:02:24.033205 [info ] [MainThread]: 
[0m06:02:24.033978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:24.034575 [info ] [MainThread]: 
[0m06:02:24.035213 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:24.036323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.280631, "process_user_time": 5.639602, "process_kernel_time": 0.307107, "process_mem_max_rss": "293740", "process_in_blocks": "3880", "process_out_blocks": "114240"}
[0m06:02:24.036971 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:24.036859 after 11.28 seconds
[0m06:02:24.037474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86bc5bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b86375c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b8d95d30>]}
[0m06:02:24.037966 [debug] [MainThread]: Flushing usage events
[0m06:02:25.815261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e34e3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e33f52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e34e0b00>]}


============================== 06:02:25.818188 | 611659ec-a236-4727-bb5f-66b3a7f3ef2b ==============================
[0m06:02:25.818188 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.818854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.965444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '611659ec-a236-4727-bb5f-66b3a7f3ef2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e2e6a960>]}
[0m06:02:25.982176 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2165091, "process_user_time": 1.477827, "process_kernel_time": 0.099853, "process_mem_max_rss": "92232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:25.982805 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:25.982692 after 0.22 seconds
[0m06:02:25.983312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e3a42270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e2f20fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e2e6a960>]}
[0m06:02:25.983814 [debug] [MainThread]: Flushing usage events
[0m14:05:11.932166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2b865b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d29e7a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d29e7a2d0>]}


============================== 14:05:11.939388 | fccb1287-fa81-4c26-a2a8-ae26fad2eba3 ==============================
[0m14:05:11.939388 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:11.940054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.078306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fccb1287-fa81-4c26-a2a8-ae26fad2eba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d29e7a8a0>]}
[0m14:05:12.091776 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uzucbq_0'
[0m14:05:12.092253 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:12.118956 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:12.119578 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:12.128576 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:12.132456 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:12.175457 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:12.176041 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:12.176620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fccb1287-fa81-4c26-a2a8-ae26fad2eba3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d29243650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d29243a70>]}
[0m14:05:12.177088 [info ] [MainThread]: 
[0m14:05:12.177609 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:12.190118 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.30699074, "process_user_time": 1.588525, "process_kernel_time": 0.115456, "process_mem_max_rss": "93776", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m14:05:12.190827 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:12.190715 after 0.31 seconds
[0m14:05:12.191266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d296bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d293285c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2932b860>]}
[0m14:05:12.191693 [debug] [MainThread]: Flushing usage events
[0m14:05:13.720771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5455929550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5454847710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54544306e0>]}


============================== 14:05:13.723645 | ce9e39dd-1b75-4b1f-b162-1594dbbe2090 ==============================
[0m14:05:13.723645 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:13.724325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:13.959718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544cf0e540>]}
[0m14:05:14.019322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545555f680>]}
[0m14:05:14.021808 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:14.037380 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:14.038092 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:14.038628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544cf86fc0>]}
[0m14:05:15.274578 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:15.275256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544c9bc6e0>]}
[0m14:05:15.458476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:15.463543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544c82a1b0>]}
[0m14:05:15.602465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544c9e7560>]}
[0m14:05:15.603024 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:15.603558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544c7790a0>]}
[0m14:05:15.605359 [info ] [MainThread]: 
[0m14:05:15.606082 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:15.610985 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:15.647844 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:15.648328 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:15.648735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:16.169466 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:16.171052 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:16.173142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:16.173719 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:16.180934 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:16.181374 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:16.181769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:16.188049 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:16.189533 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:16.189947 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:16.190548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:16.190950 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:16.191332 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:16.191934 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:16.192857 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:16.193278 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:16.193660 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:16.194196 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:16.194610 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:16.196590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:16.202309 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:16.202728 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:16.203111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:16.208922 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:16.209342 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:16.209743 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:16.233141 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:16.234651 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:16.235952 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:16.236378 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:16.239780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544cf65d60>]}
[0m14:05:16.240336 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:16.240732 [debug] [MainThread]: On master: BEGIN
[0m14:05:16.241104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:16.247342 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:16.247776 [debug] [MainThread]: On master: COMMIT
[0m14:05:16.248214 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:16.248595 [debug] [MainThread]: On master: COMMIT
[0m14:05:16.249130 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:16.249552 [debug] [MainThread]: On master: Close
[0m14:05:16.251051 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:16.251541 [info ] [MainThread]: 
[0m14:05:16.261253 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:16.261856 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:16.262487 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:16.262936 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:16.289388 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:16.290157 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:16.326504 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:16.327269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:27.850610 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:27.851132 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:27.851839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.852339 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:27.852783 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:27.853512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.856466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:27.856929 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:27.857618 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.878570 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:27.879056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:27.879504 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:27.880753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.885650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:27.886119 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:27.887183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.889537 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:27.918343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54112b8ad0>]}
[0m14:05:27.919057 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.66s]
[0m14:05:27.919827 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:27.920850 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:27.921411 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:27.921981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:27.922434 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:27.927457 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:27.928132 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:27.961863 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.962382 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241129140527955941"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:27.962872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:27.976744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.984039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.984505 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:27.985094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.985541 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.985979 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241129140527955941'
      
      
      order by ordinal_position

  
[0m14:05:28.006542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.012741 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.013223 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.016300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.023859 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.024366 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.027162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.045331 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:28.046016 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.046494 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241129140527955941"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241129140527955941"
    )
  
[0m14:05:28.078895 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.080929 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.081394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.081826 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.089605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.090503 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:28.364352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce9e39dd-1b75-4b1f-b162-1594dbbe2090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54111d37a0>]}
[0m14:05:28.365288 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.44s]
[0m14:05:28.366267 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:28.368099 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.368572 [debug] [MainThread]: On master: BEGIN
[0m14:05:28.369007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:28.375882 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.376370 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.376811 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.377239 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.377818 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.378276 [debug] [MainThread]: On master: Close
[0m14:05:28.379722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:28.380206 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:28.380613 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:28.381085 [info ] [MainThread]: 
[0m14:05:28.381679 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.78 seconds (12.78s).
[0m14:05:28.382789 [debug] [MainThread]: Command end result
[0m14:05:28.410760 [info ] [MainThread]: 
[0m14:05:28.411460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:28.412077 [info ] [MainThread]: 
[0m14:05:28.412676 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:28.413757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.743004, "process_user_time": 5.517824, "process_kernel_time": 0.410944, "process_mem_max_rss": "292880", "process_in_blocks": "3880", "process_out_blocks": "114248"}
[0m14:05:28.414402 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:28.414292 after 14.74 seconds
[0m14:05:28.414916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5454dc8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54544306e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5411303ec0>]}
[0m14:05:28.415428 [debug] [MainThread]: Flushing usage events
[0m14:05:30.032972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82176d2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821542d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8215c6df70>]}


============================== 14:05:30.035653 | 8d1ed103-1b50-47bc-8142-790ab631ffbe ==============================
[0m14:05:30.035653 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.036383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:30.174279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d1ed103-1b50-47bc-8142-790ab631ffbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8215491220>]}
[0m14:05:30.190530 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2069629, "process_user_time": 1.431243, "process_kernel_time": 0.095949, "process_mem_max_rss": "92520", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:30.191106 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:30.191004 after 0.21 seconds
[0m14:05:30.191542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82176798e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82152a7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82152a59d0>]}
[0m14:05:30.191995 [debug] [MainThread]: Flushing usage events
[0m22:05:33.603562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35d135490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35aa31a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35ae5c290>]}


============================== 22:05:33.610883 | ae18dd2d-d38d-48db-a4e0-6137bf11ed15 ==============================
[0m22:05:33.610883 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:33.611606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:33.749740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae18dd2d-d38d-48db-a4e0-6137bf11ed15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a737590>]}
[0m22:05:33.763108 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pwk3ngnp'
[0m22:05:33.763562 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:33.865634 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:33.866248 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:33.877738 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:33.881684 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:34.034087 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:34.034659 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:34.035186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ae18dd2d-d38d-48db-a4e0-6137bf11ed15', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a89ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a785be0>]}
[0m22:05:34.035653 [info ] [MainThread]: 
[0m22:05:34.036141 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:34.044318 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48991188, "process_user_time": 1.562645, "process_kernel_time": 0.109021, "process_mem_max_rss": "93540", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m22:05:34.044983 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:34.044871 after 0.49 seconds
[0m22:05:34.045431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35c9c0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a89ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35acece00>]}
[0m22:05:34.045868 [debug] [MainThread]: Flushing usage events
[0m22:05:35.648446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ae529340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ad1d47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76af011ac0>]}


============================== 22:05:35.651169 | a04c3496-0e98-4c40-be7f-943427937287 ==============================
[0m22:05:35.651169 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.651807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.886510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76adf19e20>]}
[0m22:05:35.945007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76acb26300>]}
[0m22:05:35.947398 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:35.968140 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:35.968883 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:35.969420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76acb00ce0>]}
[0m22:05:37.196083 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:37.196768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a54ae300>]}
[0m22:05:37.377282 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:37.382293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a53788c0>]}
[0m22:05:37.515562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a55e7f20>]}
[0m22:05:37.516111 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:37.516647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a53b5ee0>]}
[0m22:05:37.518355 [info ] [MainThread]: 
[0m22:05:37.519066 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:37.523710 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:37.560129 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:37.560577 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:37.561018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:38.118086 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:38.119682 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:38.121733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:38.122288 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:38.129335 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:38.129770 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:38.130163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:38.136333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.137766 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:38.138170 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:38.138708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.139100 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:38.139478 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:38.140032 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.140985 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:38.141401 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:38.141782 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:38.142369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.142771 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:38.144688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:38.150144 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:38.150556 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:38.150925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:38.156491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.156932 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:38.157328 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:38.180361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:38.181816 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:38.183013 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:38.183409 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:38.186674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a531ab40>]}
[0m22:05:38.187186 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.187577 [debug] [MainThread]: On master: BEGIN
[0m22:05:38.187946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:38.194271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.194700 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.195089 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.195465 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.195992 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.196397 [debug] [MainThread]: On master: Close
[0m22:05:38.198077 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:38.198612 [info ] [MainThread]: 
[0m22:05:38.220631 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:38.221255 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:38.221988 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:38.222451 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:38.248046 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:38.248840 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:38.284167 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:38.284940 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:46.124440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:46.125012 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:46.125653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.126112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:46.126555 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:46.127264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.130172 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:46.130633 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:46.131319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.152079 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:46.152553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:46.153012 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:46.154973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.159875 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:46.160355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:46.161526 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.163823 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:46.192765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76a55be270>]}
[0m22:05:46.193475 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.97s]
[0m22:05:46.194251 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:46.195216 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:46.195769 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:46.196356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:46.196849 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:46.201839 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:46.202498 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:46.235607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:46.236106 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241129220546229779"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:46.236574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:46.250925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.258188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:46.258655 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:46.259258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.259716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:46.260158 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241129220546229779'
      
      
      order by ordinal_position

  
[0m22:05:46.280708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.286799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:46.287290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:46.290351 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.297802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:46.298287 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:46.301046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.318921 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:46.319611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:46.320090 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241129220546229779"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241129220546229779"
    )
  
[0m22:05:46.351897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.353999 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:46.354469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:46.354903 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:46.363877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:46.364815 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:46.523563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a04c3496-0e98-4c40-be7f-943427937287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7669d6e090>]}
[0m22:05:46.524344 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:05:46.525136 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:46.526610 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.527105 [debug] [MainThread]: On master: BEGIN
[0m22:05:46.527565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:46.534185 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.534671 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.535111 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.535534 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.536121 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.536576 [debug] [MainThread]: On master: Close
[0m22:05:46.537958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:46.538396 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:46.538803 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:46.539265 [info ] [MainThread]: 
[0m22:05:46.539850 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.02 seconds (9.02s).
[0m22:05:46.540996 [debug] [MainThread]: Command end result
[0m22:05:46.568909 [info ] [MainThread]: 
[0m22:05:46.569591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:46.570184 [info ] [MainThread]: 
[0m22:05:46.570781 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:46.571861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.972732, "process_user_time": 5.494318, "process_kernel_time": 0.375338, "process_mem_max_rss": "295548", "process_in_blocks": "3880", "process_out_blocks": "114280"}
[0m22:05:46.572512 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:46.572399 after 10.97 seconds
[0m22:05:46.573045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ad5ae060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f766aee3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76acc49bb0>]}
[0m22:05:46.573533 [debug] [MainThread]: Flushing usage events
[0m22:05:48.240466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a7a22ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a9d85c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a7a8e4e0>]}


============================== 22:05:48.243123 | 472d8776-e6ac-4496-a40c-dad8d659c4ae ==============================
[0m22:05:48.243123 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:48.243774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:48.379262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '472d8776-e6ac-4496-a40c-dad8d659c4ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a836e150>]}
[0m22:05:48.395655 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20423412, "process_user_time": 1.395169, "process_kernel_time": 0.111933, "process_mem_max_rss": "92512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:48.396227 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:48.396124 after 0.20 seconds
[0m22:05:48.396707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a9d85c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a78a1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70a7809970>]}
[0m22:05:48.397140 [debug] [MainThread]: Flushing usage events
[0m06:02:14.223608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7aef27860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7aef26240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7aef26210>]}


============================== 06:02:14.230812 | 5c2eb8ec-533e-40bd-86f0-945afc795981 ==============================
[0m06:02:14.230812 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.231513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.368483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c2eb8ec-533e-40bd-86f0-945afc795981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ae7c2570>]}
[0m06:02:14.381708 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rzjwaj5r'
[0m06:02:14.382155 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.452272 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.452864 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.463578 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.467378 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:14.513708 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:14.514211 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:14.514723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5c2eb8ec-533e-40bd-86f0-945afc795981', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ae5a42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ae5023f0>]}
[0m06:02:14.515203 [info ] [MainThread]: 
[0m06:02:14.515674 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:14.517256 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34225425, "process_user_time": 1.524742, "process_kernel_time": 0.138984, "process_mem_max_rss": "93940", "process_in_blocks": "5784", "process_out_blocks": "3992"}
[0m06:02:14.517841 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:14.517732 after 0.34 seconds
[0m06:02:14.518267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7aebd7ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ae77f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7af03ed50>]}
[0m06:02:14.518691 [debug] [MainThread]: Flushing usage events
[0m06:02:16.021822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb99a4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb9b8e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb99a4800>]}


============================== 06:02:16.024519 | a54d9dd9-a20d-4019-b93d-0d557f6aedd8 ==============================
[0m06:02:16.024519 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.025170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.261015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb98c40e0>]}
[0m06:02:16.320032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ebb1175c0>]}
[0m06:02:16.322418 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:16.349918 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:16.350637 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:16.351193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eba39fad0>]}
[0m06:02:17.598407 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:17.599080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb2765a60>]}
[0m06:02:17.780927 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:17.785870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb2763e90>]}
[0m06:02:17.937505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb23c5ac0>]}
[0m06:02:17.938033 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:17.938531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb2246b40>]}
[0m06:02:17.940223 [info ] [MainThread]: 
[0m06:02:17.940892 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:17.945573 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:17.981824 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:17.982271 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:17.982667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:18.476438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.478001 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:18.480245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:18.480810 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:18.487985 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.488424 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:18.488822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.495128 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.496542 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.496947 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:18.497552 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.497957 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.498344 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:18.499005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.499943 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.500346 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.500721 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.501257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.501669 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:18.503617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:18.509120 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.509537 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:18.509913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.515558 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.515974 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.516374 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:18.539725 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.541138 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:18.542346 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:18.542754 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:18.545906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb1059ac0>]}
[0m06:02:18.546410 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.546799 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.547212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:18.553602 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.554031 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.554418 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.554792 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.555405 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.555809 [debug] [MainThread]: On master: Close
[0m06:02:18.557414 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:18.557944 [info ] [MainThread]: 
[0m06:02:18.567599 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:18.568191 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:18.568901 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:18.569349 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:18.595182 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:18.595947 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:18.631491 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:18.632219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:25.663223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.663741 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:25.664378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.664832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.665269 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:25.665973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.668873 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.669334 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:25.670019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.690811 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.691321 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.691772 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:25.692998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.697900 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:25.698370 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:25.699562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.701897 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:25.731158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ebaf4a5d0>]}
[0m06:02:25.731866 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.16s]
[0m06:02:25.732638 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:25.733620 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:25.734196 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:25.734776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:25.735284 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:25.740241 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:25.740893 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:25.774395 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.774905 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241130060225768510"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:25.775429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:25.789276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.796665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.797131 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:25.797796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.798248 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.798688 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241130060225768510'
      
      
      order by ordinal_position

  
[0m06:02:25.821095 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.827150 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.827631 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.830681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.838142 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.838616 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.843083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.860863 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:25.861540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.862014 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241130060225768510"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241130060225768510"
    )
  
[0m06:02:25.900831 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.902717 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.903202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.903630 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.911744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.912639 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:26.110121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a54d9dd9-a20d-4019-b93d-0d557f6aedd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb134fa10>]}
[0m06:02:26.110978 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:26.111737 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:26.113158 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.113642 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.114082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:26.120772 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.121256 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.121696 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.122123 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.122717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.123211 [debug] [MainThread]: On master: Close
[0m06:02:26.124772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:26.125223 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:26.125631 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:26.126093 [info ] [MainThread]: 
[0m06:02:26.126629 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m06:02:26.127697 [debug] [MainThread]: Command end result
[0m06:02:26.155570 [info ] [MainThread]: 
[0m06:02:26.156218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:26.156766 [info ] [MainThread]: 
[0m06:02:26.157327 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:26.158343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.185968, "process_user_time": 5.608786, "process_kernel_time": 0.299614, "process_mem_max_rss": "284360", "process_in_blocks": "3880", "process_out_blocks": "114752"}
[0m06:02:26.159033 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:26.158897 after 10.19 seconds
[0m06:02:26.159535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb9b8e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb997fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eb9e44860>]}
[0m06:02:26.160021 [debug] [MainThread]: Flushing usage events
[0m06:02:27.769636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15f73e2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15f757a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15f7b411c0>]}


============================== 06:02:27.772274 | 632161fe-c8f2-4191-9363-0f01026564df ==============================
[0m06:02:27.772274 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.772916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.907825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '632161fe-c8f2-4191-9363-0f01026564df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15f6c79b80>]}
[0m06:02:27.923820 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20274216, "process_user_time": 1.381216, "process_kernel_time": 0.111774, "process_mem_max_rss": "92268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:27.924386 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:27.924286 after 0.20 seconds
[0m06:02:27.924810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15f6a57c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15f6c79b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15f760a930>]}
[0m06:02:27.925239 [debug] [MainThread]: Flushing usage events
[0m14:04:51.281137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e0296090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e30c1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e0a3f950>]}


============================== 14:04:51.288300 | c44482a8-0c6a-4d96-bbf0-730acc44f94a ==============================
[0m14:04:51.288300 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:51.289003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:51.424807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c44482a8-0c6a-4d96-bbf0-730acc44f94a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e00fd340>]}
[0m14:04:51.437941 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ou8n8pcr'
[0m14:04:51.438385 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:51.519264 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:51.519855 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:51.533109 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:51.536907 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:51.595718 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:51.596262 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:51.596859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c44482a8-0c6a-4d96-bbf0-730acc44f94a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e007ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e001ad50>]}
[0m14:04:51.597302 [info ] [MainThread]: 
[0m14:04:51.597818 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:51.599783 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.36755952, "process_user_time": 1.543304, "process_kernel_time": 0.144308, "process_mem_max_rss": "93608", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m14:04:51.600358 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:51.600257 after 0.37 seconds
[0m14:04:51.600786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e02d9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e02da180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e06c4bc0>]}
[0m14:04:51.601206 [debug] [MainThread]: Flushing usage events
[0m14:04:53.092883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bdf96a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bdd46600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bda0a870>]}


============================== 14:04:53.095545 | 5f49dad6-9f73-4c6e-9939-10a01ff68b17 ==============================
[0m14:04:53.095545 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:53.096212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:53.327260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bdaa62a0>]}
[0m14:04:53.385559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bda089b0>]}
[0m14:04:53.387965 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:53.403372 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:53.404072 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:53.404614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b6a27d10>]}
[0m14:04:54.627726 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:54.628373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b646a840>]}
[0m14:04:54.808059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:54.813035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b69f9ca0>]}
[0m14:04:54.933311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b65e43e0>]}
[0m14:04:54.933848 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:54.934355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b63a3230>]}
[0m14:04:54.936096 [info ] [MainThread]: 
[0m14:04:54.936806 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:54.941470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:54.977458 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:54.977902 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:54.978308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:55.539648 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:55.541211 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:55.543300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:55.543860 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:55.551036 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:55.551471 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:55.551878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:55.558190 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:55.559641 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:55.560051 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:55.560599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:55.561003 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:55.561384 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:55.561950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:55.562902 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:55.563310 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:55.563699 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:55.564293 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:55.564718 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:55.566658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:55.572179 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:55.572594 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:55.572969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:55.578564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:55.579010 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:55.579415 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:55.602798 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:55.604247 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:55.605452 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:55.605863 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:55.609147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bf1b9490>]}
[0m14:04:55.609673 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:55.610067 [debug] [MainThread]: On master: BEGIN
[0m14:04:55.610440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:55.616704 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:55.617130 [debug] [MainThread]: On master: COMMIT
[0m14:04:55.617523 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:55.617902 [debug] [MainThread]: On master: COMMIT
[0m14:04:55.618448 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:55.618885 [debug] [MainThread]: On master: Close
[0m14:04:55.620257 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:55.620779 [info ] [MainThread]: 
[0m14:04:55.630347 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:55.630965 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:55.631670 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:55.632120 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:55.658249 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:55.659009 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:55.694893 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:55.695614 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:02.622819 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:02.623368 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:02.624014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.624473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:02.624912 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:02.625634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.628534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:02.628993 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:02.629688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.650474 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:02.650977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:02.651424 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:02.652659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.657541 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:02.658006 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:02.659289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.661571 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:02.691041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc476c9e810>]}
[0m14:05:02.691750 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.06s]
[0m14:05:02.692606 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:02.693616 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:02.694169 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:02.694824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:02.695337 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:02.700287 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:02.700928 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:02.734541 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:02.735084 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241130140502728676"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:02.735561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:02.750295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.757649 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:02.758110 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:02.758693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.759159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:02.759594 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241130140502728676'
      
      
      order by ordinal_position

  
[0m14:05:02.780427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.786487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:02.786997 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:02.790085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.797572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:02.798049 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:02.800897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.818867 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:02.819538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:02.820006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241130140502728676"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241130140502728676"
    )
  
[0m14:05:02.856994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.858933 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:02.859408 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:02.859833 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:02.868910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:02.869794 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:03.035902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f49dad6-9f73-4c6e-9939-10a01ff68b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc476cfc3e0>]}
[0m14:05:03.036706 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:03.037486 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:03.038815 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:03.039327 [debug] [MainThread]: On master: BEGIN
[0m14:05:03.039766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:03.046256 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:03.046732 [debug] [MainThread]: On master: COMMIT
[0m14:05:03.047222 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:03.047646 [debug] [MainThread]: On master: COMMIT
[0m14:05:03.048224 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:03.048669 [debug] [MainThread]: On master: Close
[0m14:05:03.049972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:03.050404 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:03.050803 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:03.051302 [info ] [MainThread]: 
[0m14:05:03.051883 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m14:05:03.052966 [debug] [MainThread]: Command end result
[0m14:05:03.080417 [info ] [MainThread]: 
[0m14:05:03.081093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:03.081675 [info ] [MainThread]: 
[0m14:05:03.082261 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:03.083332 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.039448, "process_user_time": 5.426306, "process_kernel_time": 0.301461, "process_mem_max_rss": "295640", "process_in_blocks": "3880", "process_out_blocks": "114760"}
[0m14:05:03.083972 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:03.083863 after 10.04 seconds
[0m14:05:03.084456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bea90680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bdc7eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4773df140>]}
[0m14:05:03.084935 [debug] [MainThread]: Flushing usage events
[0m14:05:04.683061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b331d2ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b332dd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b354fddf0>]}


============================== 14:05:04.685697 | 8db0634a-c570-470f-8718-55fe58dad5dd ==============================
[0m14:05:04.685697 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:04.686405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.823742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8db0634a-c570-470f-8718-55fe58dad5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b33b07710>]}
[0m14:05:04.840110 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20621833, "process_user_time": 1.397115, "process_kernel_time": 0.119752, "process_mem_max_rss": "92268", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:04.840718 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:04.840614 after 0.21 seconds
[0m14:05:04.841148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b341cfbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b32fd7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b32f7c320>]}
[0m14:05:04.841576 [debug] [MainThread]: Flushing usage events
[0m22:05:25.728833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e1bdb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e1fe0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e1fe3a40>]}


============================== 22:05:25.735994 | 08696695-f49f-4536-8d63-50b8f4bc64a5 ==============================
[0m22:05:25.735994 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.736657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:25.872172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08696695-f49f-4536-8d63-50b8f4bc64a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e183baa0>]}
[0m22:05:25.885259 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3clkf89j'
[0m22:05:25.885762 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:25.934704 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:25.935298 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:25.946445 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:25.950272 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:26.102122 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:26.102623 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:26.103136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '08696695-f49f-4536-8d63-50b8f4bc64a5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e1509fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e1509c70>]}
[0m22:05:26.103582 [info ] [MainThread]: 
[0m22:05:26.104060 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:26.117774 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.437623, "process_user_time": 1.586632, "process_kernel_time": 0.116486, "process_mem_max_rss": "93664", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m22:05:26.118484 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:26.118360 after 0.44 seconds
[0m22:05:26.118964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e17b3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e51bbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e183baa0>]}
[0m22:05:26.119388 [debug] [MainThread]: Flushing usage events
[0m22:05:27.730268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02ae8efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02b7c2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02b7c0d10>]}


============================== 22:05:27.732992 | a6c66337-b802-4ae6-93ce-e2ed23279b8d ==============================
[0m22:05:27.732992 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:27.733718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:27.966139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02ac190a0>]}
[0m22:05:28.025229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02b650a40>]}
[0m22:05:28.027766 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:28.055946 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:28.056662 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:28.057201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd023c27d10>]}
[0m22:05:29.283109 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:29.283785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd023bd7470>]}
[0m22:05:29.465898 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:29.470918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd023574c20>]}
[0m22:05:29.620559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0237dd7f0>]}
[0m22:05:29.621103 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:29.621651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0236ea000>]}
[0m22:05:29.623356 [info ] [MainThread]: 
[0m22:05:29.624050 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:29.628830 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:29.665219 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:29.665752 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:29.666161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:30.192594 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:30.194185 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:30.196241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:30.196806 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:30.203887 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:30.204324 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:30.204723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:30.210992 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:30.212440 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:30.212882 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:30.213523 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:30.213929 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:30.214311 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:30.214908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:30.215830 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:30.216244 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:30.216630 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:30.217170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:30.217621 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:30.219464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:30.225147 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:30.225603 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:30.225995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:30.231773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:30.232189 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:30.232593 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:30.256837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:30.258296 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:30.259508 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:30.259923 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:30.263210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd023510cb0>]}
[0m22:05:30.263726 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:30.264121 [debug] [MainThread]: On master: BEGIN
[0m22:05:30.264496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:30.270736 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:30.271170 [debug] [MainThread]: On master: COMMIT
[0m22:05:30.271560 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:30.271945 [debug] [MainThread]: On master: COMMIT
[0m22:05:30.272493 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:30.272902 [debug] [MainThread]: On master: Close
[0m22:05:30.274836 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:30.275354 [info ] [MainThread]: 
[0m22:05:30.298859 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:30.299454 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:30.300119 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:30.300567 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:30.326469 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:30.327213 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:30.362622 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:30.363434 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:38.443129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:38.443638 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:38.444285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.444744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:38.445186 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:38.445915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.448807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:38.449265 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:38.449983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.470536 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:38.471020 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:38.471482 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:38.472739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.477655 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:38.478131 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:38.479690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.481977 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:38.511319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c35e600>]}
[0m22:05:38.512017 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.21s]
[0m22:05:38.512789 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:38.513814 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:38.514369 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:38.514964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:38.515412 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:38.520369 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:38.521029 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:38.554330 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.554838 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241130220538548433"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:38.555310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:38.570375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.577812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.578284 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:38.578899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.579349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.579787 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241130220538548433'
      
      
      order by ordinal_position

  
[0m22:05:38.600772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.607062 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.607559 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:38.610689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.618214 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.618684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:38.621531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.639462 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:38.640152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.640632 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241130220538548433"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241130220538548433"
    )
  
[0m22:05:38.679563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.681613 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:38.682100 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:38.682535 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:38.691968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:38.692890 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:38.869626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c66337-b802-4ae6-93ce-e2ed23279b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfdbea4d40>]}
[0m22:05:38.870445 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:05:38.871288 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:38.872575 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.873044 [debug] [MainThread]: On master: BEGIN
[0m22:05:38.873511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:38.880068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.880550 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.880988 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:38.881416 [debug] [MainThread]: On master: COMMIT
[0m22:05:38.882108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:38.882566 [debug] [MainThread]: On master: Close
[0m22:05:38.883868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:38.884324 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:38.884740 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:38.885206 [info ] [MainThread]: 
[0m22:05:38.885836 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.26 seconds (9.26s).
[0m22:05:38.886939 [debug] [MainThread]: Command end result
[0m22:05:38.914807 [info ] [MainThread]: 
[0m22:05:38.915491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:38.916082 [info ] [MainThread]: 
[0m22:05:38.916690 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:38.917782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.23642, "process_user_time": 5.533382, "process_kernel_time": 0.350567, "process_mem_max_rss": "278460", "process_in_blocks": "3880", "process_out_blocks": "114792"}
[0m22:05:38.918458 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:38.918335 after 11.24 seconds
[0m22:05:38.918956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02e7bbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02ae01640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe81ab8c0>]}
[0m22:05:38.919445 [debug] [MainThread]: Flushing usage events
[0m22:05:40.579215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b76c81f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7497e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b759f53d0>]}


============================== 22:05:40.581920 | ebc7da22-eb1c-4c42-96ec-5300a6e2cb37 ==============================
[0m22:05:40.581920 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.582611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.722919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebc7da22-eb1c-4c42-96ec-5300a6e2cb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b74d1ff80>]}
[0m22:05:40.739021 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20874256, "process_user_time": 1.383592, "process_kernel_time": 0.115965, "process_mem_max_rss": "92528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:40.739583 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:40.739483 after 0.21 seconds
[0m22:05:40.740009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b747953d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b74c330e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7471a930>]}
[0m22:05:40.740434 [debug] [MainThread]: Flushing usage events
[0m06:02:11.546347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3ef9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e41a02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3efb9b0>]}


============================== 06:02:11.553875 | 67296513-f869-4466-bf21-14873d75116e ==============================
[0m06:02:11.553875 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.554579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.696551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67296513-f869-4466-bf21-14873d75116e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3d193d0>]}
[0m06:02:11.710200 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4j8e_7w1'
[0m06:02:11.710650 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.814532 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.815178 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.825492 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.829401 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.002175 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.002760 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:12.003341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '67296513-f869-4466-bf21-14873d75116e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3c73b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3c71b20>]}
[0m06:02:12.003831 [info ] [MainThread]: 
[0m06:02:12.004359 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:12.006367 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50918615, "process_user_time": 1.571196, "process_kernel_time": 0.127286, "process_mem_max_rss": "94084", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m06:02:12.006964 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:12.006860 after 0.51 seconds
[0m06:02:12.007409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e7bbbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e4366e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e4364fe0>]}
[0m06:02:12.007899 [debug] [MainThread]: Flushing usage events
[0m06:02:13.642218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e21ddd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53deef72c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e1142150>]}


============================== 06:02:13.644965 | 9c9a6308-f13e-4137-9144-725c5168dc9e ==============================
[0m06:02:13.644965 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.645606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.879755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e27bbb00>]}
[0m06:02:13.938978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53dec2aff0>]}
[0m06:02:13.941541 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:13.957913 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.958632 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.959168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d7c4d8e0>]}
[0m06:02:15.189953 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:15.190624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d7c284a0>]}
[0m06:02:15.373506 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:15.378739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d76bf0e0>]}
[0m06:02:15.517605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d77ef980>]}
[0m06:02:15.518158 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:15.518665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d764dcd0>]}
[0m06:02:15.520455 [info ] [MainThread]: 
[0m06:02:15.521181 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:15.526095 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:15.562877 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:15.563346 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:15.563786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:16.149328 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:16.150886 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:16.152905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:16.153460 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:16.160487 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.160912 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:16.161299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.167413 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.168847 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.169248 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:16.169779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.170175 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.170554 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:16.171136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.172089 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.172492 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.172875 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.173413 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.173824 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:16.175806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:16.181335 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.181746 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:16.182113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.187809 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.188227 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.188618 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:16.210856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.212379 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:16.213577 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:16.213989 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:16.217375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d61e43b0>]}
[0m06:02:16.217894 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.218288 [debug] [MainThread]: On master: BEGIN
[0m06:02:16.218657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:16.224958 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.225383 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.225768 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.226142 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.226671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.227072 [debug] [MainThread]: On master: Close
[0m06:02:16.228661 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:16.229149 [info ] [MainThread]: 
[0m06:02:16.239185 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:16.239810 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:16.240438 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:16.240887 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:16.267042 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:16.267817 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:16.303939 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:16.304670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:24.824021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.824553 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:24.825192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.825645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.826084 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:24.826856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.829872 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.830339 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:24.831069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.851832 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.852316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.852759 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.853902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.858874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.859344 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:24.860740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.863054 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:24.893897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5397f27b90>]}
[0m06:02:24.894694 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.65s]
[0m06:02:24.895475 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:24.896547 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:24.897119 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:24.897711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:24.898174 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:24.903545 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:24.904293 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:24.938792 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.939383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241201060224932783"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:24.939887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:24.954601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.962549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.963019 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:24.963635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.964120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.964561 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241201060224932783'
      
      
      order by ordinal_position

  
[0m06:02:24.985620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.992148 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.992637 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.997103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.005285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.005832 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:25.009479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.027720 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:25.028496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.028975 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241201060224932783"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241201060224932783"
    )
  
[0m06:02:25.066166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.068241 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.068719 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:25.069151 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:25.078215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:25.079145 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:25.259327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9a6308-f13e-4137-9144-725c5168dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539c181850>]}
[0m06:02:25.260174 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:25.260937 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:25.262342 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.262820 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.263254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:25.270133 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.270620 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.271056 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.271487 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.272118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.272571 [debug] [MainThread]: On master: Close
[0m06:02:25.274167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:25.274614 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:25.275024 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:25.275495 [info ] [MainThread]: 
[0m06:02:25.276075 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.75 seconds (9.75s).
[0m06:02:25.277095 [debug] [MainThread]: Command end result
[0m06:02:25.305021 [info ] [MainThread]: 
[0m06:02:25.305680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:25.306195 [info ] [MainThread]: 
[0m06:02:25.306722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:25.307742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.715385, "process_user_time": 5.082198, "process_kernel_time": 0.336675, "process_mem_max_rss": "293492", "process_in_blocks": "3880", "process_out_blocks": "115272"}
[0m06:02:25.308385 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:25.308276 after 11.72 seconds
[0m06:02:25.308882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53dee7b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53df82b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d7630bc0>]}
[0m06:02:25.309369 [debug] [MainThread]: Flushing usage events
[0m06:02:27.061977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecf06aa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecf08d17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecefda64e0>]}


============================== 06:02:27.064898 | c1b5dded-1e65-4154-b181-276bc5153a2e ==============================
[0m06:02:27.064898 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.065612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.212194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1b5dded-1e65-4154-b181-276bc5153a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecf007d280>]}
[0m06:02:27.228631 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21599601, "process_user_time": 1.432996, "process_kernel_time": 0.09979, "process_mem_max_rss": "92324", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:27.229217 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:27.229113 after 0.22 seconds
[0m06:02:27.229674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecf070a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecf030c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecefc19dc0>]}
[0m06:02:27.230117 [debug] [MainThread]: Flushing usage events
[0m14:04:55.880227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9259dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde90ee8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde910d8b60>]}


============================== 14:04:55.899892 | 83128300-ae84-4d4f-af80-049335b29422 ==============================
[0m14:04:55.899892 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:55.900584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:56.041559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83128300-ae84-4d4f-af80-049335b29422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde900b7590>]}
[0m14:04:56.054922 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y7hold67'
[0m14:04:56.055389 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:56.156299 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:56.156907 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:56.167000 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:56.170835 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:56.302902 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:56.303457 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:56.304050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '83128300-ae84-4d4f-af80-049335b29422', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9061a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8ffbfb00>]}
[0m14:04:56.304496 [info ] [MainThread]: 
[0m14:04:56.305008 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:56.312660 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4809555, "process_user_time": 1.57086, "process_kernel_time": 0.138488, "process_mem_max_rss": "93828", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m14:04:56.313264 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:56.313160 after 0.48 seconds
[0m14:04:56.313708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde93bbbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde90ee8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8ff0aa50>]}
[0m14:04:56.314148 [debug] [MainThread]: Flushing usage events
[0m14:04:57.899290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81940e2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8194e03140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81943b7ec0>]}


============================== 14:04:57.901991 | 17e866d0-00ab-4957-a890-afa3e22d0ecb ==============================
[0m14:04:57.901991 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:57.902709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:58.134482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8193f0a6f0>]}
[0m14:04:58.193078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819484d0d0>]}
[0m14:04:58.195426 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:58.210676 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:58.211379 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:58.211950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818cf68590>]}
[0m14:04:59.445270 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:59.445884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818c9cb110>]}
[0m14:04:59.628226 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:59.633217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818c7817c0>]}
[0m14:04:59.796185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818c9ef2c0>]}
[0m14:04:59.796735 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:59.797230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818c780aa0>]}
[0m14:04:59.798916 [info ] [MainThread]: 
[0m14:04:59.799602 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:59.804439 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:59.841134 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:59.841583 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:59.841992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:00.380953 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:00.382512 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:00.384572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:00.385141 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:00.392172 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:00.392608 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:00.393000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:00.399136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:00.400578 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:00.400987 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:00.401531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:00.401924 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:00.402309 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:00.402888 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:00.403856 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:00.404264 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:00.404650 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:00.405197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:00.405605 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:00.407483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:00.413023 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:00.413441 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:00.413821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:00.419596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:00.420052 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:00.420453 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:00.444017 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:00.445454 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:00.446651 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:00.447065 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:00.450993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81955c1460>]}
[0m14:05:00.451518 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:00.451956 [debug] [MainThread]: On master: BEGIN
[0m14:05:00.452334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:00.458527 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:00.458950 [debug] [MainThread]: On master: COMMIT
[0m14:05:00.459339 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:00.459760 [debug] [MainThread]: On master: COMMIT
[0m14:05:00.460312 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:00.460715 [debug] [MainThread]: On master: Close
[0m14:05:00.462156 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:00.462693 [info ] [MainThread]: 
[0m14:05:00.474963 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:00.475570 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:00.476325 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:00.476776 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:00.502432 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:00.503191 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:00.538988 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:00.539755 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:08.291471 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:08.292060 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:08.292772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.293232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:08.293686 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:08.294473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.297514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:08.297970 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:08.298686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.319547 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:08.320085 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:08.320540 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:08.321773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.326904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:08.327379 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:08.328673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.331061 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:08.362251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818c83a480>]}
[0m14:05:08.363534 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.88s]
[0m14:05:08.364792 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:08.366194 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:08.367155 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:08.368124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:08.368907 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:08.378270 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:08.379358 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:08.415376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:08.415990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241201140508409402"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:08.416471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:08.431104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.438913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:08.439391 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:08.440048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.440500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:08.440940 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241201140508409402'
      
      
      order by ordinal_position

  
[0m14:05:08.463112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.469666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:08.470164 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:08.473103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.480623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:08.481100 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:08.485393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.503547 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:08.504399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:08.504889 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241201140508409402"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241201140508409402"
    )
  
[0m14:05:08.543091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.545168 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:08.545646 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:08.546089 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:08.554352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:08.555294 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:08.751041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e866d0-00ab-4957-a890-afa3e22d0ecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f814d15c260>]}
[0m14:05:08.751919 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m14:05:08.752780 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:08.754235 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:08.754707 [debug] [MainThread]: On master: BEGIN
[0m14:05:08.755149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:08.762048 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:08.762563 [debug] [MainThread]: On master: COMMIT
[0m14:05:08.763003 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:08.763430 [debug] [MainThread]: On master: COMMIT
[0m14:05:08.764061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:08.764522 [debug] [MainThread]: On master: Close
[0m14:05:08.766318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:08.766769 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:08.767184 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:08.767707 [info ] [MainThread]: 
[0m14:05:08.768313 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.97 seconds (8.97s).
[0m14:05:08.769437 [debug] [MainThread]: Command end result
[0m14:05:08.798694 [info ] [MainThread]: 
[0m14:05:08.799461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:08.800117 [info ] [MainThread]: 
[0m14:05:08.800700 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:08.801808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.951814, "process_user_time": 5.673634, "process_kernel_time": 0.299874, "process_mem_max_rss": "303420", "process_in_blocks": "3880", "process_out_blocks": "116808"}
[0m14:05:08.802490 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:08.802374 after 10.95 seconds
[0m14:05:08.803011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f819438b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81940e2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8194508bc0>]}
[0m14:05:08.803518 [debug] [MainThread]: Flushing usage events
[0m14:05:10.598786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378fb26180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37914491f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37914498b0>]}


============================== 14:05:10.601624 | 5a0790a4-448a-4ddf-9a45-69b2ee4bb01e ==============================
[0m14:05:10.601624 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.602258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.741509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a0790a4-448a-4ddf-9a45-69b2ee4bb01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378f02f3e0>]}
[0m14:05:10.757557 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20804246, "process_user_time": 1.449306, "process_kernel_time": 0.095821, "process_mem_max_rss": "92428", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:10.758126 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:10.758025 after 0.21 seconds
[0m14:05:10.758553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3790965070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37929b4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378f49b9b0>]}
[0m14:05:10.758980 [debug] [MainThread]: Flushing usage events
[0m22:05:34.596137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6aa57f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6aa823b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6aa5cb380>]}


============================== 22:05:34.603528 | a6b41039-34bd-4bf8-b966-e1206148fdac ==============================
[0m22:05:34.603528 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:34.604215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:34.742926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6b41039-34bd-4bf8-b966-e1206148fdac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6acbed880>]}
[0m22:05:34.756411 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dhztqo9j'
[0m22:05:34.756882 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:34.878064 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:34.878741 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:34.930490 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:34.934461 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:35.157624 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:35.158199 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:35.158752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a6b41039-34bd-4bf8-b966-e1206148fdac', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6aa5c33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6aa367ce0>]}
[0m22:05:35.159211 [info ] [MainThread]: 
[0m22:05:35.159696 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:35.161487 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6142002, "process_user_time": 1.521686, "process_kernel_time": 0.166434, "process_mem_max_rss": "93788", "process_in_blocks": "5784", "process_out_blocks": "3992"}
[0m22:05:35.162090 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:35.161987 after 0.61 seconds
[0m22:05:35.162525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6aaee7ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6aa2bd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6aa2bd3d0>]}
[0m22:05:35.162949 [debug] [MainThread]: Flushing usage events
[0m22:05:37.238655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695da3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1698b1a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1696195130>]}


============================== 22:05:37.241450 | 3a435a36-8f1b-4b5b-acaf-d6c2efa25638 ==============================
[0m22:05:37.241450 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.242127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.476453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695a69100>]}
[0m22:05:37.535270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695b4d370>]}
[0m22:05:37.537759 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:37.555932 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:37.556655 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:37.557185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168eb2fd10>]}
[0m22:05:38.779252 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:38.779973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695a47d70>]}
[0m22:05:38.961320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:38.966427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168e5ab860>]}
[0m22:05:39.087292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168e9de9f0>]}
[0m22:05:39.087883 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:39.088409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695e3fa70>]}
[0m22:05:39.090112 [info ] [MainThread]: 
[0m22:05:39.090840 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:39.095701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:39.132572 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:39.133026 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:39.133423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:39.665163 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:39.666730 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:39.668774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:39.669350 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:39.676459 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.676895 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:39.677290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.683603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.685069 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.685480 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:39.686077 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.686479 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.686863 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:39.687438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.688381 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.688791 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.689178 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.689721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.690131 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:39.692082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:39.697630 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.698048 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:39.698433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.704043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.704459 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.704860 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:39.728845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.730274 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:39.731462 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:39.731926 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:39.735077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168e412ae0>]}
[0m22:05:39.735588 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.736022 [debug] [MainThread]: On master: BEGIN
[0m22:05:39.736398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:39.743051 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.743489 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.743930 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.744325 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.744862 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.745274 [debug] [MainThread]: On master: Close
[0m22:05:39.746887 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:39.747418 [info ] [MainThread]: 
[0m22:05:39.757318 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:39.757919 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:39.758628 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:39.759074 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:39.784867 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:39.785611 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:39.821578 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:39.822309 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:48.958381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.958902 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:48.959579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.960082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.960527 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:48.961242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.964112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.964578 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:48.965288 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.986160 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.986649 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.987095 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.988341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.993277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.993750 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:48.994905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.997251 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:49.026556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168e526390>]}
[0m22:05:49.027286 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.27s]
[0m22:05:49.028185 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:49.029197 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:49.029783 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:49.030458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:49.031105 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:49.036337 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:49.037000 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:49.070608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:49.071136 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241201220549064702"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:49.071612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:49.086877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:49.094405 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:49.094881 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:49.095487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:49.095977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:49.096425 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241201220549064702'
      
      
      order by ordinal_position

  
[0m22:05:49.117469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:49.123826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:49.124323 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:49.127332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:49.134938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:49.135427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:49.138511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:49.156352 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:49.157051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:49.157525 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241201220549064702"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241201220549064702"
    )
  
[0m22:05:49.191085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:49.193141 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:49.193609 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:49.194046 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:49.206685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:49.207586 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:49.409206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a435a36-8f1b-4b5b-acaf-d6c2efa25638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f164eb0e870>]}
[0m22:05:49.410012 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m22:05:49.410845 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:49.412354 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:49.412842 [debug] [MainThread]: On master: BEGIN
[0m22:05:49.413281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:49.420067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:49.420553 [debug] [MainThread]: On master: COMMIT
[0m22:05:49.421002 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:49.421433 [debug] [MainThread]: On master: COMMIT
[0m22:05:49.422070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:49.422541 [debug] [MainThread]: On master: Close
[0m22:05:49.424091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:49.424541 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:49.424956 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:49.425429 [info ] [MainThread]: 
[0m22:05:49.425981 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.33 seconds (10.33s).
[0m22:05:49.427016 [debug] [MainThread]: Command end result
[0m22:05:49.455239 [info ] [MainThread]: 
[0m22:05:49.455900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:49.456437 [info ] [MainThread]: 
[0m22:05:49.456998 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:49.458028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.268684, "process_user_time": 5.575483, "process_kernel_time": 0.363966, "process_mem_max_rss": "297564", "process_in_blocks": "3880", "process_out_blocks": "116832"}
[0m22:05:49.458675 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:49.458567 after 12.27 seconds
[0m22:05:49.459165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168e4bba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695b4c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168e9f3c80>]}
[0m22:05:49.459660 [debug] [MainThread]: Flushing usage events
[0m22:05:51.522618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb89d127440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb89d6c7ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb89d1274d0>]}


============================== 22:05:51.525328 | 8f6268bc-8e87-491b-8b09-e58d53801f9a ==============================
[0m22:05:51.525328 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:51.526043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:51.662775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f6268bc-8e87-491b-8b09-e58d53801f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb89d9d6240>]}
[0m22:05:51.679140 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20593676, "process_user_time": 1.407414, "process_kernel_time": 0.107955, "process_mem_max_rss": "92460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:51.679722 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:51.679618 after 0.21 seconds
[0m22:05:51.680216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb89d1274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb89d5b7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb89f5fa000>]}
[0m22:05:51.680647 [debug] [MainThread]: Flushing usage events
[0m06:02:15.349343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdf380980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdf7da840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdf7d8230>]}


============================== 06:02:15.358038 | 22d4a56a-f7fd-4d79-9b0e-0ec18970a398 ==============================
[0m06:02:15.358038 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:15.358762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.498748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22d4a56a-f7fd-4d79-9b0e-0ec18970a398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdf49d640>]}
[0m06:02:15.512105 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-37pqzku9'
[0m06:02:15.512560 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:15.567755 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:15.568386 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:15.591427 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:15.595258 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:15.676431 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:15.676946 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:15.677453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '22d4a56a-f7fd-4d79-9b0e-0ec18970a398', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdf0ff260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdf0fef60>]}
[0m06:02:15.677898 [info ] [MainThread]: 
[0m06:02:15.678379 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:15.680247 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37976822, "process_user_time": 1.577611, "process_kernel_time": 0.112974, "process_mem_max_rss": "93696", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m06:02:15.680848 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:15.680745 after 0.38 seconds
[0m06:02:15.681278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdf380980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdf0cdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ce03af320>]}
[0m06:02:15.681715 [debug] [MainThread]: Flushing usage events
[0m06:02:17.228919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b08f89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b1037050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b2c320c0>]}


============================== 06:02:17.231607 | 046b629c-01c2-4a38-a6e7-4138d9407638 ==============================
[0m06:02:17.231607 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.232226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.466359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b18c7f20>]}
[0m06:02:17.525286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b08caa20>]}
[0m06:02:17.527749 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:17.543045 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:17.543742 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:17.544276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b13797c0>]}
[0m06:02:18.768036 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:18.768712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a91cc530>]}
[0m06:02:18.951074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:18.956135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a910e420>]}
[0m06:02:19.075867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a91d8c20>]}
[0m06:02:19.076404 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:19.076939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a8f69730>]}
[0m06:02:19.078656 [info ] [MainThread]: 
[0m06:02:19.079384 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:19.084275 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:19.121244 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:19.121701 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:19.122103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:19.675056 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:19.676692 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:19.678830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:19.679399 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:19.686553 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.687021 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:19.687421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.693635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.695133 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.695545 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:19.696096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.696492 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.696875 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:19.697442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.698359 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.698757 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.699187 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.699786 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.700203 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:19.702112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:19.707756 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.708173 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:19.708550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.714441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.714891 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.715295 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:19.738612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.740156 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:19.741377 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:19.741785 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:19.745455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b189ea80>]}
[0m06:02:19.745995 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.746392 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.746766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:19.753197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.753629 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.754020 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.754395 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.754980 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.755386 [debug] [MainThread]: On master: Close
[0m06:02:19.756732 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:19.757229 [info ] [MainThread]: 
[0m06:02:19.766913 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:19.767532 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:19.768176 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:19.768620 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:19.794520 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:19.795307 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:19.832579 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:19.833359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:27.190056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.190575 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:27.191244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.191702 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.192149 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:27.192863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.195860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.196324 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:27.197088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.218218 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.218702 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.219179 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.220423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.225439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.225908 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:27.227193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.229520 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:27.260158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a91ab500>]}
[0m06:02:27.260962 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.49s]
[0m06:02:27.261745 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:27.262751 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:27.263349 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:27.263926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:27.264395 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:27.269766 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:27.270419 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:27.304090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.304613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241202060227298159"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:27.305095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:27.319615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.327634 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.328127 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:27.328785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.329231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.329669 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241202060227298159'
      
      
      order by ordinal_position

  
[0m06:02:27.350594 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.357241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.357736 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.360757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.368543 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.369033 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.371836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.390042 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:27.390817 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.391300 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241202060227298159"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241202060227298159"
    )
  
[0m06:02:27.424181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.426269 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.426773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.427278 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.436012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.436940 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:27.633534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046b629c-01c2-4a38-a6e7-4138d9407638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99699aa4e0>]}
[0m06:02:27.634332 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:27.635174 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:27.636628 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.637109 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.637541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:27.644347 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.644827 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.645262 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.645687 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.646248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.646695 [debug] [MainThread]: On master: Close
[0m06:02:27.648184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:27.648620 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:27.649023 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:27.649471 [info ] [MainThread]: 
[0m06:02:27.649984 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m06:02:27.651003 [debug] [MainThread]: Command end result
[0m06:02:27.681901 [info ] [MainThread]: 
[0m06:02:27.682514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:27.683056 [info ] [MainThread]: 
[0m06:02:27.683589 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:27.684600 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.506183, "process_user_time": 5.451713, "process_kernel_time": 0.320218, "process_mem_max_rss": "298824", "process_in_blocks": "3880", "process_out_blocks": "116816"}
[0m06:02:27.685252 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:27.685144 after 10.51 seconds
[0m06:02:27.685751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b1037050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b08fb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b0cf0590>]}
[0m06:02:27.686238 [debug] [MainThread]: Flushing usage events
[0m06:02:29.345998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fe65f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fe49a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fec5ec30>]}


============================== 06:02:29.348709 | bf8d2043-7807-49f4-8c0b-44c74bef6232 ==============================
[0m06:02:29.348709 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.349414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.494327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf8d2043-7807-49f4-8c0b-44c74bef6232', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fecbdf10>]}
[0m06:02:29.511388 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21443386, "process_user_time": 1.425032, "process_kernel_time": 0.0958, "process_mem_max_rss": "92636", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:29.511979 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:29.511877 after 0.22 seconds
[0m06:02:29.512421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27ff10e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fe755670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fe040e90>]}
[0m06:02:29.512855 [debug] [MainThread]: Flushing usage events
[0m14:05:29.545639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef731f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef523dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef523c9b0>]}


============================== 14:05:29.553125 | 94a932ce-1364-4719-a1b3-d48f822ff744 ==============================
[0m14:05:29.553125 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.553808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.700905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94a932ce-1364-4719-a1b3-d48f822ff744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef5268ad0>]}
[0m14:05:29.715210 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o2i3hso6'
[0m14:05:29.715677 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:29.778378 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:29.779040 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:29.803546 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:29.807702 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:29.883299 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:29.883849 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:29.884388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '94a932ce-1364-4719-a1b3-d48f822ff744', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef4f0de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef5027e00>]}
[0m14:05:29.884858 [info ] [MainThread]: 
[0m14:05:29.885335 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:29.891875 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39627776, "process_user_time": 1.590581, "process_kernel_time": 0.135538, "process_mem_max_rss": "93700", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m14:05:29.892603 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:29.892492 after 0.40 seconds
[0m14:05:29.893062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef731f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef50b7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef532b9b0>]}
[0m14:05:29.893526 [debug] [MainThread]: Flushing usage events
[0m14:05:31.474821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae84117c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae84a2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae84a2f90>]}


============================== 14:05:31.477818 | 812415a6-e058-4f68-9c34-72e7d76bf00b ==============================
[0m14:05:31.477818 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.478487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.726325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae828b470>]}
[0m14:05:31.788876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae131af30>]}
[0m14:05:31.791540 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:31.812469 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:31.813226 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:31.813791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae1250590>]}
[0m14:05:33.141160 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:33.141880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae1181700>]}
[0m14:05:33.335993 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:33.341508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae0c11310>]}
[0m14:05:33.525449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae0db9be0>]}
[0m14:05:33.526041 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:33.526586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae0b21040>]}
[0m14:05:33.528453 [info ] [MainThread]: 
[0m14:05:33.529223 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:33.534460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:33.573147 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:33.573647 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:33.574062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:34.114054 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:34.115755 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:34.117948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:34.118546 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:34.126246 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.126702 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:34.127156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.133482 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.134980 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.135437 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:34.136022 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.136433 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.136825 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:34.137410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.138377 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.138811 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:34.139239 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:34.139801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.140236 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:34.142131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:34.147996 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.148434 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:34.148824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.154649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.155099 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:34.155524 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:34.180879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:34.182404 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:34.183717 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:34.184142 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:34.187750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae99bd460>]}
[0m14:05:34.188313 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.188735 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.189129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:34.195415 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.195865 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.196281 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.196683 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.197233 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.197655 [debug] [MainThread]: On master: Close
[0m14:05:34.199207 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:34.199762 [info ] [MainThread]: 
[0m14:05:34.219924 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:34.220577 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:34.221330 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:34.221808 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:34.249450 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:34.250232 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:34.288698 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:34.289485 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:56.415858 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:56.416409 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:07:56.417068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.417570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:56.418032 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:07:56.418769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.421807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:56.422299 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:07:56.423029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.445139 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:56.445691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:56.446171 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:07:56.447736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.452956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:07:56.453444 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:07:56.454745 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.457244 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:07:56.487850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae06f63c0>]}
[0m14:07:56.488601 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 142.27s]
[0m14:07:56.489500 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:07:56.490524 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:07:56.491139 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:07:56.491825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:07:56.492302 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:07:56.497640 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:07:56.498310 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:07:56.534138 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:56.534667 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241202140756527854"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:07:56.535183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:56.549020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.557159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:56.557643 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:07:56.558345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.558813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:56.559317 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241202140756527854'
      
      
      order by ordinal_position

  
[0m14:07:56.580438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.585866 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:56.586369 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:56.589248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.598902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:56.599446 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:07:56.604323 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.623786 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:07:56.624539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:56.625032 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241202140756527854"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241202140756527854"
    )
  
[0m14:07:56.658693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.660879 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:56.661364 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:07:56.661813 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:07:56.671948 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:07:56.673025 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:07:57.316309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '812415a6-e058-4f68-9c34-72e7d76bf00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaa13c7050>]}
[0m14:07:57.317184 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.82s]
[0m14:07:57.318050 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:07:57.319556 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:57.320050 [debug] [MainThread]: On master: BEGIN
[0m14:07:57.320503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:57.327455 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:57.327946 [debug] [MainThread]: On master: COMMIT
[0m14:07:57.328410 [debug] [MainThread]: Using duckdb connection "master"
[0m14:07:57.328848 [debug] [MainThread]: On master: COMMIT
[0m14:07:57.329443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:07:57.329908 [debug] [MainThread]: On master: Close
[0m14:07:57.331390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:57.331846 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:07:57.332263 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:07:57.332736 [info ] [MainThread]: 
[0m14:07:57.333353 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 23.80 seconds (143.80s).
[0m14:07:57.334502 [debug] [MainThread]: Command end result
[0m14:07:57.363190 [info ] [MainThread]: 
[0m14:07:57.363893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:57.364499 [info ] [MainThread]: 
[0m14:07:57.365115 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:57.366242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 145.94191, "process_user_time": 6.658673, "process_kernel_time": 0.355076, "process_mem_max_rss": "374408", "process_in_blocks": "3880", "process_out_blocks": "131584"}
[0m14:07:57.366911 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:57.366797 after 145.94 seconds
[0m14:07:57.367476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae9338e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae8ca9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae88c83b0>]}
[0m14:07:57.367984 [debug] [MainThread]: Flushing usage events
[0m14:07:59.119896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcd574a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcd576f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcd576ff0>]}


============================== 14:07:59.122818 | b93be114-008b-4863-9e1d-cbb92b618cf6 ==============================
[0m14:07:59.122818 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:07:59.123544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:59.265928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b93be114-008b-4863-9e1d-cbb92b618cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcd354bf0>]}
[0m14:07:59.284306 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21554531, "process_user_time": 1.416092, "process_kernel_time": 0.104006, "process_mem_max_rss": "92292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:59.284930 [debug] [MainThread]: Command `dbt clean` succeeded at 14:07:59.284813 after 0.22 seconds
[0m14:07:59.285397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcd1f8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dce569b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcdaac230>]}
[0m14:07:59.285847 [debug] [MainThread]: Flushing usage events
[0m22:05:53.451639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d29ef9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d2a5bd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d2a1a0170>]}


============================== 22:05:53.470713 | 4c0e4abb-fb92-4d87-b262-3697b9a2400a ==============================
[0m22:05:53.470713 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.471396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.612158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c0e4abb-fb92-4d87-b262-3697b9a2400a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d2a0252e0>]}
[0m22:05:53.625614 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3d5kygh5'
[0m22:05:53.626088 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:53.708403 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:53.709075 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:53.748582 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:53.752469 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:53.823613 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:53.824148 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:53.824694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4c0e4abb-fb92-4d87-b262-3697b9a2400a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d2ac331d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d2ac31a00>]}
[0m22:05:53.825188 [info ] [MainThread]: 
[0m22:05:53.825734 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:53.833954 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4309093, "process_user_time": 1.644286, "process_kernel_time": 0.111477, "process_mem_max_rss": "93932", "process_in_blocks": "5784", "process_out_blocks": "3992"}
[0m22:05:53.834565 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:53.834461 after 0.43 seconds
[0m22:05:53.835014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d29d839e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d2a528fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d2a550f50>]}
[0m22:05:53.835481 [debug] [MainThread]: Flushing usage events
[0m22:05:55.478667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031e7c45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031f2c9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031e8ae5a0>]}


============================== 22:05:55.481488 | 815c6c48-5101-44f9-8155-13c529362883 ==============================
[0m22:05:55.481488 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:55.482173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:55.724919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031e883440>]}
[0m22:05:55.783770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031edbd040>]}
[0m22:05:55.786314 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:55.824121 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:55.824853 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:55.825397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031e820530>]}
[0m22:05:57.047636 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:57.048263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031e862a50>]}
[0m22:05:57.229798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:57.234861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03173b2ba0>]}
[0m22:05:57.384775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03173b11f0>]}
[0m22:05:57.385336 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:57.385849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031710f1a0>]}
[0m22:05:57.387540 [info ] [MainThread]: 
[0m22:05:57.388227 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:57.392934 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:57.429266 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:57.429772 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:57.430176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:58.028158 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:58.029753 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:58.031805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:58.032374 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:58.039539 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:58.039971 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:58.040370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:58.046979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:58.048394 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:58.048800 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:58.049350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:58.049786 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:58.050165 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:58.050772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:58.051691 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:58.052100 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:58.052482 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:58.053071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:58.053483 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:58.055352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:58.060865 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:58.061281 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:58.061692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:58.067492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:58.067911 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:58.068315 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:58.092007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:58.093692 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:58.094952 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:58.095368 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:58.099274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03173b2600>]}
[0m22:05:58.099833 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:58.100238 [debug] [MainThread]: On master: BEGIN
[0m22:05:58.100613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:58.107238 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:58.107674 [debug] [MainThread]: On master: COMMIT
[0m22:05:58.108073 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:58.108454 [debug] [MainThread]: On master: COMMIT
[0m22:05:58.108987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:58.109399 [debug] [MainThread]: On master: Close
[0m22:05:58.111030 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:58.111564 [info ] [MainThread]: 
[0m22:05:58.151260 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:58.151871 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:58.152609 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:58.153063 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:58.179206 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:58.179971 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:58.216153 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:58.216913 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:06.659787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.660314 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:06.660966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.661424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.661894 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:06.662607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.665472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.665964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:06.666660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.687392 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:06.687876 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.688324 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:06.689820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.694743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.695223 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:06.696396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.698722 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:06.728284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031ff2a4b0>]}
[0m22:06:06.729028 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.57s]
[0m22:06:06.729840 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:06.730811 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:06.731384 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:06.731991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:06.732443 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:06.737569 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:06.738226 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:06.771638 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.772160 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241202220606765727"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:06.772637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:06.787342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.794864 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.795339 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:06.795967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.796416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.796857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241202220606765727'
      
      
      order by ordinal_position

  
[0m22:06:06.817819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.824103 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.824599 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:06.827778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.835328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.835808 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:06.838629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.856474 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:06.857176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.857672 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241202220606765727"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241202220606765727"
    )
  
[0m22:06:06.894290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.896327 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:06.896794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.897232 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:06.907003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.907904 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:07.065390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '815c6c48-5101-44f9-8155-13c529362883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cfa5c0b0>]}
[0m22:06:07.066262 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:06:07.067042 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:07.068458 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.068943 [debug] [MainThread]: On master: BEGIN
[0m22:06:07.069384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:07.076063 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.076538 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.076971 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.077390 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.078060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.078515 [debug] [MainThread]: On master: Close
[0m22:06:07.079822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:07.080251 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:07.080654 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:07.081104 [info ] [MainThread]: 
[0m22:06:07.081670 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m22:06:07.082645 [debug] [MainThread]: Command end result
[0m22:06:07.110166 [info ] [MainThread]: 
[0m22:06:07.110773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:07.111265 [info ] [MainThread]: 
[0m22:06:07.111775 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:07.112741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.683501, "process_user_time": 5.566178, "process_kernel_time": 0.297828, "process_mem_max_rss": "293672", "process_in_blocks": "3880", "process_out_blocks": "114272"}
[0m22:06:07.113377 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:07.113268 after 11.68 seconds
[0m22:06:07.113906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031f2c9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f031f61d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03141f7a40>]}
[0m22:06:07.114398 [debug] [MainThread]: Flushing usage events
[0m22:06:08.765582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3db89f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ddb856d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3db818bf0>]}


============================== 22:06:08.768333 | f657de72-822f-4e76-a874-96ef5cef09d2 ==============================
[0m22:06:08.768333 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:08.768996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:08.911874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f657de72-822f-4e76-a874-96ef5cef09d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3db773590>]}
[0m22:06:08.928237 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21196587, "process_user_time": 1.391005, "process_kernel_time": 0.123911, "process_mem_max_rss": "92280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:08.928808 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:08.928707 after 0.21 seconds
[0m22:06:08.929239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3db7e9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3db657830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3db773590>]}
[0m22:06:08.929700 [debug] [MainThread]: Flushing usage events
[0m06:02:19.894246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a46bfe3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a46d12540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a46bfe3f0>]}


============================== 06:02:19.934103 | 227fda49-43e7-4ed8-9034-e7e6c081b1e3 ==============================
[0m06:02:19.934103 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.934806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.074392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '227fda49-43e7-4ed8-9034-e7e6c081b1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a46bfed80>]}
[0m06:02:20.087882 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lj5kxbsr'
[0m06:02:20.088335 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:20.244539 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:20.245201 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:20.276671 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:20.280564 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:20.663817 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:20.664374 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:20.664909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '227fda49-43e7-4ed8-9034-e7e6c081b1e3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a461db800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a461db530>]}
[0m06:02:20.665359 [info ] [MainThread]: 
[0m06:02:20.665886 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:20.667572 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8227539, "process_user_time": 1.58174, "process_kernel_time": 0.112693, "process_mem_max_rss": "93804", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m06:02:20.668163 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:20.668060 after 0.82 seconds
[0m06:02:20.668594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a4a167e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a462cf830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a464965a0>]}
[0m06:02:20.669014 [debug] [MainThread]: Flushing usage events
[0m06:02:22.471309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0eab74fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ea2c6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ea2728d0>]}


============================== 06:02:22.474074 | c0a7d4f8-2c20-466e-97c5-0ce132bf937f ==============================
[0m06:02:22.474074 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.474766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.707851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ea0184a0>]}
[0m06:02:22.767379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ea018920>]}
[0m06:02:22.769943 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:22.785945 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:22.786684 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:22.787224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e30639e0>]}
[0m06:02:24.021297 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:24.021938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0eb0f52b0>]}
[0m06:02:24.204653 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:24.209713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e291ce30>]}
[0m06:02:24.370902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e29827e0>]}
[0m06:02:24.371463 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:24.371946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e2af11f0>]}
[0m06:02:24.373678 [info ] [MainThread]: 
[0m06:02:24.374371 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:24.379192 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:24.416637 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:24.417117 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:24.417558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:25.160825 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:25.162393 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:25.164549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:25.165100 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:25.172176 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.172614 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:25.173010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:25.179231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.180659 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.181094 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:25.181696 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.182138 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.182530 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:25.183099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.184012 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:25.184418 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:25.184798 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:25.185431 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.185882 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:25.187726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:25.193278 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:25.193728 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:25.194107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:25.199957 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.200370 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:25.200774 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:25.224929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:25.226448 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:25.227659 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:25.228063 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:25.231381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e2a4e780>]}
[0m06:02:25.231918 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.232318 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.232694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:25.239102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.239528 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.239925 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.240307 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.240842 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.241248 [debug] [MainThread]: On master: Close
[0m06:02:25.242653 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:25.243143 [info ] [MainThread]: 
[0m06:02:25.252742 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:25.253345 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:25.254021 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:25.254475 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:25.280799 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:25.281586 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:25.317790 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:25.318555 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:34.948665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.949192 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:34.949879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.950344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.950788 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:34.951535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.954510 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.954979 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:34.955680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.976681 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.977183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.977649 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:34.979136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.984105 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:34.984584 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:34.986143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:34.988472 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:35.019257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a3a5c440>]}
[0m06:02:35.020001 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.76s]
[0m06:02:35.020800 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:35.021834 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:35.022400 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:35.022979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:35.023446 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:35.028631 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:35.029291 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:35.062991 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.063509 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241203060235057090"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:35.063994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:35.078549 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.086221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.086695 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:35.087301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.087754 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.088192 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241203060235057090'
      
      
      order by ordinal_position

  
[0m06:02:35.109372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.115895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.116392 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.119363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.127063 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.127548 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:35.130728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.148783 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:35.149497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.150035 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241203060235057090"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241203060235057090"
    )
  
[0m06:02:35.187502 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.189494 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.189987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:35.190416 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:35.198561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:35.199448 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:35.364099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0a7d4f8-2c20-466e-97c5-0ce132bf937f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a31e91f0>]}
[0m06:02:35.364915 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:35.365686 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:35.367246 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.367727 [debug] [MainThread]: On master: BEGIN
[0m06:02:35.368171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:35.374991 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.375473 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.375911 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:35.376337 [debug] [MainThread]: On master: COMMIT
[0m06:02:35.376918 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:35.377387 [debug] [MainThread]: On master: Close
[0m06:02:35.378881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:35.379317 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:35.379718 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:35.380169 [info ] [MainThread]: 
[0m06:02:35.380753 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.01 seconds (11.01s).
[0m06:02:35.381944 [debug] [MainThread]: Command end result
[0m06:02:35.409673 [info ] [MainThread]: 
[0m06:02:35.410352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:35.410945 [info ] [MainThread]: 
[0m06:02:35.411536 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:35.412618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.990984, "process_user_time": 5.787015, "process_kernel_time": 0.340177, "process_mem_max_rss": "295288", "process_in_blocks": "3880", "process_out_blocks": "114768"}
[0m06:02:35.413260 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:35.413150 after 12.99 seconds
[0m06:02:35.413805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ea613f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ed513680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0e2a04c80>]}
[0m06:02:35.414291 [debug] [MainThread]: Flushing usage events
[0m06:02:37.250974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e722b3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7136d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e712a7140>]}


============================== 06:02:37.253803 | 768b4f01-8738-4f80-81cd-d0bcee41198f ==============================
[0m06:02:37.253803 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:37.254498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:37.394233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '768b4f01-8738-4f80-81cd-d0bcee41198f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7154ae70>]}
[0m06:02:37.411010 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.209546, "process_user_time": 1.401047, "process_kernel_time": 0.10808, "process_mem_max_rss": "92368", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:37.411589 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:37.411485 after 0.21 seconds
[0m06:02:37.412020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e712d7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7108f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7273d7f0>]}
[0m06:02:37.412445 [debug] [MainThread]: Flushing usage events
[0m14:05:20.949797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f233b150e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23391b1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2339e9cd10>]}


============================== 14:05:20.957205 | b8734326-eaba-461a-a5eb-43ed48232c07 ==============================
[0m14:05:20.957205 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:20.957911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:21.106399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8734326-eaba-461a-a5eb-43ed48232c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f233a23d2e0>]}
[0m14:05:21.120417 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q1rx4og0'
[0m14:05:21.120913 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:21.178552 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:21.179299 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:21.193351 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:21.197412 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:21.245522 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:21.246134 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:21.246756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b8734326-eaba-461a-a5eb-43ed48232c07', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2339003260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2339000ce0>]}
[0m14:05:21.247229 [info ] [MainThread]: 
[0m14:05:21.247749 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:21.249720 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34939554, "process_user_time": 1.583093, "process_kernel_time": 0.136266, "process_mem_max_rss": "93952", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m14:05:21.250335 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:21.250227 after 0.35 seconds
[0m14:05:21.250785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2339e9d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2339187a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2338e94710>]}
[0m14:05:21.251221 [debug] [MainThread]: Flushing usage events
[0m14:05:22.891372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e68d2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e6ba6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e7725280>]}


============================== 14:05:22.894244 | 4920a971-0043-4054-8ec2-c879d0ad0b22 ==============================
[0m14:05:22.894244 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:22.894977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.133616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94df75c440>]}
[0m14:05:23.193502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e7d0df40>]}
[0m14:05:23.196176 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:23.213694 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:23.214472 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:23.215017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94df782210>]}
[0m14:05:24.455169 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:24.455871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94df07a210>]}
[0m14:05:24.641396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:24.646868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e78cc260>]}
[0m14:05:24.787455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94df1b6ff0>]}
[0m14:05:24.788034 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:24.788577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94def87380>]}
[0m14:05:24.790385 [info ] [MainThread]: 
[0m14:05:24.791140 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:24.795972 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:24.834192 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:24.834706 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:24.835105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:25.403215 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:25.404751 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:25.406847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:25.407412 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:25.414552 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.415001 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:25.415400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:25.421912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.423427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.423840 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:25.424443 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.424848 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.425266 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:25.425868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.426801 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:25.427209 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.427592 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:25.428142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.428562 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:25.430643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:25.436451 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:25.436878 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:25.437297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:25.443404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.443847 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:25.444269 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:25.466688 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.468383 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:25.469691 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:25.470113 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:25.474072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94def86480>]}
[0m14:05:25.474604 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:25.475016 [debug] [MainThread]: On master: BEGIN
[0m14:05:25.475399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:25.482092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:25.482528 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.482924 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:25.483308 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.483857 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:25.484265 [debug] [MainThread]: On master: Close
[0m14:05:25.485777 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:25.486294 [info ] [MainThread]: 
[0m14:05:25.496140 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:25.496748 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:25.497479 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:25.497930 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:25.523721 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:25.524527 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:25.560343 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:25.561213 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:32.606512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.607049 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:32.607785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.608249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.608690 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:32.609469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.612488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.612976 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:32.613670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.634524 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:32.635034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.635479 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:32.637615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.642687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:32.643183 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:32.644690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.647101 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:32.677632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e7d567e0>]}
[0m14:05:32.678467 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.18s]
[0m14:05:32.679271 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:32.680309 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:32.680903 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:32.681570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:32.682053 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:32.687438 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:32.688120 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:32.722129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.722695 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241203140532716138"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:32.723186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:32.737536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.745598 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.746096 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:32.746753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.747203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.747644 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241203140532716138'
      
      
      order by ordinal_position

  
[0m14:05:32.769007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.775844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.776347 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:32.779355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.787139 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.787627 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:32.791960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.810270 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:32.811020 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.811509 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241203140532716138"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241203140532716138"
    )
  
[0m14:05:32.848504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.850598 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:32.851067 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:32.851502 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:32.860419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:32.861389 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:33.034448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4920a971-0043-4054-8ec2-c879d0ad0b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f949b915040>]}
[0m14:05:33.035270 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m14:05:33.036043 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:33.037449 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:33.037935 [debug] [MainThread]: On master: BEGIN
[0m14:05:33.038373 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:33.045118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:33.045600 [debug] [MainThread]: On master: COMMIT
[0m14:05:33.046032 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:33.046454 [debug] [MainThread]: On master: COMMIT
[0m14:05:33.047032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:33.047485 [debug] [MainThread]: On master: Close
[0m14:05:33.048995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:33.049436 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:33.049842 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:33.050311 [info ] [MainThread]: 
[0m14:05:33.050834 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m14:05:33.051831 [debug] [MainThread]: Command end result
[0m14:05:33.080010 [info ] [MainThread]: 
[0m14:05:33.080697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:33.081232 [info ] [MainThread]: 
[0m14:05:33.081763 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:33.082779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.240703, "process_user_time": 5.06844, "process_kernel_time": 0.383126, "process_mem_max_rss": "282808", "process_in_blocks": "3880", "process_out_blocks": "114760"}
[0m14:05:33.083429 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:33.083317 after 10.24 seconds
[0m14:05:33.083928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e7725280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e79d7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f949b94f440>]}
[0m14:05:33.084420 [debug] [MainThread]: Flushing usage events
[0m14:05:34.796730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0ae5f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd08d75ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd08ca1490>]}


============================== 14:05:34.799591 | ea88eebb-ef55-4fe5-aedd-503eaff0c2a3 ==============================
[0m14:05:34.799591 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:34.800246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:34.946246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea88eebb-ef55-4fe5-aedd-503eaff0c2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0887b080>]}
[0m14:05:34.962908 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21673046, "process_user_time": 1.447161, "process_kernel_time": 0.107937, "process_mem_max_rss": "92508", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:34.963520 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:34.963410 after 0.22 seconds
[0m14:05:34.963959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd09729490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd0867f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd08c7cec0>]}
[0m14:05:34.964387 [debug] [MainThread]: Flushing usage events
[0m22:05:54.637858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0651af9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06522ff0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0651da3a40>]}


============================== 22:05:54.692562 | 2d39e422-a6fa-4fb2-ba76-00b641c03ca4 ==============================
[0m22:05:54.692562 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.693295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.832342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d39e422-a6fa-4fb2-ba76-00b641c03ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0651f56ea0>]}
[0m22:05:54.845800 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k17nvajh'
[0m22:05:54.846264 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:54.916407 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:54.917074 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:54.927304 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:54.931198 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:54.984047 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:54.984607 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:54.985132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2d39e422-a6fa-4fb2-ba76-00b641c03ca4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0651da3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0652a0a5d0>]}
[0m22:05:54.985584 [info ] [MainThread]: 
[0m22:05:54.986072 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:54.993020 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40410554, "process_user_time": 1.570854, "process_kernel_time": 0.140974, "process_mem_max_rss": "94080", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m22:05:54.993703 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:54.993600 after 0.40 seconds
[0m22:05:54.994141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0651afb9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0651919bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0652431bb0>]}
[0m22:05:54.994601 [debug] [MainThread]: Flushing usage events
[0m22:05:56.543636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c2512e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c2ba0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c3f397f0>]}


============================== 22:05:56.546465 | 05abdd44-ab2c-4438-a2ec-87de760213f7 ==============================
[0m22:05:56.546465 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:56.547262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:56.784721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bb54d850>]}
[0m22:05:56.845461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c2ac9e20>]}
[0m22:05:56.848127 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:56.885949 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:56.886751 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:56.887265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c24dc260>]}
[0m22:05:58.140104 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:58.140763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bb54c560>]}
[0m22:05:58.338015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:58.343460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bb36baa0>]}
[0m22:05:58.498827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c2ac9a90>]}
[0m22:05:58.499400 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:58.499935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82bad29370>]}
[0m22:05:58.501667 [info ] [MainThread]: 
[0m22:05:58.502406 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:58.507394 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:58.544800 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:58.545273 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:58.545678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:59.079061 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:59.080613 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:59.082667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:59.083234 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:59.090387 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.090867 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:59.091266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.097590 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.099135 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.099548 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:59.100170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.100572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.100952 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:59.101544 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.102476 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.102936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.103318 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.103862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.104270 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:59.106220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:59.111989 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.112406 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:59.112791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.118703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.119129 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.119530 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:59.144492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.145975 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:59.147255 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:59.147672 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:59.151115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c3bc9400>]}
[0m22:05:59.151669 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.152067 [debug] [MainThread]: On master: BEGIN
[0m22:05:59.152440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:59.158933 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.159369 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.159767 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.160148 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.160695 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.161104 [debug] [MainThread]: On master: Close
[0m22:05:59.162410 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:59.162948 [info ] [MainThread]: 
[0m22:05:59.203219 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:59.203917 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:59.204621 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:59.205088 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:59.231297 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:59.232063 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:59.267610 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:59.268361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:06.800768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.801313 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:06.801979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.802446 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.802923 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:06.803651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.806739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.807203 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:06.807903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.828770 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:06.829259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.829707 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:06.832197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.837271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:06.837744 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:06.839107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.842235 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:06.881612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c353dbb0>]}
[0m22:06:06.882661 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.68s]
[0m22:06:06.883644 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:06.884871 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:06.885650 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:06.886349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:06.886843 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:06.893601 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:06.894496 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:06.944097 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.944878 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241203220606935513"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:06.945559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:06.963391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.971593 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.972079 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:06.972789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:06.973247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:06.973688 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241203220606935513'
      
      
      order by ordinal_position

  
[0m22:06:07.001294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.007762 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.008258 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:07.011132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.018703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.019187 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:07.022213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.040205 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:07.040919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.041397 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241203220606935513"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241203220606935513"
    )
  
[0m22:06:07.077876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.080065 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:07.080593 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.081047 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:07.090164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.091186 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:07.267553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05abdd44-ab2c-4438-a2ec-87de760213f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827741e5a0>]}
[0m22:06:07.268392 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m22:06:07.269191 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:07.270725 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.271204 [debug] [MainThread]: On master: BEGIN
[0m22:06:07.271642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:07.278413 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.278943 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.279394 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.279829 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.280421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.280879 [debug] [MainThread]: On master: Close
[0m22:06:07.282656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:07.283102 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:07.283510 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:07.283981 [info ] [MainThread]: 
[0m22:06:07.284535 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m22:06:07.285572 [debug] [MainThread]: Command end result
[0m22:06:07.313382 [info ] [MainThread]: 
[0m22:06:07.314025 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:07.314612 [info ] [MainThread]: 
[0m22:06:07.315175 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:07.316203 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.822768, "process_user_time": 5.552512, "process_kernel_time": 0.325672, "process_mem_max_rss": "284008", "process_in_blocks": "3880", "process_out_blocks": "114792"}
[0m22:06:07.316853 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:07.316743 after 10.82 seconds
[0m22:06:07.317349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c276e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82774f1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a9f4fdd0>]}
[0m22:06:07.317844 [debug] [MainThread]: Flushing usage events
[0m22:06:08.975500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfa3122a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfa3127b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfa312120>]}


============================== 22:06:08.978309 | d9367b14-16ab-4147-96b3-c3b6c3751f2f ==============================
[0m22:06:08.978309 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:08.979044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:09.118098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9367b14-16ab-4147-96b3-c3b6c3751f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf9783ec0>]}
[0m22:06:09.134603 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2085646, "process_user_time": 1.408, "process_kernel_time": 0.132376, "process_mem_max_rss": "92360", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:09.135189 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:09.135085 after 0.21 seconds
[0m22:06:09.135627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfa312d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf97db770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadf9783ec0>]}
[0m22:06:09.136061 [debug] [MainThread]: Flushing usage events
[0m06:02:14.766950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58cb0c1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58caeae3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58cb0c0d40>]}


============================== 06:02:14.774604 | 2d4dfdfa-ec25-4396-b770-82fd2955bc17 ==============================
[0m06:02:14.774604 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.775324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.918718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d4dfdfa-ec25-4396-b770-82fd2955bc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58cb5bb440>]}
[0m06:02:14.932391 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kbfmlv85'
[0m06:02:14.932860 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.989600 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.990320 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:15.012030 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:15.015981 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:15.103817 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:15.104408 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:15.104912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2d4dfdfa-ec25-4396-b770-82fd2955bc17', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58cab1bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58cab19670>]}
[0m06:02:15.105368 [info ] [MainThread]: 
[0m06:02:15.105818 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:15.107465 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3899826, "process_user_time": 1.615163, "process_kernel_time": 0.131931, "process_mem_max_rss": "93620", "process_in_blocks": "5784", "process_out_blocks": "4000"}
[0m06:02:15.108110 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:15.108004 after 0.39 seconds
[0m06:02:15.108551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58cb11c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58cb12d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58cb53b380>]}
[0m06:02:15.108976 [debug] [MainThread]: Flushing usage events
[0m06:02:16.747983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37693c9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376714f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37677dab70>]}


============================== 06:02:16.750981 | 56883f13-5f23-420d-af18-d9ee64d184fc ==============================
[0m06:02:16.750981 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.751660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.001912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37677d9eb0>]}
[0m06:02:17.063345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3767998320>]}
[0m06:02:17.066155 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:17.083058 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:17.083913 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:17.084493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37670a1940>]}
[0m06:02:18.340065 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:18.340782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375ff97d40>]}
[0m06:02:18.526618 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:18.531972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375f85ef60>]}
[0m06:02:18.668207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375f9ca060>]}
[0m06:02:18.668786 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:18.669264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375f7a4b60>]}
[0m06:02:18.670978 [info ] [MainThread]: 
[0m06:02:18.671682 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.676601 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.714173 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.714696 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:18.715105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:19.281575 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:19.283540 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:19.285708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:19.286274 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:19.293568 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.294010 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:19.294402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.300766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.302258 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.302680 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:19.303286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.303688 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.304119 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:19.304709 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.305645 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.306047 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.306429 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.306972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.307382 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:19.309455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:19.315257 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.315674 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:19.316110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.321877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.322289 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.322687 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:19.345809 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.347355 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:19.348626 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:19.349044 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:19.352662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375f78a000>]}
[0m06:02:19.353214 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.353616 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.353991 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:19.360317 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.360757 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.361151 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.361533 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.362072 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.362477 [debug] [MainThread]: On master: Close
[0m06:02:19.363805 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:19.364314 [info ] [MainThread]: 
[0m06:02:19.374469 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:19.375078 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:19.375739 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:19.376230 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:19.402400 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:19.403162 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:19.439294 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:19.440125 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:26.452117 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.452670 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:26.453335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.453812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.454249 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:26.455057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.458079 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.458544 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:26.459317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.480479 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.480999 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.481445 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.482858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.487970 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.488434 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:26.490386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.492795 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:26.522385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37249959d0>]}
[0m06:02:26.523201 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.15s]
[0m06:02:26.524015 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:26.525048 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:26.525612 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:26.526222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:26.526678 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:26.532053 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:26.532716 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:26.566520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.567059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241204060226560563"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:26.567541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:26.583892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.591723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.592234 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:26.592865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.593330 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.593770 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241204060226560563'
      
      
      order by ordinal_position

  
[0m06:02:26.614511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.621095 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.621590 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.624578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.632324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.632806 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.635684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.653983 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:26.654735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.655213 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241204060226560563"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241204060226560563"
    )
  
[0m06:02:26.693073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.695139 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:26.695604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.696084 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:26.704828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.705749 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:26.893844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56883f13-5f23-420d-af18-d9ee64d184fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372415a900>]}
[0m06:02:26.894688 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:26.895532 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:26.897012 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.897528 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.897969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:26.905021 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.905510 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.905955 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.906384 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.907027 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.907489 [debug] [MainThread]: On master: Close
[0m06:02:26.909081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:26.909524 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:26.909928 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:26.910401 [info ] [MainThread]: 
[0m06:02:26.910923 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m06:02:26.912001 [debug] [MainThread]: Command end result
[0m06:02:26.939988 [info ] [MainThread]: 
[0m06:02:26.940662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:26.941175 [info ] [MainThread]: 
[0m06:02:26.941697 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:26.942741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.244656, "process_user_time": 5.746726, "process_kernel_time": 0.358672, "process_mem_max_rss": "299336", "process_in_blocks": "3880", "process_out_blocks": "115280"}
[0m06:02:26.943391 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:26.943281 after 10.25 seconds
[0m06:02:26.943921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37677da000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375f896870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37240f7b30>]}
[0m06:02:26.944418 [debug] [MainThread]: Flushing usage events
[0m06:02:28.658548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a54f20110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a52ec74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a52fb6a80>]}


============================== 06:02:28.661669 | 7f79c95a-dd09-4915-934b-9069c8add920 ==============================
[0m06:02:28.661669 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:28.662369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:28.818779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f79c95a-dd09-4915-934b-9069c8add920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a52f9fa40>]}
[0m06:02:28.836438 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22837386, "process_user_time": 1.447708, "process_kernel_time": 0.103692, "process_mem_max_rss": "92452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:28.837073 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:28.836964 after 0.23 seconds
[0m06:02:28.837533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a5452a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a54529be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a55361b50>]}
[0m06:02:28.837990 [debug] [MainThread]: Flushing usage events
[0m14:06:06.002604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59517cdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59517ce1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59517ce4b0>]}


============================== 14:06:06.042508 | 6b2846e1-0719-486f-a06f-874d30fc8273 ==============================
[0m14:06:06.042508 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:06.043208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:06.202260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b2846e1-0719-486f-a06f-874d30fc8273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59549bbe30>]}
[0m14:06:06.216849 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gkvyrpjf'
[0m14:06:06.217413 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:06.349946 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:06.350709 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:06.363191 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:06.367284 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:06.521457 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:06.522090 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:06:06.522648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b2846e1-0719-486f-a06f-874d30fc8273', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5951e02900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5951f31c10>]}
[0m14:06:06.523135 [info ] [MainThread]: 
[0m14:06:06.523621 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:06.536162 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6003063, "process_user_time": 1.654628, "process_kernel_time": 0.147166, "process_mem_max_rss": "93660", "process_in_blocks": "6032", "process_out_blocks": "3992"}
[0m14:06:06.536849 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:06.536741 after 0.60 seconds
[0m14:06:06.537358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595142a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5950e2d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5950d985f0>]}
[0m14:06:06.537814 [debug] [MainThread]: Flushing usage events
[0m14:06:08.177785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff797a09f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff797ab99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff797a0a7e0>]}


============================== 14:06:08.183300 | d78834fc-c6da-4540-892e-55536f9855cc ==============================
[0m14:06:08.183300 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:08.184219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:08.436328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7975d2cf0>]}
[0m14:06:08.496949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff797a08e30>]}
[0m14:06:08.499620 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:06:08.644936 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:08.645714 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:08.646327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78fe57680>]}
[0m14:06:09.891770 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:09.892425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78f952f90>]}
[0m14:06:10.078024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:10.083584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78f88ad80>]}
[0m14:06:10.224013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78f9e2ab0>]}
[0m14:06:10.224632 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:06:10.225239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78f714c20>]}
[0m14:06:10.227012 [info ] [MainThread]: 
[0m14:06:10.227772 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:10.232709 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:10.271106 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:10.271649 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:10.272068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:10.801266 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:06:10.802838 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:10.804973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:10.805542 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:10.812655 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:10.813132 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:10.813532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:10.819814 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:10.821342 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:10.821753 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:10.822378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:10.822801 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:10.823184 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:10.823789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:10.824722 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:10.825187 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:10.825574 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:10.826125 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:10.826541 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:10.828591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:10.834418 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:10.834839 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:10.835220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:10.841567 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:10.842019 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:10.842438 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:10.867090 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:10.868921 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:10.870241 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:10.870665 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:10.874708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7974ff260>]}
[0m14:06:10.875264 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:10.875665 [debug] [MainThread]: On master: BEGIN
[0m14:06:10.876041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:10.883060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:10.883523 [debug] [MainThread]: On master: COMMIT
[0m14:06:10.883924 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:10.884310 [debug] [MainThread]: On master: COMMIT
[0m14:06:10.884825 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:10.885273 [debug] [MainThread]: On master: Close
[0m14:06:10.886795 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:10.887333 [info ] [MainThread]: 
[0m14:06:10.929538 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:10.930342 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:10.931168 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:06:10.931648 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:10.958951 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:10.959927 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:10.998055 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:10.999005 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:20.029263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:20.029877 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:20.030710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.031200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:20.031657 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:20.032537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.035882 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:20.036358 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:20.037144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.058848 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:20.059489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:20.059991 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:20.062482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.068335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:20.068930 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:06:20.070653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.073382 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:20.104941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78fe88830>]}
[0m14:06:20.105874 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.17s]
[0m14:06:20.106742 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:20.107821 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:20.108436 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:20.109162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:20.109642 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:20.115255 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:20.115966 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:20.151846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:20.152483 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241204140620145289"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:20.153030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:20.168986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.177623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:20.178198 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:20.178979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.179470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:20.179930 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241204140620145289'
      
      
      order by ordinal_position

  
[0m14:06:20.201587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.208833 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:20.209406 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:20.212796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.221359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:20.221913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:20.225163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.243976 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:20.244835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:20.245421 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241204140620145289"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241204140620145289"
    )
  
[0m14:06:20.284390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.286620 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:20.287176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:20.287658 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:20.297917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:20.299072 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:20.488109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd78834fc-c6da-4540-892e-55536f9855cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff74c1c9d90>]}
[0m14:06:20.489007 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m14:06:20.489785 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:20.491131 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:20.491606 [debug] [MainThread]: On master: BEGIN
[0m14:06:20.492039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:20.498836 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:20.499359 [debug] [MainThread]: On master: COMMIT
[0m14:06:20.499801 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:20.500240 [debug] [MainThread]: On master: COMMIT
[0m14:06:20.500940 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:20.501408 [debug] [MainThread]: On master: Close
[0m14:06:20.503111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:20.503555 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:06:20.503966 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:20.504437 [info ] [MainThread]: 
[0m14:06:20.505047 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m14:06:20.506098 [debug] [MainThread]: Command end result
[0m14:06:20.534479 [info ] [MainThread]: 
[0m14:06:20.535205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:20.535776 [info ] [MainThread]: 
[0m14:06:20.536344 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:20.537437 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.41117, "process_user_time": 5.535878, "process_kernel_time": 0.383035, "process_mem_max_rss": "277204", "process_in_blocks": "3880", "process_out_blocks": "116800"}
[0m14:06:20.538110 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:20.537996 after 12.41 seconds
[0m14:06:20.538623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff797ab99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff79702b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff797bd1bb0>]}
[0m14:06:20.539124 [debug] [MainThread]: Flushing usage events
[0m14:06:22.359779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6174030770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6172cf2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61744298b0>]}


============================== 14:06:22.362716 | 7f9d6e6a-8644-4521-9bbd-000a5d63bcc7 ==============================
[0m14:06:22.362716 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:22.363359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:22.504214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f9d6e6a-8644-4521-9bbd-000a5d63bcc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6173a54080>]}
[0m14:06:22.521282 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21142031, "process_user_time": 1.418956, "process_kernel_time": 0.151461, "process_mem_max_rss": "92392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:22.521877 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:22.521774 after 0.21 seconds
[0m14:06:22.522327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6172bdeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6172ca64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6172fe0a70>]}
[0m14:06:22.522768 [debug] [MainThread]: Flushing usage events
[0m22:05:46.825781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8adcf9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8adcc8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8adcdfd0>]}


============================== 22:05:46.832672 | 2e3930df-c2dc-4642-b921-aee64afa26e1 ==============================
[0m22:05:46.832672 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:46.833332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:46.970178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e3930df-c2dc-4642-b921-aee64afa26e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8aa9d8e0>]}
[0m22:05:46.983623 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1v67e6e5'
[0m22:05:46.984071 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:47.056505 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:47.057094 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:47.080917 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:47.084670 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:47.240091 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:47.240637 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:47.241190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2e3930df-c2dc-4642-b921-aee64afa26e1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8bcdaf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8bcdb7d0>]}
[0m22:05:47.241623 [info ] [MainThread]: 
[0m22:05:47.242142 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:47.255993 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47898158, "process_user_time": 1.558187, "process_kernel_time": 0.112157, "process_mem_max_rss": "93768", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m22:05:47.256657 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:47.256552 after 0.48 seconds
[0m22:05:47.257088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8adcf9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8aa9e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8be8afc0>]}
[0m22:05:47.257504 [debug] [MainThread]: Flushing usage events
[0m22:05:48.816114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9abdf5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9aa51b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9aa51a0f0>]}


============================== 22:05:48.818774 | a5c00c9c-98d5-4c99-8345-916463779675 ==============================
[0m22:05:48.818774 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:48.819508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:49.051610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9aa26d250>]}
[0m22:05:49.110075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9aba81220>]}
[0m22:05:49.112464 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:05:49.142239 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:49.142944 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:49.143526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9aa3695b0>]}
[0m22:05:50.377354 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:50.377982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a32006b0>]}
[0m22:05:50.559015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:50.564002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a2d0bfb0>]}
[0m22:05:50.709164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a2ced610>]}
[0m22:05:50.709712 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:50.710234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a2c55190>]}
[0m22:05:50.711933 [info ] [MainThread]: 
[0m22:05:50.712644 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:50.717315 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:50.753279 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:50.753725 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:50.754121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:51.295073 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:51.296635 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:51.298656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:51.299250 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:51.306342 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.306776 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:51.307233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:51.313391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.314790 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.315233 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:51.315783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.316178 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.316556 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:51.317124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.318034 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:51.318445 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.318827 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:51.319435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.319846 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:51.321666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:51.327151 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:51.327566 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:51.327941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:51.333697 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.334110 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:51.334505 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:51.357961 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.359400 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:51.360614 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:51.361014 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:51.364326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a31de180>]}
[0m22:05:51.364849 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.365245 [debug] [MainThread]: On master: BEGIN
[0m22:05:51.365615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:51.371750 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.372176 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.372568 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.372945 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.373489 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.373892 [debug] [MainThread]: On master: Close
[0m22:05:51.375292 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:51.375795 [info ] [MainThread]: 
[0m22:05:51.391877 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:51.392477 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:51.393141 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:51.393592 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:51.420429 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:51.421183 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:51.455500 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:51.456232 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:58.954190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.954689 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:58.955355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.955818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.956264 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:58.956965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.959826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.960321 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:58.961015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.977285 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:58.977769 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.978213 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:58.979844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.984763 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:58.985239 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:58.986342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:58.988665 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:59.017788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9605db440>]}
[0m22:05:59.018491 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.62s]
[0m22:05:59.019266 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:59.020242 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:59.020808 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:59.021478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:59.021931 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:59.026795 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:59.027472 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:59.060573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.061085 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241204220559054745"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:59.061574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:59.076079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.084600 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.085080 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:59.085677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.086127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.086569 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241204220559054745'
      
      
      order by ordinal_position

  
[0m22:05:59.107258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.112280 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.112771 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:59.115586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.123120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.123598 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:59.126491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.144051 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:59.144713 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.145185 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241204220559054745"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241204220559054745"
    )
  
[0m22:05:59.176852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.178776 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:59.179310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:59.179744 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:59.188148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:59.189034 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:59.391715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5c00c9c-98d5-4c99-8345-916463779675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a1768e90>]}
[0m22:05:59.392529 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:05:59.393276 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:59.394762 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.395283 [debug] [MainThread]: On master: BEGIN
[0m22:05:59.395723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:59.402290 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.402766 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.403254 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.403682 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.404264 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.404718 [debug] [MainThread]: On master: Close
[0m22:05:59.406028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:59.406473 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:59.406883 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:59.407429 [info ] [MainThread]: 
[0m22:05:59.407979 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m22:05:59.409016 [debug] [MainThread]: Command end result
[0m22:05:59.437723 [info ] [MainThread]: 
[0m22:05:59.438398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:59.438980 [info ] [MainThread]: 
[0m22:05:59.439603 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:59.440670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.673612, "process_user_time": 5.511367, "process_kernel_time": 0.39538, "process_mem_max_rss": "288304", "process_in_blocks": "3880", "process_out_blocks": "116848"}
[0m22:05:59.441309 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:59.441200 after 10.67 seconds
[0m22:05:59.441796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ae1bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9aa577aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a1779820>]}
[0m22:05:59.442276 [debug] [MainThread]: Flushing usage events
[0m22:06:01.086413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60d81a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60d38fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60d818dd0>]}


============================== 22:06:01.089082 | b7a4d500-6eb8-4431-bfeb-22066cdfeb58 ==============================
[0m22:06:01.089082 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:01.089738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:01.225427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7a4d500-6eb8-4431-bfeb-22066cdfeb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60ceddd30>]}
[0m22:06:01.241646 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20428512, "process_user_time": 1.414535, "process_kernel_time": 0.0959, "process_mem_max_rss": "92248", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:01.242205 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:01.242103 after 0.20 seconds
[0m22:06:01.242632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60e5c3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60cf1f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe610d67e00>]}
[0m22:06:01.243089 [debug] [MainThread]: Flushing usage events
[0m06:02:13.942481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc500937110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ffb9cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ff5eaf60>]}


============================== 06:02:13.949514 | 8f0be9e3-2e0c-4b35-95fd-e97291cc8192 ==============================
[0m06:02:13.949514 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.950176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.087387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f0be9e3-2e0c-4b35-95fd-e97291cc8192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ff2aae70>]}
[0m06:02:14.100636 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-evu2okzr'
[0m06:02:14.101094 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.220518 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.221168 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.232902 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.236803 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:14.439660 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:14.440251 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:14.440819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8f0be9e3-2e0c-4b35-95fd-e97291cc8192', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4feb81760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4feb82750>]}
[0m06:02:14.441287 [info ] [MainThread]: 
[0m06:02:14.441759 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:14.443291 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5493165, "process_user_time": 1.552582, "process_kernel_time": 0.146919, "process_mem_max_rss": "93764", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m06:02:14.443884 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:14.443782 after 0.55 seconds
[0m06:02:14.444319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4fee42000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ffb1eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4fecbc9e0>]}
[0m06:02:14.444801 [debug] [MainThread]: Flushing usage events
[0m06:02:16.196092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431d577aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431dc555b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431de36870>]}


============================== 06:02:16.198990 | f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c ==============================
[0m06:02:16.198990 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.199692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.436007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431d044890>]}
[0m06:02:16.494719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431d054b90>]}
[0m06:02:16.497351 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:16.513564 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:16.514303 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:16.514845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4316040260>]}
[0m06:02:17.755938 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:17.756604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4315bcdeb0>]}
[0m06:02:17.939162 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:17.944511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431591f080>]}
[0m06:02:18.096937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43159f6ed0>]}
[0m06:02:18.097524 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:18.098022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431580a0c0>]}
[0m06:02:18.099755 [info ] [MainThread]: 
[0m06:02:18.100465 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.105627 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.142875 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.143377 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:18.143787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:18.608206 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.609822 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:18.612082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:18.612674 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:18.619794 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.620231 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:18.620662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.627068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.628533 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.628986 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:18.629585 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.629982 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.630359 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:18.630977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.631898 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.632317 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.632752 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.633309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.633724 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:18.635729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:18.641379 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.641812 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:18.642191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.647977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.648393 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.648834 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:18.672384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.673915 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:18.675126 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:18.675543 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:18.678891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43145e2630>]}
[0m06:02:18.679423 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.679814 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.680176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:18.686699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.687131 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.687519 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.687893 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.688421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.688876 [debug] [MainThread]: On master: Close
[0m06:02:18.690586 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:18.691113 [info ] [MainThread]: 
[0m06:02:18.700723 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:18.701349 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:18.702073 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:18.702521 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:18.729866 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:18.730644 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:18.765444 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:18.766218 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:27.064725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.065256 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:27.065961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.066418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.066860 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:27.067612 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.070623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.071088 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:27.071802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.088163 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.088672 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.089124 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.090309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.095340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.095820 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:27.097023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.099371 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:27.129367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42ebf29970>]}
[0m06:02:27.130137 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.43s]
[0m06:02:27.130924 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:27.131936 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:27.132492 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:27.133130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:27.133593 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:27.138797 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:27.139473 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:27.173082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.173640 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241205060227167128"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:27.174176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:27.189931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.199224 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.199706 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:27.200332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.200810 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.201259 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241205060227167128'
      
      
      order by ordinal_position

  
[0m06:02:27.222254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.227717 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.228213 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.231111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.238826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.239304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.242225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.260235 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:27.261009 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.261491 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241205060227167128"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241205060227167128"
    )
  
[0m06:02:27.300253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.302283 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.302742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.303172 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.312385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.313351 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:27.523069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1801582-daa6-4e9b-9dd5-5e3b9ed48f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4315be9cd0>]}
[0m06:02:27.523895 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.39s]
[0m06:02:27.524768 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:27.526252 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.526728 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.527164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:27.534072 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.534549 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.534983 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.535413 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.536010 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.536473 [debug] [MainThread]: On master: Close
[0m06:02:27.538052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:27.538497 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:27.538904 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:27.539371 [info ] [MainThread]: 
[0m06:02:27.539967 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m06:02:27.541104 [debug] [MainThread]: Command end result
[0m06:02:27.569939 [info ] [MainThread]: 
[0m06:02:27.570666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:27.571258 [info ] [MainThread]: 
[0m06:02:27.571849 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:27.572948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.425849, "process_user_time": 5.581268, "process_kernel_time": 0.343339, "process_mem_max_rss": "300404", "process_in_blocks": "3880", "process_out_blocks": "116816"}
[0m06:02:27.573601 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:27.573488 after 11.43 seconds
[0m06:02:27.574109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431d21f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431d054a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f431448ba40>]}
[0m06:02:27.574600 [debug] [MainThread]: Flushing usage events
[0m06:02:29.510011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccb519490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd381cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccb09b560>]}


============================== 06:02:29.512809 | 74f95a54-938e-492b-b3d9-2199a617ba2c ==============================
[0m06:02:29.512809 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.513449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.659776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74f95a54-938e-492b-b3d9-2199a617ba2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccb046180>]}
[0m06:02:29.676413 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21538189, "process_user_time": 1.447324, "process_kernel_time": 0.096221, "process_mem_max_rss": "92264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:29.677023 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:29.676918 after 0.22 seconds
[0m06:02:29.677559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccb016f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccadef830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccacd3f50>]}
[0m06:02:29.678199 [debug] [MainThread]: Flushing usage events
[0m14:05:21.341556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33ba0aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc339d92750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33bc81730>]}


============================== 14:05:21.356946 | f2e17581-297f-4817-a336-aa8dd59a36f4 ==============================
[0m14:05:21.356946 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.357610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:21.498792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2e17581-297f-4817-a336-aa8dd59a36f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3397841a0>]}
[0m14:05:21.512254 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j7yevfa1'
[0m14:05:21.512708 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:21.557185 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:21.557787 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:21.572928 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:21.576717 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:21.625023 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:21.625533 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:21.626072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f2e17581-297f-4817-a336-aa8dd59a36f4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33969f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc339784260>]}
[0m14:05:21.626536 [info ] [MainThread]: 
[0m14:05:21.626991 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:21.637325 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34487593, "process_user_time": 1.53668, "process_kernel_time": 0.15883, "process_mem_max_rss": "93888", "process_in_blocks": "6032", "process_out_blocks": "3992"}
[0m14:05:21.638087 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:21.637932 after 0.35 seconds
[0m14:05:21.638567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3397944a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc339796660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33a0caab0>]}
[0m14:05:21.638999 [debug] [MainThread]: Flushing usage events
[0m14:05:23.229239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00800f1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007f342ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00804219a0>]}


============================== 14:05:23.232048 | 79f5f390-03ad-4446-a5d3-91b8301bf947 ==============================
[0m14:05:23.232048 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.232708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.471409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007e9ac3b0>]}
[0m14:05:23.531000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007e9acbf0>]}
[0m14:05:23.533678 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:23.557926 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:23.558746 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:23.559308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007e8cca70>]}
[0m14:05:24.823118 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:24.823848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007779c2c0>]}
[0m14:05:25.009586 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:25.015004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007722bdd0>]}
[0m14:05:25.166115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00772f53a0>]}
[0m14:05:25.166740 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:25.167283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0077116f00>]}
[0m14:05:25.169195 [info ] [MainThread]: 
[0m14:05:25.169978 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:25.175131 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:25.212852 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:25.213384 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:25.213806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:25.910852 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:25.912400 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:25.914556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:25.915126 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:25.922209 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.922640 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:25.923035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:25.929372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.930899 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.931312 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:25.931850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.932249 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.932628 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:25.933192 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.934133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:25.934533 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.934914 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:25.935456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.935876 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:25.937820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:25.943533 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:25.943948 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:25.944322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:25.950340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.950758 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:25.951153 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:25.975124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.976768 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:25.978036 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:25.978514 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:25.982095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0077344680>]}
[0m14:05:25.982625 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:25.983018 [debug] [MainThread]: On master: BEGIN
[0m14:05:25.983402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:25.989904 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:25.990383 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.990781 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:25.991159 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.991710 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:25.992121 [debug] [MainThread]: On master: Close
[0m14:05:25.993525 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:25.994025 [info ] [MainThread]: 
[0m14:05:26.008080 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:26.008744 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:26.009463 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:26.009914 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:26.037346 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:26.038144 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:26.073348 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:26.074288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:33.546948 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.547486 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:33.548149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.548612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.549052 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:33.549781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.552746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.553206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:33.553895 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.570344 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:33.570833 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.571404 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:33.573452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.578522 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:33.578997 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:33.580239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.582615 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:33.612219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0065f7a330>]}
[0m14:05:33.613005 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.60s]
[0m14:05:33.613796 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:33.614838 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:33.615409 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:33.615984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:33.616456 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:33.621785 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:33.622508 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:33.656623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.657168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241205140533650674"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:33.657656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:33.672211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.681742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.682268 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:33.682948 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.683413 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.683857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241205140533650674'
      
      
      order by ordinal_position

  
[0m14:05:33.705290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.711140 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.711645 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:33.714616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.722508 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.722992 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:33.725942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.746091 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:33.746854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.747346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241205140533650674"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241205140533650674"
    )
  
[0m14:05:33.780315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.782394 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:33.782870 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:33.783299 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:33.793474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:33.794483 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:34.470761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79f5f390-03ad-4446-a5d3-91b8301bf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007779eba0>]}
[0m14:05:34.471575 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.85s]
[0m14:05:34.472418 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:34.473812 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.474324 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.474762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:34.481489 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.481994 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.482477 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:34.482909 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.483495 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:34.483946 [debug] [MainThread]: On master: Close
[0m14:05:34.485463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:34.485897 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:34.486377 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:34.486846 [info ] [MainThread]: 
[0m14:05:34.487428 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.32 seconds (9.32s).
[0m14:05:34.488528 [debug] [MainThread]: Command end result
[0m14:05:34.517225 [info ] [MainThread]: 
[0m14:05:34.517958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.518576 [info ] [MainThread]: 
[0m14:05:34.519172 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:34.520261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.339923, "process_user_time": 6.760096, "process_kernel_time": 0.360005, "process_mem_max_rss": "369712", "process_in_blocks": "3880", "process_out_blocks": "133200"}
[0m14:05:34.520908 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:34.520796 after 11.34 seconds
[0m14:05:34.521412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007f9cd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007ebd71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002faa78c0>]}
[0m14:05:34.521909 [debug] [MainThread]: Flushing usage events
[0m14:05:36.205882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd919771ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd916eb2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91920d490>]}


============================== 14:05:36.208844 | 485e8c93-cd7a-47b0-b209-a7fef10e808b ==============================
[0m14:05:36.208844 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.209499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.358105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '485e8c93-cd7a-47b0-b209-a7fef10e808b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd916ee2f00>]}
[0m14:05:36.374889 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21912973, "process_user_time": 1.439813, "process_kernel_time": 0.111675, "process_mem_max_rss": "92280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:36.375484 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:36.375378 after 0.22 seconds
[0m14:05:36.375931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91730ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd916cbb0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91806a930>]}
[0m14:05:36.376374 [debug] [MainThread]: Flushing usage events
[0m22:05:52.282316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d0076030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d0076090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d0bb4680>]}


============================== 22:05:52.299092 | 7476c9dc-39ee-4976-a35a-a9ca941136e1 ==============================
[0m22:05:52.299092 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.299758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.450585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7476c9dc-39ee-4976-a35a-a9ca941136e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d0227a40>]}
[0m22:05:52.464659 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8wjf3v83'
[0m22:05:52.465160 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:52.491519 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:52.492259 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:52.503846 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:52.507975 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:52.716337 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:52.716986 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:52.717558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7476c9dc-39ee-4976-a35a-a9ca941136e1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cfdf0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cfedd2b0>]}
[0m22:05:52.718036 [info ] [MainThread]: 
[0m22:05:52.718531 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:52.727766 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49559253, "process_user_time": 1.550226, "process_kernel_time": 0.178872, "process_mem_max_rss": "93936", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m22:05:52.728381 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:52.728274 after 0.50 seconds
[0m22:05:52.728829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d031bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d241aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d0227a40>]}
[0m22:05:52.729277 [debug] [MainThread]: Flushing usage events
[0m22:05:54.577818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414c8304d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414ab7fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414af9f560>]}


============================== 22:05:54.580630 | 8a643f30-3e6f-4195-9db8-214f4c3c126a ==============================
[0m22:05:54.580630 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.581315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.818629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4143538ec0>]}
[0m22:05:54.878891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414a5ca000>]}
[0m22:05:54.881538 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:05:54.926126 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:54.926890 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:54.927454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41435f01a0>]}
[0m22:05:56.178440 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:56.179141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41435150d0>]}
[0m22:05:56.364962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:56.370305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414340dca0>]}
[0m22:05:56.522316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4142daea50>]}
[0m22:05:56.522927 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:56.523452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4142eda960>]}
[0m22:05:56.525187 [info ] [MainThread]: 
[0m22:05:56.525907 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:56.530719 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:56.568259 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:56.568751 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:56.569151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:56.904649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.906240 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:56.908582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:56.909152 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:56.916278 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:56.916719 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:56.917117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:56.923393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.924873 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:56.925287 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:56.925902 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.926309 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:56.926702 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:56.927338 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.928268 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:56.928672 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:56.929050 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:56.929595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.930005 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:56.931974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:56.937621 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:56.938044 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:56.938427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:56.944418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.944850 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:56.945250 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:56.968995 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.970597 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:56.971905 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:56.972322 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:56.975964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414bba13a0>]}
[0m22:05:56.976535 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:56.976946 [debug] [MainThread]: On master: BEGIN
[0m22:05:56.977330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:56.984042 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:56.984501 [debug] [MainThread]: On master: COMMIT
[0m22:05:56.984896 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:56.985277 [debug] [MainThread]: On master: COMMIT
[0m22:05:56.985825 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:56.986236 [debug] [MainThread]: On master: Close
[0m22:05:56.987694 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:56.988191 [info ] [MainThread]: 
[0m22:05:56.997989 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:56.998611 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:56.999302 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:56.999753 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:57.027654 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:57.028500 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:57.064785 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:57.065677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:07.366391 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:07.366948 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:07.367636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.368109 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:07.368555 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:07.369285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.372236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:07.372719 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:07.373482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.390032 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:07.390533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:07.391017 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:07.392475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.397527 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:07.398003 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:07.399250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.401601 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:07.431545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414af6a900>]}
[0m22:06:07.432283 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.43s]
[0m22:06:07.433053 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:07.434070 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:07.434649 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:07.435280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:07.435761 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:07.440984 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:07.441655 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:07.475605 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.476161 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241205220607469589"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:07.476651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:07.492346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.501555 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.502045 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:07.502672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.503154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.503614 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241205220607469589'
      
      
      order by ordinal_position

  
[0m22:06:07.524821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.530295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.530883 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:07.535671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.545687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.546186 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:07.551238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.569962 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:07.570681 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.571213 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241205220607469589"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241205220607469589"
    )
  
[0m22:06:07.609917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.612335 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:07.612982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:07.613528 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:07.642448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:07.643901 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:07.837653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a643f30-3e6f-4195-9db8-214f4c3c126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4107cef800>]}
[0m22:06:07.838482 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.40s]
[0m22:06:07.839291 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:07.840693 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.841168 [debug] [MainThread]: On master: BEGIN
[0m22:06:07.841605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:07.848298 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.848783 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.849229 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.849660 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.850259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.850718 [debug] [MainThread]: On master: Close
[0m22:06:07.852246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:07.852687 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:07.853098 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:07.853572 [info ] [MainThread]: 
[0m22:06:07.854099 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.33 seconds (11.33s).
[0m22:06:07.855212 [debug] [MainThread]: Command end result
[0m22:06:07.884325 [info ] [MainThread]: 
[0m22:06:07.884974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:07.885492 [info ] [MainThread]: 
[0m22:06:07.886025 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:07.887064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.359094, "process_user_time": 5.504996, "process_kernel_time": 0.347557, "process_mem_max_rss": "296060", "process_in_blocks": "3880", "process_out_blocks": "115312"}
[0m22:06:07.887719 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:07.887606 after 13.36 seconds
[0m22:06:07.888223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414dfbbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414bd12090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41076fedb0>]}
[0m22:06:07.888724 [debug] [MainThread]: Flushing usage events
[0m22:06:09.799444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb11dd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4caf8cc380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4caefd46e0>]}


============================== 22:06:09.802216 | b12c1bbe-3453-43b1-bef8-7a68abc746a2 ==============================
[0m22:06:09.802216 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:09.802874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:09.943078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b12c1bbe-3453-43b1-bef8-7a68abc746a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4caf7de3c0>]}
[0m22:06:09.959434 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20956355, "process_user_time": 1.415572, "process_kernel_time": 0.099969, "process_mem_max_rss": "92272", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:09.960018 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:09.959917 after 0.21 seconds
[0m22:06:09.960459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4caf2f27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4caeddab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4caec92ae0>]}
[0m22:06:09.960883 [debug] [MainThread]: Flushing usage events
[0m06:02:14.628343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc880920740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87fd6cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87f91e9c0>]}


============================== 06:02:14.635748 | 7445d862-2430-49f6-a873-0578be212f0c ==============================
[0m06:02:14.635748 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.636382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.780211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7445d862-2430-49f6-a873-0578be212f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87ee4cb00>]}
[0m06:02:14.794079 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3ika947t'
[0m06:02:14.794589 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.884153 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.884883 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.896833 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.900757 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:15.078678 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:15.079284 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:15.079822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7445d862-2430-49f6-a873-0578be212f0c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87eced790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87ed57290>]}
[0m06:02:15.080308 [info ] [MainThread]: 
[0m06:02:15.080844 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:15.087168 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.508569, "process_user_time": 1.587913, "process_kernel_time": 0.120296, "process_mem_max_rss": "93856", "process_in_blocks": "6032", "process_out_blocks": "3992"}
[0m06:02:15.087780 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:15.087676 after 0.51 seconds
[0m06:02:15.088214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87f1838f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87fd6cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87ee4cb00>]}
[0m06:02:15.088641 [debug] [MainThread]: Flushing usage events
[0m06:02:16.755269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a400ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a400de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a400cc80>]}


============================== 06:02:16.758127 | 0d512752-c3c8-461a-aa24-f61e4e433a97 ==============================
[0m06:02:16.758127 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.758796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.001534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a400e750>]}
[0m06:02:17.061321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a4919e20>]}
[0m06:02:17.064203 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:17.080677 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:17.081450 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:17.081987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a3525d00>]}
[0m06:02:18.333616 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:18.334300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589c3688c0>]}
[0m06:02:18.520077 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:18.525544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589c3688c0>]}
[0m06:02:18.670644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5897dda7e0>]}
[0m06:02:18.671244 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:18.671730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5897c00140>]}
[0m06:02:18.673432 [info ] [MainThread]: 
[0m06:02:18.674143 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.679068 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.716567 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.717088 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:18.717502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:19.158919 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.160495 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:19.162784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:19.163354 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:19.170617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.171065 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:19.171464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.177781 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.179349 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.179765 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:19.180362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.180769 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.181154 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:19.181782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.182760 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.183173 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.183562 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.184107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.184528 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:19.186606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:19.192367 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.192790 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:19.193168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.199233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.199657 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.200062 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:19.224361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.226035 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:19.227328 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:19.227751 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:19.231547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589c2edd90>]}
[0m06:02:19.232087 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.232488 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.232865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:19.239501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.239941 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.240334 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.240717 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.241254 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.241665 [debug] [MainThread]: On master: Close
[0m06:02:19.243140 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:19.243644 [info ] [MainThread]: 
[0m06:02:19.253410 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:19.254057 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:19.254821 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:19.255267 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:19.283794 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:19.284657 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:19.321335 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:19.322228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:26.795031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.795570 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:26.796259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.796727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.797172 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:26.797914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.800947 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.801426 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:26.802148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.818754 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.819271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.819711 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.821080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.826273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.826777 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:26.828256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.830674 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:26.861009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58a4b62420>]}
[0m06:02:26.861811 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.61s]
[0m06:02:26.862718 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:26.863751 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:26.864352 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:26.865028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:26.865499 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:26.870889 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:26.871568 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:26.905316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.905873 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241206060226899317"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:26.906389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:26.921677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.931288 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.931804 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:26.932475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.932931 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.933374 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241206060226899317'
      
      
      order by ordinal_position

  
[0m06:02:26.955707 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.961504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.962007 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.964904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.972773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.973272 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.976190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.994515 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:26.995278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.995764 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241206060226899317"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241206060226899317"
    )
  
[0m06:02:27.028266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.030290 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.030808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.031252 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.040009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.040934 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:27.223273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d512752-c3c8-461a-aa24-f61e4e433a97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586078f4a0>]}
[0m06:02:27.224120 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:27.224968 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:27.226437 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.226950 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.227386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:27.234310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.234850 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.235297 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.235728 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.236392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.236860 [debug] [MainThread]: On master: Close
[0m06:02:27.238784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:27.239239 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:27.239651 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:27.240125 [info ] [MainThread]: 
[0m06:02:27.240683 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m06:02:27.241759 [debug] [MainThread]: Command end result
[0m06:02:27.271444 [info ] [MainThread]: 
[0m06:02:27.272153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:27.272692 [info ] [MainThread]: 
[0m06:02:27.273244 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:27.274283 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.568886, "process_user_time": 5.560365, "process_kernel_time": 0.374945, "process_mem_max_rss": "293128", "process_in_blocks": "3880", "process_out_blocks": "115288"}
[0m06:02:27.274988 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:27.274868 after 10.57 seconds
[0m06:02:27.275491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5897c1dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589c2d46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f586060f2c0>]}
[0m06:02:27.275985 [debug] [MainThread]: Flushing usage events
[0m06:02:29.042968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2be25790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2b5fd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2b5fcd70>]}


============================== 06:02:29.045826 | 060bf37a-582e-4b9c-9caf-a7414c76d9e4 ==============================
[0m06:02:29.045826 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.046553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.189593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '060bf37a-582e-4b9c-9caf-a7414c76d9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2a4f7860>]}
[0m06:02:29.206478 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21420588, "process_user_time": 1.428147, "process_kernel_time": 0.104302, "process_mem_max_rss": "92444", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:29.207085 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:29.206982 after 0.21 seconds
[0m06:02:29.207529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2a8900b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2b5fd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2aeca0c0>]}
[0m06:02:29.207979 [debug] [MainThread]: Flushing usage events
[0m14:05:31.811309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16d7fc9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16c6a1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16c6a2270>]}


============================== 14:05:31.828557 | 88800644-6bf0-4d0a-9f51-46f20bd3b5df ==============================
[0m14:05:31.828557 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.829278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.970820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88800644-6bf0-4d0a-9f51-46f20bd3b5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16bd5f890>]}
[0m14:05:31.984607 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ex_g1xlz'
[0m14:05:31.985075 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:32.061396 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:32.062183 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:32.085063 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:32.089117 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:32.162325 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:32.162989 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:32.163556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '88800644-6bf0-4d0a-9f51-46f20bd3b5df', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16bc73860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16bc73f80>]}
[0m14:05:32.164036 [info ] [MainThread]: 
[0m14:05:32.164563 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:32.174876 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41299316, "process_user_time": 1.630314, "process_kernel_time": 0.0959, "process_mem_max_rss": "93960", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m14:05:32.175716 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:32.175586 after 0.41 seconds
[0m14:05:32.176199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16bcdbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16bc2c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16bd6f4a0>]}
[0m14:05:32.176711 [debug] [MainThread]: Flushing usage events
[0m14:05:33.804180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11598e66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1159f8cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1159a95130>]}


============================== 14:05:33.807085 | 642d2a8e-5bc1-4080-953a-0f47265e26ac ==============================
[0m14:05:33.807085 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.807840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:34.059824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1159647f50>]}
[0m14:05:34.119389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11598e66f0>]}
[0m14:05:34.121944 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:34.151282 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:34.152008 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:34.152574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1159607e60>]}
[0m14:05:35.402593 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:35.403230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115213ebd0>]}
[0m14:05:35.588473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:35.593887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11521641a0>]}
[0m14:05:35.739104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1151ff26c0>]}
[0m14:05:35.739668 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:35.740187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11520bb3e0>]}
[0m14:05:35.741923 [info ] [MainThread]: 
[0m14:05:35.742610 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:35.747479 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:35.783839 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:35.784302 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:35.784740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:36.334238 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:36.335796 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:36.337828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:36.338392 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:36.345450 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:36.345878 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:36.346265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:36.352654 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.354110 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:36.354518 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:36.355112 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.355507 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:36.355881 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:36.356460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.357360 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:36.357753 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:36.358132 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:36.358735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.359146 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:36.361135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:36.366698 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:36.367108 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:36.367476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:36.373161 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.373569 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:36.373963 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:36.397883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.399307 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:36.400553 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:36.400965 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:36.404269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115ad590d0>]}
[0m14:05:36.404826 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:36.405238 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.405616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:36.412395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:36.412930 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.413344 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:36.413734 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.414277 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:36.414690 [debug] [MainThread]: On master: Close
[0m14:05:36.416628 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:36.417156 [info ] [MainThread]: 
[0m14:05:36.432692 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:36.433317 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:36.434003 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:36.434451 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:36.462550 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:36.463416 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:36.498485 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:36.499270 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:44.069861 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:44.070404 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:44.071053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.071507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:44.071949 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:44.072706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.075591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:44.076052 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:44.076783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.093242 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:44.093721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:44.094163 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:44.096133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.101140 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:44.101605 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:44.102739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.105072 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:44.134718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115ad02600>]}
[0m14:05:44.135480 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.70s]
[0m14:05:44.136351 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:44.137378 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:44.137936 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:44.138582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:44.139034 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:44.144207 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:44.144910 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:44.178563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:44.179066 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241206140544172648"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:44.179549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:44.194631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.203418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:44.203909 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:44.204585 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.205046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:44.205485 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241206140544172648'
      
      
      order by ordinal_position

  
[0m14:05:44.226438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.231729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:44.232222 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:44.236577 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.244331 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:44.244837 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:44.247673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.265725 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:44.266435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:44.266932 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241206140544172648"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241206140544172648"
    )
  
[0m14:05:44.303705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.306446 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:44.307209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:44.307923 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:44.340950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:44.341934 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:44.625020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642d2a8e-5bc1-4080-953a-0f47265e26ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1152012060>]}
[0m14:05:44.625841 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.49s]
[0m14:05:44.626578 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:44.627982 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:44.628486 [debug] [MainThread]: On master: BEGIN
[0m14:05:44.628929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:44.635746 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:44.636233 [debug] [MainThread]: On master: COMMIT
[0m14:05:44.636720 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:44.637154 [debug] [MainThread]: On master: COMMIT
[0m14:05:44.637747 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:44.638203 [debug] [MainThread]: On master: Close
[0m14:05:44.639612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:44.640049 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:44.640503 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:44.640976 [info ] [MainThread]: 
[0m14:05:44.641493 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.90 seconds (8.90s).
[0m14:05:44.642513 [debug] [MainThread]: Command end result
[0m14:05:44.671127 [info ] [MainThread]: 
[0m14:05:44.671761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:44.672261 [info ] [MainThread]: 
[0m14:05:44.672815 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:44.673797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.919338, "process_user_time": 5.741971, "process_kernel_time": 0.33119, "process_mem_max_rss": "290872", "process_in_blocks": "3880", "process_out_blocks": "116816"}
[0m14:05:44.674436 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:44.674328 after 10.92 seconds
[0m14:05:44.674940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f110f401040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115d1bbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1150a8b9b0>]}
[0m14:05:44.675422 [debug] [MainThread]: Flushing usage events
[0m14:05:46.326615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa584f1f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa582bb2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa582bb3350>]}


============================== 14:05:46.329347 | 6bc5b033-eefb-43b7-834e-f4e452401bc3 ==============================
[0m14:05:46.329347 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:46.330067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.475066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bc5b033-eefb-43b7-834e-f4e452401bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5837ebef0>]}
[0m14:05:46.491794 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21455027, "process_user_time": 1.423868, "process_kernel_time": 0.095991, "process_mem_max_rss": "92344", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:46.492450 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:46.492315 after 0.22 seconds
[0m14:05:46.492917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa585041fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa582b0f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa583c0c0b0>]}
[0m14:05:46.493358 [debug] [MainThread]: Flushing usage events
[0m22:05:44.061021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e7396990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e8967740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e697a060>]}


============================== 22:05:44.068524 | 1b63d6a8-daf1-4ca3-a1ae-1b556115be28 ==============================
[0m22:05:44.068524 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.069276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.214849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b63d6a8-daf1-4ca3-a1ae-1b556115be28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e6a99c70>]}
[0m22:05:44.228680 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-z5571pxr'
[0m22:05:44.229135 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:44.369635 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:44.370393 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:44.403437 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:44.407415 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:44.783211 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:44.783829 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:44.784413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1b63d6a8-daf1-4ca3-a1ae-1b556115be28', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e67a2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e664be60>]}
[0m22:05:44.784886 [info ] [MainThread]: 
[0m22:05:44.785427 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:44.787209 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.77532077, "process_user_time": 1.616816, "process_kernel_time": 0.128382, "process_mem_max_rss": "93352", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m22:05:44.787819 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:44.787712 after 0.78 seconds
[0m22:05:44.788269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e6dd3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e66c5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e67874a0>]}
[0m22:05:44.788692 [debug] [MainThread]: Flushing usage events
[0m22:05:46.607830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faaf40920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faaea6d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fad192000>]}


============================== 22:05:46.610715 | ba9c2026-e40c-4062-8e93-80c00072d66f ==============================
[0m22:05:46.610715 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:46.611414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:46.858366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa3d645c0>]}
[0m22:05:46.918296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fac311580>]}
[0m22:05:46.920969 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:05:46.937141 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:46.937906 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:46.938459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fab971520>]}
[0m22:05:48.185992 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:48.186711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa3605fd0>]}
[0m22:05:48.371776 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:48.377232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa3527bf0>]}
[0m22:05:48.530683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa35f9e80>]}
[0m22:05:48.531300 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:48.531820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa37ae330>]}
[0m22:05:48.533628 [info ] [MainThread]: 
[0m22:05:48.534370 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:48.539369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:48.576528 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:48.577021 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:48.577435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:49.093747 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:49.095390 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:49.097605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:49.098218 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:49.105721 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:49.106182 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:49.106591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:49.113348 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:49.115215 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:49.115670 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:49.116245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:49.116651 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:49.117036 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:49.117620 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:49.118593 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:49.119046 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:49.119438 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:49.120048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:49.120473 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:49.122994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:49.129003 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:49.129424 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:49.129818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:49.136173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:49.136628 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:49.137036 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:49.160725 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:49.162524 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:49.163861 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:49.164303 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:49.168396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa21e3740>]}
[0m22:05:49.168945 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:49.169347 [debug] [MainThread]: On master: BEGIN
[0m22:05:49.169724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:49.176245 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:49.176694 [debug] [MainThread]: On master: COMMIT
[0m22:05:49.177088 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:49.177472 [debug] [MainThread]: On master: COMMIT
[0m22:05:49.178003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:49.178414 [debug] [MainThread]: On master: Close
[0m22:05:49.179880 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:49.180387 [info ] [MainThread]: 
[0m22:05:49.190571 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:49.191228 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:49.191922 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:49.192373 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:49.219740 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:49.220642 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:49.255844 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:49.256737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:00.216369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:00.216868 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:00.217495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.217952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:00.218386 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:00.219102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.221991 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:00.222455 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:00.223150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.239438 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:00.239918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:00.240358 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:00.241716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.246672 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:00.247167 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:00.248538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.250836 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:00.281471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f68450bf0>]}
[0m22:06:00.282336 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.09s]
[0m22:06:00.283220 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:00.284281 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:00.284870 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:00.285488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:00.285956 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:00.291507 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:00.292204 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:00.326769 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:00.327397 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241206220600320768"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:00.327907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:00.343282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.352934 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:00.353475 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:00.354158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.354646 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:00.355125 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241206220600320768'
      
      
      order by ordinal_position

  
[0m22:06:00.377120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.382374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:00.382862 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:00.386049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.393714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:00.394194 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:00.397020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.415038 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:00.415748 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:00.416220 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241206220600320768"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241206220600320768"
    )
  
[0m22:06:00.455081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.457098 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:00.457576 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:00.458010 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:00.467765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:00.468681 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:00.660044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9c2026-e40c-4062-8e93-80c00072d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f98a9ee40>]}
[0m22:06:00.660890 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:00.661664 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:00.663213 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:00.663712 [debug] [MainThread]: On master: BEGIN
[0m22:06:00.664160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:00.671023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:00.671507 [debug] [MainThread]: On master: COMMIT
[0m22:06:00.671950 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:00.672377 [debug] [MainThread]: On master: COMMIT
[0m22:06:00.672969 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:00.673427 [debug] [MainThread]: On master: Close
[0m22:06:00.674891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:00.675380 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:00.675786 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:00.676249 [info ] [MainThread]: 
[0m22:06:00.676836 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.14 seconds (12.14s).
[0m22:06:00.677929 [debug] [MainThread]: Command end result
[0m22:06:00.706990 [info ] [MainThread]: 
[0m22:06:00.707673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:00.708253 [info ] [MainThread]: 
[0m22:06:00.708845 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:00.709920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.151935, "process_user_time": 5.716284, "process_kernel_time": 0.34753, "process_mem_max_rss": "295328", "process_in_blocks": "3880", "process_out_blocks": "116848"}
[0m22:06:00.710565 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:00.710455 after 14.15 seconds
[0m22:06:00.711097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fac2b2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faba50680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f63a52ff0>]}
[0m22:06:00.711597 [debug] [MainThread]: Flushing usage events
[0m22:06:02.554041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae45fce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae45fffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae41d70b0>]}


============================== 22:06:02.556871 | 2e163db1-9a6d-42d1-9e97-26e07a838b04 ==============================
[0m22:06:02.556871 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:02.557601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:02.697291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e163db1-9a6d-42d1-9e97-26e07a838b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae4b0aed0>]}
[0m22:06:02.713813 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2094628, "process_user_time": 1.421034, "process_kernel_time": 0.091808, "process_mem_max_rss": "92404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:02.714407 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:02.714297 after 0.21 seconds
[0m22:06:02.714844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae4d40b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae45da7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae6521a30>]}
[0m22:06:02.715318 [debug] [MainThread]: Flushing usage events
[0m06:02:07.766955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d70c9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d7a32360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d70c9220>]}


============================== 06:02:07.775762 | 2b2f7385-5ca0-4fdf-9870-a9577bc421ef ==============================
[0m06:02:07.775762 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.776530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.925265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b2f7385-5ca0-4fdf-9870-a9577bc421ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d7461880>]}
[0m06:02:07.938902 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6odopnbr'
[0m06:02:07.939393 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.992645 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.993445 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:08.006698 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:08.010896 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:08.147342 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:08.147967 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:08.148581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2b2f7385-5ca0-4fdf-9870-a9577bc421ef', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d6eae210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d6eac7d0>]}
[0m06:02:08.149068 [info ] [MainThread]: 
[0m06:02:08.149588 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:08.150980 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43334132, "process_user_time": 1.581571, "process_kernel_time": 0.140852, "process_mem_max_rss": "93536", "process_in_blocks": "6032", "process_out_blocks": "3992"}
[0m06:02:08.151572 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:08.151468 after 0.43 seconds
[0m06:02:08.152054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d782d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d6ef0c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11d732a630>]}
[0m06:02:08.152498 [debug] [MainThread]: Flushing usage events
[0m06:02:09.808219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60ee84f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60ee863c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc612113680>]}


============================== 06:02:09.811243 | 7c05d5f6-5e6d-4931-b903-c1e64133e81a ==============================
[0m06:02:09.811243 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.812022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.059935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60ea55ca0>]}
[0m06:02:10.122617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60f988860>]}
[0m06:02:10.125342 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:10.142442 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:10.143193 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:10.143744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60eb3c9b0>]}
[0m06:02:11.393327 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.394010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6079a0c80>]}
[0m06:02:11.579296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.584606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60f202ea0>]}
[0m06:02:11.745194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6074e1670>]}
[0m06:02:11.745797 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:11.746307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6073189e0>]}
[0m06:02:11.748069 [info ] [MainThread]: 
[0m06:02:11.748778 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.753662 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.791281 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.791798 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.792236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.131506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.133085 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.135274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.135874 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.142995 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.143437 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.143871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.150155 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.151647 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.152092 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.152649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.153040 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.153424 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.153989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.154911 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.155317 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.155694 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.156269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.156677 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.158698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.164493 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.164911 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.165296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.171274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.171689 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.172121 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.197204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.198827 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.200102 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.200508 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.204208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6060e0890>]}
[0m06:02:12.204750 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.205147 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.205528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.212123 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.212555 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.212956 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.213336 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.213896 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.214310 [debug] [MainThread]: On master: Close
[0m06:02:12.216017 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.216562 [info ] [MainThread]: 
[0m06:02:12.226598 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.227227 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.228030 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:12.228490 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.256131 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.256932 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.292016 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.292862 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.008732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.009270 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.010011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.010456 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.010882 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.011686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.014685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.015158 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.015934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.032473 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.033018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.033465 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.035867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.041174 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.041647 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.043056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.045491 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.075936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c8d5b440>]}
[0m06:02:20.076791 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.85s]
[0m06:02:20.077584 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.078607 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.079179 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.079847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.080334 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.085747 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.086462 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:20.121069 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.121662 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241207060220114945"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:20.122153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:20.137089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.146518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.147023 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:20.147796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.148290 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.148735 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241207060220114945'
      
      
      order by ordinal_position

  
[0m06:02:20.181266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.187072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.187582 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.190804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.198780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.199288 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.202351 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.220838 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:20.221641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.222155 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241207060220114945"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241207060220114945"
    )
  
[0m06:02:20.256906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.258903 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.259358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.259784 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.268967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.269880 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:20.465669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c05d5f6-5e6d-4931-b903-c1e64133e81a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5e5f87d10>]}
[0m06:02:20.466531 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.39s]
[0m06:02:20.467341 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:20.468845 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.469329 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.469766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:20.476591 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.477094 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.477533 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.477959 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.478549 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.479008 [debug] [MainThread]: On master: Close
[0m06:02:20.480835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:20.481281 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:20.481686 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:20.482156 [info ] [MainThread]: 
[0m06:02:20.482690 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.73 seconds (8.73s).
[0m06:02:20.483717 [debug] [MainThread]: Command end result
[0m06:02:20.513284 [info ] [MainThread]: 
[0m06:02:20.513963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:20.514488 [info ] [MainThread]: 
[0m06:02:20.515008 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:20.516056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.757987, "process_user_time": 5.368173, "process_kernel_time": 0.370081, "process_mem_max_rss": "295608", "process_in_blocks": "3880", "process_out_blocks": "116816"}
[0m06:02:20.516706 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:20.516594 after 10.76 seconds
[0m06:02:20.517216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60f0839b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60ee85130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c3adab70>]}
[0m06:02:20.517705 [debug] [MainThread]: Flushing usage events
[0m06:02:22.321418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19514c9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1951595190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19514caed0>]}


============================== 06:02:22.324397 | c5bb8cf4-de50-4f20-b496-7029a3ea57b4 ==============================
[0m06:02:22.324397 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.325135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.471652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5bb8cf4-de50-4f20-b496-7029a3ea57b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1951469220>]}
[0m06:02:22.488605 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21703026, "process_user_time": 1.410591, "process_kernel_time": 0.135864, "process_mem_max_rss": "92404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:22.489194 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:22.489090 after 0.22 seconds
[0m06:02:22.489639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1951595190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19512b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1951469220>]}
[0m06:02:22.490081 [debug] [MainThread]: Flushing usage events
[0m14:04:44.234280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190943ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19093e7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19093e51c0>]}


============================== 14:04:44.245375 | 0a83bf86-4618-40ec-9100-de41b3648caf ==============================
[0m14:04:44.245375 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:44.246053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:44.388875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a83bf86-4618-40ec-9100-de41b3648caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1909b50170>]}
[0m14:04:44.402504 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ccu18a3p'
[0m14:04:44.402975 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:44.536101 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:44.536881 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:44.560032 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:44.564066 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:44.638874 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:44.639519 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:44.640120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0a83bf86-4618-40ec-9100-de41b3648caf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1909af6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190893c500>]}
[0m14:04:44.640611 [info ] [MainThread]: 
[0m14:04:44.641135 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:44.642858 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45806915, "process_user_time": 1.614641, "process_kernel_time": 0.11619, "process_mem_max_rss": "93712", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m14:04:44.643452 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:44.643350 after 0.46 seconds
[0m14:04:44.643891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190943ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1908d58740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1908c3b7a0>]}
[0m14:04:44.644388 [debug] [MainThread]: Flushing usage events
[0m14:04:46.312059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff152e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff095f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff1643620>]}


============================== 14:04:46.314963 | b51c4412-25c0-42af-8429-7cad26f82c82 ==============================
[0m14:04:46.314963 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:46.315613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:46.556793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff090c4d0>]}
[0m14:04:46.616874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe99122a0>]}
[0m14:04:46.619512 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:04:46.635941 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:46.636805 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:46.637367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe99c6720>]}
[0m14:04:47.887184 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:47.887858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe9766450>]}
[0m14:04:48.076714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:48.082024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff08fd040>]}
[0m14:04:48.218439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe91f8cb0>]}
[0m14:04:48.219031 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:04:48.219568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe900dee0>]}
[0m14:04:48.221410 [info ] [MainThread]: 
[0m14:04:48.222158 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:48.227275 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:48.265156 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:48.265675 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:48.266084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:48.932748 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:48.934295 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:48.936491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:48.937065 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:48.944142 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.944614 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:48.945020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:48.951353 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.952954 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.953373 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:48.953979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.954386 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.954775 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:48.955350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.956311 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:48.956724 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:48.957105 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:48.957654 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.958064 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:48.960185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:48.965959 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:48.966379 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:48.966755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:48.972721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.973137 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:48.973537 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:48.996794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:48.998377 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:48.999615 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:49.000033 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:49.003607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe900e900>]}
[0m14:04:49.004135 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:49.004579 [debug] [MainThread]: On master: BEGIN
[0m14:04:49.004961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:49.011265 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:49.011714 [debug] [MainThread]: On master: COMMIT
[0m14:04:49.012108 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:49.012531 [debug] [MainThread]: On master: COMMIT
[0m14:04:49.013073 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:49.013479 [debug] [MainThread]: On master: Close
[0m14:04:49.014880 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:49.015419 [info ] [MainThread]: 
[0m14:04:49.025286 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:49.025900 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:49.026632 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:49.027080 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:49.054633 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:49.055487 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:49.091137 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:49.092026 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:56.508829 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:56.509369 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:56.510032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.510491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:56.510927 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:56.511686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.514644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:56.515105 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:56.515795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.532287 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:56.532799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:56.533243 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:56.535625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.540796 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:56.541279 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:56.544738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.547240 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:56.577913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fae7f2570>]}
[0m14:04:56.578720 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.55s]
[0m14:04:56.579512 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:56.580503 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:56.581071 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:56.581690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:56.582160 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:56.587467 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:56.588198 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:56.622059 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:56.622605 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241207140456616027"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:56.623094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:56.637734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.646963 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:56.647461 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:56.648125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.648649 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:56.649093 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241207140456616027'
      
      
      order by ordinal_position

  
[0m14:04:56.671047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.676618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:56.677114 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:56.679988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.687734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:56.688251 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:56.691081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.709293 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:56.710053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:56.710532 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241207140456616027"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241207140456616027"
    )
  
[0m14:04:56.743564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.745596 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:56.746073 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:56.746528 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:56.756726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:56.757736 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:57.439855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b51c4412-25c0-42af-8429-7cad26f82c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fadb0f2c0>]}
[0m14:04:57.440730 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.86s]
[0m14:04:57.441575 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:57.443068 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.443544 [debug] [MainThread]: On master: BEGIN
[0m14:04:57.443980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:57.450934 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.451447 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.451888 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.452365 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.452960 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.453421 [debug] [MainThread]: On master: Close
[0m14:04:57.455027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:57.455471 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:57.455883 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:57.456420 [info ] [MainThread]: 
[0m14:04:57.457031 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m14:04:57.458156 [debug] [MainThread]: Command end result
[0m14:04:57.487056 [info ] [MainThread]: 
[0m14:04:57.487792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:57.488414 [info ] [MainThread]: 
[0m14:04:57.489017 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:57.490096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.227931, "process_user_time": 6.80395, "process_kernel_time": 0.3358, "process_mem_max_rss": "363504", "process_in_blocks": "3880", "process_out_blocks": "133712"}
[0m14:04:57.490739 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:57.490628 after 11.23 seconds
[0m14:04:57.491234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff47bbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff160a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe8c93380>]}
[0m14:04:57.491725 [debug] [MainThread]: Flushing usage events
[0m14:04:59.172757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c4fe52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c6721ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c580eb40>]}


============================== 14:04:59.175928 | c20edb23-2c75-41eb-afce-fe2e6e427e9b ==============================
[0m14:04:59.175928 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:59.176683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:04:59.327965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20edb23-2c75-41eb-afce-fe2e6e427e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c4c60650>]}
[0m14:04:59.344488 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22194934, "process_user_time": 1.392166, "process_kernel_time": 0.144017, "process_mem_max_rss": "92648", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:04:59.345080 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:59.344971 after 0.22 seconds
[0m14:04:59.345532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c4cafb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c4cc2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c580dfa0>]}
[0m14:04:59.345972 [debug] [MainThread]: Flushing usage events
[0m22:05:35.850699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42b05a65a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42b00aae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42b1eb8740>]}


============================== 22:05:35.858063 | 5ad76b06-bcbb-4fa9-8252-ab3642ecbd07 ==============================
[0m22:05:35.858063 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.858726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.999544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ad76b06-bcbb-4fa9-8252-ab3642ecbd07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42b0d09400>]}
[0m22:05:36.012736 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qe0f5ivl'
[0m22:05:36.013188 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:36.054369 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:36.055103 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:36.067327 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:36.071360 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:36.277168 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:36.277810 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:36.278406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ad76b06-bcbb-4fa9-8252-ab3642ecbd07', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42afabea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42b0d0b0e0>]}
[0m22:05:36.278884 [info ] [MainThread]: 
[0m22:05:36.279432 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:36.289516 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48765936, "process_user_time": 1.614166, "process_kernel_time": 0.143836, "process_mem_max_rss": "93848", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m22:05:36.290249 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:36.290145 after 0.49 seconds
[0m22:05:36.290688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42b0235ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42afdf78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42aff920f0>]}
[0m22:05:36.291117 [debug] [MainThread]: Flushing usage events
[0m22:05:38.136927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0266bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b02b58b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0322d640>]}


============================== 22:05:38.139703 | 048fcdb6-f831-4857-af61-bdc5f71c5d9d ==============================
[0m22:05:38.139703 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.140437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.378073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b020645c0>]}
[0m22:05:38.437281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b021bd7f0>]}
[0m22:05:38.439927 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:05:38.455982 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:38.456727 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:38.457271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afb146ab0>]}
[0m22:05:39.724427 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:39.725043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afafe18e0>]}
[0m22:05:39.907789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:39.912805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afab09be0>]}
[0m22:05:40.085004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afaad9e20>]}
[0m22:05:40.085579 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:40.086090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afafad2e0>]}
[0m22:05:40.087821 [info ] [MainThread]: 
[0m22:05:40.088540 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:40.093212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:40.130181 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:40.130645 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:40.131044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:40.766949 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:40.768553 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:40.770721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:40.771322 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:40.778412 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.778848 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:40.779261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.785508 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.786952 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.787415 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:40.788019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.788422 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.788802 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:40.789371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.790290 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.790699 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.791087 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.791680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.792095 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:40.793953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:40.799528 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.799957 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:40.800336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.806161 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.806596 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.806995 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:40.830510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.832070 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:40.833290 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:40.833702 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:40.837072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afa9b5a90>]}
[0m22:05:40.837610 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.838002 [debug] [MainThread]: On master: BEGIN
[0m22:05:40.838375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:40.844763 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.845205 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.845604 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.845988 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.846518 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.846919 [debug] [MainThread]: On master: Close
[0m22:05:40.848429 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:40.848973 [info ] [MainThread]: 
[0m22:05:40.858681 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.859316 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.860035 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:40.860613 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.887777 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.888519 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.923101 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.923881 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.370939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.371478 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.372133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.372596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.373038 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.373748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.376660 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.377131 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.377839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.394838 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.395344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.395789 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.396948 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.401923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.402393 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.403538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.405856 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.435217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ad89c9d30>]}
[0m22:05:51.436027 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.57s]
[0m22:05:51.436891 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.437894 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.438461 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.439119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.439621 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.444927 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.445600 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:51.480451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.480990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241207220551474402"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:51.481467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:51.496537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.505642 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.506138 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:51.506789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.507270 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.507720 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241207220551474402'
      
      
      order by ordinal_position

  
[0m22:05:51.529614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.535481 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.535988 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.538890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.546596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.547084 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.549945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.567996 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:51.568704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.569177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241207220551474402"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241207220551474402"
    )
  
[0m22:05:51.603752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.605778 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.606477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.606954 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.622827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.624104 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:51.876409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '048fcdb6-f831-4857-af61-bdc5f71c5d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab743f0b0>]}
[0m22:05:51.877229 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.44s]
[0m22:05:51.878073 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:51.879595 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.880089 [debug] [MainThread]: On master: BEGIN
[0m22:05:51.880530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:51.887213 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.887735 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.888174 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.888605 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.889186 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.889641 [debug] [MainThread]: On master: Close
[0m22:05:51.890981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:51.891487 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:51.891912 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:51.892392 [info ] [MainThread]: 
[0m22:05:51.892949 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.80 seconds (11.80s).
[0m22:05:51.893992 [debug] [MainThread]: Command end result
[0m22:05:51.922710 [info ] [MainThread]: 
[0m22:05:51.923375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:51.923926 [info ] [MainThread]: 
[0m22:05:51.924483 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:51.925500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.837904, "process_user_time": 5.85578, "process_kernel_time": 0.395714, "process_mem_max_rss": "293248", "process_in_blocks": "3880", "process_out_blocks": "116848"}
[0m22:05:51.926146 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:51.926035 after 13.84 seconds
[0m22:05:51.926639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0266bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afafd4a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5afab12810>]}
[0m22:05:51.927127 [debug] [MainThread]: Flushing usage events
[0m22:05:53.810642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2f54ab530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2f458dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2f436b500>]}


============================== 22:05:53.813584 | c25ddd86-d308-4f30-9056-cacecef06610 ==============================
[0m22:05:53.813584 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.814328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.957188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c25ddd86-d308-4f30-9056-cacecef06610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2f436b500>]}
[0m22:05:53.973633 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21238124, "process_user_time": 1.428698, "process_kernel_time": 0.087797, "process_mem_max_rss": "92656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:53.974216 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:53.974115 after 0.21 seconds
[0m22:05:53.974657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2f54ab530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2f44e2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2f6802630>]}
[0m22:05:53.975081 [debug] [MainThread]: Flushing usage events
[0m06:02:03.741145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081172a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081172a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081172b830>]}


============================== 06:02:03.748277 | 882b66a3-d014-4b91-b026-20cb499e08ff ==============================
[0m06:02:03.748277 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.748983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:03.886597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '882b66a3-d014-4b91-b026-20cb499e08ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081172ba70>]}
[0m06:02:03.899859 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v3gd932j'
[0m06:02:03.900312 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:04.016467 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:04.017096 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:04.039020 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:04.042868 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:04.124547 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:04.125148 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:04.125730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '882b66a3-d014-4b91-b026-20cb499e08ff', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0810fc7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0811e32fc0>]}
[0m06:02:04.126189 [info ] [MainThread]: 
[0m06:02:04.126708 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:04.128741 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43602425, "process_user_time": 1.53651, "process_kernel_time": 0.137116, "process_mem_max_rss": "93896", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m06:02:04.129345 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:04.129242 after 0.44 seconds
[0m06:02:04.129780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08114e38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081122d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081172ba70>]}
[0m06:02:04.130204 [debug] [MainThread]: Flushing usage events
[0m06:02:05.722020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fd29dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fcd36930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fccbd6d0>]}


============================== 06:02:05.724843 | 0195972c-3bf5-45c7-827c-2d247ea64cff ==============================
[0m06:02:05.724843 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.725502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:05.955805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fbf6c0e0>]}
[0m06:02:06.014094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fadc82c0>]}
[0m06:02:06.016559 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:06.031909 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:06.032618 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:06.033163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fac50590>]}
[0m06:02:07.280232 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:07.280912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f3be6390>]}
[0m06:02:07.472175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:07.477113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fbfd4560>]}
[0m06:02:07.597751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f36d9dc0>]}
[0m06:02:07.598301 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:07.598781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f3709610>]}
[0m06:02:07.600461 [info ] [MainThread]: 
[0m06:02:07.601152 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:07.605777 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:07.641945 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:07.642404 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:07.642835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:08.159360 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:08.160908 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:08.162927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:08.163532 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:08.170575 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.171012 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:08.171453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:08.177640 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.179055 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.179512 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:08.180085 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.180487 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.180872 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:08.181493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.182424 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:08.182848 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.183235 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:08.183836 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.184249 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:08.186139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:08.191765 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:08.192188 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:08.192579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:08.198463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.198881 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:08.199314 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:08.222909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.224406 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:08.225607 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:08.226016 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:08.229372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f3632b40>]}
[0m06:02:08.229884 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:08.230281 [debug] [MainThread]: On master: BEGIN
[0m06:02:08.230651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:08.236882 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:08.237303 [debug] [MainThread]: On master: COMMIT
[0m06:02:08.237699 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:08.238085 [debug] [MainThread]: On master: COMMIT
[0m06:02:08.238615 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:08.239023 [debug] [MainThread]: On master: Close
[0m06:02:08.240512 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:08.241012 [info ] [MainThread]: 
[0m06:02:08.250368 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:08.250966 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:08.251644 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:08.252087 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:08.279187 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:08.279993 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:08.314961 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:08.315739 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:16.895797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.896303 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:16.896933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.897386 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.897826 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:16.898525 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.901435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.901894 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:16.902576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.918924 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:16.919438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.919881 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:16.921945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.926892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.927387 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:16.928822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.931095 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:16.962780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b85a3080>]}
[0m06:02:16.963517 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.71s]
[0m06:02:16.964289 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:16.965242 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:16.965799 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:16.966394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:16.966845 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:16.971825 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:16.972479 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:17.005952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:17.006457 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241208060217000093"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:17.006928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:17.021554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:17.030062 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:17.030540 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:17.031214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:17.031692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:17.032133 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241208060217000093'
      
      
      order by ordinal_position

  
[0m06:02:17.052872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:17.057934 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:17.058411 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:17.061232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:17.068905 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:17.069385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:17.073978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:17.092005 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:17.092711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:17.093184 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241208060217000093"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241208060217000093"
    )
  
[0m06:02:17.125729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:17.127776 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:17.128232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:17.128657 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:17.137809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:17.138730 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:17.346618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0195972c-3bf5-45c7-827c-2d247ea64cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b3fe75c0>]}
[0m06:02:17.347464 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:17.348304 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:17.349708 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.350196 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.350634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:17.357285 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.357765 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.358205 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.358631 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.359308 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.359775 [debug] [MainThread]: On master: Close
[0m06:02:17.361361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:17.361803 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:17.362208 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:17.362671 [info ] [MainThread]: 
[0m06:02:17.363206 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m06:02:17.364235 [debug] [MainThread]: Command end result
[0m06:02:17.393123 [info ] [MainThread]: 
[0m06:02:17.393736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:17.394236 [info ] [MainThread]: 
[0m06:02:17.394764 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:17.395777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.725352, "process_user_time": 5.608532, "process_kernel_time": 0.358499, "process_mem_max_rss": "295264", "process_in_blocks": "3880", "process_out_blocks": "116824"}
[0m06:02:17.396433 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:17.396322 after 11.73 seconds
[0m06:02:17.396922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fccbd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27faf7f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b3e1ca40>]}
[0m06:02:17.397403 [debug] [MainThread]: Flushing usage events
[0m06:02:19.032926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b38ef9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b37a464b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b388fb380>]}


============================== 06:02:19.035801 | 4342565a-8bd9-4f98-b6da-38012417b9ed ==============================
[0m06:02:19.035801 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.036479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:19.179632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4342565a-8bd9-4f98-b6da-38012417b9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b3850e7b0>]}
[0m06:02:19.196034 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21517265, "process_user_time": 1.424058, "process_kernel_time": 0.108004, "process_mem_max_rss": "92208", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:19.196609 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:19.196506 after 0.22 seconds
[0m06:02:19.197046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b37ca2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b37fdde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b39f21f70>]}
[0m06:02:19.197490 [debug] [MainThread]: Flushing usage events
[0m14:05:14.330757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0f917320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0f7820c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1012f2c0>]}


============================== 14:05:14.338087 | d2b7652b-a219-43c5-94e6-4cbf1fbcc591 ==============================
[0m14:05:14.338087 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.338764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:14.483957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2b7652b-a219-43c5-94e6-4cbf1fbcc591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff108048f0>]}
[0m14:05:14.498311 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ulv0023v'
[0m14:05:14.498788 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:14.566243 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:14.566865 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:14.577830 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:14.581865 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:14.718220 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:14.718781 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:14.719342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd2b7652b-a219-43c5-94e6-4cbf1fbcc591', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0f5eb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0f5e84a0>]}
[0m14:05:14.719811 [info ] [MainThread]: 
[0m14:05:14.720311 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:14.721913 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43992546, "process_user_time": 1.561678, "process_kernel_time": 0.161413, "process_mem_max_rss": "93460", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m14:05:14.722515 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:14.722411 after 0.44 seconds
[0m14:05:14.722950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0ff2a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0fce3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0fce12b0>]}
[0m14:05:14.723388 [debug] [MainThread]: Flushing usage events
[0m14:05:16.344498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe846cb140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe84e5e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe846cb020>]}


============================== 14:05:16.347300 | 30b38ba9-e7e3-469e-b544-da295a1b199f ==============================
[0m14:05:16.347300 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.347960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.583177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7d5555b0>]}
[0m14:05:16.642334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe85661ca0>]}
[0m14:05:16.644857 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:16.660350 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:16.661066 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:16.661620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7d5e4aa0>]}
[0m14:05:17.901166 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:17.901811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7cf68980>]}
[0m14:05:18.084003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:18.089128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7cfd89b0>]}
[0m14:05:18.210031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7cded8e0>]}
[0m14:05:18.210596 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:18.211073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7cd952e0>]}
[0m14:05:18.212749 [info ] [MainThread]: 
[0m14:05:18.213475 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:18.218297 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:18.254626 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:18.255096 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:18.255508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:18.662757 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:18.664296 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:18.666429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:18.666992 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:18.673983 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:18.674418 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:18.674886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:18.681012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:18.682463 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:18.682864 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:18.683446 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:18.683842 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:18.684217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:18.684846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:18.685807 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:18.686204 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:18.686585 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:18.687129 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:18.687539 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:18.689412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:18.694929 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:18.695341 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:18.695716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:18.701549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:18.701962 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:18.702364 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:18.725646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:18.727120 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:18.728340 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:18.728755 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:18.732163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe84570920>]}
[0m14:05:18.732686 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:18.733086 [debug] [MainThread]: On master: BEGIN
[0m14:05:18.733490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:18.739816 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:18.740243 [debug] [MainThread]: On master: COMMIT
[0m14:05:18.740640 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:18.741022 [debug] [MainThread]: On master: COMMIT
[0m14:05:18.741582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:18.741999 [debug] [MainThread]: On master: Close
[0m14:05:18.743471 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:18.744008 [info ] [MainThread]: 
[0m14:05:18.753700 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:18.754310 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:18.755043 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:18.755492 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:18.782946 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:18.783716 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:18.818306 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:18.819074 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:26.909054 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.909605 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:26.910290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.910745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.911180 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:26.911912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.914801 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.915262 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:26.915988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.932360 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.932860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.933302 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.934805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.939883 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.940354 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:26.941949 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.944282 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:26.973342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe41a022a0>]}
[0m14:05:26.974139 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.22s]
[0m14:05:26.975005 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:26.975983 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:26.976545 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:26.977202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:26.977694 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:26.982900 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:26.983560 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:27.016860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.017424 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241208140527010916"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:27.017928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:27.032117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.041069 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.041570 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:27.042202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.042659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.043113 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241208140527010916'
      
      
      order by ordinal_position

  
[0m14:05:27.063958 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.069297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.069812 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:27.072722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.080468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.080946 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:27.084130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.101873 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:27.102572 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.103042 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241208140527010916"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241208140527010916"
    )
  
[0m14:05:27.134771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.136697 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:27.137161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:27.137613 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:27.146704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:27.147612 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:27.347005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b38ba9-e7e3-469e-b544-da295a1b199f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4116c5c0>]}
[0m14:05:27.347823 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:27.348595 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:27.350077 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:27.350557 [debug] [MainThread]: On master: BEGIN
[0m14:05:27.351001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:27.357856 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:27.358348 [debug] [MainThread]: On master: COMMIT
[0m14:05:27.358797 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:27.359235 [debug] [MainThread]: On master: COMMIT
[0m14:05:27.359818 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:27.360283 [debug] [MainThread]: On master: Close
[0m14:05:27.361742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:27.362189 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:27.362600 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:27.363063 [info ] [MainThread]: 
[0m14:05:27.363610 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m14:05:27.364639 [debug] [MainThread]: Command end result
[0m14:05:27.393285 [info ] [MainThread]: 
[0m14:05:27.393943 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:27.394483 [info ] [MainThread]: 
[0m14:05:27.395046 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:27.396132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.10031, "process_user_time": 5.396512, "process_kernel_time": 0.399445, "process_mem_max_rss": "290260", "process_in_blocks": "3880", "process_out_blocks": "116816"}
[0m14:05:27.396793 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:27.396682 after 11.10 seconds
[0m14:05:27.397283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe883bbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe84f26f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe411ab9b0>]}
[0m14:05:27.397796 [debug] [MainThread]: Flushing usage events
[0m14:05:29.058194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17f377e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17f485310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1812a8fe0>]}


============================== 14:05:29.060981 | 62a51c5e-ec2a-4da6-84ce-9424292b2029 ==============================
[0m14:05:29.060981 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.061717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.200231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a51c5e-ec2a-4da6-84ce-9424292b2029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17ecccb90>]}
[0m14:05:29.216830 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20775834, "process_user_time": 1.430787, "process_kernel_time": 0.068132, "process_mem_max_rss": "92536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:29.217421 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:29.217320 after 0.21 seconds
[0m14:05:29.217896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17f6e3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17ed87a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17eea7e30>]}
[0m14:05:29.218324 [debug] [MainThread]: Flushing usage events
[0m22:05:29.555860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9103ce2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9103ceb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9103cf2c0>]}


============================== 22:05:29.562989 | 885069df-6326-42e6-b026-1a7c29f18b46 ==============================
[0m22:05:29.562989 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:29.563640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:29.702372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '885069df-6326-42e6-b026-1a7c29f18b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90faa3bc0>]}
[0m22:05:29.716048 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xf1vkwjg'
[0m22:05:29.716523 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:29.866319 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:29.867038 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:29.888637 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:29.892522 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:29.965272 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:29.965799 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:29.966292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '885069df-6326-42e6-b026-1a7c29f18b46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90f9ab410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90f9ab770>]}
[0m22:05:29.966746 [info ] [MainThread]: 
[0m22:05:29.967195 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:29.968786 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46204892, "process_user_time": 1.559037, "process_kernel_time": 0.124242, "process_mem_max_rss": "93800", "process_in_blocks": "6032", "process_out_blocks": "3992"}
[0m22:05:29.969376 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:29.969274 after 0.46 seconds
[0m22:05:29.969844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90f965220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff910b50230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90fc238f0>]}
[0m22:05:29.970269 [debug] [MainThread]: Flushing usage events
[0m22:05:31.534249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f303491d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3035559940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30332763c0>]}


============================== 22:05:31.536975 | 8d742435-af4c-4771-b4fa-46b27857e0cd ==============================
[0m22:05:31.536975 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:31.537670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:31.771396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3032fec620>]}
[0m22:05:31.830564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30354b8320>]}
[0m22:05:31.833198 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:05:31.849638 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:31.850423 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:31.851001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3033277d10>]}
[0m22:05:33.099629 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:33.100302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302bb97f50>]}
[0m22:05:33.294233 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:33.299399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302bbd09b0>]}
[0m22:05:33.426035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302b9ede50>]}
[0m22:05:33.426606 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:33.427103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302b94d2e0>]}
[0m22:05:33.428761 [info ] [MainThread]: 
[0m22:05:33.429434 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:33.434272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:33.470948 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:33.471437 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:33.471869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:33.823650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.825221 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:33.827417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:33.827973 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:33.835028 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.835459 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:33.835853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.842039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.843437 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.843839 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:33.844427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.844824 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.845199 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:33.845801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.846711 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.847123 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.847503 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.848042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.848450 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:33.850317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:33.855806 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.856214 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:33.856583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.862356 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.862767 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.863157 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:33.902382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.904889 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:33.906432 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:33.906845 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:33.911826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3033b7e030>]}
[0m22:05:33.912368 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.912783 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.913186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:33.919989 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.920443 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.920846 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.921237 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.921818 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.922233 [debug] [MainThread]: On master: Close
[0m22:05:33.923977 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:33.924487 [info ] [MainThread]: 
[0m22:05:33.934503 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:33.935169 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:33.935854 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:33.936308 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:33.964335 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:33.965238 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:34.000895 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:34.001738 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:42.131803 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.132306 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:42.132932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.133387 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.133871 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:42.134582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.137434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.137923 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:42.138617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.154992 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.155473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.155910 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.157295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.162322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.162790 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:42.164309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.166639 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:42.196270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302bfd3d40>]}
[0m22:05:42.196998 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.26s]
[0m22:05:42.197822 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:42.198829 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:42.199385 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:42.199975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:42.200427 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:42.205411 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:42.206090 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:42.239500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.240005 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241208220542233620"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:42.240477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:42.254365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.262966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.263437 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:42.264030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.264481 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.264920 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241208220542233620'
      
      
      order by ordinal_position

  
[0m22:05:42.286775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.291896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.292375 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.295217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.302842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.303322 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.306200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.324159 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:42.324923 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.325398 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241208220542233620"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241208220542233620"
    )
  
[0m22:05:42.365097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.367144 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.367615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.368053 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.378717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.379684 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:43.067365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d742435-af4c-4771-b4fa-46b27857e0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fea0638f0>]}
[0m22:05:43.068182 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.87s]
[0m22:05:43.068947 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:43.070526 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.071013 [debug] [MainThread]: On master: BEGIN
[0m22:05:43.071454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:43.078351 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.078832 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.079269 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.079691 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.080280 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.080733 [debug] [MainThread]: On master: Close
[0m22:05:43.082244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:43.082690 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:43.083097 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:43.083564 [info ] [MainThread]: 
[0m22:05:43.084103 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.65 seconds (9.65s).
[0m22:05:43.085116 [debug] [MainThread]: Command end result
[0m22:05:43.114188 [info ] [MainThread]: 
[0m22:05:43.114846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:43.115358 [info ] [MainThread]: 
[0m22:05:43.115893 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:43.116897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.632446, "process_user_time": 6.512263, "process_kernel_time": 0.322588, "process_mem_max_rss": "374324", "process_in_blocks": "3880", "process_out_blocks": "135264"}
[0m22:05:43.117546 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:43.117435 after 11.63 seconds
[0m22:05:43.118071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30199a2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe9febf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fe9fea840>]}
[0m22:05:43.118560 [debug] [MainThread]: Flushing usage events
[0m22:05:44.800182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d937bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d8f770b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d939eed0>]}


============================== 22:05:44.802996 | f772c59d-afeb-4ed0-9194-036e578c308a ==============================
[0m22:05:44.802996 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.803647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.947269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f772c59d-afeb-4ed0-9194-036e578c308a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d8d1a690>]}
[0m22:05:44.963560 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21263152, "process_user_time": 1.417411, "process_kernel_time": 0.135752, "process_mem_max_rss": "92416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:44.964143 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:44.964040 after 0.21 seconds
[0m22:05:44.964586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d921b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d9fcd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d9fcd790>]}
[0m22:05:44.965012 [debug] [MainThread]: Flushing usage events
[0m06:02:24.935706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa968c80ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96b011eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96942e270>]}


============================== 06:02:24.968676 | 0537929c-0832-45a8-a3d1-a9ab17a6c6fd ==============================
[0m06:02:24.968676 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.969427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.120811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0537929c-0832-45a8-a3d1-a9ab17a6c6fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa968b03b90>]}
[0m06:02:25.134521 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qtt92at6'
[0m06:02:25.135003 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.170657 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.171364 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.182337 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.186326 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.406467 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.407067 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:25.407644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0537929c-0832-45a8-a3d1-a9ab17a6c6fd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa968cc9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9689c5310>]}
[0m06:02:25.408111 [info ] [MainThread]: 
[0m06:02:25.408603 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:25.419516 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53344834, "process_user_time": 1.644889, "process_kernel_time": 0.088047, "process_mem_max_rss": "94080", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m06:02:25.420177 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.420070 after 0.53 seconds
[0m06:02:25.420619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa968f2b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9689d1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9689d2450>]}
[0m06:02:25.421051 [debug] [MainThread]: Flushing usage events
[0m06:02:27.288820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aaa01070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aaac5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa5ed7f0>]}


============================== 06:02:27.291648 | 15170046-b7bb-4148-adbf-a1f7c1a9166a ==============================
[0m06:02:27.291648 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.292345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.530682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa059220>]}
[0m06:02:27.590569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa06c6b0>]}
[0m06:02:27.593173 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:27.640688 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.641445 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.641985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a9fafd10>]}
[0m06:02:28.887963 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.888640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a2b98aa0>]}
[0m06:02:29.074300 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:29.079708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a2a176e0>]}
[0m06:02:29.223882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a29fd400>]}
[0m06:02:29.224459 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:29.225000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a2bf52e0>]}
[0m06:02:29.226727 [info ] [MainThread]: 
[0m06:02:29.227480 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:29.232300 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.269452 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.269950 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.270359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.632314 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.633864 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.636088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.636660 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.643802 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.644247 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:29.644657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.651001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.652692 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.653109 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.653749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.654151 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.654534 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.655121 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.656262 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.656677 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.657057 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.657615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.658040 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.660284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.666412 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.666832 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.667209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.673546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.673993 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.674595 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:29.698312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.699831 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:29.701104 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:29.701522 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:29.704970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a3052e40>]}
[0m06:02:29.705494 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.705897 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.706278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:29.712556 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.712985 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.713378 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.713760 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.714288 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.714702 [debug] [MainThread]: On master: Close
[0m06:02:29.716044 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:29.716530 [info ] [MainThread]: 
[0m06:02:29.733203 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:29.733828 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:29.734545 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:29.734992 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:29.763028 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:29.763809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:29.799508 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:29.800252 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:39.673606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.674139 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:39.674792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.675255 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.675748 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:39.676503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.679422 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.679891 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:39.680659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.697303 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:39.697787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.698236 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:39.699675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.704715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:39.705195 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:39.706412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.708756 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:39.738020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565d513680>]}
[0m06:02:39.738768 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.00s]
[0m06:02:39.739672 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:39.740666 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:39.741238 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:39.741853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:39.742318 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:39.747546 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:39.748210 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:39.782190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.782724 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241209060239776202"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:39.783218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:39.799613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.808831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.809336 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:39.809975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.810437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.810884 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241209060239776202'
      
      
      order by ordinal_position

  
[0m06:02:39.831806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.837086 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.837579 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:39.840441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.848175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.848696 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:39.851569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.869734 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:39.870443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.870922 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241209060239776202"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241209060239776202"
    )
  
[0m06:02:39.903391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.905458 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:39.905963 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:39.906416 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:39.916154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:39.917131 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:40.118769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15170046-b7bb-4148-adbf-a1f7c1a9166a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565d122000>]}
[0m06:02:40.119611 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:40.120364 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:40.121972 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.122464 [debug] [MainThread]: On master: BEGIN
[0m06:02:40.122911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:40.129935 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.130442 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.130889 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:40.131356 [debug] [MainThread]: On master: COMMIT
[0m06:02:40.131967 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:40.132428 [debug] [MainThread]: On master: Close
[0m06:02:40.134183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:40.134627 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:40.135039 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:40.135557 [info ] [MainThread]: 
[0m06:02:40.136150 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.91 seconds (10.91s).
[0m06:02:40.137297 [debug] [MainThread]: Command end result
[0m06:02:40.169175 [info ] [MainThread]: 
[0m06:02:40.170009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:40.170630 [info ] [MainThread]: 
[0m06:02:40.171407 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:40.172530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.936553, "process_user_time": 5.541672, "process_kernel_time": 0.324331, "process_mem_max_rss": "300252", "process_in_blocks": "3880", "process_out_blocks": "116824"}
[0m06:02:40.173251 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:40.173136 after 12.94 seconds
[0m06:02:40.173781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa5ed7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a299cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a2a192e0>]}
[0m06:02:40.174287 [debug] [MainThread]: Flushing usage events
[0m06:02:42.153342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708ce88b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708bd96600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708c43d130>]}


============================== 06:02:42.156277 | 8f0b9397-cf86-48b2-b5f7-9766f0e20094 ==============================
[0m06:02:42.156277 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:42.157024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:42.302831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f0b9397-cf86-48b2-b5f7-9766f0e20094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708bcce900>]}
[0m06:02:42.319341 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21816057, "process_user_time": 1.446164, "process_kernel_time": 0.108161, "process_mem_max_rss": "92376", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:42.319949 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:42.319835 after 0.22 seconds
[0m06:02:42.320383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708cc97170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708bb13f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f708ba7a150>]}
[0m06:02:42.320812 [debug] [MainThread]: Flushing usage events
[0m14:05:35.068894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad913fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad96a0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad913c980>]}


============================== 14:05:35.076498 | 51a998ff-8fe3-4f76-a56f-91c850fa3089 ==============================
[0m14:05:35.076498 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:35.077308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.220403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a998ff-8fe3-4f76-a56f-91c850fa3089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad96a0770>]}
[0m14:05:35.234004 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sgmsj24i'
[0m14:05:35.234465 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:35.290970 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:35.291696 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:35.323006 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:35.327123 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:35.399262 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:35.399872 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:35.400428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '51a998ff-8fe3-4f76-a56f-91c850fa3089', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad913fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad9258740>]}
[0m14:05:35.400947 [info ] [MainThread]: 
[0m14:05:35.401448 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:35.403349 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3840209, "process_user_time": 1.549412, "process_kernel_time": 0.164149, "process_mem_max_rss": "93808", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m14:05:35.403962 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:35.403858 after 0.38 seconds
[0m14:05:35.404405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad92b56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ada11eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad96a0770>]}
[0m14:05:35.404940 [debug] [MainThread]: Flushing usage events
[0m14:05:37.004266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462d1c96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462ac0f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462ac0f890>]}


============================== 14:05:37.007293 | 3f6b6608-7739-4859-a64c-a06856f0635a ==============================
[0m14:05:37.007293 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:37.008002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:37.253221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4623d50440>]}
[0m14:05:37.314049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462d48f8c0>]}
[0m14:05:37.316860 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:37.335726 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:37.336537 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:37.337129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4623dd8da0>]}
[0m14:05:38.586616 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:38.587329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4623b23f50>]}
[0m14:05:38.774428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:38.779829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462b2aba10>]}
[0m14:05:38.912984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46235e58e0>]}
[0m14:05:38.913585 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:38.914106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46236863f0>]}
[0m14:05:38.915883 [info ] [MainThread]: 
[0m14:05:38.916624 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:38.921621 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:38.959213 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:38.959778 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:38.960277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:39.486754 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:39.488350 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:39.490581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:39.491178 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:39.498507 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.498963 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:39.499367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:39.505772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.507301 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.507715 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:39.508289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.508729 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.509117 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:39.509697 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.510638 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:39.511046 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.511428 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:39.511981 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.512400 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:39.514669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:39.520487 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:39.520947 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:39.521333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:39.527349 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.527805 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:39.528220 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:39.553543 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.555233 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:39.556527 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:39.557002 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:39.560846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462bee9640>]}
[0m14:05:39.561383 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.561786 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.562162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:39.569056 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.569496 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.569893 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.570283 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.570820 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.571236 [debug] [MainThread]: On master: Close
[0m14:05:39.573062 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:39.573598 [info ] [MainThread]: 
[0m14:05:39.583787 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:39.584429 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:39.585280 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:39.585740 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:39.613290 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:39.614158 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:39.649477 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:39.650347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:47.636401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.636979 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:47.637689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.638157 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.638602 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:47.639344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.642289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.642754 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:47.643454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.660155 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:47.660721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.661169 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:47.663506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.668829 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.669309 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:47.670557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.673009 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:47.703278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46237ea390>]}
[0m14:05:47.704113 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.12s]
[0m14:05:47.705022 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:47.706033 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:47.706607 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:47.707275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:47.707749 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:47.713191 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:47.713866 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:47.748286 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.748898 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241209140547742213"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:47.749380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:47.764560 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.774130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.774639 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:47.775392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.775852 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.776298 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241209140547742213'
      
      
      order by ordinal_position

  
[0m14:05:47.807939 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.814024 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.814536 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:47.817507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.825491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.825984 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:47.828946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.847138 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:47.847899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.848385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241209140547742213"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241209140547742213"
    )
  
[0m14:05:47.885795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.887836 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:47.888313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.888773 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:47.898199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.899116 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:48.100767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f6b6608-7739-4859-a64c-a06856f0635a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45e5f4bd40>]}
[0m14:05:48.101595 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.39s]
[0m14:05:48.102440 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:48.103956 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.104432 [debug] [MainThread]: On master: BEGIN
[0m14:05:48.104903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:48.111767 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.112268 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.112766 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.113206 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.113816 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.114279 [debug] [MainThread]: On master: Close
[0m14:05:48.115932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:48.116378 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:48.116836 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:48.117330 [info ] [MainThread]: 
[0m14:05:48.117923 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.20 seconds (9.20s).
[0m14:05:48.119034 [debug] [MainThread]: Command end result
[0m14:05:48.148023 [info ] [MainThread]: 
[0m14:05:48.148753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:48.149352 [info ] [MainThread]: 
[0m14:05:48.149953 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:48.151026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.196753, "process_user_time": 5.762446, "process_kernel_time": 0.341805, "process_mem_max_rss": "295996", "process_in_blocks": "3880", "process_out_blocks": "116816"}
[0m14:05:48.151669 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:48.151559 after 11.20 seconds
[0m14:05:48.152160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462ac57980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462d1c96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4623605280>]}
[0m14:05:48.152672 [debug] [MainThread]: Flushing usage events
[0m14:05:49.976122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4deff6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4e49ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4e49eed0>]}


============================== 14:05:49.979096 | 285d33f8-4524-44b2-aa11-fe0be14bfe43 ==============================
[0m14:05:49.979096 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:49.979778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:50.131622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '285d33f8-4524-44b2-aa11-fe0be14bfe43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4ec4d2e0>]}
[0m14:05:50.148175 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22225179, "process_user_time": 1.515372, "process_kernel_time": 0.127947, "process_mem_max_rss": "92284", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:50.148810 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:50.148698 after 0.22 seconds
[0m14:05:50.149259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4e49cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4e371bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4ec4d2e0>]}
[0m14:05:50.149711 [debug] [MainThread]: Flushing usage events
[0m22:06:08.238645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8a424470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff89901280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff88f45220>]}


============================== 22:06:08.268596 | 364dae69-619d-4e0d-b27f-5ca9a3b85085 ==============================
[0m22:06:08.268596 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:08.269300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:08.417882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '364dae69-619d-4e0d-b27f-5ca9a3b85085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff88e26720>]}
[0m22:06:08.431677 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qewk76xw'
[0m22:06:08.432157 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:08.514624 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:08.515482 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:08.541191 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:08.545237 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:08.617399 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:08.618000 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:08.618553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '364dae69-619d-4e0d-b27f-5ca9a3b85085', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff88852450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff89ab6ab0>]}
[0m22:06:08.619057 [info ] [MainThread]: 
[0m22:06:08.619554 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:08.643768 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45461357, "process_user_time": 1.558202, "process_kernel_time": 0.180719, "process_mem_max_rss": "93828", "process_in_blocks": "6032", "process_out_blocks": "3992"}
[0m22:06:08.644478 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:08.644354 after 0.46 seconds
[0m22:06:08.644961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff89ec1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff88ff3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff88f45220>]}
[0m22:06:08.645412 [debug] [MainThread]: Flushing usage events
[0m22:06:10.287788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8e57dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8cb62450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8cb627e0>]}


============================== 22:06:10.290734 | ce4438a3-d219-44f2-a7eb-635ad1475951 ==============================
[0m22:06:10.290734 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:10.291410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:10.541616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8cfbc1a0>]}
[0m22:06:10.603171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8cb62180>]}
[0m22:06:10.605837 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:06:10.647373 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:10.648238 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:10.648784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a850030e0>]}
[0m22:06:11.910955 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:11.911624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a84b8e6c0>]}
[0m22:06:12.096088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:12.101135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a84b92630>]}
[0m22:06:12.254199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a84b90ef0>]}
[0m22:06:12.254814 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:06:12.255317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a84a0f2f0>]}
[0m22:06:12.257043 [info ] [MainThread]: 
[0m22:06:12.257748 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:12.262723 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:12.300274 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:12.300781 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:12.301185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.742009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.743636 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:12.745828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:12.746407 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:12.753572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.754015 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:12.754415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.760918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.762478 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.762929 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:12.763478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.763877 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.764261 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:12.764891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.765825 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.766235 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:12.766622 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:12.767206 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.767625 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:12.769781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:12.775616 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.776041 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:12.776423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:12.782340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.782775 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:12.783230 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:12.807093 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:12.808805 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:12.810077 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:12.810509 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:12.814305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a845882f0>]}
[0m22:06:12.814923 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.815334 [debug] [MainThread]: On master: BEGIN
[0m22:06:12.815764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:12.822197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.822638 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.823081 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.823467 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.824000 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.824412 [debug] [MainThread]: On master: Close
[0m22:06:12.825959 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:12.826486 [info ] [MainThread]: 
[0m22:06:12.861643 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:12.862330 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:12.863130 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:12.863594 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:12.891770 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:12.892654 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:12.928742 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:12.929670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:21.205651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.206207 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:21.206927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.207390 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.207828 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:21.208601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.212447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.213015 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:21.214024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.235214 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.235913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.236478 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:21.255032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.263298 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:21.264091 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:21.270023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.273851 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:21.331311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a401050a0>]}
[0m22:06:21.332160 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.47s]
[0m22:06:21.333028 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:21.334081 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:21.334666 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:21.335389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:21.335860 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:21.341351 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:21.342033 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:21.376304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.376890 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241209220621370240"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:21.377367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:21.392183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.401734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.402251 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:21.402959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.403415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.403865 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241209220621370240'
      
      
      order by ordinal_position

  
[0m22:06:21.436261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.442392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.442968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.446211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.454297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.454840 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:21.457949 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.476439 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:21.477299 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.477815 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241209220621370240"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241209220621370240"
    )
  
[0m22:06:21.516900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.518961 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.519436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:21.519861 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:21.534236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:21.535313 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:22.233453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce4438a3-d219-44f2-a7eb-635ad1475951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3b08f290>]}
[0m22:06:22.234257 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.90s]
[0m22:06:22.235113 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:22.236477 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.236962 [debug] [MainThread]: On master: BEGIN
[0m22:06:22.237401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:22.244426 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.245001 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.245441 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:22.245866 [debug] [MainThread]: On master: COMMIT
[0m22:06:22.246478 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:22.247009 [debug] [MainThread]: On master: Close
[0m22:06:22.248713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:22.249157 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:22.249568 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:22.250049 [info ] [MainThread]: 
[0m22:06:22.250602 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m22:06:22.251666 [debug] [MainThread]: Command end result
[0m22:06:22.281034 [info ] [MainThread]: 
[0m22:06:22.281734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:22.282243 [info ] [MainThread]: 
[0m22:06:22.282773 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:22.283835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.046483, "process_user_time": 6.741525, "process_kernel_time": 0.313559, "process_mem_max_rss": "369604", "process_in_blocks": "3880", "process_out_blocks": "135280"}
[0m22:06:22.284494 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:22.284380 after 12.05 seconds
[0m22:06:22.284997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8c4efe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8c5e9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3b03ed80>]}
[0m22:06:22.285506 [debug] [MainThread]: Flushing usage events
[0m22:06:24.001084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7c50f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7a4064e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7a998bc0>]}


============================== 22:06:24.004125 | 987dfb01-6827-4599-880a-16e9e75e30e1 ==============================
[0m22:06:24.004125 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:24.004788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:24.154303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '987dfb01-6827-4599-880a-16e9e75e30e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7a4f7d70>]}
[0m22:06:24.171756 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22058098, "process_user_time": 1.44851, "process_kernel_time": 0.10375, "process_mem_max_rss": "92288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:24.172376 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:24.172259 after 0.22 seconds
[0m22:06:24.172832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7c50f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7dfbbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea7ba671a0>]}
[0m22:06:24.173277 [debug] [MainThread]: Flushing usage events
[0m06:02:12.851229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797f3e3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797f187590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797f2b19a0>]}


============================== 06:02:12.858272 | 0057a194-310e-4d3c-9f9b-22f384c4dd90 ==============================
[0m06:02:12.858272 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.858943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.992773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0057a194-310e-4d3c-9f9b-22f384c4dd90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7982dbbe90>]}
[0m06:02:13.005883 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vu4n35mq'
[0m06:02:13.006329 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.167959 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.168565 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.190162 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.194011 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.265153 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.265693 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:13.266247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0057a194-310e-4d3c-9f9b-22f384c4dd90', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7980033b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7980033380>]}
[0m06:02:13.266684 [info ] [MainThread]: 
[0m06:02:13.267243 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.268822 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46632925, "process_user_time": 1.575053, "process_kernel_time": 0.093126, "process_mem_max_rss": "93932", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m06:02:13.269408 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.269305 after 0.47 seconds
[0m06:02:13.269838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797f0b3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f797f183500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7981481fd0>]}
[0m06:02:13.270260 [debug] [MainThread]: Flushing usage events
[0m06:02:14.803817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39722113d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3970b49610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39706cb3e0>]}


============================== 06:02:14.806932 | 6c40caf0-76fd-48a1-bd17-efe47c8a1b64 ==============================
[0m06:02:14.806932 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.807592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.043576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3970666600>]}
[0m06:02:15.102466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39706882c0>]}
[0m06:02:15.107821 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:15.122821 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.123525 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.124049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3970675d30>]}
[0m06:02:16.364509 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.365167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3969558800>]}
[0m06:02:16.546166 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.551081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3969063ec0>]}
[0m06:02:16.686546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3968e004d0>]}
[0m06:02:16.687110 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:16.687600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3971378230>]}
[0m06:02:16.689273 [info ] [MainThread]: 
[0m06:02:16.689936 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.694795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.730639 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.731114 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.731519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.269678 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:17.271335 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.273471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.274048 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.281227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.281677 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.282081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.288278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.289746 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.290161 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.290810 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.291222 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.291603 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.292168 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.293085 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.293488 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.293873 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.294419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.294869 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.296850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.302493 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.302946 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.303331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.309118 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.309537 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.309938 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.333182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.334613 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.335855 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.336270 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.339707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3971d85520>]}
[0m06:02:17.340230 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.340631 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.341001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.347189 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.347619 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.348014 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.348388 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.348915 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.349318 [debug] [MainThread]: On master: Close
[0m06:02:17.350809 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.351356 [info ] [MainThread]: 
[0m06:02:17.360888 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.361478 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.362197 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:17.362647 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.389506 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.390253 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.425021 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.425755 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:24.438904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.439542 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:24.440522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.441112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.441789 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:24.442672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.445927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.446514 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:24.447416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.467741 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.468225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.468682 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.505554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.511938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.512634 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:24.574129 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.577573 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:24.676265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391f872750>]}
[0m06:02:24.676999 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.31s]
[0m06:02:24.677852 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:24.678843 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:24.679411 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:24.680069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:24.680526 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:24.685617 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:24.686270 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:24.719863 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.720375 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241210060224713992"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:24.720859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:24.735411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.743956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.744423 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:24.745044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.745493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.745930 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241210060224713992'
      
      
      order by ordinal_position

  
[0m06:02:24.767070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.772053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.772527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.776705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.784218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.784706 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.787490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.805379 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:24.806039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.806519 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241210060224713992"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241210060224713992"
    )
  
[0m06:02:24.838566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.840526 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.840987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.841422 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.851076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.851983 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:25.056606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c40caf0-76fd-48a1-bd17-efe47c8a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39240e1460>]}
[0m06:02:25.057368 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:25.058202 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:25.059666 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.060151 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.060594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:25.067230 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.067712 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.068159 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.068589 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.069192 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.069652 [debug] [MainThread]: On master: Close
[0m06:02:25.071109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:25.071554 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:25.071966 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:25.072429 [info ] [MainThread]: 
[0m06:02:25.072985 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m06:02:25.074031 [debug] [MainThread]: Command end result
[0m06:02:25.102539 [info ] [MainThread]: 
[0m06:02:25.103192 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:25.103741 [info ] [MainThread]: 
[0m06:02:25.104299 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:25.105306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.350711, "process_user_time": 5.675064, "process_kernel_time": 0.302882, "process_mem_max_rss": "301836", "process_in_blocks": "3880", "process_out_blocks": "116824"}
[0m06:02:25.105957 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:25.105846 after 10.35 seconds
[0m06:02:25.106449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3971480680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39705ef800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391f7537d0>]}
[0m06:02:25.106968 [debug] [MainThread]: Flushing usage events
[0m06:02:26.704902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0a7eb500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0a73b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0b763590>]}


============================== 06:02:26.707579 | 59815d90-ff3c-4406-a0a0-d49eb48d3ac9 ==============================
[0m06:02:26.707579 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.708284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.845457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59815d90-ff3c-4406-a0a0-d49eb48d3ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0bc23260>]}
[0m06:02:26.861826 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20586117, "process_user_time": 1.362307, "process_kernel_time": 0.127841, "process_mem_max_rss": "92532", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:26.862394 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:26.862291 after 0.21 seconds
[0m06:02:26.862855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0a7eb500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0a805460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b0a4dc320>]}
[0m06:02:26.863292 [debug] [MainThread]: Flushing usage events
[0m14:05:51.251732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963abf67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9639c842c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9639c84290>]}


============================== 14:05:51.306316 | d6828981-c723-4cc0-a738-cac81e23fb9f ==============================
[0m14:05:51.306316 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:51.306993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:51.450782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6828981-c723-4cc0-a738-cac81e23fb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9639ce1190>]}
[0m14:05:51.464063 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-paa_3wel'
[0m14:05:51.464514 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:51.508674 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:51.509368 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:51.532347 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:51.536163 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:51.607990 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:51.608492 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:51.609013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd6828981-c723-4cc0-a738-cac81e23fb9f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963abf64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9639b49580>]}
[0m14:05:51.609463 [info ] [MainThread]: 
[0m14:05:51.609943 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:51.655424 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.452324, "process_user_time": 1.547162, "process_kernel_time": 0.166617, "process_mem_max_rss": "94068", "process_in_blocks": "6032", "process_out_blocks": "3992"}
[0m14:05:51.656037 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:51.655934 after 0.45 seconds
[0m14:05:51.656472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9639bcbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963a2a98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9639e77620>]}
[0m14:05:51.656896 [debug] [MainThread]: Flushing usage events
[0m14:05:53.210822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9705caa4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970817fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9705caa300>]}


============================== 14:05:53.213651 | 40b5b706-21ce-4d17-8b1a-a0a9f95d21b3 ==============================
[0m14:05:53.213651 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:53.214294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:53.446928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970579f170>]}
[0m14:05:53.505570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9705cdfaa0>]}
[0m14:05:53.508040 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:53.635804 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:53.636531 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:53.637039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970506fd10>]}
[0m14:05:54.880463 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:54.881146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fdc11ee0>]}
[0m14:05:55.063745 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:55.068773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97067aa2a0>]}
[0m14:05:55.200179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fda1e8d0>]}
[0m14:05:55.200723 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:55.201251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f970521c860>]}
[0m14:05:55.202941 [info ] [MainThread]: 
[0m14:05:55.203695 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:55.208353 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:55.244598 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:55.245063 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:55.245472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:55.848842 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:55.850447 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:55.852998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:55.853589 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:55.860954 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:55.861396 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:55.861792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:55.868836 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.870316 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:55.870727 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:55.871305 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.871709 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:55.872090 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:55.872664 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.873579 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:55.873989 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:55.874382 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:55.874978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.875439 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:55.877575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:55.883458 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:55.883876 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:55.884260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:55.889951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.890364 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:55.890764 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:55.914346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.915813 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:55.917035 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:55.917447 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:55.920647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9705c6c290>]}
[0m14:05:55.921163 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:55.921562 [debug] [MainThread]: On master: BEGIN
[0m14:05:55.921938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:55.928354 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:55.928785 [debug] [MainThread]: On master: COMMIT
[0m14:05:55.929178 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:55.929557 [debug] [MainThread]: On master: COMMIT
[0m14:05:55.930116 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:55.930516 [debug] [MainThread]: On master: Close
[0m14:05:55.931949 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:55.932452 [info ] [MainThread]: 
[0m14:05:55.958568 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:55.959167 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:55.959852 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:55.960292 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:55.987499 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:55.988254 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:56.023147 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:56.023903 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:04.077328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:04.077842 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:04.078544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.079006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:04.079493 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:04.080253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.083127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:04.083630 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:04.084362 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.100800 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:04.101284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:04.101729 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:04.103305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.108251 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:04.108719 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:06:04.110408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.112740 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:04.143403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9705caa960>]}
[0m14:06:04.144124 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.18s]
[0m14:06:04.144978 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:04.145937 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:04.146497 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:04.147141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:04.147630 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:04.152612 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:04.153260 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:04.186729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:04.187266 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241210140604180781"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:04.187747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:04.202677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.211287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:04.211775 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:04.212398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.212859 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:04.213301 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241210140604180781'
      
      
      order by ordinal_position

  
[0m14:06:04.234175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.239563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:04.240046 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:04.243194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.250868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:04.251373 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:04.254470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.272534 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:04.273242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:04.273720 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241210140604180781"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241210140604180781"
    )
  
[0m14:06:04.312271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.314317 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:04.314810 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:04.315289 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:04.325297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:04.326248 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:05.021701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40b5b706-21ce-4d17-8b1a-a0a9f95d21b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fdcee210>]}
[0m14:06:05.022529 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.87s]
[0m14:06:05.023337 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:05.024760 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.025261 [debug] [MainThread]: On master: BEGIN
[0m14:06:05.025705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:05.032509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.033018 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.033462 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.033906 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.034563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.035028 [debug] [MainThread]: On master: Close
[0m14:06:05.036658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:05.037119 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:06:05.037530 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:05.038003 [info ] [MainThread]: 
[0m14:06:05.038607 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.83 seconds (9.83s).
[0m14:06:05.039767 [debug] [MainThread]: Command end result
[0m14:06:05.068841 [info ] [MainThread]: 
[0m14:06:05.069525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:05.070110 [info ] [MainThread]: 
[0m14:06:05.070699 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:05.071838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.910694, "process_user_time": 6.70451, "process_kernel_time": 0.367151, "process_mem_max_rss": "362096", "process_in_blocks": "3880", "process_out_blocks": "135248"}
[0m14:06:05.072487 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:05.072376 after 11.91 seconds
[0m14:06:05.072983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9705127fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97056cc5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b8177770>]}
[0m14:06:05.073467 [debug] [MainThread]: Flushing usage events
[0m14:06:06.796997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65869fcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65869fe1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65869fcd40>]}


============================== 14:06:06.799891 | c4f12d02-30d1-426e-b8d4-eb15c65ffecb ==============================
[0m14:06:06.799891 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:06.800606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:06.950116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4f12d02-30d1-426e-b8d4-eb15c65ffecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6585ecd160>]}
[0m14:06:06.967343 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22006205, "process_user_time": 1.441607, "process_kernel_time": 0.116129, "process_mem_max_rss": "92528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:06.967942 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:06.967839 after 0.22 seconds
[0m14:06:06.968388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6586600800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6585eccdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65865c6a80>]}
[0m14:06:06.968826 [debug] [MainThread]: Flushing usage events
[0m22:05:46.082542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457d828860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457c72e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457c72fb90>]}


============================== 22:05:46.090475 | 1348de76-1ce1-4385-8024-bf3d8e34bfb9 ==============================
[0m22:05:46.090475 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:46.091220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:46.248940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1348de76-1ce1-4385-8024-bf3d8e34bfb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457c327b60>]}
[0m22:05:46.263250 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-up84ok3n'
[0m22:05:46.263754 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:46.308996 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:46.309802 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:46.321957 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:46.326139 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:46.538335 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:46.539044 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:46.539668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1348de76-1ce1-4385-8024-bf3d8e34bfb9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457bc565d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457ce36d50>]}
[0m22:05:46.540180 [info ] [MainThread]: 
[0m22:05:46.540714 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:46.542494 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5105126, "process_user_time": 1.647599, "process_kernel_time": 0.130385, "process_mem_max_rss": "93976", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m22:05:46.543170 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:46.543050 after 0.51 seconds
[0m22:05:46.543629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457f9bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457c3a6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457bcc50d0>]}
[0m22:05:46.544089 [debug] [MainThread]: Flushing usage events
[0m22:05:48.476627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8aa30a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab04fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8aa308e30>]}


============================== 22:05:48.479677 | 4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e ==============================
[0m22:05:48.479677 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:48.480428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:48.731862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a9683f20>]}
[0m22:05:48.793057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a96a85c0>]}
[0m22:05:48.795754 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:05:48.812761 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:48.813540 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:48.814084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a980c1a0>]}
[0m22:05:50.081709 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:50.082445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a25e1610>]}
[0m22:05:50.282323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:50.288206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a21409b0>]}
[0m22:05:50.462406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a20e2960>]}
[0m22:05:50.463078 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:50.463618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a21c6000>]}
[0m22:05:50.465528 [info ] [MainThread]: 
[0m22:05:50.466281 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:50.471292 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:50.509320 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:50.509836 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:50.510242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:51.021848 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:51.023637 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:51.025884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:51.026504 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:51.033990 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.034453 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:51.034890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:51.041800 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.043452 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.043872 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:51.044442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.044843 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.045226 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:51.046001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.047009 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:51.047426 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.047820 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:51.048399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.048823 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:51.051537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:51.057711 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:51.058145 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:51.058534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:51.064617 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.065034 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:51.065434 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:51.088886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.090582 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:51.091939 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:51.092389 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:51.096154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a0ce7c50>]}
[0m22:05:51.096711 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.097121 [debug] [MainThread]: On master: BEGIN
[0m22:05:51.097504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:51.104058 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.104491 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.104889 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.105273 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.105810 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.106221 [debug] [MainThread]: On master: Close
[0m22:05:51.107692 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:51.108225 [info ] [MainThread]: 
[0m22:05:51.117866 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:51.118465 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:51.119211 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:51.119658 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:51.147100 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:51.147852 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:51.182649 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:51.183493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:01.580276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.580818 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:01.581470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.581924 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.582361 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:01.583107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.586145 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.586608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:01.587381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.604120 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:01.604703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.605154 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:01.607440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.613060 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:01.613553 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:01.615120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.617654 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:01.647363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8aa30a8d0>]}
[0m22:06:01.648217 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.53s]
[0m22:06:01.649019 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:01.650088 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:01.650664 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:01.651335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:01.651803 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:01.657210 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:01.657898 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:01.692313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.692921 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241210220601686113"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:01.693421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:01.709164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.718703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.719246 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:01.719940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.720394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.720842 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241210220601686113'
      
      
      order by ordinal_position

  
[0m22:06:01.751283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.757297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.757839 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:01.761011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.769075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.769562 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:01.772489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.790676 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:01.791495 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.791978 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241210220601686113"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241210220601686113"
    )
  
[0m22:06:01.827847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.829895 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:01.830384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:01.830844 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:01.840393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:01.841306 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:02.538953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cdd6df8-576d-4fca-a7a6-7e75e4d9ba7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a25b0770>]}
[0m22:06:02.539798 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.89s]
[0m22:06:02.540652 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:02.542088 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:02.542566 [debug] [MainThread]: On master: BEGIN
[0m22:06:02.543054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:02.549641 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:02.550123 [debug] [MainThread]: On master: COMMIT
[0m22:06:02.550572 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:02.551048 [debug] [MainThread]: On master: COMMIT
[0m22:06:02.551634 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:02.552095 [debug] [MainThread]: On master: Close
[0m22:06:02.553582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:02.554022 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:02.554434 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:02.554961 [info ] [MainThread]: 
[0m22:06:02.555568 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.09 seconds (12.09s).
[0m22:06:02.556690 [debug] [MainThread]: Command end result
[0m22:06:02.585691 [info ] [MainThread]: 
[0m22:06:02.586427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:02.587041 [info ] [MainThread]: 
[0m22:06:02.587644 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:02.588738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.16253, "process_user_time": 6.840084, "process_kernel_time": 0.345215, "process_mem_max_rss": "363856", "process_in_blocks": "3880", "process_out_blocks": "135280"}
[0m22:06:02.589381 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:02.589271 after 14.16 seconds
[0m22:06:02.589885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe86570c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe864841b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe864841340>]}
[0m22:06:02.590380 [debug] [MainThread]: Flushing usage events
[0m22:06:04.682986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b612a3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b619e6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b61d4de20>]}


============================== 22:06:04.685933 | 6d17307e-5141-487f-b7e8-9749c51e5295 ==============================
[0m22:06:04.685933 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:04.686581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:04.848504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d17307e-5141-487f-b7e8-9749c51e5295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b61a3e4b0>]}
[0m22:06:04.865713 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.24734372, "process_user_time": 1.504636, "process_kernel_time": 0.127714, "process_mem_max_rss": "92204", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:04.866322 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:04.866208 after 0.25 seconds
[0m22:06:04.866774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b612a1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b6104c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b61c2a1b0>]}
[0m22:06:04.867266 [debug] [MainThread]: Flushing usage events
[0m06:02:27.166719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535ff8a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53622e9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535ff8a120>]}


============================== 06:02:27.173773 | f73bf1d4-4625-4b3d-8270-149a5937c253 ==============================
[0m06:02:27.173773 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.174433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.315030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f73bf1d4-4625-4b3d-8270-149a5937c253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535ff8a1b0>]}
[0m06:02:27.328581 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9gb8gufa'
[0m06:02:27.329034 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:27.463086 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:27.463854 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:27.501703 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:27.505610 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:27.887829 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:27.888408 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:27.888940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f73bf1d4-4625-4b3d-8270-149a5937c253', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535fc99e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535fc99010>]}
[0m06:02:27.889394 [info ] [MainThread]: 
[0m06:02:27.889865 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:27.891482 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7739681, "process_user_time": 1.6171, "process_kernel_time": 0.123778, "process_mem_max_rss": "93756", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m06:02:27.892076 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:27.891972 after 0.77 seconds
[0m06:02:27.892512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535ffd3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536182c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535fcc8e90>]}
[0m06:02:27.892937 [debug] [MainThread]: Flushing usage events
[0m06:02:29.688102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0bea9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0b5771a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0b5770b0>]}


============================== 06:02:29.690762 | c3c310d3-17fe-4d6c-bb05-5fdfed8ed352 ==============================
[0m06:02:29.690762 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.691430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.923671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0b39e4b0>]}
[0m06:02:29.982161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0c83dc70>]}
[0m06:02:29.984724 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:30.000338 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:30.001056 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:30.001589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0c5cd820>]}
[0m06:02:31.246645 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:31.247356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d041dc560>]}
[0m06:02:31.431286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:31.436689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cffc2a270>]}
[0m06:02:31.581614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cffcd95b0>]}
[0m06:02:31.582231 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:31.582763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cffdc1160>]}
[0m06:02:31.584663 [info ] [MainThread]: 
[0m06:02:31.585430 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:31.590499 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:31.628968 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:31.629527 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:31.629943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:32.400020 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:32.401617 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:32.404005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:32.404600 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:32.411836 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:32.412280 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:32.412679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:32.418940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:32.420450 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:32.420866 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:32.421470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:32.421876 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:32.422259 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:32.422862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:32.423823 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:32.424238 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:32.424643 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:32.425195 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:32.425604 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:32.427628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:32.433314 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:32.433731 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:32.434109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:32.440103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:32.440520 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:32.440920 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:32.463001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:32.464523 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:32.465749 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:32.466178 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:32.469595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cfe8dc260>]}
[0m06:02:32.470110 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.470503 [debug] [MainThread]: On master: BEGIN
[0m06:02:32.470869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:32.477152 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.477579 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.477963 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.478341 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.478867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.479297 [debug] [MainThread]: On master: Close
[0m06:02:32.480620 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:32.481151 [info ] [MainThread]: 
[0m06:02:32.490587 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:32.491182 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:32.491938 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:32.492389 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:32.519625 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:32.520380 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:32.555484 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:32.556224 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:45.499343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.499883 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:45.500539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.501001 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.501443 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:45.502172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.505276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.505737 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:45.506457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.522853 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:45.523391 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.523838 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:45.525366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.530637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.531107 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:45.532336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.534674 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:45.565911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc20e39b0>]}
[0m06:02:45.566732 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.07s]
[0m06:02:45.567558 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:45.568589 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:45.569154 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:45.569746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:45.570204 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:45.575674 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:45.576350 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:45.610123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:45.610643 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241211060245604206"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:45.611157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:45.626098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.634966 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:45.635462 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:45.636089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.636552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:45.636996 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241211060245604206'
      
      
      order by ordinal_position

  
[0m06:02:45.659087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.664248 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:45.664729 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:45.669182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.676727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:45.677208 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:45.681486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.699422 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:45.700347 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:45.701155 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241211060245604206"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241211060245604206"
    )
  
[0m06:02:45.739971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.742603 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:45.743240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:45.743967 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:45.773726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.774930 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:46.029899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c310d3-17fe-4d6c-bb05-5fdfed8ed352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cffd08b90>]}
[0m06:02:46.030733 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.46s]
[0m06:02:46.031518 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:46.032891 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:46.033417 [debug] [MainThread]: On master: BEGIN
[0m06:02:46.033899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:46.040549 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:46.041031 [debug] [MainThread]: On master: COMMIT
[0m06:02:46.041465 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:46.041887 [debug] [MainThread]: On master: COMMIT
[0m06:02:46.042452 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:46.042910 [debug] [MainThread]: On master: Close
[0m06:02:46.044260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:46.044704 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:46.045111 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:46.045569 [info ] [MainThread]: 
[0m06:02:46.046161 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.46 seconds (14.46s).
[0m06:02:46.047281 [debug] [MainThread]: Command end result
[0m06:02:46.076231 [info ] [MainThread]: 
[0m06:02:46.076913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:46.077494 [info ] [MainThread]: 
[0m06:02:46.078081 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:46.079156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.43968, "process_user_time": 5.304768, "process_kernel_time": 0.315569, "process_mem_max_rss": "302060", "process_in_blocks": "3880", "process_out_blocks": "117336"}
[0m06:02:46.079850 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:46.079737 after 16.44 seconds
[0m06:02:46.080339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0b97bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cfc223e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc1eaba10>]}
[0m06:02:46.080826 [debug] [MainThread]: Flushing usage events
[0m06:02:47.944664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9475327440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9476a5a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9476a5bbf0>]}


============================== 06:02:47.947587 | d29ffcc4-a783-4978-b353-8ce428979749 ==============================
[0m06:02:47.947587 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:47.948305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:48.097671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd29ffcc4-a783-4978-b353-8ce428979749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9476336bd0>]}
[0m06:02:48.114876 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22081445, "process_user_time": 1.403778, "process_kernel_time": 0.116313, "process_mem_max_rss": "92384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:48.115532 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:48.115422 after 0.22 seconds
[0m06:02:48.116002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9475869490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9475203f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94758a1ac0>]}
[0m06:02:48.116452 [debug] [MainThread]: Flushing usage events
[0m14:05:50.390141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e2377ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e1e9ce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e1e9fc20>]}


============================== 14:05:50.405204 | cf68f5ff-64bd-4810-b3b8-2af2e2b333bf ==============================
[0m14:05:50.405204 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:50.405914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:50.551193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf68f5ff-64bd-4810-b3b8-2af2e2b333bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e1af9fa0>]}
[0m14:05:50.564672 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2umwh29t'
[0m14:05:50.565142 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:50.637328 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:50.638079 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:50.677923 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:50.682000 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:51.065632 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:51.066232 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:51.066807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cf68f5ff-64bd-4810-b3b8-2af2e2b333bf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e196b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e1873d70>]}
[0m14:05:51.067280 [info ] [MainThread]: 
[0m14:05:51.067743 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:51.076681 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7356054, "process_user_time": 1.623413, "process_kernel_time": 0.116244, "process_mem_max_rss": "93804", "process_in_blocks": "6032", "process_out_blocks": "3992"}
[0m14:05:51.077390 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:51.077284 after 0.74 seconds
[0m14:05:51.077833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e27387a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e1af77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e19187a0>]}
[0m14:05:51.078282 [debug] [MainThread]: Flushing usage events
[0m14:05:52.887935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3505440f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3505187680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350541fd10>]}


============================== 14:05:52.890999 | d5931321-5f37-4cdf-9414-3beb61e821e9 ==============================
[0m14:05:52.890999 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:52.891682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:53.144628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3504f73e00>]}
[0m14:05:53.204490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3504f73b00>]}
[0m14:05:53.207166 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:53.231365 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:53.232153 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:53.232689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fde0fad0>]}
[0m14:05:54.466803 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:54.467481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fd9d9ee0>]}
[0m14:05:54.652340 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:54.657832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fd8074d0>]}
[0m14:05:54.796844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fd7a9160>]}
[0m14:05:54.797427 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:54.797906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fd719340>]}
[0m14:05:54.799668 [info ] [MainThread]: 
[0m14:05:54.800379 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:54.805126 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:54.842584 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:54.843146 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:54.843556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:55.275372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.276938 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:55.279207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:55.279786 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:55.287031 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:55.287514 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:55.287917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:55.294913 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.296569 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:55.296988 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:55.297563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.297969 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:55.298358 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:55.298975 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.299913 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:55.300333 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:55.300732 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:55.301334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.301771 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:55.304069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:55.310002 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:55.310430 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:55.310860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:55.316855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.317296 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:55.317700 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:55.342231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:55.343998 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:55.345278 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:55.345720 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:55.349806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fd7c82f0>]}
[0m14:05:55.350352 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:55.350748 [debug] [MainThread]: On master: BEGIN
[0m14:05:55.351174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:55.358179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:55.358669 [debug] [MainThread]: On master: COMMIT
[0m14:05:55.359124 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:55.359525 [debug] [MainThread]: On master: COMMIT
[0m14:05:55.360141 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:55.360563 [debug] [MainThread]: On master: Close
[0m14:05:55.362312 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:55.362895 [info ] [MainThread]: 
[0m14:05:55.380460 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:55.381125 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:55.381908 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:55.382371 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:55.410237 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:55.411162 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:55.447200 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:55.448117 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:08.301249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:08.301783 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:08.302515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.302999 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:08.303438 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:08.304223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.307240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:08.307701 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:08.308408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.325016 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:08.325566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:08.326007 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:08.328152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.333482 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:08.333960 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:06:08.335307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.337709 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:08.368415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35065423c0>]}
[0m14:06:08.369250 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.99s]
[0m14:06:08.370059 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:08.371101 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:08.371679 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:08.372305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:08.372771 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:08.378211 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:08.378937 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:08.413013 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:08.413607 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241211140608406960"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:08.414083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:08.429733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.439418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:08.439950 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:08.440672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.441128 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:08.441568 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241211140608406960'
      
      
      order by ordinal_position

  
[0m14:06:08.462832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.468726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:08.469247 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:08.472365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.480509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:08.481001 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:08.484322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.502692 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:08.503519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:08.504009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241211140608406960"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241211140608406960"
    )
  
[0m14:06:08.542606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.544649 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:08.545114 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:08.545546 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:08.553530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:08.554462 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:08.594171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5931321-5f37-4cdf-9414-3beb61e821e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34b7fcd7c0>]}
[0m14:06:08.595014 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.22s]
[0m14:06:08.595782 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:08.597200 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:08.597686 [debug] [MainThread]: On master: BEGIN
[0m14:06:08.598127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:08.604878 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:08.605362 [debug] [MainThread]: On master: COMMIT
[0m14:06:08.605800 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:08.606229 [debug] [MainThread]: On master: COMMIT
[0m14:06:08.606840 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:08.607303 [debug] [MainThread]: On master: Close
[0m14:06:08.608781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:08.609226 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:06:08.609639 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:08.610112 [info ] [MainThread]: 
[0m14:06:08.610705 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.81 seconds (13.81s).
[0m14:06:08.611864 [debug] [MainThread]: Command end result
[0m14:06:08.640936 [info ] [MainThread]: 
[0m14:06:08.641655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:08.642251 [info ] [MainThread]: 
[0m14:06:08.642878 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:08.643976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.806624, "process_user_time": 5.299197, "process_kernel_time": 0.361308, "process_mem_max_rss": "290956", "process_in_blocks": "3880", "process_out_blocks": "108616"}
[0m14:06:08.644632 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:08.644520 after 15.81 seconds
[0m14:06:08.645135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3505311610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fc03e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fc03c9e0>]}
[0m14:06:08.645627 [debug] [MainThread]: Flushing usage events
[0m14:06:10.527914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf8769b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf7bd8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf9b19fa0>]}


============================== 14:06:10.530886 | d8b09c61-996d-4564-aa63-1861477d7641 ==============================
[0m14:06:10.530886 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:10.531541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:10.674624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8b09c61-996d-4564-aa63-1861477d7641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf8109fd0>]}
[0m14:06:10.691175 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21317829, "process_user_time": 1.43451, "process_kernel_time": 0.091904, "process_mem_max_rss": "92300", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:10.691776 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:10.691671 after 0.21 seconds
[0m14:06:10.692212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf77d71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf761a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf783e180>]}
[0m14:06:10.692659 [debug] [MainThread]: Flushing usage events
[0m22:05:54.588599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0975c355b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0975c353d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0975c36930>]}


============================== 22:05:54.595877 | f3430e3b-eaac-4741-a63a-3f5faef1db34 ==============================
[0m22:05:54.595877 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.596608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.743322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3430e3b-eaac-4741-a63a-3f5faef1db34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0974b6bd40>]}
[0m22:05:54.756863 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sjbagwae'
[0m22:05:54.757359 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:55.022374 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:55.023147 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:55.058583 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:55.062701 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:55.420869 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:55.421457 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:55.421998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3430e3b-eaac-4741-a63a-3f5faef1db34', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0974d86570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0974bad4f0>]}
[0m22:05:55.422485 [info ] [MainThread]: 
[0m22:05:55.422974 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:55.432596 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8929536, "process_user_time": 1.587958, "process_kernel_time": 0.143274, "process_mem_max_rss": "93824", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m22:05:55.433269 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:55.433164 after 0.89 seconds
[0m22:05:55.433706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0974d86570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0974a81250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0974b4b890>]}
[0m22:05:55.434130 [debug] [MainThread]: Flushing usage events
[0m22:05:57.221339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4874297c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa485a07020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa485bcba40>]}


============================== 22:05:57.224162 | c8eb408a-5538-4b41-a376-ec05b5f25a19 ==============================
[0m22:05:57.224162 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:57.224842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.462275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa485843a70>]}
[0m22:05:57.522221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa485afba40>]}
[0m22:05:57.524881 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:05:57.572651 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:57.573456 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:57.573997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4858cfd10>]}
[0m22:05:58.821527 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:58.822197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47e3359a0>]}
[0m22:05:59.007093 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:59.012426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4858401a0>]}
[0m22:05:59.145246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47e2dd850>]}
[0m22:05:59.145888 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:59.146536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47e105250>]}
[0m22:05:59.148422 [info ] [MainThread]: 
[0m22:05:59.149123 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:59.153803 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:59.191115 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:59.191609 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:59.192011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:59.911433 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:59.913038 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:59.915201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:59.915766 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:59.922885 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.923330 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:59.923735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.930386 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.932000 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.932463 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:59.933075 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.933474 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.933857 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:59.934422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.935355 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.935794 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.936181 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.936769 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.937186 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:59.939494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:59.945467 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.945900 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:59.946279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.952374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.952805 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.953204 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:59.976846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.978485 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:59.979975 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:59.980439 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:59.984017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4870bd130>]}
[0m22:05:59.984587 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.984987 [debug] [MainThread]: On master: BEGIN
[0m22:05:59.985354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:00.007404 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:00.007927 [debug] [MainThread]: On master: COMMIT
[0m22:06:00.008369 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:00.008757 [debug] [MainThread]: On master: COMMIT
[0m22:06:00.009285 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:00.009696 [debug] [MainThread]: On master: Close
[0m22:06:00.011747 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:00.012498 [info ] [MainThread]: 
[0m22:06:00.031045 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:00.032013 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:00.032984 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:00.033697 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:00.078576 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:00.079809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:00.124970 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:00.125851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:11.317731 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.318256 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:11.318902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.319382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.319828 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:11.320589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.323529 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.323984 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:11.324706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.341184 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:11.341674 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.342112 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:11.343555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.348689 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:11.349160 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:11.350619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.353004 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:11.383782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47e2a51c0>]}
[0m22:06:11.384603 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.35s]
[0m22:06:11.385379 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:11.386350 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:11.386908 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:11.387512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:11.387961 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:11.393253 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:11.393926 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:11.427754 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.428357 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241211220611421756"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:11.428875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:11.443900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.453478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.453995 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:11.454677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.455129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.455567 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241211220611421756'
      
      
      order by ordinal_position

  
[0m22:06:11.476747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.482525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.483027 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:11.486319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.494291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.494778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:11.497656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.515910 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:11.516714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.517200 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241211220611421756"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241211220611421756"
    )
  
[0m22:06:11.556759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.558771 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:11.559229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:11.559658 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:11.567321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:11.568297 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:11.612509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8eb408a-5538-4b41-a376-ec05b5f25a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa44433ddc0>]}
[0m22:06:11.613314 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.22s]
[0m22:06:11.614165 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:11.615608 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:11.616123 [debug] [MainThread]: On master: BEGIN
[0m22:06:11.616629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:11.623520 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:11.624050 [debug] [MainThread]: On master: COMMIT
[0m22:06:11.624548 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:11.624984 [debug] [MainThread]: On master: COMMIT
[0m22:06:11.625568 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:11.626023 [debug] [MainThread]: On master: Close
[0m22:06:11.627617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:11.628057 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:11.628519 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:11.628991 [info ] [MainThread]: 
[0m22:06:11.629530 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.48 seconds (12.48s).
[0m22:06:11.630549 [debug] [MainThread]: Command end result
[0m22:06:11.659470 [info ] [MainThread]: 
[0m22:06:11.660170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:11.660702 [info ] [MainThread]: 
[0m22:06:11.661226 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:11.662258 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.490788, "process_user_time": 5.644466, "process_kernel_time": 0.32048, "process_mem_max_rss": "284496", "process_in_blocks": "3880", "process_out_blocks": "108656"}
[0m22:06:11.662922 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:11.662802 after 14.49 seconds
[0m22:06:11.663432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4895bbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa457f4a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47cd8ca40>]}
[0m22:06:11.663923 [debug] [MainThread]: Flushing usage events
[0m22:06:13.555286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f949dc7b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f949e51c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f949ff99e80>]}


============================== 22:06:13.558206 | 7b2716c0-67e3-4612-85ae-a837402ded55 ==============================
[0m22:06:13.558206 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:13.558925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:13.705277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b2716c0-67e3-4612-85ae-a837402ded55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f949da7ca40>]}
[0m22:06:13.721979 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21665287, "process_user_time": 1.442927, "process_kernel_time": 0.087934, "process_mem_max_rss": "92532", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:13.722565 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:13.722461 after 0.22 seconds
[0m22:06:13.723003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f949e0a3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f949dc79a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f949dabff50>]}
[0m22:06:13.723437 [debug] [MainThread]: Flushing usage events
[0m06:02:14.612421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aba03df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aba46cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aba407ec0>]}


============================== 06:02:14.620214 | 74058669-6a6b-42f6-b9eb-5c0f91d154a8 ==============================
[0m06:02:14.620214 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.620948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.767082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74058669-6a6b-42f6-b9eb-5c0f91d154a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8abb52df10>]}
[0m06:02:14.780494 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fsstwj88'
[0m06:02:14.780954 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.884579 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.885318 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.896500 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.900391 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:15.037759 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:15.038336 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:15.038851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '74058669-6a6b-42f6-b9eb-5c0f91d154a8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aba15d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ab9e652b0>]}
[0m06:02:15.039328 [info ] [MainThread]: 
[0m06:02:15.039779 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:15.041799 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4788494, "process_user_time": 1.609821, "process_kernel_time": 0.149656, "process_mem_max_rss": "93804", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m06:02:15.042429 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:15.042321 after 0.48 seconds
[0m06:02:15.042905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aba8fb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8abaf50110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8abacdbf80>]}
[0m06:02:15.043346 [debug] [MainThread]: Flushing usage events
[0m06:02:16.681877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce899af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce946e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcceacc6060>]}


============================== 06:02:16.684784 | a5bd8c0e-3acb-4017-8013-c121568c875c ==============================
[0m06:02:16.684784 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.685452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.922778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce8783fe0>]}
[0m06:02:16.983166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce928fcb0>]}
[0m06:02:16.985862 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:17.002110 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:17.002848 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:17.003392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce8cb7d10>]}
[0m06:02:18.261845 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:18.262499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce151a300>]}
[0m06:02:18.448690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:18.454000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce1037260>]}
[0m06:02:18.614971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce15a7d70>]}
[0m06:02:18.615581 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:18.616136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce0f1d3d0>]}
[0m06:02:18.618022 [info ] [MainThread]: 
[0m06:02:18.618809 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.623998 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.662154 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.662687 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:18.663099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:19.036465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.038077 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:19.040331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:19.040905 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:19.048072 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.048513 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:19.048911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.055438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.056972 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.057379 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:19.057964 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.058362 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.058740 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:19.059326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.060240 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.060650 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.061031 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.061597 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.062028 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:19.064115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:19.069856 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.070273 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:19.070647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.076556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.076970 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.077363 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:19.101172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.102715 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:19.103933 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:19.104354 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:19.107861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce0fb97c0>]}
[0m06:02:19.108393 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.108807 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.109187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:19.115588 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.116014 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.116406 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.116782 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.117362 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.117805 [debug] [MainThread]: On master: Close
[0m06:02:19.119170 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:19.119659 [info ] [MainThread]: 
[0m06:02:19.129281 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:19.129937 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:19.130596 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:19.131041 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:19.159128 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:19.160000 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:19.195909 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:19.196803 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:26.239044 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.239577 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:26.240243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.240700 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.241138 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:26.241923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.244832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.245293 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:26.246033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.262636 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.263116 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.263571 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:26.264630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.269687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:26.270162 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:26.271575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.273935 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:26.306135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca4977440>]}
[0m06:02:26.306970 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.17s]
[0m06:02:26.307747 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:26.308778 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:26.309349 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:26.309976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:26.310439 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:26.315823 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:26.316504 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:26.350877 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.351469 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241212060226344796"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:26.351937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:26.366537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.376003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.376510 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:26.377182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.377654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.378098 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241212060226344796'
      
      
      order by ordinal_position

  
[0m06:02:26.399480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.405519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.406045 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.409041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.416993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.417492 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:26.420747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.438914 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:26.439663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.440138 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241212060226344796"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241212060226344796"
    )
  
[0m06:02:26.478830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.480847 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:26.481324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:26.481790 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:26.490098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:26.491067 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:26.542873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5bd8c0e-3acb-4017-8013-c121568c875c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcca48246b0>]}
[0m06:02:26.543698 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.23s]
[0m06:02:26.544446 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:26.545959 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.546441 [debug] [MainThread]: On master: BEGIN
[0m06:02:26.546878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:26.553688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.554179 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.554617 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:26.555037 [debug] [MainThread]: On master: COMMIT
[0m06:02:26.555682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:26.556144 [debug] [MainThread]: On master: Close
[0m06:02:26.557888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:26.558351 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:26.558764 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:26.559244 [info ] [MainThread]: 
[0m06:02:26.559772 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m06:02:26.560795 [debug] [MainThread]: Command end result
[0m06:02:26.589793 [info ] [MainThread]: 
[0m06:02:26.590525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:26.591035 [info ] [MainThread]: 
[0m06:02:26.591556 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:26.592581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.960958, "process_user_time": 5.315616, "process_kernel_time": 0.3252, "process_mem_max_rss": "296164", "process_in_blocks": "3880", "process_out_blocks": "109136"}
[0m06:02:26.593228 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:26.593118 after 9.96 seconds
[0m06:02:26.593763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce899b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce890d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc9f8c9190>]}
[0m06:02:26.594259 [debug] [MainThread]: Flushing usage events
[0m06:02:28.359341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b7902330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b73e7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b709b470>]}


============================== 06:02:28.362358 | cc09aea1-8466-40ad-a35b-cbbf8dcabf40 ==============================
[0m06:02:28.362358 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:28.363142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:28.513513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc09aea1-8466-40ad-a35b-cbbf8dcabf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b6fe6180>]}
[0m06:02:28.530743 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22133318, "process_user_time": 1.440572, "process_kernel_time": 0.104041, "process_mem_max_rss": "92412", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:28.531340 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:28.531236 after 0.22 seconds
[0m06:02:28.531780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b6de7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b6ec05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b7f18200>]}
[0m06:02:28.532223 [debug] [MainThread]: Flushing usage events
[0m14:05:32.282898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09863faae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0986b46f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0985c4f560>]}


============================== 14:05:32.290721 | 70644d96-5fa1-45b9-b0e6-622c97d93765 ==============================
[0m14:05:32.290721 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.291440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.442529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70644d96-5fa1-45b9-b0e6-622c97d93765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0985a3bbf0>]}
[0m14:05:32.457107 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1q5h0ic7'
[0m14:05:32.457649 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:32.484897 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:32.485651 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:32.496053 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:32.500205 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:32.714882 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:32.715486 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:32.716038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '70644d96-5fa1-45b9-b0e6-622c97d93765', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09869329f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0985c4dd60>]}
[0m14:05:32.716503 [info ] [MainThread]: 
[0m14:05:32.716984 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:32.718444 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48588157, "process_user_time": 1.605657, "process_kernel_time": 0.180636, "process_mem_max_rss": "93832", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m14:05:32.719059 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:32.718952 after 0.49 seconds
[0m14:05:32.719493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09895d4c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09869329f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0985a585c0>]}
[0m14:05:32.719927 [debug] [MainThread]: Flushing usage events
[0m14:05:34.527214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc7036e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fd58a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc703440>]}


============================== 14:05:34.530129 | 17a18bb4-2646-4665-a383-787d50c6ba0d ==============================
[0m14:05:34.530129 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:34.530791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:34.778256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc782d50>]}
[0m14:05:34.839784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fdebd070>]}
[0m14:05:34.842416 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:34.857941 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:34.858681 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:34.859214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc6cad80>]}
[0m14:05:36.113442 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:36.114126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f5172ae0>]}
[0m14:05:36.299597 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:36.305006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f55026f0>]}
[0m14:05:36.463023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f50a4b60>]}
[0m14:05:36.463612 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:36.464117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f50d8fe0>]}
[0m14:05:36.465927 [info ] [MainThread]: 
[0m14:05:36.466688 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:36.471968 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:36.510057 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:36.510604 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:36.511039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:36.958455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.960064 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:36.962445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:36.963040 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:36.970325 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:36.970782 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:36.971183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:36.977727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.979320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:36.979767 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:36.980344 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.980782 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:36.981169 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:36.981776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.982760 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:36.983173 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:36.983554 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:36.984096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.984510 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:36.986693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:36.992502 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:36.992922 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:36.993298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:36.999393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:36.999820 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:37.000221 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:37.024073 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:37.025792 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:37.027139 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:37.027569 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:37.031445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f4fb2330>]}
[0m14:05:37.031983 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:37.032385 [debug] [MainThread]: On master: BEGIN
[0m14:05:37.032759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:37.039332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:37.039786 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.040182 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:37.040561 [debug] [MainThread]: On master: COMMIT
[0m14:05:37.041083 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:37.041496 [debug] [MainThread]: On master: Close
[0m14:05:37.042987 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:37.043508 [info ] [MainThread]: 
[0m14:05:37.053028 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:37.053647 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:37.054412 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:37.054869 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:37.083230 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:37.084077 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:37.119597 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:37.120521 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:46.497603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:46.498163 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:46.498839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.499295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:46.499733 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:46.500517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.503516 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:46.503981 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:46.504668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.521077 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:46.521591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:46.522060 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:46.523273 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.528416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:46.528883 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:46.530143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.532490 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:46.562967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1af9b9e80>]}
[0m14:05:46.563861 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.51s]
[0m14:05:46.564664 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:46.565730 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:46.566338 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:46.566968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:46.567542 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:46.573018 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:46.573705 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:46.607411 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:46.607968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241212140546601450"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:46.608442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:46.623608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.632888 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:46.633400 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:46.634124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.634574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:46.635016 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241212140546601450'
      
      
      order by ordinal_position

  
[0m14:05:46.657358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.662805 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:46.663307 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:46.666167 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.673959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:46.674449 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:46.677292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.695152 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:46.695901 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:46.696372 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241212140546601450"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241212140546601450"
    )
  
[0m14:05:46.736162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.738190 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:46.738665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:46.739098 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:46.746793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:46.747779 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:46.803917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a18bb4-2646-4665-a383-787d50c6ba0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b4977cb0>]}
[0m14:05:46.804751 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.24s]
[0m14:05:46.805588 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:46.807085 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.807563 [debug] [MainThread]: On master: BEGIN
[0m14:05:46.808007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:46.814974 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.815491 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.815937 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.816368 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.816956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.817416 [debug] [MainThread]: On master: Close
[0m14:05:46.819159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:46.819599 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:46.820005 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:46.820472 [info ] [MainThread]: 
[0m14:05:46.821072 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.35 seconds (10.35s).
[0m14:05:46.822265 [debug] [MainThread]: Command end result
[0m14:05:46.851825 [info ] [MainThread]: 
[0m14:05:46.852596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:46.853191 [info ] [MainThread]: 
[0m14:05:46.853789 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:46.854946 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.377214, "process_user_time": 5.399707, "process_kernel_time": 0.334742, "process_mem_max_rss": "294544", "process_in_blocks": "3880", "process_out_blocks": "109136"}
[0m14:05:46.855591 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:46.855481 after 12.38 seconds
[0m14:05:46.856091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fcc138f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f512a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1af855430>]}
[0m14:05:46.856608 [debug] [MainThread]: Flushing usage events
[0m14:05:48.856217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8a522750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8af821b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8c381df0>]}


============================== 14:05:48.859337 | b9645009-b782-4d22-98e1-2a78c8a99813 ==============================
[0m14:05:48.859337 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:48.860245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:49.014930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9645009-b782-4d22-98e1-2a78c8a99813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8af20200>]}
[0m14:05:49.032599 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22723693, "process_user_time": 1.477728, "process_kernel_time": 0.087864, "process_mem_max_rss": "92632", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:49.033214 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:49.033105 after 0.23 seconds
[0m14:05:49.033682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8b0feed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c89fc6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c8aa93440>]}
[0m14:05:49.034182 [debug] [MainThread]: Flushing usage events
[0m22:06:04.753912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88cce40950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88cd2a6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88cf1a1e50>]}


============================== 22:06:04.778621 | 1a1e688a-c600-4f88-88ff-4eefb30f34a6 ==============================
[0m22:06:04.778621 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:04.779325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:04.935913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a1e688a-c600-4f88-88ff-4eefb30f34a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ce505c70>]}
[0m22:06:04.950584 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2tzicu4g'
[0m22:06:04.951128 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:05.055179 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:05.056012 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:05.078940 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:05.083125 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:05.159082 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:05.159725 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:05.160290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1a1e688a-c600-4f88-88ff-4eefb30f34a6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ccc4eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ccb81340>]}
[0m22:06:05.160771 [info ] [MainThread]: 
[0m22:06:05.161268 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:05.171632 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46748045, "process_user_time": 1.666841, "process_kernel_time": 0.119344, "process_mem_max_rss": "93812", "process_in_blocks": "6032", "process_out_blocks": "4000"}
[0m22:06:05.172340 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:05.172227 after 0.47 seconds
[0m22:06:05.172821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88cd1e2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ccb90f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ccfb98b0>]}
[0m22:06:05.173284 [debug] [MainThread]: Flushing usage events
[0m22:06:06.851140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d76b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2dddd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2dddc4a0>]}


============================== 22:06:06.854070 | 5bbc751c-10ab-4d01-99c5-de29a70d995c ==============================
[0m22:06:06.854070 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:06.854726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:07.103805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d72f7d0>]}
[0m22:06:07.164443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec26638320>]}
[0m22:06:07.167180 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:06:07.193775 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:07.194620 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:07.195187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec266638f0>]}
[0m22:06:08.454404 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:08.455105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec26043260>]}
[0m22:06:08.642604 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:08.648180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec26009820>]}
[0m22:06:08.790088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec25fd9c40>]}
[0m22:06:08.790730 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:06:08.791236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2dc19d90>]}
[0m22:06:08.793022 [info ] [MainThread]: 
[0m22:06:08.793767 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:08.798802 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:08.836338 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:08.836841 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:08.837248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:09.309096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.310693 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:09.312922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:09.313481 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:09.320697 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:09.321138 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:09.321538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:09.328166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.329775 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:09.330189 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:09.330796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.331198 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:09.331580 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:09.332194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.333139 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:09.333539 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:09.333921 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:09.334531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.334952 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:09.337208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:09.343180 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:09.343603 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:09.343980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:09.350013 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.350476 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:09.350902 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:09.374731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:09.376416 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:09.377680 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:09.378091 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:09.382012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24bf6960>]}
[0m22:06:09.382616 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:09.383029 [debug] [MainThread]: On master: BEGIN
[0m22:06:09.383415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:09.390254 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:09.390741 [debug] [MainThread]: On master: COMMIT
[0m22:06:09.391142 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:09.391525 [debug] [MainThread]: On master: COMMIT
[0m22:06:09.392150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:09.392563 [debug] [MainThread]: On master: Close
[0m22:06:09.394206 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:09.394774 [info ] [MainThread]: 
[0m22:06:09.404649 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:09.405296 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:09.406051 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:09.406551 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:09.434908 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:09.435793 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:09.471397 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:09.472273 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:16.308486 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.309124 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:16.310054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.310603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.311106 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:16.312127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.315607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.316082 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:16.316847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.333950 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:16.334532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.334996 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:16.337100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.342546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.343030 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:16.344319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.346819 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:16.377491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec24bbe120>]}
[0m22:06:16.378331 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.97s]
[0m22:06:16.379251 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:16.380300 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:16.380882 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:16.381557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:16.382021 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:16.387587 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:16.388305 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:16.422820 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.423424 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241212220616416723"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:16.423905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:16.439486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.449170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.449686 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:16.450374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.450868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.451310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241212220616416723'
      
      
      order by ordinal_position

  
[0m22:06:16.472532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.478597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.479126 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:16.482272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.491010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.491560 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:16.495021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.513554 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:16.514357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.514879 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241212220616416723"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241212220616416723"
    )
  
[0m22:06:16.554991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.557060 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:16.557535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.557968 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:16.565453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.566437 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:16.629117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bbc751c-10ab-4d01-99c5-de29a70d995c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec07fbbf80>]}
[0m22:06:16.629972 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.25s]
[0m22:06:16.630858 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:16.632381 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.632931 [debug] [MainThread]: On master: BEGIN
[0m22:06:16.633372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:16.640545 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.641072 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.641519 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.641948 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.642552 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.643017 [debug] [MainThread]: On master: Close
[0m22:06:16.645070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:16.645526 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:16.645942 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:16.646435 [info ] [MainThread]: 
[0m22:06:16.647066 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.85 seconds (7.85s).
[0m22:06:16.648116 [debug] [MainThread]: Command end result
[0m22:06:16.677823 [info ] [MainThread]: 
[0m22:06:16.678542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:16.679056 [info ] [MainThread]: 
[0m22:06:16.679578 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:16.680600 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.880029, "process_user_time": 5.449708, "process_kernel_time": 0.365698, "process_mem_max_rss": "293964", "process_in_blocks": "3880", "process_out_blocks": "109680"}
[0m22:06:16.681254 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:16.681145 after 9.88 seconds
[0m22:06:16.681752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2dddc4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec26010a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe084a300>]}
[0m22:06:16.682242 [debug] [MainThread]: Flushing usage events
[0m22:06:18.473701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc6b32d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc6421fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc867db50>]}


============================== 22:06:18.476663 | 1f9eb49e-cbc2-415b-ba56-9c8e39634229 ==============================
[0m22:06:18.476663 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.477391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.633509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f9eb49e-cbc2-415b-ba56-9c8e39634229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc7218080>]}
[0m22:06:18.651153 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22754985, "process_user_time": 1.492845, "process_kernel_time": 0.067856, "process_mem_max_rss": "92544", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:18.651761 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:18.651657 after 0.23 seconds
[0m22:06:18.652223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc6b32d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc60e7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc66120c0>]}
[0m22:06:18.652679 [debug] [MainThread]: Flushing usage events
[0m06:02:19.771270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb117145b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb114f9f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1156ab500>]}


============================== 06:02:19.808397 | 0f0fb432-106d-4e2b-ab4a-61e15653a65e ==============================
[0m06:02:19.808397 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.809052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:19.946957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f0fb432-106d-4e2b-ab4a-61e15653a65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1164c1f10>]}
[0m06:02:19.960238 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-va83j3wi'
[0m06:02:19.960695 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:20.055424 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:20.056044 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:20.067236 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:20.071012 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:20.208529 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:20.209036 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:20.209551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0f0fb432-106d-4e2b-ab4a-61e15653a65e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb114b2e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb114f651c0>]}
[0m06:02:20.210016 [info ] [MainThread]: 
[0m06:02:20.210499 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:20.239490 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5171012, "process_user_time": 1.540848, "process_kernel_time": 0.1549, "process_mem_max_rss": "93900", "process_in_blocks": "5792", "process_out_blocks": "4000"}
[0m06:02:20.240220 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:20.240106 after 0.52 seconds
[0m06:02:20.240664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb114f2e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb114bf78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb114b28890>]}
[0m06:02:20.241102 [debug] [MainThread]: Flushing usage events
[0m06:02:21.878311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde27dcd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde27ed8e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde27d3f710>]}


============================== 06:02:21.881320 | 05d595a6-57aa-437f-98df-a01af1e9a4eb ==============================
[0m06:02:21.881320 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.881983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.125221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde27ba8a10>]}
[0m06:02:22.188030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde28706240>]}
[0m06:02:22.190572 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:22.217023 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:22.217735 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:22.218273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde27b5c620>]}
[0m06:02:23.469363 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:23.470038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde209aa660>]}
[0m06:02:23.664580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:23.670570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde209f82f0>]}
[0m06:02:23.829515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde209a8ad0>]}
[0m06:02:23.830119 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:23.830611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde27dcc470>]}
[0m06:02:23.832373 [info ] [MainThread]: 
[0m06:02:23.833056 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:23.838116 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:23.875535 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:23.876053 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:23.876471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:24.189040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.190616 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:24.192859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:24.193422 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:24.200521 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:24.200957 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:24.201351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:24.207476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.208893 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:24.209304 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:24.209904 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.210310 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:24.210695 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:24.211358 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.212285 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:24.212701 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:24.213085 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:24.213627 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.214035 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:24.215959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:24.221616 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:24.222040 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:24.222421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:24.228284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.228725 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:24.229133 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:24.252217 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:24.253824 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:24.255117 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:24.255531 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:24.259171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde203a8200>]}
[0m06:02:24.259727 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.260148 [debug] [MainThread]: On master: BEGIN
[0m06:02:24.260539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:24.267032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.267476 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.267885 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.268274 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.268819 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.269234 [debug] [MainThread]: On master: Close
[0m06:02:24.270981 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:24.271484 [info ] [MainThread]: 
[0m06:02:24.303256 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:24.303964 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:24.304691 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:24.305163 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:24.333368 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:24.334151 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:24.369560 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:24.370330 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:31.916577 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.917093 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:31.917723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.918188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.918634 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:31.919380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.922248 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.922711 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:31.923727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.952480 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:31.953353 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.954111 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:31.972239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:31.980228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:31.980804 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:31.999326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.002714 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:32.061775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde209a9790>]}
[0m06:02:32.062565 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.76s]
[0m06:02:32.063495 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:32.064508 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:32.065097 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:32.065770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:32.066273 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:32.071538 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:32.072203 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:32.106047 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.106561 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241213060232100016"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:32.107086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:32.120876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.129621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.130098 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:32.130715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.131201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.131650 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241213060232100016'
      
      
      order by ordinal_position

  
[0m06:02:32.151844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.156918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.157407 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.160523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.168196 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.168687 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:32.172997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.190839 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:32.191542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.192025 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241213060232100016"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241213060232100016"
    )
  
[0m06:02:32.229053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.231100 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.231573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:32.232011 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:32.241098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:32.242042 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:32.307156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05d595a6-57aa-437f-98df-a01af1e9a4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd6ed70e0>]}
[0m06:02:32.307926 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.24s]
[0m06:02:32.308693 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:32.310233 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.310753 [debug] [MainThread]: On master: BEGIN
[0m06:02:32.311218 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:32.317963 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.318461 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.318963 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:32.319410 [debug] [MainThread]: On master: COMMIT
[0m06:02:32.320069 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:32.320543 [debug] [MainThread]: On master: Close
[0m06:02:32.322043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:32.322491 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:32.322962 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:32.323438 [info ] [MainThread]: 
[0m06:02:32.323974 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m06:02:32.324984 [debug] [MainThread]: Command end result
[0m06:02:32.354055 [info ] [MainThread]: 
[0m06:02:32.354695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:32.355228 [info ] [MainThread]: 
[0m06:02:32.355748 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:32.356754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.528186, "process_user_time": 5.245637, "process_kernel_time": 0.351573, "process_mem_max_rss": "295348", "process_in_blocks": "3896", "process_out_blocks": "110176"}
[0m06:02:32.357409 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:32.357298 after 10.53 seconds
[0m06:02:32.357909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde281f0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde28538f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd6d09370>]}
[0m06:02:32.358406 [debug] [MainThread]: Flushing usage events
[0m06:02:34.011117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ee3dd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86eebea450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86eebe9a60>]}


============================== 06:02:34.013991 | 816404a1-afe8-4adf-b520-c2d561ffdae9 ==============================
[0m06:02:34.013991 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:34.014644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:34.153342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '816404a1-afe8-4adf-b520-c2d561ffdae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ef863560>]}
[0m06:02:34.169347 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20764634, "process_user_time": 1.418555, "process_kernel_time": 0.076137, "process_mem_max_rss": "92584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:34.169914 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:34.169812 after 0.21 seconds
[0m06:02:34.170347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ee68b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ee48ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ee051e20>]}
[0m06:02:34.170811 [debug] [MainThread]: Flushing usage events
[0m14:05:41.695880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202fa9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82043bddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8205036e40>]}


============================== 14:05:41.731156 | a734d4ff-51d7-45b0-a126-85ebe686ce9b ==============================
[0m14:05:41.731156 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.731853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.887607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a734d4ff-51d7-45b0-a126-85ebe686ce9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202bf4350>]}
[0m14:05:41.902015 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-43lfkkoi'
[0m14:05:41.902551 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:41.957927 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:41.958740 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:41.993782 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:41.997875 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:42.382806 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:42.383416 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:42.383975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a734d4ff-51d7-45b0-a126-85ebe686ce9b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203951970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202bf6870>]}
[0m14:05:42.384483 [info ] [MainThread]: 
[0m14:05:42.384986 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:42.386749 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.74139225, "process_user_time": 1.676195, "process_kernel_time": 0.148017, "process_mem_max_rss": "94032", "process_in_blocks": "5792", "process_out_blocks": "4008"}
[0m14:05:42.387364 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:42.387259 after 0.74 seconds
[0m14:05:42.387817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202bf6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202b845f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203726de0>]}
[0m14:05:42.388262 [debug] [MainThread]: Flushing usage events
[0m14:05:44.256927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbb6e9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd718620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbb432600>]}


============================== 14:05:44.260331 | 018ab194-17f3-4399-80fe-d1175a500920 ==============================
[0m14:05:44.260331 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:44.261093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:44.514189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecba865d60>]}
[0m14:05:44.574711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb39b4890>]}
[0m14:05:44.577492 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:44.593858 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:44.594683 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:44.595258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbb3fc620>]}
[0m14:05:45.852513 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:45.853203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb33a8bc0>]}
[0m14:05:46.038997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:46.044562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb31138f0>]}
[0m14:05:46.184773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb31e91f0>]}
[0m14:05:46.185412 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:46.185973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb33f9e20>]}
[0m14:05:46.187916 [info ] [MainThread]: 
[0m14:05:46.188682 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:46.193866 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:46.231585 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:46.232105 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:46.232517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:46.631960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.633584 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:46.635925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:46.636501 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:46.643733 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:46.644176 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:46.644575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:46.651020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.652547 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:46.652959 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:46.653617 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.654024 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:46.654407 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:46.655030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.655952 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:46.656366 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:46.656744 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:46.657303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.657718 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:46.659874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:46.665758 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:46.666177 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:46.666564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:46.672739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.673164 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:46.673606 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:46.698954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.700749 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:46.702115 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:46.702564 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:46.706604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb3185bb0>]}
[0m14:05:46.707192 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.707608 [debug] [MainThread]: On master: BEGIN
[0m14:05:46.707996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:46.714649 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.715093 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.715494 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.715880 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.716470 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.716897 [debug] [MainThread]: On master: Close
[0m14:05:46.718527 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:46.719076 [info ] [MainThread]: 
[0m14:05:46.731171 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:46.731867 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:46.732645 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:46.733111 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:46.761263 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:46.762153 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:46.797583 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:46.798492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:58.772549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.773111 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:58.773879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.774344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.774788 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:58.775564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.778874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.779343 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:58.780073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.796978 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:58.797583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.798042 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:58.800017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.805466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:58.805942 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:58.807259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.809741 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:58.839833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb006d0d0>]}
[0m14:05:58.840670 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.11s]
[0m14:05:58.841525 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:58.842584 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:58.843186 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:58.843875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:58.844341 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:58.849853 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:58.850547 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:58.885200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.885831 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241213140558879027"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:58.886328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:58.901316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.911325 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.911873 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:58.912632 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.913092 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.913569 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241213140558879027'
      
      
      order by ordinal_position

  
[0m14:05:58.936293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.942341 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.942870 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:58.945965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.954245 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.954763 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:58.958067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:58.976500 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:58.977374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:58.977891 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241213140558879027"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241213140558879027"
    )
  
[0m14:05:59.013052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:59.015125 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:59.015603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:59.016039 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:59.024410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:59.025438 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:59.101947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '018ab194-17f3-4399-80fe-d1175a500920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec76a01010>]}
[0m14:05:59.102796 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m14:05:59.103659 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:59.105267 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:59.105772 [debug] [MainThread]: On master: BEGIN
[0m14:05:59.106218 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:59.113376 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:59.113922 [debug] [MainThread]: On master: COMMIT
[0m14:05:59.114374 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:59.114820 [debug] [MainThread]: On master: COMMIT
[0m14:05:59.115413 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:59.115881 [debug] [MainThread]: On master: Close
[0m14:05:59.117764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:59.118220 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:59.118635 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:59.119139 [info ] [MainThread]: 
[0m14:05:59.119715 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.93 seconds (12.93s).
[0m14:05:59.120799 [debug] [MainThread]: Command end result
[0m14:05:59.151105 [info ] [MainThread]: 
[0m14:05:59.151853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:59.152401 [info ] [MainThread]: 
[0m14:05:59.152964 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:59.154064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.948999, "process_user_time": 5.485287, "process_kernel_time": 0.292068, "process_mem_max_rss": "287052", "process_in_blocks": "3896", "process_out_blocks": "110168"}
[0m14:05:59.154728 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:59.154615 after 14.95 seconds
[0m14:05:59.155241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbaafa3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbde26990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec759039b0>]}
[0m14:05:59.155741 [debug] [MainThread]: Flushing usage events
[0m14:06:01.210659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb51a52f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb519c109e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb519c12210>]}


============================== 14:06:01.213929 | f806f101-0416-4253-9372-33a3152f9c94 ==============================
[0m14:06:01.213929 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:01.214585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:01.367646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f806f101-0416-4253-9372-33a3152f9c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb51ab5f350>]}
[0m14:06:01.384851 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22468102, "process_user_time": 1.524244, "process_kernel_time": 0.088245, "process_mem_max_rss": "92292", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:06:01.385505 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:01.385387 after 0.23 seconds
[0m14:06:01.385978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb519c12210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb519447950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb51ab5f350>]}
[0m14:06:01.386444 [debug] [MainThread]: Flushing usage events
[0m22:05:37.267329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f54f2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f54f29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f54f24e0>]}


============================== 22:05:37.275421 | 57336e6b-09a8-4905-ae74-b84fc3f6409b ==============================
[0m22:05:37.275421 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.276136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.414938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57336e6b-09a8-4905-ae74-b84fc3f6409b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f5171d00>]}
[0m22:05:37.428264 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bzye8d8l'
[0m22:05:37.428763 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:37.494397 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:37.495074 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:37.519305 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:37.523066 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:37.596881 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:37.597392 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:37.597894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '57336e6b-09a8-4905-ae74-b84fc3f6409b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f4be5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f4be66c0>]}
[0m22:05:37.598352 [info ] [MainThread]: 
[0m22:05:37.598858 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:37.600470 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38218978, "process_user_time": 1.548448, "process_kernel_time": 0.137102, "process_mem_max_rss": "93532", "process_in_blocks": "5792", "process_out_blocks": "4008"}
[0m22:05:37.601070 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:37.600966 after 0.38 seconds
[0m22:05:37.601528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f4d85f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f4aac8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f4b27d40>]}
[0m22:05:37.601961 [debug] [MainThread]: Flushing usage events
[0m22:05:39.159764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07db379880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07db347e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07db5746b0>]}


============================== 22:05:39.162879 | b5513116-0a66-488b-96e3-31b2fa05fc06 ==============================
[0m22:05:39.162879 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:39.163542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:39.398773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07dae49460>]}
[0m22:05:39.456785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07dadf9250>]}
[0m22:05:39.459281 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m22:05:39.474646 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:39.475419 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:39.475967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07daeb64b0>]}
[0m22:05:40.709361 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:40.710021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d3e4d610>]}
[0m22:05:40.891632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:40.896681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d3dcdf70>]}
[0m22:05:41.024416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d37f59d0>]}
[0m22:05:41.025009 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:41.025508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d39fda90>]}
[0m22:05:41.027242 [info ] [MainThread]: 
[0m22:05:41.027954 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:41.032872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:41.071303 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:41.071805 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:41.072213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:41.663540 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:41.665137 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:41.667277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:41.667839 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:41.674918 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.675353 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:41.675752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:41.682371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.683818 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.684224 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:41.684774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.685187 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.685571 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:41.686147 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.687103 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:41.687514 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.687901 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:41.688501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.688920 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:41.690803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:41.696288 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:41.696708 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:41.697097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:41.702913 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.703324 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:41.703723 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:41.727170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.728621 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:41.729843 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:41.730258 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:41.733637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d23e6ba0>]}
[0m22:05:41.734162 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.734567 [debug] [MainThread]: On master: BEGIN
[0m22:05:41.734994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:41.741310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.741748 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.742154 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.742553 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.743133 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.743542 [debug] [MainThread]: On master: Close
[0m22:05:41.744830 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:41.745328 [info ] [MainThread]: 
[0m22:05:41.755113 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:41.755719 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:41.756369 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:41.756823 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:41.784019 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:41.784766 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:41.819286 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:41.820032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.002152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.002678 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.003358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.003818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.004260 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.004979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.007950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.008414 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.009110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.025284 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.025812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.026268 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.028687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.033664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.034137 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.035522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.037867 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.068195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079a2946e0>]}
[0m22:05:51.068943 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.31s]
[0m22:05:51.069724 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.070776 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.071352 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.071965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.072419 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.077644 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.078317 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:51.112125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.112688 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241213220551106145"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:51.113190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:51.127460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.136394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.136881 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:51.137530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.137997 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.138441 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241213220551106145'
      
      
      order by ordinal_position

  
[0m22:05:51.159506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.164621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.165107 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.167877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.175349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.175841 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.178963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.196743 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:51.197459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.197936 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241213220551106145"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241213220551106145"
    )
  
[0m22:05:51.232527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.234562 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.235089 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.235531 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.243668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.244638 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:51.321798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5513116-0a66-488b-96e3-31b2fa05fc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d39eb0b0>]}
[0m22:05:51.322578 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.25s]
[0m22:05:51.323358 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:51.324909 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.325446 [debug] [MainThread]: On master: BEGIN
[0m22:05:51.325944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:51.332783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.333271 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.333732 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.334179 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.334800 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.335272 [debug] [MainThread]: On master: Close
[0m22:05:51.336762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:51.337207 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:51.337629 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:51.338118 [info ] [MainThread]: 
[0m22:05:51.338752 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.31 seconds (10.31s).
[0m22:05:51.339884 [debug] [MainThread]: Command end result
[0m22:05:51.368674 [info ] [MainThread]: 
[0m22:05:51.369355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:51.369952 [info ] [MainThread]: 
[0m22:05:51.370546 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:51.371661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.261659, "process_user_time": 5.445827, "process_kernel_time": 0.355075, "process_mem_max_rss": "280248", "process_in_blocks": "3896", "process_out_blocks": "110200"}
[0m22:05:51.372309 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:51.372199 after 12.26 seconds
[0m22:05:51.372806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07dbdbd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07db319fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d2292ba0>]}
[0m22:05:51.373293 [debug] [MainThread]: Flushing usage events
[0m22:05:53.086047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50ae32a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50bae6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50ae31e20>]}


============================== 22:05:53.089206 | f3277143-2e1b-46bc-b212-5dacb813786c ==============================
[0m22:05:53.089206 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.089886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.237592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3277143-2e1b-46bc-b212-5dacb813786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50a79fb30>]}
[0m22:05:53.254537 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2192144, "process_user_time": 1.450737, "process_kernel_time": 0.103909, "process_mem_max_rss": "92236", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:53.255195 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:53.255087 after 0.22 seconds
[0m22:05:53.255653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50ae32870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50dfd0b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa50b96b6e0>]}
[0m22:05:53.256120 [debug] [MainThread]: Flushing usage events
[0m06:02:11.982191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617f534350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617ea10770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617e0aabd0>]}


============================== 06:02:11.990126 | 7284eff1-c73b-479c-ad4d-27c8520d8648 ==============================
[0m06:02:11.990126 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.990773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.130253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7284eff1-c73b-479c-ad4d-27c8520d8648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617da7fc80>]}
[0m06:02:12.143289 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xedltrac'
[0m06:02:12.143743 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:12.282408 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:12.283104 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:12.293250 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:12.297105 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.467542 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.468047 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:12.468565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7284eff1-c73b-479c-ad4d-27c8520d8648', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617dab7ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617d9651f0>]}
[0m06:02:12.469031 [info ] [MainThread]: 
[0m06:02:12.469505 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:12.471151 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53732175, "process_user_time": 1.568462, "process_kernel_time": 0.128365, "process_mem_max_rss": "93732", "process_in_blocks": "5792", "process_out_blocks": "4000"}
[0m06:02:12.471748 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:12.471645 after 0.54 seconds
[0m06:02:12.472179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617e598230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617e029520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617d9fc6b0>]}
[0m06:02:12.472603 [debug] [MainThread]: Flushing usage events
[0m06:02:14.141205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26631a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb266371b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb266a31100>]}


============================== 06:02:14.144141 | 967e2846-1c1f-4daa-8d4b-6eeaf0f62baf ==============================
[0m06:02:14.144141 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.144809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.376887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb265c137a0>]}
[0m06:02:14.435736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26596d1c0>]}
[0m06:02:14.438137 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:02:14.453873 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:14.454615 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:14.455148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2659c8fe0>]}
[0m06:02:15.690848 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:15.691547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e34c1a0>]}
[0m06:02:15.872830 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:15.877758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e37a3f0>]}
[0m06:02:16.004410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e2de4e0>]}
[0m06:02:16.004956 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:16.005446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e3ccb60>]}
[0m06:02:16.007143 [info ] [MainThread]: 
[0m06:02:16.007825 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.012570 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.048920 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.049385 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.049797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:16.537908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.539523 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:16.541949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:16.542541 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:16.549706 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.550183 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:16.550587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.556923 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.558423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.558846 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:16.559393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.559793 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.560180 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:16.560797 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.561719 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.562184 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.562578 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.563174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.563594 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:16.565571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:16.571265 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.571690 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:16.572078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.577760 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.578221 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.578631 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:16.602020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.603452 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:16.604653 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:16.605062 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:16.608259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e31d130>]}
[0m06:02:16.608792 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.609189 [debug] [MainThread]: On master: BEGIN
[0m06:02:16.609575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:16.615920 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.616356 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.616756 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.617133 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.617665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.618114 [debug] [MainThread]: On master: Close
[0m06:02:16.619706 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:16.620214 [info ] [MainThread]: 
[0m06:02:16.654579 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:16.655173 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:16.655838 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:16.656290 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:16.683165 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:16.683912 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:16.718610 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:16.719361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:24.436870 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.437374 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:24.438050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.438519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.438961 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:24.439663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.442574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.443040 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:24.443778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.460150 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.460641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.461090 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.462789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.467777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.468256 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:24.469392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.471721 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:24.502032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21cbfb020>]}
[0m06:02:24.502741 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.85s]
[0m06:02:24.503521 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:24.504498 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:24.505072 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:24.505677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:24.506180 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:24.511211 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:24.511863 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:24.545389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.545928 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241214060224539473"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:24.546407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:24.560470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.569072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.569561 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:24.570183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.570642 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.571090 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241214060224539473'
      
      
      order by ordinal_position

  
[0m06:02:24.591906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.597010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.597497 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.600605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.608264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.608748 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.611487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.629165 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:24.629848 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.630365 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241214060224539473"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241214060224539473"
    )
  
[0m06:02:24.667207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.669157 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.669645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.670115 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.677497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.678434 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:24.760760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '967e2846-1c1f-4daa-8d4b-6eeaf0f62baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb23ff9f200>]}
[0m06:02:24.761503 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.25s]
[0m06:02:24.762296 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:24.763704 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.764182 [debug] [MainThread]: On master: BEGIN
[0m06:02:24.764624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:24.771258 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.771743 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.772195 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:24.772632 [debug] [MainThread]: On master: COMMIT
[0m06:02:24.773231 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:24.773693 [debug] [MainThread]: On master: Close
[0m06:02:24.775294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:24.775737 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:24.776152 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:24.776615 [info ] [MainThread]: 
[0m06:02:24.777174 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.77 seconds (8.77s).
[0m06:02:24.778246 [debug] [MainThread]: Command end result
[0m06:02:24.806774 [info ] [MainThread]: 
[0m06:02:24.807415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:24.807961 [info ] [MainThread]: 
[0m06:02:24.808521 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:24.809599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.717923, "process_user_time": 5.321443, "process_kernel_time": 0.319366, "process_mem_max_rss": "293420", "process_in_blocks": "3896", "process_out_blocks": "110680"}
[0m06:02:24.810279 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:24.810167 after 10.72 seconds
[0m06:02:24.810777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26596cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e103290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21ca94d40>]}
[0m06:02:24.811279 [debug] [MainThread]: Flushing usage events
[0m06:02:26.458778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8c70a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8ea2a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8c708770>]}


============================== 06:02:26.461753 | 08bf74b9-b44d-4848-9dcc-3c3a60391ace ==============================
[0m06:02:26.461753 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.462480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.629107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08bf74b9-b44d-4848-9dcc-3c3a60391ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8caa5c70>]}
[0m06:02:26.645348 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23604338, "process_user_time": 1.374856, "process_kernel_time": 0.144299, "process_mem_max_rss": "92448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:26.645978 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:26.645826 after 0.24 seconds
[0m06:02:26.646424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8ea2a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8d313920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8c44fb90>]}
[0m06:02:26.646855 [debug] [MainThread]: Flushing usage events
[0m14:05:14.336753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b709a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b6e49940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b744d100>]}


============================== 14:05:14.376906 | 540c01d2-867d-4065-b34e-317c83db2a8b ==============================
[0m14:05:14.376906 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.377666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:14.536472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '540c01d2-867d-4065-b34e-317c83db2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b6d198e0>]}
[0m14:05:14.551327 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lewocyia'
[0m14:05:14.551956 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:14.594369 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:14.595165 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:14.618356 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:14.622472 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:14.695811 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:14.696450 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:14.697059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '540c01d2-867d-4065-b34e-317c83db2a8b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b7df1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b66cbd70>]}
[0m14:05:14.697571 [info ] [MainThread]: 
[0m14:05:14.698095 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:14.705005 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.418805, "process_user_time": 1.673682, "process_kernel_time": 0.135811, "process_mem_max_rss": "94052", "process_in_blocks": "5792", "process_out_blocks": "4008"}
[0m14:05:14.705643 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:14.705531 after 0.42 seconds
[0m14:05:14.706140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b6a618e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b76ccb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1b678ad20>]}
[0m14:05:14.706614 [debug] [MainThread]: Flushing usage events
[0m14:05:16.471754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e271d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e180dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e180deb0>]}


============================== 14:05:16.474991 | 38067466-6af1-4a5b-9213-b29c2b333562 ==============================
[0m14:05:16.474991 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.475730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.729373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e0bfaa80>]}
[0m14:05:16.790316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e127a5a0>]}
[0m14:05:16.793058 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:16.818755 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:16.819575 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:16.820121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e0c94380>]}
[0m14:05:18.078991 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:18.079690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d97c2c60>]}
[0m14:05:18.267140 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:18.272692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d951e9f0>]}
[0m14:05:18.455300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d95f6de0>]}
[0m14:05:18.455925 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:18.456453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d96bf920>]}
[0m14:05:18.458363 [info ] [MainThread]: 
[0m14:05:18.459140 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:18.464329 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:18.502575 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:18.503128 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:18.503542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:18.983966 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:18.985535 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:18.987853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:18.988425 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:18.995543 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:18.995995 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:18.996402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.003259 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.004929 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.005366 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:19.006001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.006469 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.006867 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:19.007449 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.008407 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:19.008818 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.009201 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:19.009748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.010200 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:19.012676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:19.018696 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:19.019141 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:19.019531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.025871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.026397 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:19.026809 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:19.051232 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.053017 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:19.054391 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:19.054860 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:19.058941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d96becc0>]}
[0m14:05:19.059499 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.059914 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.060302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:19.067440 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.067970 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.068381 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.068773 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.069356 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.069781 [debug] [MainThread]: On master: Close
[0m14:05:19.071700 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:19.072229 [info ] [MainThread]: 
[0m14:05:19.107735 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:19.108447 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:19.109181 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:19.109638 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:19.137246 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:19.138197 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:19.173784 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:19.174755 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:26.584332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.584898 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:26.585622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.586086 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.586564 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:26.587339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.590500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.590968 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:26.591725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.608322 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.608881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.609335 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.612380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.617890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.618401 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:26.620544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.623064 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:26.676096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b889c1a0>]}
[0m14:05:26.676974 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.57s]
[0m14:05:26.677771 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:26.678815 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:26.679384 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:26.680006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:26.680473 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:26.688665 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:26.689686 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:26.731628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.732443 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241214140526723866"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:26.733046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.756074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.766670 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.767320 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:26.768284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.768794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.769295 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241214140526723866'
      
      
      order by ordinal_position

  
[0m14:05:26.794784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.800753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.801262 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.804279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.812446 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.812972 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.816391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.834818 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:26.835641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.836127 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241214140526723866"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241214140526723866"
    )
  
[0m14:05:26.878083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.880167 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.880638 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.881074 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.891601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.892653 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.980893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38067466-6af1-4a5b-9213-b29c2b333562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969c1d22d0>]}
[0m14:05:26.981740 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m14:05:26.982526 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.984055 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.984560 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.985030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.992233 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.992814 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.993291 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.993735 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.994484 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.994973 [debug] [MainThread]: On master: Close
[0m14:05:26.997364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.997817 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:26.998275 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.998768 [info ] [MainThread]: 
[0m14:05:26.999386 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.54 seconds (8.54s).
[0m14:05:27.000565 [debug] [MainThread]: Command end result
[0m14:05:27.031112 [info ] [MainThread]: 
[0m14:05:27.031908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:27.032518 [info ] [MainThread]: 
[0m14:05:27.033133 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:27.034347 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.613549, "process_user_time": 5.631325, "process_kernel_time": 0.316186, "process_mem_max_rss": "295696", "process_in_blocks": "3896", "process_out_blocks": "110680"}
[0m14:05:27.035012 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:27.034898 after 10.61 seconds
[0m14:05:27.035531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e0c23b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d03a6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f968fa0c200>]}
[0m14:05:27.036030 [debug] [MainThread]: Flushing usage events
[0m14:05:28.832274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30bf7ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30ccc4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30c787740>]}


============================== 14:05:28.835563 | 1a039b5f-0427-484f-a68c-60fb4e45d8d0 ==============================
[0m14:05:28.835563 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.836265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.991684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a039b5f-0427-484f-a68c-60fb4e45d8d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30c8b6000>]}
[0m14:05:29.009229 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22772604, "process_user_time": 1.47334, "process_kernel_time": 0.092083, "process_mem_max_rss": "92532", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:29.009847 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:29.009741 after 0.23 seconds
[0m14:05:29.010365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30f2ddcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30c8b6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30e2a1c40>]}
[0m14:05:29.010828 [debug] [MainThread]: Flushing usage events
