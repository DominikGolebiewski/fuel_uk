[0m06:03:06.008204 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:06.009186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.009603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.009990 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119060305984631'
      
      
      order by ordinal_position

  
[0m06:03:06.012735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.017942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.018360 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:06.021191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.028429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.028857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:06.031460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.033031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.033429 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:06.034110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.049220 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:06.049881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.050280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119060305984631"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119060305984631"
    )
  
[0m06:03:06.115440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.117464 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:06.117919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:06.118372 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:06.124483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:06.125419 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:06.126102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde5f77f-5dfe-4b46-88d6-4f8cebaaf83e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd64e594fe0>]}
[0m06:03:06.126764 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:03:06.127451 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:06.129001 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:06.129385 [debug] [MainThread]: On master: BEGIN
[0m06:03:06.129710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:06.130449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:06.130803 [debug] [MainThread]: On master: COMMIT
[0m06:03:06.131159 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:06.131471 [debug] [MainThread]: On master: COMMIT
[0m06:03:06.132067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:06.132435 [debug] [MainThread]: On master: Close
[0m06:03:06.132881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:06.133205 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:06.133559 [info ] [MainThread]: 
[0m06:03:06.133999 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m06:03:06.134829 [debug] [MainThread]: Command end result
[0m06:03:06.160214 [info ] [MainThread]: 
[0m06:03:06.160780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:06.161227 [info ] [MainThread]: 
[0m06:03:06.161596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:06.162523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.577324, "process_user_time": 4.874011, "process_kernel_time": 0.274831, "process_mem_max_rss": "327440", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:06.163095 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:06.162998 after 11.58 seconds
[0m06:03:06.163503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd698135fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd698c1a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd648384c80>]}
[0m06:03:06.163908 [debug] [MainThread]: Flushing usage events
[0m06:03:07.861631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947eba2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc083e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc0a930>]}


============================== 06:03:07.864866 | 021a097e-f851-4104-b01a-c27421e29f19 ==============================
[0m06:03:07.864866 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:07.865483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:07.965958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '021a097e-f851-4104-b01a-c27421e29f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e0d2750>]}
[0m06:03:07.980671 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16507837, "process_user_time": 1.220228, "process_kernel_time": 0.074952, "process_mem_max_rss": "99364", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:07.981252 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:07.981160 after 0.17 seconds
[0m06:03:07.981632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94826d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947df60c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e4c0530>]}
[0m06:03:07.982029 [debug] [MainThread]: Flushing usage events
[0m14:06:02.650225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672555430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671efc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671efdca0>]}


============================== 14:06:02.665396 | 48da9350-70f4-4b6c-86b0-8d9b40083dce ==============================
[0m14:06:02.665396 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:02.666059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:02.847865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48da9350-70f4-4b6c-86b0-8d9b40083dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56722443e0>]}
[0m14:06:02.863425 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kmzgbmsj'
[0m14:06:02.863927 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:02.989852 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:02.991656 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:03.038294 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:03.043539 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:03.155624 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:03.156243 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:03.156803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '48da9350-70f4-4b6c-86b0-8d9b40083dce', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672f63bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56731945f0>]}
[0m14:06:03.157294 [info ] [MainThread]: 
[0m14:06:03.157797 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:03.177816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5785703, "process_user_time": 1.670071, "process_kernel_time": 0.149469, "process_mem_max_rss": "101120", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:06:03.178525 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:03.178385 after 0.58 seconds
[0m14:06:03.179079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5671e984d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56722443e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5672f63bf0>]}
[0m14:06:03.179638 [debug] [MainThread]: Flushing usage events
[0m14:06:04.763805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36ebd3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37023dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36efe6570>]}


============================== 14:06:04.766961 | a879ce7d-82e6-4cb8-83be-fcc809017ca1 ==============================
[0m14:06:04.766961 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:04.767641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:05.001229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36f2fce60>]}
[0m14:06:05.062310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36e0a0a40>]}
[0m14:06:05.064153 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:05.089401 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:05.090136 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:05.090664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa370af72f0>]}
[0m14:06:06.463942 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:06.464633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36600eb40>]}
[0m14:06:06.709894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:06.715483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661b7050>]}
[0m14:06:06.844227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa366850c80>]}
[0m14:06:06.844862 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:06.845373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36de2b0b0>]}
[0m14:06:06.847286 [info ] [MainThread]: 
[0m14:06:06.848016 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:06.852953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:06.889930 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:06.890392 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:06.890804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:07.317231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.319033 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:07.319954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:07.320533 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:07.328224 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.328662 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:07.329033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:07.330006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.331292 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.331694 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:07.332307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.332709 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.333069 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:07.333701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.334614 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:07.334995 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:07.335348 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:07.335928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.336312 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:07.337606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:07.343549 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:07.343945 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:07.344303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:07.344969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.345355 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:07.345771 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:07.356998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:07.358450 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:07.359750 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:07.360158 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:07.362213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36602ad80>]}
[0m14:06:07.362751 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:07.363132 [debug] [MainThread]: On master: BEGIN
[0m14:06:07.363484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:07.364145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:07.364562 [debug] [MainThread]: On master: COMMIT
[0m14:06:07.364936 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:07.365301 [debug] [MainThread]: On master: COMMIT
[0m14:06:07.365892 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:07.366279 [debug] [MainThread]: On master: Close
[0m14:06:07.366778 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:07.367248 [info ] [MainThread]: 
[0m14:06:07.388810 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:07.389608 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:07.390296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:07.390772 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:07.418017 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:07.418866 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:07.454283 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:07.455053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:15.646519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.647083 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:15.647770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.648213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.648666 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:15.649635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.650994 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.651438 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:15.652493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.659274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.659764 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:15.660830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.665051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.665514 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:15.666271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.683240 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:15.683724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.684138 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:15.686113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.691915 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:15.692373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:15.693638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.696105 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:15.697621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661b6720>]}
[0m14:06:15.698298 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.31s]
[0m14:06:15.699072 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:15.700220 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:15.700805 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:15.701402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:15.701931 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:15.706985 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:15.707659 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:15.743896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.744396 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251119140615737863"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:15.744877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:15.751940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.759490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.759962 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:15.760621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.761051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.761475 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119140615737863'
      
      
      order by ordinal_position

  
[0m14:06:15.763981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.769176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.769646 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:15.772071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.779682 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.780141 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:15.782578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.784262 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.784726 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:15.785443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.802588 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:15.803314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.803783 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119140615737863"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119140615737863"
    )
  
[0m14:06:15.864829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.867154 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:15.867626 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:15.868035 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:15.874235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:15.875287 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:15.876086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a879ce7d-82e6-4cb8-83be-fcc809017ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3661dc2f0>]}
[0m14:06:15.876835 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:15.877604 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:15.879305 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.879751 [debug] [MainThread]: On master: BEGIN
[0m14:06:15.880129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:15.880907 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.881309 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.881721 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:15.882084 [debug] [MainThread]: On master: COMMIT
[0m14:06:15.882682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:15.883076 [debug] [MainThread]: On master: Close
[0m14:06:15.883574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:15.883944 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:15.884352 [info ] [MainThread]: 
[0m14:06:15.884882 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.04 seconds (9.04s).
[0m14:06:15.885876 [debug] [MainThread]: Command end result
[0m14:06:15.914456 [info ] [MainThread]: 
[0m14:06:15.915089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:15.915607 [info ] [MainThread]: 
[0m14:06:15.916108 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:15.917219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.204388, "process_user_time": 5.671275, "process_kernel_time": 0.284364, "process_mem_max_rss": "369444", "process_in_blocks": "1200", "process_out_blocks": "107288"}
[0m14:06:15.917839 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:15.917727 after 11.21 seconds
[0m14:06:15.918289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37023dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa344f67f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36e51bd40>]}
[0m14:06:15.918765 [debug] [MainThread]: Flushing usage events
[0m14:06:17.667653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56374d74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637e39d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755be00>]}


============================== 14:06:17.670832 | e7a7d9a0-fad7-4c9e-afdc-84c8928b5281 ==============================
[0m14:06:17.670832 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:17.671561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:17.786458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a7d9a0-fad7-4c9e-afdc-84c8928b5281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755b0b0>]}
[0m14:06:17.805109 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18851323, "process_user_time": 1.334391, "process_kernel_time": 0.115947, "process_mem_max_rss": "99404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:17.805802 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:17.805691 after 0.19 seconds
[0m14:06:17.806233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637fd5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563755b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5637534200>]}
[0m14:06:17.806684 [debug] [MainThread]: Flushing usage events
[0m22:06:45.110829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949f7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949a74b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9495a0050>]}


============================== 22:06:45.125425 | cc9f9267-01c5-435a-8161-1a81059cdac9 ==============================
[0m22:06:45.125425 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:45.126052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:45.272366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc9f9267-01c5-435a-8161-1a81059cdac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9495a0260>]}
[0m22:06:45.287454 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g212j8i7'
[0m22:06:45.287919 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:45.381560 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:45.383031 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:45.417060 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:45.421677 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:45.512836 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:45.513382 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:45.513878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc9f9267-01c5-435a-8161-1a81059cdac9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949732f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94a605370>]}
[0m22:06:45.514349 [info ] [MainThread]: 
[0m22:06:45.514802 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:45.524056 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46460143, "process_user_time": 1.635375, "process_kernel_time": 0.130392, "process_mem_max_rss": "100928", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m22:06:45.524632 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:45.524528 after 0.47 seconds
[0m22:06:45.525058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949f7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa949a01a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94a7c2600>]}
[0m22:06:45.525499 [debug] [MainThread]: Flushing usage events
[0m22:06:47.110660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1037e8bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035f78dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035f7a180>]}


============================== 22:06:47.113819 | d717296a-b81a-4e0f-afb2-e4ce2efc7e02 ==============================
[0m22:06:47.113819 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:47.114473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.348083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035523440>]}
[0m22:06:47.409495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10359b68a0>]}
[0m22:06:47.411285 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:47.432269 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:47.432993 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:47.433562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10355c28a0>]}
[0m22:06:48.821772 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:48.822428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102dd06930>]}
[0m22:06:49.060347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:49.065610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102d59eea0>]}
[0m22:06:49.159490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102dd445f0>]}
[0m22:06:49.160023 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:49.160566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1035597500>]}
[0m22:06:49.162391 [info ] [MainThread]: 
[0m22:06:49.163069 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:49.167895 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:49.203694 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:49.204126 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:49.204536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:49.633325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.635573 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:49.636727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:49.637563 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:49.647434 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.648045 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:49.648588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.649718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.651007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.651421 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:49.651979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.652382 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.652744 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:49.653410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.654336 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.654730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:49.655093 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:49.655696 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.656081 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:49.657286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:49.663035 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.663467 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:49.663825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:49.664487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.664870 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:49.665272 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:49.676092 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:49.677566 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:49.678831 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:49.679253 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:49.681471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10372ddcd0>]}
[0m22:06:49.681976 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.682407 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.682776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:49.683421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.683814 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.684200 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.684564 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.685135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.685548 [debug] [MainThread]: On master: Close
[0m22:06:49.686032 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:49.686526 [info ] [MainThread]: 
[0m22:06:49.696601 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:49.697218 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:49.697788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:49.698250 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:49.725626 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:49.726446 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:49.762086 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:49.762894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.836721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.837316 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:58.838016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.838479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.838905 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.839882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.841258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.841699 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.843019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.850012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.850537 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:58.851499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.856078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.856554 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:58.857392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.874071 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.874566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.874980 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.876657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.882514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.882969 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:58.884456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.886920 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:58.888439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102c138c50>]}
[0m22:06:58.889114 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.19s]
[0m22:06:58.889955 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:58.890880 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:58.891540 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:58.892110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:58.892577 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:58.897594 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:58.898271 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:58.937547 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.938427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251119220658928571"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:58.939120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.947850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.958006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.958692 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:58.959542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.960111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.960789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251119220658928571'
      
      
      order by ordinal_position

  
[0m22:06:58.964373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.970654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.971347 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.974334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.982275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.982739 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.986049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.988155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.988775 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:58.989757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.009042 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:59.009779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:59.010268 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251119220658928571"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251119220658928571"
    )
  
[0m22:06:59.069130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.071128 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:59.071591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:59.072007 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:59.089851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:59.090810 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:59.091519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd717296a-b81a-4e0f-afb2-e4ce2efc7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe56e7c50>]}
[0m22:06:59.092208 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.20s]
[0m22:06:59.093104 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:59.094963 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:59.095417 [debug] [MainThread]: On master: BEGIN
[0m22:06:59.095802 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:59.096528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:59.096931 [debug] [MainThread]: On master: COMMIT
[0m22:06:59.097378 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:59.097749 [debug] [MainThread]: On master: COMMIT
[0m22:06:59.098343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:59.098744 [debug] [MainThread]: On master: Close
[0m22:06:59.099241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:59.099614 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:59.100008 [info ] [MainThread]: 
[0m22:06:59.100551 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.94 seconds (9.94s).
[0m22:06:59.101562 [debug] [MainThread]: Command end result
[0m22:06:59.128030 [info ] [MainThread]: 
[0m22:06:59.128639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:59.129118 [info ] [MainThread]: 
[0m22:06:59.129635 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:59.130588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.071445, "process_user_time": 5.633693, "process_kernel_time": 0.315758, "process_mem_max_rss": "331856", "process_in_blocks": "1200", "process_out_blocks": "107328"}
[0m22:06:59.131139 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:59.131034 after 12.07 seconds
[0m22:06:59.131629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10356f8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10359b47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fe56cb350>]}
[0m22:06:59.132050 [debug] [MainThread]: Flushing usage events
[0m22:07:00.849516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa59b354f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa59527ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa594cd0a0>]}


============================== 22:07:00.852642 | aaa10c2d-7541-432c-ad5e-9376a450c0ac ==============================
[0m22:07:00.852642 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.853337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.969422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaa10c2d-7541-432c-ad5e-9376a450c0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa58f57020>]}
[0m22:07:00.987844 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18902452, "process_user_time": 1.354442, "process_kernel_time": 0.104956, "process_mem_max_rss": "99392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:00.988415 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:00.988308 after 0.19 seconds
[0m22:07:00.988845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa5d6d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa590a5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa58f6fbc0>]}
[0m22:07:00.989296 [debug] [MainThread]: Flushing usage events
[0m06:02:52.963025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b551fd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b56a597f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55fc3440>]}


============================== 06:02:52.975427 | b6315041-664c-4beb-8f51-7b44686fdedb ==============================
[0m06:02:52.975427 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:52.976097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:53.128221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6315041-664c-4beb-8f51-7b44686fdedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54e3ade0>]}
[0m06:02:53.143838 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-t41c24x8'
[0m06:02:53.144323 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:53.180813 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:53.182591 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:53.215908 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:53.221315 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:53.473828 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:53.474417 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:53.474966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b6315041-664c-4beb-8f51-7b44686fdedb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54f50140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55e011f0>]}
[0m06:02:53.475421 [info ] [MainThread]: 
[0m06:02:53.475925 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:53.486319 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.57421726, "process_user_time": 1.714649, "process_kernel_time": 0.150319, "process_mem_max_rss": "100944", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m06:02:53.486897 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:53.486790 after 0.57 seconds
[0m06:02:53.487326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b55fc3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54c30c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b54c30830>]}
[0m06:02:53.487795 [debug] [MainThread]: Flushing usage events
[0m06:02:55.357852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c8635e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c7376000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c706ed80>]}


============================== 06:02:55.361149 | 129e2fa3-d541-4795-b67d-8cefb79b40f2 ==============================
[0m06:02:55.361149 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.361821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.601432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6483ce0>]}
[0m06:02:55.664995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c82739e0>]}
[0m06:02:55.666945 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:55.688814 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:55.689585 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:55.690122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6300800>]}
[0m06:02:57.101808 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:57.102480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c625f1d0>]}
[0m06:02:57.358216 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:57.364114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c76b2930>]}
[0m06:02:57.465772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bec29f10>]}
[0m06:02:57.466392 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:57.466962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38be5d4d40>]}
[0m06:02:57.468993 [info ] [MainThread]: 
[0m06:02:57.469759 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:57.474880 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:57.512954 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:57.513470 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:57.513898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:58.003362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.005360 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:58.006362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:58.007061 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:58.016530 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.017127 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:58.017513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:58.019224 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.020686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.021082 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:58.021693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.022077 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.022435 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:58.023101 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.024051 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:58.024449 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:58.024840 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:58.025411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.025840 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:58.027201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:58.033550 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:58.034016 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:58.034379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:58.035282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.035705 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:58.036093 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:58.047512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:58.049235 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:58.050554 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:58.050994 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:58.053290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38be41be60>]}
[0m06:02:58.053855 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.054249 [debug] [MainThread]: On master: BEGIN
[0m06:02:58.054616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:58.055397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.055837 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.056220 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:58.056581 [debug] [MainThread]: On master: COMMIT
[0m06:02:58.057206 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:58.057605 [debug] [MainThread]: On master: Close
[0m06:02:58.058162 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:58.058701 [info ] [MainThread]: 
[0m06:02:58.078882 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:58.079582 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:58.080315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:58.080779 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:58.108863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:58.109832 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:58.146876 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:58.147807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:08.287993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.288570 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:08.289357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.289831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.290248 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:08.291337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.292832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.293290 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:08.294419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.301604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.302130 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:08.303102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.307867 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.308351 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:08.309253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.326886 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:08.327452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.327914 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:08.329698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.337237 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:08.338053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:08.341010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.343718 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:08.345340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bd178e60>]}
[0m06:03:08.346096 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.26s]
[0m06:03:08.346992 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:08.348103 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:08.348707 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:08.349381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:08.349850 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:08.357126 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:08.358145 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:08.404398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.405007 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120060308397904"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:08.405471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:08.412778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.424442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.425221 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:08.426594 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.427072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.427528 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120060308397904'
      
      
      order by ordinal_position

  
[0m06:03:08.430592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.436607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.437132 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:08.439966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.448468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.449037 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:08.451964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.453851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.454310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:08.455137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.476808 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:08.477619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.478126 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120060308397904"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120060308397904"
    )
  
[0m06:03:08.543630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.545725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:08.546221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:08.546670 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:08.652440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:08.653671 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:08.654510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129e2fa3-d541-4795-b67d-8cefb79b40f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3875d9a240>]}
[0m06:03:08.655279 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:03:08.656096 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:08.658097 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:08.658528 [debug] [MainThread]: On master: BEGIN
[0m06:03:08.658962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:08.659813 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:08.660241 [debug] [MainThread]: On master: COMMIT
[0m06:03:08.660632 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:08.661064 [debug] [MainThread]: On master: COMMIT
[0m06:03:08.661707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:08.662121 [debug] [MainThread]: On master: Close
[0m06:03:08.662609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:08.663011 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:08.663416 [info ] [MainThread]: 
[0m06:03:08.663969 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.19 seconds (11.19s).
[0m06:03:08.664984 [debug] [MainThread]: Command end result
[0m06:03:08.692976 [info ] [MainThread]: 
[0m06:03:08.693661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:08.694200 [info ] [MainThread]: 
[0m06:03:08.694737 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:08.695766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.390484, "process_user_time": 5.963643, "process_kernel_time": 0.314611, "process_mem_max_rss": "334412", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m06:03:08.696304 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:08.696201 after 13.39 seconds
[0m06:03:08.696787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cabbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c691b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c6940200>]}
[0m06:03:08.697251 [debug] [MainThread]: Flushing usage events
[0m06:03:10.830883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb169a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb26c2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb26c2180>]}


============================== 06:03:10.834291 | 15d8f03c-c736-4b71-81f9-827f3ee84702 ==============================
[0m06:03:10.834291 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:10.834994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:10.966984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15d8f03c-c736-4b71-81f9-827f3ee84702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1f7fc80>]}
[0m06:03:10.986505 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20906797, "process_user_time": 1.459182, "process_kernel_time": 0.107939, "process_mem_max_rss": "99560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:10.987108 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:10.986999 after 0.21 seconds
[0m06:03:10.987555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1b423c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1354380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb133d550>]}
[0m06:03:10.988038 [debug] [MainThread]: Flushing usage events
[0m14:05:53.179557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a58c7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a62117f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5abe600>]}


============================== 14:05:53.191610 | 5a672e3c-23f6-4110-bc27-b90d7988f7aa ==============================
[0m14:05:53.191610 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:53.192305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:53.358203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a672e3c-23f6-4110-bc27-b90d7988f7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a56d7d70>]}
[0m14:05:53.373640 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k_qvy3k2'
[0m14:05:53.374135 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:53.485516 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:53.486960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:53.521317 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:53.525868 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:53.596609 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:53.597239 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:05:53.597813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a672e3c-23f6-4110-bc27-b90d7988f7aa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a68d42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a543de80>]}
[0m14:05:53.598270 [info ] [MainThread]: 
[0m14:05:53.598792 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:53.607982 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4789139, "process_user_time": 1.630166, "process_kernel_time": 0.145461, "process_mem_max_rss": "100920", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:05:53.608518 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:53.608417 after 0.48 seconds
[0m14:05:53.608958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a5d89970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a68d42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a56d7d70>]}
[0m14:05:53.609364 [debug] [MainThread]: Flushing usage events
[0m14:05:55.230135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06390955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06383d54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063839dee0>]}


============================== 14:05:55.233197 | d8802396-d66b-4a81-a57e-17063e595344 ==============================
[0m14:05:55.233197 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:55.233852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:55.464047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06382ad310>]}
[0m14:05:55.525264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06385a4ce0>]}
[0m14:05:55.526935 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:05:55.567943 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:55.568651 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:55.569182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06380ef2f0>]}
[0m14:05:56.991250 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:56.991891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06303d6a20>]}
[0m14:05:57.238909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:57.246488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063876a930>]}
[0m14:05:57.383057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0630a96b40>]}
[0m14:05:57.383651 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:05:57.384226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06381e0260>]}
[0m14:05:57.386195 [info ] [MainThread]: 
[0m14:05:57.386979 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:57.391932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:57.428666 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:57.429139 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:57.429529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:57.886792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.888403 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:57.889298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:57.889886 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:57.897451 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.897890 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:57.898327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:57.899326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.900649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.901061 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:57.901645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.902047 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.902410 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:57.903050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.903979 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:57.904371 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:57.904755 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:57.905339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.905758 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:57.907052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:57.913119 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:57.913515 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:57.913900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:57.914596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.915014 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:57.915384 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:57.927360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:57.928875 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:57.930122 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:57.930521 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:57.932595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0630a38bf0>]}
[0m14:05:57.933159 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.933539 [debug] [MainThread]: On master: BEGIN
[0m14:05:57.933932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:57.934611 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.935045 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.935418 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.935816 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.936451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.936878 [debug] [MainThread]: On master: Close
[0m14:05:57.937365 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:57.937848 [info ] [MainThread]: 
[0m14:05:57.956891 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:57.957476 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:57.958057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:57.958494 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:57.985553 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:57.986370 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:58.021870 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:58.022637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:05.384534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.385116 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:05.385837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.386275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.386714 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:05.387679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.389046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.389483 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:05.390463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.397278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.397752 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:05.398481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.402677 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.403142 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:05.403862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.420336 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:05.420825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.421329 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:05.423679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.429416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:05.429888 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:05.431315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.433753 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:05.435261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062afaf620>]}
[0m14:06:05.435971 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.48s]
[0m14:06:05.436763 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:05.437774 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:05.438326 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:05.438938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:05.439367 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:05.444388 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:05.445054 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:05.481184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.481674 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120140605475122"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:05.482145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:05.489088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.496643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.497116 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:05.497775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.498204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.498613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120140605475122'
      
      
      order by ordinal_position

  
[0m14:06:05.501036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.506129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.506585 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:05.508920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.516500 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.516987 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:05.519275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.520940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.521379 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:05.522096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.539162 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:05.539869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.540324 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120140605475122"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120140605475122"
    )
  
[0m14:06:05.601256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.603275 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:05.603729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:05.604140 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:05.609893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:05.610797 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:05.611479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8802396-d66b-4a81-a57e-17063e595344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06280cc5f0>]}
[0m14:06:05.612166 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:05.612912 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:05.614658 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.615094 [debug] [MainThread]: On master: BEGIN
[0m14:06:05.615461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:05.616186 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.616582 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.617012 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.617381 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.617967 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.618356 [debug] [MainThread]: On master: Close
[0m14:06:05.618833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:05.619208 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:05.619602 [info ] [MainThread]: 
[0m14:06:05.620106 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m14:06:05.621110 [debug] [MainThread]: Command end result
[0m14:06:05.647878 [info ] [MainThread]: 
[0m14:06:05.648476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:05.649003 [info ] [MainThread]: 
[0m14:06:05.649520 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:05.650514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.470858, "process_user_time": 5.215342, "process_kernel_time": 0.274859, "process_mem_max_rss": "323848", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:05.651082 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:05.650977 after 10.47 seconds
[0m14:06:05.651510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063c8d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063af6c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e82976b0>]}
[0m14:06:05.651954 [debug] [MainThread]: Flushing usage events
[0m14:06:07.361218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28613bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff284665eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28384cd70>]}


============================== 14:06:07.364281 | c8511478-8494-47d2-bea8-498865bb57db ==============================
[0m14:06:07.364281 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:07.364951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:07.480396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8511478-8494-47d2-bea8-498865bb57db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff283e81f70>]}
[0m14:06:07.498954 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18795969, "process_user_time": 1.33182, "process_kernel_time": 0.106905, "process_mem_max_rss": "99312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:07.499502 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:07.499395 after 0.19 seconds
[0m14:06:07.499972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff287dbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2838d36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28364d4c0>]}
[0m14:06:07.500402 [debug] [MainThread]: Flushing usage events
[0m22:06:45.606555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99e92a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e996a7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9a7ee480>]}


============================== 22:06:45.619893 | 09023abc-f759-4565-a56f-a3a6750e70cb ==============================
[0m22:06:45.619893 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:45.620598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:45.771352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09023abc-f759-4565-a56f-a3a6750e70cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9952c860>]}
[0m22:06:45.787325 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rb0y47vk'
[0m22:06:45.787810 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:45.945205 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:45.946746 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:45.992172 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:45.996847 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:46.090783 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:46.091433 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:46.091971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '09023abc-f759-4565-a56f-a3a6750e70cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9a50c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9a50c200>]}
[0m22:06:46.092452 [info ] [MainThread]: 
[0m22:06:46.092926 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:46.103317 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54911476, "process_user_time": 1.702694, "process_kernel_time": 0.134767, "process_mem_max_rss": "101200", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m22:06:46.103867 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:46.103763 after 0.55 seconds
[0m22:06:46.104340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9998a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99254050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e99fef5c0>]}
[0m22:06:46.104772 [debug] [MainThread]: Flushing usage events
[0m22:06:47.709338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ae5d7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28af87a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ae5d7c50>]}


============================== 22:06:47.712881 | 857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186 ==============================
[0m22:06:47.712881 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:47.713594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:47.952091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28aecfcfb0>]}
[0m22:06:48.013942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28adb1a450>]}
[0m22:06:48.015821 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:48.065031 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:48.065771 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:48.066332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28adb033b0>]}
[0m22:06:49.458166 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:49.458877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a6476f00>]}
[0m22:06:49.704552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:49.710470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a5b8e840>]}
[0m22:06:49.809147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a63621b0>]}
[0m22:06:49.809744 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:49.810332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a6340230>]}
[0m22:06:49.812260 [info ] [MainThread]: 
[0m22:06:49.813018 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:49.818014 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:49.854671 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:49.855165 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:49.855574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:50.247908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.249612 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:50.250513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:50.251110 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:50.258764 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.259217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:50.259604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:50.260636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.261983 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.262401 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:50.263006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.263394 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.263755 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:50.264378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.265304 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:50.265698 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:50.266088 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:50.266652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.267063 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:50.268279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:50.274227 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:50.274627 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:50.275005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:50.275689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.276101 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:50.276475 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:50.287098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:50.288558 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:50.289807 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:50.290231 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:50.292433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a5ba36e0>]}
[0m22:06:50.292935 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.293375 [debug] [MainThread]: On master: BEGIN
[0m22:06:50.293743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:50.294429 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.294856 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.295257 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:50.295619 [debug] [MainThread]: On master: COMMIT
[0m22:06:50.296248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:50.296655 [debug] [MainThread]: On master: Close
[0m22:06:50.297170 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:50.297668 [info ] [MainThread]: 
[0m22:06:50.333258 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:50.333855 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:50.334508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:50.334948 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:50.361835 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:50.362583 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:50.397694 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:50.398468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.397737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.398308 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:58.399031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.399479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.399907 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.400877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.402240 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.402688 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:58.403709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.411518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.411978 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:58.412737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.415697 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.416169 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:58.416929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.433574 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.434056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.434487 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:58.436512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.442274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:58.442735 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:58.444185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.446586 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:58.448109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28af87aa80>]}
[0m22:06:58.448805 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.11s]
[0m22:06:58.449587 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:58.450591 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:58.451172 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:58.451745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:58.452210 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:58.457169 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:58.457800 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:58.493906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.494434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251120220658487815"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:58.494890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:58.501908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.509436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.509906 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:58.510627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.511089 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.511517 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251120220658487815'
      
      
      order by ordinal_position

  
[0m22:06:58.514311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.520008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.520511 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.523181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.531217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.531691 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:58.534146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.535848 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.536321 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:58.537047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.555807 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:58.556653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.557164 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251120220658487815"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251120220658487815"
    )
  
[0m22:06:58.615171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.617209 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:58.617673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:58.618099 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:58.624375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:58.625300 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:58.625970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857bf0d0-0b11-4b8a-8b4f-0ee7d0eba186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f285dcff920>]}
[0m22:06:58.626691 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:58.627452 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:58.629275 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:58.629689 [debug] [MainThread]: On master: BEGIN
[0m22:06:58.630107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:58.630841 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:58.631273 [debug] [MainThread]: On master: COMMIT
[0m22:06:58.631644 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:58.632027 [debug] [MainThread]: On master: COMMIT
[0m22:06:58.632618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:58.633048 [debug] [MainThread]: On master: Close
[0m22:06:58.633524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:58.633881 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:58.634309 [info ] [MainThread]: 
[0m22:06:58.634760 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.82 seconds (8.82s).
[0m22:06:58.635701 [debug] [MainThread]: Command end result
[0m22:06:58.661802 [info ] [MainThread]: 
[0m22:06:58.662413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:58.662874 [info ] [MainThread]: 
[0m22:06:58.663361 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:58.664311 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.008272, "process_user_time": 5.259007, "process_kernel_time": 0.277528, "process_mem_max_rss": "351268", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:58.664849 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:58.664746 after 11.01 seconds
[0m22:06:58.665317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28af87a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28a636b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f285dc82f90>]}
[0m22:06:58.665747 [debug] [MainThread]: Flushing usage events
[0m22:07:00.419837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18d504620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18caf17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18d299c40>]}


============================== 22:07:00.423078 | 93ea60b9-8717-46f3-85c7-0305b8fc10d1 ==============================
[0m22:07:00.423078 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.423771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.537786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ea60b9-8717-46f3-85c7-0305b8fc10d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e53fe60>]}
[0m22:07:00.556260 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1879157, "process_user_time": 1.327799, "process_kernel_time": 0.112897, "process_mem_max_rss": "99448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:00.556818 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:00.556712 after 0.19 seconds
[0m22:07:00.557269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd190dbb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e53fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18d9972f0>]}
[0m22:07:00.557698 [debug] [MainThread]: Flushing usage events
[0m06:02:55.195014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f79f3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7c9c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7e88200>]}


============================== 06:02:55.203822 | 0c1ad6c8-aef9-4da0-8a74-36d6c9ec5b31 ==============================
[0m06:02:55.203822 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.204459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.367564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1ad6c8-aef9-4da0-8a74-36d6c9ec5b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f77cea80>]}
[0m06:02:55.383061 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lrbn4gex'
[0m06:02:55.383530 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:55.475968 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:55.477622 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:55.511404 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:55.516067 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:55.744004 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:55.744607 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:55.745208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0c1ad6c8-aef9-4da0-8a74-36d6c9ec5b31', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f8a05c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f8a053a0>]}
[0m06:02:55.745703 [info ] [MainThread]: 
[0m06:02:55.746188 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:55.748104 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.60558575, "process_user_time": 1.693584, "process_kernel_time": 0.133651, "process_mem_max_rss": "100784", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m06:02:55.748661 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:55.748556 after 0.61 seconds
[0m06:02:55.749131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7a3a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7e126c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79f7a3c890>]}
[0m06:02:55.749548 [debug] [MainThread]: Flushing usage events
[0m06:02:57.704051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38cfc54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d0e3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d0e3740>]}


============================== 06:02:57.707419 | 0c398430-b643-419c-81bc-6df873ee76ee ==============================
[0m06:02:57.707419 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:57.708141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:57.954026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38c9a17f0>]}
[0m06:02:58.018819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38cad6420>]}
[0m06:02:58.020641 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:58.059786 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:58.060510 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:58.061053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38cc77110>]}
[0m06:02:59.461006 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:59.461701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe384c52240>]}
[0m06:02:59.714786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:59.720357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe384d6a150>]}
[0m06:02:59.822014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe385489940>]}
[0m06:02:59.822600 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:59.823116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3854e7d70>]}
[0m06:02:59.825014 [info ] [MainThread]: 
[0m06:02:59.825738 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:59.831001 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:59.869212 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:59.869721 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:59.870139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:00.224249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.226331 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:00.227387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:00.227987 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:00.237114 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.237728 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:00.238289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.239974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.241427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.241861 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:00.242779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.243171 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.243533 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:00.244182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.245105 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.245493 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.245903 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.246491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.246907 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:00.248168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:00.254159 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.254578 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:00.254978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.255938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.256332 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.256729 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:00.267418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.268944 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:00.270222 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:00.270621 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:00.272835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3854e5fd0>]}
[0m06:03:00.273341 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.273752 [debug] [MainThread]: On master: BEGIN
[0m06:03:00.274119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:00.274789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.275184 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.275554 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.275952 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.276527 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.276969 [debug] [MainThread]: On master: Close
[0m06:03:00.277467 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:00.277958 [info ] [MainThread]: 
[0m06:03:00.288338 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:00.288956 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:00.289596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:00.290056 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:00.317696 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:00.318503 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:00.355577 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:00.356383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:12.536913 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.537477 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:12.538184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.538630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.539083 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:12.540080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.541411 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.541873 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:12.542876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.549775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.550247 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:12.550999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.555189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.555636 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:12.556372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.573707 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:12.574190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.574618 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:12.576342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.582120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:12.582586 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:12.584051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.586463 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:12.588006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38ea6ab40>]}
[0m06:03:12.588726 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.30s]
[0m06:03:12.589549 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:12.590471 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:12.591068 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:12.591755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:12.592209 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:12.597308 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:12.598096 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:12.635083 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.635615 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251121060312628691"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:12.636102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:12.643374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.651246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.651728 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:12.652403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.652865 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.653341 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251121060312628691'
      
      
      order by ordinal_position

  
[0m06:03:12.655903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.661365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.661875 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:12.664304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.671964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.672428 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:12.675113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.676779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.677220 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:12.677933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.695722 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:12.696421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.696941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251121060312628691"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251121060312628691"
    )
  
[0m06:03:12.755271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.757302 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:12.757763 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:12.758198 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:12.764490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:12.765405 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:12.766116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c398430-b643-419c-81bc-6df873ee76ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33c3c14c0>]}
[0m06:03:12.766800 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:12.767605 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:12.769605 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:12.770046 [debug] [MainThread]: On master: BEGIN
[0m06:03:12.770420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:12.771155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:12.771547 [debug] [MainThread]: On master: COMMIT
[0m06:03:12.771973 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:12.772329 [debug] [MainThread]: On master: COMMIT
[0m06:03:12.772915 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:12.773305 [debug] [MainThread]: On master: Close
[0m06:03:12.773785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:12.774146 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:12.774544 [info ] [MainThread]: 
[0m06:03:12.775101 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.95 seconds (12.95s).
[0m06:03:12.776108 [debug] [MainThread]: Command end result
[0m06:03:12.803024 [info ] [MainThread]: 
[0m06:03:12.803646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:12.804187 [info ] [MainThread]: 
[0m06:03:12.804726 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:12.805754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.156757, "process_user_time": 5.662956, "process_kernel_time": 0.302676, "process_mem_max_rss": "332584", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:12.806291 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:12.806189 after 15.16 seconds
[0m06:03:12.806737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38f8d5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36c57bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38d0e3a70>]}
[0m06:03:12.807160 [debug] [MainThread]: Flushing usage events
[0m06:03:14.790682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37469da930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37473b3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37458fc530>]}


============================== 06:03:14.793956 | 16ed70cf-4058-4fd0-ae12-acc6d1da4ac9 ==============================
[0m06:03:14.793956 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:14.794660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:14.915430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16ed70cf-4058-4fd0-ae12-acc6d1da4ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374483a2a0>]}
[0m06:03:14.933811 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19744481, "process_user_time": 1.408084, "process_kernel_time": 0.097005, "process_mem_max_rss": "99400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:14.934358 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:14.934254 after 0.20 seconds
[0m06:03:14.934809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374679c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744aaf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3744aafc80>]}
[0m06:03:14.935232 [debug] [MainThread]: Flushing usage events
[0m14:06:00.761642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fb977a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fbb5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fb97890>]}


============================== 14:06:00.773998 | 6c79b183-917f-40d4-8d7c-a8894befcfb6 ==============================
[0m14:06:00.773998 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:00.774692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:00.917702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c79b183-917f-40d4-8d7c-a8894befcfb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9f7fd370>]}
[0m14:06:00.934006 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m1rb07yp'
[0m14:06:00.934505 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:01.029900 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:01.031653 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:01.077072 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:01.082036 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:01.186461 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:01.187106 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:01.187651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6c79b183-917f-40d4-8d7c-a8894befcfb6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9f7ff410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9f7446e0>]}
[0m14:06:01.188136 [info ] [MainThread]: 
[0m14:06:01.188611 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:01.199111 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48842794, "process_user_time": 1.635622, "process_kernel_time": 0.148874, "process_mem_max_rss": "101156", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m14:06:01.199670 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:01.199566 after 0.49 seconds
[0m14:06:01.200136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca36cb530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fa1c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c9fb67200>]}
[0m14:06:01.200557 [debug] [MainThread]: Flushing usage events
[0m14:06:02.885372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3df9ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3e8ed5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d58f110>]}


============================== 14:06:02.888460 | 86d98b8a-820d-47a5-946c-3bd1245117f2 ==============================
[0m14:06:02.888460 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:02.889142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:03.121687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3ef6d730>]}
[0m14:06:03.183217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d21dc70>]}
[0m14:06:03.184889 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:03.204832 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:03.205526 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:03.206081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d312450>]}
[0m14:06:04.592444 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:04.593084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf35c5af30>]}
[0m14:06:04.825033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:04.830278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3557cf80>]}
[0m14:06:04.922975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3d313440>]}
[0m14:06:04.923477 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:04.923988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf35c88d10>]}
[0m14:06:04.925837 [info ] [MainThread]: 
[0m14:06:04.926503 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:04.931405 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:04.966955 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:04.967380 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:04.967762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:05.317665 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.319289 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:05.320216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:05.320754 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:05.328256 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.328665 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:05.329074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:05.330001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.331279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.331659 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:05.332254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.332628 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.333004 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:05.333605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.334506 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:05.334900 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:05.335249 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:05.335822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.336208 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:05.337380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:05.343069 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:05.343462 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:05.343836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:05.344506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.344921 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:05.345285 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:05.356621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:05.358070 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:05.359327 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:05.359722 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:05.361761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf35447fe0>]}
[0m14:06:05.362295 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.362676 [debug] [MainThread]: On master: BEGIN
[0m14:06:05.363073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:05.363699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.364112 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.364484 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:05.364862 [debug] [MainThread]: On master: COMMIT
[0m14:06:05.365447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:05.365868 [debug] [MainThread]: On master: Close
[0m14:06:05.366358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:05.366835 [info ] [MainThread]: 
[0m14:06:05.384076 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:05.384672 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:05.385259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:05.385693 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:05.412447 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:05.413205 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:05.448754 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:05.449512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:13.165625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.166198 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:13.166878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.167319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.167737 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:13.168729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.170102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.170543 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:13.171645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.178431 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.178910 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:13.179648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.183823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.184266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:13.185231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.201949 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:13.202408 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.202844 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:13.204804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.210533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:13.211006 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:13.212144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.214547 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:13.216058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2ff00500>]}
[0m14:06:13.216732 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.83s]
[0m14:06:13.217606 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:13.218611 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:13.219213 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:13.219862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:13.220301 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:13.225265 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:13.225938 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:13.262529 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.263055 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251121140613256398"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:13.263510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:13.270740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.278443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.278934 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:13.279622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.280081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.280502 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251121140613256398'
      
      
      order by ordinal_position

  
[0m14:06:13.282956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.288152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.288610 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:13.290983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.298645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.299123 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:13.301493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.303182 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.303625 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:13.304347 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.321471 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:13.322175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.322619 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251121140613256398"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251121140613256398"
    )
  
[0m14:06:13.379572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.381584 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:13.382052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:13.382465 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:13.388512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:13.389453 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:13.390170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86d98b8a-820d-47a5-946c-3bd1245117f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf06776180>]}
[0m14:06:13.390857 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:13.391669 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:13.393795 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:13.394212 [debug] [MainThread]: On master: BEGIN
[0m14:06:13.394582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:13.395324 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:13.395721 [debug] [MainThread]: On master: COMMIT
[0m14:06:13.396151 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:13.396518 [debug] [MainThread]: On master: COMMIT
[0m14:06:13.397180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:13.397626 [debug] [MainThread]: On master: Close
[0m14:06:13.398209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:13.398611 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:13.399054 [info ] [MainThread]: 
[0m14:06:13.399566 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.47 seconds (8.47s).
[0m14:06:13.400589 [debug] [MainThread]: Command end result
[0m14:06:13.427561 [info ] [MainThread]: 
[0m14:06:13.428222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:13.428744 [info ] [MainThread]: 
[0m14:06:13.429295 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:13.430307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.596053, "process_user_time": 5.524964, "process_kernel_time": 0.305053, "process_mem_max_rss": "360356", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:13.430895 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:13.430749 after 10.60 seconds
[0m14:06:13.431342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3de375f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf41ad3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeed42b560>]}
[0m14:06:13.431773 [debug] [MainThread]: Flushing usage events
[0m14:06:15.125884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f3098bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f30de9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2f4e7f20>]}


============================== 14:06:15.129013 | a71fc38f-db05-499c-a718-5f5beee240c3 ==============================
[0m14:06:15.129013 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:15.129645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:06:15.243507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71fc38f-db05-499c-a718-5f5beee240c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e0674d0>]}
[0m14:06:15.262975 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18801713, "process_user_time": 1.31611, "process_kernel_time": 0.104929, "process_mem_max_rss": "99292", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:15.263521 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:15.263418 after 0.19 seconds
[0m14:06:15.263996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f30b4b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e0674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2e67d460>]}
[0m14:06:15.264420 [debug] [MainThread]: Flushing usage events
[0m22:06:35.301394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9195993cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193b9fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193b9d7c0>]}


============================== 22:06:35.313919 | 6fb50e86-466a-4cfd-8bfb-414755d307f0 ==============================
[0m22:06:35.313919 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:35.314602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:35.476126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fb50e86-466a-4cfd-8bfb-414755d307f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9194a22510>]}
[0m22:06:35.491999 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1e3ohzqt'
[0m22:06:35.492495 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:35.558752 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:35.560277 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:35.591213 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:35.595876 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:35.823899 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:35.824524 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:35.825073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6fb50e86-466a-4cfd-8bfb-414755d307f0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193111e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9193d15c10>]}
[0m22:06:35.825553 [info ] [MainThread]: 
[0m22:06:35.826021 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:35.838769 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.58808714, "process_user_time": 1.635583, "process_kernel_time": 0.14062, "process_mem_max_rss": "100832", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m22:06:35.839324 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:35.839219 after 0.59 seconds
[0m22:06:35.839790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9195993cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9192b17650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9192b14050>]}
[0m22:06:35.840213 [debug] [MainThread]: Flushing usage events
[0m22:06:37.453388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ccb836e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cd395e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc948500>]}


============================== 22:06:37.456542 | 25ec4911-ff44-4326-ab0d-9a2d19f03f0a ==============================
[0m22:06:37.456542 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.457243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.692443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ce6980e0>]}
[0m22:06:37.754340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc69ed80>]}
[0m22:06:37.756151 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:37.776321 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:37.777065 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:37.777602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc91ac60>]}
[0m22:06:39.169532 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:39.170180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c49be930>]}
[0m22:06:39.414373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:39.419813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c49f43e0>]}
[0m22:06:39.524013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c5034860>]}
[0m22:06:39.524585 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:39.525090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c50ef0e0>]}
[0m22:06:39.527009 [info ] [MainThread]: 
[0m22:06:39.527757 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:39.532704 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:39.568983 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:39.569426 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:39.569835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:39.917108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.918835 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:39.919803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:39.920592 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:39.929077 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.929531 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:39.929928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.931284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.932668 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.933059 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:39.933698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.934078 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.934437 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:39.935074 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.936022 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.936412 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.936796 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.937369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.937784 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:39.939029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:39.945095 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.945520 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:39.945886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.946578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.946966 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.947334 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:39.958377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.959918 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:39.961198 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:39.961620 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:39.963765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ce6ca0f0>]}
[0m22:06:39.964271 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.964689 [debug] [MainThread]: On master: BEGIN
[0m22:06:39.965047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:39.965712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.966105 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.966494 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.966856 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.967438 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.967863 [debug] [MainThread]: On master: Close
[0m22:06:39.968358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:39.968849 [info ] [MainThread]: 
[0m22:06:39.986695 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:39.987370 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:39.988091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:39.988567 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:40.016476 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:40.017354 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:40.053263 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:40.054148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.272647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.273206 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:48.273955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.274383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.274820 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.275762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.277124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.277598 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.278658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.285558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.286023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:48.286782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.291034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.291498 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:48.292287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.308974 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.309470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.309896 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.311176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.316903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.317357 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:48.318610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.321064 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:48.322601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ce663170>]}
[0m22:06:48.323293 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.33s]
[0m22:06:48.324131 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:48.324981 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:48.325758 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:48.326365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:48.326844 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:48.331895 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:48.332576 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:48.368582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.369095 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251121220648362528"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:48.369560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.376933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.384760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.385211 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:48.386112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.386571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.386992 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251121220648362528'
      
      
      order by ordinal_position

  
[0m22:06:48.389568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.394841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.395290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.397790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.405545 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.405996 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.408739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.410407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.410867 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:48.411573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.428890 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:48.429623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.430131 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251121220648362528"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251121220648362528"
    )
  
[0m22:06:48.491154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.493182 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:48.493639 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.494055 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:48.500179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.501115 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:48.501804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ec4911-ff44-4326-ab0d-9a2d19f03f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c513c560>]}
[0m22:06:48.502479 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:06:48.503202 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:48.504741 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.505153 [debug] [MainThread]: On master: BEGIN
[0m22:06:48.505567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:48.506308 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.506754 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.507126 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.507518 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.508100 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.508513 [debug] [MainThread]: On master: Close
[0m22:06:48.508981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:48.509338 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:48.509758 [info ] [MainThread]: 
[0m22:06:48.510267 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m22:06:48.511248 [debug] [MainThread]: Command end result
[0m22:06:48.538312 [info ] [MainThread]: 
[0m22:06:48.538978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:48.539507 [info ] [MainThread]: 
[0m22:06:48.540028 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:48.541031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.139096, "process_user_time": 5.544868, "process_kernel_time": 0.332591, "process_mem_max_rss": "368528", "process_in_blocks": "1200", "process_out_blocks": "107328"}
[0m22:06:48.541586 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:48.541481 after 11.14 seconds
[0m22:06:48.542032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12cc948500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ccd0c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f127c67c530>]}
[0m22:06:48.542468 [debug] [MainThread]: Flushing usage events
[0m22:06:50.318555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f76e1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8fa24de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f76833b0>]}


============================== 22:06:50.321888 | 5640dcc7-29f8-4cd9-83b5-a3b6483a443b ==============================
[0m22:06:50.321888 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:50.322573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.436562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5640dcc7-29f8-4cd9-83b5-a3b6483a443b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f77de810>]}
[0m22:06:50.454565 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18738385, "process_user_time": 1.304815, "process_kernel_time": 0.13498, "process_mem_max_rss": "99492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:50.455099 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:50.454998 after 0.19 seconds
[0m22:06:50.455655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f87a6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f7beffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f7befce0>]}
[0m22:06:50.456072 [debug] [MainThread]: Flushing usage events
[0m06:02:48.916693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0024e518b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00230df0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023a154c0>]}


============================== 06:02:48.930614 | 38d0ec57-b996-4362-aacb-e501405e3dbd ==============================
[0m06:02:48.930614 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:48.931384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:49.095123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38d0ec57-b996-4362-aacb-e501405e3dbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023d6bc50>]}
[0m06:02:49.112651 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n9h8vowr'
[0m06:02:49.113237 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:49.249581 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:49.251870 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:49.299410 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:49.305136 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:49.401163 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:49.401746 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:49.402300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '38d0ec57-b996-4362-aacb-e501405e3dbd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0022c6e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0022c9fdd0>]}
[0m06:02:49.402753 [info ] [MainThread]: 
[0m06:02:49.403232 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:49.413181 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5499759, "process_user_time": 1.764816, "process_kernel_time": 0.161983, "process_mem_max_rss": "100908", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m06:02:49.413868 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:49.413759 after 0.55 seconds
[0m06:02:49.414348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023a154c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0023d6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0022c6e450>]}
[0m06:02:49.414776 [debug] [MainThread]: Flushing usage events
[0m06:02:51.258389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026d395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20261ad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026036d80>]}


============================== 06:02:51.261733 | 7ee08eb3-63ff-4302-9bd3-de88075a2d61 ==============================
[0m06:02:51.261733 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:51.262467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:51.505707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201db7d3d0>]}
[0m06:02:51.569299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2024fb63f0>]}
[0m06:02:51.571243 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:51.593338 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:51.594194 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:51.594744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2024f3eff0>]}
[0m06:02:53.028540 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:53.029278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201dab7ec0>]}
[0m06:02:53.303433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:53.309658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201d1e90d0>]}
[0m06:02:53.412315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201daf4080>]}
[0m06:02:53.412934 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:53.413472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201db7de20>]}
[0m06:02:53.415599 [info ] [MainThread]: 
[0m06:02:53.416391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:53.421768 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:53.460491 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:53.461021 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:53.461444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:53.836174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.838396 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:53.839529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:53.840120 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:53.847989 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.848533 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:53.848915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:53.850286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.851753 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.852166 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:53.852772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.853180 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.853547 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:53.854249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.855259 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:53.855648 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:53.856005 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:53.856605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.857011 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:53.858452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:53.865277 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:53.865799 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:53.866192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:53.867135 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.867527 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:53.867898 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:53.879227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:53.881073 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:53.882481 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:53.882919 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:53.885172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201d194470>]}
[0m06:02:53.885727 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.886151 [debug] [MainThread]: On master: BEGIN
[0m06:02:53.886519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:53.887458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.887870 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.888289 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:53.888658 [debug] [MainThread]: On master: COMMIT
[0m06:02:53.889303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:53.889706 [debug] [MainThread]: On master: Close
[0m06:02:53.890288 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:53.890801 [info ] [MainThread]: 
[0m06:02:53.909338 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:53.910063 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:53.910783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:53.911258 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:53.940078 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:53.941021 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:53.979189 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:53.980172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:02.256289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.256903 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:02.257825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.258307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.258734 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:02.259891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.261472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.261928 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:02.263172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.270753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.271368 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:02.272540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.277609 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.278171 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:02.279378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.297491 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:02.298118 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.298565 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:02.301087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.307875 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:02.308495 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:02.310182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.312934 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:02.314653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026e7aa80>]}
[0m06:03:02.315432 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.40s]
[0m06:03:02.316318 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:02.317273 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:02.317862 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:02.318645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:02.319128 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:02.324942 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:02.325786 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:02.364332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.365089 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251122060302357804"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:02.365635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:02.373289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.382038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.382642 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:02.383548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.383998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.384467 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251122060302357804'
      
      
      order by ordinal_position

  
[0m06:03:02.387316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.393473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.394078 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:02.397177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.405963 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.406566 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:02.409649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.411633 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.412132 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:02.413034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.431468 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:02.432390 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.432874 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251122060302357804"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251122060302357804"
    )
  
[0m06:03:02.493211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.495420 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:02.495961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:02.496461 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:02.502645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:02.503874 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:02.504761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee08eb3-63ff-4302-9bd3-de88075a2d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd521be90>]}
[0m06:03:02.505560 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.19s]
[0m06:03:02.506405 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:02.508699 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:02.509173 [debug] [MainThread]: On master: BEGIN
[0m06:03:02.509562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:02.510505 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:02.510925 [debug] [MainThread]: On master: COMMIT
[0m06:03:02.511351 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:02.511728 [debug] [MainThread]: On master: COMMIT
[0m06:03:02.512386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:02.512810 [debug] [MainThread]: On master: Close
[0m06:03:02.513382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:02.513753 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:02.514223 [info ] [MainThread]: 
[0m06:03:02.514728 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m06:03:02.515721 [debug] [MainThread]: Command end result
[0m06:03:02.545468 [info ] [MainThread]: 
[0m06:03:02.546184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:02.546669 [info ] [MainThread]: 
[0m06:03:02.547168 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:02.548193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.34226, "process_user_time": 5.854422, "process_kernel_time": 0.335425, "process_mem_max_rss": "323960", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:02.548754 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:02.548646 after 11.34 seconds
[0m06:03:02.549239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026d395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2025587a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fd58727b0>]}
[0m06:03:02.549732 [debug] [MainThread]: Flushing usage events
[0m06:03:04.541158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e4385a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e50b6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e50b6090>]}


============================== 06:03:04.544612 | d1f7c138-0a74-4ce9-985a-6e31500253a9 ==============================
[0m06:03:04.544612 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:04.545404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:04.670008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1f7c138-0a74-4ce9-985a-6e31500253a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e3eda4e0>]}
[0m06:03:04.689329 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20137587, "process_user_time": 1.452365, "process_kernel_time": 0.114949, "process_mem_max_rss": "99896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:04.689922 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:04.689812 after 0.20 seconds
[0m06:03:04.690406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e3eff8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e43842c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e4385a30>]}
[0m06:03:04.690851 [debug] [MainThread]: Flushing usage events
[0m14:05:17.532598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f2ec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58fddd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f2ecad0>]}


============================== 14:05:17.545804 | 5b300d89-c1de-4653-a304-ecf78c784803 ==============================
[0m14:05:17.545804 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.546446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.725768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b300d89-c1de-4653-a304-ecf78c784803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f6cd190>]}
[0m14:05:17.741617 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tw29ox31'
[0m14:05:17.742109 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:17.941084 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:17.942534 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:17.973389 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:17.977968 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:18.132288 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:18.132887 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:05:18.133414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5b300d89-c1de-4653-a304-ecf78c784803', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f50cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f37a630>]}
[0m14:05:18.133906 [info ] [MainThread]: 
[0m14:05:18.134374 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:18.168528 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6872557, "process_user_time": 1.68707, "process_kernel_time": 0.142005, "process_mem_max_rss": "100796", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m14:05:18.169118 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:18.169014 after 0.69 seconds
[0m14:05:18.169575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff593ad3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f28c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58f6cd190>]}
[0m14:05:18.170060 [debug] [MainThread]: Flushing usage events
[0m14:05:19.813796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ca79a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7ef38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7c33410>]}


============================== 14:05:19.817036 | 7c64aa58-f025-4453-b2c6-eac7fd04dea1 ==============================
[0m14:05:19.817036 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.817751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.048555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c8de8f50>]}
[0m14:05:20.110322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7a3ebd0>]}
[0m14:05:20.112120 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:05:20.145387 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:20.146156 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:20.146702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0620cb0>]}
[0m14:05:21.556127 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:21.556831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c00cd880>]}
[0m14:05:21.806862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:21.812320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b3b7a960>]}
[0m14:05:21.908322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0169df0>]}
[0m14:05:21.908929 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:05:21.909416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c015fce0>]}
[0m14:05:21.911265 [info ] [MainThread]: 
[0m14:05:21.911987 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:21.916873 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:21.952716 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:21.953172 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:21.953557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:22.281582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.283944 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:22.285160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:22.286024 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:22.294244 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.294678 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:22.295061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.296024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.297320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.297722 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:22.298300 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.298697 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.299061 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:22.299676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.300562 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.300972 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.301338 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.301913 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.302304 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:22.303488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:22.309277 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.309697 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:22.310065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.310726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.311114 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.311488 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:22.322197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.323621 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:22.324903 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:22.325304 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:22.327514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c9981a60>]}
[0m14:05:22.328081 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.328462 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.328864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:22.329504 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.329926 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.330295 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.330650 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.331262 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.331678 [debug] [MainThread]: On master: Close
[0m14:05:22.332191 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:22.332709 [info ] [MainThread]: 
[0m14:05:22.353761 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:22.354358 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:22.355014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:22.355451 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:22.383235 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:22.384228 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:22.422380 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:22.423382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.550761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.551310 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.551995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.552436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.552906 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:30.553953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.555314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.555780 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:30.557001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.565031 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.565483 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.566242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.569264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.569727 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.570442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.587071 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.587519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.587952 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.589756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.595514 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.595992 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:30.597192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.599588 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.601142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c0095070>]}
[0m14:05:30.601841 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.25s]
[0m14:05:30.602597 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.603585 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.604165 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.604746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.605179 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.610178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.610857 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.647604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.648148 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251122140530641497"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.648613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.655726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.663375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.663847 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.664497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.664952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.665369 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251122140530641497'
      
      
      order by ordinal_position

  
[0m14:05:30.668738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.673985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.674441 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.676956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.684719 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.685177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.687551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.689238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.689695 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:05:30.690447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.708967 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.709652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.710124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251122140530641497"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251122140530641497"
    )
  
[0m14:05:30.769721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.771834 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.772328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.772760 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.778840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.779795 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:30.780504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c64aa58-f025-4453-b2c6-eac7fd04dea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88737cd250>]}
[0m14:05:30.781209 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:05:30.781956 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:30.783928 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.784356 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.784765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:30.785501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.785945 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.786319 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.786712 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.787276 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.787698 [debug] [MainThread]: On master: Close
[0m14:05:30.788167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:30.788526 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:30.788963 [info ] [MainThread]: 
[0m14:05:30.789468 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m14:05:30.790474 [debug] [MainThread]: Command end result
[0m14:05:30.816228 [info ] [MainThread]: 
[0m14:05:30.816871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:30.817385 [info ] [MainThread]: 
[0m14:05:30.817936 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:30.818973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.05933, "process_user_time": 5.609932, "process_kernel_time": 0.311885, "process_mem_max_rss": "333580", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:05:30.819519 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:30.819417 after 11.06 seconds
[0m14:05:30.819987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ca79a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7b7e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c7a58e60>]}
[0m14:05:30.820412 [debug] [MainThread]: Flushing usage events
[0m14:05:32.657548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157c832f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157c45ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915982d370>]}


============================== 14:05:32.660763 | f841a433-fcc0-42a3-ace7-28b29ff29a74 ==============================
[0m14:05:32.660763 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.661458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.780924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f841a433-fcc0-42a3-ace7-28b29ff29a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157bce5a0>]}
[0m14:05:32.799510 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19348136, "process_user_time": 1.402522, "process_kernel_time": 0.118959, "process_mem_max_rss": "99664", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:32.800100 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:32.799995 after 0.19 seconds
[0m14:05:32.800526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9158daa060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9157a38380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91582714c0>]}
[0m14:05:32.800994 [debug] [MainThread]: Flushing usage events
[0m22:06:16.465473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f58df7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f58df9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f58de420>]}


============================== 22:06:16.524213 | 4e586fd0-f9d2-4d15-928b-9af52a86b6f6 ==============================
[0m22:06:16.524213 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:16.524917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:16.760473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e586fd0-f9d2-4d15-928b-9af52a86b6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4ffcdd0>]}
[0m22:06:16.776774 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8d4rxxv5'
[0m22:06:16.777321 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:16.892143 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:16.894082 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:16.942232 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:16.947626 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:17.043860 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:17.044543 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:17.045142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e586fd0-f9d2-4d15-928b-9af52a86b6f6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f5261100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4c703e0>]}
[0m22:06:17.045613 [info ] [MainThread]: 
[0m22:06:17.046103 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:17.077754 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.66445327, "process_user_time": 1.766131, "process_kernel_time": 0.138323, "process_mem_max_rss": "100676", "process_in_blocks": "8760", "process_out_blocks": "5176"}
[0m22:06:17.078520 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:17.078398 after 0.67 seconds
[0m22:06:17.079046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f52912e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4df7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f4b67e90>]}
[0m22:06:17.079527 [debug] [MainThread]: Flushing usage events
[0m22:06:18.859054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62851ed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62856bd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62856bdd00>]}


============================== 22:06:18.862429 | fa1f70ea-5297-45bd-a081-efe2e989a355 ==============================
[0m22:06:18.862429 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.863136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:19.109175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6285de8fe0>]}
[0m22:06:19.173187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62875849e0>]}
[0m22:06:19.175187 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:19.209759 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:19.210620 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:19.211185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62849de210>]}
[0m22:06:20.654751 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:20.655492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627d596d80>]}
[0m22:06:20.928511 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:20.934527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6284c8f410>]}
[0m22:06:21.037158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627d460bc0>]}
[0m22:06:21.037759 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:21.038278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62856ecce0>]}
[0m22:06:21.040317 [info ] [MainThread]: 
[0m22:06:21.041079 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:21.046198 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:21.085269 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:21.085850 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:21.086292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:21.571730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.573582 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:21.574825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:21.575578 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:21.585703 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.586286 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:21.586718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.588266 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.589988 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.590431 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:21.591157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.591611 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.592074 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:21.592813 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.593785 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:21.594205 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:21.594590 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:21.595202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.595613 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:21.597009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:21.603506 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:21.604175 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:21.604585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.605783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.606228 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:21.606602 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:21.619039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:21.620885 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:21.622289 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:21.622715 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:21.624915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62849de060>]}
[0m22:06:21.625455 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.625869 [debug] [MainThread]: On master: BEGIN
[0m22:06:21.626239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:21.627215 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.627669 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.628081 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:21.628472 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.629146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:21.629547 [debug] [MainThread]: On master: Close
[0m22:06:21.630111 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:21.630586 [info ] [MainThread]: 
[0m22:06:21.813944 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:21.814701 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:21.815523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:21.816048 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:21.845030 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:21.845965 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:21.893047 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:21.894054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:29.482575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.483191 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:29.484062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.484505 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.484972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:29.486038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.487520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.487989 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:29.489100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.496462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.497000 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:29.497981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.502675 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.503166 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:29.504038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.521292 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:29.521903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.522340 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:29.524229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.530834 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:29.531373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:29.533036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.535665 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:29.537305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62355950a0>]}
[0m22:06:29.538066 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.72s]
[0m22:06:29.538868 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:29.539865 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:29.540445 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:29.541179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:29.541624 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:29.547178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:29.547908 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:29.585446 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.586050 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251122220629579151"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:29.586529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:29.594058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.602584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.603143 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:29.604011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.604444 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.604878 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251122220629579151'
      
      
      order by ordinal_position

  
[0m22:06:29.607575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.613409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.613959 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:29.616944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.625656 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.626206 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:29.629318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.631250 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.631722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:29.632554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.651016 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:29.651928 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.652437 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251122220629579151"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251122220629579151"
    )
  
[0m22:06:29.711657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.713856 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:29.714363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:29.714836 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:29.722190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:29.723364 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:29.724202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1f70ea-5297-45bd-a081-efe2e989a355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627cd88cb0>]}
[0m22:06:29.724969 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:06:29.725741 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:29.727443 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:29.727912 [debug] [MainThread]: On master: BEGIN
[0m22:06:29.728307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:29.729209 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:29.729616 [debug] [MainThread]: On master: COMMIT
[0m22:06:29.730049 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:29.730418 [debug] [MainThread]: On master: COMMIT
[0m22:06:29.731068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:29.731472 [debug] [MainThread]: On master: Close
[0m22:06:29.732009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:29.732374 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:29.732785 [info ] [MainThread]: 
[0m22:06:29.733304 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m22:06:29.734303 [debug] [MainThread]: Command end result
[0m22:06:29.763593 [info ] [MainThread]: 
[0m22:06:29.764269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:29.764753 [info ] [MainThread]: 
[0m22:06:29.765276 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:29.766299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.960622, "process_user_time": 5.925612, "process_kernel_time": 0.354635, "process_mem_max_rss": "334852", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:29.766874 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:29.766741 after 10.96 seconds
[0m22:06:29.767319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f628508f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627cda8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62346def30>]}
[0m22:06:29.767759 [debug] [MainThread]: Flushing usage events
[0m22:06:31.685593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe806c46510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe805cb51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80540cad0>]}


============================== 22:06:31.689126 | 63f285a0-93e8-4a5c-8d8b-e63f8bded3c0 ==============================
[0m22:06:31.689126 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:31.689892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:31.811166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63f285a0-93e8-4a5c-8d8b-e63f8bded3c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe804bc1580>]}
[0m22:06:31.831064 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19891493, "process_user_time": 1.419081, "process_kernel_time": 0.119837, "process_mem_max_rss": "99536", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:31.831644 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:31.831534 after 0.20 seconds
[0m22:06:31.832132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe804f8f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8049af3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80498f470>]}
[0m22:06:31.832589 [debug] [MainThread]: Flushing usage events
[0m06:02:55.269830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d45c59220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d467362a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d45d26810>]}


============================== 06:02:55.298146 | 42e4f472-b01e-461f-8a5c-7aa50762a376 ==============================
[0m06:02:55.298146 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:55.298858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.508613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42e4f472-b01e-461f-8a5c-7aa50762a376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d449bd700>]}
[0m06:02:55.523748 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-25w7v57_'
[0m06:02:55.524219 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:55.661723 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:55.663082 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:55.732469 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:55.737461 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:55.935864 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:55.936457 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:55.937037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '42e4f472-b01e-461f-8a5c-7aa50762a376', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d4399ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d438e8590>]}
[0m06:02:55.937471 [info ] [MainThread]: 
[0m06:02:55.937985 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:55.956878 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73759365, "process_user_time": 1.624433, "process_kernel_time": 0.147766, "process_mem_max_rss": "100804", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m06:02:55.957419 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:55.957319 after 0.74 seconds
[0m06:02:55.957875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d44584b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d439ac6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d439aca10>]}
[0m06:02:55.958281 [debug] [MainThread]: Flushing usage events
[0m06:02:57.660017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3580dfc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3597f3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc35b1cb530>]}


============================== 06:02:57.663150 | 471154e4-f271-436e-a8cb-fa1a5427d577 ==============================
[0m06:02:57.663150 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:57.663848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:57.891660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3585f8e00>]}
[0m06:02:57.952462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3591739e0>]}
[0m06:02:57.954194 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:57.975589 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:57.976332 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:57.976877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3571c4e30>]}
[0m06:02:59.356466 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:59.357152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34fc9ed80>]}
[0m06:02:59.594944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:59.600336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34f478aa0>]}
[0m06:02:59.701231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34f554da0>]}
[0m06:02:59.701819 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:59.702338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34f5005f0>]}
[0m06:02:59.704208 [info ] [MainThread]: 
[0m06:02:59.704955 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:59.709789 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:59.745683 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:59.746170 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:59.746568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:00.314838 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:03:00.316447 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:00.317300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:00.317855 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:00.325223 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.325654 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:00.326032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.327030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.328579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.329054 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:00.329747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.330127 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.330486 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:00.331116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.332032 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.332429 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:00.332824 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:00.333389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.333801 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:00.335016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:00.340823 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.341221 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:00.341577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:00.342485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.342903 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:00.343277 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:00.353795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:00.355256 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:00.356506 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:00.356937 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:00.358938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3591d5970>]}
[0m06:03:00.359447 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.359856 [debug] [MainThread]: On master: BEGIN
[0m06:03:00.360226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:00.360876 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.361266 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.361651 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:00.362012 [debug] [MainThread]: On master: COMMIT
[0m06:03:00.362586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:00.363001 [debug] [MainThread]: On master: Close
[0m06:03:00.363476 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:00.363963 [info ] [MainThread]: 
[0m06:03:00.386083 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:00.386691 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:00.387319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:00.387787 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:00.414629 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:00.415369 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:00.451377 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:00.452192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.414566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.415118 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:10.415793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.416241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.416711 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.417722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.419315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.419786 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.420982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.428891 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.429348 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:10.430112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.433122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.433561 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:10.434298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.450942 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.451401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.451837 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.454309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.460131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.460581 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:10.462025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.464457 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:10.465989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc303f0ecf0>]}
[0m06:03:10.466691 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.08s]
[0m06:03:10.467444 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:10.468244 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:10.468811 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:10.469440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:10.469911 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:10.474894 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:10.475783 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:10.511783 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.512270 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251123060310505796"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:10.512746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.519510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.526899 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.527341 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:10.527997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.528425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.528863 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251123060310505796'
      
      
      order by ordinal_position

  
[0m06:03:10.531292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.536392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.536863 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.539305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.546936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.547389 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.550298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.551973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.552413 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:10.553147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.571470 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:10.572161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.572631 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251123060310505796"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251123060310505796"
    )
  
[0m06:03:10.629945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.631942 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.632380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.632814 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.638092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.638984 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:10.639666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471154e4-f271-436e-a8cb-fa1a5427d577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30321ea50>]}
[0m06:03:10.640329 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:10.641141 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:10.642755 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.643174 [debug] [MainThread]: On master: BEGIN
[0m06:03:10.643546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:10.644261 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.644684 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.645058 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.645421 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.646040 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.646425 [debug] [MainThread]: On master: Close
[0m06:03:10.646939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:10.647299 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:10.647715 [info ] [MainThread]: 
[0m06:03:10.648165 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.94 seconds (10.94s).
[0m06:03:10.649078 [debug] [MainThread]: Command end result
[0m06:03:10.674608 [info ] [MainThread]: 
[0m06:03:10.675165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:10.675632 [info ] [MainThread]: 
[0m06:03:10.676094 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:10.677048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.069069, "process_user_time": 5.712059, "process_kernel_time": 0.301214, "process_mem_max_rss": "365612", "process_in_blocks": "1200", "process_out_blocks": "107312"}
[0m06:03:10.677580 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:10.677479 after 13.07 seconds
[0m06:03:10.678037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3574431d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc357844740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc357817dd0>]}
[0m06:03:10.678462 [debug] [MainThread]: Flushing usage events
[0m06:03:12.512816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f599835ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5998f6bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5997465eb0>]}


============================== 06:03:12.516035 | 3a156b8d-77a2-4f69-911e-e84dc86c3012 ==============================
[0m06:03:12.516035 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:12.516742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:12.631255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a156b8d-77a2-4f69-911e-e84dc86c3012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59966abd70>]}
[0m06:03:12.649627 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1881399, "process_user_time": 1.323672, "process_kernel_time": 0.111972, "process_mem_max_rss": "99408", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:12.650170 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:12.650062 after 0.19 seconds
[0m06:03:12.650607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5996c30fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5996490380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59964ecb90>]}
[0m06:03:12.651034 [debug] [MainThread]: Flushing usage events
[0m14:05:21.028336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65876ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65597980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65597aa0>]}


============================== 14:05:21.040976 | 473d1c3f-5780-4d79-9d90-bd6dff4ff144 ==============================
[0m14:05:21.040976 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:21.041720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:21.211437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '473d1c3f-5780-4d79-9d90-bd6dff4ff144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65809f70>]}
[0m14:05:21.227416 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gvrxvb98'
[0m14:05:21.227918 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:21.412713 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:21.414447 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:21.450633 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:21.455541 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:21.614554 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:21.615171 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:05:21.615725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '473d1c3f-5780-4d79-9d90-bd6dff4ff144', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc657a0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65140800>]}
[0m14:05:21.616235 [info ] [MainThread]: 
[0m14:05:21.616707 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:21.638410 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6609263, "process_user_time": 1.64401, "process_kernel_time": 0.152278, "process_mem_max_rss": "101016", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m14:05:21.639096 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:21.638935 after 0.66 seconds
[0m14:05:21.639564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6553af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc657a2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc657a0ef0>]}
[0m14:05:21.639995 [debug] [MainThread]: Flushing usage events
[0m14:05:23.303566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84d5654c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84cabbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84d46d4f0>]}


============================== 14:05:23.306618 | 6a0e5afa-5081-42a4-96e6-374b31777f04 ==============================
[0m14:05:23.306618 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.307326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.537655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84d9f0e90>]}
[0m14:05:23.599389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84cb317f0>]}
[0m14:05:23.601223 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:05:23.621787 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:23.622551 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:23.623085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff845030b90>]}
[0m14:05:25.010527 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:25.011199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff845103b60>]}
[0m14:05:25.248819 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:25.254213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff844899760>]}
[0m14:05:25.349408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8449470e0>]}
[0m14:05:25.349989 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:05:25.350573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8451df9b0>]}
[0m14:05:25.352472 [info ] [MainThread]: 
[0m14:05:25.353224 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:25.358116 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:25.393942 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:25.394414 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:25.394804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:25.809259 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.812847 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:25.813957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:25.814533 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:25.821954 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.822390 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:25.822764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:25.824248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.825602 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.825990 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:25.826636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.827014 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.827438 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:25.828066 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.828969 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:25.829398 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:25.829760 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:25.830381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.830787 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:25.832029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:25.838158 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:25.838558 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:25.838921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:25.839620 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.840005 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:25.840404 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:25.851427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:25.852929 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:25.854218 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:25.854620 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:25.856829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff844906300>]}
[0m14:05:25.857375 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:25.857752 [debug] [MainThread]: On master: BEGIN
[0m14:05:25.858135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:25.858783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:25.859202 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.859573 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:25.859932 [debug] [MainThread]: On master: COMMIT
[0m14:05:25.860520 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:25.860912 [debug] [MainThread]: On master: Close
[0m14:05:25.861419 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:25.861889 [info ] [MainThread]: 
[0m14:05:25.881527 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:25.882160 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:25.882831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:25.883293 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:25.910080 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:25.910839 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:25.946256 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:25.947057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.934986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.935567 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:34.936315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.936756 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.937215 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:34.938212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.939566 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.940016 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:05:34.941080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.947807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.948284 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:34.949116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.953298 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.953743 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:34.954526 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.971217 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.971688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.972133 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:34.973545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.979558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:34.980015 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:05:34.981215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:34.983690 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:34.985241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8451df6e0>]}
[0m14:05:34.985929 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.10s]
[0m14:05:34.986712 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:34.987727 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:34.988328 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:34.988891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:34.989382 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:34.994477 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:34.995141 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:35.031844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.032410 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251123140535025716"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:35.032873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:35.040058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.047988 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.048498 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:35.049261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.049695 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.050163 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251123140535025716'
      
      
      order by ordinal_position

  
[0m14:05:35.052719 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.058138 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.058597 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:35.061027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.069276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.069802 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:35.072638 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.074463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.074916 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:05:35.075708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.093337 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:35.094141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.094606 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251123140535025716"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251123140535025716"
    )
  
[0m14:05:35.153010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.155054 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:35.155507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.155916 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:35.161911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.162835 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:35.163538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0e5afa-5081-42a4-96e6-374b31777f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff844729430>]}
[0m14:05:35.164223 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:05:35.164950 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:35.166615 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.167078 [debug] [MainThread]: On master: BEGIN
[0m14:05:35.167474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:35.168163 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.168566 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.168955 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.169392 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.169972 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.170399 [debug] [MainThread]: On master: Close
[0m14:05:35.170858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:35.171245 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:35.171641 [info ] [MainThread]: 
[0m14:05:35.172173 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.82 seconds (9.82s).
[0m14:05:35.173192 [debug] [MainThread]: Command end result
[0m14:05:35.200141 [info ] [MainThread]: 
[0m14:05:35.200786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:35.201329 [info ] [MainThread]: 
[0m14:05:35.201858 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:35.202876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.949886, "process_user_time": 5.218987, "process_kernel_time": 0.274631, "process_mem_max_rss": "334104", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:05:35.203467 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:35.203361 after 11.95 seconds
[0m14:05:35.203904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84d9a7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84cc7c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7fc1cf8f0>]}
[0m14:05:35.204356 [debug] [MainThread]: Flushing usage events
[0m14:05:37.084948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93644caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93689f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93644e7b0>]}


============================== 14:05:37.088258 | f9af1dd8-72ee-4a0e-96e8-6640c053628e ==============================
[0m14:05:37.088258 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:37.088947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:37.204435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9af1dd8-72ee-4a0e-96e8-6640c053628e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe937d1b980>]}
[0m14:05:37.223001 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19037297, "process_user_time": 1.380766, "process_kernel_time": 0.09991, "process_mem_max_rss": "99476", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:37.223574 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:37.223470 after 0.19 seconds
[0m14:05:37.223996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93618bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe937d1b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe935ccbe00>]}
[0m14:05:37.224446 [debug] [MainThread]: Flushing usage events
[0m22:06:44.249694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bcb13650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bda18740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bcd83b30>]}


============================== 22:06:44.263793 | a4794751-6439-48b4-bd0e-aa9bff333ce1 ==============================
[0m22:06:44.263793 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:44.264419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:44.434346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4794751-6439-48b4-bd0e-aa9bff333ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bc7be600>]}
[0m22:06:44.448859 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e1t8ytn4'
[0m22:06:44.449295 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:44.629382 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:44.630588 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:44.672787 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:44.677366 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:44.771600 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:44.772162 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:44.772724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a4794751-6439-48b4-bd0e-aa9bff333ce1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bc6cc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bc679550>]}
[0m22:06:44.773172 [info ] [MainThread]: 
[0m22:06:44.773652 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:44.786321 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5870858, "process_user_time": 1.61788, "process_kernel_time": 0.125455, "process_mem_max_rss": "100944", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m22:06:44.786881 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:44.786777 after 0.59 seconds
[0m22:06:44.787302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c0f63920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bca5e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48bc730ce0>]}
[0m22:06:44.787726 [debug] [MainThread]: Flushing usage events
[0m22:06:46.361281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500f27ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5011a86de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500fa914c0>]}


============================== 22:06:46.364381 | 63fbde7e-b0d0-41d4-aba2-c13bf138d2d3 ==============================
[0m22:06:46.364381 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:46.365041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:46.601252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50077925d0>]}
[0m22:06:46.662202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500fbd7ce0>]}
[0m22:06:46.663827 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:46.685087 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:46.685821 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:46.686341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50077d7470>]}
[0m22:06:48.060400 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:48.061033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006e977d0>]}
[0m22:06:48.291343 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:48.296474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006e96150>]}
[0m22:06:48.395032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006f4b710>]}
[0m22:06:48.395582 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:48.396106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006d46d20>]}
[0m22:06:48.397937 [info ] [MainThread]: 
[0m22:06:48.398632 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:48.403463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:48.439436 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:48.439891 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:48.440281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:48.850159 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.851974 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:48.852955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:48.853576 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:48.862156 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:48.862637 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:48.863159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:48.864354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.865822 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:48.866213 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:48.866806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.867189 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:48.867547 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:48.868172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.869089 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:48.869475 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:48.869863 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:48.870436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.870848 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:48.872033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:48.877920 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:48.878324 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:48.878681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:48.879405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.879838 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:48.880216 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:48.891079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:48.892594 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:48.893866 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:48.894275 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:48.896435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5005ab6690>]}
[0m22:06:48.896955 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.897334 [debug] [MainThread]: On master: BEGIN
[0m22:06:48.897692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:48.898397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.898817 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.899184 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:48.899538 [debug] [MainThread]: On master: COMMIT
[0m22:06:48.900119 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:48.900503 [debug] [MainThread]: On master: Close
[0m22:06:48.901008 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:48.901484 [info ] [MainThread]: 
[0m22:06:48.921995 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:48.922571 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:48.923222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:48.923655 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:48.949860 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:48.950581 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:48.985468 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:48.986212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:57.352482 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.353030 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:57.353676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.354139 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.354560 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:57.355548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.356924 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.357363 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:57.358534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.366466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.366954 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:57.367788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.370771 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.371216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:57.371964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.388587 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:57.389074 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.389498 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:57.390844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.396482 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:57.396965 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:57.398750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.401124 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:57.402633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5005a8bd40>]}
[0m22:06:57.403339 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.48s]
[0m22:06:57.404115 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:57.405102 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:57.405652 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:57.406246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:57.406677 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:57.411637 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:57.412299 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:57.447953 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.448437 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251123220657441998"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:57.448915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:57.455759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.463048 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.463496 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:57.464153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.464582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.465029 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251123220657441998'
      
      
      order by ordinal_position

  
[0m22:06:57.467365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.472533 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.473008 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:57.475425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.483029 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.483483 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:57.485932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.487594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.488063 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:57.488770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.506815 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:57.507473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.507944 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251123220657441998"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251123220657441998"
    )
  
[0m22:06:57.567222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.569211 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:57.569664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:57.570103 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:57.576244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:57.577157 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:57.577871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63fbde7e-b0d0-41d4-aba2-c13bf138d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006d6c6e0>]}
[0m22:06:57.578541 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:57.579267 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:57.581264 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:57.581682 [debug] [MainThread]: On master: BEGIN
[0m22:06:57.582101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:57.582842 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:57.583249 [debug] [MainThread]: On master: COMMIT
[0m22:06:57.583624 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:57.584090 [debug] [MainThread]: On master: COMMIT
[0m22:06:57.584769 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:57.585176 [debug] [MainThread]: On master: Close
[0m22:06:57.585633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:57.586033 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:57.586439 [info ] [MainThread]: 
[0m22:06:57.586967 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m22:06:57.587990 [debug] [MainThread]: Command end result
[0m22:06:57.613173 [info ] [MainThread]: 
[0m22:06:57.613763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:57.614253 [info ] [MainThread]: 
[0m22:06:57.614763 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:57.615755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.3056, "process_user_time": 5.103142, "process_kernel_time": 0.288403, "process_mem_max_rss": "346640", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:57.616296 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:57.616193 after 11.31 seconds
[0m22:06:57.616745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5011a2ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500fafe180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500f2a8620>]}
[0m22:06:57.617172 [debug] [MainThread]: Flushing usage events
[0m22:06:59.267747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a24d57290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a24d54a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2536cf80>]}


============================== 22:06:59.270717 | 4c1e7ae8-bc9d-4213-b94e-6b4361b555ef ==============================
[0m22:06:59.270717 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:59.271396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:59.385048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c1e7ae8-bc9d-4213-b94e-6b4361b555ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a25eaae40>]}
[0m22:06:59.402650 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18487474, "process_user_time": 1.307487, "process_kernel_time": 0.10804, "process_mem_max_rss": "99944", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:59.403247 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:59.403148 after 0.19 seconds
[0m22:06:59.403653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2582cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a24b6c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a24d1a180>]}
[0m22:06:59.404086 [debug] [MainThread]: Flushing usage events
[0m06:03:00.336598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71c754c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d729a7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d729a68d0>]}


============================== 06:03:00.347844 | 2467c20f-9c05-4130-b363-9e1115d79fd8 ==============================
[0m06:03:00.347844 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:00.348485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:03:00.479081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2467c20f-9c05-4130-b363-9e1115d79fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7243af60>]}
[0m06:03:00.492233 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ad7etkns'
[0m06:03:00.492675 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:03:00.630667 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:03:00.632332 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:03:00.714738 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:03:00.719504 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:03:01.002179 [info ] [MainThread]: Installed from version 1.2.0
[0m06:03:01.002780 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:03:01.003288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2467c20f-9c05-4130-b363-9e1115d79fd8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71575fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71576390>]}
[0m06:03:01.003763 [info ] [MainThread]: 
[0m06:03:01.004172 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:03:01.014329 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7215606, "process_user_time": 1.477729, "process_kernel_time": 0.088222, "process_mem_max_rss": "101216", "process_in_blocks": "8768", "process_out_blocks": "5176"}
[0m06:03:01.014951 [debug] [MainThread]: Command `dbt deps` succeeded at 06:03:01.014846 after 0.72 seconds
[0m06:03:01.015448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71eb27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7243af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71c34860>]}
[0m06:03:01.015847 [debug] [MainThread]: Flushing usage events
[0m06:03:02.596833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead1651dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf0eddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf076b40>]}


============================== 06:03:02.599623 | 2c72f1ae-ec9c-4115-86a8-f4055526ef7a ==============================
[0m06:03:02.599623 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:02.600190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:02.802446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feace8b14c0>]}
[0m06:03:02.856142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf590ec0>]}
[0m06:03:02.857799 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:03:02.888629 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:03:02.889241 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:03:02.889728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac7336810>]}
[0m06:03:04.083877 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:03:04.084495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacea04770>]}
[0m06:03:04.293432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:03:04.298331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac6933f20>]}
[0m06:03:04.383226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac6b52f60>]}
[0m06:03:04.383757 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:03:04.384190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac6afb3e0>]}
[0m06:03:04.386073 [info ] [MainThread]: 
[0m06:03:04.386713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:03:04.391020 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:03:04.421736 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:03:04.422178 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:03:04.422538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:05.049939 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:03:05.051789 [debug] [ThreadPool]: On list_petro: Close
[0m06:03:05.052787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:03:05.053438 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:03:05.060127 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.060533 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:03:05.060864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:05.061849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.063128 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.063494 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:03:05.064882 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.065244 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.065589 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:03:05.066153 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.067027 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:05.067389 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:03:05.067696 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:03:05.068211 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.068574 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:03:05.069761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:03:05.075171 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:05.075636 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:03:05.075945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:05.076573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.076935 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:03:05.077255 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:03:05.087896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:03:05.089285 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:03:05.090440 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:03:05.090797 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:03:05.092774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac6b25a90>]}
[0m06:03:05.093232 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:05.093586 [debug] [MainThread]: On master: BEGIN
[0m06:03:05.093891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:03:05.094502 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:05.094864 [debug] [MainThread]: On master: COMMIT
[0m06:03:05.095180 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:05.095505 [debug] [MainThread]: On master: COMMIT
[0m06:03:05.095999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:05.096347 [debug] [MainThread]: On master: Close
[0m06:03:05.096765 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:03:05.097190 [info ] [MainThread]: 
[0m06:03:05.114031 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:03:05.114612 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:03:05.115129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:03:05.115524 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:03:05.139491 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:03:05.140122 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:05.171673 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:05.172333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:15.442962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.443479 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:15.444092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.444517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.444876 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:15.445782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.447099 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.447525 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:15.448500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.454773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.455189 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:15.455898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.459841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.460244 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:15.460918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.475879 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:15.476308 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.476673 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:15.478044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.483222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:15.483672 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:15.484734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.486894 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:15.488313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf4e4950>]}
[0m06:03:15.488977 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.37s]
[0m06:03:15.489671 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:15.490596 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:15.491115 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:15.491698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:15.492113 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:15.498475 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:15.499836 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:15.532818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.533277 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251124060315527398"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:15.533664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:15.540907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.547684 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.548086 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:15.548680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.549047 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.549408 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251124060315527398'
      
      
      order by ordinal_position

  
[0m06:03:15.551819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.556602 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.557012 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:15.559418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.566362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.566776 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:15.569498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.571044 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.571460 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:15.572149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.587067 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:15.587678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.588068 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251124060315527398"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251124060315527398"
    )
  
[0m06:03:15.647256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.649106 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:15.649562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:15.649917 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:15.656114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:15.656951 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:15.657582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c72f1ae-ec9c-4115-86a8-f4055526ef7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea8053c650>]}
[0m06:03:15.658190 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:03:15.658857 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:15.660349 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:15.660831 [debug] [MainThread]: On master: BEGIN
[0m06:03:15.661176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:15.661855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:15.662209 [debug] [MainThread]: On master: COMMIT
[0m06:03:15.662557 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:15.662864 [debug] [MainThread]: On master: COMMIT
[0m06:03:15.663404 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:15.663774 [debug] [MainThread]: On master: Close
[0m06:03:15.664193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:15.664530 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:15.664867 [info ] [MainThread]: 
[0m06:03:15.665326 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m06:03:15.666197 [debug] [MainThread]: Command end result
[0m06:03:15.690202 [info ] [MainThread]: 
[0m06:03:15.690770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:15.691235 [info ] [MainThread]: 
[0m06:03:15.691731 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:15.692612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.139614, "process_user_time": 4.678389, "process_kernel_time": 0.218158, "process_mem_max_rss": "347804", "process_in_blocks": "1200", "process_out_blocks": "107312"}
[0m06:03:15.693136 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:15.693054 after 13.14 seconds
[0m06:03:15.693591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacf077f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea819baab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feacee962d0>]}
[0m06:03:15.693968 [debug] [MainThread]: Flushing usage events
[0m06:03:17.356408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6256bfd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62598ea120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f625771c200>]}


============================== 06:03:17.359425 | 7ba61536-fbfc-416d-a0e9-d97184b91206 ==============================
[0m06:03:17.359425 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:17.359995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:03:17.458917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ba61536-fbfc-416d-a0e9-d97184b91206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62571b4e00>]}
[0m06:03:17.472009 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16053708, "process_user_time": 1.182384, "process_kernel_time": 0.063912, "process_mem_max_rss": "99604", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:03:17.472525 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:17.472437 after 0.16 seconds
[0m06:03:17.472883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6257954260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62571b4e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6256ee2ea0>]}
[0m06:03:17.473241 [debug] [MainThread]: Flushing usage events
[0m14:06:27.275899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafab20d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa975040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafad1c320>]}


============================== 14:06:27.290765 | 0c991ff8-8276-4421-a7a0-695f86787889 ==============================
[0m14:06:27.290765 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:27.291437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:27.463115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c991ff8-8276-4421-a7a0-695f86787889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa8075f0>]}
[0m14:06:27.478290 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0u_fr699'
[0m14:06:27.478750 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:27.673735 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:27.675434 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:27.717496 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:27.722464 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:27.798611 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:27.799210 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:27.799778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0c991ff8-8276-4421-a7a0-695f86787889', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa6ce450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa6cef00>]}
[0m14:06:27.800265 [info ] [MainThread]: 
[0m14:06:27.800771 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:27.812975 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5883191, "process_user_time": 1.663693, "process_kernel_time": 0.141973, "process_mem_max_rss": "101088", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m14:06:27.813612 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:27.813507 after 0.59 seconds
[0m14:06:27.814117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafad85250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafa979d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdafaabdee0>]}
[0m14:06:27.814575 [debug] [MainThread]: Flushing usage events
[0m14:06:29.354192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba7c65430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba79f0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba79554c0>]}


============================== 14:06:29.357241 | e095a6a3-8d59-43e2-b5c0-dff51bea484c ==============================
[0m14:06:29.357241 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:29.357871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:29.589558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba76a38c0>]}
[0m14:06:29.650988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba76e0350>]}
[0m14:06:29.652683 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:29.688641 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:29.689390 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:29.689910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba014a060>]}
[0m14:06:31.078218 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:31.078890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba003ce60>]}
[0m14:06:31.321186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:31.326589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9f9bec60>]}
[0m14:06:31.489810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba00954c0>]}
[0m14:06:31.490419 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:31.490927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba78e3e60>]}
[0m14:06:31.492979 [info ] [MainThread]: 
[0m14:06:31.493724 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:31.498582 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:31.537109 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:31.537567 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:31.538025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:31.863869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.866035 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:31.867159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:31.867921 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:31.875502 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:31.875913 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:31.876312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:31.877564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.878845 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:31.879255 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:31.879854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.880255 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:31.880608 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:31.881307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.882234 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:31.882617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:31.882970 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:31.883591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.883979 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:31.885180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:31.890878 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:31.891297 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:31.891655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:31.892324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.892711 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:31.893113 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:31.903253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:31.904670 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:31.905879 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:31.906285 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:31.908393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba8aab560>]}
[0m14:06:31.908886 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:31.909308 [debug] [MainThread]: On master: BEGIN
[0m14:06:31.909667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:31.910315 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:31.910711 [debug] [MainThread]: On master: COMMIT
[0m14:06:31.911103 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:31.911471 [debug] [MainThread]: On master: COMMIT
[0m14:06:31.912060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:31.912452 [debug] [MainThread]: On master: Close
[0m14:06:31.912929 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:31.913405 [info ] [MainThread]: 
[0m14:06:31.934292 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:31.934874 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:31.935452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:31.935878 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:31.962430 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:31.963181 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:31.998239 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:31.998941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:39.295348 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.295895 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:39.296662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.297121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.297539 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:39.298541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.299889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.300355 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:39.301326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.308164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.308615 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:39.309377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.313498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.313940 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:39.314728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.331289 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:39.331742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.332179 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:39.333955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.339738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:39.340209 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:39.341364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.343769 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:39.345283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba962afc0>]}
[0m14:06:39.345956 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.41s]
[0m14:06:39.346732 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:39.347682 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:39.348254 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:39.348816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:39.349281 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:39.354258 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:39.354902 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:39.390939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.391441 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251124140639384913"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:39.391888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:39.398858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.406384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.406834 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:39.407496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.407931 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.408378 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251124140639384913'
      
      
      order by ordinal_position

  
[0m14:06:39.410840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.416110 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.416567 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:39.418941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.426616 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.427091 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:39.429420 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.431091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.431530 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:39.432251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.449519 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:39.450236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.450686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251124140639384913"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251124140639384913"
    )
  
[0m14:06:39.509984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.511985 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:39.512459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:39.512870 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:39.518422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:39.519341 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:39.520014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e095a6a3-8d59-43e2-b5c0-dff51bea484c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b5df1f0e0>]}
[0m14:06:39.520676 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:06:39.521410 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:39.523485 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:39.523891 [debug] [MainThread]: On master: BEGIN
[0m14:06:39.524301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:39.524962 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:39.525385 [debug] [MainThread]: On master: COMMIT
[0m14:06:39.525757 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:39.526155 [debug] [MainThread]: On master: COMMIT
[0m14:06:39.526750 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:39.527185 [debug] [MainThread]: On master: Close
[0m14:06:39.527650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:39.528035 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:39.528444 [info ] [MainThread]: 
[0m14:06:39.528900 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.03 seconds (8.03s).
[0m14:06:39.529821 [debug] [MainThread]: Command end result
[0m14:06:39.556652 [info ] [MainThread]: 
[0m14:06:39.557258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:39.557705 [info ] [MainThread]: 
[0m14:06:39.558196 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:39.559158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.255344, "process_user_time": 5.183659, "process_kernel_time": 0.28209, "process_mem_max_rss": "342008", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:39.559694 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:39.559593 after 10.26 seconds
[0m14:06:39.560150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba7c65430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ba78e0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b538b0650>]}
[0m14:06:39.560578 [debug] [MainThread]: Flushing usage events
[0m14:06:41.334204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca40b1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca21cd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca1dc0350>]}


============================== 14:06:41.337247 | e2c37c4c-cf17-4ff0-89a7-3965c686a37c ==============================
[0m14:06:41.337247 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:41.337922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:41.452493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2c37c4c-cf17-4ff0-89a7-3965c686a37c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca17f3f20>]}
[0m14:06:41.470203 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.187202, "process_user_time": 1.333678, "process_kernel_time": 0.105895, "process_mem_max_rss": "99612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:41.470736 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:41.470633 after 0.19 seconds
[0m14:06:41.471178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca5ad3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca1b90920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca154b170>]}
[0m14:06:41.471584 [debug] [MainThread]: Flushing usage events
[0m22:06:03.496335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527eb81220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527eb109b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527f7197f0>]}


============================== 22:06:03.508623 | 263eddb1-c7c2-4794-8e22-5f684b97f970 ==============================
[0m22:06:03.508623 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:03.509232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:03.659296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '263eddb1-c7c2-4794-8e22-5f684b97f970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527e836540>]}
[0m22:06:03.673453 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wnoad0wi'
[0m22:06:03.673938 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:03.774619 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:03.776532 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:03.838906 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:03.844082 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:04.215179 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:04.215770 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:06:04.216333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '263eddb1-c7c2-4794-8e22-5f684b97f970', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527e7f7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527e86a750>]}
[0m22:06:04.216754 [info ] [MainThread]: 
[0m22:06:04.217220 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:04.226626 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7752152, "process_user_time": 1.538517, "process_kernel_time": 0.089971, "process_mem_max_rss": "101076", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m22:06:04.227339 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:04.227206 after 0.78 seconds
[0m22:06:04.227788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527f878740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527e72ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527ee54080>]}
[0m22:06:04.228177 [debug] [MainThread]: Flushing usage events
[0m22:06:05.859221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3440c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c33a5da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c33a5dac0>]}


============================== 22:06:05.862154 | b61856d0-a080-497d-a977-389ef0e40ab4 ==============================
[0m22:06:05.862154 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.862762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:06.070157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c338a04d0>]}
[0m22:06:06.124930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c33d01f70>]}
[0m22:06:06.126712 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:06.145588 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:06.146289 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:06.146761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c339b2240>]}
[0m22:06:07.348172 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:07.348698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c29fd70>]}
[0m22:06:07.568879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:07.574014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c11a870>]}
[0m22:06:07.660991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c18ab70>]}
[0m22:06:07.661558 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:07.661995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c1563c0>]}
[0m22:06:07.663876 [info ] [MainThread]: 
[0m22:06:07.664541 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:07.668973 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:07.700548 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:07.701022 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:07.701382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:08.274377 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:08.276471 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:08.277509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:08.278174 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:08.285221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:08.285629 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:08.285950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:08.287047 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.288346 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:08.288693 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:08.289768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.290109 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:08.290439 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:08.291018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.291895 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:08.292220 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:08.292546 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:08.293053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.293402 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:08.294753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:08.300642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:08.301014 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:08.301343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:08.302462 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.302799 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:08.303102 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:08.313156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:08.314702 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:08.315924 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:08.316316 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:08.318064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c0dc860>]}
[0m22:06:08.318571 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:08.318908 [debug] [MainThread]: On master: BEGIN
[0m22:06:08.319212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:08.319911 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:08.320310 [debug] [MainThread]: On master: COMMIT
[0m22:06:08.320644 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:08.320949 [debug] [MainThread]: On master: COMMIT
[0m22:06:08.321511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:08.321857 [debug] [MainThread]: On master: Close
[0m22:06:08.322330 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:08.322758 [info ] [MainThread]: 
[0m22:06:08.340031 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:08.340650 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:08.341215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:08.341634 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:08.366231 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:08.367012 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:08.399096 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:08.399863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:19.017190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.017720 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:19.018401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.018812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.019156 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:19.020106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.021434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.021831 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:19.022805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.029300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.029720 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:19.030499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.034699 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.035105 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:19.035882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.051219 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:19.051670 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.052029 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:19.054041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.059410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:19.059831 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:19.061096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.063392 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:19.064846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0c983530>]}
[0m22:06:19.065511 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.72s]
[0m22:06:19.066196 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:19.067160 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:19.067688 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:19.068209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:19.068625 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:19.073556 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:19.074162 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:19.106930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.107452 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251124220619101412"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:19.107863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:19.115119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.122369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.122823 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:19.123602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.123996 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.124365 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251124220619101412'
      
      
      order by ordinal_position

  
[0m22:06:19.126967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.132078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.132514 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:19.135065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.142388 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.142805 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:19.145616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.147243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.147665 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:19.148363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.163642 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:19.164326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.164742 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251124220619101412"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251124220619101412"
    )
  
[0m22:06:19.226803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.228655 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:19.229081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:19.229454 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:19.235555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:19.236440 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:19.237101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b61856d0-a080-497d-a977-389ef0e40ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2795d280>]}
[0m22:06:19.237741 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:06:19.238362 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:19.239928 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:19.240350 [debug] [MainThread]: On master: BEGIN
[0m22:06:19.240698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:19.241447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:19.241815 [debug] [MainThread]: On master: COMMIT
[0m22:06:19.242133 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:19.242508 [debug] [MainThread]: On master: COMMIT
[0m22:06:19.243064 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:19.243460 [debug] [MainThread]: On master: Close
[0m22:06:19.243886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:19.244202 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:19.244587 [info ] [MainThread]: 
[0m22:06:19.245030 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.58 seconds (11.58s).
[0m22:06:19.245953 [debug] [MainThread]: Command end result
[0m22:06:19.270906 [info ] [MainThread]: 
[0m22:06:19.271546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:19.271956 [info ] [MainThread]: 
[0m22:06:19.272526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:19.273485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.459174, "process_user_time": 4.834718, "process_kernel_time": 0.220123, "process_mem_max_rss": "347756", "process_in_blocks": "1200", "process_out_blocks": "107336"}
[0m22:06:19.274040 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:19.273955 after 13.46 seconds
[0m22:06:19.274452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3440c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be6278500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2c033500>]}
[0m22:06:19.274841 [debug] [MainThread]: Flushing usage events
[0m22:06:21.055902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553ac51b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553aedee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553b26d490>]}


============================== 22:06:21.058801 | a7e40c54-4cb2-42fa-8a76-b994bf58fc67 ==============================
[0m22:06:21.058801 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.059434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:21.161800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7e40c54-4cb2-42fa-8a76-b994bf58fc67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553a86c8f0>]}
[0m22:06:21.176600 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1657763, "process_user_time": 1.201764, "process_kernel_time": 0.075921, "process_mem_max_rss": "99848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:21.177129 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:21.177038 after 0.17 seconds
[0m22:06:21.177558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553abb81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553a9df770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553a84e330>]}
[0m22:06:21.177937 [debug] [MainThread]: Flushing usage events
[0m06:02:54.965180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aeb21310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aedf1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aeac0c80>]}


============================== 06:02:54.976440 | 3f1ba568-b3a4-4ead-9c99-d460fb8a7716 ==============================
[0m06:02:54.976440 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:54.977119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:55.134851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f1ba568-b3a4-4ead-9c99-d460fb8a7716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aedcc560>]}
[0m06:02:55.149746 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zkds8frr'
[0m06:02:55.150250 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:55.282576 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:55.284637 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:55.366768 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:55.371582 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:55.647468 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:55.648061 [info ] [MainThread]: Updated version available: 1.3.2
[0m06:02:55.648562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3f1ba568-b3a4-4ead-9c99-d460fb8a7716', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ae80b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ae6d3110>]}
[0m06:02:55.648978 [info ] [MainThread]: 
[0m06:02:55.649398 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:55.657038 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73726165, "process_user_time": 1.506481, "process_kernel_time": 0.10675, "process_mem_max_rss": "101356", "process_in_blocks": "8768", "process_out_blocks": "5168"}
[0m06:02:55.657751 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:55.657645 after 0.74 seconds
[0m06:02:55.658152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03b2f63920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aec2e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03af63f9e0>]}
[0m06:02:55.658575 [debug] [MainThread]: Flushing usage events
[0m06:02:57.299328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a6a31a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5d29970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5d29940>]}


============================== 06:02:57.302648 | da2096f6-6ed9-45d3-9ab5-a89777c0806f ==============================
[0m06:02:57.302648 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:57.303321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:57.513306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5a3cce0>]}
[0m06:02:57.567199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5b875c0>]}
[0m06:02:57.569096 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:02:57.593723 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:57.594440 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:57.594911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5b85130>]}
[0m06:02:58.808304 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:58.808898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5a9baa0>]}
[0m06:02:59.051072 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:59.056223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19ddb3e30>]}
[0m06:02:59.143822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19e46dbe0>]}
[0m06:02:59.144436 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:02:59.144860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19dc6fd70>]}
[0m06:02:59.146869 [info ] [MainThread]: 
[0m06:02:59.147587 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:59.152095 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:59.183619 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:59.184026 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:59.184376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:59.887453 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:59.889181 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:59.890133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:59.890680 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:59.897977 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:59.898382 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:59.898706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:59.899754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.901022 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:59.901392 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:59.902545 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.902889 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:59.903193 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:59.903784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.904643 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:59.904999 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:59.905323 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:59.905837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.906180 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:59.907404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:59.913092 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:59.913475 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:59.913787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:59.914441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.914780 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:59.915091 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:59.925348 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:59.926787 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:59.928024 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:59.928405 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:59.930131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19c9da390>]}
[0m06:02:59.930643 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:59.930970 [debug] [MainThread]: On master: BEGIN
[0m06:02:59.931310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:59.931947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:59.932326 [debug] [MainThread]: On master: COMMIT
[0m06:02:59.932639 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:59.932937 [debug] [MainThread]: On master: COMMIT
[0m06:02:59.933456 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:59.933790 [debug] [MainThread]: On master: Close
[0m06:02:59.934243 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:59.934685 [info ] [MainThread]: 
[0m06:02:59.959100 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:59.959708 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:59.960268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:59.960677 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:59.985147 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:59.985869 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:03:00.018617 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:03:00.019585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.168463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.169035 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:03:10.169864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.170323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.170698 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.171673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.173054 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.173492 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:03:10.175112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.183479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.183902 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:03:10.184664 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.187720 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.188121 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:03:10.188823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.204158 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.204614 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.204968 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:03:10.206501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.211964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:03:10.212404 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:03:10.213945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.216344 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:03:10.217846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a7a76ab0>]}
[0m06:03:10.218559 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.26s]
[0m06:03:10.219299 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:03:10.220172 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:03:10.220726 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:03:10.221312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:03:10.221937 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:03:10.226834 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:03:10.227456 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:03:10.261412 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.262019 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251125060310255630"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:03:10.262453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:10.271586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.279136 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.279598 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:03:10.280346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.280751 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.281106 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251125060310255630'
      
      
      order by ordinal_position

  
[0m06:03:10.283852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.289004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.289434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.292350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.299537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.299955 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:03:10.302684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.304313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.304718 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:03:10.305403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.322046 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:03:10.322794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.323240 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251125060310255630"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251125060310255630"
    )
  
[0m06:03:10.391354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.393455 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.393895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:03:10.394268 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:03:10.401150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:03:10.402060 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:03:10.402769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2096f6-6ed9-45d3-9ab5-a89777c0806f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153fb9eb0>]}
[0m06:03:10.403491 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:03:10.404138 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:03:10.405580 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.405981 [debug] [MainThread]: On master: BEGIN
[0m06:03:10.406355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:03:10.407062 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.407443 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.407765 [debug] [MainThread]: Using duckdb connection "master"
[0m06:03:10.408075 [debug] [MainThread]: On master: COMMIT
[0m06:03:10.408638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:03:10.408979 [debug] [MainThread]: On master: Close
[0m06:03:10.409459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:10.410016 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:03:10.410424 [info ] [MainThread]: 
[0m06:03:10.410837 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.26 seconds (11.26s).
[0m06:03:10.411662 [debug] [MainThread]: Command end result
[0m06:03:10.435957 [info ] [MainThread]: 
[0m06:03:10.436516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:03:10.436937 [info ] [MainThread]: 
[0m06:03:10.437387 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:03:10.438338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.184986, "process_user_time": 4.905322, "process_kernel_time": 0.272127, "process_mem_max_rss": "335772", "process_in_blocks": "1200", "process_out_blocks": "107304"}
[0m06:03:10.438852 [debug] [MainThread]: Command `dbt run` succeeded at 06:03:10.438765 after 13.19 seconds
[0m06:03:10.439260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5fd0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a6132450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa153f91280>]}
[0m06:03:10.439658 [debug] [MainThread]: Flushing usage events
[0m06:03:12.290721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63cb6d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63d41dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63d51fe90>]}


============================== 06:03:12.294020 | 6a981e79-6cc0-4281-8ac0-574f3648f81b ==============================
[0m06:03:12.294020 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:03:12.294712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:03:12.394833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a981e79-6cc0-4281-8ac0-574f3648f81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63c8e97f0>]}
[0m06:03:12.409056 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16449061, "process_user_time": 1.223421, "process_kernel_time": 0.068967, "process_mem_max_rss": "99404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:03:12.409577 [debug] [MainThread]: Command `dbt clean` succeeded at 06:03:12.409485 after 0.17 seconds
[0m06:03:12.409959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63ca015e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63cbaa480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6410d3920>]}
[0m06:03:12.410351 [debug] [MainThread]: Flushing usage events
[0m14:06:14.258532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ee3dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb98174c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97ee3dcd0>]}


============================== 14:06:14.286604 | c70d3c7c-c9ba-422c-818b-a9fe1b5c2ddc ==============================
[0m14:06:14.286604 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:14.287344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:14.458898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c70d3c7c-c9ba-422c-818b-a9fe1b5c2ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb980b1e270>]}
[0m14:06:14.475075 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ivqawizy'
[0m14:06:14.475589 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:14.593052 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:14.595124 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:14.687429 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:14.693199 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:14.878533 [info ] [MainThread]: Installed from version 1.2.0
[0m14:06:14.879245 [info ] [MainThread]: Updated version available: 1.3.2
[0m14:06:14.879898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c70d3c7c-c9ba-422c-818b-a9fe1b5c2ddc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97eb966f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97eb96d20>]}
[0m14:06:14.880401 [info ] [MainThread]: 
[0m14:06:14.880997 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:06:14.911093 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.70448446, "process_user_time": 1.735288, "process_kernel_time": 0.150719, "process_mem_max_rss": "101016", "process_in_blocks": "8760", "process_out_blocks": "5168"}
[0m14:06:14.911889 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:14.911755 after 0.71 seconds
[0m14:06:14.912394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97f290200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97f4b2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97f4b10a0>]}
[0m14:06:14.912875 [debug] [MainThread]: Flushing usage events
[0m14:06:16.684045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0204020e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0204280ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0204a94440>]}


============================== 14:06:16.687340 | a9eba7bc-d97d-4363-9c37-ec4f9fcacb85 ==============================
[0m14:06:16.687340 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:16.687991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:16.922870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc9b8800>]}
[0m14:06:16.984623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0205d7d7c0>]}
[0m14:06:16.986489 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:06:17.019242 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:17.020007 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:17.020556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc994680>]}
[0m14:06:18.423036 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:18.423763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc850530>]}
[0m14:06:18.687770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:18.693355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc0ad820>]}
[0m14:06:18.794756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc1741a0>]}
[0m14:06:18.795361 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:06:18.795961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01fc8c1c70>]}
[0m14:06:18.798087 [info ] [MainThread]: 
[0m14:06:18.798824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:18.803902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:18.843485 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:18.844044 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:18.844443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:19.195142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.196910 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:19.197848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:19.198473 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:19.206881 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:19.207299 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:19.207706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:19.209278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.210616 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:19.211045 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:19.211689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.212079 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:19.212444 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:19.213169 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.214117 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:19.214508 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:19.214908 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:19.215603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.216047 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:19.217363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:19.223702 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:19.224120 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:19.224477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:19.225229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.225607 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:19.226004 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:19.237282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:19.238885 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:19.240159 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:19.240553 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:19.242857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01eecf61b0>]}
[0m14:06:19.243418 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:19.243834 [debug] [MainThread]: On master: BEGIN
[0m14:06:19.244199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:19.244949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:19.245354 [debug] [MainThread]: On master: COMMIT
[0m14:06:19.245748 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:19.246106 [debug] [MainThread]: On master: COMMIT
[0m14:06:19.246703 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:19.247095 [debug] [MainThread]: On master: Close
[0m14:06:19.247589 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:19.248084 [info ] [MainThread]: 
[0m14:06:19.280077 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:19.280781 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:19.281525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:19.281996 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:19.309208 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:19.310043 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:19.345763 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:19.346682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:27.543466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.544058 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:06:27.545039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.545476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.545972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:27.547035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.548486 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.548952 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:06:27.550018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.558564 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.559114 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:06:27.560149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.563459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.563924 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:06:27.564787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.582114 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:27.582690 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.583124 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:06:27.585031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.591349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:06:27.591865 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:06:27.593348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.595919 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:06:27.597515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01eff73740>]}
[0m14:06:27.598243 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.32s]
[0m14:06:27.599054 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:06:27.599909 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:06:27.600736 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:06:27.601377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:06:27.601866 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:06:27.607315 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:06:27.608060 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:06:27.645239 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.645838 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251125140627638999"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:06:27.646297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:27.654007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.662299 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.662819 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:06:27.663609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.664063 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.664483 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251125140627638999'
      
      
      order by ordinal_position

  
[0m14:06:27.667233 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.673291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.673805 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:27.676460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.684470 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.684970 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:06:27.688055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.689883 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.690326 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:06:27.691071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.710196 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:06:27.711048 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.711507 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251125140627638999"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251125140627638999"
    )
  
[0m14:06:27.769697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.771746 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:27.772216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:06:27.772618 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:06:27.779582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:06:27.780635 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:06:27.781395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9eba7bc-d97d-4363-9c37-ec4f9fcacb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01af7e2780>]}
[0m14:06:27.782097 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:06:27.782941 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:06:27.784684 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:27.785100 [debug] [MainThread]: On master: BEGIN
[0m14:06:27.785470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:27.786335 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:27.786767 [debug] [MainThread]: On master: COMMIT
[0m14:06:27.787143 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:27.787505 [debug] [MainThread]: On master: COMMIT
[0m14:06:27.788162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:27.788562 [debug] [MainThread]: On master: Close
[0m14:06:27.789112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:27.789470 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:06:27.789906 [info ] [MainThread]: 
[0m14:06:27.790422 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m14:06:27.791432 [debug] [MainThread]: Command end result
[0m14:06:27.818385 [info ] [MainThread]: 
[0m14:06:27.819114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:27.819645 [info ] [MainThread]: 
[0m14:06:27.820262 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:27.821323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.189932, "process_user_time": 5.336343, "process_kernel_time": 0.326326, "process_mem_max_rss": "335552", "process_in_blocks": "1200", "process_out_blocks": "107296"}
[0m14:06:27.821891 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:27.821785 after 11.19 seconds
[0m14:06:27.822346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0204280ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02040225a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01af7aa450>]}
[0m14:06:27.822803 [debug] [MainThread]: Flushing usage events
[0m14:06:29.949179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6155f0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6156c7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6155f12b0>]}


============================== 14:06:29.952652 | cf1178d0-e318-4f51-b1cb-7efb89a24e8a ==============================
[0m14:06:29.952652 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:29.953384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:30.069890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf1178d0-e318-4f51-b1cb-7efb89a24e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6149b2ae0>]}
[0m14:06:30.088108 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19217546, "process_user_time": 1.3947, "process_kernel_time": 0.117805, "process_mem_max_rss": "99548", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:06:30.088699 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:30.088550 after 0.19 seconds
[0m14:06:30.089125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa619163920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa615626ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6151e8920>]}
[0m14:06:30.089533 [debug] [MainThread]: Flushing usage events
[0m22:07:03.232497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3902720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3ef2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a39023c0>]}


============================== 22:07:03.255699 | a68ab182-125c-46e5-89bb-aabf9af13d7b ==============================
[0m22:07:03.255699 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:03.256371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:07:03.397356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a68ab182-125c-46e5-89bb-aabf9af13d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a581e720>]}
[0m22:07:03.412122 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x17ogl8x'
[0m22:07:03.412620 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:03.615990 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:03.617957 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:03.791940 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:03.797131 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:04.206158 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:04.206669 [info ] [MainThread]: Updated version available: 1.3.2
[0m22:07:04.207222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a68ab182-125c-46e5-89bb-aabf9af13d7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a392bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3929400>]}
[0m22:07:04.207645 [info ] [MainThread]: 
[0m22:07:04.208085 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:04.219388 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0330466, "process_user_time": 1.576242, "process_kernel_time": 0.10688, "process_mem_max_rss": "101388", "process_in_blocks": "8760", "process_out_blocks": "5168"}
[0m22:07:04.220190 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:04.220057 after 1.03 seconds
[0m22:07:04.220687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3f4e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a4574860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a3b7ea20>]}
[0m22:07:04.221181 [debug] [MainThread]: Flushing usage events
[0m22:07:05.941687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac93f0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac930be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac93f05c0>]}


============================== 22:07:05.944769 | 39f4dc43-afdc-4e14-8350-bc9f600b9a4f ==============================
[0m22:07:05.944769 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:05.945452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:06.156435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1397830>]}
[0m22:07:06.211562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac8807ce0>]}
[0m22:07:06.213322 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:07:06.252278 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:06.252985 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:06.253498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac13956d0>]}
[0m22:07:07.472218 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:07.472799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac0976000>]}
[0m22:07:07.716794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:07.722129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac87e3230>]}
[0m22:07:07.814024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac09e56a0>]}
[0m22:07:07.814584 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:07:07.814986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1180bc0>]}
[0m22:07:07.816966 [info ] [MainThread]: 
[0m22:07:07.817684 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:07.822400 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:07.859738 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:07.860264 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:07.860613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:08.270892 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.272422 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:08.273277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:08.273806 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:08.280873 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:08.281357 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:08.281690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:08.282974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.284423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:08.284809 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:08.286575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.286943 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:08.287290 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:08.287972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.288947 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:08.289317 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:08.289634 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:08.290280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.290644 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:08.291907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:08.297981 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:08.298448 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:08.298761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:08.299611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.299995 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:08.300348 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:08.311220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:08.312945 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:08.314304 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:08.314714 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:08.316881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac1191880>]}
[0m22:07:08.317446 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:08.317823 [debug] [MainThread]: On master: BEGIN
[0m22:07:08.318202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:08.319072 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:08.319457 [debug] [MainThread]: On master: COMMIT
[0m22:07:08.319775 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:08.320108 [debug] [MainThread]: On master: COMMIT
[0m22:07:08.320713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:08.321096 [debug] [MainThread]: On master: Close
[0m22:07:08.321582 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:08.322026 [info ] [MainThread]: 
[0m22:07:08.341860 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:08.342558 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:08.343244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:08.343956 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:08.370257 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:08.371085 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:08.404771 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:08.405625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:20.853272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.853817 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:20.854776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.855274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.855649 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:20.856803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.858261 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.858686 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:20.860344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.868218 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.868649 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:20.869591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.872752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.873186 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:20.873974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.889702 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:20.890236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.890617 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:20.892754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.898582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:20.899087 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:20.900750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.903252 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:20.904747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7a4d24b0>]}
[0m22:07:20.905474 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.56s]
[0m22:07:20.906295 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:20.907345 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:20.907879 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:20.908535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:20.908955 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:20.914105 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:20.914739 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:20.949024 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.949585 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20251125220720943221"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:20.949991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:20.957897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.965718 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.966235 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:20.967107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.967537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.967899 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20251125220720943221'
      
      
      order by ordinal_position

  
[0m22:07:20.970844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.976338 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.976788 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:20.979649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.987304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.987779 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:20.990721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:20.992584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:20.993035 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:20.993913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.011683 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:21.012498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.012941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20251125220720943221"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20251125220720943221"
    )
  
[0m22:07:21.075818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.077745 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:21.078202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:21.078560 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:21.084501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:21.085429 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:21.086149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f4dc43-afdc-4e14-8350-bc9f600b9a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7b1f1b20>]}
[0m22:07:21.086801 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:07:21.087454 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:21.089463 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:21.089887 [debug] [MainThread]: On master: BEGIN
[0m22:07:21.090255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:21.091144 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:21.091529 [debug] [MainThread]: On master: COMMIT
[0m22:07:21.091852 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:21.092210 [debug] [MainThread]: On master: COMMIT
[0m22:07:21.092834 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:21.093238 [debug] [MainThread]: On master: Close
[0m22:07:21.093702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:21.094036 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:21.094417 [info ] [MainThread]: 
[0m22:07:21.094821 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.28 seconds (13.28s).
[0m22:07:21.095670 [debug] [MainThread]: Command end result
[0m22:07:21.120112 [info ] [MainThread]: 
[0m22:07:21.120733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:21.121148 [info ] [MainThread]: 
[0m22:07:21.121591 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:21.122519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.227246, "process_user_time": 4.929253, "process_kernel_time": 0.248558, "process_mem_max_rss": "343156", "process_in_blocks": "1200", "process_out_blocks": "107344"}
[0m22:07:21.123089 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:21.122961 after 15.23 seconds
[0m22:07:21.123504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4accf63920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ac9aab830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7a4e43e0>]}
[0m22:07:21.123895 [debug] [MainThread]: Flushing usage events
[0m22:07:23.174105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f393680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16fab1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16eedeff0>]}


============================== 22:07:23.177366 | 7905e1b2-274f-4bf8-9d3d-952be16833ad ==============================
[0m22:07:23.177366 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:23.177955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:23.280847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7905e1b2-274f-4bf8-9d3d-952be16833ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f7503e0>]}
[0m22:07:23.295181 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16876286, "process_user_time": 1.281126, "process_kernel_time": 0.077946, "process_mem_max_rss": "99556", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:23.295709 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:23.295620 after 0.17 seconds
[0m22:07:23.296121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f7503e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f7b0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16f7b05c0>]}
[0m22:07:23.296514 [debug] [MainThread]: Flushing usage events
[0m20:58:47.526674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88bd90>]}


============================== 20:58:47.529294 | e9067148-713e-437d-99fb-e6c4b8393197 ==============================
[0m20:58:47.529294 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:58:47.529565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:47.616506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9067148-713e-437d-99fb-e6c4b8393197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a695cd0>]}
[0m20:58:47.638531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9067148-713e-437d-99fb-e6c4b8393197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b46fdf0>]}
[0m20:58:47.639502 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:58:47.653605 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m20:58:47.883878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39220276, "process_user_time": 0.643356, "process_kernel_time": 0.114516, "process_mem_max_rss": "126353408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:58:47.884561 [debug] [MainThread]: Command `dbt run` failed at 20:58:47.884443 after 0.39 seconds
[0m20:58:47.885004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b971350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b971450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b902990>]}
[0m20:58:47.885359 [debug] [MainThread]: Flushing usage events
[0m20:58:51.287613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba23ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba23d90>]}


============================== 20:58:51.289204 | 3c153747-6a5f-4048-927a-50a63323e9c7 ==============================
[0m20:58:51.289204 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:58:51.289455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:51.330078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c153747-6a5f-4048-927a-50a63323e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a869f30>]}
[0m20:58:51.337136 [debug] [MainThread]: Set downloads directory='/var/folders/zf/mwchy5wd3lldxn9vw7f15ztw0000gn/T/dbt-downloads-p1ld57ej'
[0m20:58:51.337291 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:58:51.441470 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:58:51.442189 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:58:51.508230 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:58:51.511152 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:58:51.755916 [info ] [MainThread]: Installed from version 1.2.0
[0m20:58:51.756180 [info ] [MainThread]: Updated version available: 1.3.3
[0m20:58:51.756371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3c153747-6a5f-4048-927a-50a63323e9c7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac5bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb4e360>]}
[0m20:58:51.756563 [info ] [MainThread]: 
[0m20:58:51.756718 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m20:58:51.758365 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49575457, "process_user_time": 0.511164, "process_kernel_time": 0.116872, "process_mem_max_rss": "115195904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:58:51.758611 [debug] [MainThread]: Command `dbt deps` succeeded at 20:58:51.758556 after 0.50 seconds
[0m20:58:51.758763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8e120>]}
[0m20:58:51.758909 [debug] [MainThread]: Flushing usage events
[0m20:58:55.255930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107455940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fbd90>]}


============================== 20:58:55.257575 | a48657f9-5b58-4efa-8a6e-57f0a92bf35a ==============================
[0m20:58:55.257575 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:58:55.257808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:55.333044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823dcd0>]}
[0m20:58:55.352840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdbdf0>]}
[0m20:58:55.353553 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:58:55.362568 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:58:55.363074 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:58:55.363264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e1150>]}
[0m20:58:55.844316 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:58:55.844556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f9c70>]}
[0m20:58:55.909980 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m20:58:55.911803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109606c10>]}
[0m20:58:55.944576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974f520>]}
[0m20:58:55.944776 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m20:58:55.944907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a48657f9-5b58-4efa-8a6e-57f0a92bf35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0d3d0>]}
[0m20:58:55.945791 [info ] [MainThread]: 
[0m20:58:55.946007 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:58:55.947620 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m20:58:55.972509 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m20:58:55.972683 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m20:58:55.972797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:55.974809 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m20:58:55.974933 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:58:55.975222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:55.975352 [debug] [MainThread]: Connection 'list_petro' was properly closed.
[0m20:58:55.975460 [info ] [MainThread]: 
[0m20:58:55.975597 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m20:58:55.975770 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: The file "/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/petro.duckdb" exists, but it is not a valid DuckDB database file!
[0m20:58:55.976774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7441672, "process_user_time": 1.107867, "process_kernel_time": 0.11116, "process_mem_max_rss": "140951552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:58:55.976925 [debug] [MainThread]: Command `dbt run` failed at 20:58:55.976892 after 0.74 seconds
[0m20:58:55.977043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d02cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d02d50>]}
[0m20:58:55.977160 [debug] [MainThread]: Flushing usage events
[0m20:59:14.258400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078cd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109853ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109853d90>]}


============================== 20:59:14.259955 | 9db65d02-21a0-4fd1-ab39-8a39e7aa3557 ==============================
[0m20:59:14.259955 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:59:14.260216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:14.334648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865dcd0>]}
[0m20:59:14.354351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109433df0>]}
[0m20:59:14.355086 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:59:14.363079 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:59:14.405110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:14.405275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:14.407548 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m20:59:14.419012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109939850>]}
[0m20:59:14.450546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c65d0>]}
[0m20:59:14.450734 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m20:59:14.450863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d44050>]}
[0m20:59:14.451590 [info ] [MainThread]: 
[0m20:59:14.451813 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:59:14.453759 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m20:59:14.475013 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m20:59:14.475189 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m20:59:14.475302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:14.971172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.971857 [debug] [ThreadPool]: On list_petro: Close
[0m20:59:14.972151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m20:59:14.972326 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m20:59:14.974872 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:14.974991 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m20:59:14.975087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:14.975377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.975866 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:14.975973 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m20:59:14.976122 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.976214 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:14.976310 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m20:59:14.976484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.976754 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m20:59:14.976848 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:14.976932 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m20:59:14.977100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.977238 [debug] [ThreadPool]: On create_petro_main: Close
[0m20:59:14.977683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m20:59:14.979894 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m20:59:14.980023 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m20:59:14.980118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:14.980298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.980386 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m20:59:14.980478 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m20:59:14.984148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:14.984520 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m20:59:14.984974 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m20:59:14.985069 [debug] [ThreadPool]: On list_petro_main: Close
[0m20:59:14.985287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f45570>]}
[0m20:59:14.985481 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:14.985595 [debug] [MainThread]: On master: BEGIN
[0m20:59:14.985691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:14.985865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:14.985962 [debug] [MainThread]: On master: COMMIT
[0m20:59:14.986048 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:14.986131 [debug] [MainThread]: On master: COMMIT
[0m20:59:14.986268 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:14.986363 [debug] [MainThread]: On master: Close
[0m20:59:14.986507 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:59:14.986635 [info ] [MainThread]: 
[0m20:59:14.987770 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m20:59:14.987937 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m20:59:14.988089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m20:59:14.988196 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m20:59:14.999191 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m20:59:15.001290 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m20:59:15.016137 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m20:59:15.016850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:17.383297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:17.383503 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m20:59:17.383740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.383881 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:17.384024 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m20:59:17.384298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.390160 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m20:59:17.390317 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:17.390451 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m20:59:17.390725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.393112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:17.393266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m20:59:17.393482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.394533 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m20:59:17.395270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111891190>]}
[0m20:59:17.395774 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.41s]
[0m20:59:17.396253 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m20:59:17.396678 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m20:59:17.396962 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m20:59:17.397208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m20:59:17.397362 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m20:59:17.404097 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m20:59:17.404653 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m20:59:17.419211 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m20:59:17.420496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:17.420628 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m20:59:17.420753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:17.421024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.421131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:17.421255 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m20:59:17.424280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.424928 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m20:59:17.425062 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:17.425173 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m20:59:17.426019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:17.426300 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m20:59:17.426503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db65d02-21a0-4fd1-ab39-8a39e7aa3557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d39de0>]}
[0m20:59:17.426727 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.03s]
[0m20:59:17.426943 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m20:59:17.427458 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:17.427573 [debug] [MainThread]: On master: BEGIN
[0m20:59:17.427672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:17.427835 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:17.427937 [debug] [MainThread]: On master: COMMIT
[0m20:59:17.428038 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:17.428130 [debug] [MainThread]: On master: COMMIT
[0m20:59:17.428272 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:17.428371 [debug] [MainThread]: On master: Close
[0m20:59:17.428503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:17.428600 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m20:59:17.428709 [info ] [MainThread]: 
[0m20:59:17.428830 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m20:59:17.429107 [debug] [MainThread]: Command end result
[0m20:59:17.441575 [info ] [MainThread]: 
[0m20:59:17.441773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:17.441879 [info ] [MainThread]: 
[0m20:59:17.441988 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:59:17.443618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2081199, "process_user_time": 1.321079, "process_kernel_time": 0.21114, "process_mem_max_rss": "299188224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:59:17.443779 [debug] [MainThread]: Command `dbt run` succeeded at 20:59:17.443747 after 3.21 seconds
[0m20:59:17.443909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111872cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3c6d0>]}
[0m20:59:17.444030 [debug] [MainThread]: Flushing usage events
[0m20:59:21.304440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107205940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ebed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ebd90>]}


============================== 20:59:21.306255 | c5590b3d-aa2d-4703-a26d-23e1e6c2457c ==============================
[0m20:59:21.306255 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:59:21.306496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -f', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:59:21.387511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff1cd0>]}
[0m20:59:21.408416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcbdf0>]}
[0m20:59:21.409145 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:59:21.418600 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:59:21.461378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:21.461567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:21.463820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m20:59:21.474947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cd850>]}
[0m20:59:21.506949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925e5d0>]}
[0m20:59:21.507168 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m20:59:21.507301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e0050>]}
[0m20:59:21.508015 [info ] [MainThread]: 
[0m20:59:21.508237 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:59:21.510096 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m20:59:21.531505 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m20:59:21.531696 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m20:59:21.531811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:21.536604 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.537139 [debug] [ThreadPool]: On list_petro: Close
[0m20:59:21.537400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m20:59:21.537563 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m20:59:21.539955 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:21.540062 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m20:59:21.540152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:21.540396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.540814 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:21.540904 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m20:59:21.541042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.541129 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:21.541212 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m20:59:21.541358 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.541629 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m20:59:21.541718 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m20:59:21.541803 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m20:59:21.541972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.542114 [debug] [ThreadPool]: On create_petro_main: Close
[0m20:59:21.542552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m20:59:21.544713 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m20:59:21.544829 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m20:59:21.544916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:21.545087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.545176 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m20:59:21.545265 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m20:59:21.548939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m20:59:21.549397 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m20:59:21.549840 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m20:59:21.549941 [debug] [ThreadPool]: On list_petro_main: Close
[0m20:59:21.550254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d9570>]}
[0m20:59:21.550400 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:21.550489 [debug] [MainThread]: On master: BEGIN
[0m20:59:21.550574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:21.550729 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:21.550820 [debug] [MainThread]: On master: COMMIT
[0m20:59:21.550903 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:21.550982 [debug] [MainThread]: On master: COMMIT
[0m20:59:21.551118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:21.551208 [debug] [MainThread]: On master: Close
[0m20:59:21.551334 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m20:59:21.551445 [info ] [MainThread]: 
[0m20:59:21.552236 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m20:59:21.552403 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m20:59:21.552553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m20:59:21.552660 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m20:59:21.563310 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m20:59:21.563718 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m20:59:21.575978 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m20:59:21.576299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:23.617358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.617643 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m20:59:23.617955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.618143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.618324 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m20:59:23.618742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.619425 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.619602 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m20:59:23.620090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.623687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.623897 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m20:59:23.624208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.625469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.625627 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m20:59:23.625870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.633655 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m20:59:23.633826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.633977 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m20:59:23.634291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.636765 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m20:59:23.636960 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m20:59:23.637303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.638358 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m20:59:23.639026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127d3d0>]}
[0m20:59:23.639298 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.09s]
[0m20:59:23.639562 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m20:59:23.639910 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m20:59:23.640145 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m20:59:23.640339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m20:59:23.640499 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m20:59:23.647502 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m20:59:23.648152 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m20:59:23.662647 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m20:59:23.663074 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.663214 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m20:59:23.663337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:23.663597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.663716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.663851 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro__dbt_tmp"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m20:59:23.667006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.667511 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.667659 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m20:59:23.667964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.668424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.668549 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m20:59:23.668819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.669904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.670027 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro" rename to "petro__dbt_backup"
[0m20:59:23.670223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.671313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.671435 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro__dbt_tmp" rename to "petro"
[0m20:59:23.671613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.672204 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m20:59:23.672322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.672431 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m20:59:23.673301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.673476 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.673597 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m20:59:23.673755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.673867 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.673984 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m20:59:23.674218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.674648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.674764 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m20:59:23.674997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.675987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m20:59:23.676103 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m20:59:23.676281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m20:59:23.676713 [debug] [Thread-1 (]: On model.petro.petro: ROLLBACK
[0m20:59:23.676999 [debug] [Thread-1 (]: Failed to rollback 'model.petro.petro'
[0m20:59:23.677113 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m20:59:23.677307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5590b3d-aa2d-4703-a26d-23e1e6c2457c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d60a0>]}
[0m20:59:23.677523 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.04s]
[0m20:59:23.677733 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m20:59:23.678222 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:23.678336 [debug] [MainThread]: On master: BEGIN
[0m20:59:23.678438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:23.678597 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:23.678703 [debug] [MainThread]: On master: COMMIT
[0m20:59:23.678803 [debug] [MainThread]: Using duckdb connection "master"
[0m20:59:23.678897 [debug] [MainThread]: On master: COMMIT
[0m20:59:23.679034 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:59:23.679131 [debug] [MainThread]: On master: Close
[0m20:59:23.679258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:23.679353 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m20:59:23.679458 [info ] [MainThread]: 
[0m20:59:23.679579 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m20:59:23.679859 [debug] [MainThread]: Command end result
[0m20:59:23.692508 [info ] [MainThread]: 
[0m20:59:23.692726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:23.692850 [info ] [MainThread]: 
[0m20:59:23.693026 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:59:23.694853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4161623, "process_user_time": 1.18842, "process_kernel_time": 0.160725, "process_mem_max_rss": "222642176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:59:23.695036 [debug] [MainThread]: Command `dbt run` succeeded at 20:59:23.695000 after 2.42 seconds
[0m20:59:23.695173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111335c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11125b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b6ad0>]}
[0m20:59:23.695301 [debug] [MainThread]: Flushing usage events
[0m21:01:56.126162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107109940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090afed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090afd90>]}


============================== 21:01:56.127719 | 4672562a-1f9d-498d-9dd5-39e342344571 ==============================
[0m21:01:56.127719 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:01:56.127965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -f', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:56.203699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef5cd0>]}
[0m21:01:56.230460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8fdf0>]}
[0m21:01:56.231521 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:01:56.246961 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:01:56.295327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:01:56.295684 [debug] [MainThread]: Partial parsing: updated file: petro://models/staging/stg_petro.py
[0m21:01:56.393981 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:01:56.395904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109385450>]}
[0m21:01:56.428416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911a5d0>]}
[0m21:01:56.428622 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:01:56.428751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971d2b0>]}
[0m21:01:56.429815 [info ] [MainThread]: 
[0m21:01:56.430077 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:01:56.431760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:01:56.454959 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:01:56.455142 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:01:56.455265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:56.460186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.460689 [debug] [ThreadPool]: On list_petro: Close
[0m21:01:56.460940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:01:56.461094 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:01:56.463466 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:01:56.463576 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:01:56.463671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:56.463927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.464359 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:01:56.464455 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:01:56.464592 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.464678 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:01:56.464763 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:01:56.464912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.465184 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:01:56.465277 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:01:56.465362 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:01:56.465485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.465582 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:01:56.466010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:01:56.468142 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:01:56.468258 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:01:56.468350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:56.468521 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.468614 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:01:56.468703 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:01:56.472390 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:01:56.472816 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:01:56.473245 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:01:56.473344 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:01:56.473706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a68a10>]}
[0m21:01:56.473871 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:56.473968 [debug] [MainThread]: On master: BEGIN
[0m21:01:56.474059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:56.474232 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:01:56.474325 [debug] [MainThread]: On master: COMMIT
[0m21:01:56.474408 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:56.474488 [debug] [MainThread]: On master: COMMIT
[0m21:01:56.474624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:01:56.474718 [debug] [MainThread]: On master: Close
[0m21:01:56.474855 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:01:56.475031 [info ] [MainThread]: 
[0m21:01:56.475824 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:01:56.475997 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:01:56.476153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:01:56.476270 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:01:56.485855 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:01:56.486261 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:01:56.498259 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:01:56.498596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:58.739571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.739861 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:01:58.740142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.740314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.740476 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:01:58.740857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.741534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.741705 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:01:58.742113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.745773 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.745983 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:01:58.746268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.747643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.747803 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:01:58.748093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.755988 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:01:58.756178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.756331 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:01:58.756705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.759019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:01:58.759178 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:01:58.759513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.760644 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:01:58.761341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f6b10>]}
[0m21:01:58.761636 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.28s]
[0m21:01:58.761900 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:01:58.762293 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:01:58.762503 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:01:58.762685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:01:58.762834 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:01:58.769429 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:01:58.769798 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:01:58.784930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.785104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:01:58.785234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:58.785683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.786317 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:01:58.786633 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.786758 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:01:58.786957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.787069 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.787200 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro__dbt_tmp"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:01:58.790295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.790692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.790813 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m21:01:58.791104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.791607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.791735 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m21:01:58.792034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.793260 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.793380 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro" rename to "petro__dbt_backup"
[0m21:01:58.793579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.794472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.794590 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro__dbt_tmp" rename to "petro"
[0m21:01:58.794776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.795377 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:01:58.795494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.795603 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:01:58.796456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.796628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.796743 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:01:58.796900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.797007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.797118 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m21:01:58.797356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.797791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.797908 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m21:01:58.798197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.799401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:01:58.799543 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:01:58.799768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:01:58.800467 [debug] [Thread-1 (]: On model.petro.petro: ROLLBACK
[0m21:01:58.800786 [debug] [Thread-1 (]: Failed to rollback 'model.petro.petro'
[0m21:01:58.800908 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:01:58.801112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672562a-1f9d-498d-9dd5-39e342344571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109717070>]}
[0m21:01:58.801340 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.04s]
[0m21:01:58.801561 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:01:58.802186 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:58.802307 [debug] [MainThread]: On master: BEGIN
[0m21:01:58.802408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:01:58.802580 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:01:58.802683 [debug] [MainThread]: On master: COMMIT
[0m21:01:58.802783 [debug] [MainThread]: Using duckdb connection "master"
[0m21:01:58.802881 [debug] [MainThread]: On master: COMMIT
[0m21:01:58.803018 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:01:58.803116 [debug] [MainThread]: On master: Close
[0m21:01:58.803250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:58.803349 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:01:58.803468 [info ] [MainThread]: 
[0m21:01:58.803595 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m21:01:58.803880 [debug] [MainThread]: Command end result
[0m21:01:58.814762 [info ] [MainThread]: 
[0m21:01:58.814949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:58.815073 [info ] [MainThread]: 
[0m21:01:58.815195 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:01:58.816992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7146597, "process_user_time": 1.321709, "process_kernel_time": 0.190001, "process_mem_max_rss": "225476608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:01:58.817194 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:58.817155 after 2.72 seconds
[0m21:01:58.817354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111295e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bfd50>]}
[0m21:01:58.817492 [debug] [MainThread]: Flushing usage events
[0m21:02:21.348024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b23d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d223ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d223d90>]}


============================== 21:02:21.349632 | 3c92545d-b4ae-4e2c-8c9e-29e72e65acff ==============================
[0m21:02:21.349632 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:02:21.349880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_petro --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:02:21.424351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c029cd0>]}
[0m21:02:21.444260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce03df0>]}
[0m21:02:21.445098 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:02:21.452998 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:02:21.495839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:21.496040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:21.498303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:02:21.509820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d305850>]}
[0m21:02:21.541564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d28e5d0>]}
[0m21:02:21.541793 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:02:21.541925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d714050>]}
[0m21:02:21.542820 [info ] [MainThread]: 
[0m21:02:21.543092 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:02:21.543427 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:02:21.567900 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:02:21.568105 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:02:21.568237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:21.573056 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.573562 [debug] [ThreadPool]: On list_petro: Close
[0m21:02:21.573805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:02:21.573955 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:02:21.576296 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:02:21.576407 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:02:21.576533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:21.576881 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.577354 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:02:21.577462 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:02:21.577611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.577706 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:02:21.577792 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:02:21.577941 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.578243 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:02:21.578339 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:02:21.578423 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:02:21.578550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.578643 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:02:21.580347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:02:21.582454 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:02:21.582586 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:02:21.582678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:21.582855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.582946 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:02:21.583034 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:02:21.586703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:02:21.587221 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:02:21.587680 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:02:21.587793 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:02:21.588177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d915640>]}
[0m21:02:21.588320 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:21.588413 [debug] [MainThread]: On master: BEGIN
[0m21:02:21.588499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:21.588660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:02:21.588751 [debug] [MainThread]: On master: COMMIT
[0m21:02:21.588835 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:21.588917 [debug] [MainThread]: On master: COMMIT
[0m21:02:21.589091 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:02:21.589225 [debug] [MainThread]: On master: Close
[0m21:02:21.589385 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:02:21.589514 [info ] [MainThread]: 
[0m21:02:21.590294 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:02:21.590480 [info ] [Thread-1 (]: 1 of 1 START python table model main.stg_petro ................................. [RUN]
[0m21:02:21.590646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:02:21.590758 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:02:21.601477 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:02:21.601896 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:02:21.613951 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:02:21.614322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:23.702676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.702989 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:02:23.703276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.703452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.703619 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:02:23.704015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.704713 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.704893 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:02:23.705326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.709035 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.709223 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:02:23.709515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.710721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.710880 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:02:23.711120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.718644 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:02:23.718807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.718948 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:02:23.719283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.721812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:02:23.721980 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:02:23.722322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:02:23.723793 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:02:23.724554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c92545d-b4ae-4e2c-8c9e-29e72e65acff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152b1550>]}
[0m21:02:23.724868 [info ] [Thread-1 (]: 1 of 1 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.13s]
[0m21:02:23.725142 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:02:23.725813 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:23.725946 [debug] [MainThread]: On master: BEGIN
[0m21:02:23.726065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:23.726253 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:02:23.726366 [debug] [MainThread]: On master: COMMIT
[0m21:02:23.726475 [debug] [MainThread]: Using duckdb connection "master"
[0m21:02:23.726583 [debug] [MainThread]: On master: COMMIT
[0m21:02:23.726741 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:02:23.726853 [debug] [MainThread]: On master: Close
[0m21:02:23.727006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:23.727118 [debug] [MainThread]: Connection 'model.petro.stg_petro' was properly closed.
[0m21:02:23.727243 [info ] [MainThread]: 
[0m21:02:23.727384 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m21:02:23.727653 [debug] [MainThread]: Command end result
[0m21:02:23.745767 [info ] [MainThread]: 
[0m21:02:23.745998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:23.746125 [info ] [MainThread]: 
[0m21:02:23.746256 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:02:23.748109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4233997, "process_user_time": 1.164454, "process_kernel_time": 0.176204, "process_mem_max_rss": "220119040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:02:23.748300 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:23.748263 after 2.42 seconds
[0m21:02:23.748467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c7d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d388870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7cecb0>]}
[0m21:02:23.748604 [debug] [MainThread]: Flushing usage events
[0m21:03:22.268504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf47ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf47d90>]}


============================== 21:03:22.270082 | b975bb03-8683-484b-94d1-fe48d389b1df ==============================
[0m21:03:22.270082 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:22.270325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_petro --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:03:22.346163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd8dcd0>]}
[0m21:03:22.365998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb27df0>]}
[0m21:03:22.366795 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:03:22.375586 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:03:22.420207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:03:22.420464 [debug] [MainThread]: Partial parsing: updated file: petro://models/staging/stg_petro.py
[0m21:03:22.518125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:03:22.520010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d219450>]}
[0m21:03:22.551222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfb25d0>]}
[0m21:03:22.551436 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:03:22.551572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b5390>]}
[0m21:03:22.552390 [info ] [MainThread]: 
[0m21:03:22.552613 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:22.552965 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:03:22.575726 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:03:22.575887 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:03:22.575993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:22.580878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.581443 [debug] [ThreadPool]: On list_petro: Close
[0m21:03:22.581733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:03:22.581912 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:03:22.584294 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:22.584403 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:03:22.584496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:22.584769 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.585187 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:22.585281 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:03:22.585417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.585503 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:22.585586 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:03:22.585730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.586003 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:22.586097 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:22.586184 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:22.586315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.586409 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:03:22.588169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:03:22.590174 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:22.590272 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:03:22.590353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:22.590500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.590592 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:22.590682 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:03:22.594272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:22.594825 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:03:22.595302 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:03:22.595409 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:03:22.595770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d90c940>]}
[0m21:03:22.595926 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:22.596022 [debug] [MainThread]: On master: BEGIN
[0m21:03:22.596112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:22.596285 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:22.596377 [debug] [MainThread]: On master: COMMIT
[0m21:03:22.596460 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:22.596543 [debug] [MainThread]: On master: COMMIT
[0m21:03:22.596713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:22.596839 [debug] [MainThread]: On master: Close
[0m21:03:22.596986 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:03:22.597117 [info ] [MainThread]: 
[0m21:03:22.597889 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:03:22.598059 [info ] [Thread-1 (]: 1 of 1 START python table model main.stg_petro ................................. [RUN]
[0m21:03:22.598219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:03:22.598330 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:03:22.607971 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:03:22.608407 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:03:22.620114 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:03:22.620453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:36.066727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.067329 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:03:36.067593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.067702 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.067811 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:03:36.068108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.068538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.068650 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:03:36.068921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.071069 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.071186 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:03:36.071401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.072251 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.072369 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:03:36.072532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.078120 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:36.078276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.078402 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:36.078859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.080727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:36.080861 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:03:36.081132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:36.082065 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:03:36.082594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b975bb03-8683-484b-94d1-fe48d389b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115142090>]}
[0m21:03:36.082820 [info ] [Thread-1 (]: 1 of 1 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.48s]
[0m21:03:36.083062 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:03:36.083618 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:36.083773 [debug] [MainThread]: On master: BEGIN
[0m21:03:36.083880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:36.084065 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:36.084177 [debug] [MainThread]: On master: COMMIT
[0m21:03:36.084280 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:36.084372 [debug] [MainThread]: On master: COMMIT
[0m21:03:36.084508 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:36.084610 [debug] [MainThread]: On master: Close
[0m21:03:36.084749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:36.084844 [debug] [MainThread]: Connection 'model.petro.stg_petro' was properly closed.
[0m21:03:36.084944 [info ] [MainThread]: 
[0m21:03:36.085064 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.53 seconds (13.53s).
[0m21:03:36.085310 [debug] [MainThread]: Command end result
[0m21:03:36.101079 [info ] [MainThread]: 
[0m21:03:36.101300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:36.101420 [info ] [MainThread]: 
[0m21:03:36.101540 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:03:36.103303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.857885, "process_user_time": 13.003882, "process_kernel_time": 0.706921, "process_mem_max_rss": "2216361984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:03:36.103485 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:36.103449 after 13.86 seconds
[0m21:03:36.103625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d28cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cf890>]}
[0m21:03:36.103758 [debug] [MainThread]: Flushing usage events
[0m21:03:42.480686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb35940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad7d90>]}


============================== 21:03:42.482396 | e06e38fe-0fff-4069-9ed4-0c8e2dec610d ==============================
[0m21:03:42.482396 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:03:42.482644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -f', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:03:42.560068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c921cd0>]}
[0m21:03:42.580332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6bbdf0>]}
[0m21:03:42.581071 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:03:42.590630 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:03:42.637237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:42.637462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:42.640126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:03:42.652583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbbd850>]}
[0m21:03:42.686440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db465d0>]}
[0m21:03:42.686650 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:03:42.686785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfd4050>]}
[0m21:03:42.687482 [info ] [MainThread]: 
[0m21:03:42.687713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:42.689701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:03:42.712182 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:03:42.712366 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:03:42.712483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:42.717455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.717980 [debug] [ThreadPool]: On list_petro: Close
[0m21:03:42.718253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:03:42.718442 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:03:42.720773 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:42.720891 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:03:42.720989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:42.721255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.721686 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:42.721781 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:03:42.721944 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.722039 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:42.722135 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:03:42.722299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.722575 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:42.722667 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:03:42.722748 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:03:42.722875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.722967 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:03:42.723336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:03:42.725531 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:42.725672 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:03:42.725773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:42.725959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.726056 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:03:42.726149 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:03:42.730186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:03:42.730779 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:03:42.731286 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:03:42.731409 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:03:42.731871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1cd570>]}
[0m21:03:42.732049 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:42.732150 [debug] [MainThread]: On master: BEGIN
[0m21:03:42.732255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:42.732446 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:42.732553 [debug] [MainThread]: On master: COMMIT
[0m21:03:42.732648 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:42.732741 [debug] [MainThread]: On master: COMMIT
[0m21:03:42.732897 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:42.732987 [debug] [MainThread]: On master: Close
[0m21:03:42.733136 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:03:42.733258 [info ] [MainThread]: 
[0m21:03:42.734173 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:03:42.734369 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:03:42.734526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:03:42.734637 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:03:42.745557 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:03:42.745986 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:03:42.758460 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:03:42.758848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:56.032707 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.033707 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:03:56.033986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.034099 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.034206 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:03:56.034507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.034941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.035052 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:03:56.035318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.037567 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.037682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:03:56.037883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.038734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.038852 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:03:56.039031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.044561 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:56.044678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.044780 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:03:56.045234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.047276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:03:56.047417 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:03:56.047788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.048775 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:03:56.049321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b18dd0>]}
[0m21:03:56.049670 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.31s]
[0m21:03:56.049906 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:03:56.050257 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:03:56.050463 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:03:56.050632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:03:56.050762 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:03:56.056411 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:03:56.056716 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:03:56.070615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.070773 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:03:56.070891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:56.071277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.071843 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:03:56.072121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.072225 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:03:56.072406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.072509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.072632 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro__dbt_tmp"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:03:56.347408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.348034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.348204 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m21:03:56.348626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.349125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.349258 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro'
  
[0m21:03:56.349546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.350842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.350962 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro" rename to "petro__dbt_backup"
[0m21:03:56.351170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.352079 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.352204 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
alter table "petro"."main"."petro__dbt_tmp" rename to "petro"
[0m21:03:56.352384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.352970 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:56.353085 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.353194 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:03:56.358090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.358332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.358458 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:03:56.358650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.358757 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.358860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m21:03:56.359133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.359591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.359724 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'petro__dbt_backup'
  
[0m21:03:56.359997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.360969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:03:56.361073 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:03:56.361248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:03:56.361860 [debug] [Thread-1 (]: On model.petro.petro: ROLLBACK
[0m21:03:56.362133 [debug] [Thread-1 (]: Failed to rollback 'model.petro.petro'
[0m21:03:56.362240 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:03:56.362419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06e38fe-0fff-4069-9ed4-0c8e2dec610d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfca2b0>]}
[0m21:03:56.362629 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m21:03:56.362841 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:03:56.363417 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:56.363574 [debug] [MainThread]: On master: BEGIN
[0m21:03:56.363691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:56.363891 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:56.363999 [debug] [MainThread]: On master: COMMIT
[0m21:03:56.364102 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:56.364193 [debug] [MainThread]: On master: COMMIT
[0m21:03:56.364366 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:03:56.364537 [debug] [MainThread]: On master: Close
[0m21:03:56.364693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:56.364790 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:03:56.364902 [info ] [MainThread]: 
[0m21:03:56.365024 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.68 seconds (13.68s).
[0m21:03:56.365309 [debug] [MainThread]: Command end result
[0m21:03:56.381330 [info ] [MainThread]: 
[0m21:03:56.381520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:56.381638 [info ] [MainThread]: 
[0m21:03:56.381759 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:03:56.383998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.927426, "process_user_time": 15.662326, "process_kernel_time": 0.753275, "process_mem_max_rss": "2244444160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:03:56.384203 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:56.384160 after 13.93 seconds
[0m21:03:56.384370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145d6d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b2009e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db00a50>]}
[0m21:03:56.384509 [debug] [MainThread]: Flushing usage events
[0m21:05:24.757861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5dd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d55fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d55fd90>]}


============================== 21:05:24.760012 | 176b4a3f-b70c-4294-8fa1-7df7d23202cd ==============================
[0m21:05:24.760012 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:05:24.760274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dominikgolebiewski/Documents/GitHub/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:05:24.841907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c369cd0>]}
[0m21:05:24.863044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d143df0>]}
[0m21:05:24.864127 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:05:24.873197 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:05:24.924830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:24.925016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:24.927432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:05:24.939061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d645850>]}
[0m21:05:24.979189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5ce5d0>]}
[0m21:05:24.979421 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:05:24.979558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da5c050>]}
[0m21:05:24.980260 [info ] [MainThread]: 
[0m21:05:24.980508 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:05:24.982497 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:05:25.011546 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:05:25.011730 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:05:25.011845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:25.018084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.018694 [debug] [ThreadPool]: On list_petro: Close
[0m21:05:25.018990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:05:25.019179 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:05:25.021735 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:05:25.021870 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:05:25.021975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:25.022305 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.022771 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:05:25.022865 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:05:25.023008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.023106 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:05:25.023200 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:05:25.023366 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.023679 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:05:25.023784 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:05:25.023881 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:05:25.024015 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.024114 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:05:25.024623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:05:25.026876 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:05:25.027006 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:05:25.027114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:25.027290 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.027390 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:05:25.027491 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:05:25.031264 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:05:25.031781 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:05:25.032528 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:05:25.032629 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:05:25.033060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc55570>]}
[0m21:05:25.033279 [debug] [MainThread]: Using duckdb connection "master"
[0m21:05:25.033397 [debug] [MainThread]: On master: BEGIN
[0m21:05:25.033492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:05:25.033674 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:05:25.033792 [debug] [MainThread]: On master: COMMIT
[0m21:05:25.033894 [debug] [MainThread]: Using duckdb connection "master"
[0m21:05:25.033988 [debug] [MainThread]: On master: COMMIT
[0m21:05:25.034126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:05:25.034226 [debug] [MainThread]: On master: Close
[0m21:05:25.034384 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:05:25.034510 [info ] [MainThread]: 
[0m21:05:25.035521 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:05:25.035720 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:05:25.035887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:05:25.036016 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:05:25.047167 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:05:25.047549 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:05:25.060137 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:05:25.060515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:27.547825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.548102 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:05:27.548408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.548583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.548745 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:05:27.549100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.549747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.549916 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m21:05:27.550287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.553371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.553553 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m21:05:27.553829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.555050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.555210 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:05:27.555454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.562792 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:05:27.562964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.563108 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:05:27.563464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.566211 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:05:27.567016 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:05:27.568642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.569891 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:05:27.570550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155a1310>]}
[0m21:05:27.570822 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 2.53s]
[0m21:05:27.571069 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:05:27.571399 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:05:27.571625 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:05:27.571886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:05:27.572074 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:05:27.579007 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:05:27.579389 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:05:27.594277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.594456 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      drop table if exists "petro"."main"."petro__dbt_backup" cascade
    
[0m21:05:27.594582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:27.595086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.595613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.595755 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260129210527591528"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:05:27.598835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.601568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.601711 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:05:27.601890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.602005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.602121 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260129210527591528'
      
      
      order by ordinal_position

  
[0m21:05:27.603033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.604723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.604864 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m21:05:27.605696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.608393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.608523 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m21:05:27.609294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.609826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.609938 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m21:05:27.610117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.615798 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:05:27.616166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.616285 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260129210527591528"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260129210527591528"
    )
  
[0m21:05:27.629911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.630598 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:05:27.630727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:05:27.630836 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:05:27.632689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:05:27.632981 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:05:27.633215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '176b4a3f-b70c-4294-8fa1-7df7d23202cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da522b0>]}
[0m21:05:27.633456 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.06s]
[0m21:05:27.633667 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:05:27.634194 [debug] [MainThread]: Using duckdb connection "master"
[0m21:05:27.634348 [debug] [MainThread]: On master: BEGIN
[0m21:05:27.634465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:05:27.634672 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:05:27.634780 [debug] [MainThread]: On master: COMMIT
[0m21:05:27.634882 [debug] [MainThread]: Using duckdb connection "master"
[0m21:05:27.634981 [debug] [MainThread]: On master: COMMIT
[0m21:05:27.635135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:05:27.635238 [debug] [MainThread]: On master: Close
[0m21:05:27.635376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:27.635476 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:05:27.635591 [info ] [MainThread]: 
[0m21:05:27.635720 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m21:05:27.636032 [debug] [MainThread]: Command end result
[0m21:05:27.648244 [info ] [MainThread]: 
[0m21:05:27.648428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:27.648546 [info ] [MainThread]: 
[0m21:05:27.648674 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:05:27.650896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9179864, "process_user_time": 1.316641, "process_kernel_time": 0.206931, "process_mem_max_rss": "281018368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:05:27.651068 [debug] [MainThread]: Command `dbt run` succeeded at 21:05:27.651032 after 2.92 seconds
[0m21:05:27.651199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11563ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115582c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155c22d0>]}
[0m21:05:27.651334 [debug] [MainThread]: Flushing usage events
[0m21:08:01.359187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d40eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93e27d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93e27fec0>]}


============================== 21:08:01.367635 | bdd831c5-474d-42b3-8b7d-65858f2ba704 ==============================
[0m21:08:01.367635 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:08:01.368281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:08:01.618444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdd831c5-474d-42b3-8b7d-65858f2ba704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d1dfa10>]}
[0m21:08:01.633958 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ne8jp4b7'
[0m21:08:01.634453 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:08:01.780297 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:08:01.781813 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:08:01.862164 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:08:01.867581 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:08:02.185028 [info ] [MainThread]: Installed from version 1.2.0
[0m21:08:02.185649 [info ] [MainThread]: Updated version available: 1.3.3
[0m21:08:02.186176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bdd831c5-474d-42b3-8b7d-65858f2ba704', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f319f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d274f50>]}
[0m21:08:02.186709 [info ] [MainThread]: 
[0m21:08:02.187187 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:08:02.216990 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9085995, "process_user_time": 1.651168, "process_kernel_time": 0.144101, "process_mem_max_rss": "101304", "process_in_blocks": "8528", "process_out_blocks": "5176"}
[0m21:08:02.217581 [debug] [MainThread]: Command `dbt deps` succeeded at 21:08:02.217477 after 0.91 seconds
[0m21:08:02.218016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93e27d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d57e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93d12ea20>]}
[0m21:08:02.218485 [debug] [MainThread]: Flushing usage events
[0m21:08:03.972349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb76455eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb75cda300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb75cdabd0>]}


============================== 21:08:03.975441 | 18a4f234-70b0-4ece-b0ee-4e649c08cb49 ==============================
[0m21:08:03.975441 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:08:03.976121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:08:04.208743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb75c30920>]}
[0m21:08:04.270497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb76999df0>]}
[0m21:08:04.272333 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:08:04.332079 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:08:04.332887 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:08:04.333455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6e76a180>]}
[0m21:08:05.717562 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:08:05.718216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6df3e930>]}
[0m21:08:05.959356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m21:08:05.964782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6def2570>]}
[0m21:08:06.063507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6df6efc0>]}
[0m21:08:06.064080 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m21:08:06.064618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb770db920>]}
[0m21:08:06.066703 [info ] [MainThread]: 
[0m21:08:06.067454 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:08:06.072381 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m21:08:06.108908 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m21:08:06.109407 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m21:08:06.109804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:06.858493 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m21:08:06.860102 [debug] [ThreadPool]: On list_petro: Close
[0m21:08:06.860937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m21:08:06.861507 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m21:08:06.869049 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:08:06.869507 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m21:08:06.869902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:06.871100 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.872438 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:08:06.872823 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m21:08:06.873630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.874008 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:08:06.874363 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m21:08:06.875032 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.875988 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:08:06.876380 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m21:08:06.876781 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m21:08:06.877372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.877805 [debug] [ThreadPool]: On create_petro_main: Close
[0m21:08:06.879016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m21:08:06.885117 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:08:06.885556 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m21:08:06.885919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:06.886681 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.887065 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m21:08:06.887478 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m21:08:06.897932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:08:06.899244 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m21:08:06.900532 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m21:08:06.900922 [debug] [ThreadPool]: On list_petro_main: Close
[0m21:08:06.901631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb77b76750>]}
[0m21:08:06.902151 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:06.902569 [debug] [MainThread]: On master: BEGIN
[0m21:08:06.902935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:06.903855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:08:06.904260 [debug] [MainThread]: On master: COMMIT
[0m21:08:06.904666 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:06.905026 [debug] [MainThread]: On master: COMMIT
[0m21:08:06.905635 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:08:06.906025 [debug] [MainThread]: On master: Close
[0m21:08:06.906535 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:08:06.907016 [info ] [MainThread]: 
[0m21:08:06.990091 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m21:08:06.990824 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m21:08:06.991575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m21:08:06.992039 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m21:08:07.019525 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m21:08:07.020316 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m21:08:07.055914 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m21:08:07.056791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:18.353088 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:08:18.353645 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m21:08:18.354378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.354842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:08:18.355260 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m21:08:18.356007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.370448 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:08:18.370920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:08:18.371347 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m21:08:18.372858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.378962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m21:08:18.379454 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m21:08:18.380211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.382665 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m21:08:18.384184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb32e9d880>]}
[0m21:08:18.384888 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.39s]
[0m21:08:18.385677 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m21:08:18.386595 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m21:08:18.387175 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m21:08:18.387871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m21:08:18.388317 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m21:08:18.393522 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m21:08:18.394311 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m21:08:18.431045 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m21:08:18.431808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:08:18.432249 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m21:08:18.432685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:18.433648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.434088 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:08:18.434569 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

  
    
    

    create  table
      "petro"."main"."petro"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m21:08:18.441916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.444051 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:08:18.444511 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m21:08:18.444924 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m21:08:18.448327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m21:08:18.449183 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m21:08:18.449824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18a4f234-70b0-4ece-b0ee-4e649c08cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6dd647d0>]}
[0m21:08:18.450491 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.06s]
[0m21:08:18.451291 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m21:08:18.453171 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:18.453617 [debug] [MainThread]: On master: BEGIN
[0m21:08:18.453989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:08:18.454696 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:08:18.455094 [debug] [MainThread]: On master: COMMIT
[0m21:08:18.455505 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:18.455875 [debug] [MainThread]: On master: COMMIT
[0m21:08:18.456493 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:08:18.456898 [debug] [MainThread]: On master: Close
[0m21:08:18.457360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:18.457756 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m21:08:18.458150 [info ] [MainThread]: 
[0m21:08:18.458685 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.39 seconds (12.39s).
[0m21:08:18.459704 [debug] [MainThread]: Command end result
[0m21:08:18.485953 [info ] [MainThread]: 
[0m21:08:18.486631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:18.487156 [info ] [MainThread]: 
[0m21:08:18.487707 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:08:18.488724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.567081, "process_user_time": 5.936412, "process_kernel_time": 0.284827, "process_mem_max_rss": "272840", "process_in_blocks": "1200", "process_out_blocks": "107368"}
[0m21:08:18.489261 [debug] [MainThread]: Command `dbt run` succeeded at 21:08:18.489159 after 14.57 seconds
[0m21:08:18.489729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a3bb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb32f19a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6df8a7e0>]}
[0m21:08:18.490160 [debug] [MainThread]: Flushing usage events
[0m21:08:20.419763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bcbe8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25baee32c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25baa3b0b0>]}


============================== 21:08:20.422972 | 4a85ff86-703a-4ecd-809c-c03cb3ea29c6 ==============================
[0m21:08:20.422972 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:08:20.423680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m21:08:20.541781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a85ff86-703a-4ecd-809c-c03cb3ea29c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bc878aa0>]}
[0m21:08:20.560767 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19282293, "process_user_time": 1.36923, "process_kernel_time": 0.111937, "process_mem_max_rss": "99456", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m21:08:20.561329 [debug] [MainThread]: Command `dbt clean` succeeded at 21:08:20.561227 after 0.19 seconds
[0m21:08:20.561810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25bdf63620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ba95b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25baf9da30>]}
[0m21:08:20.562243 [debug] [MainThread]: Flushing usage events
[0m22:08:53.901698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a3af800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74d7ab1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a767920>]}


============================== 22:08:53.911182 | 6ae8bf1d-c0d0-4000-97d6-518848a04b24 ==============================
[0m22:08:53.911182 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:53.911937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:54.129944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ae8bf1d-c0d0-4000-97d6-518848a04b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74b5ef5f0>]}
[0m22:08:54.146708 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wpmvlwpa'
[0m22:08:54.147289 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:08:54.277026 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:08:54.278970 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:08:54.325473 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:08:54.331730 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:08:54.490318 [info ] [MainThread]: Installed from version 1.2.0
[0m22:08:54.491050 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:08:54.491681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6ae8bf1d-c0d0-4000-97d6-518848a04b24', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a0bf2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a0bf140>]}
[0m22:08:54.492215 [info ] [MainThread]: 
[0m22:08:54.492758 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:08:54.503254 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.65709037, "process_user_time": 1.777548, "process_kernel_time": 0.133341, "process_mem_max_rss": "101320", "process_in_blocks": "8520", "process_out_blocks": "5176"}
[0m22:08:54.504086 [debug] [MainThread]: Command `dbt deps` succeeded at 22:08:54.503953 after 0.66 seconds
[0m22:08:54.504578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74a1d0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74af964b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74af96e40>]}
[0m22:08:54.505085 [debug] [MainThread]: Flushing usage events
[0m22:08:56.388084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01c50ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019d65b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019d657f0>]}


============================== 22:08:56.391371 | 101e2816-2800-4d0f-b37a-682d3e3e20f7 ==============================
[0m22:08:56.391371 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:08:56.392095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:56.634802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01ba90ce0>]}
[0m22:08:56.699040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0199bcdd0>]}
[0m22:08:56.701053 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:08:56.782461 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:08:56.783316 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:08:56.783909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019b5fd10>]}
[0m22:08:58.226229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:08:58.226995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0124de600>]}
[0m22:08:58.501353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:08:58.507421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff011d910a0>]}
[0m22:08:58.610328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01247fda0>]}
[0m22:08:58.610972 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:08:58.611506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff011c1e420>]}
[0m22:08:58.613669 [info ] [MainThread]: 
[0m22:08:58.614439 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:08:58.619603 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:08:58.658592 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:08:58.659180 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:08:58.659619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:59.142149 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.144444 [debug] [ThreadPool]: On list_petro: Close
[0m22:08:59.145687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:08:59.146529 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:08:59.155129 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:59.155668 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:08:59.156137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:59.157886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.159434 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:59.159875 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:08:59.160542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.160961 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:59.161329 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:08:59.162038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.163053 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:59.163450 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:08:59.163813 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:08:59.164569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.165043 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:08:59.166531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:08:59.173222 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:59.173753 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:08:59.174203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:59.175182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.175600 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:08:59.176015 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:08:59.187667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:59.189422 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:08:59.190773 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:08:59.191206 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:08:59.192422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0109ea270>]}
[0m22:08:59.192995 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:59.193400 [debug] [MainThread]: On master: BEGIN
[0m22:08:59.193776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:59.194718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:59.195174 [debug] [MainThread]: On master: COMMIT
[0m22:08:59.195558 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:59.195958 [debug] [MainThread]: On master: COMMIT
[0m22:08:59.196592 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:59.197036 [debug] [MainThread]: On master: Close
[0m22:08:59.197585 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:08:59.198095 [info ] [MainThread]: 
[0m22:08:59.237508 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:08:59.238234 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:08:59.238960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:08:59.239410 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:08:59.267917 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:08:59.268887 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:08:59.306463 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:08:59.307418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:07.538334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.538943 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:09:07.539814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.540286 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.540715 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:09:07.541897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.543437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.543906 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:09:07.545050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.553722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.554299 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:09:07.555369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.558896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.559373 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:09:07.560409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.578792 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:09:07.579726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.580469 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:09:07.582229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.589151 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:07.589707 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:09:07.591360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.594061 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:09:07.595666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01252ae70>]}
[0m22:09:07.596413 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.36s]
[0m22:09:07.597211 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:09:07.598222 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:09:07.598829 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:09:07.599566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:09:07.600075 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:09:07.605966 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:09:07.606738 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:09:07.644723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.645356 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260129220907638369"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:09:07.645859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:07.653943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.662545 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.663151 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:09:07.664070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.664515 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.664978 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260129220907638369'
      
      
      order by ordinal_position

  
[0m22:09:07.667694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.673702 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.674267 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:09:07.677333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.685983 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.686551 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:09:07.690122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.692086 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.692545 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:09:07.693428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.713459 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:09:07.714359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.714854 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260129220907638369"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260129220907638369"
    )
  
[0m22:09:07.724766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.726920 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:09:07.727397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:07.727881 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:09:07.734282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:07.735359 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:09:07.736131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '101e2816-2800-4d0f-b37a-682d3e3e20f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd2970560>]}
[0m22:09:07.736814 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.14s]
[0m22:09:07.737582 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:09:07.739116 [debug] [MainThread]: Using duckdb connection "master"
[0m22:09:07.739537 [debug] [MainThread]: On master: BEGIN
[0m22:09:07.739944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:09:07.740763 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:09:07.741209 [debug] [MainThread]: On master: COMMIT
[0m22:09:07.741591 [debug] [MainThread]: Using duckdb connection "master"
[0m22:09:07.741997 [debug] [MainThread]: On master: COMMIT
[0m22:09:07.742646 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:09:07.743114 [debug] [MainThread]: On master: Close
[0m22:09:07.743619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:07.744014 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:09:07.744429 [info ] [MainThread]: 
[0m22:09:07.744950 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m22:09:07.745961 [debug] [MainThread]: Command end result
[0m22:09:07.773615 [info ] [MainThread]: 
[0m22:09:07.774323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:09:07.774825 [info ] [MainThread]: 
[0m22:09:07.775353 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:09:07.776429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.441113, "process_user_time": 6.095265, "process_kernel_time": 0.30857, "process_mem_max_rss": "313572", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:09:07.777019 [debug] [MainThread]: Command `dbt run` succeeded at 22:09:07.776910 after 11.44 seconds
[0m22:09:07.777473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01c50ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff019c6a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01a649ca0>]}
[0m22:09:07.777932 [debug] [MainThread]: Flushing usage events
[0m22:09:09.748723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d73846780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d73e94590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d749a61b0>]}


============================== 22:09:09.752114 | 206b11f0-2ccf-46c8-a751-a64e9001023e ==============================
[0m22:09:09.752114 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:09:09.752803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:09:09.873020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '206b11f0-2ccf-46c8-a751-a64e9001023e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d738872c0>]}
[0m22:09:09.892727 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1966639, "process_user_time": 1.459043, "process_kernel_time": 0.111926, "process_mem_max_rss": "99644", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:09:09.893365 [debug] [MainThread]: Command `dbt clean` succeeded at 22:09:09.893249 after 0.20 seconds
[0m22:09:09.893918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d736f9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d738872c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d73885490>]}
[0m22:09:09.894387 [debug] [MainThread]: Flushing usage events
[0m06:20:26.758903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c308b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c3440dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c3fc6c60>]}


============================== 06:20:26.776783 | 6143c17d-cd6f-4176-8ce6-4f2a18385bdb ==============================
[0m06:20:26.776783 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:20:26.777452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:20:26.942950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6143c17d-cd6f-4176-8ce6-4f2a18385bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2ead760>]}
[0m06:20:26.958430 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_udpg3qe'
[0m06:20:26.958893 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:20:27.012631 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:20:27.014410 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:20:27.049122 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:20:27.055062 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:20:27.291435 [info ] [MainThread]: Installed from version 1.2.0
[0m06:20:27.292008 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:20:27.292593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6143c17d-cd6f-4176-8ce6-4f2a18385bdb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2eace60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2d71eb0>]}
[0m06:20:27.293045 [info ] [MainThread]: 
[0m06:20:27.293549 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:20:27.303366 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.59577, "process_user_time": 1.658431, "process_kernel_time": 0.126261, "process_mem_max_rss": "101412", "process_in_blocks": "8528", "process_out_blocks": "5176"}
[0m06:20:27.303916 [debug] [MainThread]: Command `dbt deps` succeeded at 06:20:27.303812 after 0.60 seconds
[0m06:20:27.304379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c73bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c36f4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c3046d20>]}
[0m06:20:27.304812 [debug] [MainThread]: Flushing usage events
[0m06:20:29.091694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48b32e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48968aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4896892b0>]}


============================== 06:20:29.094769 | 9718e89c-a094-4bb0-87c4-1373231583f8 ==============================
[0m06:20:29.094769 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:20:29.095475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:20:29.328843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff488fa1490>]}
[0m06:20:29.390951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff489202900>]}
[0m06:20:29.392859 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:20:29.428140 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:20:29.429377 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:20:29.430125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481b34410>]}
[0m06:20:30.843640 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:20:30.844318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481c15880>]}
[0m06:20:31.085487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:20:31.090896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481211cd0>]}
[0m06:20:31.186211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481a81c40>]}
[0m06:20:31.186736 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:20:31.187273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481bba4b0>]}
[0m06:20:31.189291 [info ] [MainThread]: 
[0m06:20:31.189996 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:20:31.194814 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:20:31.230619 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:20:31.231059 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:20:31.231476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:31.740497 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:20:31.742086 [debug] [ThreadPool]: On list_petro: Close
[0m06:20:31.742917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:20:31.743476 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:20:31.750933 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:20:31.751372 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:20:31.751743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:20:31.752673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.753956 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:20:31.754383 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:20:31.754950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.755354 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:20:31.755713 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:20:31.756343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.757262 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:20:31.757654 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:20:31.758041 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:20:31.758629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.759018 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:20:31.760222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:20:31.766012 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:20:31.766433 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:20:31.766791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:20:31.767431 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.767827 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:20:31.768226 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:20:31.778759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:20:31.780081 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:20:31.781327 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:20:31.781724 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:20:31.782840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481ac24b0>]}
[0m06:20:31.783386 [debug] [MainThread]: Using duckdb connection "master"
[0m06:20:31.783771 [debug] [MainThread]: On master: BEGIN
[0m06:20:31.784134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:20:31.784797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:20:31.785191 [debug] [MainThread]: On master: COMMIT
[0m06:20:31.785596 [debug] [MainThread]: Using duckdb connection "master"
[0m06:20:31.785963 [debug] [MainThread]: On master: COMMIT
[0m06:20:31.786563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:20:31.786958 [debug] [MainThread]: On master: Close
[0m06:20:31.787465 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:20:31.787937 [info ] [MainThread]: 
[0m06:20:31.807097 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:20:31.807703 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:20:31.808312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:20:31.808747 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:20:31.835758 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:20:31.836507 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:20:31.871884 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:20:31.872650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:20:43.316532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.317063 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:20:43.317820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.318275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.318695 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:20:43.319601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.320940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.321421 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:20:43.322433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.330319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.330781 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:20:43.331528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.334506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.334947 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:20:43.335677 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.352159 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:20:43.352654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.353070 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:20:43.355069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.360789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:20:43.361272 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:20:43.362482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.364890 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:20:43.366422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48af63bf0>]}
[0m06:20:43.367126 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.56s]
[0m06:20:43.367892 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:20:43.368888 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:20:43.369490 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:20:43.370085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:20:43.370562 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:20:43.375525 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:20:43.376157 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:20:43.412077 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.412580 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260130062043406030"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:20:43.413029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:20:43.420007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.427552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.428008 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:20:43.428722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.429155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.429602 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260130062043406030'
      
      
      order by ordinal_position

  
[0m06:20:43.431991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.437167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.437657 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:20:43.440076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.447826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.448302 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:20:43.450619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.452306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.452749 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:20:43.453470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.471722 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:20:43.472448 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.472904 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260130062043406030"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260130062043406030"
    )
  
[0m06:20:43.480055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.481895 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:20:43.482364 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:20:43.482770 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:20:43.488829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:20:43.489728 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:20:43.490424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9718e89c-a094-4bb0-87c4-1373231583f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43da770b0>]}
[0m06:20:43.491086 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:20:43.491859 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:20:43.493738 [debug] [MainThread]: Using duckdb connection "master"
[0m06:20:43.494150 [debug] [MainThread]: On master: BEGIN
[0m06:20:43.494564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:20:43.495283 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:20:43.495756 [debug] [MainThread]: On master: COMMIT
[0m06:20:43.496142 [debug] [MainThread]: Using duckdb connection "master"
[0m06:20:43.496555 [debug] [MainThread]: On master: COMMIT
[0m06:20:43.497158 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:20:43.497626 [debug] [MainThread]: On master: Close
[0m06:20:43.498095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:20:43.498478 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:20:43.498905 [info ] [MainThread]: 
[0m06:20:43.499397 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.31 seconds (12.31s).
[0m06:20:43.500317 [debug] [MainThread]: Command end result
[0m06:20:43.525646 [info ] [MainThread]: 
[0m06:20:43.526218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:20:43.526671 [info ] [MainThread]: 
[0m06:20:43.527122 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:20:43.528043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.486872, "process_user_time": 5.799391, "process_kernel_time": 0.290269, "process_mem_max_rss": "312788", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:20:43.528611 [debug] [MainThread]: Command `dbt run` succeeded at 06:20:43.528511 after 14.49 seconds
[0m06:20:43.529050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48b32e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff481c14110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43dadd940>]}
[0m06:20:43.529499 [debug] [MainThread]: Flushing usage events
[0m06:20:45.468786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118b1a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118a9d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118a9deb0>]}


============================== 06:20:45.471891 | d1d0d4e3-3901-45a2-abbd-c60ede0a0bdc ==============================
[0m06:20:45.471891 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:20:45.472610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:20:45.587990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1d0d4e3-3901-45a2-abbd-c60ede0a0bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11a778560>]}
[0m06:20:45.606344 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18779896, "process_user_time": 1.351778, "process_kernel_time": 0.100983, "process_mem_max_rss": "99336", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:20:45.606896 [debug] [MainThread]: Command `dbt clean` succeeded at 06:20:45.606793 after 0.19 seconds
[0m06:20:45.607342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118a9fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118a68b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc118ad1f10>]}
[0m06:20:45.607763 [debug] [MainThread]: Flushing usage events
[0m14:18:17.107259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b2dc9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7afaf45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7afaf74a0>]}


============================== 14:18:17.125510 | f8bc9997-f86a-45af-9f11-d79625a6aefd ==============================
[0m14:18:17.125510 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:18:17.126172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:17.301765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8bc9997-f86a-45af-9f11-d79625a6aefd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7afb227b0>]}
[0m14:18:17.317587 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3c9q6jf0'
[0m14:18:17.318066 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:18:17.387014 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:18:17.388318 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:18:17.419353 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:18:17.424513 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:18:17.658651 [info ] [MainThread]: Installed from version 1.2.0
[0m14:18:17.659281 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:18:17.659880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f8bc9997-f86a-45af-9f11-d79625a6aefd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7af0adbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7af0ae060>]}
[0m14:18:17.660379 [info ] [MainThread]: 
[0m14:18:17.660867 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:18:17.674557 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6185427, "process_user_time": 1.630593, "process_kernel_time": 0.156248, "process_mem_max_rss": "101212", "process_in_blocks": "8528", "process_out_blocks": "5176"}
[0m14:18:17.675108 [debug] [MainThread]: Command `dbt deps` succeeded at 14:18:17.675002 after 0.62 seconds
[0m14:18:17.675581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7afbdd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7af072180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b37bb950>]}
[0m14:18:17.676039 [debug] [MainThread]: Flushing usage events
[0m14:18:19.454965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00b183e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af671730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af6716d0>]}


============================== 14:18:19.457990 | df9bfd27-85dc-4734-befb-dcf85ba8c93c ==============================
[0m14:18:19.457990 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:18:19.458680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:19.691505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af3e9580>]}
[0m14:18:19.753115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af3eb7d0>]}
[0m14:18:19.754866 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:18:19.807490 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:18:19.808209 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:18:19.808754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af6716d0>]}
[0m14:18:21.207560 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:18:21.208233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7600c20>]}
[0m14:18:21.449047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:18:21.454414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af53c290>]}
[0m14:18:21.549935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7e93380>]}
[0m14:18:21.550500 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:18:21.551007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7ee5f70>]}
[0m14:18:21.553042 [info ] [MainThread]: 
[0m14:18:21.553774 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:18:21.558602 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:18:21.594715 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:18:21.595163 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:18:21.595580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:22.139536 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:18:22.141121 [debug] [ThreadPool]: On list_petro: Close
[0m14:18:22.142034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:18:22.142608 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:18:22.149937 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:18:22.150377 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:18:22.150755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:22.151799 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.153127 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:18:22.153530 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:18:22.154107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.154508 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:18:22.154867 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:18:22.155494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.156409 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:18:22.156800 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:18:22.157163 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:18:22.157819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.158210 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:18:22.159482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:18:22.165429 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:18:22.165828 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:18:22.166188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:22.166865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.167248 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:18:22.167666 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:18:22.178151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:18:22.179554 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:18:22.180795 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:18:22.181190 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:18:22.182355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00a7e4dee0>]}
[0m14:18:22.182863 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:22.183243 [debug] [MainThread]: On master: BEGIN
[0m14:18:22.183630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:22.184271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:18:22.184688 [debug] [MainThread]: On master: COMMIT
[0m14:18:22.185056 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:22.185441 [debug] [MainThread]: On master: COMMIT
[0m14:18:22.186023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:18:22.186446 [debug] [MainThread]: On master: Close
[0m14:18:22.186930 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:18:22.187435 [info ] [MainThread]: 
[0m14:18:22.206477 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:18:22.207114 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:18:22.207756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:18:22.208206 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:18:22.235422 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:18:22.236229 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:18:22.271440 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:18:22.272194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:31.417384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.417916 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:18:31.418582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.419013 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.419445 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:18:31.420366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.421710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.422149 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:18:31.423180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.430920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.431390 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:18:31.432204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.435146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.435608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:18:31.436340 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.452950 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:18:31.453428 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.453847 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:18:31.455708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.461343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:18:31.461797 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:18:31.463183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.465646 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:18:31.467170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0080007650>]}
[0m14:18:31.467868 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.26s]
[0m14:18:31.468649 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:18:31.469481 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:18:31.470227 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:18:31.470851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:18:31.471286 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:18:31.476283 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:18:31.476957 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:18:31.514184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.514692 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260130141831508174"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:18:31.515148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:31.522646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.530213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.530687 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:18:31.531348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.531785 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.532206 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260130141831508174'
      
      
      order by ordinal_position

  
[0m14:18:31.534604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.539799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.540257 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:18:31.542697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.550371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.550826 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:18:31.554007 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.555678 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.556125 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:18:31.556893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.575476 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:18:31.576189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.576661 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260130141831508174"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260130141831508174"
    )
  
[0m14:18:31.585114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.586986 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:18:31.587433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:18:31.587839 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:18:31.593686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:18:31.594574 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:18:31.595222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9bfd27-85dc-4734-befb-dcf85ba8c93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006c341b20>]}
[0m14:18:31.595896 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:18:31.596622 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:18:31.597954 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:31.598421 [debug] [MainThread]: On master: BEGIN
[0m14:18:31.598818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:31.599528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:18:31.599950 [debug] [MainThread]: On master: COMMIT
[0m14:18:31.600348 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:31.600732 [debug] [MainThread]: On master: COMMIT
[0m14:18:31.601301 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:18:31.601727 [debug] [MainThread]: On master: Close
[0m14:18:31.602187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:31.602587 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:18:31.602981 [info ] [MainThread]: 
[0m14:18:31.603492 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.05 seconds (10.05s).
[0m14:18:31.604434 [debug] [MainThread]: Command end result
[0m14:18:31.630141 [info ] [MainThread]: 
[0m14:18:31.630715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:31.631180 [info ] [MainThread]: 
[0m14:18:31.631673 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:18:31.632614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.228007, "process_user_time": 5.360382, "process_kernel_time": 0.286806, "process_mem_max_rss": "297576", "process_in_blocks": "1200", "process_out_blocks": "107384"}
[0m14:18:31.633146 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:31.633044 after 12.23 seconds
[0m14:18:31.633593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00af671730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006d49afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006c32f8c0>]}
[0m14:18:31.634012 [debug] [MainThread]: Flushing usage events
[0m14:18:33.592454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21001554f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210095d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2100046930>]}


============================== 14:18:33.595571 | 523e8826-36c1-438d-8005-8a530883184f ==============================
[0m14:18:33.595571 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:18:33.596236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:33.712698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '523e8826-36c1-438d-8005-8a530883184f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210095c8f0>]}
[0m14:18:33.730828 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18896872, "process_user_time": 1.339973, "process_kernel_time": 0.11691, "process_mem_max_rss": "99644", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:18:33.731402 [debug] [MainThread]: Command `dbt clean` succeeded at 14:18:33.731264 after 0.19 seconds
[0m14:18:33.731840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21001c06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fff7f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f210095c8f0>]}
[0m14:18:33.732257 [debug] [MainThread]: Flushing usage events
[0m22:07:18.082059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51a96870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51f6b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51a96ea0>]}


============================== 22:07:18.098622 | 690ee77b-bb0c-483a-8ce7-f2c14955acbe ==============================
[0m22:07:18.098622 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:18.099315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:18.261177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '690ee77b-bb0c-483a-8ce7-f2c14955acbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5332ad20>]}
[0m22:07:18.276770 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fmwxrtu2'
[0m22:07:18.277273 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:18.394556 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:18.396283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:18.456906 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:18.462460 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:18.820501 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:18.821151 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:07:18.821762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '690ee77b-bb0c-483a-8ce7-f2c14955acbe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51480830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c51459820>]}
[0m22:07:18.822269 [info ] [MainThread]: 
[0m22:07:18.822782 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:18.878909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8482842, "process_user_time": 1.62606, "process_kernel_time": 0.148279, "process_mem_max_rss": "101476", "process_in_blocks": "8520", "process_out_blocks": "5176"}
[0m22:07:18.879642 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:18.879530 after 0.85 seconds
[0m22:07:18.880105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c525db530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c513af8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c513ac980>]}
[0m22:07:18.880554 [debug] [MainThread]: Flushing usage events
[0m22:07:20.687804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216bad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3217875670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32167aaf30>]}


============================== 22:07:20.690976 | 0d1dd4e9-9bd0-4388-9943-dbd11b848e66 ==============================
[0m22:07:20.690976 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:20.691690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:07:20.925922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f321867c740>]}
[0m22:07:20.987437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216589100>]}
[0m22:07:20.989285 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:07:21.013263 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:21.014005 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:21.014513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32172d0aa0>]}
[0m22:07:22.404548 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:22.405215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f320e90f860>]}
[0m22:07:22.650417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:22.656111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216c510a0>]}
[0m22:07:22.751469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f320f0c2d20>]}
[0m22:07:22.752088 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:07:22.752619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216c51a60>]}
[0m22:07:22.754746 [info ] [MainThread]: 
[0m22:07:22.755501 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:22.760520 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:22.797459 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:22.797958 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:22.798372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:23.629920 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:07:23.631594 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:23.632493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:23.633117 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:23.640904 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.641396 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:23.641794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:23.642805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.644216 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.644646 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:23.645303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.645711 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.646136 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:23.646811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.647787 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:23.648250 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:23.648675 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:23.649343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.649795 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:23.651210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:23.657672 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:23.658097 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:23.658479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:23.659170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.659559 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:23.659931 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:23.670361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:23.671706 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:23.672907 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:23.673336 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:23.674449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32166a46e0>]}
[0m22:07:23.674954 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:23.675381 [debug] [MainThread]: On master: BEGIN
[0m22:07:23.675746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:23.676397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:23.676793 [debug] [MainThread]: On master: COMMIT
[0m22:07:23.677204 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:23.677570 [debug] [MainThread]: On master: COMMIT
[0m22:07:23.678172 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:23.678567 [debug] [MainThread]: On master: Close
[0m22:07:23.679074 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:23.679578 [info ] [MainThread]: 
[0m22:07:23.697553 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:23.698168 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:23.698730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:23.699191 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:23.726371 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:23.727190 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:23.762298 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:23.763076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:34.286636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.287213 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:34.287936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.288398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.288809 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:34.289779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.291190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.291629 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:34.292838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.300653 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.301132 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:34.302150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.305185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.305638 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:34.306368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.323231 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:34.323752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.324197 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:34.325773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.331746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:34.332235 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:34.334133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.336601 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:34.338130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f320e8a8f50>]}
[0m22:07:34.338808 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.64s]
[0m22:07:34.339582 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:34.340419 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:34.341013 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:34.341662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:34.342145 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:34.347363 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:34.348280 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:34.384710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.385303 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260130220734378580"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:34.385767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:34.393215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.402015 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.402577 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:34.403432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.403952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.404427 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260130220734378580'
      
      
      order by ordinal_position

  
[0m22:07:34.407270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.412703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.413190 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:34.415616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.423522 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.424000 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:34.427190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.428892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.429366 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:34.430114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.448784 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:34.449576 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.450052 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260130220734378580"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260130220734378580"
    )
  
[0m22:07:34.459025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.460940 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:34.461398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:34.461815 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:34.468436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:34.469383 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:34.470096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dd4e9-9bd0-4388-9943-dbd11b848e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fc164080>]}
[0m22:07:34.470764 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:07:34.471545 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:34.473304 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:34.473732 [debug] [MainThread]: On master: BEGIN
[0m22:07:34.474158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:34.474921 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:34.475369 [debug] [MainThread]: On master: COMMIT
[0m22:07:34.475750 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:34.476177 [debug] [MainThread]: On master: COMMIT
[0m22:07:34.476767 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:34.477217 [debug] [MainThread]: On master: Close
[0m22:07:34.477708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:34.478108 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:34.478528 [info ] [MainThread]: 
[0m22:07:34.479026 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.72 seconds (11.72s).
[0m22:07:34.479941 [debug] [MainThread]: Command end result
[0m22:07:34.506336 [info ] [MainThread]: 
[0m22:07:34.507009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:34.507475 [info ] [MainThread]: 
[0m22:07:34.507931 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:34.508895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.874199, "process_user_time": 5.385848, "process_kernel_time": 0.283097, "process_mem_max_rss": "302060", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:07:34.509474 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:34.509372 after 13.87 seconds
[0m22:07:34.509915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32173f6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3216d0b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31c775b7d0>]}
[0m22:07:34.510373 [debug] [MainThread]: Flushing usage events
[0m22:07:36.403072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d70af980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d692afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d70adfa0>]}


============================== 22:07:36.406183 | 1482a502-82e9-4462-a312-a7d4ecfaf1c2 ==============================
[0m22:07:36.406183 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:36.406820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:36.521196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1482a502-82e9-4462-a312-a7d4ecfaf1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d77c3860>]}
[0m22:07:36.538924 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18818788, "process_user_time": 1.348855, "process_kernel_time": 0.119987, "process_mem_max_rss": "99700", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:07:36.539491 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:36.539391 after 0.19 seconds
[0m22:07:36.539906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d99f3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d6f6e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d6327950>]}
[0m22:07:36.540374 [debug] [MainThread]: Flushing usage events
[0m06:14:25.787980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad182d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad6b23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25aef0d6d0>]}


============================== 06:14:25.803775 | 46b61f68-2db1-4889-b7b6-f5e03b7b3e8c ==============================
[0m06:14:25.803775 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:14:25.804477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:14:25.965246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46b61f68-2db1-4889-b7b6-f5e03b7b3e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25aef0e960>]}
[0m06:14:25.980510 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xkv8whit'
[0m06:14:25.980973 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:14:26.096163 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:14:26.097698 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:14:26.152930 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:14:26.158061 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:14:26.390905 [info ] [MainThread]: Installed from version 1.2.0
[0m06:14:26.391549 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:14:26.392104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '46b61f68-2db1-4889-b7b6-f5e03b7b3e8c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25acd7c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ad093740>]}
[0m06:14:26.392606 [info ] [MainThread]: 
[0m06:14:26.393100 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:14:26.404067 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.66776896, "process_user_time": 1.627118, "process_kernel_time": 0.153539, "process_mem_max_rss": "101444", "process_in_blocks": "8520", "process_out_blocks": "5176"}
[0m06:14:26.404681 [debug] [MainThread]: Command `dbt deps` succeeded at 06:14:26.404571 after 0.67 seconds
[0m06:14:26.405131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25acd7d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ace32600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25acd5d670>]}
[0m06:14:26.405600 [debug] [MainThread]: Flushing usage events
[0m06:14:28.163728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c3e96570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c416d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4daec60>]}


============================== 06:14:28.166852 | 6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc ==============================
[0m06:14:28.166852 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:14:28.167545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:14:28.417122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c5d6c560>]}
[0m06:14:28.479188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4105730>]}
[0m06:14:28.481047 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:14:28.506923 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:14:28.507700 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:14:28.508259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4425d30>]}
[0m06:14:29.912357 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:14:29.913009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bc860080>]}
[0m06:14:30.155895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:14:30.161499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b7f14830>]}
[0m06:14:30.256810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bc177680>]}
[0m06:14:30.257403 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:14:30.257891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b7f61130>]}
[0m06:14:30.259948 [info ] [MainThread]: 
[0m06:14:30.260704 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:14:30.265604 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:14:30.302195 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:14:30.302709 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:14:30.303098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:30.830536 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:14:30.832492 [debug] [ThreadPool]: On list_petro: Close
[0m06:14:30.833533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:14:30.834287 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:14:30.843599 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:14:30.844024 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:14:30.844445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:30.845569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.846920 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:14:30.847343 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:14:30.848255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.848649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:14:30.849013 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:14:30.849708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.850663 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:14:30.851052 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:14:30.851435 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:14:30.851996 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.852413 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:14:30.853721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:14:30.859940 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:14:30.860380 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:14:30.860745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:30.861531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.861921 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:14:30.862320 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:14:30.872982 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:14:30.874474 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:14:30.875728 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:14:30.876131 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:14:30.877364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bc860200>]}
[0m06:14:30.877883 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:30.878327 [debug] [MainThread]: On master: BEGIN
[0m06:14:30.878704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:30.879386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:30.879801 [debug] [MainThread]: On master: COMMIT
[0m06:14:30.880180 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:30.880599 [debug] [MainThread]: On master: COMMIT
[0m06:14:30.881196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:30.881634 [debug] [MainThread]: On master: Close
[0m06:14:30.882139 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:14:30.882686 [info ] [MainThread]: 
[0m06:14:30.902860 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:14:30.903587 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:14:30.904330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:14:30.904784 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:14:30.932120 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:14:30.932993 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:14:30.968895 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:14:30.969777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:39.348660 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.349236 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:14:39.349942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.350406 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.350826 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:14:39.351774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.353129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.353594 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:14:39.354605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.362398 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.362852 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:14:39.363680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.366685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.367137 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:14:39.367944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.384786 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:14:39.385273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.385689 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:14:39.387507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.393200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:39.393670 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:14:39.394815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.397290 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:14:39.398818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c5d47590>]}
[0m06:14:39.399533 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.49s]
[0m06:14:39.400388 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:14:39.401395 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:14:39.401944 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:14:39.402606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:14:39.403043 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:14:39.408038 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:14:39.408693 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:14:39.444619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.445123 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260131061439438614"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:14:39.445599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:39.452559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.460179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.460655 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:14:39.461324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.461759 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.462176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260131061439438614'
      
      
      order by ordinal_position

  
[0m06:14:39.464537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.469671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.470129 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:14:39.472470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.480049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.480525 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:14:39.483614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.485274 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.485716 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:14:39.486464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.505042 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:14:39.505791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.506290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260131061439438614"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260131061439438614"
    )
  
[0m06:14:39.514902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.516838 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:14:39.517318 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:39.517729 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:14:39.522875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:39.523795 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:14:39.524479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f94a048-fc3a-4e96-82ff-f3a97f3ba8dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff678309220>]}
[0m06:14:39.525148 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:14:39.525971 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:14:39.527585 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:39.527996 [debug] [MainThread]: On master: BEGIN
[0m06:14:39.528414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:39.529122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:39.529560 [debug] [MainThread]: On master: COMMIT
[0m06:14:39.529930 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:39.530327 [debug] [MainThread]: On master: COMMIT
[0m06:14:39.530928 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:39.531363 [debug] [MainThread]: On master: Close
[0m06:14:39.531821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:39.532179 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:14:39.532600 [info ] [MainThread]: 
[0m06:14:39.533114 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m06:14:39.534110 [debug] [MainThread]: Command end result
[0m06:14:39.560101 [info ] [MainThread]: 
[0m06:14:39.560727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:14:39.561262 [info ] [MainThread]: 
[0m06:14:39.561804 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:14:39.562800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.452127, "process_user_time": 5.424592, "process_kernel_time": 0.289779, "process_mem_max_rss": "279280", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:14:39.563372 [debug] [MainThread]: Command `dbt run` succeeded at 06:14:39.563265 after 11.45 seconds
[0m06:14:39.563811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c3fc99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c40abda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c43f7d40>]}
[0m06:14:39.564254 [debug] [MainThread]: Flushing usage events
[0m06:14:41.335201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf4960710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf37a4920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf2e62bd0>]}


============================== 06:14:41.338259 | b251035d-4c46-4be2-b373-e9312a1d7a91 ==============================
[0m06:14:41.338259 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:14:41.338948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:14:41.453258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b251035d-4c46-4be2-b373-e9312a1d7a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf3bed8e0>]}
[0m06:14:41.471422 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18813032, "process_user_time": 1.33291, "process_kernel_time": 0.122899, "process_mem_max_rss": "99688", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:14:41.471961 [debug] [MainThread]: Command `dbt clean` succeeded at 06:14:41.471863 after 0.19 seconds
[0m06:14:41.472422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf6fbb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf35883b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf2b31790>]}
[0m06:14:41.472835 [debug] [MainThread]: Flushing usage events
[0m14:10:01.126595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3171f96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316cfb740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31694adb0>]}


============================== 14:10:01.146478 | 1f9ef5a5-06a6-4b9d-9aaf-28a0e8e16859 ==============================
[0m14:10:01.146478 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:01.147163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:10:01.330183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f9ef5a5-06a6-4b9d-9aaf-28a0e8e16859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3167c3d70>]}
[0m14:10:01.346421 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qg__b2al'
[0m14:10:01.346936 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:10:01.435046 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:10:01.436953 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:10:01.468843 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:10:01.474761 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:10:01.941844 [info ] [MainThread]: Installed from version 1.2.0
[0m14:10:01.942464 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:10:01.943005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1f9ef5a5-06a6-4b9d-9aaf-28a0e8e16859', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3165ec620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316757a70>]}
[0m14:10:01.943500 [info ] [MainThread]: 
[0m14:10:01.943981 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:10:01.955623 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8811898, "process_user_time": 1.661222, "process_kernel_time": 0.14262, "process_mem_max_rss": "101408", "process_in_blocks": "8512", "process_out_blocks": "5168"}
[0m14:10:01.956195 [debug] [MainThread]: Command `dbt deps` succeeded at 14:10:01.956090 after 0.88 seconds
[0m14:10:01.956653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316d643b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31784a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31694ad20>]}
[0m14:10:01.957084 [debug] [MainThread]: Flushing usage events
[0m14:10:03.857281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ccfe3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cf11c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ccfaa8a0>]}


============================== 14:10:03.860503 | bd4b7619-9058-4608-b371-8cb40bc80642 ==============================
[0m14:10:03.860503 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:03.861202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:04.098249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ceca48c0>]}
[0m14:10:04.161465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c597f410>]}
[0m14:10:04.163397 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:10:04.195432 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:10:04.196187 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:10:04.196724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cce23e60>]}
[0m14:10:05.605358 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:10:05.606034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c50db860>]}
[0m14:10:05.858477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:10:05.863901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c5098da0>]}
[0m14:10:05.964021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c5197260>]}
[0m14:10:05.964621 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:10:05.965134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c5906180>]}
[0m14:10:05.967238 [info ] [MainThread]: 
[0m14:10:05.967988 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:10:05.972989 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:10:06.010714 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:10:06.011232 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:10:06.011661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:06.452269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.454051 [debug] [ThreadPool]: On list_petro: Close
[0m14:10:06.454974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:10:06.455576 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:10:06.463537 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:06.463965 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:10:06.464379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:06.465701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.467082 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:06.467510 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:10:06.468309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.468726 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:06.469088 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:10:06.469745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.470694 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:10:06.471090 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:10:06.471488 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:10:06.472065 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.472496 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:10:06.473762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:10:06.479781 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:10:06.480191 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:10:06.480579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:06.481250 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.481666 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:10:06.482046 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:10:06.492890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:10:06.494312 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:10:06.495570 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:10:06.495967 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:10:06.497031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c51ebcb0>]}
[0m14:10:06.497589 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:06.497977 [debug] [MainThread]: On master: BEGIN
[0m14:10:06.498363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:06.499036 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:06.499459 [debug] [MainThread]: On master: COMMIT
[0m14:10:06.499831 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:06.500191 [debug] [MainThread]: On master: COMMIT
[0m14:10:06.500784 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:06.501180 [debug] [MainThread]: On master: Close
[0m14:10:06.501692 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:10:06.502169 [info ] [MainThread]: 
[0m14:10:06.523422 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:10:06.524034 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:10:06.524650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:10:06.525082 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:10:06.552024 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:10:06.552840 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:10:06.588491 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:10:06.589230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:16.882454 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.883009 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:16.883685 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.884141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.884587 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:10:16.885591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.886943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.887402 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:10:16.888460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.896373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.896850 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:16.897668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.900725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.901187 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:16.901908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.918578 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:16.919057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.919500 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:16.920945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.926669 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.927124 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:10:16.928557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.930947 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:16.932457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cd9fd730>]}
[0m14:10:16.933132 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.41s]
[0m14:10:16.933890 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:16.934718 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:16.935288 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:16.935959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:16.936441 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:16.941496 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:16.942284 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:16.978823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.979382 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260131141016972695"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:16.979841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:16.987049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.994931 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.995415 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:16.996084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.996536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.996965 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260131141016972695'
      
      
      order by ordinal_position

  
[0m14:10:16.999295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.004460 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.004916 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:17.007153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.014869 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.015331 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:17.018096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.019782 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.020226 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:10:17.020937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.039308 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:17.040034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.040506 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260131141016972695"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260131141016972695"
    )
  
[0m14:10:17.046807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.048661 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:17.049107 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:17.049539 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:17.057073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:17.057969 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:17.058658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4b7619-9058-4608-b371-8cb40bc80642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd782793020>]}
[0m14:10:17.059325 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:10:17.060150 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:17.061900 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:17.062308 [debug] [MainThread]: On master: BEGIN
[0m14:10:17.062726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:17.063483 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:17.063963 [debug] [MainThread]: On master: COMMIT
[0m14:10:17.064359 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:17.064760 [debug] [MainThread]: On master: COMMIT
[0m14:10:17.065328 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:17.065760 [debug] [MainThread]: On master: Close
[0m14:10:17.066223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:17.066629 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:17.067040 [info ] [MainThread]: 
[0m14:10:17.067588 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.10 seconds (11.10s).
[0m14:10:17.068606 [debug] [MainThread]: Command end result
[0m14:10:17.095360 [info ] [MainThread]: 
[0m14:10:17.096021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:17.096554 [info ] [MainThread]: 
[0m14:10:17.097078 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:17.098117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.294845, "process_user_time": 5.478823, "process_kernel_time": 0.278041, "process_mem_max_rss": "283128", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m14:10:17.098718 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:17.098611 after 13.30 seconds
[0m14:10:17.099166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ccfe19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd781a69fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cd3a3200>]}
[0m14:10:17.099627 [debug] [MainThread]: Flushing usage events
[0m14:10:19.097149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3257e7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa324cfd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa324fc8a40>]}


============================== 14:10:19.100261 | 8b540e30-43ef-4a0d-9f3a-3870bd6dfdf3 ==============================
[0m14:10:19.100261 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:19.100967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:19.216567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b540e30-43ef-4a0d-9f3a-3870bd6dfdf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa324c94410>]}
[0m14:10:19.235019 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19052821, "process_user_time": 1.350946, "process_kernel_time": 0.097923, "process_mem_max_rss": "99728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:19.235599 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:19.235493 after 0.19 seconds
[0m14:10:19.236031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa324dd5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32699e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa325eaebd0>]}
[0m14:10:19.236477 [debug] [MainThread]: Flushing usage events
[0m22:06:34.876374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e9322c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e9742c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ea3f0b00>]}


============================== 22:06:34.895740 | 0af2afb3-00b9-4e5b-a8b7-64c3f35908cd ==============================
[0m22:06:34.895740 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:34.896415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:35.068811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0af2afb3-00b9-4e5b-a8b7-64c3f35908cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e91677d0>]}
[0m22:06:35.085746 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wrm5mvu7'
[0m22:06:35.086263 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:35.169765 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:35.171362 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:35.203781 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:35.209058 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:35.362047 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:35.362714 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:06:35.363327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0af2afb3-00b9-4e5b-a8b7-64c3f35908cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e908a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e908b500>]}
[0m22:06:35.363812 [info ] [MainThread]: 
[0m22:06:35.364330 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:35.376047 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5518326, "process_user_time": 1.68341, "process_kernel_time": 0.14329, "process_mem_max_rss": "101528", "process_in_blocks": "8512", "process_out_blocks": "5168"}
[0m22:06:35.376594 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:35.376489 after 0.55 seconds
[0m22:06:35.377066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ea3f0b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e9368170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e948e0f0>]}
[0m22:06:35.377502 [debug] [MainThread]: Flushing usage events
[0m22:06:36.994923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06efe7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06efe76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06efe4290>]}


============================== 22:06:36.998099 | 5fd591ec-0ed6-49fc-82d6-75c53b90f2c9 ==============================
[0m22:06:36.998099 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:36.998832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.232695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0702908f0>]}
[0m22:06:37.294305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06e320770>]}
[0m22:06:37.296146 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:06:37.322974 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:37.323798 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:37.324358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06efe5490>]}
[0m22:06:38.716229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:38.716906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0665f7b60>]}
[0m22:06:38.964435 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:38.970096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0665e0470>]}
[0m22:06:39.070566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb066c856d0>]}
[0m22:06:39.071204 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:06:39.071726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0665fb9b0>]}
[0m22:06:39.073864 [info ] [MainThread]: 
[0m22:06:39.074570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:39.079600 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:39.117062 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:39.117591 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:39.118033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:39.833584 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:39.836332 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:39.837702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:39.838695 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:39.847875 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.848316 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:39.848710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.850219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.851617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.852028 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:39.852622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.853032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.853395 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:39.854055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.854996 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.855390 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:39.855778 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:39.856364 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.856788 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:39.858098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:39.864300 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.864736 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:39.865109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:39.866162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.866553 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:39.866992 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:39.877806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:39.879331 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:39.880577 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:39.881004 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:39.882144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb066c39eb0>]}
[0m22:06:39.882710 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.883120 [debug] [MainThread]: On master: BEGIN
[0m22:06:39.883481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:39.884206 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.884606 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.885006 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:39.885364 [debug] [MainThread]: On master: COMMIT
[0m22:06:39.885972 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:39.886368 [debug] [MainThread]: On master: Close
[0m22:06:39.886912 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:39.887415 [info ] [MainThread]: 
[0m22:06:39.908294 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:39.908978 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:39.909666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:39.910132 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:39.937764 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:39.938595 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:39.974479 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:39.975378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.853028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.853591 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:48.854546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.855012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.855433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.856423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.857816 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.858260 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:06:48.859322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.867315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.867829 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:48.868704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.872008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.872458 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:48.873237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.890050 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.890537 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.890989 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:48.892236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.898080 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:48.898549 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:06:48.899854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.902338 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:48.903879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0640a6180>]}
[0m22:06:48.904568 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.99s]
[0m22:06:48.905366 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:48.906222 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:48.906799 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:48.907513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:48.908114 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:48.913235 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:48.913915 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:48.951319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.951927 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260131220648945091"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:48.952393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:48.962031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.970105 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.970571 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:48.971268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.971726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.972156 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260131220648945091'
      
      
      order by ordinal_position

  
[0m22:06:48.974753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.980119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.980574 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.983045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.991005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.991468 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:48.993917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:48.995697 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:48.996157 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:06:48.996950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.016194 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:49.017015 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.017484 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260131220648945091"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260131220648945091"
    )
  
[0m22:06:49.025839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.027737 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.028185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:49.028591 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:49.035397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:49.036348 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:49.037048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd591ec-0ed6-49fc-82d6-75c53b90f2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb026fe2c60>]}
[0m22:06:49.037763 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m22:06:49.038511 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:49.040133 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.040544 [debug] [MainThread]: On master: BEGIN
[0m22:06:49.040960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:49.041719 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.042154 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.042524 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:49.042929 [debug] [MainThread]: On master: COMMIT
[0m22:06:49.043510 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:49.043951 [debug] [MainThread]: On master: Close
[0m22:06:49.044417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:49.044800 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:49.045200 [info ] [MainThread]: 
[0m22:06:49.045749 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m22:06:49.046765 [debug] [MainThread]: Command end result
[0m22:06:49.072996 [info ] [MainThread]: 
[0m22:06:49.073704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:49.074236 [info ] [MainThread]: 
[0m22:06:49.074784 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:49.075857 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.134117, "process_user_time": 6.068084, "process_kernel_time": 0.298397, "process_mem_max_rss": "280308", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:06:49.076397 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:49.076293 after 12.13 seconds
[0m22:06:49.076855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06e7f2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06e4fdbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0270690d0>]}
[0m22:06:49.077282 [debug] [MainThread]: Flushing usage events
[0m22:06:50.858381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e350140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e1b8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e1ba6c0>]}


============================== 22:06:50.861563 | 40be1307-5e64-4be2-9bc8-1254161b9e02 ==============================
[0m22:06:50.861563 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:50.862285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.978617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40be1307-5e64-4be2-9bc8-1254161b9e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6ff545c0>]}
[0m22:06:50.997454 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19193503, "process_user_time": 1.380567, "process_kernel_time": 0.095969, "process_mem_max_rss": "99560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:50.998042 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:50.997931 after 0.19 seconds
[0m22:06:50.998475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e8a03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e067290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6e0676b0>]}
[0m22:06:50.998935 [debug] [MainThread]: Flushing usage events
[0m06:21:46.751713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72d348d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72b67e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72b62b7a0>]}


============================== 06:21:46.767803 | ec5ff1f2-6f8b-4dca-ab7b-c65bc42ffa98 ==============================
[0m06:21:46.767803 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:46.768473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:21:46.953703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec5ff1f2-6f8b-4dca-ab7b-c65bc42ffa98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72aff7b00>]}
[0m06:21:46.968897 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1kxrcl9f'
[0m06:21:46.969353 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:21:47.162354 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:21:47.163813 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:21:47.217202 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:21:47.222375 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:21:47.436352 [info ] [MainThread]: Installed from version 1.2.0
[0m06:21:47.436956 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:21:47.437503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ec5ff1f2-6f8b-4dca-ab7b-c65bc42ffa98', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72b06fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72af93a40>]}
[0m06:21:47.437965 [info ] [MainThread]: 
[0m06:21:47.438450 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:21:47.447378 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.74737006, "process_user_time": 1.616336, "process_kernel_time": 0.139683, "process_mem_max_rss": "101268", "process_in_blocks": "8504", "process_out_blocks": "5168"}
[0m06:21:47.447933 [debug] [MainThread]: Command `dbt deps` succeeded at 06:21:47.447834 after 0.75 seconds
[0m06:21:47.448352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72bd00470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72af58e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd72af587d0>]}
[0m06:21:47.448802 [debug] [MainThread]: Flushing usage events
[0m06:21:49.103089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9516b1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9521aa420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb951eb2960>]}


============================== 06:21:49.106076 | a982fe28-7d57-4a0d-a4f1-19b2a4c99a40 ==============================
[0m06:21:49.106076 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:49.106748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:21:49.336056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9499c9f10>]}
[0m06:21:49.397345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb951133770>]}
[0m06:21:49.399125 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:21:49.422596 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:21:49.423299 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:21:49.423858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb949865df0>]}
[0m06:21:50.810467 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:21:50.811103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9490ed580>]}
[0m06:21:51.043698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:21:51.049124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9490ee450>]}
[0m06:21:51.141735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb949197dd0>]}
[0m06:21:51.142247 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:21:51.142807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9513c02c0>]}
[0m06:21:51.144782 [info ] [MainThread]: 
[0m06:21:51.145477 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:21:51.150257 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:21:51.185875 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:21:51.186320 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:21:51.186732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:51.738819 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:21:51.740442 [debug] [ThreadPool]: On list_petro: Close
[0m06:21:51.741268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:21:51.741824 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:21:51.749247 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:51.749684 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:21:51.750055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:51.750973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.752259 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:51.752672 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:21:51.753248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.753652 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:51.754011 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:21:51.754612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.755532 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:21:51.755923 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:21:51.756289 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:21:51.756872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.757261 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:21:51.758459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:21:51.764190 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:21:51.764609 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:21:51.764969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:51.765838 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.766221 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:21:51.766640 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:21:51.776783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:21:51.778107 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:21:51.779285 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:21:51.779698 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:21:51.780756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb951332e10>]}
[0m06:21:51.781260 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:51.781673 [debug] [MainThread]: On master: BEGIN
[0m06:21:51.782036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:21:51.782671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:51.783067 [debug] [MainThread]: On master: COMMIT
[0m06:21:51.783452 [debug] [MainThread]: Using duckdb connection "master"
[0m06:21:51.783813 [debug] [MainThread]: On master: COMMIT
[0m06:21:51.784377 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:21:51.784789 [debug] [MainThread]: On master: Close
[0m06:21:51.785261 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:21:51.785730 [info ] [MainThread]: 
[0m06:21:51.804455 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:21:51.805028 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:21:51.805600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:21:51.806035 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:21:51.832807 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:21:51.833560 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:21:51.868835 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:21:51.869584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:00.698232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.698801 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:22:00.699704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.700147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.700593 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:00.701554 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.702922 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.703364 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:00.704536 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.712557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.713017 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:22:00.713822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.716822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.717266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:22:00.717985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.734727 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:00.735193 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.735644 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:00.737861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.743549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:00.744002 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:22:00.745412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.747777 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:22:00.749319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb952d47770>]}
[0m06:22:00.750027 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.94s]
[0m06:22:00.750806 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:22:00.751611 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:22:00.752160 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:22:00.752924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:22:00.753363 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:22:00.758299 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:22:00.758955 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:22:00.795067 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.795567 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260201062200789067"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:22:00.796016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:00.803112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.810587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.811033 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:22:00.811669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.812095 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.812535 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260201062200789067'
      
      
      order by ordinal_position

  
[0m06:22:00.814905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.819973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.820455 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:00.822689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.830281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.830778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:00.833068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.834734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.835174 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:22:00.835907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.854123 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:22:00.854835 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.855285 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260201062200789067"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260201062200789067"
    )
  
[0m06:22:00.862886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.864750 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:00.865185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:00.865614 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:00.871910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:00.872790 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:22:00.873462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a982fe28-7d57-4a0d-a4f1-19b2a4c99a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90dba7410>]}
[0m06:22:00.874117 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:22:00.874869 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:22:00.876449 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:00.876857 [debug] [MainThread]: On master: BEGIN
[0m06:22:00.877226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:00.877898 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:00.878300 [debug] [MainThread]: On master: COMMIT
[0m06:22:00.878728 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:00.879093 [debug] [MainThread]: On master: COMMIT
[0m06:22:00.879698 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:00.880087 [debug] [MainThread]: On master: Close
[0m06:22:00.880568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:00.880922 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:22:00.881310 [info ] [MainThread]: 
[0m06:22:00.881837 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.74 seconds (9.74s).
[0m06:22:00.882834 [debug] [MainThread]: Command end result
[0m06:22:00.908306 [info ] [MainThread]: 
[0m06:22:00.908921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:00.909448 [info ] [MainThread]: 
[0m06:22:00.909975 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:22:00.910951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.859628, "process_user_time": 5.812298, "process_kernel_time": 0.287915, "process_mem_max_rss": "282560", "process_in_blocks": "1200", "process_out_blocks": "107408"}
[0m06:22:00.911524 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:00.911380 after 11.86 seconds
[0m06:22:00.911955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9532d3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb950fa9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95146ba10>]}
[0m06:22:00.912375 [debug] [MainThread]: Flushing usage events
[0m06:22:02.659806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531eba930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532932930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0530bc6b40>]}


============================== 06:22:02.662785 | 0b5213ed-c2ad-4cf2-9cc0-53946a35befc ==============================
[0m06:22:02.662785 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:22:02.663442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:22:02.777409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b5213ed-c2ad-4cf2-9cc0-53946a35befc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0530b4a2a0>]}
[0m06:22:02.796262 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18777582, "process_user_time": 1.344874, "process_kernel_time": 0.094991, "process_mem_max_rss": "99628", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:22:02.796870 [debug] [MainThread]: Command `dbt clean` succeeded at 06:22:02.796768 after 0.19 seconds
[0m06:22:02.797284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531051ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531625550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531626c90>]}
[0m06:22:02.797722 [debug] [MainThread]: Flushing usage events
[0m14:11:50.087165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da375580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da3742f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da376d50>]}


============================== 14:11:50.103739 | 5e957892-148b-48a6-8a59-ae6d2997fe2f ==============================
[0m14:11:50.103739 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:11:50.104474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:50.264862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e957892-148b-48a6-8a59-ae6d2997fe2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dc026f90>]}
[0m14:11:50.280733 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_sn7cp2m'
[0m14:11:50.281265 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:11:50.504532 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:11:50.506591 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:11:50.589807 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:11:50.595705 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:11:50.954793 [info ] [MainThread]: Installed from version 1.2.0
[0m14:11:50.955450 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:11:50.956001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e957892-148b-48a6-8a59-ae6d2997fe2f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da15bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8da0a5820>]}
[0m14:11:50.956469 [info ] [MainThread]: 
[0m14:11:50.956938 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:11:50.969729 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9354542, "process_user_time": 1.676459, "process_kernel_time": 0.136362, "process_mem_max_rss": "101236", "process_in_blocks": "8504", "process_out_blocks": "5168"}
[0m14:11:50.970303 [debug] [MainThread]: Command `dbt deps` succeeded at 14:11:50.970199 after 0.94 seconds
[0m14:11:50.970733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8de9bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dc026f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8dad48d40>]}
[0m14:11:50.971175 [debug] [MainThread]: Flushing usage events
[0m14:11:52.812914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ae0e4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad8c9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adc9ddf0>]}


============================== 14:11:52.816208 | d1ef84a2-0f68-4fbf-8d20-1b8fb21a3985 ==============================
[0m14:11:52.816208 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:11:52.816871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:53.055041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad6686e0>]}
[0m14:11:53.117141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ae4ae6c0>]}
[0m14:11:53.119060 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:11:53.143876 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:11:53.144689 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:11:53.145273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a6157410>]}
[0m14:11:54.532508 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:11:54.533184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a58faf60>]}
[0m14:11:54.777455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:11:54.782948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a58f90d0>]}
[0m14:11:54.877117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a5976180>]}
[0m14:11:54.877673 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:11:54.878222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a58d6e70>]}
[0m14:11:54.880264 [info ] [MainThread]: 
[0m14:11:54.881007 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:54.885795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:11:54.922033 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:11:54.922527 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:11:54.922926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:55.658069 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:11:55.660002 [debug] [ThreadPool]: On list_petro: Close
[0m14:11:55.661192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:11:55.662102 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:11:55.671164 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:55.671583 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:11:55.671961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:55.673370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.674704 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:55.675112 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:11:55.675703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.676105 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:55.676468 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:11:55.677087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.678009 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:11:55.678393 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:11:55.678753 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:11:55.679347 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.679740 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:11:55.680947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:11:55.686992 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:11:55.687396 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:11:55.687840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:55.688546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.688924 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:11:55.689321 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:11:55.700123 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:55.701603 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:11:55.702820 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:11:55.703260 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:11:55.704401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad6ac920>]}
[0m14:11:55.704930 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:55.705413 [debug] [MainThread]: On master: BEGIN
[0m14:11:55.705781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:55.706501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:55.706897 [debug] [MainThread]: On master: COMMIT
[0m14:11:55.707298 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:55.707665 [debug] [MainThread]: On master: COMMIT
[0m14:11:55.708293 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:55.708695 [debug] [MainThread]: On master: Close
[0m14:11:55.709255 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:11:55.709743 [info ] [MainThread]: 
[0m14:11:55.727411 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:11:55.728070 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:11:55.728751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:11:55.729213 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:11:55.756869 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:11:55.757711 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:11:55.793544 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:11:55.794382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:07.078590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.079172 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:12:07.079911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.080399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.080820 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:12:07.081845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.083259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.083720 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:12:07.084904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.093414 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.093943 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:12:07.095029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.098369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.098817 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:12:07.099616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.116581 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:07.117115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.117535 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:07.119584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.125776 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:07.126275 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:12:07.127676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.130249 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:12:07.131823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a5771730>]}
[0m14:12:07.132582 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.40s]
[0m14:12:07.133407 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:12:07.134367 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:12:07.135098 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:12:07.135784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:12:07.136263 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:12:07.141602 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:12:07.142308 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:12:07.179440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.180029 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260201141207173339"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:12:07.180479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:07.187955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.195999 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.196475 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:12:07.197248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.197687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.198153 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260201141207173339'
      
      
      order by ordinal_position

  
[0m14:12:07.200994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.206581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.207087 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:07.209897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.218194 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.218683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:07.221623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.223570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.224061 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:12:07.224862 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.244780 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:12:07.245639 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.246149 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260201141207173339"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260201141207173339"
    )
  
[0m14:12:07.255015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.257217 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:07.257720 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:07.258179 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:07.264653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:07.265794 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:12:07.266576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ef84a2-0f68-4fbf-8d20-1b8fb21a3985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99621ef470>]}
[0m14:12:07.267324 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.13s]
[0m14:12:07.268221 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:12:07.269933 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:07.270398 [debug] [MainThread]: On master: BEGIN
[0m14:12:07.270773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:07.271664 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:07.272126 [debug] [MainThread]: On master: COMMIT
[0m14:12:07.272509 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:07.272879 [debug] [MainThread]: On master: COMMIT
[0m14:12:07.273541 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:07.273937 [debug] [MainThread]: On master: Close
[0m14:12:07.274481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:07.274848 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:12:07.275299 [info ] [MainThread]: 
[0m14:12:07.275823 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.39 seconds (12.39s).
[0m14:12:07.276862 [debug] [MainThread]: Command end result
[0m14:12:07.304572 [info ] [MainThread]: 
[0m14:12:07.305313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:07.305886 [info ] [MainThread]: 
[0m14:12:07.306480 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:12:07.307563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.548134, "process_user_time": 6.116972, "process_kernel_time": 0.302394, "process_mem_max_rss": "279136", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m14:12:07.308170 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:07.308054 after 14.55 seconds
[0m14:12:07.308630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99adc42930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ad6ff6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9962220560>]}
[0m14:12:07.309101 [debug] [MainThread]: Flushing usage events
[0m14:12:09.278126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fa5eee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fafd8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fa5eef60>]}


============================== 14:12:09.281411 | 9915b929-0896-42fc-abab-8bb3a217eddb ==============================
[0m14:12:09.281411 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:12:09.282155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:09.398037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9915b929-0896-42fc-abab-8bb3a217eddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fa5222a0>]}
[0m14:12:09.416369 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19143593, "process_user_time": 1.381413, "process_kernel_time": 0.112952, "process_mem_max_rss": "100228", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:09.416918 [debug] [MainThread]: Command `dbt clean` succeeded at 14:12:09.416814 after 0.19 seconds
[0m14:12:09.417389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fc7b0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fa5727b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fdb1b5f0>]}
[0m14:12:09.417807 [debug] [MainThread]: Flushing usage events
[0m22:07:00.671469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655af074d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655c705e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a65e120>]}


============================== 22:07:00.688568 | fb5ec63e-7180-4b5c-8616-381f1795f949 ==============================
[0m22:07:00.688568 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:00.689298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:00.848529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb5ec63e-7180-4b5c-8616-381f1795f949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a4db6b0>]}
[0m22:07:00.863694 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_72fk9gy'
[0m22:07:00.864184 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:07:00.977278 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:07:00.978994 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:07:01.024809 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:07:01.030271 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:07:01.122520 [info ] [MainThread]: Installed from version 1.2.0
[0m22:07:01.123110 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:07:01.123713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fb5ec63e-7180-4b5c-8616-381f1795f949', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a390950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a391a90>]}
[0m22:07:01.124201 [info ] [MainThread]: 
[0m22:07:01.124710 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:07:01.135181 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.51495135, "process_user_time": 1.63898, "process_kernel_time": 0.147538, "process_mem_max_rss": "101404", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m22:07:01.135787 [debug] [MainThread]: Command `dbt deps` succeeded at 22:07:01.135683 after 0.52 seconds
[0m22:07:01.136302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655dc172f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a4a7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f655a4a7d40>]}
[0m22:07:01.136785 [debug] [MainThread]: Flushing usage events
[0m22:07:02.750465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe048a43320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe045856060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0476f60f0>]}


============================== 22:07:02.753847 | 97eeec6f-1c91-4ef8-9b81-3b41dca1ed78 ==============================
[0m22:07:02.753847 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:02.754567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:02.992921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe048a43320>]}
[0m22:07:03.057205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0469d9e20>]}
[0m22:07:03.059100 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:07:03.077069 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:07:03.077794 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:07:03.078331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe04560f3e0>]}
[0m22:07:04.501358 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:07:04.502028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03d546750>]}
[0m22:07:04.741868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:07:04.747281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03d5104a0>]}
[0m22:07:04.834811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03d750590>]}
[0m22:07:04.835398 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:07:04.835940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03de60080>]}
[0m22:07:04.837972 [info ] [MainThread]: 
[0m22:07:04.838702 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:07:04.843507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:07:04.881606 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:07:04.882069 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:07:04.882512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:05.618837 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:07:05.620594 [debug] [ThreadPool]: On list_petro: Close
[0m22:07:05.621821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:07:05.623208 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:07:05.634324 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:05.634761 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:07:05.635166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:05.636169 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.637513 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:05.637904 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:07:05.638536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.638919 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:05.639312 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:07:05.639950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.640890 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:05.641305 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:07:05.641664 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:07:05.642263 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.642658 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:07:05.643990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:07:05.650139 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:05.650546 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:07:05.650907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:05.651622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.652012 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:07:05.652421 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:07:05.663579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:07:05.664933 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:07:05.666183 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:07:05.666588 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:07:05.667658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03d7529f0>]}
[0m22:07:05.668202 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.668594 [debug] [MainThread]: On master: BEGIN
[0m22:07:05.668959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:05.669641 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.670038 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.670446 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:05.670809 [debug] [MainThread]: On master: COMMIT
[0m22:07:05.671415 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:05.671806 [debug] [MainThread]: On master: Close
[0m22:07:05.672331 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:07:05.672791 [info ] [MainThread]: 
[0m22:07:05.683347 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:07:05.683965 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:07:05.684583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:07:05.685034 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:07:05.712261 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:07:05.713003 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:07:05.748862 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:07:05.749613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:14.677739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.678332 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:07:14.679054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.679518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.679934 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:14.680921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.682279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.682717 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:07:14.683963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.692138 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.692597 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:07:14.693434 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.696450 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.696891 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:07:14.697611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.714298 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:14.714766 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.715201 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:07:14.717397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.723393 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:07:14.723854 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:07:14.725302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.727994 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:07:14.730920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe04732b860>]}
[0m22:07:14.732345 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.04s]
[0m22:07:14.733632 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:07:14.735725 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:07:14.736737 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:07:14.737376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:07:14.737810 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:07:14.743608 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:07:14.744329 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:07:14.788462 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.789385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260201220714777639"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:07:14.790028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:14.801582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.810814 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.811331 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:07:14.812144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.812598 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.813025 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260201220714777639'
      
      
      order by ordinal_position

  
[0m22:07:14.815740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.821544 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.822006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:14.824601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.832821 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.833309 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:07:14.835800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.837522 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.837964 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:07:14.838695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.858316 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:07:14.859141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.859597 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260201220714777639"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260201220714777639"
    )
  
[0m22:07:14.869126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.871104 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:14.871578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:07:14.871988 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:07:14.879171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:07:14.880180 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:07:14.880932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97eeec6f-1c91-4ef8-9b81-3b41dca1ed78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff9975760>]}
[0m22:07:14.881735 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.14s]
[0m22:07:14.882603 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:07:14.884596 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:14.885022 [debug] [MainThread]: On master: BEGIN
[0m22:07:14.885452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:07:14.886228 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:14.886637 [debug] [MainThread]: On master: COMMIT
[0m22:07:14.887014 [debug] [MainThread]: Using duckdb connection "master"
[0m22:07:14.887423 [debug] [MainThread]: On master: COMMIT
[0m22:07:14.887990 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:07:14.888449 [debug] [MainThread]: On master: Close
[0m22:07:14.888952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:14.889356 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:07:14.889777 [info ] [MainThread]: 
[0m22:07:14.890296 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.05 seconds (10.05s).
[0m22:07:14.891298 [debug] [MainThread]: Command end result
[0m22:07:14.919750 [info ] [MainThread]: 
[0m22:07:14.920375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:14.920838 [info ] [MainThread]: 
[0m22:07:14.921337 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:14.922465 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.225846, "process_user_time": 6.167887, "process_kernel_time": 0.315015, "process_mem_max_rss": "317664", "process_in_blocks": "1200", "process_out_blocks": "107448"}
[0m22:07:14.923033 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:14.922925 after 12.23 seconds
[0m22:07:14.923517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0455258e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0459dbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff99ae3c0>]}
[0m22:07:14.923961 [debug] [MainThread]: Flushing usage events
[0m22:07:16.987815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728b0be450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a83b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a30da30>]}


============================== 22:07:16.991255 | f20827fd-0cf6-42e8-957a-65c5fcb15ee5 ==============================
[0m22:07:16.991255 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:07:16.991973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:07:17.110729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f20827fd-0cf6-42e8-957a-65c5fcb15ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a83b350>]}
[0m22:07:17.134529 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20171516, "process_user_time": 1.403956, "process_kernel_time": 0.115831, "process_mem_max_rss": "99780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:07:17.135172 [debug] [MainThread]: Command `dbt clean` succeeded at 22:07:17.135040 after 0.20 seconds
[0m22:07:17.135645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7289ef2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f728a2526c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7289cdf7a0>]}
[0m22:07:17.136122 [debug] [MainThread]: Flushing usage events
[0m06:29:29.200885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78f6f6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ee032f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78f073a40>]}


============================== 06:29:29.220289 | 54df96c2-86e1-436f-b93f-fe85321bc14a ==============================
[0m06:29:29.220289 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:29.220973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:29:29.448248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54df96c2-86e1-436f-b93f-fe85321bc14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea4f560>]}
[0m06:29:29.463250 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y0t6bwin'
[0m06:29:29.463692 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:29:29.631742 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:29:29.632998 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:29:29.676295 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:29:29.681366 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:29:29.769874 [info ] [MainThread]: Installed from version 1.2.0
[0m06:29:29.770435 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:29:29.771004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54df96c2-86e1-436f-b93f-fe85321bc14a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea0c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea0c260>]}
[0m06:29:29.771457 [info ] [MainThread]: 
[0m06:29:29.771970 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:29:29.785034 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6350876, "process_user_time": 1.616727, "process_kernel_time": 0.14333, "process_mem_max_rss": "101248", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m06:29:29.785581 [debug] [MainThread]: Command `dbt deps` succeeded at 06:29:29.785478 after 0.64 seconds
[0m06:29:29.786012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ee032f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea4fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa78ea4f560>]}
[0m06:29:29.786431 [debug] [MainThread]: Flushing usage events
[0m06:29:31.382544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc57fe840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc5696300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc8c870e0>]}


============================== 06:29:31.385471 | 53403505-d2cb-4152-b263-90ba883e3a87 ==============================
[0m06:29:31.385471 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:31.386132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:29:31.615318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbe1d4650>]}
[0m06:29:31.676578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc641e420>]}
[0m06:29:31.678211 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:29:31.708388 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:29:31.709114 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:29:31.709633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc55918b0>]}
[0m06:29:33.102410 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:29:33.103073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbd90b2f0>]}
[0m06:29:33.334897 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:29:33.340162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbd70f320>]}
[0m06:29:33.436249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbd98bcb0>]}
[0m06:29:33.436738 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:29:33.437298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbe102cc0>]}
[0m06:29:33.439235 [info ] [MainThread]: 
[0m06:29:33.439929 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:29:33.444699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:29:33.480587 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:29:33.481068 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:29:33.481492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:33.895256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.897391 [debug] [ThreadPool]: On list_petro: Close
[0m06:29:33.898518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:29:33.899308 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:29:33.907190 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:33.907617 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:29:33.908015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:33.909393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.910740 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:33.911183 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:29:33.911771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.912176 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:33.912545 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:29:33.913173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.914092 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:33.914483 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:29:33.914848 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:29:33.915438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.915830 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:29:33.917063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:29:33.923004 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:33.923409 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:29:33.923768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:33.924428 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.924812 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:29:33.925240 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:29:33.935550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:29:33.936882 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:29:33.938087 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:29:33.938486 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:29:33.939604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc75c6660>]}
[0m06:29:33.940224 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:33.940607 [debug] [MainThread]: On master: BEGIN
[0m06:29:33.940993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:33.941660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:33.942087 [debug] [MainThread]: On master: COMMIT
[0m06:29:33.942459 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:33.942828 [debug] [MainThread]: On master: COMMIT
[0m06:29:33.943443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:33.943837 [debug] [MainThread]: On master: Close
[0m06:29:33.944345 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:29:33.944823 [info ] [MainThread]: 
[0m06:29:33.967193 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:29:33.967756 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:29:33.968411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:29:33.968838 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:29:33.995624 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:29:33.996350 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:29:34.031481 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:29:34.032207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:43.898873 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.899445 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:29:43.900172 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.900620 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.901077 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:43.902023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.903372 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.903821 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:29:43.905076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.912917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.913408 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:29:43.914250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.917283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.917732 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:29:43.918540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.935298 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:43.935764 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.936210 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:29:43.937457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.943220 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:29:43.943682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:29:43.944846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:43.947303 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:29:43.948824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafbd70e7b0>]}
[0m06:29:43.949529 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.98s]
[0m06:29:43.950310 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:29:43.951126 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:29:43.951870 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:29:43.952552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:29:43.953037 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:29:43.957982 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:29:43.958643 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:29:43.994786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:43.995290 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260202062943988635"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:29:43.995732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:29:44.002407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.009777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.010251 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:29:44.010916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.011377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.011808 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260202062943988635'
      
      
      order by ordinal_position

  
[0m06:29:44.014141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.019277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.019739 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:44.022088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.029780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.030262 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:29:44.032529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.034221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.034669 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:29:44.035403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.053797 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:29:44.054493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.054944 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260202062943988635"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260202062943988635"
    )
  
[0m06:29:44.062297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.064054 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:29:44.064493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:29:44.064896 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:29:44.070916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:29:44.071789 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:29:44.072451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53403505-d2cb-4152-b263-90ba883e3a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf79fff410>]}
[0m06:29:44.073117 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:29:44.073912 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:29:44.075543 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:44.075990 [debug] [MainThread]: On master: BEGIN
[0m06:29:44.076383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:44.077077 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:44.077484 [debug] [MainThread]: On master: COMMIT
[0m06:29:44.077860 [debug] [MainThread]: Using duckdb connection "master"
[0m06:29:44.078275 [debug] [MainThread]: On master: COMMIT
[0m06:29:44.078874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:29:44.079319 [debug] [MainThread]: On master: Close
[0m06:29:44.079784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:44.080206 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:29:44.080625 [info ] [MainThread]: 
[0m06:29:44.081133 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.64 seconds (10.64s).
[0m06:29:44.082069 [debug] [MainThread]: Command end result
[0m06:29:44.107816 [info ] [MainThread]: 
[0m06:29:44.108395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:44.108860 [info ] [MainThread]: 
[0m06:29:44.109357 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:29:44.110285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.78006, "process_user_time": 5.282296, "process_kernel_time": 0.306901, "process_mem_max_rss": "278488", "process_in_blocks": "1200", "process_out_blocks": "107408"}
[0m06:29:44.110826 [debug] [MainThread]: Command `dbt run` succeeded at 06:29:44.110724 after 12.78 seconds
[0m06:29:44.111285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafc5696300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf79fe5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf79f86120>]}
[0m06:29:44.111710 [debug] [MainThread]: Flushing usage events
[0m06:29:45.757702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42b2af080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42ad40a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42bf11940>]}


============================== 06:29:45.760701 | d4d4e4a7-114d-4bbd-beb4-db96978176f7 ==============================
[0m06:29:45.760701 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:29:45.761412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:45.876627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4d4e4a7-114d-4bbd-beb4-db96978176f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42ac06f90>]}
[0m06:29:45.894504 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18864508, "process_user_time": 1.326008, "process_kernel_time": 0.107919, "process_mem_max_rss": "99828", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:29:45.895057 [debug] [MainThread]: Command `dbt clean` succeeded at 06:29:45.894928 after 0.19 seconds
[0m06:29:45.895471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42ac64ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42ab256d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc42aa2f440>]}
[0m06:29:45.895878 [debug] [MainThread]: Flushing usage events
[0m14:21:50.485683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fe05b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fdd181d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fe242330>]}


============================== 14:21:50.504105 | 6b0fff8c-732c-41fd-91aa-1d36e2f2cc34 ==============================
[0m14:21:50.504105 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:21:50.504803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:50.677918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b0fff8c-732c-41fd-91aa-1d36e2f2cc34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fdb9ee40>]}
[0m14:21:50.694185 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-npgqq0xy'
[0m14:21:50.694751 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:21:50.892537 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:21:50.894621 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:21:50.950370 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:21:50.956420 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:21:51.158465 [info ] [MainThread]: Installed from version 1.2.0
[0m14:21:51.159131 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:21:51.159714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b0fff8c-732c-41fd-91aa-1d36e2f2cc34', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fdb9f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fdb9eb70>]}
[0m14:21:51.160189 [info ] [MainThread]: 
[0m14:21:51.160712 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:21:51.173451 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7396881, "process_user_time": 1.725126, "process_kernel_time": 0.152745, "process_mem_max_rss": "101404", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m14:21:51.174132 [debug] [MainThread]: Command `dbt deps` succeeded at 14:21:51.174023 after 0.74 seconds
[0m14:21:51.174616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fe5537a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76010e3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75fec250a0>]}
[0m14:21:51.175083 [debug] [MainThread]: Flushing usage events
[0m14:21:53.060319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5d0ef500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5d473650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5d0ed550>]}


============================== 14:21:53.063672 | f66f3295-49f4-4b2c-b9b8-d407afa0e2d2 ==============================
[0m14:21:53.063672 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:21:53.064424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:21:53.301449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c5de060>]}
[0m14:21:53.364381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c3471a0>]}
[0m14:21:53.366394 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:21:53.393980 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:21:53.394852 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:21:53.395450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5cac9cd0>]}
[0m14:21:54.798548 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:21:54.799269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa54e4e930>]}
[0m14:21:55.070870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:21:55.076800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa547fcf20>]}
[0m14:21:55.175549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa54e9aa50>]}
[0m14:21:55.176177 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:21:55.176700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5501a960>]}
[0m14:21:55.178827 [info ] [MainThread]: 
[0m14:21:55.179576 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:21:55.184699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:21:55.223436 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:21:55.223997 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:21:55.224380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:55.915396 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:21:55.917489 [debug] [ThreadPool]: On list_petro: Close
[0m14:21:55.918650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:21:55.919406 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:21:55.927208 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:21:55.927670 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:21:55.928055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:55.929233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.930638 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:21:55.931050 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:21:55.931671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.932056 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:21:55.932420 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:21:55.933059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.933988 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:21:55.934373 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:21:55.934760 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:21:55.935326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.935751 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:21:55.937157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:21:55.943613 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:21:55.944043 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:21:55.944408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:55.945247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.945680 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:21:55.946087 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:21:55.957026 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:21:55.958796 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:21:55.960163 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:21:55.960579 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:21:55.961872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5e3ce7e0>]}
[0m14:21:55.962403 [debug] [MainThread]: Using duckdb connection "master"
[0m14:21:55.962840 [debug] [MainThread]: On master: BEGIN
[0m14:21:55.963216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:55.964049 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:21:55.964449 [debug] [MainThread]: On master: COMMIT
[0m14:21:55.964855 [debug] [MainThread]: Using duckdb connection "master"
[0m14:21:55.965218 [debug] [MainThread]: On master: COMMIT
[0m14:21:55.965831 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:21:55.966232 [debug] [MainThread]: On master: Close
[0m14:21:55.966800 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:21:55.967280 [info ] [MainThread]: 
[0m14:21:55.977765 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:21:55.978458 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:21:55.979191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:21:55.979816 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:21:56.007818 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:21:56.008754 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:21:56.044948 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:21:56.045892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.759357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.760001 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:22:05.760876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.761329 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.761799 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:05.762892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.764396 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.764880 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:22:05.766240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.774756 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.775266 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:22:05.776219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.779563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.780055 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:22:05.780985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.798451 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:05.799070 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.799501 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:22:05.801912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.808499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:22:05.809046 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:22:05.810628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.813261 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:22:05.814865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa544b9f10>]}
[0m14:22:05.815588 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.83s]
[0m14:22:05.816436 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:22:05.817299 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:22:05.817914 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:22:05.818573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:22:05.819074 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:22:05.824939 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:22:05.825726 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:22:05.863747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.864371 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260202142205857287"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:22:05.864861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.872892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.881659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.882222 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:22:05.883074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.883512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.883965 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260202142205857287'
      
      
      order by ordinal_position

  
[0m14:22:05.886814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.892962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.893490 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:05.896403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.905104 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.905669 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:22:05.909052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.910965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.911429 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:22:05.912282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.932205 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:22:05.933087 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.933554 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260202142205857287"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260202142205857287"
    )
  
[0m14:22:05.942353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.944413 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:05.944903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:22:05.945318 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:22:05.952571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:22:05.953711 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:22:05.954458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66f3295-49f4-4b2c-b9b8-d407afa0e2d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa11227710>]}
[0m14:22:05.955170 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.14s]
[0m14:22:05.955971 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:22:05.957393 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:05.957856 [debug] [MainThread]: On master: BEGIN
[0m14:22:05.958236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:05.959120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:05.959531 [debug] [MainThread]: On master: COMMIT
[0m14:22:05.959953 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:05.960318 [debug] [MainThread]: On master: COMMIT
[0m14:22:05.960955 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:22:05.961355 [debug] [MainThread]: On master: Close
[0m14:22:05.961907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:05.962273 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:22:05.962707 [info ] [MainThread]: 
[0m14:22:05.963236 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.78 seconds (10.78s).
[0m14:22:05.964268 [debug] [MainThread]: Command end result
[0m14:22:05.991390 [info ] [MainThread]: 
[0m14:22:05.992151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:05.992709 [info ] [MainThread]: 
[0m14:22:05.993242 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:22:05.994342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.988032, "process_user_time": 5.537238, "process_kernel_time": 0.30061, "process_mem_max_rss": "297532", "process_in_blocks": "1200", "process_out_blocks": "107392"}
[0m14:22:05.994934 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:05.994826 after 12.99 seconds
[0m14:22:05.995383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5c5dd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa609bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa54605c10>]}
[0m14:22:05.995850 [debug] [MainThread]: Flushing usage events
[0m14:22:08.094102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc8aeaea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bca92eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcacf6000>]}


============================== 14:22:08.097702 | 7b237a13-2bd7-4461-b532-414e0598f457 ==============================
[0m14:22:08.097702 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:22:08.098368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:22:08.217820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b237a13-2bd7-4461-b532-414e0598f457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bca950470>]}
[0m14:22:08.237619 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1982405, "process_user_time": 1.436372, "process_kernel_time": 0.11703, "process_mem_max_rss": "99640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:22:08.238215 [debug] [MainThread]: Command `dbt clean` succeeded at 14:22:08.238111 after 0.20 seconds
[0m14:22:08.238914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc8b95820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc8a6ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc8a6e5d0>]}
[0m14:22:08.239360 [debug] [MainThread]: Flushing usage events
[0m06:21:57.308166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b008ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168f20b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168f22db0>]}


============================== 06:21:57.325484 | 85a637e2-ae4f-43e5-bf4e-f34f0df7e73d ==============================
[0m06:21:57.325484 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:57.326156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:21:57.499350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85a637e2-ae4f-43e5-bf4e-f34f0df7e73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1169d90e90>]}
[0m06:21:57.513914 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mpmdf8jl'
[0m06:21:57.514389 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:21:57.598471 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:21:57.599646 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:21:57.651457 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:21:57.656468 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:21:57.730215 [info ] [MainThread]: Installed from version 1.2.0
[0m06:21:57.730706 [info ] [MainThread]: Updated version available: 1.3.3
[0m06:21:57.731256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '85a637e2-ae4f-43e5-bf4e-f34f0df7e73d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168f66d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168c5bb90>]}
[0m06:21:57.731695 [info ] [MainThread]: 
[0m06:21:57.732179 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:21:57.743548 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4865415, "process_user_time": 1.612919, "process_kernel_time": 0.14672, "process_mem_max_rss": "101112", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m06:21:57.744099 [debug] [MainThread]: Command `dbt deps` succeeded at 06:21:57.743994 after 0.49 seconds
[0m06:21:57.744519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1169a0d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116908a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1168f670b0>]}
[0m06:21:57.744922 [debug] [MainThread]: Flushing usage events
[0m06:21:59.305233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763a6b9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7639eb2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7639bbb770>]}


============================== 06:21:59.308259 | c984a017-f346-483d-abcc-6160a67a6bde ==============================
[0m06:21:59.308259 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:21:59.308925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:21:59.538102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763b29c590>]}
[0m06:21:59.599315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7639977770>]}
[0m06:21:59.600989 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m06:21:59.626466 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:21:59.627186 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:21:59.627706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7631e2b9e0>]}
[0m06:22:01.012066 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:22:01.012738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76393c7fb0>]}
[0m06:22:01.247468 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:22:01.252890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76316bec90>]}
[0m06:22:01.347673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763177f230>]}
[0m06:22:01.348219 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m06:22:01.348689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7631ee4290>]}
[0m06:22:01.350679 [info ] [MainThread]: 
[0m06:22:01.351391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:22:01.356132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:22:01.392056 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:22:01.392494 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:22:01.392884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:01.800673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.802576 [debug] [ThreadPool]: On list_petro: Close
[0m06:22:01.803588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:22:01.804280 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:22:01.812759 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:01.813266 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:22:01.813740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:01.814817 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.816178 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:01.816565 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:22:01.817166 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.817555 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:01.817919 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:22:01.818540 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.819465 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:22:01.819853 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:22:01.820238 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:22:01.820854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.821297 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:22:01.822545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:22:01.828294 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:22:01.828694 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:22:01.829075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:01.829744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.830170 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:22:01.830546 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:22:01.841384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:22:01.842715 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:22:01.843915 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:22:01.844354 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:22:01.845369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763b2d6450>]}
[0m06:22:01.845881 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:01.846315 [debug] [MainThread]: On master: BEGIN
[0m06:22:01.846672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:01.847376 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:01.847769 [debug] [MainThread]: On master: COMMIT
[0m06:22:01.848187 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:01.848550 [debug] [MainThread]: On master: COMMIT
[0m06:22:01.849134 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:01.849530 [debug] [MainThread]: On master: Close
[0m06:22:01.850042 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:22:01.850536 [info ] [MainThread]: 
[0m06:22:01.870836 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:22:01.871429 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:22:01.872075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:22:01.872515 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:22:01.899482 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:22:01.900236 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:22:01.935392 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:22:01.936156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:09.538738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.539321 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:22:09.540024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.540474 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.540897 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:09.541845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.543228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.543670 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m06:22:09.544694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.552543 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.553026 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:22:09.553847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.556806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.557279 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:22:09.558307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.575069 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:09.575539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.575976 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:22:09.578024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.583715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:22:09.584200 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m06:22:09.585553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.587992 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:22:09.589547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee362570>]}
[0m06:22:09.590264 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.72s]
[0m06:22:09.591049 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:22:09.591941 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:22:09.592651 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:22:09.593286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:22:09.593719 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:22:09.598688 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:22:09.599403 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:22:09.635599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.636114 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260203062209629588"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:22:09.636569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:09.643375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.650756 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.651226 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:22:09.651896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.652365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.652787 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260203062209629588'
      
      
      order by ordinal_position

  
[0m06:22:09.655164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.660322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.660784 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:09.663147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.670819 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.671302 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:22:09.673624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.675303 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.675748 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m06:22:09.676464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.694811 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:22:09.695530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.696004 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260203062209629588"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260203062209629588"
    )
  
[0m06:22:09.703533 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.705309 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:09.705746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:22:09.706176 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:22:09.711840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:22:09.712715 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:22:09.713409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c984a017-f346-483d-abcc-6160a67a6bde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee342270>]}
[0m06:22:09.714080 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m06:22:09.714806 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:22:09.716595 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:09.717034 [debug] [MainThread]: On master: BEGIN
[0m06:22:09.717419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:09.718107 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:09.718504 [debug] [MainThread]: On master: COMMIT
[0m06:22:09.718877 [debug] [MainThread]: Using duckdb connection "master"
[0m06:22:09.719274 [debug] [MainThread]: On master: COMMIT
[0m06:22:09.719834 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:22:09.720281 [debug] [MainThread]: On master: Close
[0m06:22:09.720745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:09.721152 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:22:09.721552 [info ] [MainThread]: 
[0m06:22:09.722058 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.37 seconds (8.37s).
[0m06:22:09.722977 [debug] [MainThread]: Command end result
[0m06:22:09.748582 [info ] [MainThread]: 
[0m06:22:09.749178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:09.749661 [info ] [MainThread]: 
[0m06:22:09.750176 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:22:09.751193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.497821, "process_user_time": 5.289479, "process_kernel_time": 0.281131, "process_mem_max_rss": "273568", "process_in_blocks": "1200", "process_out_blocks": "107400"}
[0m06:22:09.751738 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:09.751634 after 10.50 seconds
[0m06:22:09.752213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763a6b9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763999f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee324e30>]}
[0m06:22:09.752645 [debug] [MainThread]: Flushing usage events
[0m06:22:11.452191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481bfac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481f74a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481e94470>]}


============================== 06:22:11.455256 | 627d1cc8-7366-41a3-b9d8-37dff9994fc8 ==============================
[0m06:22:11.455256 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:22:11.455883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:22:11.571188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '627d1cc8-7366-41a3-b9d8-37dff9994fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481b6a420>]}
[0m06:22:11.589270 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18879193, "process_user_time": 1.306997, "process_kernel_time": 0.127901, "process_mem_max_rss": "99868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:22:11.589811 [debug] [MainThread]: Command `dbt clean` succeeded at 06:22:11.589708 after 0.19 seconds
[0m06:22:11.590258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24861bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2481ff2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24818c3680>]}
[0m06:22:11.590671 [debug] [MainThread]: Flushing usage events
[0m14:23:42.204163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5962d93110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5963203dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5962ada150>]}


============================== 14:23:42.212645 | fda5a1d4-2454-4ee3-97b3-d1dd71d924e1 ==============================
[0m14:23:42.212645 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:23:42.213351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:42.381228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fda5a1d4-2454-4ee3-97b3-d1dd71d924e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596379dfd0>]}
[0m14:23:42.396098 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b0oo5j95'
[0m14:23:42.396584 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:23:42.499148 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:23:42.500417 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:23:42.542366 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:23:42.547340 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:23:42.642575 [info ] [MainThread]: Installed from version 1.2.0
[0m14:23:42.643065 [info ] [MainThread]: Updated version available: 1.3.3
[0m14:23:42.643598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fda5a1d4-2454-4ee3-97b3-d1dd71d924e1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596296e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59627e8e90>]}
[0m14:23:42.644026 [info ] [MainThread]: 
[0m14:23:42.644524 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:23:42.646191 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49570405, "process_user_time": 1.656251, "process_kernel_time": 0.126171, "process_mem_max_rss": "100936", "process_in_blocks": "8512", "process_out_blocks": "5176"}
[0m14:23:42.646736 [debug] [MainThread]: Command `dbt deps` succeeded at 14:23:42.646635 after 0.50 seconds
[0m14:23:42.647149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5962d901a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59626a2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5962d51d30>]}
[0m14:23:42.647586 [debug] [MainThread]: Flushing usage events
[0m14:23:44.226781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21187a54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2118a94fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21191f8500>]}


============================== 14:23:44.229727 | 37f0d644-bb9f-4cbf-9632-4cc90a2fea34 ==============================
[0m14:23:44.229727 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:23:44.230382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:44.466649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21185ca000>]}
[0m14:23:44.529950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21187a6ab0>]}
[0m14:23:44.531569 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:23:44.556389 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:23:44.557100 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:23:44.557655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f211104bce0>]}
[0m14:23:45.968968 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:23:45.969622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21108d6c00>]}
[0m14:23:46.211262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:23:46.216764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f211a3df6b0>]}
[0m14:23:46.312743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21109938c0>]}
[0m14:23:46.313242 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m14:23:46.313765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21111009e0>]}
[0m14:23:46.315734 [info ] [MainThread]: 
[0m14:23:46.316424 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:23:46.321307 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:23:46.357611 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:23:46.358049 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:23:46.358467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:46.961059 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:23:46.963098 [debug] [ThreadPool]: On list_petro: Close
[0m14:23:46.964169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:23:46.965018 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:23:46.973098 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:46.973546 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:23:46.973934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:46.975112 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.976431 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:46.976823 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:23:46.977433 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.977818 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:46.978186 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:23:46.978841 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.979769 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:23:46.980161 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:23:46.980555 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:23:46.981114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.981543 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:23:46.982716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:23:46.988639 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:23:46.989053 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:23:46.989451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:46.990108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:46.990527 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:23:46.990911 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:23:47.001515 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:23:47.002843 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:23:47.004031 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:23:47.004452 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:23:47.005460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21108c2300>]}
[0m14:23:47.005968 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:47.006379 [debug] [MainThread]: On master: BEGIN
[0m14:23:47.006739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:47.007388 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:23:47.007785 [debug] [MainThread]: On master: COMMIT
[0m14:23:47.008153 [debug] [MainThread]: Using duckdb connection "master"
[0m14:23:47.008540 [debug] [MainThread]: On master: COMMIT
[0m14:23:47.009122 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:23:47.009542 [debug] [MainThread]: On master: Close
[0m14:23:47.010021 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:23:47.010506 [info ] [MainThread]: 
[0m14:23:47.029589 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:23:47.030160 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:23:47.030815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:23:47.031275 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:23:47.057965 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:23:47.058716 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:23:47.093734 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:23:47.094461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:09.732965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.733510 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:26:09.734191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.734652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.735065 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:26:09.736028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.737382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.737823 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m14:26:09.738809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.746424 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.746881 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:26:09.747658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.750579 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.751022 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:26:09.751755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.768119 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:26:09.768596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.769012 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:26:09.770205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.775747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:26:09.776205 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m14:26:09.777399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.779759 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:26:09.781316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f211075e7e0>]}
[0m14:26:09.782008 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 142.75s]
[0m14:26:09.782791 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:26:09.783584 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:26:09.784152 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:26:09.784787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:26:09.785281 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:26:09.790327 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:26:09.791045 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:26:09.826328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.826815 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260203142609820436"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:26:09.827282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:09.834102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.841319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.841775 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:26:09.842421 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.842856 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.843300 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260203142609820436'
      
      
      order by ordinal_position

  
[0m14:26:09.845849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.850889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.851372 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:26:09.853727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.861322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.861778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:26:09.864480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.866136 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.866623 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m14:26:09.867356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.885241 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:26:09.885901 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.886371 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260203142609820436"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260203142609820436"
    )
  
[0m14:26:09.894316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.895958 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:26:09.896407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:26:09.896805 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:26:09.903382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:26:09.904195 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:26:09.904844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f0d644-bb9f-4cbf-9632-4cc90a2fea34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20d53c6f60>]}
[0m14:26:09.905489 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m14:26:09.906306 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:26:09.907853 [debug] [MainThread]: Using duckdb connection "master"
[0m14:26:09.908275 [debug] [MainThread]: On master: BEGIN
[0m14:26:09.908641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:26:09.909289 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:26:09.909678 [debug] [MainThread]: On master: COMMIT
[0m14:26:09.910042 [debug] [MainThread]: Using duckdb connection "master"
[0m14:26:09.910448 [debug] [MainThread]: On master: COMMIT
[0m14:26:09.911013 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:26:09.911432 [debug] [MainThread]: On master: Close
[0m14:26:09.911878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:09.912249 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:26:09.912640 [info ] [MainThread]: 
[0m14:26:09.913136 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 2 minutes and 23.60 seconds (143.60s).
[0m14:26:09.914130 [debug] [MainThread]: Command end result
[0m14:26:09.938729 [info ] [MainThread]: 
[0m14:26:09.939334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:09.939847 [info ] [MainThread]: 
[0m14:26:09.940384 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:26:09.941360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 145.7681, "process_user_time": 5.862326, "process_kernel_time": 0.277062, "process_mem_max_rss": "289424", "process_in_blocks": "1200", "process_out_blocks": "107312"}
[0m14:26:09.941884 [debug] [MainThread]: Command `dbt run` succeeded at 14:26:09.941786 after 145.77 seconds
[0m14:26:09.942322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21107572f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2118aeade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2118b9fb60>]}
[0m14:26:09.942740 [debug] [MainThread]: Flushing usage events
[0m14:26:11.623831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2789526180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27874b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27877cbda0>]}


============================== 14:26:11.626925 | aed653b7-5d4c-4db9-9823-99a36106e82b ==============================
[0m14:26:11.626925 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:26:11.627591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:26:11.747093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed653b7-5d4c-4db9-9823-99a36106e82b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27885689b0>]}
[0m14:26:11.766596 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19673762, "process_user_time": 1.35561, "process_kernel_time": 0.112884, "process_mem_max_rss": "99848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:26:11.767119 [debug] [MainThread]: Command `dbt clean` succeeded at 14:26:11.767015 after 0.20 seconds
[0m14:26:11.767597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2787721040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27874b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278825ba10>]}
[0m14:26:11.768024 [debug] [MainThread]: Flushing usage events
[0m22:10:54.736919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a02b58e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a00b73770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a013425d0>]}


============================== 22:10:54.754595 | d648643a-c3d5-4f8e-b17a-7bf3f3e79d0a ==============================
[0m22:10:54.754595 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:54.755337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:10:54.918164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd648643a-c3d5-4f8e-b17a-7bf3f3e79d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a0090a000>]}
[0m22:10:54.936816 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8pu132bo'
[0m22:10:54.937317 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:10:55.030670 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:10:55.032197 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:10:55.077360 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:10:55.082559 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:10:55.174725 [info ] [MainThread]: Installed from version 1.2.0
[0m22:10:55.175311 [info ] [MainThread]: Updated version available: 1.3.3
[0m22:10:55.175798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd648643a-c3d5-4f8e-b17a-7bf3f3e79d0a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a00d0c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a007cfb00>]}
[0m22:10:55.176250 [info ] [MainThread]: 
[0m22:10:55.176698 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:10:55.250889 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5636699, "process_user_time": 1.6216, "process_kernel_time": 0.16226, "process_mem_max_rss": "101384", "process_in_blocks": "8504", "process_out_blocks": "5176"}
[0m22:10:55.251620 [debug] [MainThread]: Command `dbt deps` succeeded at 22:10:55.251511 after 0.56 seconds
[0m22:10:55.252042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a02b58e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a00edac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a0084ffe0>]}
[0m22:10:55.252473 [debug] [MainThread]: Flushing usage events
[0m22:10:56.904442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85985220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a85987590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84f75c10>]}


============================== 22:10:56.907855 | 4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27 ==============================
[0m22:10:56.907855 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:56.908562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:10:57.154615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84da3bc0>]}
[0m22:10:57.214653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84da2e70>]}
[0m22:10:57.216682 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m22:10:57.242886 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:10:57.243622 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:10:57.244105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d98d850>]}
[0m22:10:58.481583 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:10:58.482279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d0ce570>]}
[0m22:10:58.722209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:10:58.727634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d0d92e0>]}
[0m22:10:58.821207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d184140>]}
[0m22:10:58.821826 [info ] [MainThread]: Found 2 models, 1 test, 539 macros
[0m22:10:58.822347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7cf47fb0>]}
[0m22:10:58.824388 [info ] [MainThread]: 
[0m22:10:58.825107 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:10:58.829818 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:10:58.866337 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:10:58.866804 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:10:58.867156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:59.340726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.342460 [debug] [ThreadPool]: On list_petro: Close
[0m22:10:59.343410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:10:59.344235 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:10:59.351930 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:59.352380 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:10:59.352725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:59.353966 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.355279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:59.355652 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:10:59.356249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.356612 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:59.356927 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:10:59.357512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.358426 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:10:59.358779 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:10:59.359100 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:10:59.359667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.360042 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:10:59.361316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:10:59.367184 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:10:59.367591 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:10:59.367926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:59.368603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.368972 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:10:59.369331 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:10:59.379285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:10:59.380705 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:10:59.381892 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:10:59.382290 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:10:59.383325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d1755b0>]}
[0m22:10:59.383822 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:59.384176 [debug] [MainThread]: On master: BEGIN
[0m22:10:59.384557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:59.385193 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:59.385586 [debug] [MainThread]: On master: COMMIT
[0m22:10:59.385908 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:59.386214 [debug] [MainThread]: On master: COMMIT
[0m22:10:59.386875 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:59.387284 [debug] [MainThread]: On master: Close
[0m22:10:59.387755 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:10:59.388201 [info ] [MainThread]: 
[0m22:10:59.406881 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:10:59.407522 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:10:59.408152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:10:59.408583 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:10:59.434594 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:10:59.435424 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:10:59.469941 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:10:59.470760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:08.802842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.803394 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:11:08.804040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.804475 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.804844 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:08.805787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.807129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.807556 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_petro'
  
[0m22:11:08.808555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.816602 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.817054 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:11:08.817857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.820938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.821374 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:11:08.822064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.838410 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:08.838873 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.839268 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:08.840507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.846489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:08.846952 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */

      drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
    
[0m22:11:08.848251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.850751 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:11:08.852294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7d191970>]}
[0m22:11:08.852973 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.44s]
[0m22:11:08.853774 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:11:08.854600 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:11:08.855126 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:11:08.855773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:11:08.856182 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:11:08.861558 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:11:08.862280 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:11:08.897357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.897944 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20260203221108891417"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:11:08.898377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:08.906024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.913944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.914425 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:11:08.915112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.915549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.915927 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20260203221108891417'
      
      
      order by ordinal_position

  
[0m22:11:08.918410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.923743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.924202 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:08.926848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.934543 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.934983 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:08.937513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.939238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.939663 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */
SELECT version()
[0m22:11:08.940357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.958409 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:11:08.959154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.959592 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20260203221108891417"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20260203221108891417"
    )
  
[0m22:11:08.969737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.971584 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:08.971990 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:08.972370 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:08.979147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:08.980038 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:11:08.980710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f12acf8-4d6e-4ed2-a3c4-e3f44f4c4f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a39527320>]}
[0m22:11:08.981376 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.12s]
[0m22:11:08.982108 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:11:08.983702 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:08.984091 [debug] [MainThread]: On master: BEGIN
[0m22:11:08.984471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:08.985128 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:08.985538 [debug] [MainThread]: On master: COMMIT
[0m22:11:08.985865 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:08.986175 [debug] [MainThread]: On master: COMMIT
[0m22:11:08.986728 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:08.987086 [debug] [MainThread]: On master: Close
[0m22:11:08.987553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:08.987872 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:11:08.988249 [info ] [MainThread]: 
[0m22:11:08.988724 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m22:11:08.989623 [debug] [MainThread]: Command end result
[0m22:11:09.015167 [info ] [MainThread]: 
[0m22:11:09.015800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:09.016321 [info ] [MainThread]: 
[0m22:11:09.016807 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:11:09.017809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.165953, "process_user_time": 5.597971, "process_kernel_time": 0.365259, "process_mem_max_rss": "314060", "process_in_blocks": "1200", "process_out_blocks": "107432"}
[0m22:11:09.018395 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:09.018268 after 12.17 seconds
[0m22:11:09.018801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84edd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a84e32c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3958f7d0>]}
[0m22:11:09.019184 [debug] [MainThread]: Flushing usage events
[0m22:11:10.755916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47214bec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47203149b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47201caf90>]}


============================== 22:11:10.759117 | 3bb8edc3-01c9-46b7-96e2-ed2b61928198 ==============================
[0m22:11:10.759117 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:10.759802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:10.872950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bb8edc3-01c9-46b7-96e2-ed2b61928198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f472076e270>]}
[0m22:11:10.891607 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18708023, "process_user_time": 1.324773, "process_kernel_time": 0.118889, "process_mem_max_rss": "99604", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:11:10.892167 [debug] [MainThread]: Command `dbt clean` succeeded at 22:11:10.892045 after 0.19 seconds
[0m22:11:10.892621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47237e7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47201cacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f472076e270>]}
[0m22:11:10.893006 [debug] [MainThread]: Flushing usage events
