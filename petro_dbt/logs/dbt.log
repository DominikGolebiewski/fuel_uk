[0m22:06:04.797210 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:04.798255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1697b82270>]}
[0m22:06:04.998859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:05.005577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16939ffe30>]}
[0m22:06:05.169119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1693823200>]}
[0m22:06:05.169758 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:06:05.170273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1693851070>]}
[0m22:06:05.172239 [info ] [MainThread]: 
[0m22:06:05.173046 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:05.178490 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:05.218183 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:05.218788 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:05.219207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:05.688569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.690714 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:05.691916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:05.692536 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:05.700417 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.700964 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:05.701384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:05.702796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.704509 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.704927 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:05.705575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.705977 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.706391 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:05.707030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.708042 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:05.708478 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.708871 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:05.709497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.709933 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:05.711414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:05.717903 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:05.718434 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:05.718819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:05.719701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.720110 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:05.720524 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:05.735024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.736874 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:05.738202 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:05.738653 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:05.741100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16938adf70>]}
[0m22:06:05.741703 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:05.742106 [debug] [MainThread]: On master: BEGIN
[0m22:06:05.742520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:05.743359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:05.743778 [debug] [MainThread]: On master: COMMIT
[0m22:06:05.744166 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:05.744563 [debug] [MainThread]: On master: COMMIT
[0m22:06:05.745203 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:05.745661 [debug] [MainThread]: On master: Close
[0m22:06:05.746283 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:05.746800 [info ] [MainThread]: 
[0m22:06:05.759242 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:05.759971 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:05.760643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:05.761090 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:05.790308 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:05.791328 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:05.831592 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:05.832619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:15.763548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.764156 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:15.765024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.765501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.765932 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:15.766959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.770497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.770962 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:15.771791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.791558 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:15.792207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.792765 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:15.794773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.800805 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:15.801376 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:15.803096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.806024 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:15.807994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168bf458b0>]}
[0m22:06:15.808845 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.05s]
[0m22:06:15.809805 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:15.810971 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:15.811646 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:15.812415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:15.812901 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:15.820131 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:15.820907 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:15.859735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.860410 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250305220615852953"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:15.860943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:15.869983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.878936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.879585 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:15.880492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.880975 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.881452 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250305220615852953'
      
      
      order by ordinal_position

  
[0m22:06:15.886759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.892995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.893563 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:15.896541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.906384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.906983 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:15.910056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.931262 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:15.932186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.932738 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250305220615852953"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250305220615852953"
    )
  
[0m22:06:15.981324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.983413 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:15.983906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:15.984354 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:15.992964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:15.994251 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:15.996129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b990b678-e881-4827-9de1-fe6d6245efaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16683cf9b0>]}
[0m22:06:15.996908 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:06:15.997748 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:15.999248 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:15.999725 [debug] [MainThread]: On master: BEGIN
[0m22:06:16.000118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:16.001012 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.001481 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.001872 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.002254 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.002896 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.003377 [debug] [MainThread]: On master: Close
[0m22:06:16.004251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:16.004664 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:16.005104 [info ] [MainThread]: 
[0m22:06:16.005651 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m22:06:16.006633 [debug] [MainThread]: Command end result
[0m22:06:16.034707 [info ] [MainThread]: 
[0m22:06:16.035468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:16.035952 [info ] [MainThread]: 
[0m22:06:16.036464 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:16.037515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.999849, "process_user_time": 5.582571, "process_kernel_time": 0.315484, "process_mem_max_rss": "301120", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m22:06:16.038058 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:16.037954 after 13.00 seconds
[0m22:06:16.038555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169383ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1697a09220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1693822c00>]}
[0m22:06:16.039009 [debug] [MainThread]: Flushing usage events
[0m22:06:18.273125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70dabd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70cf0e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70cc3e9f0>]}


============================== 22:06:18.276307 | ce50ca55-d1ac-453c-b98a-a661a4d4b964 ==============================
[0m22:06:18.276307 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.276993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.443389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce50ca55-d1ac-453c-b98a-a661a4d4b964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70ccd7a40>]}
[0m22:06:18.461107 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23889945, "process_user_time": 1.416967, "process_kernel_time": 0.115997, "process_mem_max_rss": "92628", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:18.461697 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:18.461589 after 0.24 seconds
[0m22:06:18.462160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70cd759d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70ccd7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70cf8b590>]}
[0m22:06:18.462651 [debug] [MainThread]: Flushing usage events
[0m06:02:14.477639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b75adeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b754f0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b753c5b50>]}


============================== 06:02:14.490433 | ed58e1c3-70f9-460d-8499-9dfbfc584fda ==============================
[0m06:02:14.490433 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.491153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.634097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed58e1c3-70f9-460d-8499-9dfbfc584fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7610d1f0>]}
[0m06:02:14.647599 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r00z_156'
[0m06:02:14.648084 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.695745 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.696425 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.705608 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.709558 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:14.754325 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:14.754828 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:14.755385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed58e1c3-70f9-460d-8499-9dfbfc584fda', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b750ade50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7560da30>]}
[0m06:02:14.755837 [info ] [MainThread]: 
[0m06:02:14.756350 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:14.763167 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.33450562, "process_user_time": 1.508166, "process_kernel_time": 0.128014, "process_mem_max_rss": "94480", "process_in_blocks": "5760", "process_out_blocks": "4008"}
[0m06:02:14.763690 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:14.763590 after 0.34 seconds
[0m06:02:14.764179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7529b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7610d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b753c5b20>]}
[0m06:02:14.764612 [debug] [MainThread]: Flushing usage events
[0m06:02:16.289899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d0a1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d8df440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d8de780>]}


============================== 06:02:16.293004 | 5147eab5-0a1c-4525-8927-695e1f77ccf1 ==============================
[0m06:02:16.293004 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.293661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.533399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7e6840e0>]}
[0m06:02:16.593115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d69af00>]}
[0m06:02:16.595771 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:16.702243 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:16.703051 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:16.703582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7cd81d60>]}
[0m06:02:17.995566 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:17.996250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe78c58da0>]}
[0m06:02:18.181547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:18.187067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe78de02f0>]}
[0m06:02:18.323630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe78c06ab0>]}
[0m06:02:18.324208 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:18.324721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe78c0ed80>]}
[0m06:02:18.326516 [info ] [MainThread]: 
[0m06:02:18.327256 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.332133 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.367161 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.367621 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:18.368047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:18.866720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.868331 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:18.869375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:18.869937 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:18.877223 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.877655 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:18.878071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.879021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.880530 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.880941 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:18.881628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.882050 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.882428 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:18.883048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.883989 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.884392 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.884768 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.885334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.885738 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:18.886982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:18.892758 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.893189 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:18.893569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.894229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.894637 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.895056 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:18.908656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.910144 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:18.911357 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:18.911767 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:18.913933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7ce1e870>]}
[0m06:02:18.914481 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.914870 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.915278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:18.915897 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.916341 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.916722 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.917127 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.917660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.918096 [debug] [MainThread]: On master: Close
[0m06:02:18.918627 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:18.919133 [info ] [MainThread]: 
[0m06:02:18.939349 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:18.939976 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:18.940624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:18.941091 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:18.967813 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:18.968575 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:19.004168 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:19.004974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:09.104118 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.104636 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:09.105345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.105791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.106265 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:09.106995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.109886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.110369 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:09.111053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.127653 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:09.128146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.128588 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:09.130012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.135097 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:09.135562 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:09.137069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.139428 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:09.140986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe5816bb60>]}
[0m06:07:09.141677 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 290.20s]
[0m06:07:09.142473 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:09.143322 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:09.143900 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:09.144552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:09.145036 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:09.150838 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:09.151684 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:09.186939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.187493 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250306060709180663"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:09.187976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:09.196102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.203813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.204295 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:09.205002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.205453 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.205883 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250306060709180663'
      
      
      order by ordinal_position

  
[0m06:07:09.210799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.215917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.216408 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:09.218870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.226409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.226882 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:09.229300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.247414 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:09.248167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.248644 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250306060709180663"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250306060709180663"
    )
  
[0m06:07:09.298207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.300233 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:09.300692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:09.301142 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:09.309140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:09.310054 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:09.311496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5147eab5-0a1c-4525-8927-695e1f77ccf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe58053590>]}
[0m06:07:09.312191 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:09.313039 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:09.314348 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:09.314767 [debug] [MainThread]: On master: BEGIN
[0m06:07:09.315196 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:09.315871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:09.316320 [debug] [MainThread]: On master: COMMIT
[0m06:07:09.316702 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:09.317108 [debug] [MainThread]: On master: COMMIT
[0m06:07:09.317655 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:09.318084 [debug] [MainThread]: On master: Close
[0m06:07:09.318715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:09.319136 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:09.319541 [info ] [MainThread]: 
[0m06:07:09.320088 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 50.99 seconds (290.99s).
[0m06:07:09.321122 [debug] [MainThread]: Command end result
[0m06:07:09.346493 [info ] [MainThread]: 
[0m06:07:09.347165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:09.347697 [info ] [MainThread]: 
[0m06:07:09.348254 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:09.349284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.1094, "process_user_time": 4.759081, "process_kernel_time": 0.281708, "process_mem_max_rss": "283256", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m06:07:09.349814 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:09.349714 after 293.11 seconds
[0m06:07:09.350322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7ce1fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe6ffe9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7d4d5310>]}
[0m06:07:09.350773 [debug] [MainThread]: Flushing usage events
[0m06:07:11.182058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda61eae6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda61aa3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda61aa3140>]}


============================== 06:07:11.185067 | 5f3a9981-b9e9-40c9-aeb1-6c174645f1df ==============================
[0m06:07:11.185067 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:11.185749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:07:11.331758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3a9981-b9e9-40c9-aeb1-6c174645f1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda6305bb90>]}
[0m06:07:11.350047 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21775787, "process_user_time": 1.332776, "process_kernel_time": 0.103982, "process_mem_max_rss": "92704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:11.350576 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:11.350477 after 0.22 seconds
[0m06:07:11.351043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda61eaecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda655d7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda6305bb90>]}
[0m06:07:11.351490 [debug] [MainThread]: Flushing usage events
[0m14:05:26.635785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd331f6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd331f7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd331f6540>]}


============================== 14:05:26.647516 | 18bdf2b5-3c22-4069-b896-37858792d9db ==============================
[0m14:05:26.647516 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.648156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.792988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18bdf2b5-3c22-4069-b896-37858792d9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd32813fb0>]}
[0m14:05:26.806875 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jo3jk3b4'
[0m14:05:26.807379 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:26.867188 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:26.868037 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:26.892299 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:26.896455 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:26.973561 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:26.974233 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:26.974864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18bdf2b5-3c22-4069-b896-37858792d9db', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd326eda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3263e6c0>]}
[0m14:05:26.975373 [info ] [MainThread]: 
[0m14:05:26.975865 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:26.981629 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39509267, "process_user_time": 1.491036, "process_kernel_time": 0.13345, "process_mem_max_rss": "94252", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:05:26.982163 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:26.982061 after 0.40 seconds
[0m14:05:26.982633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd331f6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd32d3e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd32d3d370>]}
[0m14:05:26.983071 [debug] [MainThread]: Flushing usage events
[0m14:05:28.559080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14025b7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f140252fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1403011730>]}


============================== 14:05:28.562877 | 8275f0a8-7a84-4ecd-abff-e1cbed44d355 ==============================
[0m14:05:28.562877 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.563679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.851087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe5b8e60>]}
[0m14:05:28.915761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1403207770>]}
[0m14:05:28.918519 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:29.111211 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:29.112098 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:29.112689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe5e8560>]}
[0m14:05:30.453924 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:30.454577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe1387a0>]}
[0m14:05:30.652590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:30.659816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe5eb1a0>]}
[0m14:05:30.848401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe115100>]}
[0m14:05:30.848999 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:30.849510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe139670>]}
[0m14:05:30.851337 [info ] [MainThread]: 
[0m14:05:30.852148 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:30.858372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:30.895924 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:30.896467 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:30.896881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:31.426581 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:31.428399 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:31.429434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:31.430035 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:31.437710 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.438151 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:31.438571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.439805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.441388 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.441814 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:31.442446 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.442856 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.443236 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:31.443866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.444839 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:31.445249 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.445653 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:31.446182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.446626 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:31.447958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:31.454073 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:31.454514 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:31.454890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.455563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.455969 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:31.456391 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:31.470350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.471902 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:31.473178 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:31.473634 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:31.475884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fe1cdb80>]}
[0m14:05:31.476434 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.476825 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.477187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:31.477823 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.478230 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.478642 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.479012 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.479561 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.479964 [debug] [MainThread]: On master: Close
[0m14:05:31.480514 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:31.480987 [info ] [MainThread]: 
[0m14:05:31.511448 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:31.512076 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:31.512687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:31.513135 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:31.540191 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:31.541091 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:31.577297 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:31.578098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:23.397729 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.398371 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:23.399332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.399812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.400270 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:23.401250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.404889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.405391 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:23.406345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.423964 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:23.424611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.425056 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:23.426871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.432748 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:23.433244 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:23.435081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.437761 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:23.439450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fcb9cc20>]}
[0m14:10:23.440213 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.93s]
[0m14:10:23.441051 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:23.441951 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:23.442737 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:23.443458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:23.443971 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:23.450803 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:23.451647 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:23.489331 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.489957 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250306141023482950"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:23.490467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:23.499443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.508369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.508938 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:23.509819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.510282 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.510723 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250306141023482950'
      
      
      order by ordinal_position

  
[0m14:10:23.515815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.521961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.522492 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:23.525509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.534296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.534875 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:23.538472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.558005 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:23.559022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.559557 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250306141023482950"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250306141023482950"
    )
  
[0m14:10:23.614215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.616372 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:23.616836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:23.617269 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:23.624989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:23.626050 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:23.627827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8275f0a8-7a84-4ecd-abff-e1cbed44d355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13e0011160>]}
[0m14:10:23.628538 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:10:23.629323 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:23.630730 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:23.631170 [debug] [MainThread]: On master: BEGIN
[0m14:10:23.631607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:23.632454 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:23.632870 [debug] [MainThread]: On master: COMMIT
[0m14:10:23.633279 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:23.633678 [debug] [MainThread]: On master: COMMIT
[0m14:10:23.634223 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:23.634683 [debug] [MainThread]: On master: Close
[0m14:10:23.635392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:23.635781 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:23.636214 [info ] [MainThread]: 
[0m14:10:23.636776 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.78 seconds (292.78s).
[0m14:10:23.637825 [debug] [MainThread]: Command end result
[0m14:10:23.665789 [info ] [MainThread]: 
[0m14:10:23.666541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:23.667083 [info ] [MainThread]: 
[0m14:10:23.667679 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:23.668805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.16995, "process_user_time": 5.445172, "process_kernel_time": 0.31347, "process_mem_max_rss": "302808", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m14:10:23.669391 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:23.669245 after 295.17 seconds
[0m14:10:23.669868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f140323d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1403baa2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ea9be060>]}
[0m14:10:23.670346 [debug] [MainThread]: Flushing usage events
[0m14:10:25.669350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d7dd4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6c29730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d707a630>]}


============================== 14:10:25.672686 | 3dbcacdb-25d9-4dec-8bc9-56d942d6b9d6 ==============================
[0m14:10:25.672686 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:25.673371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:25.836124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dbcacdb-25d9-4dec-8bc9-56d942d6b9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6a7bb00>]}
[0m14:10:25.854430 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23671605, "process_user_time": 1.403238, "process_kernel_time": 0.112019, "process_mem_max_rss": "92816", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:10:25.854972 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:25.854872 after 0.24 seconds
[0m14:10:25.855435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6ce0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6fbc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d6a7bb00>]}
[0m14:10:25.855879 [debug] [MainThread]: Flushing usage events
[0m22:05:54.705428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61c01f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61b7c3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61c01fdd0>]}


============================== 22:05:54.713411 | 47b5885a-72c2-4ba9-8427-2a46fde47168 ==============================
[0m22:05:54.713411 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.714092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.857190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47b5885a-72c2-4ba9-8427-2a46fde47168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61b5783e0>]}
[0m22:05:54.870541 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3zq48n60'
[0m22:05:54.871031 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:54.903458 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:54.904117 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:54.914253 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:54.918201 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:55.147894 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:55.148469 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:55.149048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '47b5885a-72c2-4ba9-8427-2a46fde47168', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bc0e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61bb11ac0>]}
[0m22:05:55.149518 [info ] [MainThread]: 
[0m22:05:55.150034 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:55.152085 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49578744, "process_user_time": 1.505654, "process_kernel_time": 0.104697, "process_mem_max_rss": "94252", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m22:05:55.152648 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:55.152513 after 0.50 seconds
[0m22:05:55.153092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61b8a56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61f3bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61b8e1a60>]}
[0m22:05:55.153523 [debug] [MainThread]: Flushing usage events
[0m22:05:56.937431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbaa0f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbaa0d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbc7626f0>]}


============================== 22:05:56.940379 | 5ae1878b-6da1-474a-b13f-14e5ad2091c2 ==============================
[0m22:05:56.940379 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:56.941084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.172759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db9e25670>]}
[0m22:05:57.231917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db9f53ad0>]}
[0m22:05:57.234414 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:57.271212 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:57.271939 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:57.272469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5e4ff80>]}
[0m22:05:58.550723 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:58.551406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5b83d10>]}
[0m22:05:58.736035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:58.741486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5d57fe0>]}
[0m22:05:58.866977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5cfc7a0>]}
[0m22:05:58.867520 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:58.868054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5b3c860>]}
[0m22:05:58.869812 [info ] [MainThread]: 
[0m22:05:58.870530 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:58.875359 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:58.910552 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:58.911029 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:58.911427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:59.860931 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:59.862786 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:59.864019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:59.864747 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:59.872098 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.872525 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:59.872941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.873866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.875283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.875713 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:59.876311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.876727 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.877118 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:59.877728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.878661 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.879066 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.879442 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.880019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.880429 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:59.881667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:59.887339 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.887786 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:59.888158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.888780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.889179 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.889584 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:59.902925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.904379 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:59.905606 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:59.906015 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:59.908275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5b05580>]}
[0m22:05:59.908803 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.909192 [debug] [MainThread]: On master: BEGIN
[0m22:05:59.909561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:59.910181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.910591 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.910976 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.911339 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.911898 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.912292 [debug] [MainThread]: On master: Close
[0m22:05:59.912845 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:59.913330 [info ] [MainThread]: 
[0m22:05:59.924320 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:59.924936 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:59.925592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:59.926041 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:59.952178 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:59.952930 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:59.988259 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:59.989006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:53.083062 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.083592 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:17:53.084240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.084701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.085129 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:17:53.085837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.088703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.089152 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:17:53.089894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.106216 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:17:53.106706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.107138 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:17:53.108643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.113585 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:53.114054 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:17:53.115321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.117639 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:17:53.119137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d89f76f00>]}
[0m22:17:53.119834 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 713.19s]
[0m22:17:53.120612 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:17:53.121549 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:17:53.122138 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:17:53.122808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:17:53.123250 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:17:53.129005 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:17:53.129685 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:17:53.164426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.164940 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250306221753158446"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:17:53.165402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:53.173303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.180715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.181176 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:17:53.181809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.182248 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.182705 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250306221753158446'
      
      
      order by ordinal_position

  
[0m22:17:53.187329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.192349 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.192834 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:17:53.195316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.202776 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.203244 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:17:53.205762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.223775 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:17:53.224445 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.224944 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250306221753158446"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250306221753158446"
    )
  
[0m22:17:53.273128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.275123 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:17:53.275595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:53.276027 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:17:53.283699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:53.284589 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:17:53.286300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ae1878b-6da1-474a-b13f-14e5ad2091c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d89fdd460>]}
[0m22:17:53.286996 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:17:53.287749 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:17:53.289120 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:53.289532 [debug] [MainThread]: On master: BEGIN
[0m22:17:53.289948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:53.290618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:53.291027 [debug] [MainThread]: On master: COMMIT
[0m22:17:53.291402 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:53.291824 [debug] [MainThread]: On master: COMMIT
[0m22:17:53.292352 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:53.292787 [debug] [MainThread]: On master: Close
[0m22:17:53.293404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:53.293831 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:17:53.294237 [info ] [MainThread]: 
[0m22:17:53.294749 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 11 minutes and 54.42 seconds (714.42s).
[0m22:17:53.295729 [debug] [MainThread]: Command end result
[0m22:17:53.321157 [info ] [MainThread]: 
[0m22:17:53.321764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:53.322257 [info ] [MainThread]: 
[0m22:17:53.322780 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:17:53.323789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 716.43567, "process_user_time": 4.68402, "process_kernel_time": 0.264944, "process_mem_max_rss": "285332", "process_in_blocks": "3816", "process_out_blocks": "95552"}
[0m22:17:53.324302 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:53.324203 after 716.44 seconds
[0m22:17:53.324759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db9fb56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbb60ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5cff740>]}
[0m22:17:53.325197 [debug] [MainThread]: Flushing usage events
[0m22:17:55.323325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb3772180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb55d1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb3536240>]}


============================== 22:17:55.326322 | e3650275-cbbb-44c6-acf4-a98b4ab8ca4a ==============================
[0m22:17:55.326322 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:17:55.327005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:55.469331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3650275-cbbb-44c6-acf4-a98b4ab8ca4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb32e1f70>]}
[0m22:17:55.487400 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2136196, "process_user_time": 1.333641, "process_kernel_time": 0.101972, "process_mem_max_rss": "92816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:17:55.487932 [debug] [MainThread]: Command `dbt clean` succeeded at 22:17:55.487834 after 0.21 seconds
[0m22:17:55.488375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb3bb3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb3fe7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eb2e3ab10>]}
[0m22:17:55.488822 [debug] [MainThread]: Flushing usage events
[0m06:02:06.802650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150e4bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb151a11c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150e8bf50>]}


============================== 06:02:06.810415 | 635b83f3-95e7-4e73-89be-6fb7ee991bab ==============================
[0m06:02:06.810415 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.811103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.957627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '635b83f3-95e7-4e73-89be-6fb7ee991bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb152e26d20>]}
[0m06:02:06.971721 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-951yiqsf'
[0m06:02:06.972210 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.176206 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.176844 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.207446 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.211396 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.598018 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.598534 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:07.599066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '635b83f3-95e7-4e73-89be-6fb7ee991bab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1507db6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150812150>]}
[0m06:02:07.599526 [info ] [MainThread]: 
[0m06:02:07.600025 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:07.606001 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8552159, "process_user_time": 1.48846, "process_kernel_time": 0.12487, "process_mem_max_rss": "94488", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m06:02:07.606523 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.606422 after 0.86 seconds
[0m06:02:07.606948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150c01ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150899070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1508986b0>]}
[0m06:02:07.607393 [debug] [MainThread]: Flushing usage events
[0m06:02:09.383168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce0f41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d04ddeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce8c2990>]}


============================== 06:02:09.386226 | de22f904-47c6-4252-aeba-f0f77a1242ec ==============================
[0m06:02:09.386226 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.386906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.622545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdec44d0>]}
[0m06:02:09.684694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce143950>]}
[0m06:02:09.687209 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:09.711515 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.712249 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.712781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdd23e90>]}
[0m06:02:11.085466 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.086112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c9e3afc0>]}
[0m06:02:11.277807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.283312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdd56ae0>]}
[0m06:02:11.412431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce143950>]}
[0m06:02:11.413034 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:11.413562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdfd79b0>]}
[0m06:02:11.415360 [info ] [MainThread]: 
[0m06:02:11.416099 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.421156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.457492 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.457993 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.458433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.380536 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:12.382167 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.383203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.383751 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.391253 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.391700 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.392130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.393040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.394447 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.394851 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.395465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.395860 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.396274 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.396846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.397776 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.398198 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.398580 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.399139 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.399548 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.400730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.406646 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.407096 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.407487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.408146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.408566 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.408992 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.423128 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.424565 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.425751 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.426176 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.428495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cdfd79b0>]}
[0m06:02:12.429049 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.429467 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.429855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.430495 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.430924 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.431372 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.431773 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.432357 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.432783 [debug] [MainThread]: On master: Close
[0m06:02:12.433358 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.433846 [info ] [MainThread]: 
[0m06:02:12.455794 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.456422 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.457079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:12.457524 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.485133 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.485888 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.523064 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.523813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:05.380824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.381337 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:05.381950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.382423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.382850 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:05.383555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.386391 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.386839 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:05.387513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.404295 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:05.404785 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.405254 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:05.406410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.411552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.412093 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:05.413359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.415666 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:05.417178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c876e450>]}
[0m06:07:05.417859 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.96s]
[0m06:07:05.418650 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:05.419607 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:05.420185 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:05.420787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:05.421284 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:05.427067 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:05.427722 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:05.464353 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.464870 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250307060705458013"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:05.465380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:05.473210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.480890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.481384 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:05.482009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.482477 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.482924 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250307060705458013'
      
      
      order by ordinal_position

  
[0m06:07:05.487301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.492273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.492740 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:05.495066 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.502484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.502982 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:05.506248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.525104 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:05.525794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.526296 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250307060705458013"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250307060705458013"
    )
  
[0m06:07:05.575426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.577499 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:05.577996 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.578458 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:05.586602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.587573 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:05.589070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de22f904-47c6-4252-aeba-f0f77a1242ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6af5cb380>]}
[0m06:07:05.589775 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:05.590563 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:05.591852 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:05.592314 [debug] [MainThread]: On master: BEGIN
[0m06:07:05.592708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:05.593385 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:05.593799 [debug] [MainThread]: On master: COMMIT
[0m06:07:05.594222 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:05.594605 [debug] [MainThread]: On master: COMMIT
[0m06:07:05.595170 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:05.595577 [debug] [MainThread]: On master: Close
[0m06:07:05.596237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:05.596639 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:05.597085 [info ] [MainThread]: 
[0m06:07:05.597588 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.18 seconds (294.18s).
[0m06:07:05.598562 [debug] [MainThread]: Command end result
[0m06:07:05.623986 [info ] [MainThread]: 
[0m06:07:05.624602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:05.625126 [info ] [MainThread]: 
[0m06:07:05.625634 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:05.626630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.2952, "process_user_time": 4.839207, "process_kernel_time": 0.259493, "process_mem_max_rss": "287496", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m06:07:05.627186 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:05.627082 after 296.30 seconds
[0m06:07:05.627632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d04ddeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a0188b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ce0f4350>]}
[0m06:07:05.628101 [debug] [MainThread]: Flushing usage events
[0m06:07:07.649412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe384eee2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383cf3200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383be3290>]}


============================== 06:07:07.652294 | 06ace2c9-bb2f-4547-9af2-537bef8cb1ac ==============================
[0m06:07:07.652294 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:07.652945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:07:07.795021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ace2c9-bb2f-4547-9af2-537bef8cb1ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383682de0>]}
[0m06:07:07.813252 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21529639, "process_user_time": 1.332462, "process_kernel_time": 0.110955, "process_mem_max_rss": "92708", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:07.813766 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:07.813664 after 0.22 seconds
[0m06:07:07.814237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383928170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383977170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3836b7bc0>]}
[0m06:07:07.814674 [debug] [MainThread]: Flushing usage events
[0m14:05:07.863429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df326e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df3378770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df32b8320>]}


============================== 14:05:07.871889 | e97ff69c-64a4-48a9-a2a6-06e6c2283ea2 ==============================
[0m14:05:07.871889 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:07.872562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:08.022368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e97ff69c-64a4-48a9-a2a6-06e6c2283ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df3070530>]}
[0m14:05:08.036048 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7qbb11vx'
[0m14:05:08.036529 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:08.162281 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:08.163076 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:08.217422 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:08.221580 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:08.353548 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:08.354187 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:08.354734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e97ff69c-64a4-48a9-a2a6-06e6c2283ea2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df3b448c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df3011040>]}
[0m14:05:08.355234 [info ] [MainThread]: 
[0m14:05:08.355712 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:08.371725 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55808336, "process_user_time": 1.514059, "process_kernel_time": 0.133828, "process_mem_max_rss": "94144", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:05:08.372358 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:08.372254 after 0.56 seconds
[0m14:05:08.372870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df40ad4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df38ad130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df38ae120>]}
[0m14:05:08.373325 [debug] [MainThread]: Flushing usage events
[0m14:05:09.934907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3366a738c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33674ce900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33674cda00>]}


============================== 14:05:09.937969 | 4ff086ea-93dd-4365-ae41-fa567b93d906 ==============================
[0m14:05:09.937969 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:09.938659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.185963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3366935d00>]}
[0m14:05:10.245854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3367a48680>]}
[0m14:05:10.248537 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:10.518806 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:10.519573 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:10.520137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336672a810>]}
[0m14:05:11.913213 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:11.913862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33626257c0>]}
[0m14:05:12.122232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:12.128084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336267a600>]}
[0m14:05:12.390310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33627def60>]}
[0m14:05:12.390923 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:12.391455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33669347a0>]}
[0m14:05:12.393262 [info ] [MainThread]: 
[0m14:05:12.394018 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:12.398939 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:12.434917 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:12.435401 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:12.435820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:12.962853 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:12.964593 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:12.965595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:12.966244 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:12.973814 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.974247 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:12.974639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.975564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.977018 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.977421 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:12.977996 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.978392 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.978766 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:12.979362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.980296 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.980709 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:12.981114 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:12.981656 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.982095 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:12.983317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:12.989032 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.989448 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:12.989840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:12.990458 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:12.990890 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:12.991288 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:13.004941 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:13.006446 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:13.007678 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:13.008120 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:13.010412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3362624230>]}
[0m14:05:13.010941 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:13.011328 [debug] [MainThread]: On master: BEGIN
[0m14:05:13.011693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:13.012351 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:13.012749 [debug] [MainThread]: On master: COMMIT
[0m14:05:13.013150 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:13.013515 [debug] [MainThread]: On master: COMMIT
[0m14:05:13.014063 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:13.014453 [debug] [MainThread]: On master: Close
[0m14:05:13.014992 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:13.015499 [info ] [MainThread]: 
[0m14:05:13.041870 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:13.042506 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:13.043200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:13.043651 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:13.070770 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:13.071603 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:13.107744 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:13.108640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:11.517437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.518001 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:11.518811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.519279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.519715 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:11.520511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.523640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.524111 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:11.524853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.541589 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:11.542130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.542563 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:11.544157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.549403 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:11.549881 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:11.551158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.553556 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:11.555099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3361173200>]}
[0m14:10:11.555780 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 298.51s]
[0m14:10:11.556550 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:11.557573 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:11.558154 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:11.558743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:11.559206 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:11.565196 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:11.565887 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:11.601481 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.602093 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250307141011595310"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:11.602561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:11.611623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.619953 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.620498 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:11.621280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.621740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.622198 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250307141011595310'
      
      
      order by ordinal_position

  
[0m14:10:11.627025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.632504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.633003 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:11.635599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.643538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.644042 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:11.646510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.664778 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:11.665582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.666101 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250307141011595310"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250307141011595310"
    )
  
[0m14:10:11.715545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.717574 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:11.718056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:11.718478 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:11.727481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:11.728554 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:11.730527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ff086ea-93dd-4365-ae41-fa567b93d906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33627559a0>]}
[0m14:10:11.731241 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:11.732071 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:11.733441 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:11.733897 [debug] [MainThread]: On master: BEGIN
[0m14:10:11.734296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:11.735049 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:11.735457 [debug] [MainThread]: On master: COMMIT
[0m14:10:11.735871 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:11.736252 [debug] [MainThread]: On master: COMMIT
[0m14:10:11.736808 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:11.737219 [debug] [MainThread]: On master: Close
[0m14:10:11.737859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:11.738242 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:11.738646 [info ] [MainThread]: 
[0m14:10:11.739149 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 59.34 seconds (299.34s).
[0m14:10:11.740062 [debug] [MainThread]: Command end result
[0m14:10:11.766422 [info ] [MainThread]: 
[0m14:10:11.767101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:11.767563 [info ] [MainThread]: 
[0m14:10:11.768047 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:11.769037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 301.88406, "process_user_time": 5.427041, "process_kernel_time": 0.280622, "process_mem_max_rss": "307284", "process_in_blocks": "3816", "process_out_blocks": "95520"}
[0m14:10:11.769567 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:11.769465 after 301.88 seconds
[0m14:10:11.770041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3344382240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33440af0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33627b2e70>]}
[0m14:10:11.770488 [debug] [MainThread]: Flushing usage events
[0m14:10:14.244873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89832b7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89832b5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89832b7860>]}


============================== 14:10:14.248114 | ed183672-e469-436b-944e-4e38d06da5ab ==============================
[0m14:10:14.248114 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:14.248807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:14.401776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed183672-e469-436b-944e-4e38d06da5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8983057ce0>]}
[0m14:10:14.421003 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22653587, "process_user_time": 1.365372, "process_kernel_time": 0.118945, "process_mem_max_rss": "92716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:14.421554 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:14.421449 after 0.23 seconds
[0m14:10:14.422030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89871bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8983326ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89830b1e20>]}
[0m14:10:14.422490 [debug] [MainThread]: Flushing usage events
[0m22:05:20.474579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e4cc1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e4e07c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e4cc8320>]}


============================== 22:05:20.482664 | 1c6e1450-3184-4774-97e4-e2d4425d5aab ==============================
[0m22:05:20.482664 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:20.483370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:20.629950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c6e1450-3184-4774-97e4-e2d4425d5aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e55254c0>]}
[0m22:05:20.643734 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f2rps4il'
[0m22:05:20.644225 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:20.756477 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:20.757294 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:20.789794 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:20.793819 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:21.153734 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:21.154314 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:21.154903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1c6e1450-3184-4774-97e4-e2d4425d5aab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e49c31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e49c1940>]}
[0m22:05:21.155363 [info ] [MainThread]: 
[0m22:05:21.155871 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:21.158839 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73375016, "process_user_time": 1.504548, "process_kernel_time": 0.126297, "process_mem_max_rss": "94272", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m22:05:21.159366 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:21.159264 after 0.73 seconds
[0m22:05:21.159826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e49fbef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e4d8d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e49ecbf0>]}
[0m22:05:21.160252 [debug] [MainThread]: Flushing usage events
[0m22:05:22.945395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718661e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7185c6d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7186dd08f0>]}


============================== 22:05:22.948474 | 0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5 ==============================
[0m22:05:22.948474 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.949188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:23.182936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7185b2ebd0>]}
[0m22:05:23.241927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7185aa5160>]}
[0m22:05:23.244549 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:23.266666 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:23.267376 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:23.267928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71859c11f0>]}
[0m22:05:24.559376 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:24.560066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71818808c0>]}
[0m22:05:24.745551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:24.751222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181b62600>]}
[0m22:05:24.882899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71818178f0>]}
[0m22:05:24.883468 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:24.883999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718199ef00>]}
[0m22:05:24.885812 [info ] [MainThread]: 
[0m22:05:24.886571 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:24.891650 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:24.927961 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:24.928472 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:24.928898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:25.557539 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:25.559267 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:25.560350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:25.560972 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:25.569003 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.569507 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:25.569964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:25.571151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.572861 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.573295 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:25.573942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.574378 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.574850 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:25.575544 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.576603 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:25.577028 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:25.577433 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:25.578116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.578688 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:25.580241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:25.586365 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:25.586799 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:25.587175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:25.587821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.588221 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:25.588633 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:25.602404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:25.603962 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:25.605206 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:25.605636 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:25.608091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7185fdaed0>]}
[0m22:05:25.608642 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.609043 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.609416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:25.610090 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.610514 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.610904 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.611273 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.611842 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.612243 [debug] [MainThread]: On master: Close
[0m22:05:25.612837 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:25.613327 [info ] [MainThread]: 
[0m22:05:25.629561 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:25.630182 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:25.630795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:25.631240 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:25.658598 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:25.659468 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:25.695762 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:25.696644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:20.801033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.801573 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:20.802257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.802735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.803171 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:20.803898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.806738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.807191 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:20.807875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.824345 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:20.824836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.825274 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:20.826669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.831622 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:20.832086 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:20.833520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.835844 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:20.837357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7187247020>]}
[0m22:10:20.838058 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.21s]
[0m22:10:20.838909 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:20.839762 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:20.840430 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:20.841135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:20.841614 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:20.847558 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:20.848235 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:20.883753 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.884339 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250307221020877578"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:20.884830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:20.893873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.901959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.902462 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:20.903199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.903664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.904095 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250307221020877578'
      
      
      order by ordinal_position

  
[0m22:10:20.908857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.914407 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.914907 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:20.917427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.925306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.925846 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:20.928613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.947024 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:20.947843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:20.948321 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250307221020877578"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250307221020877578"
    )
  
[0m22:10:20.997785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:20.999773 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:21.000231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:21.000684 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:21.009080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:21.010043 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:21.011665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0859af7e-0833-4d53-bbfe-f9f7c2f7aaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715c3c72c0>]}
[0m22:10:21.012344 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:21.013100 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:21.014647 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:21.015068 [debug] [MainThread]: On master: BEGIN
[0m22:10:21.015451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:21.016203 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:21.016644 [debug] [MainThread]: On master: COMMIT
[0m22:10:21.017088 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:21.017475 [debug] [MainThread]: On master: COMMIT
[0m22:10:21.018114 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:21.018550 [debug] [MainThread]: On master: Close
[0m22:10:21.019156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:21.019560 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:21.019971 [info ] [MainThread]: 
[0m22:10:21.020463 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 56.13 seconds (296.13s).
[0m22:10:21.021425 [debug] [MainThread]: Command end result
[0m22:10:21.047423 [info ] [MainThread]: 
[0m22:10:21.048105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:21.048621 [info ] [MainThread]: 
[0m22:10:21.049121 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:21.050140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 298.15405, "process_user_time": 5.305818, "process_kernel_time": 0.324111, "process_mem_max_rss": "305792", "process_in_blocks": "3816", "process_out_blocks": "95544"}
[0m22:10:21.050705 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:21.050597 after 298.15 seconds
[0m22:10:21.051165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7189bbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71818cf9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f716dabda00>]}
[0m22:10:21.051631 [debug] [MainThread]: Flushing usage events
[0m22:10:23.271902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3a987770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3ac2c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3a913230>]}


============================== 22:10:23.274999 | 0a84a8de-e594-4486-8a6f-a4cd531d201d ==============================
[0m22:10:23.274999 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:23.275660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:23.425227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a84a8de-e594-4486-8a6f-a4cd531d201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3cae96a0>]}
[0m22:10:23.443434 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22124603, "process_user_time": 1.351509, "process_kernel_time": 0.106882, "process_mem_max_rss": "92972", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:23.443981 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:23.443881 after 0.22 seconds
[0m22:10:23.444414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3ac8e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3cae96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3a7de600>]}
[0m22:10:23.444881 [debug] [MainThread]: Flushing usage events
[0m06:02:02.045711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddf12a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddf27b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de135e450>]}


============================== 06:02:02.061334 | 0792ce28-d713-47d5-8c0f-e0fa7707bade ==============================
[0m06:02:02.061334 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:02.061996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.200259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0792ce28-d713-47d5-8c0f-e0fa7707bade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddecdeed0>]}
[0m06:02:02.213481 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l8gupxip'
[0m06:02:02.213932 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:02.280254 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:02.280875 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:02.293381 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:02.297407 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:02.438773 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:02.439295 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:02.439841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0792ce28-d713-47d5-8c0f-e0fa7707bade', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddeec5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddfe5c200>]}
[0m06:02:02.440398 [info ] [MainThread]: 
[0m06:02:02.441152 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:02.442908 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44636616, "process_user_time": 1.536309, "process_kernel_time": 0.1332, "process_mem_max_rss": "93992", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m06:02:02.443450 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:02.443350 after 0.45 seconds
[0m06:02:02.443869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddec84710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ddef90fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de04262d0>]}
[0m06:02:02.444315 [debug] [MainThread]: Flushing usage events
[0m06:02:04.029812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63bbda5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b3b7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b3b5160>]}


============================== 06:02:04.032683 | fb31c210-5298-46d0-949c-d1b9e55a2d8a ==============================
[0m06:02:04.032683 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:04.033384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.265827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b16d250>]}
[0m06:02:04.324797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63735d310>]}
[0m06:02:04.327159 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:04.365736 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:04.366438 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:04.366958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd637332cc0>]}
[0m06:02:05.652773 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.653427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd636f93230>]}
[0m06:02:05.843851 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.849119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63709f9b0>]}
[0m06:02:05.986374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63ef96d80>]}
[0m06:02:05.986917 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:05.987476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b789280>]}
[0m06:02:05.989203 [info ] [MainThread]: 
[0m06:02:05.989913 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.994618 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:06.030557 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:06.031020 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:06.031477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:06.572454 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:06.573979 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:06.574934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:06.575517 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:06.582737 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.583189 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:06.583576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.584549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.586007 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.586440 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:06.586994 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.587410 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.587781 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:06.588371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.589295 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.589694 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.590090 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.590642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.591069 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:06.592299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:06.598060 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.598477 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:06.598848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.599489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.599881 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.600303 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:06.614720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.616167 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.617365 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.617765 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.620098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63bc091f0>]}
[0m06:02:06.620600 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.620989 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.621406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.621993 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.622430 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.622811 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.623206 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.623740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.624185 [debug] [MainThread]: On master: Close
[0m06:02:06.624707 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.625216 [info ] [MainThread]: 
[0m06:02:06.647117 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.647690 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.648328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:06.648771 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.675110 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.675837 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.711304 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.712019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:59.381005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.381511 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:06:59.382144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.382589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.383016 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:06:59.383716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.386510 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.386955 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:06:59.387630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.403991 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.404475 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.404903 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.406105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.410989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.411465 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:06:59.412655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.414922 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:06:59.416415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6359a00e0>]}
[0m06:06:59.417099 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.77s]
[0m06:06:59.417845 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:06:59.418657 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:06:59.419241 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:06:59.420059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:06:59.420515 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:06:59.426009 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:06:59.426649 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:06:59.461125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.461620 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250308060659455196"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:06:59.462111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:59.469748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.476954 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.477424 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:06:59.478024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.478494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.478916 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250308060659455196'
      
      
      order by ordinal_position

  
[0m06:06:59.483203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.488115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.488580 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:59.490911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.498369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.498834 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:59.501023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.518795 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:06:59.519444 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.519907 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250308060659455196"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250308060659455196"
    )
  
[0m06:06:59.567754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.569728 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:59.570223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.570656 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:59.578822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.579717 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:06:59.581396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb31c210-5298-46d0-949c-d1b9e55a2d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd624922cc0>]}
[0m06:06:59.582086 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:06:59.582888 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:06:59.584220 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:59.584647 [debug] [MainThread]: On master: BEGIN
[0m06:06:59.585031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:06:59.585699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:59.586142 [debug] [MainThread]: On master: COMMIT
[0m06:06:59.586531 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:59.586904 [debug] [MainThread]: On master: COMMIT
[0m06:06:59.587483 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:59.587880 [debug] [MainThread]: On master: Close
[0m06:06:59.588485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:06:59.588860 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:06:59.589289 [info ] [MainThread]: 
[0m06:06:59.589759 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.60 seconds (293.60s).
[0m06:06:59.590688 [debug] [MainThread]: Command end result
[0m06:06:59.616489 [info ] [MainThread]: 
[0m06:06:59.617057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:06:59.617528 [info ] [MainThread]: 
[0m06:06:59.618002 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:06:59.618934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.64246, "process_user_time": 4.68442, "process_kernel_time": 0.233469, "process_mem_max_rss": "290844", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m06:06:59.619482 [debug] [MainThread]: Command `dbt run` succeeded at 06:06:59.619382 after 295.64 seconds
[0m06:06:59.619913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd610045b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63b37ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63ebb4590>]}
[0m06:06:59.620370 [debug] [MainThread]: Flushing usage events
[0m06:07:01.420092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874b7b9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874bae1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874c0955e0>]}


============================== 06:07:01.423017 | 738408cb-60ce-47d1-bbc1-4dade8afcd58 ==============================
[0m06:07:01.423017 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:01.423749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:07:01.570670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '738408cb-60ce-47d1-bbc1-4dade8afcd58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874c1503e0>]}
[0m06:07:01.588740 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2209975, "process_user_time": 1.372704, "process_kernel_time": 0.086981, "process_mem_max_rss": "92836", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:01.589288 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:01.589182 after 0.22 seconds
[0m06:07:01.589718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874bae1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874bbcb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874bbca630>]}
[0m06:07:01.590168 [debug] [MainThread]: Flushing usage events
[0m14:04:38.553529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc137b5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13739640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc137b7140>]}


============================== 14:04:38.561143 | aafb068c-969c-42c3-828f-73e85c553b1c ==============================
[0m14:04:38.561143 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:38.561852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:38.705932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aafb068c-969c-42c3-828f-73e85c553b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13c7a480>]}
[0m14:04:38.719293 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c4d0duva'
[0m14:04:38.719769 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:38.832919 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:38.833602 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:38.844418 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:38.848431 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:39.057896 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:39.058518 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:39.059105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aafb068c-969c-42c3-828f-73e85c553b1c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13794b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc14329c70>]}
[0m14:04:39.059609 [info ] [MainThread]: 
[0m14:04:39.060144 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:39.071129 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5665494, "process_user_time": 1.533139, "process_kernel_time": 0.126838, "process_mem_max_rss": "94176", "process_in_blocks": "5728", "process_out_blocks": "4008"}
[0m14:04:39.071683 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:39.071581 after 0.57 seconds
[0m14:04:39.072121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13739640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13794e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc13794b60>]}
[0m14:04:39.072567 [debug] [MainThread]: Flushing usage events
[0m14:04:40.791325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c15977830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c159777d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c159779e0>]}


============================== 14:04:40.794364 | 5abb2805-8464-4f61-affb-a439083e249c ==============================
[0m14:04:40.794364 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:40.795021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:41.026324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c16950650>]}
[0m14:04:41.085605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c16638620>]}
[0m14:04:41.088189 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:04:41.114366 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:41.115101 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:41.115670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c15977950>]}
[0m14:04:42.405893 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:42.406530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c15d52a50>]}
[0m14:04:42.590189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:42.595622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c115a5b20>]}
[0m14:04:42.719319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c11581310>]}
[0m14:04:42.719868 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:04:42.720402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c1154ade0>]}
[0m14:04:42.722136 [info ] [MainThread]: 
[0m14:04:42.722871 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:42.727705 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:42.762813 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:42.763288 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:42.763690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:43.331482 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:43.333416 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:43.334371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:43.334923 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:43.342074 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:43.342519 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:43.342902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:43.343987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.345408 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:43.345810 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:43.346368 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.346764 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:43.347137 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:43.347733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.348657 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:43.349055 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:43.349449 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:43.349979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.350405 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:43.351585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:43.357269 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:43.357685 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:43.358059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:43.358720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.359126 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:43.359554 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:43.372837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:43.374286 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:43.375492 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:43.375896 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:43.378137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c11527c50>]}
[0m14:04:43.378650 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:43.379038 [debug] [MainThread]: On master: BEGIN
[0m14:04:43.379430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:43.380020 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:43.380438 [debug] [MainThread]: On master: COMMIT
[0m14:04:43.380820 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:43.381182 [debug] [MainThread]: On master: COMMIT
[0m14:04:43.381717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:43.382105 [debug] [MainThread]: On master: Close
[0m14:04:43.382643 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:43.383118 [info ] [MainThread]: 
[0m14:04:43.398701 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:43.399335 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:43.399909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:04:43.400379 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:43.427004 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:43.427769 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:43.463531 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:43.464288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:38.528564 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.529055 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:38.529694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.530137 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.530591 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:38.531319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.534139 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.534605 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:38.535289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.551710 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:38.552190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.552643 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:38.553850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.558745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:38.559202 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:09:38.560513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.562794 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:38.564292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bec1137d0>]}
[0m14:09:38.564974 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.16s]
[0m14:09:38.565757 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:38.566670 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:38.567218 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:38.567804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:38.568257 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:38.573799 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:38.574449 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:38.609268 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.609771 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250308140938603163"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:38.610230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:38.617921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.625271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.625731 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:38.626335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.626775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.627202 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250308140938603163'
      
      
      order by ordinal_position

  
[0m14:09:38.631666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.636670 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.637148 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:38.640235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.647644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.648106 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:38.651145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.668953 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:38.669628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.670089 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250308140938603163"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250308140938603163"
    )
  
[0m14:09:38.722708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.724654 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:38.725102 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:38.725549 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:38.734595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:38.735492 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:38.737161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abb2805-8464-4f61-affb-a439083e249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bedfb3380>]}
[0m14:09:38.737868 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:38.738635 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:38.739910 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:38.740357 [debug] [MainThread]: On master: BEGIN
[0m14:09:38.740743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:38.741358 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:38.741761 [debug] [MainThread]: On master: COMMIT
[0m14:09:38.742142 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:38.742558 [debug] [MainThread]: On master: COMMIT
[0m14:09:38.743100 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:38.743567 [debug] [MainThread]: On master: Close
[0m14:09:38.744171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:38.744581 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:38.744983 [info ] [MainThread]: 
[0m14:09:38.745478 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 56.02 seconds (296.02s).
[0m14:09:38.746405 [debug] [MainThread]: Command end result
[0m14:09:38.771515 [info ] [MainThread]: 
[0m14:09:38.772065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:38.772541 [info ] [MainThread]: 
[0m14:09:38.773009 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:38.773910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 298.0325, "process_user_time": 4.696336, "process_kernel_time": 0.251876, "process_mem_max_rss": "286260", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m14:09:38.774464 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:38.774358 after 298.03 seconds
[0m14:09:38.774897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c158efcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c159779e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c17d11100>]}
[0m14:09:38.775356 [debug] [MainThread]: Flushing usage events
[0m14:09:40.763017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36f1ec6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef9bb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef9bb8f0>]}


============================== 14:09:40.765945 | 24005778-db28-44fd-89ac-73e04cf9b1cb ==============================
[0m14:09:40.765945 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:40.766611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:09:40.908329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24005778-db28-44fd-89ac-73e04cf9b1cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef84e600>]}
[0m14:09:40.926117 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21269411, "process_user_time": 1.31064, "process_kernel_time": 0.111969, "process_mem_max_rss": "92756", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:40.926651 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:40.926551 after 0.21 seconds
[0m14:09:40.927084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef7e0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef7e1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ef7e00e0>]}
[0m14:09:40.927529 [debug] [MainThread]: Flushing usage events
[0m22:05:02.860510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d41adc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4c79fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4182810>]}


============================== 22:05:02.891736 | fde2371f-90ff-4d39-a803-c4c50514056c ==============================
[0m22:05:02.891736 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:02.892578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:03.052772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fde2371f-90ff-4d39-a803-c4c50514056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4bbaae0>]}
[0m22:05:03.066240 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xlolw798'
[0m22:05:03.066691 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:03.139445 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:03.140155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:03.151991 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:03.156174 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:03.208272 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:03.208791 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:03.209369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fde2371f-90ff-4d39-a803-c4c50514056c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d7713770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4022720>]}
[0m22:05:03.209819 [info ] [MainThread]: 
[0m22:05:03.210354 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:03.336225 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5244499, "process_user_time": 1.5041, "process_kernel_time": 0.126008, "process_mem_max_rss": "94348", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m22:05:03.337136 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:03.336947 after 0.53 seconds
[0m22:05:03.337747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d69761b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4de7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d3f85040>]}
[0m22:05:03.338395 [debug] [MainThread]: Flushing usage events
[0m22:05:04.842243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedce7f7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedce7f7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedce7f7a70>]}


============================== 22:05:04.846431 | 39dd048d-221c-4e9b-8d93-57ca3503b3ad ==============================
[0m22:05:04.846431 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:04.847378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:05.088201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf8545f0>]}
[0m22:05:05.159941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedceb01700>]}
[0m22:05:05.162497 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:05.310750 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:05.311518 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:05.312067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedce6b7f20>]}
[0m22:05:06.604988 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:06.605619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedce55bb60>]}
[0m22:05:06.789251 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:06.794548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedca482600>]}
[0m22:05:06.916816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedca5e74a0>]}
[0m22:05:06.917394 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:06.917927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedca420860>]}
[0m22:05:06.919685 [info ] [MainThread]: 
[0m22:05:06.920418 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:06.925306 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:06.960440 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:06.960896 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:06.961326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:07.432154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:07.433751 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:07.434781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:07.435376 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:07.442795 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:07.443246 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:07.443637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:07.444597 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:07.446002 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:07.446426 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:07.446985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:07.447404 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:07.447782 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:07.448380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:07.449328 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:07.449733 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:07.450136 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:07.450680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:07.451105 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:07.452326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:07.457948 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:07.458387 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:07.458762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:07.459417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:07.459816 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:07.460237 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:07.475361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:07.476921 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:07.478169 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:07.478575 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:07.480869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedca296ff0>]}
[0m22:05:07.481426 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:07.481827 [debug] [MainThread]: On master: BEGIN
[0m22:05:07.482233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:07.482854 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:07.483287 [debug] [MainThread]: On master: COMMIT
[0m22:05:07.483667 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:07.484064 [debug] [MainThread]: On master: COMMIT
[0m22:05:07.484618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:07.485023 [debug] [MainThread]: On master: Close
[0m22:05:07.485610 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:07.486123 [info ] [MainThread]: 
[0m22:05:07.563365 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:07.564021 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:07.564684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:07.565168 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:07.592008 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:07.592766 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:07.628710 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:07.629463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:58.874241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:58.874751 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:09:58.875404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:58.875859 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:58.876316 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:09:58.877255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:58.880131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:58.880590 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:09:58.881296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:58.897813 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:09:58.898322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:58.898761 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:09:58.900068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:58.905145 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:09:58.905608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:09:58.906830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:58.909211 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:09:58.910787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda1f9e870>]}
[0m22:09:58.911504 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.35s]
[0m22:09:58.912280 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:09:58.913203 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:09:58.913865 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:09:58.914538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:09:58.914988 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:09:58.920787 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:09:58.921473 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:09:58.957217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:58.957920 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250308220958949991"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:09:58.958595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:58.966718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:58.974117 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:58.974579 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:09:58.975250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:58.975696 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:58.976153 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250308220958949991'
      
      
      order by ordinal_position

  
[0m22:09:58.980711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:58.985726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:58.986215 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:09:58.988500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:58.995919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:58.996408 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:09:58.999647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:59.017654 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:09:59.018335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:59.018799 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250308220958949991"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250308220958949991"
    )
  
[0m22:09:59.067619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:59.069648 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:09:59.070126 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:09:59.070559 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:09:59.078532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:09:59.079434 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:09:59.081127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39dd048d-221c-4e9b-8d93-57ca3503b3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedac084710>]}
[0m22:09:59.081806 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:09:59.082622 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:09:59.084232 [debug] [MainThread]: Using duckdb connection "master"
[0m22:09:59.084659 [debug] [MainThread]: On master: BEGIN
[0m22:09:59.085083 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:09:59.085736 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:09:59.086180 [debug] [MainThread]: On master: COMMIT
[0m22:09:59.086567 [debug] [MainThread]: Using duckdb connection "master"
[0m22:09:59.086941 [debug] [MainThread]: On master: COMMIT
[0m22:09:59.087555 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:09:59.087959 [debug] [MainThread]: On master: Close
[0m22:09:59.088595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:59.088976 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:09:59.089425 [info ] [MainThread]: 
[0m22:09:59.089919 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.17 seconds (292.17s).
[0m22:09:59.090866 [debug] [MainThread]: Command end result
[0m22:09:59.116411 [info ] [MainThread]: 
[0m22:09:59.117000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:09:59.117531 [info ] [MainThread]: 
[0m22:09:59.118051 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:09:59.119049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.33344, "process_user_time": 5.225173, "process_kernel_time": 0.288395, "process_mem_max_rss": "304428", "process_in_blocks": "3816", "process_out_blocks": "95568"}
[0m22:09:59.119573 [debug] [MainThread]: Command `dbt run` succeeded at 22:09:59.119473 after 294.33 seconds
[0m22:09:59.120016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedce85d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf274890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedac119520>]}
[0m22:09:59.120478 [debug] [MainThread]: Flushing usage events
[0m22:10:00.861294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1d2850a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1d880770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1d8831d0>]}


============================== 22:10:00.864230 | a3e185df-e6a9-42a2-8b60-5300db8805c6 ==============================
[0m22:10:00.864230 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:00.864930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:10:01.009126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3e185df-e6a9-42a2-8b60-5300db8805c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1d01d250>]}
[0m22:10:01.027097 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21486601, "process_user_time": 1.330205, "process_kernel_time": 0.097014, "process_mem_max_rss": "92664", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:10:01.027616 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:01.027516 after 0.22 seconds
[0m22:10:01.028069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1d2850a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b1de50da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b21163da0>]}
[0m22:10:01.028505 [debug] [MainThread]: Flushing usage events
[0m06:02:04.477885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf550f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf4d48770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf5c18110>]}


============================== 06:02:04.486686 | 1374d376-2e46-436c-a7c5-fe607d8fbe8f ==============================
[0m06:02:04.486686 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:04.487490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.651083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1374d376-2e46-436c-a7c5-fe607d8fbe8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf4a404a0>]}
[0m06:02:04.666319 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-80m7mub8'
[0m06:02:04.666860 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:04.717182 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:04.718005 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:04.730889 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:04.735026 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:04.947372 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:04.947962 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:04.948536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1374d376-2e46-436c-a7c5-fe607d8fbe8f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf4981e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf49812b0>]}
[0m06:02:04.949007 [info ] [MainThread]: 
[0m06:02:04.949519 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:04.951296 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.52601683, "process_user_time": 1.524669, "process_kernel_time": 0.143874, "process_mem_max_rss": "94520", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m06:02:04.951837 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:04.951735 after 0.53 seconds
[0m06:02:04.952312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf8ad3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf4c8bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf4ff0e60>]}
[0m06:02:04.952774 [debug] [MainThread]: Flushing usage events
[0m06:02:06.741062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff740f90da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742a16360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff740ddc350>]}


============================== 06:02:06.744337 | 275dc043-fce9-4f47-bfc0-84c0735e05d0 ==============================
[0m06:02:06.744337 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.745092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.003388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff741558590>]}
[0m06:02:07.065492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7409b6600>]}
[0m06:02:07.068120 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:07.100183 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:07.100974 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:07.101548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff74031ed80>]}
[0m06:02:08.395331 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:08.395988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73c1ae4e0>]}
[0m06:02:08.584015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:08.591488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73c154200>]}
[0m06:02:08.723713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73c2fe600>]}
[0m06:02:08.724290 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:08.724792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73c1ada00>]}
[0m06:02:08.726501 [info ] [MainThread]: 
[0m06:02:08.727195 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:08.732060 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:08.768567 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:08.769069 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:08.769516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:09.116253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.118210 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:09.119432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:09.120121 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:09.127728 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.128165 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:09.128585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.129578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.131043 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.131470 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:09.132063 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.132509 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.132889 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:09.133487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.134445 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.134849 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.135251 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.135796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.136203 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:09.137476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:09.143239 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.143660 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:09.144037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.144671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.145070 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.145497 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:09.159633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.161204 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:09.162504 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:09.162920 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:09.165123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73c1acf80>]}
[0m06:02:09.165683 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.166079 [debug] [MainThread]: On master: BEGIN
[0m06:02:09.166485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:09.167109 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.167544 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.167933 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.168330 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.168869 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.169299 [debug] [MainThread]: On master: Close
[0m06:02:09.169840 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:09.170356 [info ] [MainThread]: 
[0m06:02:09.181679 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:09.182332 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:09.182999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:09.183482 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:09.210597 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:09.211431 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:09.248011 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:09.248831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:01.111587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.112081 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:01.112727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.113172 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.113623 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:01.114329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.117189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.117658 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:01.118335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.134905 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:01.135408 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.135841 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:01.136960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.141878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.142358 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:01.143494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.145821 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:01.147357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73c358680>]}
[0m06:07:01.148027 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.96s]
[0m06:07:01.148865 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:01.149648 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:01.150398 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:01.151039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:01.151507 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:01.157073 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:01.157741 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:01.192618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.193111 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250309060701186677"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:01.193597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:01.201748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.208997 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.209483 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:01.210075 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.210539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.210969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250309060701186677'
      
      
      order by ordinal_position

  
[0m06:07:01.215344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.220356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.220824 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:01.223098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.230586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.231053 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:01.233543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.251520 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:01.252168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.252665 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250309060701186677"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250309060701186677"
    )
  
[0m06:07:01.301159 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.303155 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:01.303623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.304041 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:01.311842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.312733 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:01.314254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '275dc043-fce9-4f47-bfc0-84c0735e05d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff71fea4d10>]}
[0m06:07:01.314929 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:01.315695 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:01.317031 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:01.317497 [debug] [MainThread]: On master: BEGIN
[0m06:07:01.317888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:01.318541 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:01.318951 [debug] [MainThread]: On master: COMMIT
[0m06:07:01.319375 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:01.319754 [debug] [MainThread]: On master: COMMIT
[0m06:07:01.320323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:01.320719 [debug] [MainThread]: On master: Close
[0m06:07:01.321308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:01.321691 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:01.322094 [info ] [MainThread]: 
[0m06:07:01.322587 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.60 seconds (292.60s).
[0m06:07:01.323483 [debug] [MainThread]: Command end result
[0m06:07:01.348435 [info ] [MainThread]: 
[0m06:07:01.348985 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:01.349470 [info ] [MainThread]: 
[0m06:07:01.349940 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:01.350839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.65973, "process_user_time": 5.107945, "process_kernel_time": 0.28694, "process_mem_max_rss": "299220", "process_in_blocks": "3816", "process_out_blocks": "95520"}
[0m06:07:01.351387 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:01.351284 after 294.66 seconds
[0m06:07:01.351822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7441bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73aaab230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7409b4980>]}
[0m06:07:01.352262 [debug] [MainThread]: Flushing usage events
[0m06:07:03.332934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe780a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe780a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe76acb60>]}


============================== 06:07:03.335765 | d4db8d25-8bf4-4ef2-ae41-22ecd7c4a78c ==============================
[0m06:07:03.335765 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:03.336474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:07:03.475054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4db8d25-8bf4-4ef2-ae41-22ecd7c4a78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe6b4f860>]}
[0m06:07:03.493027 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2092298, "process_user_time": 1.310217, "process_kernel_time": 0.107935, "process_mem_max_rss": "92596", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:03.493587 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:03.493481 after 0.21 seconds
[0m06:07:03.494014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe780a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe8fa55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe6c0af30>]}
[0m06:07:03.494458 [debug] [MainThread]: Flushing usage events
[0m14:04:23.651471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496ee19ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496ea75a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496ea4a630>]}


============================== 14:04:23.664728 | 784b3297-8aa9-4cea-a68a-e0967c953d06 ==============================
[0m14:04:23.664728 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:23.665389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:23.807157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '784b3297-8aa9-4cea-a68a-e0967c953d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496f8d45f0>]}
[0m14:04:23.820762 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f1j8zzgb'
[0m14:04:23.821250 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:23.923751 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:23.924418 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:23.938961 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:23.943219 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:23.990096 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:23.990632 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:23.991152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '784b3297-8aa9-4cea-a68a-e0967c953d06', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496e7a9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496e7e10d0>]}
[0m14:04:23.991603 [info ] [MainThread]: 
[0m14:04:23.992086 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:24.036348 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4342249, "process_user_time": 1.564396, "process_kernel_time": 0.120415, "process_mem_max_rss": "94288", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:04:24.036949 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:24.036842 after 0.43 seconds
[0m14:04:24.037451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496ea8ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49725b8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f496f8d45f0>]}
[0m14:04:24.037886 [debug] [MainThread]: Flushing usage events
[0m14:04:25.464923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1cb74290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1dcd12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1c0bc140>]}


============================== 14:04:25.468072 | 6ccfec4e-dba8-45cc-b6f5-1820927542dc ==============================
[0m14:04:25.468072 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:25.468731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:25.704605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1c1227b0>]}
[0m14:04:25.763001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1c175580>]}
[0m14:04:25.765466 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:04:25.806071 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:25.806785 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:25.807339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1bfc9e50>]}
[0m14:04:27.085281 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:27.085931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf180b7c20>]}
[0m14:04:27.269147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:27.274448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf17fe0980>]}
[0m14:04:27.404403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1c2fafc0>]}
[0m14:04:27.405362 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:04:27.406150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1cd951c0>]}
[0m14:04:27.408636 [info ] [MainThread]: 
[0m14:04:27.409368 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:27.414171 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:27.451093 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:27.451593 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:27.452039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:27.966958 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:27.968730 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:27.969731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:27.970389 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:27.978108 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:27.978532 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:27.978918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:27.980055 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:27.981454 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:27.981864 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:27.982443 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:27.982831 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:27.983243 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:27.983846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:27.984783 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:27.985203 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:27.985574 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:27.986133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:27.986530 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:27.987739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:27.993423 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:27.993834 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:27.994251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:27.994890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:27.995322 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:27.995746 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:28.009659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:28.011118 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:28.012347 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:28.012746 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:28.014932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1f926a50>]}
[0m14:04:28.015478 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:28.015862 [debug] [MainThread]: On master: BEGIN
[0m14:04:28.016265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:28.016874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:28.017313 [debug] [MainThread]: On master: COMMIT
[0m14:04:28.017691 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:28.018088 [debug] [MainThread]: On master: COMMIT
[0m14:04:28.018640 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:28.019073 [debug] [MainThread]: On master: Close
[0m14:04:28.019596 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:28.020094 [info ] [MainThread]: 
[0m14:04:28.053721 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:28.054340 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:28.055007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:04:28.055461 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:28.082200 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:28.083014 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:28.118909 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:28.119687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:18.827539 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:18.828059 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:18.828692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.829157 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:18.829580 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:18.830290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.833124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:18.833575 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:18.834254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.850693 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:18.851179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:18.851607 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:18.852842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.857808 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:18.858288 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:09:18.859494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.861819 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:18.863334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0c798d70>]}
[0m14:09:18.864034 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 290.81s]
[0m14:09:18.864866 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:18.865867 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:18.866467 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:18.867101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:18.867540 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:18.873079 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:18.873720 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:18.908306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:18.908796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250309140918902390"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:18.909278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:18.917430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.924765 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:18.925250 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:18.925883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.926350 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:18.926778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250309140918902390'
      
      
      order by ordinal_position

  
[0m14:09:18.931399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.936385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:18.936857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:18.939291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.946703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:18.947205 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:18.949441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:18.967306 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:18.968010 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:18.968477 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250309140918902390"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250309140918902390"
    )
  
[0m14:09:19.019747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:19.021757 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:19.022239 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:19.022664 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:19.031241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:19.032170 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:19.034068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ccfec4e-dba8-45cc-b6f5-1820927542dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf17ea2570>]}
[0m14:09:19.034738 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:19.035491 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:19.036794 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:19.037260 [debug] [MainThread]: On master: BEGIN
[0m14:09:19.037651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:19.038338 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:19.038745 [debug] [MainThread]: On master: COMMIT
[0m14:09:19.039171 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:19.039546 [debug] [MainThread]: On master: COMMIT
[0m14:09:19.040142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:19.040557 [debug] [MainThread]: On master: Close
[0m14:09:19.041197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:19.041578 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:19.042008 [info ] [MainThread]: 
[0m14:09:19.042508 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 51.63 seconds (291.63s).
[0m14:09:19.043480 [debug] [MainThread]: Command end result
[0m14:09:19.068707 [info ] [MainThread]: 
[0m14:09:19.069297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:19.069826 [info ] [MainThread]: 
[0m14:09:19.070391 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:19.071389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.65613, "process_user_time": 5.18247, "process_kernel_time": 0.293536, "process_mem_max_rss": "309920", "process_in_blocks": "3816", "process_out_blocks": "95512"}
[0m14:09:19.071924 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:19.071821 after 293.66 seconds
[0m14:09:19.072400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1c2aaf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf17e12db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf180b3170>]}
[0m14:09:19.072836 [debug] [MainThread]: Flushing usage events
[0m14:09:21.281174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b14b5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b1559760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b14eb5c0>]}


============================== 14:09:21.284102 | e582f084-c8ba-43e6-bd7f-d84700bf3a1e ==============================
[0m14:09:21.284102 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:21.284735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:21.424258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e582f084-c8ba-43e6-bd7f-d84700bf3a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b2454590>]}
[0m14:09:21.442084 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21043077, "process_user_time": 1.320729, "process_kernel_time": 0.104978, "process_mem_max_rss": "92696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:21.442590 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:21.442492 after 0.21 seconds
[0m14:09:21.443036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b5363da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b2454590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18b34f63c0>]}
[0m14:09:21.443481 [debug] [MainThread]: Flushing usage events
[0m22:05:16.692996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f5d216a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f3f0fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f3c4b7d0>]}


============================== 22:05:16.701308 | d8de8d4b-76e2-4917-82ea-2ffc52473d7b ==============================
[0m22:05:16.701308 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:16.701953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:16.843899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8de8d4b-76e2-4917-82ea-2ffc52473d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f39318e0>]}
[0m22:05:16.857212 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ucw8hwwg'
[0m22:05:16.857668 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:16.911825 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:16.912467 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:16.926823 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:16.931297 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:17.263317 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:17.263831 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:17.264384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd8de8d4b-76e2-4917-82ea-2ffc52473d7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f3b59a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f3b5ad50>]}
[0m22:05:17.264832 [info ] [MainThread]: 
[0m22:05:17.265322 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:17.266899 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6220833, "process_user_time": 1.455257, "process_kernel_time": 0.127109, "process_mem_max_rss": "94496", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m22:05:17.267449 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:17.267349 after 0.62 seconds
[0m22:05:17.267877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f5d216a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f3912f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f3ee5cd0>]}
[0m22:05:17.268347 [debug] [MainThread]: Flushing usage events
[0m22:05:18.900498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd705bce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6fbb4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6fe45ee0>]}


============================== 22:05:18.903384 | bc43de68-56da-4baa-bc69-5cb5db7b29d6 ==============================
[0m22:05:18.903384 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:18.904058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:19.131841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd70b40710>]}
[0m22:05:19.189786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd7119d850>]}
[0m22:05:19.192138 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:19.222903 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:19.223614 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:19.224157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6bbe3470>]}
[0m22:05:20.492777 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:20.493465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6b79f440>]}
[0m22:05:20.674364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:20.679593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6b79e060>]}
[0m22:05:20.804312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6b7c51f0>]}
[0m22:05:20.804862 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:20.805398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6fb438f0>]}
[0m22:05:20.807130 [info ] [MainThread]: 
[0m22:05:20.807832 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:20.812678 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:20.848042 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:20.848496 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:20.848893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:21.667285 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:21.668965 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:21.670051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:21.670717 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:21.679330 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:21.679791 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:21.680260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:21.681384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:21.683003 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:21.683500 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:21.684092 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:21.684501 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:21.684949 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:21.685663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:21.686725 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:21.687161 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:21.687576 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:21.688209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:21.688647 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:21.689983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:21.696186 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:21.696607 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:21.697006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:21.697652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:21.698106 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:21.698499 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:21.712081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:21.713518 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:21.714741 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:21.715184 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:21.717352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6b937a40>]}
[0m22:05:21.717863 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:21.718299 [debug] [MainThread]: On master: BEGIN
[0m22:05:21.718673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:21.719275 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:21.719682 [debug] [MainThread]: On master: COMMIT
[0m22:05:21.720086 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:21.720470 [debug] [MainThread]: On master: COMMIT
[0m22:05:21.721031 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:21.721441 [debug] [MainThread]: On master: Close
[0m22:05:21.721969 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:21.722461 [info ] [MainThread]: 
[0m22:05:21.733240 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:21.733815 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:21.734425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:21.734867 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:21.761217 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:21.761961 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:21.797328 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:21.798079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:17.283134 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:17.283632 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:17.284259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.284706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:17.285163 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:17.285854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.288692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:17.289156 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:17.289818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.305950 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:17.306439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:17.306890 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:17.309463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.314340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:17.314801 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:17.318513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.320787 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:17.322281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd62d3d8b0>]}
[0m22:10:17.322942 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.59s]
[0m22:10:17.323779 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:17.324595 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:17.325170 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:17.325784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:17.326427 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:17.331974 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:17.332622 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:17.366314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:17.366798 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250309221017360470"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:17.367286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:17.375328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.382420 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:17.382870 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:17.383461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.383893 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:17.384338 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250309221017360470'
      
      
      order by ordinal_position

  
[0m22:10:17.388584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.393523 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:17.393983 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:17.396283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.403679 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:17.404157 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:17.407244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.424722 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:17.425371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:17.425827 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250309221017360470"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250309221017360470"
    )
  
[0m22:10:17.473261 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.475268 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:17.475720 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:17.476166 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:17.485334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:17.486239 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:17.487791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc43de68-56da-4baa-bc69-5cb5db7b29d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6b786cf0>]}
[0m22:10:17.488475 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:10:17.489306 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:17.490852 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:17.491316 [debug] [MainThread]: On master: BEGIN
[0m22:10:17.491708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:17.492362 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:17.492767 [debug] [MainThread]: On master: COMMIT
[0m22:10:17.493184 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:17.493566 [debug] [MainThread]: On master: COMMIT
[0m22:10:17.494123 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:17.494522 [debug] [MainThread]: On master: Close
[0m22:10:17.495156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:17.495544 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:17.495950 [info ] [MainThread]: 
[0m22:10:17.496446 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 56.69 seconds (296.69s).
[0m22:10:17.497356 [debug] [MainThread]: Command end result
[0m22:10:17.522210 [info ] [MainThread]: 
[0m22:10:17.522764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:17.523241 [info ] [MainThread]: 
[0m22:10:17.523708 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:17.524609 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 298.6729, "process_user_time": 5.435846, "process_kernel_time": 0.256228, "process_mem_max_rss": "300340", "process_in_blocks": "3816", "process_out_blocks": "95552"}
[0m22:10:17.525150 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:17.525040 after 298.67 seconds
[0m22:10:17.525590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd705bce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd40da52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd5bf5f8c0>]}
[0m22:10:17.526009 [debug] [MainThread]: Flushing usage events
[0m22:10:19.515144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d10beae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d113d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d105e9f0>]}


============================== 22:10:19.517971 | bf5cb8e2-a642-4fa8-a1e4-f4b730a50df5 ==============================
[0m22:10:19.517971 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:19.518662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:19.655911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf5cb8e2-a642-4fa8-a1e4-f4b730a50df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d205c500>]}
[0m22:10:19.673558 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20682997, "process_user_time": 1.305587, "process_kernel_time": 0.087039, "process_mem_max_rss": "92704", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:10:19.674132 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:19.673955 after 0.21 seconds
[0m22:10:19.674555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d0f27bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d1083590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d10836b0>]}
[0m22:10:19.674970 [debug] [MainThread]: Flushing usage events
[0m06:02:08.097366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342a93f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342a32c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342a32ce60>]}


============================== 06:02:08.105351 | c4a299b4-467b-41c1-bd84-efa4258e2321 ==============================
[0m06:02:08.105351 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.106053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.248956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4a299b4-467b-41c1-bd84-efa4258e2321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342bb1e390>]}
[0m06:02:08.262573 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ddpt1x77'
[0m06:02:08.263054 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:08.290583 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:08.291250 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:08.301359 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:08.305326 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:08.518451 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:08.519102 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:08.519703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c4a299b4-467b-41c1-bd84-efa4258e2321', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342b52bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342b52b5c0>]}
[0m06:02:08.520205 [info ] [MainThread]: 
[0m06:02:08.520707 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:08.522794 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47519436, "process_user_time": 1.47061, "process_kernel_time": 0.131965, "process_mem_max_rss": "94252", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m06:02:08.523329 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:08.523228 after 0.48 seconds
[0m06:02:08.523777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342a8f7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342a438500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342bb1e390>]}
[0m06:02:08.524203 [debug] [MainThread]: Flushing usage events
[0m06:02:10.236183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bdb15190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bc752ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bcfb9220>]}


============================== 06:02:10.239303 | 7de8217b-75a6-440a-902f-0d9ea1cfce45 ==============================
[0m06:02:10.239303 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.240041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.492282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bbef5430>]}
[0m06:02:10.551208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bbf0aab0>]}
[0m06:02:10.553817 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:10.570201 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:10.570945 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:10.571488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bbf41c70>]}
[0m06:02:11.912463 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.913106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b7c24440>]}
[0m06:02:12.108242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:12.113637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b7dd72c0>]}
[0m06:02:12.285370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b7c1aed0>]}
[0m06:02:12.286175 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:12.286820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b7c25cd0>]}
[0m06:02:12.289119 [info ] [MainThread]: 
[0m06:02:12.290007 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:12.296029 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:12.331936 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:12.332387 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:12.332818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.804909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.806741 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.808037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.808803 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.816317 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.816778 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.817208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.818162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.819633 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.820058 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.820621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.821049 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.821424 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.822034 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.822981 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.823388 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.823781 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.824347 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.824768 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.826041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.831843 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.832255 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.832630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.833342 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.833782 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.834191 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.850107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.851856 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.853288 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.853817 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.856298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b7c16930>]}
[0m06:02:12.856830 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.857224 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.857595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.858227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.858625 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.859035 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.859400 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.859952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.860348 [debug] [MainThread]: On master: Close
[0m06:02:12.860923 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.861488 [info ] [MainThread]: 
[0m06:02:12.899039 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.899666 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.900321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:12.900835 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.928453 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.929211 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.964909 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.965674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:06.540607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:06.541143 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:06.541788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.542233 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:06.542655 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:06.543358 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.546169 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:06.546611 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:06.547291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.563538 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:06.564027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:06.564467 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:06.567590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.572473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:06.572940 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:06.578045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.580308 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:06.581823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498c020c20>]}
[0m06:07:06.582494 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.68s]
[0m06:07:06.583257 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:06.584178 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:06.584726 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:06.585343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:06.585803 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:06.591303 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:06.591961 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:06.626429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.626933 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250310060706620505"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:06.627388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:06.635131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.642384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.642855 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:06.643458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.643936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.644368 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250310060706620505'
      
      
      order by ordinal_position

  
[0m06:07:06.648894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.653856 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.654320 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:06.657519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.665068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.665535 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:06.668430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.686303 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:06.686988 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.687451 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250310060706620505"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250310060706620505"
    )
  
[0m06:07:06.734665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.736607 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:06.737073 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.737493 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:06.746449 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.747329 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:06.748701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de8217b-75a6-440a-902f-0d9ea1cfce45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49a41c8e90>]}
[0m06:07:06.749381 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:06.750193 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:06.751930 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:06.752349 [debug] [MainThread]: On master: BEGIN
[0m06:07:06.752733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:06.753479 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:06.753928 [debug] [MainThread]: On master: COMMIT
[0m06:07:06.754315 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:06.754687 [debug] [MainThread]: On master: COMMIT
[0m06:07:06.755252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:06.755662 [debug] [MainThread]: On master: Close
[0m06:07:06.756409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:06.756812 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:06.757217 [info ] [MainThread]: 
[0m06:07:06.757677 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.47 seconds (294.47s).
[0m06:07:06.758585 [debug] [MainThread]: Command end result
[0m06:07:06.783997 [info ] [MainThread]: 
[0m06:07:06.784569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:06.785054 [info ] [MainThread]: 
[0m06:07:06.785519 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:06.786430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.59998, "process_user_time": 4.779698, "process_kernel_time": 0.296353, "process_mem_max_rss": "283644", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m06:07:06.786994 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:06.786892 after 296.60 seconds
[0m06:07:06.787431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bd7a1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bc1e7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bc174290>]}
[0m06:07:06.787883 [debug] [MainThread]: Flushing usage events
[0m06:07:08.781622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5954c7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc595ac9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594fbd850>]}


============================== 06:07:08.784507 | d1bf192b-0f41-447e-845f-5f7330952e29 ==============================
[0m06:07:08.784507 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:08.785215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:08.925189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1bf192b-0f41-447e-845f-5f7330952e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc596257bf0>]}
[0m06:07:08.943482 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21143828, "process_user_time": 1.320669, "process_kernel_time": 0.103974, "process_mem_max_rss": "92696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:08.944033 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:08.943929 after 0.21 seconds
[0m06:07:08.944471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5987b8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc598b63da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc594f7c4a0>]}
[0m06:07:08.944924 [debug] [MainThread]: Flushing usage events
[0m14:05:39.500408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9136f3e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9138dc66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9136f3f980>]}


============================== 14:05:39.508321 | d30b6d76-672d-4eb7-8207-7eaadd6a3b1c ==============================
[0m14:05:39.508321 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:39.508990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:39.652178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd30b6d76-672d-4eb7-8207-7eaadd6a3b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9136961610>]}
[0m14:05:39.665586 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-clfcj_tt'
[0m14:05:39.666048 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:39.719987 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:39.720667 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:39.731057 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:39.735276 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:39.966236 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:39.966896 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:39.967509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd30b6d76-672d-4eb7-8207-7eaadd6a3b1c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913718d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9137b2b590>]}
[0m14:05:39.967978 [info ] [MainThread]: 
[0m14:05:39.968508 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:39.971040 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5199253, "process_user_time": 1.494173, "process_kernel_time": 0.125762, "process_mem_max_rss": "94380", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:05:39.971617 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:39.971514 after 0.52 seconds
[0m14:05:39.972052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913761f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9136b44560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913683e030>]}
[0m14:05:39.972501 [debug] [MainThread]: Flushing usage events
[0m14:05:41.660936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85787ce540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85771b5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85770ee5a0>]}


============================== 14:05:41.663838 | 7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7 ==============================
[0m14:05:41.663838 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.664516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.894865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85766ec5c0>]}
[0m14:05:41.953523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85766a51f0>]}
[0m14:05:41.955929 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:41.972343 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:41.973044 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:41.973591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8576593470>]}
[0m14:05:43.298869 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:43.299566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85724b1ac0>]}
[0m14:05:43.488172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:43.493674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8572404a70>]}
[0m14:05:43.674234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85768b2120>]}
[0m14:05:43.674820 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:43.675374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85776d9b80>]}
[0m14:05:43.677091 [info ] [MainThread]: 
[0m14:05:43.677860 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:43.683401 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:43.719493 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:43.719955 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:43.720402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:44.166214 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:44.167867 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:44.168891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:44.169509 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:44.176798 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:44.177227 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:44.177640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:44.178524 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:44.179940 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:44.180361 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:44.181163 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:44.181589 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:44.181964 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:44.182616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:44.183578 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:44.183984 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:44.184382 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:44.184909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:44.185341 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:44.186572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:44.192177 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:44.192615 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:44.192989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:44.193616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:44.194014 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:44.194424 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:44.213095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:44.215476 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:44.217496 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:44.218155 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:44.220899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f857711c7d0>]}
[0m14:05:44.221519 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:44.221934 [debug] [MainThread]: On master: BEGIN
[0m14:05:44.222335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:44.223037 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:44.223489 [debug] [MainThread]: On master: COMMIT
[0m14:05:44.223877 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:44.224280 [debug] [MainThread]: On master: COMMIT
[0m14:05:44.224841 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:44.225266 [debug] [MainThread]: On master: Close
[0m14:05:44.225794 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:44.226323 [info ] [MainThread]: 
[0m14:05:44.323394 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:44.324027 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:44.324714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:44.325157 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:44.351925 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:44.352675 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:44.388034 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:44.388786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:35.567028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.567575 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:35.568287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.568744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.569182 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:35.569935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.572842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.573318 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:35.574015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.590499 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:35.590971 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.591430 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:35.592577 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.597558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.598019 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:35.599207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.601556 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:35.603084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8577e5f200>]}
[0m14:10:35.603786 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.28s]
[0m14:10:35.604550 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:35.605548 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:35.606096 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:35.606680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:35.607123 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:35.612868 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:35.613552 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:35.648183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.648712 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250310141035642210"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:35.649171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:35.657279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.664949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.665432 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:35.666059 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.666524 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.666957 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250310141035642210'
      
      
      order by ordinal_position

  
[0m14:10:35.671453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.676593 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.677063 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:35.679346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.686787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.687273 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:35.690329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.708459 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:35.709169 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.709667 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250310141035642210"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250310141035642210"
    )
  
[0m14:10:35.759718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.761740 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:35.762199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.762654 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:35.771477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.772443 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:35.774107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2504d1-0f7b-4e60-ad2f-2ef1a294cfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855407ae70>]}
[0m14:10:35.774810 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:35.775564 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:35.776896 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:35.777366 [debug] [MainThread]: On master: BEGIN
[0m14:10:35.777754 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:35.778472 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:35.778877 [debug] [MainThread]: On master: COMMIT
[0m14:10:35.779281 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:35.779665 [debug] [MainThread]: On master: COMMIT
[0m14:10:35.780198 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:35.780633 [debug] [MainThread]: On master: Close
[0m14:10:35.781223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:35.781644 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:35.782048 [info ] [MainThread]: 
[0m14:10:35.782598 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.10 seconds (292.10s).
[0m14:10:35.783590 [debug] [MainThread]: Command end result
[0m14:10:35.809287 [info ] [MainThread]: 
[0m14:10:35.809924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:35.810476 [info ] [MainThread]: 
[0m14:10:35.811007 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:35.812023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.20013, "process_user_time": 4.721129, "process_kernel_time": 0.297323, "process_mem_max_rss": "291568", "process_in_blocks": "3816", "process_out_blocks": "95520"}
[0m14:10:35.812584 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:35.812484 after 294.20 seconds
[0m14:10:35.813024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8576c256a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855757fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85725d0da0>]}
[0m14:10:35.813492 [debug] [MainThread]: Flushing usage events
[0m14:10:37.856231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034a42930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03581e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd033c274a0>]}


============================== 14:10:37.859326 | 9ed8f087-a124-4bdc-96f2-05c765f0e4b7 ==============================
[0m14:10:37.859326 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:37.860012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:10:38.006739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ed8f087-a124-4bdc-96f2-05c765f0e4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034947dd0>]}
[0m14:10:38.025012 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21797924, "process_user_time": 1.32362, "process_kernel_time": 0.112967, "process_mem_max_rss": "92860", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:10:38.025598 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:38.025489 after 0.22 seconds
[0m14:10:38.026035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd033c4d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd034947dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0333737d0>]}
[0m14:10:38.026485 [debug] [MainThread]: Flushing usage events
[0m22:05:46.880665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cadd4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cae73d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cc28ffe0>]}


============================== 22:05:46.895987 | 79484712-2b40-45f3-8933-43e2e0bb991c ==============================
[0m22:05:46.895987 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:46.896645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:47.037701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79484712-2b40-45f3-8933-43e2e0bb991c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ca87fce0>]}
[0m22:05:47.051443 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uu0zksr3'
[0m22:05:47.051955 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:47.119297 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:47.120125 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:47.132798 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:47.136821 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:47.272772 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:47.273411 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:47.273981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '79484712-2b40-45f3-8933-43e2e0bb991c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ca8bf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ca8bfb00>]}
[0m22:05:47.274475 [info ] [MainThread]: 
[0m22:05:47.274972 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:47.311178 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4797738, "process_user_time": 1.51589, "process_kernel_time": 0.125321, "process_mem_max_rss": "94200", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m22:05:47.311883 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:47.311762 after 0.48 seconds
[0m22:05:47.312365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cacc4d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cab4dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ca891970>]}
[0m22:05:47.312866 [debug] [MainThread]: Flushing usage events
[0m22:05:48.906630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f46e0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f4672390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f4673920>]}


============================== 22:05:48.909667 | 961246b9-7ebe-44ae-a20b-660e076dc8b8 ==============================
[0m22:05:48.909667 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:48.910309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:49.178955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f560cce0>]}
[0m22:05:49.259858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f7c13770>]}
[0m22:05:49.262526 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:49.349084 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:49.349995 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:49.350564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f05415b0>]}
[0m22:05:50.711344 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:50.712012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f028ef30>]}
[0m22:05:50.895607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:50.900946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f053da90>]}
[0m22:05:51.054105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f023b290>]}
[0m22:05:51.054692 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:51.055232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f0228d70>]}
[0m22:05:51.056973 [info ] [MainThread]: 
[0m22:05:51.057717 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:51.062589 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:51.098192 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:51.098663 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:51.099064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:51.660218 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:51.661900 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:51.662897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:51.663542 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:51.671046 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.671514 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:51.671908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:51.672932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.674474 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.674884 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:51.675489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.675909 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.676287 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:51.676931 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.677884 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:51.678293 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:51.678691 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:51.679243 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.679672 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:51.681047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:51.686908 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:51.687319 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:51.687731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:51.688400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.688801 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:51.689184 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:51.703192 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:51.704935 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:51.706241 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:51.706722 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:51.709221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f0228d70>]}
[0m22:05:51.709799 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.710214 [debug] [MainThread]: On master: BEGIN
[0m22:05:51.710634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:51.711330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.711772 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.712161 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:51.712562 [debug] [MainThread]: On master: COMMIT
[0m22:05:51.713144 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:51.713583 [debug] [MainThread]: On master: Close
[0m22:05:51.714157 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:51.714663 [info ] [MainThread]: 
[0m22:05:51.727067 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:51.727739 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:51.728350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:51.728842 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:51.756513 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:51.757514 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:51.795130 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:51.796163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:41.745718 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.746259 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:41.746975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.747453 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.747901 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:41.748660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.751693 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.752145 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:41.752864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.769388 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:41.769935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.770382 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:41.771682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.776903 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.777365 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:41.778618 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.780993 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:41.782569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1eed73140>]}
[0m22:10:41.783251 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 290.05s]
[0m22:10:41.784028 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:41.784944 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:41.785612 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:41.786175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:41.786650 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:41.792428 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:41.793087 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:41.827695 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.828239 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250310221041821692"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:41.828725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:41.836725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.844647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.845131 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:41.845816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.846256 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.846702 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250310221041821692'
      
      
      order by ordinal_position

  
[0m22:10:41.851263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.856497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.856974 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:41.859454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.867196 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.867706 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:41.870409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.888721 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:41.889493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.889974 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250310221041821692"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250310221041821692"
    )
  
[0m22:10:41.943817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.945891 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:41.946401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.946843 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:41.955857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.956896 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:41.958693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '961246b9-7ebe-44ae-a20b-660e076dc8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1cdfd2ab0>]}
[0m22:10:41.959420 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:41.960245 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:41.961640 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:41.962067 [debug] [MainThread]: On master: BEGIN
[0m22:10:41.962485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:41.963201 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:41.963655 [debug] [MainThread]: On master: COMMIT
[0m22:10:41.964048 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:41.964472 [debug] [MainThread]: On master: COMMIT
[0m22:10:41.965089 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:41.965525 [debug] [MainThread]: On master: Close
[0m22:10:41.966138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:41.966538 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:41.966954 [info ] [MainThread]: 
[0m22:10:41.967502 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 50.91 seconds (290.91s).
[0m22:10:41.968523 [debug] [MainThread]: Command end result
[0m22:10:41.994628 [info ] [MainThread]: 
[0m22:10:41.995291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:41.995850 [info ] [MainThread]: 
[0m22:10:41.996402 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:41.997445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.1398, "process_user_time": 4.897075, "process_kernel_time": 0.276342, "process_mem_max_rss": "296896", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m22:10:41.997977 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:41.997873 after 293.14 seconds
[0m22:10:41.998446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f8563da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f4aa8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1cc043080>]}
[0m22:10:41.998903 [debug] [MainThread]: Flushing usage events
[0m22:10:44.374720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a6295c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a605bb9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a605bb890>]}


============================== 22:10:44.377932 | 5f8a7bd3-bea1-4398-be65-4a9869e3cbc9 ==============================
[0m22:10:44.377932 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:44.378662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:10:44.541275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f8a7bd3-bea1-4398-be65-4a9869e3cbc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a603ae480>]}
[0m22:10:44.560900 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23729837, "process_user_time": 1.380733, "process_kernel_time": 0.09998, "process_mem_max_rss": "92720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:44.561522 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:44.561404 after 0.24 seconds
[0m22:10:44.561998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a610e2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a605bb9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a61c2fb90>]}
[0m22:10:44.562483 [debug] [MainThread]: Flushing usage events
[0m06:02:04.671823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc49a2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc57a1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc4c48620>]}


============================== 06:02:04.680243 | 2dff0baa-9d05-4694-80dc-f6e3aae05f80 ==============================
[0m06:02:04.680243 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:04.680990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.831025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dff0baa-9d05-4694-80dc-f6e3aae05f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc5f223f0>]}
[0m06:02:04.844985 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6sr8w4tc'
[0m06:02:04.845449 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:04.956946 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:04.957653 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:04.969884 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:04.973752 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:05.026773 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:05.027304 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:05.027814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2dff0baa-9d05-4694-80dc-f6e3aae05f80', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc4814b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc4800aa0>]}
[0m06:02:05.028297 [info ] [MainThread]: 
[0m06:02:05.028778 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:05.030468 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41010636, "process_user_time": 1.504507, "process_kernel_time": 0.120559, "process_mem_max_rss": "94620", "process_in_blocks": "5760", "process_out_blocks": "4008"}
[0m06:02:05.030998 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:05.030897 after 0.41 seconds
[0m06:02:05.031438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc4d556a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc5f223f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc49a2690>]}
[0m06:02:05.031887 [debug] [MainThread]: Flushing usage events
[0m06:02:06.564867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc43902c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4391610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4392720>]}


============================== 06:02:06.567883 | 8613c77b-1e5c-4e30-b800-6a7048f5a063 ==============================
[0m06:02:06.567883 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.568603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.810129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4b20770>]}
[0m06:02:06.873066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4af6510>]}
[0m06:02:06.875580 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:06.891985 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:06.892718 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:06.893283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc387be90>]}
[0m06:02:08.339196 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:08.339870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf6bf500>]}
[0m06:02:08.541708 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:08.547241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf604140>]}
[0m06:02:08.839790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf606240>]}
[0m06:02:08.840535 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:08.841137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf617830>]}
[0m06:02:08.843251 [info ] [MainThread]: 
[0m06:02:08.844070 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:08.849911 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:08.888611 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:08.889089 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:08.889484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:09.449635 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:09.451218 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:09.452094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:09.452645 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:09.462077 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.462712 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:09.463323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.464434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.466580 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.467199 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:09.467991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.468579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.469180 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:09.469992 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.471411 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.472028 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.472608 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.473360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.473973 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:09.475440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:09.481283 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.481705 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:09.482121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.482750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.483174 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.483563 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:09.498018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.499529 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:09.500835 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:09.501461 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:09.504116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf4a69f0>]}
[0m06:02:09.504674 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.505104 [debug] [MainThread]: On master: BEGIN
[0m06:02:09.505470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:09.506087 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.506493 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.506889 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.507278 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.507820 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.508246 [debug] [MainThread]: On master: Close
[0m06:02:09.508764 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:09.509294 [info ] [MainThread]: 
[0m06:02:09.810098 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:09.810732 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:09.811416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:09.811878 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:09.839506 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:09.840275 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:09.878170 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:09.878946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:59.962933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.963453 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:06:59.964125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.964593 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.965079 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:06:59.965816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.968837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.969327 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:06:59.970036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.987340 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.987827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.988306 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.989480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.994668 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.995169 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:06:59.996794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.999151 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:00.000689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefa416cce0>]}
[0m06:07:00.001391 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 290.19s]
[0m06:07:00.002179 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:00.003119 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:00.003799 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:00.004482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:00.004949 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:00.010511 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:00.011154 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:00.048438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.048971 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250311060700041998"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:00.049457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:00.057494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.065137 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.065618 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:00.066276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.066743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.067229 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250311060700041998'
      
      
      order by ordinal_position

  
[0m06:07:00.071657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.076796 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.077286 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:00.079770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.087488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.087973 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:00.090263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.108375 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:00.109072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.109537 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250311060700041998"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250311060700041998"
    )
  
[0m06:07:00.158060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.160076 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:00.160532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.160991 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:00.169009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.169892 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:00.171555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8613c77b-1e5c-4e30-b800-6a7048f5a063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefaeddb560>]}
[0m06:07:00.172249 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:00.173078 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:00.174368 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:00.174797 [debug] [MainThread]: On master: BEGIN
[0m06:07:00.175223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:00.175895 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:00.176311 [debug] [MainThread]: On master: COMMIT
[0m06:07:00.176688 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:00.177101 [debug] [MainThread]: On master: COMMIT
[0m06:07:00.177642 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:00.178079 [debug] [MainThread]: On master: Close
[0m06:07:00.178668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:00.179074 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:00.179478 [info ] [MainThread]: 
[0m06:07:00.179973 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 51.34 seconds (291.34s).
[0m06:07:00.180910 [debug] [MainThread]: Command end result
[0m06:07:00.206517 [info ] [MainThread]: 
[0m06:07:00.207085 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:00.207542 [info ] [MainThread]: 
[0m06:07:00.208028 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:00.208952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.69608, "process_user_time": 4.941291, "process_kernel_time": 0.26012, "process_mem_max_rss": "292444", "process_in_blocks": "3816", "process_out_blocks": "95520"}
[0m06:07:00.209476 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:00.209375 after 293.70 seconds
[0m06:07:00.209931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc38b7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3e156a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3f6d2e0>]}
[0m06:07:00.210362 [debug] [MainThread]: Flushing usage events
[0m06:07:01.951184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3332ca69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3332d126c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3332d12780>]}


============================== 06:07:01.954046 | fd59790e-ef40-48b1-aa9e-014e2403b387 ==============================
[0m06:07:01.954046 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:01.954684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:02.103057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd59790e-ef40-48b1-aa9e-014e2403b387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3333250650>]}
[0m06:07:02.121288 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.219414, "process_user_time": 1.338346, "process_kernel_time": 0.093024, "process_mem_max_rss": "92700", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:02.121817 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:02.121713 after 0.22 seconds
[0m06:07:02.122317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3332111ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3332112f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3332d12780>]}
[0m06:07:02.122753 [debug] [MainThread]: Flushing usage events
[0m14:05:35.086221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1d3c0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1dd22240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1d3c1430>]}


============================== 14:05:35.109509 | 6fd55142-ba51-4e85-b306-902406d1d7c7 ==============================
[0m14:05:35.109509 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:35.110217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.254540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fd55142-ba51-4e85-b306-902406d1d7c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1e115fd0>]}
[0m14:05:35.268300 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-muxdrk0t'
[0m14:05:35.268794 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:35.324980 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:35.325795 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:35.350699 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:35.354713 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:35.424726 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:35.425267 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:35.425824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6fd55142-ba51-4e85-b306-902406d1d7c7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1d995b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1db4c230>]}
[0m14:05:35.426281 [info ] [MainThread]: 
[0m14:05:35.426791 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:35.428538 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39286128, "process_user_time": 1.514567, "process_kernel_time": 0.120362, "process_mem_max_rss": "94492", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:05:35.429063 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:35.428963 after 0.39 seconds
[0m14:05:35.429515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1cb21fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1c9485f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1c94ad80>]}
[0m14:05:35.429941 [debug] [MainThread]: Flushing usage events
[0m14:05:36.933231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9d66f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9d9bec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9d3eba10>]}


============================== 14:05:36.936213 | 5802d3d9-08fa-483b-b7e6-6fd0141ad737 ==============================
[0m14:05:36.936213 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.936919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:37.174292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9e6585c0>]}
[0m14:05:37.234220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9dec55b0>]}
[0m14:05:37.236821 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:37.253805 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:37.254552 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:37.255095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9d34da30>]}
[0m14:05:38.550404 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:38.551062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a993bbc50>]}
[0m14:05:38.736963 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:38.742406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a993a3560>]}
[0m14:05:38.874762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a991f8d70>]}
[0m14:05:38.875338 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:38.875894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9d4bae70>]}
[0m14:05:38.877676 [info ] [MainThread]: 
[0m14:05:38.878445 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:38.883342 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:38.919307 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:38.919829 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:38.920230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:39.615412 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:39.617223 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:39.618234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:39.618811 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:39.626061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.626731 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:39.627340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:39.628484 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.630155 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.630786 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:39.631568 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.632175 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.632797 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:39.633648 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.634925 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:39.635335 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.635745 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:39.636329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.636758 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:39.637958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:39.643567 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:39.643975 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:39.644346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:39.644979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.645377 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:39.645792 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:39.661475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.662959 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:39.664167 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:39.664598 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:39.666733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9920f5f0>]}
[0m14:05:39.667234 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.667663 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.668027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:39.668653 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.669064 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.669476 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.669856 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.670423 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.670826 [debug] [MainThread]: On master: Close
[0m14:05:39.671344 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:39.671842 [info ] [MainThread]: 
[0m14:05:39.784790 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:39.785556 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:39.786271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:39.786815 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:39.815663 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:39.816455 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:39.853140 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:39.853989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:30.445900 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.446440 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:30.447086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.447545 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.447975 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:30.448672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.451578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.452025 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:30.452693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.469265 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:30.469747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.470174 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:30.471351 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.476236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.476714 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:30.477830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.480149 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:30.481704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a78d49970>]}
[0m14:10:30.482376 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 290.69s]
[0m14:10:30.483120 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:30.483961 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:30.484527 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:30.485269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:30.485740 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:30.491565 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:30.492199 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:30.528886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.529412 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250311141030522906"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:30.529883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:30.537759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.545294 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.545767 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:30.546401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.546842 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.547268 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250311141030522906'
      
      
      order by ordinal_position

  
[0m14:10:30.551561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.556536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.557001 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:30.560125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.567590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.568047 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:30.570297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.588152 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:30.588850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.589300 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250311141030522906"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250311141030522906"
    )
  
[0m14:10:30.637328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.639323 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:30.639794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.640209 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:30.647647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.648539 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:30.650039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5802d3d9-08fa-483b-b7e6-6fd0141ad737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a940eb0e0>]}
[0m14:10:30.650740 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:10:30.651486 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:30.652830 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:30.653261 [debug] [MainThread]: On master: BEGIN
[0m14:10:30.653689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:30.654360 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:30.654818 [debug] [MainThread]: On master: COMMIT
[0m14:10:30.655214 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:30.655608 [debug] [MainThread]: On master: COMMIT
[0m14:10:30.656130 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:30.656565 [debug] [MainThread]: On master: Close
[0m14:10:30.657181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:30.657603 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:30.658008 [info ] [MainThread]: 
[0m14:10:30.658540 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 51.78 seconds (291.78s).
[0m14:10:30.659539 [debug] [MainThread]: Command end result
[0m14:10:30.684758 [info ] [MainThread]: 
[0m14:10:30.685364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:30.685912 [info ] [MainThread]: 
[0m14:10:30.686461 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:30.687470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.80396, "process_user_time": 4.747118, "process_kernel_time": 0.265566, "process_mem_max_rss": "286204", "process_in_blocks": "3816", "process_out_blocks": "95512"}
[0m14:10:30.687991 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:30.687891 after 293.80 seconds
[0m14:10:30.688441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a9d66f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a897b68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8a344080>]}
[0m14:10:30.688873 [debug] [MainThread]: Flushing usage events
[0m14:10:32.518333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac443e9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac440b2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac42de0ce0>]}


============================== 14:10:32.521471 | 0ab8e68d-60ad-4f33-80ad-f85b0f58657b ==============================
[0m14:10:32.521471 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:32.522209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:32.669743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ab8e68d-60ad-4f33-80ad-f85b0f58657b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac419fd250>]}
[0m14:10:32.688145 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22099788, "process_user_time": 1.35343, "process_kernel_time": 0.098958, "process_mem_max_rss": "92728", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:10:32.688691 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:32.688586 after 0.22 seconds
[0m14:10:32.689130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac42de0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4200bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac41911eb0>]}
[0m14:10:32.689588 [debug] [MainThread]: Flushing usage events
[0m22:05:50.468179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e018ecbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e02621640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e022291c0>]}


============================== 22:05:50.483482 | e1db3845-b42a-4361-9f9c-df87554e6b30 ==============================
[0m22:05:50.483482 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.484132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.629147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1db3845-b42a-4361-9f9c-df87554e6b30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0218e750>]}
[0m22:05:50.642590 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-35c4gmlv'
[0m22:05:50.643050 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:50.762114 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:50.762782 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:50.816945 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:50.821069 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:50.973490 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:50.974063 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:50.974637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e1db3845-b42a-4361-9f9c-df87554e6b30', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e016919d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e01691a30>]}
[0m22:05:50.975112 [info ] [MainThread]: 
[0m22:05:50.975615 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:50.977444 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5581521, "process_user_time": 1.481757, "process_kernel_time": 0.111206, "process_mem_max_rss": "94260", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m22:05:50.977969 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:50.977868 after 0.56 seconds
[0m22:05:50.978424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e01b94cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e057bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0166abd0>]}
[0m22:05:50.978860 [debug] [MainThread]: Flushing usage events
[0m22:05:52.528893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f297361a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2972e28da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2972e28350>]}


============================== 22:05:52.531902 | bdeb8229-bcc4-42f3-ab78-7287310ab2d9 ==============================
[0m22:05:52.531902 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.532558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.767143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296ed58d70>]}
[0m22:05:52.825233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2973ca92b0>]}
[0m22:05:52.827826 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:52.874069 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:52.874848 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:52.875387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296ec456d0>]}
[0m22:05:54.149631 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:54.150286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296ea9ee70>]}
[0m22:05:54.333208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:54.338642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296eada630>]}
[0m22:05:54.476913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296e9d3ad0>]}
[0m22:05:54.477490 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:54.478013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296e91dd30>]}
[0m22:05:54.479771 [info ] [MainThread]: 
[0m22:05:54.480520 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:54.485419 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:54.520521 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:54.520983 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:54.521403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.070822 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:55.072522 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:55.073509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:55.074089 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:55.081580 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.082036 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:55.082450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.083661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.085196 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.085646 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:55.086246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.086671 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.087076 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:55.087699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.088698 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.089166 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.089638 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.090232 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.090694 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:55.091960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:55.097882 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.098323 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:55.098711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.099335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.099745 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.100132 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:55.114157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.115645 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:55.116842 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:55.117247 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:55.119502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296e91f140>]}
[0m22:05:55.120026 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.120468 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.120842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:55.121477 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.121883 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.122270 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.122676 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.123239 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.123678 [debug] [MainThread]: On master: Close
[0m22:05:55.124222 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:55.124719 [info ] [MainThread]: 
[0m22:05:55.135951 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:55.136577 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:55.137151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:55.137621 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:55.164156 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:55.164948 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:55.200264 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:55.201042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:46.345877 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:46.346392 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:46.347039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.347510 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:46.347943 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:46.348644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.351509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:46.351958 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:46.352639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.369013 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:46.369495 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:46.369928 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:46.372132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.377190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:46.377661 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:46.379399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.381653 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:46.383162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2974356930>]}
[0m22:10:46.383855 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.25s]
[0m22:10:46.384693 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:46.385624 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:46.386317 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:46.386892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:46.387350 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:46.392887 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:46.393546 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:46.427809 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:46.428322 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250311221046421858"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:46.428794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:46.436538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.443762 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:46.444213 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:46.444837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.445275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:46.445741 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250311221046421858'
      
      
      order by ordinal_position

  
[0m22:10:46.450225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.455187 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:46.455673 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:46.457884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.465266 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:46.465752 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:46.468946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.486466 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:46.487124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:46.487602 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250311221046421858"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250311221046421858"
    )
  
[0m22:10:46.537759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.539728 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:46.540179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:46.540645 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:46.549839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:46.550744 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:46.552122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdeb8229-bcc4-42f3-ab78-7287310ab2d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296ed2f0e0>]}
[0m22:10:46.552809 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:46.553555 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:46.554875 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:46.555321 [debug] [MainThread]: On master: BEGIN
[0m22:10:46.555729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:46.556386 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:46.556794 [debug] [MainThread]: On master: COMMIT
[0m22:10:46.557173 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:46.557579 [debug] [MainThread]: On master: COMMIT
[0m22:10:46.558107 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:46.558550 [debug] [MainThread]: On master: Close
[0m22:10:46.559157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:46.559598 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:46.560003 [info ] [MainThread]: 
[0m22:10:46.560500 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.08 seconds (292.08s).
[0m22:10:46.561436 [debug] [MainThread]: Command end result
[0m22:10:46.588596 [info ] [MainThread]: 
[0m22:10:46.589153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:46.589645 [info ] [MainThread]: 
[0m22:10:46.590111 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:46.591044 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.11124, "process_user_time": 4.632009, "process_kernel_time": 0.274178, "process_mem_max_rss": "296776", "process_in_blocks": "3816", "process_out_blocks": "95552"}
[0m22:10:46.591588 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:46.591486 after 294.11 seconds
[0m22:10:46.592023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2972e2a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29731f08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295c1b6960>]}
[0m22:10:46.592474 [debug] [MainThread]: Flushing usage events
[0m22:10:48.879880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c57fcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4543e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4c95a00>]}


============================== 22:10:48.882787 | 1c9a09c1-b6de-4bca-a248-b0f85f5fc431 ==============================
[0m22:10:48.882787 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:48.883463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:49.027197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c9a09c1-b6de-4bca-a248-b0f85f5fc431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c5c53c80>]}
[0m22:10:49.044862 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21369621, "process_user_time": 1.300327, "process_kernel_time": 0.106944, "process_mem_max_rss": "92708", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:49.045443 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:49.045273 after 0.21 seconds
[0m22:10:49.045880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c57fcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c54f39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c5c53c80>]}
[0m22:10:49.046377 [debug] [MainThread]: Flushing usage events
[0m06:02:01.706092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8b993b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8c46d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8b9ee3f0>]}


============================== 06:02:01.719902 | c83e11fd-cbe6-4c2d-9bef-7b5a53645efd ==============================
[0m06:02:01.719902 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:01.720557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:01.860281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c83e11fd-cbe6-4c2d-9bef-7b5a53645efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8c3b2360>]}
[0m06:02:01.873488 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jwckbsky'
[0m06:02:01.873967 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:01.920721 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:01.921348 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:01.932648 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:01.936574 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:02.004455 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:02.004987 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:02.005493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c83e11fd-cbe6-4c2d-9bef-7b5a53645efd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8ce9c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8c5fb4a0>]}
[0m06:02:02.005958 [info ] [MainThread]: 
[0m06:02:02.006413 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:02.014365 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35732046, "process_user_time": 1.522712, "process_kernel_time": 0.142347, "process_mem_max_rss": "94240", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m06:02:02.014906 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:02.014805 after 0.36 seconds
[0m06:02:02.015327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8f4d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8b63dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a8c46d3d0>]}
[0m06:02:02.015774 [debug] [MainThread]: Flushing usage events
[0m06:02:03.459887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682060f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682048e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682060e480>]}


============================== 06:02:03.462706 | dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b ==============================
[0m06:02:03.462706 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.463350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:03.694950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f682048e3c0>]}
[0m06:02:03.753169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681fa57aa0>]}
[0m06:02:03.755490 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:03.822306 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:03.823012 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:03.823573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6820dfec30>]}
[0m06:02:05.092707 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.093357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681b99d940>]}
[0m06:02:05.274818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.280014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681b8ca780>]}
[0m06:02:05.411000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681b6fd6a0>]}
[0m06:02:05.411565 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:05.412092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681b8f2630>]}
[0m06:02:05.413770 [info ] [MainThread]: 
[0m06:02:05.414418 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.419123 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.453960 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.454406 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:05.454839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:06.042656 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:06.044392 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:06.045370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:06.045978 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:06.053213 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.053668 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:06.054145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.055094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.056579 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.056985 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:06.057617 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.058016 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.058392 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:06.058997 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.059938 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.060339 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.060739 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.061291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.061732 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:06.063089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:06.068836 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.069256 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:06.069652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.070270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.070697 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.071089 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:06.084843 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.086281 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.087477 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.087915 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.090092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681a1e6240>]}
[0m06:02:06.090616 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.091008 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.091380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.092001 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.092403 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.092804 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.093173 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.093729 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.094139 [debug] [MainThread]: On master: Close
[0m06:02:06.094678 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.095140 [info ] [MainThread]: 
[0m06:02:06.121153 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.121747 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.122303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:06.122769 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.148961 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.149715 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.184756 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.185472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:54.227452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:54.227994 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:06:54.228652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.229106 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:54.229535 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:06:54.230263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.233241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:54.233709 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:06:54.234378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.250875 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:54.251342 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:54.251824 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:54.252921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.257919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:54.258380 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:06:54.259605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.261921 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:06:54.263464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681bae0740>]}
[0m06:06:54.264160 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 288.14s]
[0m06:06:54.264943 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:06:54.265890 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:06:54.266452 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:06:54.267138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:06:54.267625 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:06:54.273283 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:06:54.273950 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:06:54.308843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:54.309360 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250312060654302882"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:06:54.309849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:54.318696 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.326321 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:54.326809 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:06:54.327468 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.327938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:54.328365 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250312060654302882'
      
      
      order by ordinal_position

  
[0m06:06:54.333104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.338124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:54.338665 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:54.341002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.348435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:54.348918 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:54.352237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.370251 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:06:54.370953 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:54.371414 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250312060654302882"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250312060654302882"
    )
  
[0m06:06:54.420857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.422872 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:54.423326 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:54.423771 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:54.431913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:54.432815 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:06:54.434362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec30eb2-a0db-4c10-8cb4-cbe194fe2e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fc328920>]}
[0m06:06:54.435052 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:06:54.435801 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:06:54.437189 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:54.437643 [debug] [MainThread]: On master: BEGIN
[0m06:06:54.438036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:06:54.438697 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:54.439110 [debug] [MainThread]: On master: COMMIT
[0m06:06:54.439484 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:54.439902 [debug] [MainThread]: On master: COMMIT
[0m06:06:54.440447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:54.440898 [debug] [MainThread]: On master: Close
[0m06:06:54.441466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:06:54.441875 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:06:54.442278 [info ] [MainThread]: 
[0m06:06:54.442792 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 49.03 seconds (289.03s).
[0m06:06:54.443743 [debug] [MainThread]: Command end result
[0m06:06:54.468944 [info ] [MainThread]: 
[0m06:06:54.469527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:06:54.470038 [info ] [MainThread]: 
[0m06:06:54.470558 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:06:54.471505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 291.06046, "process_user_time": 4.637843, "process_kernel_time": 0.263218, "process_mem_max_rss": "288780", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m06:06:54.472075 [debug] [MainThread]: Command `dbt run` succeeded at 06:06:54.471973 after 291.06 seconds
[0m06:06:54.472516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68201cdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681ffe8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681b8c96d0>]}
[0m06:06:54.472984 [debug] [MainThread]: Flushing usage events
[0m06:06:56.250381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e65b51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e56e2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e65b5040>]}


============================== 06:06:56.253343 | 7a5187ba-9a13-4d98-9979-8a0213b343c8 ==============================
[0m06:06:56.253343 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:06:56.254042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:06:56.397965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a5187ba-9a13-4d98-9979-8a0213b343c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e56d3c50>]}
[0m06:06:56.415997 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21521392, "process_user_time": 1.343985, "process_kernel_time": 0.092929, "process_mem_max_rss": "92816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:06:56.416511 [debug] [MainThread]: Command `dbt clean` succeeded at 06:06:56.416412 after 0.22 seconds
[0m06:06:56.416973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e95bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e56d3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e586d460>]}
[0m06:06:56.417395 [debug] [MainThread]: Flushing usage events
[0m14:05:49.535552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abc3ea630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abbf3b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abc3ea840>]}


============================== 14:05:49.558269 | 6101f945-ba6f-4591-8774-19252a368320 ==============================
[0m14:05:49.558269 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:49.558931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:49.705165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6101f945-ba6f-4591-8774-19252a368320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb9c16d0>]}
[0m14:05:49.718429 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5fziegjg'
[0m14:05:49.718919 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:49.786777 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:49.787377 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:49.820650 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:49.824532 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:50.206234 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:50.206802 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:50.207325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6101f945-ba6f-4591-8774-19252a368320', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb86ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abcb44ad0>]}
[0m14:05:50.207811 [info ] [MainThread]: 
[0m14:05:50.208281 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:50.215244 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7319991, "process_user_time": 1.494728, "process_kernel_time": 0.121221, "process_mem_max_rss": "94172", "process_in_blocks": "5720", "process_out_blocks": "4008"}
[0m14:05:50.215784 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:50.215683 after 0.73 seconds
[0m14:05:50.216206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abbb74bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb9d9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abbb6c4d0>]}
[0m14:05:50.216653 [debug] [MainThread]: Flushing usage events
[0m14:05:51.941810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5633e34d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56344242f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5633f5a330>]}


============================== 14:05:51.944681 | 5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f ==============================
[0m14:05:51.944681 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:51.945327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:52.176002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56339767b0>]}
[0m14:05:52.235309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5634b3c860>]}
[0m14:05:52.237755 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:52.273284 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:52.274022 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:52.274585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562fa2d430>]}
[0m14:05:53.550618 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:53.551257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562f737560>]}
[0m14:05:53.735268 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:53.778490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562f8c2d80>]}
[0m14:05:53.877593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562f717a10>]}
[0m14:05:53.878134 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:53.878657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562f764a70>]}
[0m14:05:53.880362 [info ] [MainThread]: 
[0m14:05:53.881074 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:53.885729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:53.920660 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:53.921102 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:53.921525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:54.535456 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:54.537038 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:54.538053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:54.538642 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:54.545958 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:54.546392 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:54.546810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:54.547743 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:54.549202 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:54.549626 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:54.550188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:54.550606 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:54.550992 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:54.551642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:54.552579 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:54.552984 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:54.553365 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:54.553954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:54.554366 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:54.555624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:54.561314 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:54.561762 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:54.562137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:54.562789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:54.563344 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:54.563829 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:54.577220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:54.578686 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:54.579934 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:54.580341 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:54.582707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562f765790>]}
[0m14:05:54.583207 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:54.583630 [debug] [MainThread]: On master: BEGIN
[0m14:05:54.584021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:54.584630 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:54.585038 [debug] [MainThread]: On master: COMMIT
[0m14:05:54.585436 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:54.585844 [debug] [MainThread]: On master: COMMIT
[0m14:05:54.586374 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:54.586806 [debug] [MainThread]: On master: Close
[0m14:05:54.587326 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:54.587813 [info ] [MainThread]: 
[0m14:05:54.609401 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:54.610001 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:54.610594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:54.611042 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:54.637712 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:54.638438 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:54.673844 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:54.674615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:48.306515 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:48.307018 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:48.307680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.308139 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:48.308601 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:48.309296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.312156 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:48.312622 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:48.313291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.329891 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:48.330365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:48.330821 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:48.332006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.336950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:48.337410 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:48.338781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.341076 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:48.342577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56181b5ac0>]}
[0m14:10:48.343263 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.73s]
[0m14:10:48.344045 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:48.344887 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:48.345594 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:48.346190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:48.346669 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:48.352227 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:48.352878 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:48.387845 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:48.388368 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250312141048381657"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:48.388878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:48.396917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.404272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:48.404751 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:48.405353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.405827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:48.406270 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250312141048381657'
      
      
      order by ordinal_position

  
[0m14:10:48.410602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.415643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:48.416116 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:48.418705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.426278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:48.426765 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:48.429185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.447244 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:48.447948 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:48.448412 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250312141048381657"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250312141048381657"
    )
  
[0m14:10:48.496758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.498796 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:48.499278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:48.499744 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:48.507843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:48.508768 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:48.510386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5474826e-d4e7-4b92-8b9f-bcd39f6e8a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5626d64aa0>]}
[0m14:10:48.511109 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:10:48.511937 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:48.513211 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:48.513672 [debug] [MainThread]: On master: BEGIN
[0m14:10:48.514059 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:48.514747 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:48.515157 [debug] [MainThread]: On master: COMMIT
[0m14:10:48.515577 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:48.515950 [debug] [MainThread]: On master: COMMIT
[0m14:10:48.516515 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:48.516917 [debug] [MainThread]: On master: Close
[0m14:10:48.517566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:48.517945 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:48.518349 [info ] [MainThread]: 
[0m14:10:48.518841 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.64 seconds (294.64s).
[0m14:10:48.519747 [debug] [MainThread]: Command end result
[0m14:10:48.544956 [info ] [MainThread]: 
[0m14:10:48.545523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:48.545983 [info ] [MainThread]: 
[0m14:10:48.546468 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:48.547364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.65576, "process_user_time": 4.624991, "process_kernel_time": 0.27141, "process_mem_max_rss": "298204", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m14:10:48.547920 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:48.547819 after 296.66 seconds
[0m14:10:48.548355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5633be4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5633981940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5633f5a6f0>]}
[0m14:10:48.548818 [debug] [MainThread]: Flushing usage events
[0m14:10:51.080292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36d4d7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36c776780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36e7a3590>]}


============================== 14:10:51.083139 | 020e26e3-a9f3-4872-958d-c4e3d29987a6 ==============================
[0m14:10:51.083139 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:51.083795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:10:51.222231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '020e26e3-a9f3-4872-958d-c4e3d29987a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36c0e5190>]}
[0m14:10:51.240168 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20968165, "process_user_time": 1.2756, "process_kernel_time": 0.123961, "process_mem_max_rss": "92816", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:10:51.240764 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:51.240658 after 0.21 seconds
[0m14:10:51.241195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36c1fc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36c655760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36c137110>]}
[0m14:10:51.241656 [debug] [MainThread]: Flushing usage events
[0m22:05:51.651283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec30a1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec4be36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec2ddffe0>]}


============================== 22:05:51.665649 | 9453b707-4cda-4ba1-b9db-aceb29c6c6fc ==============================
[0m22:05:51.665649 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:51.666365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:51.815985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9453b707-4cda-4ba1-b9db-aceb29c6c6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec23d9d60>]}
[0m22:05:51.829891 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6s0bvdpi'
[0m22:05:51.830479 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:51.895033 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:51.895804 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:51.907016 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:51.910982 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:51.955005 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:51.955657 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:51.956287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9453b707-4cda-4ba1-b9db-aceb29c6c6fc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec2402270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec2402c90>]}
[0m22:05:51.956751 [info ] [MainThread]: 
[0m22:05:51.957288 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:51.959414 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35733822, "process_user_time": 1.485887, "process_kernel_time": 0.110767, "process_mem_max_rss": "94412", "process_in_blocks": "5744", "process_out_blocks": "4008"}
[0m22:05:51.959945 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:51.959844 after 0.36 seconds
[0m22:05:51.960412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec2baa3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec23af290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec2e07f80>]}
[0m22:05:51.960836 [debug] [MainThread]: Flushing usage events
[0m22:05:53.391399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d1435cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d14e35670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d147066f0>]}


============================== 22:05:53.394455 | 96594b09-342e-42d7-bbbe-4458d96278f9 ==============================
[0m22:05:53.394455 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.395158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.624138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d15961280>]}
[0m22:05:53.682564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d1030e240>]}
[0m22:05:53.685079 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:53.737556 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:53.738354 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:53.738892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d103bf5f0>]}
[0m22:05:55.026726 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:55.027423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d10037aa0>]}
[0m22:05:55.236624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:55.285784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d100c2ae0>]}
[0m22:05:55.511705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0ff57560>]}
[0m22:05:55.512309 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:55.512786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d100eb020>]}
[0m22:05:55.515220 [info ] [MainThread]: 
[0m22:05:55.516004 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:55.522144 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:55.558769 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:55.559345 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:55.559772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:56.127272 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:56.129712 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:56.130865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:56.131720 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:56.143501 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:56.144174 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:56.144581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:56.145681 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.147174 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:56.147584 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:56.148199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.148602 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:56.148984 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:56.149603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.150559 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:56.150961 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:56.151360 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:56.151903 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.152409 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:56.153631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:56.159458 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:56.159875 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:56.160276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:56.160892 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.161330 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:56.161725 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:56.180719 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:56.183043 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:56.184974 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:56.185590 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:56.188184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d0ff482c0>]}
[0m22:05:56.188701 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:56.189082 [debug] [MainThread]: On master: BEGIN
[0m22:05:56.189481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:56.190131 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:56.190537 [debug] [MainThread]: On master: COMMIT
[0m22:05:56.190911 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:56.191303 [debug] [MainThread]: On master: COMMIT
[0m22:05:56.191837 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:56.192267 [debug] [MainThread]: On master: Close
[0m22:05:56.192782 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:56.193308 [info ] [MainThread]: 
[0m22:05:56.435406 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:56.436339 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:56.437007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:56.437489 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:56.468247 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:56.469218 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:56.509811 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:56.510705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:48.548314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:48.548817 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:48.549460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.549906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:48.550358 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:48.551035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.553973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:48.554438 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:48.555094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.571895 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:48.572383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:48.572815 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:48.574079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.579062 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:48.579543 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:48.580803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.583152 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:48.584659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d101ebf50>]}
[0m22:10:48.585343 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.15s]
[0m22:10:48.586181 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:48.586984 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:48.587576 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:48.588196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:48.588667 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:48.594450 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:48.595082 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:48.630207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:48.630702 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250312221048624178"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:48.631174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:48.639121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.646550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:48.647009 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:48.647623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.648067 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:48.648555 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250312221048624178'
      
      
      order by ordinal_position

  
[0m22:10:48.652848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.657932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:48.658416 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:48.661640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.669283 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:48.669747 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:48.672905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.691030 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:48.691716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:48.692205 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250312221048624178"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250312221048624178"
    )
  
[0m22:10:48.742975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.745020 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:48.745517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:48.745940 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:48.754906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:48.755900 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:48.757513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96594b09-342e-42d7-bbbe-4458d96278f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d103bec60>]}
[0m22:10:48.758224 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:48.758960 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:48.760544 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:48.760961 [debug] [MainThread]: On master: BEGIN
[0m22:10:48.761383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:48.762076 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:48.762509 [debug] [MainThread]: On master: COMMIT
[0m22:10:48.762886 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:48.763283 [debug] [MainThread]: On master: COMMIT
[0m22:10:48.763832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:48.764292 [debug] [MainThread]: On master: Close
[0m22:10:48.764899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:48.765292 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:48.765697 [info ] [MainThread]: 
[0m22:10:48.766227 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.25 seconds (293.25s).
[0m22:10:48.767182 [debug] [MainThread]: Command end result
[0m22:10:48.792630 [info ] [MainThread]: 
[0m22:10:48.793226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:48.793717 [info ] [MainThread]: 
[0m22:10:48.794230 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:48.795223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.45422, "process_user_time": 4.736325, "process_kernel_time": 0.27119, "process_mem_max_rss": "294408", "process_in_blocks": "3816", "process_out_blocks": "95568"}
[0m22:10:48.795736 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:48.795638 after 295.45 seconds
[0m22:10:48.796191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d141d8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce8149b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d1033dd00>]}
[0m22:10:48.796623 [debug] [MainThread]: Flushing usage events
[0m22:10:51.022432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e45ecb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e6a378c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e6a371d0>]}


============================== 22:10:51.025432 | a4169346-ac20-46ee-b5c8-7cdedc903f75 ==============================
[0m22:10:51.025432 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:51.026133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:51.168156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4169346-ac20-46ee-b5c8-7cdedc903f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e43d4e90>]}
[0m22:10:51.186303 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21398793, "process_user_time": 1.317132, "process_kernel_time": 0.096009, "process_mem_max_rss": "93084", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:51.186815 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:51.186714 after 0.21 seconds
[0m22:10:51.187267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e6a378c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e4388140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e438a180>]}
[0m22:10:51.187699 [debug] [MainThread]: Flushing usage events
[0m06:02:13.486327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d79752e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d8294890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d8238a40>]}


============================== 06:02:13.494454 | c27043af-051f-46e7-b980-de52fe8e200a ==============================
[0m06:02:13.494454 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.495164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.634537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c27043af-051f-46e7-b980-de52fe8e200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d7772630>]}
[0m06:02:13.647845 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rt3n7bop'
[0m06:02:13.648329 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.694433 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.695153 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.709026 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.712913 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.950149 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.950755 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:13.951361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c27043af-051f-46e7-b980-de52fe8e200a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d79752e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d8944dd0>]}
[0m06:02:13.951823 [info ] [MainThread]: 
[0m06:02:13.952358 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.959104 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5214821, "process_user_time": 1.482947, "process_kernel_time": 0.112147, "process_mem_max_rss": "94004", "process_in_blocks": "5744", "process_out_blocks": "4016"}
[0m06:02:13.959671 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.959570 after 0.52 seconds
[0m06:02:13.960133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45db8d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d76d6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d8002330>]}
[0m06:02:13.960564 [debug] [MainThread]: Flushing usage events
[0m06:02:15.654565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed9bf5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed9bf7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedb673b60>]}


============================== 06:02:15.657437 | 020cca8e-89ba-49c9-baa5-4c72f212b8a1 ==============================
[0m06:02:15.657437 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:15.658098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.911362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed95b3d70>]}
[0m06:02:15.973082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed8fc2b70>]}
[0m06:02:15.975530 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:16.053845 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:16.054739 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:16.055356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed511a480>]}
[0m06:02:17.386430 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:17.387116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed4f4dac0>]}
[0m06:02:17.574456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:17.625793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed4e6fbc0>]}
[0m06:02:17.906932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed4d3c410>]}
[0m06:02:17.907568 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:17.908167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed4d70d40>]}
[0m06:02:17.909918 [info ] [MainThread]: 
[0m06:02:17.910649 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:17.915411 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:17.954264 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:17.954762 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:17.955212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:18.511735 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:18.513316 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:18.514192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:18.514750 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:18.522159 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.522588 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:18.522976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.523834 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.525246 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.525655 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:18.526281 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.526681 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.527094 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:18.527714 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.528646 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.529061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.529443 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.529983 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.530409 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:18.531614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:18.537215 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.537626 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:18.538032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.538644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.539061 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.539451 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:18.553226 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.554663 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:18.555883 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:18.556310 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:18.558520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeda7a2f00>]}
[0m06:02:18.559065 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.559465 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.559843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:18.560463 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.560863 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.561272 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.561647 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.562211 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.562630 [debug] [MainThread]: On master: Close
[0m06:02:18.563332 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:18.563841 [info ] [MainThread]: 
[0m06:02:18.575089 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:18.575675 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:18.576337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:18.576785 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:18.603145 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:18.603874 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:18.639523 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:18.640258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:13.021683 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.022210 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:13.022838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.023307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.023741 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:13.024466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.027307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.027757 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:13.028440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.045115 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:13.045586 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.046042 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:13.047445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.052377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.052845 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:13.054176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.056479 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:13.057978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed37adf40>]}
[0m06:07:13.058672 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 294.48s]
[0m06:07:13.059465 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:13.060260 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:13.060835 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:13.061522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:13.061983 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:13.067674 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:13.068512 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:13.102816 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.103348 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250313060713096882"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:13.103820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:13.112686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.120051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.120511 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:13.121122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.121573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.122016 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250313060713096882'
      
      
      order by ordinal_position

  
[0m06:07:13.126402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.131403 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.131869 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:13.135073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.142478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.142938 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:13.145294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.162841 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:13.163541 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.164020 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250313060713096882"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250313060713096882"
    )
  
[0m06:07:13.212837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.214820 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:13.215289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.215707 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:13.224745 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.225650 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:13.227212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '020cca8e-89ba-49c9-baa5-4c72f212b8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb8142420>]}
[0m06:07:13.227898 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:13.228643 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:13.230183 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:13.230605 [debug] [MainThread]: On master: BEGIN
[0m06:07:13.231009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:13.231681 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:13.232108 [debug] [MainThread]: On master: COMMIT
[0m06:07:13.232492 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:13.232862 [debug] [MainThread]: On master: COMMIT
[0m06:07:13.233437 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:13.233834 [debug] [MainThread]: On master: Close
[0m06:07:13.234480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:13.234853 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:13.235285 [info ] [MainThread]: 
[0m06:07:13.235744 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 55.32 seconds (295.32s).
[0m06:07:13.236637 [debug] [MainThread]: Command end result
[0m06:07:13.261821 [info ] [MainThread]: 
[0m06:07:13.262407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:13.262860 [info ] [MainThread]: 
[0m06:07:13.263344 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:13.264269 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 297.65936, "process_user_time": 5.291828, "process_kernel_time": 0.276147, "process_mem_max_rss": "301508", "process_in_blocks": "3816", "process_out_blocks": "95544"}
[0m06:07:13.264791 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:13.264691 after 297.66 seconds
[0m06:07:13.265255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed9c7c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed4d71730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed95da7b0>]}
[0m06:07:13.265696 [debug] [MainThread]: Flushing usage events
[0m06:07:15.285310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4aabd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4a1b8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4a1bacc0>]}


============================== 06:07:15.288284 | feeac704-1238-4f23-a57b-f346e952a8a3 ==============================
[0m06:07:15.288284 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:15.288911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:07:15.429386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feeac704-1238-4f23-a57b-f346e952a8a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b1bb800>]}
[0m06:07:15.447316 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21175377, "process_user_time": 1.305758, "process_kernel_time": 0.110979, "process_mem_max_rss": "92828", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:15.447840 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:15.447741 after 0.21 seconds
[0m06:07:15.448316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4dfbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a49f2bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4a324a10>]}
[0m06:07:15.448749 [debug] [MainThread]: Flushing usage events
[0m14:05:27.432907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dbc37a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dbd92cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dbc37b30>]}


============================== 14:05:27.441933 | a53b1d91-8034-4fdf-87cf-63471dbaf4cc ==============================
[0m14:05:27.441933 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:27.442687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:27.606539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a53b1d91-8034-4fdf-87cf-63471dbaf4cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dbd932c0>]}
[0m14:05:27.621514 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n9v9174k'
[0m14:05:27.622096 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:27.681521 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:27.682361 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:27.692098 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:27.696433 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:27.741735 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:27.742402 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:27.743028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a53b1d91-8034-4fdf-87cf-63471dbaf4cc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dcc2b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dbc86fc0>]}
[0m14:05:27.743506 [info ] [MainThread]: 
[0m14:05:27.744038 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:27.745750 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3638797, "process_user_time": 1.618731, "process_kernel_time": 0.126978, "process_mem_max_rss": "94328", "process_in_blocks": "5744", "process_out_blocks": "4016"}
[0m14:05:27.746305 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:27.746203 after 0.36 seconds
[0m14:05:27.746743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dc6d2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dbaadd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dbaae6f0>]}
[0m14:05:27.747210 [debug] [MainThread]: Flushing usage events
[0m14:05:29.440038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a1a2f6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a1a19d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a19940620>]}


============================== 14:05:29.443480 | c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10 ==============================
[0m14:05:29.443480 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:29.444182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.705448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a19b44d10>]}
[0m14:05:29.770481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a1995efc0>]}
[0m14:05:29.773371 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:29.891139 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:29.892144 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:29.892708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a197138f0>]}
[0m14:05:31.295318 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:31.296006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a1546b950>]}
[0m14:05:31.501370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:31.571992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a155b97c0>]}
[0m14:05:31.662272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a15405040>]}
[0m14:05:31.662880 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:31.663443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a155e5880>]}
[0m14:05:31.665340 [info ] [MainThread]: 
[0m14:05:31.666152 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:31.671221 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:31.708901 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:31.709479 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:31.709887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:32.205676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.207423 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:32.208587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:32.209194 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:32.216837 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.217352 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:32.217749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:32.219021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.220646 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.221074 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:32.221739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.222165 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.222547 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:32.223156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.224129 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:32.224535 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.224914 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:32.225483 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.225902 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:32.227319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:32.233551 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:32.234039 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:32.234431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:32.235257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.235662 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:32.236081 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:32.250679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.252488 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:32.253794 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:32.254234 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:32.256718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a1544ca10>]}
[0m14:05:32.257314 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.257724 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.258150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:32.258921 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.259370 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.259762 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.260164 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.260744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.261192 [debug] [MainThread]: On master: Close
[0m14:05:32.261778 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:32.262358 [info ] [MainThread]: 
[0m14:05:32.274343 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:32.275058 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:32.275764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:32.276256 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:32.304111 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:32.305044 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:32.342519 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:32.343467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:36.988350 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:36.988927 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:12:36.989797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:36.990273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:36.990702 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:12:36.991540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:36.994784 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:36.995253 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:12:36.995994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.013020 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:37.013595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:37.014054 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:12:37.015488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.021113 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:12:37.021621 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:12:37.023136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.025690 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:12:37.027314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ec231430>]}
[0m14:12:37.028043 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 424.75s]
[0m14:12:37.028807 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:12:37.029761 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:12:37.030446 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:12:37.031056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:12:37.031502 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:12:37.036851 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:12:37.037554 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:12:37.074799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:37.075404 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250313141237068494"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:12:37.075874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.083576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.091847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:37.092393 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:12:37.093176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.093621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:37.094072 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250313141237068494'
      
      
      order by ordinal_position

  
[0m14:12:37.098946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.104611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:37.105153 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:37.107843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.115697 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:37.116195 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:12:37.118777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.137100 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:12:37.137879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:37.138377 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250313141237068494"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250313141237068494"
    )
  
[0m14:12:37.194738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.196784 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:37.197293 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:12:37.197731 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:12:37.204404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:37.205339 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:12:37.207006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d5c70b-16fc-420f-aaf3-7b99b8fb7d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ec3984a0>]}
[0m14:12:37.207696 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:12:37.208465 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:12:37.209798 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:37.210275 [debug] [MainThread]: On master: BEGIN
[0m14:12:37.210666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:37.211384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:37.211801 [debug] [MainThread]: On master: COMMIT
[0m14:12:37.212230 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:37.212609 [debug] [MainThread]: On master: COMMIT
[0m14:12:37.213214 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:37.213629 [debug] [MainThread]: On master: Close
[0m14:12:37.214257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:37.214646 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:12:37.215093 [info ] [MainThread]: 
[0m14:12:37.215634 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 7 minutes and 5.55 seconds (425.55s).
[0m14:12:37.216684 [debug] [MainThread]: Command end result
[0m14:12:37.243674 [info ] [MainThread]: 
[0m14:12:37.244417 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:37.244989 [info ] [MainThread]: 
[0m14:12:37.245538 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:12:37.246562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 427.8621, "process_user_time": 5.558327, "process_kernel_time": 0.320903, "process_mem_max_rss": "304108", "process_in_blocks": "3816", "process_out_blocks": "95456"}
[0m14:12:37.247123 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:37.247010 after 427.86 seconds
[0m14:12:37.247580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a19669220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f813ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a1575aea0>]}
[0m14:12:37.248049 [debug] [MainThread]: Flushing usage events
[0m14:12:39.012628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035842cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035842c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035842d1c0>]}


============================== 14:12:39.015810 | 6385cb95-1137-402f-9b84-84a009d1fc2a ==============================
[0m14:12:39.015810 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:12:39.016545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:12:39.171198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6385cb95-1137-402f-9b84-84a009d1fc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03586766f0>]}
[0m14:12:39.189504 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22840866, "process_user_time": 1.372735, "process_kernel_time": 0.115977, "process_mem_max_rss": "93052", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:39.190060 [debug] [MainThread]: Command `dbt clean` succeeded at 14:12:39.189928 after 0.23 seconds
[0m14:12:39.190513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035899bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03585d9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0358301bb0>]}
[0m14:12:39.190966 [debug] [MainThread]: Flushing usage events
[0m22:05:36.232473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12fe00e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ffc438f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12fde3a0c0>]}


============================== 22:05:36.240785 | 1937a19c-302a-43ce-9233-23f396bd5c63 ==============================
[0m22:05:36.240785 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:36.241501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:36.387816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1937a19c-302a-43ce-9233-23f396bd5c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12fd263bf0>]}
[0m22:05:36.401492 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6_m1mtgx'
[0m22:05:36.401968 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:36.592004 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:36.592817 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:36.654312 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:36.658534 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:36.781961 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:36.782583 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:36.783190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1937a19c-302a-43ce-9233-23f396bd5c63', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12fd40d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12fd40e990>]}
[0m22:05:36.783667 [info ] [MainThread]: 
[0m22:05:36.784197 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:36.785885 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.60299385, "process_user_time": 1.506086, "process_kernel_time": 0.11145, "process_mem_max_rss": "94576", "process_in_blocks": "5744", "process_out_blocks": "4016"}
[0m22:05:36.786445 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:36.786341 after 0.60 seconds
[0m22:05:36.786884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1300db8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12fd435e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12fd313a10>]}
[0m22:05:36.787349 [debug] [MainThread]: Flushing usage events
[0m22:05:38.310621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90c18e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90dba7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90c18d520>]}


============================== 22:05:38.313598 | 60b44330-4936-4588-8d92-f48445641c6f ==============================
[0m22:05:38.313598 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.314247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.546407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90b9dcc80>]}
[0m22:05:38.605875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90c713e00>]}
[0m22:05:38.608373 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:38.624618 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:38.625373 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:38.625931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90b59f230>]}
[0m22:05:39.912238 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:39.912858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc907436f90>]}
[0m22:05:40.099248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:40.146832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9074599d0>]}
[0m22:05:40.230051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90748c7a0>]}
[0m22:05:40.230625 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:40.231115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc907354a70>]}
[0m22:05:40.232858 [info ] [MainThread]: 
[0m22:05:40.233564 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:40.238213 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:40.274313 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:40.274774 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:40.275198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:40.801760 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:40.803406 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:40.804361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:40.804916 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:40.812465 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.812897 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:40.813307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.814213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.815657 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.816055 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:40.816650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.817041 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.817444 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:40.818020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.818968 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.819389 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.819764 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.820314 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.820719 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:40.821932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:40.827682 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.828091 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:40.828489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.829095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.829512 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.829899 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:40.843745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.845241 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:40.846537 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:40.846942 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:40.849456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9074e79b0>]}
[0m22:05:40.849981 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.850413 [debug] [MainThread]: On master: BEGIN
[0m22:05:40.850786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:40.851408 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.851813 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.852214 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.852586 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.853114 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.853535 [debug] [MainThread]: On master: Close
[0m22:05:40.854057 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:40.854590 [info ] [MainThread]: 
[0m22:05:40.866195 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.866790 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.867458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:40.867905 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.895049 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.895809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.932719 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.933470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:34.006311 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.006809 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:34.007453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.007901 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.008352 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:34.009048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.011938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.012404 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:34.013070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.029939 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:34.030431 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.030906 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:34.032080 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.037051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.037533 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:34.038872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.041287 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:34.042807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e02d49e0>]}
[0m22:10:34.043514 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.17s]
[0m22:10:34.044375 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:34.045296 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:34.045959 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:34.046609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:34.047063 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:34.052830 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:34.053504 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:34.089658 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.090259 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250313221034083449"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:34.090735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:34.099516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.107449 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.107909 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:34.108537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.108980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.109433 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250313221034083449'
      
      
      order by ordinal_position

  
[0m22:10:34.113839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.118909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.119392 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:34.122704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.130344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.130817 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:34.133824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.152020 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:34.152726 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.153209 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250313221034083449"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250313221034083449"
    )
  
[0m22:10:34.205087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.207112 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:34.207584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.208007 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:34.214943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.215838 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:34.217560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60b44330-4936-4588-8d92-f48445641c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9041b9640>]}
[0m22:10:34.218261 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:34.219083 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:34.220470 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:34.220891 [debug] [MainThread]: On master: BEGIN
[0m22:10:34.221316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:34.221957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:34.222415 [debug] [MainThread]: On master: COMMIT
[0m22:10:34.222796 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:34.223198 [debug] [MainThread]: On master: COMMIT
[0m22:10:34.223752 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:34.224174 [debug] [MainThread]: On master: Close
[0m22:10:34.224795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:34.225198 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:34.225609 [info ] [MainThread]: 
[0m22:10:34.226066 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.99 seconds (293.99s).
[0m22:10:34.226962 [debug] [MainThread]: Command end result
[0m22:10:34.251841 [info ] [MainThread]: 
[0m22:10:34.252409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:34.252863 [info ] [MainThread]: 
[0m22:10:34.253375 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:34.254315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.9944, "process_user_time": 5.207232, "process_kernel_time": 0.291124, "process_mem_max_rss": "302148", "process_in_blocks": "3816", "process_out_blocks": "95560"}
[0m22:10:34.254840 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:34.254741 after 295.99 seconds
[0m22:10:34.255303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc90dba7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8fdaa8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc905dbaab0>]}
[0m22:10:34.255744 [debug] [MainThread]: Flushing usage events
[0m22:10:35.915871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa95e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa95d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aa95f1d0>]}


============================== 22:10:35.918965 | bbb1cb03-64fc-4395-b966-ee3fb831f38a ==============================
[0m22:10:35.918965 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:35.919643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:36.061648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbb1cb03-64fc-4395-b966-ee3fb831f38a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aafc0d70>]}
[0m22:10:36.079495 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21423219, "process_user_time": 1.318847, "process_kernel_time": 0.109987, "process_mem_max_rss": "92956", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:36.080013 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:36.079914 after 0.21 seconds
[0m22:10:36.080477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aac09fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ac3e99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16aabc3d70>]}
[0m22:10:36.080916 [debug] [MainThread]: Flushing usage events
[0m06:02:07.631926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d6dd3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d6d8fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d6d8fad0>]}


============================== 06:02:07.640267 | 154c7cc6-2e94-4f4d-9057-593b45139101 ==============================
[0m06:02:07.640267 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.640944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.789681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154c7cc6-2e94-4f4d-9057-593b45139101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d6bb24e0>]}
[0m06:02:07.803677 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-143fwn1b'
[0m06:02:07.804202 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.921452 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.922240 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.979745 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.983928 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:08.034691 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:08.035322 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:08.035909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '154c7cc6-2e94-4f4d-9057-593b45139101', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d7d3d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d6dd3f50>]}
[0m06:02:08.036376 [info ] [MainThread]: 
[0m06:02:08.036915 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:08.043819 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46147808, "process_user_time": 1.572783, "process_kernel_time": 0.12414, "process_mem_max_rss": "94196", "process_in_blocks": "5744", "process_out_blocks": "4024"}
[0m06:02:08.044358 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:08.044255 after 0.46 seconds
[0m06:02:08.044819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d706b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d71eb6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89d7f4b7a0>]}
[0m06:02:08.045259 [debug] [MainThread]: Flushing usage events
[0m06:02:09.567171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690ae3eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690afc5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690ae3d700>]}


============================== 06:02:09.570145 | 707f30f3-9bc1-4863-a87a-b23959cdb67e ==============================
[0m06:02:09.570145 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.570887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.802241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690bd135c0>]}
[0m06:02:09.860640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690acd3920>]}
[0m06:02:09.863104 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:09.927269 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.927989 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.928524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690a95d670>]}
[0m06:02:11.207641 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.208268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690673f560>]}
[0m06:02:11.390491 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.434365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690c0b2480>]}
[0m06:02:11.517386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690671f7a0>]}
[0m06:02:11.517972 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:11.518477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690677a300>]}
[0m06:02:11.520261 [info ] [MainThread]: 
[0m06:02:11.520960 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.525681 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.561461 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.561949 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.562394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.038086 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.039802 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.040906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.041569 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.049168 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.049604 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.050019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.051050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.052541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.052989 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.053609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.054067 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.054473 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.055094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.056026 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.056427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.056846 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.057397 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.057849 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.059102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.064872 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.065283 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.065655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.066288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.066684 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.067095 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.081139 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.082590 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.083858 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.084271 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.086501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6906739220>]}
[0m06:02:12.087046 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.087459 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.087873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.088501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.088949 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.089348 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.089751 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.090319 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.090762 [debug] [MainThread]: On master: Close
[0m06:02:12.091293 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.091837 [info ] [MainThread]: 
[0m06:02:12.103083 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.103657 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.104315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:12.104786 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.131190 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.131941 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.167832 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.168562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:02.384538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:02.385069 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:02.385759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.386213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:02.386642 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:02.387369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.390224 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:02.390671 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:02.391356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.407662 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:02.408162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:02.408591 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:02.409843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.414813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:02.415273 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:02.416456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.418781 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:02.420292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690c1602f0>]}
[0m06:07:02.420988 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 290.32s]
[0m06:07:02.421842 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:02.422617 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:02.423195 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:02.423852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:02.424306 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:02.430049 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:02.430871 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:02.465700 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:02.466238 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250314060702459751"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:02.466738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:02.474809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.482227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:02.482683 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:02.483356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.483818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:02.484264 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250314060702459751'
      
      
      order by ordinal_position

  
[0m06:07:02.488654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.493618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:02.494102 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:02.497282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.504769 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:02.505238 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:02.508301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.526150 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:02.526847 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:02.527308 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250314060702459751"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250314060702459751"
    )
  
[0m06:07:02.576281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.578297 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:02.578819 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:02.579259 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:02.585961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:02.586869 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:02.588543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707f30f3-9bc1-4863-a87a-b23959cdb67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69067881a0>]}
[0m06:07:02.589237 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:02.589990 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:02.591341 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:02.591813 [debug] [MainThread]: On master: BEGIN
[0m06:07:02.592225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:02.592939 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:02.593371 [debug] [MainThread]: On master: COMMIT
[0m06:07:02.593813 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:02.594216 [debug] [MainThread]: On master: COMMIT
[0m06:07:02.594803 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:02.595229 [debug] [MainThread]: On master: Close
[0m06:07:02.595849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:02.596262 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:02.596694 [info ] [MainThread]: 
[0m06:07:02.597256 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 51.08 seconds (291.08s).
[0m06:07:02.598273 [debug] [MainThread]: Command end result
[0m06:07:02.624037 [info ] [MainThread]: 
[0m06:07:02.624660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:02.625222 [info ] [MainThread]: 
[0m06:07:02.625787 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:02.626810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.11237, "process_user_time": 5.159861, "process_kernel_time": 0.257342, "process_mem_max_rss": "300780", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m06:07:02.627337 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:02.627241 after 293.11 seconds
[0m06:07:02.627807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690abab950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f690abee570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e83e8050>]}
[0m06:07:02.628245 [debug] [MainThread]: Flushing usage events
[0m06:07:04.252021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc526ee660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc52b22450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc522ab8c0>]}


============================== 06:07:04.254941 | bcb69ab6-ebb5-460b-921b-94efce543481 ==============================
[0m06:07:04.254941 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:04.255585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:07:04.399398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcb69ab6-ebb5-460b-921b-94efce543481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc522ecc80>]}
[0m06:07:04.417160 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21503104, "process_user_time": 1.300412, "process_kernel_time": 0.120038, "process_mem_max_rss": "92844", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:04.417678 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:04.417577 after 0.22 seconds
[0m06:07:04.418163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc561bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc522ecc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc52c8bf80>]}
[0m06:07:04.418595 [debug] [MainThread]: Flushing usage events
[0m14:05:12.462740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bbdc4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bc172330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bc172480>]}


============================== 14:05:12.474591 | 15069745-6cd7-442a-b32c-a0f0c0be215a ==============================
[0m14:05:12.474591 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.475260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.616721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15069745-6cd7-442a-b32c-a0f0c0be215a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bb8e9b80>]}
[0m14:05:12.630230 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5cqj85cl'
[0m14:05:12.630680 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:12.721618 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:12.722284 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:12.730974 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:12.734913 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:12.777904 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:12.778444 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:12.778967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '15069745-6cd7-442a-b32c-a0f0c0be215a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bb87d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bb87e000>]}
[0m14:05:12.779433 [info ] [MainThread]: 
[0m14:05:12.779907 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:12.785287 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37176377, "process_user_time": 1.481051, "process_kernel_time": 0.134913, "process_mem_max_rss": "94108", "process_in_blocks": "5744", "process_out_blocks": "4008"}
[0m14:05:12.785822 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:12.785720 after 0.37 seconds
[0m14:05:12.786275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bb8e9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bc966b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bc966f30>]}
[0m14:05:12.786698 [debug] [MainThread]: Flushing usage events
[0m14:05:14.219731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b92b56390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b937a79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b92bdee40>]}


============================== 14:05:14.222635 | 283d40a1-3a73-435e-8734-96163663fa30 ==============================
[0m14:05:14.222635 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.223330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:14.453069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b929439b0>]}
[0m14:05:14.512022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b92979190>]}
[0m14:05:14.514597 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:14.655084 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:14.656054 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:14.656668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9296efc0>]}
[0m14:05:16.003854 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:16.004541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8e6741a0>]}
[0m14:05:16.198012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:16.250871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8e7e14c0>]}
[0m14:05:16.366325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8e62d9a0>]}
[0m14:05:16.366960 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:16.367588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8e7bb050>]}
[0m14:05:16.369348 [info ] [MainThread]: 
[0m14:05:16.370080 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:16.374840 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:16.410972 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:16.411449 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:16.411848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:17.164225 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:17.165856 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:17.166918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:17.167508 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:17.174932 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.175389 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:17.175801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:17.176764 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.178248 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.178650 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:17.179245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.179642 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.180030 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:17.180634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.181598 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:17.182005 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.182422 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:17.182968 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.183399 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:17.184692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:17.190431 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:17.190850 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:17.191245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:17.191858 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.192275 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:17.192660 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:17.206392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.207895 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:17.209144 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:17.209563 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:17.211775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8e684950>]}
[0m14:05:17.212318 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.212713 [debug] [MainThread]: On master: BEGIN
[0m14:05:17.213091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:17.213764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.214201 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.214597 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.214968 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.215529 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.215930 [debug] [MainThread]: On master: Close
[0m14:05:17.216489 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:17.216994 [info ] [MainThread]: 
[0m14:05:17.228155 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:17.228759 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:17.229422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:17.229872 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:17.256717 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:17.257604 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:17.293302 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:17.294135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:08.422180 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:08.422684 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:08.423322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.423765 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:08.424221 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:08.424908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.427786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:08.428256 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:08.428926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.445323 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:08.445797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:08.446252 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:08.447665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.452612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:08.453080 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:08.454314 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.456637 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:08.458171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b849272f0>]}
[0m14:10:08.458846 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.23s]
[0m14:10:08.459623 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:08.460533 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:08.461210 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:08.461804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:08.462274 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:08.467990 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:08.468687 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:08.503461 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:08.503952 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250314141008497504"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:08.504433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:08.512262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.519613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:08.520070 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:08.520695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.521153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:08.521589 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250314141008497504'
      
      
      order by ordinal_position

  
[0m14:10:08.525989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.530995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:08.531483 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:08.533793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.541216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:08.541682 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:08.543968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.561941 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:08.562780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:08.563273 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250314141008497504"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250314141008497504"
    )
  
[0m14:10:08.616710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.618697 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:08.619163 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:08.619587 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:08.626025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:08.626919 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:08.628520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283d40a1-3a73-435e-8734-96163663fa30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b69f8ef90>]}
[0m14:10:08.629220 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:08.629952 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:08.631273 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:08.631694 [debug] [MainThread]: On master: BEGIN
[0m14:10:08.632077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:08.632752 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:08.633177 [debug] [MainThread]: On master: COMMIT
[0m14:10:08.633560 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:08.633927 [debug] [MainThread]: On master: COMMIT
[0m14:10:08.634511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:08.634901 [debug] [MainThread]: On master: Close
[0m14:10:08.635579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:08.635950 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:08.636375 [info ] [MainThread]: 
[0m14:10:08.636872 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.27 seconds (292.27s).
[0m14:10:08.637814 [debug] [MainThread]: Command end result
[0m14:10:08.662942 [info ] [MainThread]: 
[0m14:10:08.663581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:08.664076 [info ] [MainThread]: 
[0m14:10:08.664602 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:08.665558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.4956, "process_user_time": 4.723761, "process_kernel_time": 0.292542, "process_mem_max_rss": "286460", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m14:10:08.666081 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:08.665982 after 294.50 seconds
[0m14:10:08.666555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b937a79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b928c5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b7f30d5b0>]}
[0m14:10:08.666996 [debug] [MainThread]: Flushing usage events
[0m14:10:10.313892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0b6ee6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0acaf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0b522780>]}


============================== 14:10:10.316779 | 5611e534-03f4-4c9c-9b16-e0a30de88bee ==============================
[0m14:10:10.316779 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:10.317448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:10:10.455381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5611e534-03f4-4c9c-9b16-e0a30de88bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0b581bb0>]}
[0m14:10:10.473069 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2087866, "process_user_time": 1.294285, "process_kernel_time": 0.113024, "process_mem_max_rss": "92836", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:10.473600 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:10.473501 after 0.21 seconds
[0m14:10:10.474044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0a9c7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0acf3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0acf3cb0>]}
[0m14:10:10.474502 [debug] [MainThread]: Flushing usage events
[0m22:05:37.289042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0787843a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0785c70860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0785574770>]}


============================== 22:05:37.300758 | 0f221c24-bd3d-46bf-b141-b4c27ec1138a ==============================
[0m22:05:37.300758 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.301469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.442997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f221c24-bd3d-46bf-b141-b4c27ec1138a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0784e479e0>]}
[0m22:05:37.456438 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2h1vzxcd'
[0m22:05:37.456895 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:37.505322 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:37.505969 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:37.517134 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:37.521107 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:37.735539 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:37.736127 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:37.736729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0f221c24-bd3d-46bf-b141-b4c27ec1138a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f078501bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0785018ce0>]}
[0m22:05:37.737220 [info ] [MainThread]: 
[0m22:05:37.737729 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:37.743350 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50519156, "process_user_time": 1.510434, "process_kernel_time": 0.109958, "process_mem_max_rss": "94420", "process_in_blocks": "5744", "process_out_blocks": "4024"}
[0m22:05:37.743879 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:37.743777 after 0.51 seconds
[0m22:05:37.744335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07890d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0787843a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0784ec9070>]}
[0m22:05:37.744758 [debug] [MainThread]: Flushing usage events
[0m22:05:39.464162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6024af7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60240d7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60240d4c80>]}


============================== 22:05:39.467102 | 12841072-8ea2-4870-839f-bda7a244b72d ==============================
[0m22:05:39.467102 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:39.467802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:39.701734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60255eb890>]}
[0m22:05:39.760386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60256a30e0>]}
[0m22:05:39.762883 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:39.803934 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:39.804649 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:39.805198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601ff3d2b0>]}
[0m22:05:41.083530 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:41.084220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601fc7a1b0>]}
[0m22:05:41.267859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:41.319697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601fd73980>]}
[0m22:05:41.401023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601fc38230>]}
[0m22:05:41.401561 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:41.402095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601fc78680>]}
[0m22:05:41.403816 [info ] [MainThread]: 
[0m22:05:41.404553 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:41.409161 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:41.444346 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:41.444796 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:41.445239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:41.965597 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:41.967186 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:41.968069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:41.968621 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:41.976120 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.976548 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:41.976958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:41.978046 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.979529 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.979958 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:41.980554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.980980 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.981359 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:41.981977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.982879 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:41.983302 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.983676 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:41.984237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.984638 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:41.985823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:41.991471 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:41.991884 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:41.992288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:41.992903 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.993328 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:41.993716 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:42.007704 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:42.009169 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:42.010396 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:42.010808 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:42.013274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601fc49610>]}
[0m22:05:42.013780 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.014206 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.014579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:42.015186 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.015588 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.015991 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.016360 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.016884 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.017302 [debug] [MainThread]: On master: Close
[0m22:05:42.017821 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:42.018342 [info ] [MainThread]: 
[0m22:05:42.034101 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:42.034696 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:42.035351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:42.035798 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:42.062258 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:42.063017 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:42.099204 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:42.100021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:35.864645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:35.865179 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:35.865820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.866276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:35.866696 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:35.867409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.870332 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:35.870785 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:35.871474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.887893 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:35.888377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:35.888805 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:35.890096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.894989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:35.895454 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:35.896805 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.899109 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:35.900591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f602566c0e0>]}
[0m22:10:35.901275 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.86s]
[0m22:10:35.902119 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:35.903041 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:35.903691 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:35.904276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:35.904720 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:35.910347 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:35.911039 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:35.945710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.946232 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250314221035939687"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:35.946711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:35.954652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.962115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.962567 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:35.963194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.963631 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.964093 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250314221035939687'
      
      
      order by ordinal_position

  
[0m22:10:35.968539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.973548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.974032 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:35.976381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.983762 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.984241 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:35.987515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:36.005262 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:36.005964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:36.006428 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250314221035939687"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250314221035939687"
    )
  
[0m22:10:36.059515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:36.061505 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:36.061969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:36.062395 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:36.069145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:36.070059 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:36.071564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12841072-8ea2-4870-839f-bda7a244b72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ff8122240>]}
[0m22:10:36.072262 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:36.073001 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:36.074295 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:36.074719 [debug] [MainThread]: On master: BEGIN
[0m22:10:36.075136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:36.075788 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:36.076221 [debug] [MainThread]: On master: COMMIT
[0m22:10:36.076602 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:36.077002 [debug] [MainThread]: On master: COMMIT
[0m22:10:36.077545 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:36.077977 [debug] [MainThread]: On master: Close
[0m22:10:36.078568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:36.078959 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:36.079418 [info ] [MainThread]: 
[0m22:10:36.079882 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.67 seconds (294.67s).
[0m22:10:36.080800 [debug] [MainThread]: Command end result
[0m22:10:36.106424 [info ] [MainThread]: 
[0m22:10:36.107052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:36.107510 [info ] [MainThread]: 
[0m22:10:36.107992 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:36.108948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.69458, "process_user_time": 5.175032, "process_kernel_time": 0.27884, "process_mem_max_rss": "298576", "process_in_blocks": "3816", "process_out_blocks": "95560"}
[0m22:10:36.109470 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:36.109370 after 296.70 seconds
[0m22:10:36.109925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6027fbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f601e7a6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ff9facbc0>]}
[0m22:10:36.110369 [debug] [MainThread]: Flushing usage events
[0m22:10:38.017237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbc6269250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbc88b9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbc63ccc20>]}


============================== 22:10:38.020161 | d6bf88a8-c96a-45a8-ab95-2b4117888430 ==============================
[0m22:10:38.020161 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:38.020816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:38.162254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6bf88a8-c96a-45a8-ab95-2b4117888430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbc61b4e90>]}
[0m22:10:38.180374 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21336947, "process_user_time": 1.339256, "process_kernel_time": 0.095018, "process_mem_max_rss": "92972", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:10:38.180898 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:38.180797 after 0.21 seconds
[0m22:10:38.181372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbc6ec9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbc62028d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbc6202f30>]}
[0m22:10:38.181810 [debug] [MainThread]: Flushing usage events
[0m06:02:04.007266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fa07f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fc6e3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fa454fe0>]}


============================== 06:02:04.015376 | b8bc39f0-aa79-41b9-bd41-8b5c737c1a42 ==============================
[0m06:02:04.015376 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:04.016062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.162402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8bc39f0-aa79-41b9-bd41-8b5c737c1a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f9e7df10>]}
[0m06:02:04.176846 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-54hbu9ds'
[0m06:02:04.177357 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:04.319385 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:04.320235 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:04.344391 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:04.348617 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:04.423053 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:04.423647 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:04.424198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b8bc39f0-aa79-41b9-bd41-8b5c737c1a42', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f9e15730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f9e15940>]}
[0m06:02:04.424680 [info ] [MainThread]: 
[0m06:02:04.425162 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:04.426849 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4686862, "process_user_time": 1.498066, "process_kernel_time": 0.124005, "process_mem_max_rss": "94372", "process_in_blocks": "5744", "process_out_blocks": "4024"}
[0m06:02:04.427379 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:04.427278 after 0.47 seconds
[0m06:02:04.427839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f9ed5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fb1cb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fa0c13d0>]}
[0m06:02:04.428275 [debug] [MainThread]: Flushing usage events
[0m06:02:05.963321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74a2ed5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74b56f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74a2ed940>]}


============================== 06:02:05.966343 | ed286e9b-4878-4126-abc1-a53746835070 ==============================
[0m06:02:05.966343 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.967063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.193801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74a3a1580>]}
[0m06:02:06.251845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74b51bb60>]}
[0m06:02:06.254304 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:06.270162 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:06.270873 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:06.271406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74641d550>]}
[0m06:02:07.551961 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:07.552600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe746210560>]}
[0m06:02:07.735165 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:07.784992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74626f590>]}
[0m06:02:07.868276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7461383e0>]}
[0m06:02:07.868873 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:07.869359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74616c980>]}
[0m06:02:07.871112 [info ] [MainThread]: 
[0m06:02:07.871825 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:07.876491 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:07.912176 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:07.912690 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:07.913085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:08.403930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.405804 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:08.406913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:08.407620 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:08.416655 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.417086 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:08.417472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:08.418445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.419863 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.420272 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:08.420851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.421242 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.421655 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:08.422257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.423198 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:08.423612 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.423995 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:08.424567 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.424973 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:08.426165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:08.431760 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:08.432167 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:08.432534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:08.433187 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.433608 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:08.434004 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:08.448659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.450124 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:08.451350 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:08.451771 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:08.453977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74616fc20>]}
[0m06:02:08.454484 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:08.454921 [debug] [MainThread]: On master: BEGIN
[0m06:02:08.455290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:08.455897 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:08.456299 [debug] [MainThread]: On master: COMMIT
[0m06:02:08.456703 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:08.457079 [debug] [MainThread]: On master: COMMIT
[0m06:02:08.457617 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:08.458029 [debug] [MainThread]: On master: Close
[0m06:02:08.458573 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:08.459093 [info ] [MainThread]: 
[0m06:02:08.470318 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:08.470929 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:08.471583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:08.472033 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:08.498417 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:08.499167 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:08.535644 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:08.536370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:01.340427 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.340953 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:01.341636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.342085 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.342510 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:01.343220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.346057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.346512 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:01.347238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.363352 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:01.363833 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.364259 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:01.365716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.370540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:01.371013 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:01.372442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.374731 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:01.376207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74bb642c0>]}
[0m06:07:01.376889 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.90s]
[0m06:07:01.377667 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:01.378428 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:01.379001 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:01.379612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:01.380071 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:01.385627 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:01.386411 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:01.420359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.420872 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250315060701414495"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:01.421336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:01.429541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.436797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.437250 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:01.437860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.438294 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.438752 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250315060701414495'
      
      
      order by ordinal_position

  
[0m06:07:01.443121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.448023 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.448487 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:01.450767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.458122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.458603 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:01.462016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.479622 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:01.480318 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.480826 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250315060701414495"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250315060701414495"
    )
  
[0m06:07:01.529496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.531466 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:01.531938 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.532359 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:01.539869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.540764 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:01.542476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed286e9b-4878-4126-abc1-a53746835070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71c580c50>]}
[0m06:07:01.543180 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:01.544001 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:01.545273 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:01.545733 [debug] [MainThread]: On master: BEGIN
[0m06:07:01.546123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:01.546770 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:01.547175 [debug] [MainThread]: On master: COMMIT
[0m06:07:01.547589 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:01.547974 [debug] [MainThread]: On master: COMMIT
[0m06:07:01.548491 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:01.548932 [debug] [MainThread]: On master: Close
[0m06:07:01.549530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:01.549924 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:01.550325 [info ] [MainThread]: 
[0m06:07:01.550815 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.68 seconds (293.68s).
[0m06:07:01.551721 [debug] [MainThread]: Command end result
[0m06:07:01.576689 [info ] [MainThread]: 
[0m06:07:01.577239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:01.577720 [info ] [MainThread]: 
[0m06:07:01.578183 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:01.579085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.6651, "process_user_time": 5.124138, "process_kernel_time": 0.26026, "process_mem_max_rss": "302612", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m06:07:01.579635 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:01.579501 after 295.67 seconds
[0m06:07:01.580074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74c9313d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74a6987a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74b56f5f0>]}
[0m06:07:01.580498 [debug] [MainThread]: Flushing usage events
[0m06:07:03.277000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e698b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e7ef0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e698cb0>]}


============================== 06:07:03.279937 | 1b858109-269e-415e-853c-d4677ac0e6bd ==============================
[0m06:07:03.279937 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:03.280604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:07:03.420324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b858109-269e-415e-853c-d4677ac0e6bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9f649a90>]}
[0m06:07:03.437929 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21025835, "process_user_time": 1.307568, "process_kernel_time": 0.097967, "process_mem_max_rss": "92636", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:03.438431 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:03.438335 after 0.21 seconds
[0m06:07:03.438890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9f335ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e4efbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9eee9ac0>]}
[0m06:07:03.439326 [debug] [MainThread]: Flushing usage events
[0m14:05:42.509469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121f713aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121fdc0d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121f2e2960>]}


============================== 14:05:42.516993 | cbeb762a-bf39-4437-ae75-24944e52aad8 ==============================
[0m14:05:42.516993 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:42.517653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:42.659188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbeb762a-bf39-4437-ae75-24944e52aad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121ef1ed80>]}
[0m14:05:42.672696 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-khv614p0'
[0m14:05:42.673179 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:42.820478 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:42.821144 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:42.831791 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:42.835634 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:42.911750 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:42.912288 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:42.912803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cbeb762a-bf39-4437-ae75-24944e52aad8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121fc48ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121fc48350>]}
[0m14:05:42.913283 [info ] [MainThread]: 
[0m14:05:42.913765 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:42.915449 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4545695, "process_user_time": 1.481309, "process_kernel_time": 0.114946, "process_mem_max_rss": "94316", "process_in_blocks": "5744", "process_out_blocks": "4008"}
[0m14:05:42.915967 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:42.915868 after 0.46 seconds
[0m14:05:42.916443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12212f78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121ef1ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121ea75970>]}
[0m14:05:42.916861 [debug] [MainThread]: Flushing usage events
[0m14:05:44.383312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4f6f6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a51a88ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4fba6bd0>]}


============================== 14:05:44.386147 | d4766812-8000-4e66-aba1-69878b562705 ==============================
[0m14:05:44.386147 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:44.386834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:44.612818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5052f920>]}
[0m14:05:44.673625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4f8fec00>]}
[0m14:05:44.676503 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:44.723078 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:44.724209 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:44.724940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b5aa210>]}
[0m14:05:46.075529 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:46.076208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b45a000>]}
[0m14:05:46.272711 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:46.328828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b27a480>]}
[0m14:05:46.566562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b1134d0>]}
[0m14:05:46.567179 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:46.567771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b2e0e60>]}
[0m14:05:46.569891 [info ] [MainThread]: 
[0m14:05:46.570735 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:46.576863 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:46.613614 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:46.614088 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:46.614499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:47.499944 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:47.501554 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:47.502646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:47.503382 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:47.510572 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:47.511001 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:47.511430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:47.512285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:47.513695 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:47.514117 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:47.514680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:47.515091 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:47.515471 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:47.516096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:47.516991 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:47.517406 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:47.517779 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:47.518347 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:47.518742 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:47.519921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:47.525495 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:47.525912 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:47.526309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:47.526918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:47.527338 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:47.527725 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:47.541294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:47.542717 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:47.543944 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:47.544394 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:47.546559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4b179670>]}
[0m14:05:47.547094 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:47.547487 [debug] [MainThread]: On master: BEGIN
[0m14:05:47.547845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:47.548445 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:47.548838 [debug] [MainThread]: On master: COMMIT
[0m14:05:47.549233 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:47.549598 [debug] [MainThread]: On master: COMMIT
[0m14:05:47.550155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:47.550550 [debug] [MainThread]: On master: Close
[0m14:05:47.551073 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:47.551580 [info ] [MainThread]: 
[0m14:05:47.562435 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:47.563015 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:47.563670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:47.564137 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:47.590327 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:47.591069 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:47.625770 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:47.626501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:35.314359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.314851 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:35.315490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.315929 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.316374 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:35.317083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.319873 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.320335 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:35.320997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.337109 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:35.337576 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.338006 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:35.339273 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.344125 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:35.344582 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:35.345889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.348178 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:35.349650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a49bb9fd0>]}
[0m14:10:35.350329 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 287.79s]
[0m14:10:35.351085 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:35.351880 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:35.352462 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:35.353066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:35.353526 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:35.359174 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:35.359795 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:35.394044 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.394548 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250315141035388128"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:35.395001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:35.402616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.409711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.410180 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:35.410766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.411222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.411645 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250315141035388128'
      
      
      order by ordinal_position

  
[0m14:10:35.415981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.420945 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.421423 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:35.423698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.431036 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.431514 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:35.434017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.451628 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:35.452288 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.452744 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250315141035388128"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250315141035388128"
    )
  
[0m14:10:35.503934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.505921 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:35.506404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:35.506824 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:35.513747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:35.514651 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:35.516251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4766812-8000-4e66-aba1-69878b562705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a40148d70>]}
[0m14:10:35.516922 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:10:35.517742 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:35.519113 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:35.519533 [debug] [MainThread]: On master: BEGIN
[0m14:10:35.519913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:35.520585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:35.520987 [debug] [MainThread]: On master: COMMIT
[0m14:10:35.521399 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:35.521773 [debug] [MainThread]: On master: COMMIT
[0m14:10:35.522340 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:35.522732 [debug] [MainThread]: On master: Close
[0m14:10:35.523364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:35.523738 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:35.524167 [info ] [MainThread]: 
[0m14:10:35.524629 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 48.95 seconds (288.95s).
[0m14:10:35.525526 [debug] [MainThread]: Command end result
[0m14:10:35.550643 [info ] [MainThread]: 
[0m14:10:35.551199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:35.551657 [info ] [MainThread]: 
[0m14:10:35.552133 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:35.553025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 291.21918, "process_user_time": 4.705609, "process_kernel_time": 0.284157, "process_mem_max_rss": "289712", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m14:10:35.553562 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:35.553464 after 291.22 seconds
[0m14:10:35.553998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a519efa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4ffc3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a4f9a5dc0>]}
[0m14:10:35.554461 [debug] [MainThread]: Flushing usage events
[0m14:10:37.275822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4cb8ea6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4cb721af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ccd5d250>]}


============================== 14:10:37.278658 | 7267fb3c-78d3-4298-87b9-c6ed38e04286 ==============================
[0m14:10:37.278658 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:37.279363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:37.418757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7267fb3c-78d3-4298-87b9-c6ed38e04286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ccd1a3f0>]}
[0m14:10:37.436628 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21028015, "process_user_time": 1.297481, "process_kernel_time": 0.094962, "process_mem_max_rss": "93088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:37.437270 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:37.437026 after 0.21 seconds
[0m14:10:37.437698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4cabd1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ca4b3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ca62af30>]}
[0m14:10:37.438145 [debug] [MainThread]: Flushing usage events
[0m22:05:37.900575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c04163ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c05b119d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c04163e00>]}


============================== 22:05:37.908677 | 88056845-c4bd-4de0-9394-fd07cb2aa399 ==============================
[0m22:05:37.908677 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.909388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.060247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88056845-c4bd-4de0-9394-fd07cb2aa399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c05341880>]}
[0m22:05:38.074275 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8j2pumfn'
[0m22:05:38.074745 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:38.193570 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:38.194192 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:38.203413 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:38.207329 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:38.256721 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:38.257297 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:38.257881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '88056845-c4bd-4de0-9394-fd07cb2aa399', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c03f61d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0401da90>]}
[0m22:05:38.258363 [info ] [MainThread]: 
[0m22:05:38.258873 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:38.260511 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4124704, "process_user_time": 1.482697, "process_kernel_time": 0.116211, "process_mem_max_rss": "94432", "process_in_blocks": "5744", "process_out_blocks": "4016"}
[0m22:05:38.261035 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:38.260933 after 0.41 seconds
[0m22:05:38.261492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c04af54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c03ec6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c04c7cbf0>]}
[0m22:05:38.261916 [debug] [MainThread]: Flushing usage events
[0m22:05:39.820663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffd18a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffb0a35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffbbf1100>]}


============================== 22:05:39.823589 | 730accc3-8c82-47f1-ad0b-f46047210be1 ==============================
[0m22:05:39.823589 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:39.824271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.056852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffadd6e70>]}
[0m22:05:40.116329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffbb67740>]}
[0m22:05:40.118778 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:40.180312 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:40.181021 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:40.181578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffade15b0>]}
[0m22:05:41.542480 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:41.543134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ff6f25a60>]}
[0m22:05:41.751654 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:41.801362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ff6c79550>]}
[0m22:05:41.911521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ff6b00aa0>]}
[0m22:05:41.912096 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:41.912792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ff6b86360>]}
[0m22:05:41.914882 [info ] [MainThread]: 
[0m22:05:41.915645 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:41.920558 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:41.958705 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:41.959423 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:41.960073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:42.466634 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:42.468783 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:42.469992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:42.470717 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:42.479338 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:42.479789 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:42.480199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:42.481079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:42.482524 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:42.482926 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:42.483497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:42.483902 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:42.484315 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:42.484926 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:42.485857 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:42.486284 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:42.486668 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:42.487262 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:42.487668 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:42.488887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:42.494488 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:42.494897 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:42.495306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:42.495920 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:42.496348 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:42.496736 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:42.511725 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:42.513560 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:42.515016 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:42.515514 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:42.517701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ff6cb5160>]}
[0m22:05:42.518249 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.518655 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.519026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:42.519721 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.520130 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.520554 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.520929 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.521490 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.521890 [debug] [MainThread]: On master: Close
[0m22:05:42.522434 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:42.522923 [info ] [MainThread]: 
[0m22:05:42.601328 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:42.601990 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:42.602692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:42.603181 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:42.631989 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:42.632772 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:42.670714 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:42.671556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:32.233351 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:32.233849 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:32.234493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.234942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:32.235401 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:32.236086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.238904 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:32.239370 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:32.240035 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.256344 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:32.256809 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:32.257258 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:32.258447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.263316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:32.263772 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:32.265093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.267382 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:32.268861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffc570230>]}
[0m22:10:32.269546 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 289.67s]
[0m22:10:32.270329 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:32.271141 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:32.271723 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:32.272544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:32.273000 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:32.278590 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:32.279229 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:32.314316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:32.314830 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250315221032307966"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:32.315342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:32.323818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.331151 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:32.331630 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:32.332238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.332687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:32.333117 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250315221032307966'
      
      
      order by ordinal_position

  
[0m22:10:32.337761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.342724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:32.343193 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:32.345734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.353131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:32.353637 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:32.356066 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.377358 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:32.378022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:32.378522 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250315221032307966"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250315221032307966"
    )
  
[0m22:10:32.431458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.433456 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:32.433902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:32.434346 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:32.440880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:32.441767 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:32.443274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '730accc3-8c82-47f1-ad0b-f46047210be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fec0a81a0>]}
[0m22:10:32.443952 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:32.444716 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:32.445981 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:32.446490 [debug] [MainThread]: On master: BEGIN
[0m22:10:32.446874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:32.447514 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:32.447910 [debug] [MainThread]: On master: COMMIT
[0m22:10:32.448319 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:32.448685 [debug] [MainThread]: On master: COMMIT
[0m22:10:32.449224 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:32.449645 [debug] [MainThread]: On master: Close
[0m22:10:32.450284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:32.450662 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:32.451065 [info ] [MainThread]: 
[0m22:10:32.451544 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 50.54 seconds (290.54s).
[0m22:10:32.452446 [debug] [MainThread]: Command end result
[0m22:10:32.477326 [info ] [MainThread]: 
[0m22:10:32.477871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:32.478355 [info ] [MainThread]: 
[0m22:10:32.478831 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:32.479777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 292.71246, "process_user_time": 5.297284, "process_kernel_time": 0.28075, "process_mem_max_rss": "297540", "process_in_blocks": "3816", "process_out_blocks": "95568"}
[0m22:10:32.480326 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:32.480203 after 292.71 seconds
[0m22:10:32.480764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffb9807d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ff6b2f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fec027770>]}
[0m22:10:32.481197 [debug] [MainThread]: Flushing usage events
[0m22:10:34.213038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f4394170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f2775a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f40634a0>]}


============================== 22:10:34.216029 | 4e61b748-f505-4865-9d49-cb08146f9d15 ==============================
[0m22:10:34.216029 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:34.216733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:34.364323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e61b748-f505-4865-9d49-cb08146f9d15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f1e24860>]}
[0m22:10:34.382588 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22261497, "process_user_time": 1.318533, "process_kernel_time": 0.102963, "process_mem_max_rss": "92956", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:10:34.383104 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:34.383002 after 0.22 seconds
[0m22:10:34.383595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f1eadeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f53b8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f1a6d280>]}
[0m22:10:34.384048 [debug] [MainThread]: Flushing usage events
[0m06:02:01.307463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e011b6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e004191c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e011b5850>]}


============================== 06:02:01.315978 | a94af726-f87c-47b0-817e-0a03c6ca1314 ==============================
[0m06:02:01.315978 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:01.316683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:01.467033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a94af726-f87c-47b0-817e-0a03c6ca1314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e00467590>]}
[0m06:02:01.481345 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7pkbs9p9'
[0m06:02:01.481821 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:01.534906 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:01.535558 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:01.549486 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:01.553457 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:01.765086 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:01.765697 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:01.766239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a94af726-f87c-47b0-817e-0a03c6ca1314', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dffeb7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dffeb7650>]}
[0m06:02:01.766727 [info ] [MainThread]: 
[0m06:02:01.767216 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:01.769040 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5110929, "process_user_time": 1.498333, "process_kernel_time": 0.123191, "process_mem_max_rss": "93960", "process_in_blocks": "5744", "process_out_blocks": "4024"}
[0m06:02:01.769598 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:01.769495 after 0.51 seconds
[0m06:02:01.770038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e00ccbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dffee6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dffee5b50>]}
[0m06:02:01.770502 [debug] [MainThread]: Flushing usage events
[0m06:02:03.469069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18231b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb183102b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb181566210>]}


============================== 06:02:03.472032 | 1544683a-631c-4f72-b3f9-fe9c484f250f ==============================
[0m06:02:03.472032 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.472744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:03.702371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb181815790>]}
[0m06:02:03.761472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1821b5070>]}
[0m06:02:03.763973 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:03.789651 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:03.790366 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:03.790900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18173b8c0>]}
[0m06:02:05.067210 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.067898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17d372b40>]}
[0m06:02:05.251440 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.297423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17d45c1a0>]}
[0m06:02:05.380480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17d31b0b0>]}
[0m06:02:05.381049 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:05.381592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17d4ef260>]}
[0m06:02:05.383340 [info ] [MainThread]: 
[0m06:02:05.384063 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.388793 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.424313 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.424773 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:05.425170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:05.963731 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:05.965700 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:05.966840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:05.967463 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:05.974929 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.975383 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:05.975772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.976714 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.978224 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.978645 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:05.979208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.979630 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.979998 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:05.980595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.981552 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.981956 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:05.982344 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:05.982885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.983327 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:05.984593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:05.990237 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.990680 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:05.991050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.991670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:05.992064 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:05.992486 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:06.006495 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.007953 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.009182 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.009626 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.011963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17d31b170>]}
[0m06:02:06.012523 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.012937 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.013326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.013964 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.014407 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.014795 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.015171 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.015738 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.016137 [debug] [MainThread]: On master: Close
[0m06:02:06.016697 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.017189 [info ] [MainThread]: 
[0m06:02:06.028899 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.029529 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.030180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:06.030650 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.057438 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.058216 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.094108 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.094946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:59.460170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.460708 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:06:59.461408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.461858 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.462305 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:06:59.463031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.465981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.466448 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:06:59.467123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.483561 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.484052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.484526 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.486089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.491157 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.491641 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:06:59.493437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.495816 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:06:59.497410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1681be6c0>]}
[0m06:06:59.498097 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.47s]
[0m06:06:59.498864 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:06:59.499692 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:06:59.500293 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:06:59.500935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:06:59.501416 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:06:59.507573 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:06:59.508230 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:06:59.542636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.543144 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250316060659536705"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:06:59.543635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:59.551966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.559432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.559886 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:06:59.560503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.560940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.561382 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250316060659536705'
      
      
      order by ordinal_position

  
[0m06:06:59.565761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.570790 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.571275 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:59.574421 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.581812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.582288 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:59.585208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.602979 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:06:59.603691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.604151 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250316060659536705"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250316060659536705"
    )
  
[0m06:06:59.653644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.655643 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:59.656098 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.656534 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:59.663729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.664635 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:06:59.666208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1544683a-631c-4f72-b3f9-fe9c484f250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb158174710>]}
[0m06:06:59.666919 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:06:59.667664 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:06:59.668970 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:59.669416 [debug] [MainThread]: On master: BEGIN
[0m06:06:59.669798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:06:59.670485 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:59.670905 [debug] [MainThread]: On master: COMMIT
[0m06:06:59.671316 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:59.671692 [debug] [MainThread]: On master: COMMIT
[0m06:06:59.672255 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:59.672674 [debug] [MainThread]: On master: Close
[0m06:06:59.673248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:06:59.673655 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:06:59.674058 [info ] [MainThread]: 
[0m06:06:59.674576 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.29 seconds (294.29s).
[0m06:06:59.675526 [debug] [MainThread]: Command end result
[0m06:06:59.700540 [info ] [MainThread]: 
[0m06:06:59.701189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:06:59.701819 [info ] [MainThread]: 
[0m06:06:59.702375 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:06:59.703376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.28464, "process_user_time": 5.176826, "process_kernel_time": 0.275629, "process_mem_max_rss": "304456", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m06:06:59.703889 [debug] [MainThread]: Command `dbt run` succeeded at 06:06:59.703791 after 296.29 seconds
[0m06:06:59.704332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb181756f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb18173ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb169bab080>]}
[0m06:06:59.704761 [debug] [MainThread]: Flushing usage events
[0m06:07:01.606252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca476e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca46100e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca3d44da0>]}


============================== 06:07:01.609220 | 04c87198-215a-46ff-9592-e0aed3d40068 ==============================
[0m06:07:01.609220 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:01.609898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:07:01.751072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04c87198-215a-46ff-9592-e0aed3d40068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca3cb19a0>]}
[0m06:07:01.769421 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2135726, "process_user_time": 1.338771, "process_kernel_time": 0.097983, "process_mem_max_rss": "92800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:01.769948 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:01.769845 after 0.21 seconds
[0m06:07:01.770403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca3be07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca4674bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca3cb1970>]}
[0m06:07:01.770846 [debug] [MainThread]: Flushing usage events
[0m14:04:48.943327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f817e007710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f817da6fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f817ca8bfb0>]}


============================== 14:04:48.951260 | 07bb6aa6-3a0d-4eee-a2cc-3adae218f553 ==============================
[0m14:04:48.951260 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:48.951995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.101860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07bb6aa6-3a0d-4eee-a2cc-3adae218f553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f817b7e3620>]}
[0m14:04:49.115696 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vbxdwj4d'
[0m14:04:49.116199 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:49.251748 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:49.252458 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:49.265874 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:49.269906 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:49.406491 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:49.407117 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:49.407741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '07bb6aa6-3a0d-4eee-a2cc-3adae218f553', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f817b6f5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f817b6f6600>]}
[0m14:04:49.408210 [info ] [MainThread]: 
[0m14:04:49.408767 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:49.410801 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5167484, "process_user_time": 1.478145, "process_kernel_time": 0.124348, "process_mem_max_rss": "94624", "process_in_blocks": "5744", "process_out_blocks": "4024"}
[0m14:04:49.411326 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:49.411222 after 0.52 seconds
[0m14:04:49.411797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f817bc3d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f817b795a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f817b80e5a0>]}
[0m14:04:49.412221 [debug] [MainThread]: Flushing usage events
[0m14:04:50.903164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46814a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa468148470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa468148d10>]}


============================== 14:04:50.906039 | 49eb3d70-6d82-4ebb-9e86-5b23e485a238 ==============================
[0m14:04:50.906039 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:50.906710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:51.136981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa464398500>]}
[0m14:04:51.195459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa464317bf0>]}
[0m14:04:51.197947 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:04:51.214044 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:51.214787 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:51.215330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4643c7500>]}
[0m14:04:52.504911 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:52.505590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa463f6d640>]}
[0m14:04:52.690092 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:52.735993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46405e300>]}
[0m14:04:52.817284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa463f23bf0>]}
[0m14:04:52.817817 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:04:52.818330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa463f34080>]}
[0m14:04:52.820079 [info ] [MainThread]: 
[0m14:04:52.820807 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:52.825518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:52.860311 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:52.860795 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:52.861199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:53.264724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.266308 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:53.267332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:53.267923 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:53.275355 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.275808 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:53.276203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.277103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.278523 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.278926 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:53.279500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.279901 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.280278 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:53.280878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.281804 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.282210 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:53.282688 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:53.283244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.283684 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:53.284892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:53.290624 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.291035 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:53.291434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:53.292052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.292481 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:53.292872 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:53.306880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:53.308322 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:53.309562 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:53.309970 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:53.312426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4640d68d0>]}
[0m14:04:53.312934 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.313330 [debug] [MainThread]: On master: BEGIN
[0m14:04:53.313734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:53.314328 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.314762 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.315150 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:53.315549 [debug] [MainThread]: On master: COMMIT
[0m14:04:53.316138 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:53.316593 [debug] [MainThread]: On master: Close
[0m14:04:53.317156 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:53.317666 [info ] [MainThread]: 
[0m14:04:53.328783 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:53.329365 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:53.330025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:04:53.330503 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:53.356942 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:53.357692 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:53.393496 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:53.394218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:42.074244 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:42.074811 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:42.075588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.076033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:42.076480 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:42.077231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.080280 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:42.080749 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:42.081485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.097889 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:42.098390 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:42.098832 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:42.100315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.105396 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:42.105855 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:09:42.107228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.109572 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:42.111100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4380d8200>]}
[0m14:09:42.111788 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 288.78s]
[0m14:09:42.112554 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:42.113508 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:42.114075 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:42.114667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:42.115120 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:42.120904 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:42.121572 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:42.155838 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:42.156391 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250316140942149900"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:42.156869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:42.165345 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.173044 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:42.173535 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:42.174208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.174685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:42.175116 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250316140942149900'
      
      
      order by ordinal_position

  
[0m14:09:42.179640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.184797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:42.185266 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:42.187662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.195246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:42.195744 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:42.198478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.216297 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:42.217012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:42.217497 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250316140942149900"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250316140942149900"
    )
  
[0m14:09:42.267582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.269541 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:42.269992 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:42.270429 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:42.279842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:42.280744 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:42.282281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49eb3d70-6d82-4ebb-9e86-5b23e485a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa447f0f380>]}
[0m14:09:42.282977 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:42.283748 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:42.285123 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:42.285571 [debug] [MainThread]: On master: BEGIN
[0m14:09:42.285958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:42.286620 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:42.287031 [debug] [MainThread]: On master: COMMIT
[0m14:09:42.287437 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:42.287834 [debug] [MainThread]: On master: COMMIT
[0m14:09:42.288397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:42.288804 [debug] [MainThread]: On master: Close
[0m14:09:42.289424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:42.289807 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:42.290210 [info ] [MainThread]: 
[0m14:09:42.290752 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 49.47 seconds (289.47s).
[0m14:09:42.291748 [debug] [MainThread]: Command end result
[0m14:09:42.316767 [info ] [MainThread]: 
[0m14:09:42.317424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:42.317960 [info ] [MainThread]: 
[0m14:09:42.318519 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:42.319545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 291.46625, "process_user_time": 5.021877, "process_kernel_time": 0.299932, "process_mem_max_rss": "295780", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m14:09:42.320062 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:42.319963 after 291.47 seconds
[0m14:09:42.320523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46814ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46811da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4640d6840>]}
[0m14:09:42.320958 [debug] [MainThread]: Flushing usage events
[0m14:09:44.142479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b40af5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b42573ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b404b24b0>]}


============================== 14:09:44.145523 | 736f1d62-0d5c-40f6-bbc3-df94aaf650d9 ==============================
[0m14:09:44.145523 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:44.146214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:44.290659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '736f1d62-0d5c-40f6-bbc3-df94aaf650d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b40eb23c0>]}
[0m14:09:44.308914 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21661256, "process_user_time": 1.322198, "process_kernel_time": 0.106854, "process_mem_max_rss": "92716", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:09:44.309496 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:44.309342 after 0.22 seconds
[0m14:09:44.309945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b40a011c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b42573ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b41023d70>]}
[0m14:09:44.310404 [debug] [MainThread]: Flushing usage events
[0m22:05:37.722456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa89a9b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa8a8a26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa89a9b950>]}


============================== 22:05:37.730699 | 0f9ffaf8-74ca-4ead-844c-16d5ba1b6655 ==============================
[0m22:05:37.730699 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.731398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.873928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f9ffaf8-74ca-4ead-844c-16d5ba1b6655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa89766540>]}
[0m22:05:37.887886 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r81w675i'
[0m22:05:37.888419 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:38.596680 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:38.597528 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:39.253009 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:39.257150 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:39.474873 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:39.475505 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:39.476066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0f9ffaf8-74ca-4ead-844c-16d5ba1b6655', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa89954350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa899544a0>]}
[0m22:05:39.476581 [info ] [MainThread]: 
[0m22:05:39.477072 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:39.478867 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8058714, "process_user_time": 1.497416, "process_kernel_time": 0.111179, "process_mem_max_rss": "94368", "process_in_blocks": "5744", "process_out_blocks": "4024"}
[0m22:05:39.479437 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:39.479329 after 1.81 seconds
[0m22:05:39.479872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa8b0af260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa8c12f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa89766540>]}
[0m22:05:39.480351 [debug] [MainThread]: Flushing usage events
[0m22:05:41.191789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca54e8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca78bb200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca5a7e030>]}


============================== 22:05:41.194824 | 4983b55c-3f04-4c36-99b9-8a1a2325ad34 ==============================
[0m22:05:41.194824 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:41.195503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.423210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca52a4590>]}
[0m22:05:41.481525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca5d266f0>]}
[0m22:05:41.484146 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:41.500139 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:41.500876 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:41.501428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca13425d0>]}
[0m22:05:42.784718 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:42.785396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca135a8a0>]}
[0m22:05:42.969671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:43.018308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca1194890>]}
[0m22:05:43.100889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca103e540>]}
[0m22:05:43.101477 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:43.101985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca10751f0>]}
[0m22:05:43.103748 [info ] [MainThread]: 
[0m22:05:43.104444 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:43.109207 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:43.145416 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:43.145920 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:43.146347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.655097 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:43.657289 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:43.658456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:43.659258 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:43.666857 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.667316 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:43.667705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.668735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.670224 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.670625 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:43.671278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.671677 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.672054 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:43.672726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.673681 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.674092 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.674489 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.675049 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.675489 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:43.676787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:43.682540 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.682949 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:43.683346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.683976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.684399 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.684781 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:43.700443 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.702135 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:43.703423 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:43.703833 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:43.706156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca11d6ba0>]}
[0m22:05:43.706726 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.707121 [debug] [MainThread]: On master: BEGIN
[0m22:05:43.707531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:43.708197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.708610 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.709003 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.709394 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.709949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.710386 [debug] [MainThread]: On master: Close
[0m22:05:43.710927 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:43.711413 [info ] [MainThread]: 
[0m22:05:43.722598 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:43.723246 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:43.723851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:43.724326 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:43.751083 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:43.751923 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:43.787564 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:43.788363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:37.315147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:37.315676 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:37.316369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.316822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:37.317283 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:37.318020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.320861 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:37.321338 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:37.322043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.338350 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:37.338825 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:37.339273 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:37.340419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.345267 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:37.345729 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:37.346952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.349246 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:37.350737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c802b0e60>]}
[0m22:10:37.351428 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.63s]
[0m22:10:37.352210 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:37.353015 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:37.353597 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:37.354229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:37.354705 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:37.360401 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:37.361068 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:37.395405 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:37.395914 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250316221037389456"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:37.396398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:37.404381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.411686 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:37.412143 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:37.412759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.413224 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:37.413657 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250316221037389456'
      
      
      order by ordinal_position

  
[0m22:10:37.418086 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.423047 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:37.423530 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:37.426742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.434085 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:37.434573 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:37.436822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.454535 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:37.455259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:37.455735 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250316221037389456"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250316221037389456"
    )
  
[0m22:10:37.505284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.507272 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:37.507725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:37.508157 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:37.515386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:37.516275 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:37.517840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4983b55c-3f04-4c36-99b9-8a1a2325ad34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c80246c90>]}
[0m22:10:37.518546 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:10:37.519302 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:37.520643 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:37.521075 [debug] [MainThread]: On master: BEGIN
[0m22:10:37.521504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:37.522143 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:37.522592 [debug] [MainThread]: On master: COMMIT
[0m22:10:37.522969 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:37.523389 [debug] [MainThread]: On master: COMMIT
[0m22:10:37.523931 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:37.524367 [debug] [MainThread]: On master: Close
[0m22:10:37.524957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:37.525400 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:37.525807 [info ] [MainThread]: 
[0m22:10:37.526357 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.42 seconds (294.42s).
[0m22:10:37.527374 [debug] [MainThread]: Command end result
[0m22:10:37.552763 [info ] [MainThread]: 
[0m22:10:37.553430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:37.553958 [info ] [MainThread]: 
[0m22:10:37.554519 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:37.555508 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.4138, "process_user_time": 4.668162, "process_kernel_time": 0.277009, "process_mem_max_rss": "290436", "process_in_blocks": "3816", "process_out_blocks": "95560"}
[0m22:10:37.556029 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:37.555927 after 296.41 seconds
[0m22:10:37.556525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca92d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca6a60410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca103cc80>]}
[0m22:10:37.556970 [debug] [MainThread]: Flushing usage events
[0m22:10:39.448937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950711d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9507acac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9507c9ba70>]}


============================== 22:10:39.452012 | a2f90fa5-c81a-466d-9ddf-dfa3b9f16881 ==============================
[0m22:10:39.452012 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:39.452692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:39.594029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2f90fa5-c81a-466d-9ddf-dfa3b9f16881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95070d72c0>]}
[0m22:10:39.612213 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2135135, "process_user_time": 1.320884, "process_kernel_time": 0.10599, "process_mem_max_rss": "93020", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:39.612740 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:39.612639 after 0.21 seconds
[0m22:10:39.613198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95070d7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950755daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950755db20>]}
[0m22:10:39.613636 [debug] [MainThread]: Flushing usage events
[0m06:02:12.462491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5032c25730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5031339070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50348606b0>]}


============================== 06:02:12.470284 | d35a70ed-69f0-47ff-95b2-8f1d65189524 ==============================
[0m06:02:12.470284 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.470918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.610953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd35a70ed-69f0-47ff-95b2-8f1d65189524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5030f02fc0>]}
[0m06:02:12.624364 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i66h2xv2'
[0m06:02:12.624834 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:12.827288 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:12.828022 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:12.850359 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:12.855158 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.925972 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.926505 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:12.927018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd35a70ed-69f0-47ff-95b2-8f1d65189524', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5032248170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5032249340>]}
[0m06:02:12.927502 [info ] [MainThread]: 
[0m06:02:12.927966 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:12.936521 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.523272, "process_user_time": 1.490842, "process_kernel_time": 0.11591, "process_mem_max_rss": "94272", "process_in_blocks": "5744", "process_out_blocks": "4016"}
[0m06:02:12.937036 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:12.936939 after 0.52 seconds
[0m06:02:12.937487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5031fe3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50348606b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5031089df0>]}
[0m06:02:12.937921 [debug] [MainThread]: Flushing usage events
[0m06:02:14.411132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0094220920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f009405ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f009449dd00>]}


============================== 06:02:14.414200 | 4a2c1113-58ab-4a11-a4e4-df45e91dfb4f ==============================
[0m06:02:14.414200 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.414869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.644875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0095127e60>]}
[0m06:02:14.704347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0094567230>]}
[0m06:02:14.706785 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:14.735183 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:14.735912 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:14.736456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0090157800>]}
[0m06:02:16.020416 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.021089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008fd66ba0>]}
[0m06:02:16.207487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.255202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008fe7a480>]}
[0m06:02:16.338284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008fd1e2d0>]}
[0m06:02:16.338821 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:16.339360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f008fef6240>]}
[0m06:02:16.341113 [info ] [MainThread]: 
[0m06:02:16.341853 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.346471 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.381436 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.381882 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.382295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:16.885607 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:16.888116 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:16.889459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:16.890139 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:16.897952 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.898418 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:16.898809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.899804 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.901208 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.901645 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:16.902213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.902641 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.903017 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:16.903653 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.904601 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.905011 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.905428 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.905977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.906415 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:16.907616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:16.913282 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.913715 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:16.914086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.914713 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.915106 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.915541 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:16.930082 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.931552 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:16.932765 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:16.933177 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:16.935478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00957a6f90>]}
[0m06:02:16.935982 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.936414 [debug] [MainThread]: On master: BEGIN
[0m06:02:16.936782 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:16.937395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.937798 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.938173 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.938562 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.939082 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.939496 [debug] [MainThread]: On master: Close
[0m06:02:16.940017 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:16.940531 [info ] [MainThread]: 
[0m06:02:16.951901 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:16.952519 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:16.953168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:16.953657 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:16.980573 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:16.981346 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.017562 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.018297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:09:21.626692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:09:21.627206 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:09:21.627872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.628333 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:09:21.628766 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:09:21.629467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.632363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:09:21.632816 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:09:21.633559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.650113 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:09:21.650604 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:09:21.651058 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:09:21.652359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.657216 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:09:21.657686 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:09:21.659051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.661377 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:09:21.662942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0095770260>]}
[0m06:09:21.663631 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 424.71s]
[0m06:09:21.664477 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:09:21.665398 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:09:21.666032 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:09:21.666627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:09:21.667080 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:09:21.672035 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:09:21.672700 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:09:21.708520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:09:21.709029 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250317060921702560"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:09:21.709531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:09:21.718082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.726175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:09:21.726713 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:09:21.727417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.727863 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:09:21.728324 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250317060921702560'
      
      
      order by ordinal_position

  
[0m06:09:21.732930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.738094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:09:21.738577 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:09:21.741205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.748730 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:09:21.749193 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:09:21.751509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.769533 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:09:21.770224 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:09:21.770710 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250317060921702560"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250317060921702560"
    )
  
[0m06:09:21.821676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.823676 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:09:21.824124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:09:21.824581 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:09:21.831185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:09:21.832060 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:09:21.833663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a2c1113-58ab-4a11-a4e4-df45e91dfb4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f006438dbb0>]}
[0m06:09:21.834364 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:09:21.835104 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:09:21.836457 [debug] [MainThread]: Using duckdb connection "master"
[0m06:09:21.836877 [debug] [MainThread]: On master: BEGIN
[0m06:09:21.837281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:09:21.837949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:09:21.838384 [debug] [MainThread]: On master: COMMIT
[0m06:09:21.838766 [debug] [MainThread]: Using duckdb connection "master"
[0m06:09:21.839135 [debug] [MainThread]: On master: COMMIT
[0m06:09:21.839704 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:09:21.840100 [debug] [MainThread]: On master: Close
[0m06:09:21.840726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:09:21.841106 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:09:21.841532 [info ] [MainThread]: 
[0m06:09:21.842046 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 7 minutes and 5.50 seconds (425.50s).
[0m06:09:21.843028 [debug] [MainThread]: Command end result
[0m06:09:21.868126 [info ] [MainThread]: 
[0m06:09:21.868749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:09:21.869294 [info ] [MainThread]: 
[0m06:09:21.869835 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:09:21.870817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 427.51068, "process_user_time": 5.164674, "process_kernel_time": 0.286092, "process_mem_max_rss": "300596", "process_in_blocks": "3816", "process_out_blocks": "95448"}
[0m06:09:21.871361 [debug] [MainThread]: Command `dbt run` succeeded at 06:09:21.871226 after 427.51 seconds
[0m06:09:21.871811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0094220920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0093f2d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0090154410>]}
[0m06:09:21.872247 [debug] [MainThread]: Flushing usage events
[0m06:09:23.661684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee493e09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee49775640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee49777aa0>]}


============================== 06:09:23.664709 | 63bb57ed-9777-4d61-8458-31baf2d401ec ==============================
[0m06:09:23.664709 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:09:23.665426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:09:23.806940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63bb57ed-9777-4d61-8458-31baf2d401ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4910b530>]}
[0m06:09:23.825292 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21394955, "process_user_time": 1.329876, "process_kernel_time": 0.09699, "process_mem_max_rss": "92948", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:09:23.825817 [debug] [MainThread]: Command `dbt clean` succeeded at 06:09:23.825715 after 0.21 seconds
[0m06:09:23.826256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4a8ec380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4a3a1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee49dbbf80>]}
[0m06:09:23.826711 [debug] [MainThread]: Flushing usage events
[0m14:05:42.102139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f3999100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f3aa78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f39994f0>]}


============================== 14:05:42.116096 | e6e7a019-c3e8-4fb4-b3ef-4780d39673fb ==============================
[0m14:05:42.116096 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:42.116806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:42.256973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e7a019-c3e8-4fb4-b3ef-4780d39673fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f32c82c0>]}
[0m14:05:42.270660 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0q9poa9q'
[0m14:05:42.271148 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:42.432053 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:42.432828 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:42.445103 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:42.449075 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:42.497813 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:42.498358 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:42.498942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e6e7a019-c3e8-4fb4-b3ef-4780d39673fb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f2edcaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f403c950>]}
[0m14:05:42.499397 [info ] [MainThread]: 
[0m14:05:42.499936 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:42.504983 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45181125, "process_user_time": 1.486598, "process_kernel_time": 0.112499, "process_mem_max_rss": "94460", "process_in_blocks": "5744", "process_out_blocks": "4024"}
[0m14:05:42.505517 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:42.505404 after 0.45 seconds
[0m14:05:42.505972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f2ff1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f2e157c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f3fbb2c0>]}
[0m14:05:42.506394 [debug] [MainThread]: Flushing usage events
[0m14:05:43.986560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc59859640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc59892270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc599efa40>]}


============================== 14:05:43.989593 | e381b4a3-69c3-44cd-bf14-29185fd1a71d ==============================
[0m14:05:43.989593 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:43.990307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:44.223697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc59220740>]}
[0m14:05:44.281937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc59f1acf0>]}
[0m14:05:44.284361 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:44.307060 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:44.307777 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:44.308310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc58faa480>]}
[0m14:05:45.582409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:45.583085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc54ccd9d0>]}
[0m14:05:45.767848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:45.815728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc54ccc8f0>]}
[0m14:05:45.897582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc54b1b0e0>]}
[0m14:05:45.898150 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:45.898686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc54b6b260>]}
[0m14:05:45.900385 [info ] [MainThread]: 
[0m14:05:45.901113 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:45.905705 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:45.941322 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:45.941791 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:45.942186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:46.467195 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:46.468768 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:46.469621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:46.470189 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:46.477649 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:46.478079 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:46.478461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:46.479511 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.480951 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:46.481352 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:46.481951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.482341 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:46.482750 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:46.483315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.484251 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:46.484667 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:46.485044 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:46.485573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.485997 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:46.487179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:46.492828 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:46.493238 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:46.493608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:46.494246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.494663 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:46.495060 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:46.508746 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.510220 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:46.511434 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:46.511877 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:46.514270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc5a593320>]}
[0m14:05:46.514800 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.515197 [debug] [MainThread]: On master: BEGIN
[0m14:05:46.515567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:46.516212 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.516658 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.517051 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.517427 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.517988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.518395 [debug] [MainThread]: On master: Close
[0m14:05:46.518929 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:46.519412 [info ] [MainThread]: 
[0m14:05:46.535261 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:46.535874 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:46.536464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:46.536929 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:46.563721 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:46.564457 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:46.600450 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:46.601198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:39.587985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:39.588484 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:17:39.589119 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.589554 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:39.589994 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:17:39.590700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.593498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:39.593959 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:17:39.594609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.611025 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:17:39.611490 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:39.611939 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:17:39.613232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.618114 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:39.618567 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:17:39.619710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.622004 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:17:39.623495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc34168650>]}
[0m14:17:39.624180 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 713.09s]
[0m14:17:39.624948 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:17:39.625782 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:17:39.626341 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:17:39.627110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:17:39.627557 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:17:39.633154 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:17:39.633817 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:17:39.668759 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:39.669252 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250317141739662821"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:17:39.669736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:39.678016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.685333 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:39.685803 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:17:39.686384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.686836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:39.687258 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250317141739662821'
      
      
      order by ordinal_position

  
[0m14:17:39.691747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.696790 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:39.697254 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:17:39.699807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.707301 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:39.707779 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:17:39.710202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.728153 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:17:39.728848 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:39.729304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250317141739662821"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250317141739662821"
    )
  
[0m14:17:39.779854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.781854 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:17:39.782313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:39.782758 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:17:39.789816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:39.790694 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:17:39.792354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e381b4a3-69c3-44cd-bf14-29185fd1a71d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc50818c20>]}
[0m14:17:39.793044 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:17:39.793804 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:17:39.795117 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:39.795534 [debug] [MainThread]: On master: BEGIN
[0m14:17:39.795944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:39.796575 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:17:39.797005 [debug] [MainThread]: On master: COMMIT
[0m14:17:39.797378 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:39.797770 [debug] [MainThread]: On master: COMMIT
[0m14:17:39.798298 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:17:39.798725 [debug] [MainThread]: On master: Close
[0m14:17:39.799318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:39.799752 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:17:39.800161 [info ] [MainThread]: 
[0m14:17:39.800699 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 11 minutes and 53.90 seconds (713.90s).
[0m14:17:39.801697 [debug] [MainThread]: Command end result
[0m14:17:39.826469 [info ] [MainThread]: 
[0m14:17:39.827083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:39.827598 [info ] [MainThread]: 
[0m14:17:39.828146 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:17:39.829106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 715.89325, "process_user_time": 5.187962, "process_kernel_time": 0.271154, "process_mem_max_rss": "303800", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m14:17:39.829617 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:39.829520 after 715.89 seconds
[0m14:17:39.830093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc54d101a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc58fccd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc508bd550>]}
[0m14:17:39.830520 [debug] [MainThread]: Flushing usage events
[0m14:17:41.565761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d9971160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46da363c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46da32e690>]}


============================== 14:17:41.568871 | ae69513f-16f4-4449-831a-f2f0f8c0d3b8 ==============================
[0m14:17:41.568871 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:17:41.569517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:17:41.719427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae69513f-16f4-4449-831a-f2f0f8c0d3b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d990b470>]}
[0m14:17:41.737429 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22267847, "process_user_time": 1.335292, "process_kernel_time": 0.10886, "process_mem_max_rss": "92828", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:17:41.737998 [debug] [MainThread]: Command `dbt clean` succeeded at 14:17:41.737895 after 0.22 seconds
[0m14:17:41.738445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d9eb5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d9bbfbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d9b40bf0>]}
[0m14:17:41.739062 [debug] [MainThread]: Flushing usage events
[0m22:05:55.306445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c929afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c9418680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ca8ecf80>]}


============================== 22:05:55.314988 | f5305fc5-f5a7-410a-8155-4aeeeffa0e0b ==============================
[0m22:05:55.314988 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:55.315620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:55.460371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5305fc5-f5a7-410a-8155-4aeeeffa0e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c8ffba10>]}
[0m22:05:55.473940 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gnk_yn26'
[0m22:05:55.474413 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:55.554481 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:55.555144 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:55.567282 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:55.571188 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:55.731078 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:55.731675 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:55.732242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f5305fc5-f5a7-410a-8155-4aeeeffa0e0b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c9786630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c8fec590>]}
[0m22:05:55.732713 [info ] [MainThread]: 
[0m22:05:55.733213 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:55.735022 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4778268, "process_user_time": 1.511297, "process_kernel_time": 0.122104, "process_mem_max_rss": "94372", "process_in_blocks": "5744", "process_out_blocks": "4016"}
[0m22:05:55.735546 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:55.735446 after 0.48 seconds
[0m22:05:55.735995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c95be540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c918ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c8e7afc0>]}
[0m22:05:55.736425 [debug] [MainThread]: Flushing usage events
[0m22:05:57.397160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe67e394f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe676508c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe67651730>]}


============================== 22:05:57.400437 | d9fccaf8-48e9-47f4-8d6b-ccbce5edfce9 ==============================
[0m22:05:57.400437 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:57.401122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.643977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe6713a2d0>]}
[0m22:05:57.706387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe671ced80>]}
[0m22:05:57.708983 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:57.877063 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:57.878322 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:57.879074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe633fb470>]}
[0m22:05:59.348653 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:59.349335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe63130140>]}
[0m22:05:59.548854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:59.600906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe630a9820>]}
[0m22:05:59.687744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe62f25df0>]}
[0m22:05:59.688328 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:59.688809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe630b53a0>]}
[0m22:05:59.690557 [info ] [MainThread]: 
[0m22:05:59.691260 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:59.695974 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:59.732786 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:59.733287 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:59.733697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:00.145544 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:00.147366 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:00.148493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:00.149186 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:00.157310 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:00.157779 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:00.158209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:00.159422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:00.160953 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:00.161361 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:00.161956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:00.162363 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:00.162744 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:00.163381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:00.164340 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:00.164746 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:00.165170 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:00.165715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:00.166152 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:00.167502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:00.173754 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:00.174219 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:00.174615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:00.175340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:00.175775 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:00.176228 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:00.191272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:00.193098 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:00.194460 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:00.194890 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:00.197477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe633cea50>]}
[0m22:06:00.198071 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:00.198483 [debug] [MainThread]: On master: BEGIN
[0m22:06:00.198856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:00.199677 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:00.200114 [debug] [MainThread]: On master: COMMIT
[0m22:06:00.200502 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:00.200878 [debug] [MainThread]: On master: COMMIT
[0m22:06:00.201511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:00.201947 [debug] [MainThread]: On master: Close
[0m22:06:00.202571 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:00.203085 [info ] [MainThread]: 
[0m22:06:00.214809 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:00.215449 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:00.216100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:00.216552 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:00.245038 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:00.245859 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:00.284589 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:00.285401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:52.861718 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:52.862253 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:52.862948 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.863401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:52.863832 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:52.864535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.867341 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:52.867790 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:52.868472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.885858 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:52.886370 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:52.886822 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:52.888149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.893219 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:52.893696 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:52.894941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.897219 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:52.898717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe6895c200>]}
[0m22:10:52.899404 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.68s]
[0m22:10:52.900246 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:52.901065 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:52.901630 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:52.902303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:52.902763 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:52.908612 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:52.909458 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:52.946428 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.946962 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250317221052940071"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:52.947455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:52.955870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.963497 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.963990 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:52.964606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.965084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.965533 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250317221052940071'
      
      
      order by ordinal_position

  
[0m22:10:52.970019 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.975154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.975645 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:52.978036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.985782 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.986283 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:52.989568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:53.008307 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:53.009037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:53.009523 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250317221052940071"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250317221052940071"
    )
  
[0m22:10:53.056930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:53.059018 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:53.059520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:53.060001 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:53.067556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:53.068555 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:53.070300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9fccaf8-48e9-47f4-8d6b-ccbce5edfce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe59b5f050>]}
[0m22:10:53.071036 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:53.071862 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:53.073311 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:53.073744 [debug] [MainThread]: On master: BEGIN
[0m22:10:53.074175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:53.074873 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:53.075325 [debug] [MainThread]: On master: COMMIT
[0m22:10:53.075707 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:53.076147 [debug] [MainThread]: On master: COMMIT
[0m22:10:53.076718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:53.077171 [debug] [MainThread]: On master: Close
[0m22:10:53.077794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:53.078216 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:53.078636 [info ] [MainThread]: 
[0m22:10:53.079128 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.39 seconds (293.39s).
[0m22:10:53.080066 [debug] [MainThread]: Command end result
[0m22:10:53.105304 [info ] [MainThread]: 
[0m22:10:53.105860 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:53.106348 [info ] [MainThread]: 
[0m22:10:53.106813 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:53.107741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.76736, "process_user_time": 5.385845, "process_kernel_time": 0.279888, "process_mem_max_rss": "304824", "process_in_blocks": "3816", "process_out_blocks": "95560"}
[0m22:10:53.108305 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:53.108204 after 295.77 seconds
[0m22:10:53.108761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe679723c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe603d0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe67c57080>]}
[0m22:10:53.109231 [debug] [MainThread]: Flushing usage events
[0m22:10:54.940566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ba001af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00b9c9a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00b9821730>]}


============================== 22:10:54.943651 | 83ce57f8-a610-4d04-8fc1-d5a0655bdc1a ==============================
[0m22:10:54.943651 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:54.944355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:10:55.086675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83ce57f8-a610-4d04-8fc1-d5a0655bdc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00b927d3d0>]}
[0m22:10:55.104697 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21482718, "process_user_time": 1.329875, "process_kernel_time": 0.104146, "process_mem_max_rss": "93320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:55.105251 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:55.105143 after 0.22 seconds
[0m22:10:55.105675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bd2d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bcfb8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bb89f830>]}
[0m22:10:55.106126 [debug] [MainThread]: Flushing usage events
[0m06:02:07.076880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75d5b8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75de19520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75d2f0770>]}


============================== 06:02:07.085157 | 0414d559-dc5b-4912-bc66-29d02581ab8a ==============================
[0m06:02:07.085157 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.085836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.232890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0414d559-dc5b-4912-bc66-29d02581ab8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75c871b80>]}
[0m06:02:07.246451 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d2k2jpie'
[0m06:02:07.246913 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.281029 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.281729 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.293123 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.297080 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.512597 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.513229 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:07.513780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0414d559-dc5b-4912-bc66-29d02581ab8a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75d43d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75d43c9b0>]}
[0m06:02:07.514288 [info ] [MainThread]: 
[0m06:02:07.514811 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:07.516483 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48953456, "process_user_time": 1.499927, "process_kernel_time": 0.120315, "process_mem_max_rss": "94440", "process_in_blocks": "5744", "process_out_blocks": "4016"}
[0m06:02:07.517009 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.516909 after 0.49 seconds
[0m06:02:07.517488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75cccdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75c871b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75c8b9970>]}
[0m06:02:07.517911 [debug] [MainThread]: Flushing usage events
[0m06:02:09.222533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8909654fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89096308f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890ac6f200>]}


============================== 06:02:09.225544 | 2d351216-b643-4bb7-9831-1ded379183da ==============================
[0m06:02:09.225544 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.226245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.455484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890957a5d0>]}
[0m06:02:09.513849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890a07f380>]}
[0m06:02:09.516341 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:09.540399 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.541092 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.541655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8905643ec0>]}
[0m06:02:10.834425 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:10.835053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890554ef90>]}
[0m06:02:11.022703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.076220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89054684a0>]}
[0m06:02:11.246157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8905341040>]}
[0m06:02:11.247028 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:11.247701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89054b3860>]}
[0m06:02:11.250107 [info ] [MainThread]: 
[0m06:02:11.251061 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.257378 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.295403 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.295896 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.296428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:11.788902 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.791125 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:11.792461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:11.793237 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:11.802790 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.803248 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:11.803645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.804632 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.806071 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.806506 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:11.807074 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.807491 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.807865 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:11.808471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.809399 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.809794 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.810180 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.810732 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.811131 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:11.812359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:11.818051 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.818478 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:11.818847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.819463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.819861 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.820265 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:11.835240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.836711 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:11.837942 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:11.838369 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:11.840656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890ada2b10>]}
[0m06:02:11.841188 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.841597 [debug] [MainThread]: On master: BEGIN
[0m06:02:11.841971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:11.842644 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.843050 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.843476 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.843866 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.844433 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.844839 [debug] [MainThread]: On master: Close
[0m06:02:11.845378 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:11.845881 [info ] [MainThread]: 
[0m06:02:11.894876 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:11.895677 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:11.896456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:11.896905 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:11.923815 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:11.924615 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:11.969357 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:11.970243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:13.831253 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.831762 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:13.832409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.832858 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.833297 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:13.833987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.836893 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.837357 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:13.838015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.854416 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:13.854880 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.855331 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:13.856755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.861731 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:13.862215 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:13.863960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.866295 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:13.867818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88dcd80650>]}
[0m06:07:13.868512 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 301.97s]
[0m06:07:13.869355 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:13.870311 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:13.870860 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:13.871512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:13.871956 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:13.877917 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:13.878625 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:13.913468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.914005 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250318060713907412"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:13.914491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:13.922475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.930122 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.930604 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:13.931289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.931728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.932151 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250318060713907412'
      
      
      order by ordinal_position

  
[0m06:07:13.936773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.942020 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.942529 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:13.944864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.952382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.952886 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:13.956224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:13.973988 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:13.974679 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:13.975136 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250318060713907412"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250318060713907412"
    )
  
[0m06:07:14.024818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:14.026820 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:14.027281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:14.027700 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:14.035438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:14.036338 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:14.037990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d351216-b643-4bb7-9831-1ded379183da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f75dfc50>]}
[0m06:07:14.038674 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:14.039432 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:14.040706 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:14.041133 [debug] [MainThread]: On master: BEGIN
[0m06:07:14.041567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:14.042258 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:14.042672 [debug] [MainThread]: On master: COMMIT
[0m06:07:14.043060 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:14.043470 [debug] [MainThread]: On master: COMMIT
[0m06:07:14.044028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:14.044469 [debug] [MainThread]: On master: Close
[0m06:07:14.045046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:14.045460 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:14.045870 [info ] [MainThread]: 
[0m06:07:14.046376 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 5 minutes and 2.80 seconds (302.80s).
[0m06:07:14.047309 [debug] [MainThread]: Command end result
[0m06:07:14.072806 [info ] [MainThread]: 
[0m06:07:14.073432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:14.073902 [info ] [MainThread]: 
[0m06:07:14.074392 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:14.075330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 304.90344, "process_user_time": 5.23047, "process_kernel_time": 0.268486, "process_mem_max_rss": "304496", "process_in_blocks": "3816", "process_out_blocks": "95552"}
[0m06:07:14.075853 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:14.075755 after 304.90 seconds
[0m06:07:14.076331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8909a7a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8905538c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88dc1079e0>]}
[0m06:07:14.076762 [debug] [MainThread]: Flushing usage events
[0m06:07:16.018779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe30c4b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe31b2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe4a0e660>]}


============================== 06:07:16.021785 | 1551ce2b-3e70-4e2e-9f3b-61622c986e45 ==============================
[0m06:07:16.021785 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:16.022457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:07:16.166740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1551ce2b-3e70-4e2e-9f3b-61622c986e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe34aa300>]}
[0m06:07:16.184926 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21627693, "process_user_time": 1.304997, "process_kernel_time": 0.121999, "process_mem_max_rss": "92740", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:16.185494 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:16.185389 after 0.22 seconds
[0m06:07:16.185936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe3114860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe338d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe2d79d90>]}
[0m06:07:16.186401 [debug] [MainThread]: Flushing usage events
[0m14:05:44.629956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cf4d1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d10a77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cf4d2ab0>]}


============================== 14:05:44.744106 | 354dbfcb-f2b5-4a54-8f24-77b149ece3ce ==============================
[0m14:05:44.744106 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:44.744808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:44.885732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '354dbfcb-f2b5-4a54-8f24-77b149ece3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cfa2bf80>]}
[0m14:05:44.899006 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mz1zqlfv'
[0m14:05:44.899512 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:44.978762 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:44.979396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:45.002456 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:45.006476 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:45.076632 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:45.077230 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:45.077808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '354dbfcb-f2b5-4a54-8f24-77b149ece3ce', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ce8d7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cf9c7200>]}
[0m14:05:45.078292 [info ] [MainThread]: 
[0m14:05:45.078768 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:45.112669 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5312595, "process_user_time": 1.470138, "process_kernel_time": 0.129659, "process_mem_max_rss": "94260", "process_in_blocks": "5744", "process_out_blocks": "4024"}
[0m14:05:45.113357 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:45.113186 after 0.53 seconds
[0m14:05:45.113853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d0101b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ce8f0f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ce7b78c0>]}
[0m14:05:45.114294 [debug] [MainThread]: Flushing usage events
[0m14:05:46.629396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be798a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be780f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be7f46db0>]}


============================== 14:05:46.632402 | e1335ef9-e5f7-446f-8a3c-d344a8e6c53a ==============================
[0m14:05:46.632402 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:46.633084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.865445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be353a900>]}
[0m14:05:46.924390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be739d7f0>]}
[0m14:05:46.926938 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:46.970824 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:46.971568 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:46.972105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be7fa7bc0>]}
[0m14:05:48.250421 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:48.251080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be333ce30>]}
[0m14:05:48.435111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:48.488621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be329fc20>]}
[0m14:05:48.570828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be3110800>]}
[0m14:05:48.571409 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:48.571923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be32ca090>]}
[0m14:05:48.573644 [info ] [MainThread]: 
[0m14:05:48.574344 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:48.578928 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:48.614176 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:48.614640 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:48.615031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:49.022372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:49.024160 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:49.025332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:49.025937 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:49.034601 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:49.035166 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:49.035656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:49.036768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:49.038394 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:49.038796 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:49.039510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:49.039965 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:49.040426 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:49.041009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:49.041948 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:49.042359 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:49.042728 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:49.043280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:49.043680 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:49.044870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:49.050454 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:49.050865 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:49.051253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:49.051877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:49.052299 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:49.052690 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:49.066825 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:49.068294 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:49.069527 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:49.069925 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:49.072095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be32c6270>]}
[0m14:05:49.072652 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:49.073065 [debug] [MainThread]: On master: BEGIN
[0m14:05:49.073459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:49.074069 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:49.074498 [debug] [MainThread]: On master: COMMIT
[0m14:05:49.074881 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:49.075263 [debug] [MainThread]: On master: COMMIT
[0m14:05:49.075796 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:49.076195 [debug] [MainThread]: On master: Close
[0m14:05:49.076769 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:49.077304 [info ] [MainThread]: 
[0m14:05:49.110253 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:49.110854 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:49.111513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:49.111964 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:49.138635 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:49.139405 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:49.175150 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:49.175899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:42.121764 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:42.122297 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:42.122945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.123411 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:42.123834 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:42.124607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.127463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:42.127901 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:42.128631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.144802 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:42.145290 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:42.145726 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:42.146886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.151727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:42.152181 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:42.153388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.155665 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:42.157150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be8b58800>]}
[0m14:10:42.157845 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.04s]
[0m14:10:42.158605 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:42.159563 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:42.160106 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:42.160711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:42.161151 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:42.166710 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:42.167356 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:42.201503 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:42.202009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250318141042195626"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:42.202494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:42.212031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.220410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:42.220874 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:42.221498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.221933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:42.222384 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250318141042195626'
      
      
      order by ordinal_position

  
[0m14:10:42.226827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.231840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:42.232334 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:42.234981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.242482 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:42.242946 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:42.246470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.264299 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:42.264975 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:42.265449 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250318141042195626"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250318141042195626"
    )
  
[0m14:10:42.316991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.318992 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:42.319492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:42.319908 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:42.327680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:42.328577 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:42.330265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1335ef9-e5f7-446f-8a3c-d344a8e6c53a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb8d60dd0>]}
[0m14:10:42.330950 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:42.331793 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:42.333124 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:42.333581 [debug] [MainThread]: On master: BEGIN
[0m14:10:42.333969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:42.334653 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:42.335062 [debug] [MainThread]: On master: COMMIT
[0m14:10:42.335490 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:42.335869 [debug] [MainThread]: On master: COMMIT
[0m14:10:42.336415 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:42.336820 [debug] [MainThread]: On master: Close
[0m14:10:42.337445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:42.337834 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:42.338265 [info ] [MainThread]: 
[0m14:10:42.338764 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.76 seconds (293.76s).
[0m14:10:42.339713 [debug] [MainThread]: Command end result
[0m14:10:42.365568 [info ] [MainThread]: 
[0m14:10:42.366193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:42.366746 [info ] [MainThread]: 
[0m14:10:42.367293 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:42.368295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.7938, "process_user_time": 5.106854, "process_kernel_time": 0.257699, "process_mem_max_rss": "303496", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m14:10:42.368812 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:42.368712 after 295.79 seconds
[0m14:10:42.369272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be7937200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc7fe7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bb8d92600>]}
[0m14:10:42.369717 [debug] [MainThread]: Flushing usage events
[0m14:10:44.100899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9dc93ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9df1b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9dcd8350>]}


============================== 14:10:44.104015 | 5b463d33-4f9b-4aef-95d5-87118aa2a810 ==============================
[0m14:10:44.104015 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:44.104681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:44.258508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b463d33-4f9b-4aef-95d5-87118aa2a810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9dee4a10>]}
[0m14:10:44.277115 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22718698, "process_user_time": 1.344763, "process_kernel_time": 0.087984, "process_mem_max_rss": "92840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:44.277697 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:44.277592 after 0.23 seconds
[0m14:10:44.278145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9dd1bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba1703020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9df1b890>]}
[0m14:10:44.278613 [debug] [MainThread]: Flushing usage events
[0m22:05:32.942136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa405fe7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa405fe68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa405fe7d40>]}


============================== 22:05:32.950266 | f3ce37cf-506e-4f17-978b-ef8e9bbfeceb ==============================
[0m22:05:32.950266 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:32.950986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:33.089861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3ce37cf-506e-4f17-978b-ef8e9bbfeceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4057478f0>]}
[0m22:05:33.103404 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xgsg3gyc'
[0m22:05:33.103889 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:33.186591 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:33.187256 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:33.210581 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:33.214527 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:33.283323 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:33.283880 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:33.284446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3ce37cf-506e-4f17-978b-ef8e9bbfeceb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4067588f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406758410>]}
[0m22:05:33.284926 [info ] [MainThread]: 
[0m22:05:33.285437 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:33.287185 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39423236, "process_user_time": 1.476658, "process_kernel_time": 0.114817, "process_mem_max_rss": "94432", "process_in_blocks": "5744", "process_out_blocks": "4016"}
[0m22:05:33.287703 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:33.287603 after 0.39 seconds
[0m22:05:33.288162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406015e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa40619e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406d07b90>]}
[0m22:05:33.288600 [debug] [MainThread]: Flushing usage events
[0m22:05:34.796002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee2c165d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee1c975f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee12f8cb0>]}


============================== 22:05:34.799033 | 62458529-4dbb-440d-bb42-5e2a55318e79 ==============================
[0m22:05:34.799033 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:34.799686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.031117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee286cf50>]}
[0m22:05:35.089914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee2222c90>]}
[0m22:05:35.092381 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:35.114967 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:35.115674 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:35.116230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedd1472f0>]}
[0m22:05:36.409628 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:36.410278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedce7d940>]}
[0m22:05:36.593483 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:36.638045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedcf71c40>]}
[0m22:05:36.719992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedce6cfe0>]}
[0m22:05:36.720495 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:36.721021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedcfe70b0>]}
[0m22:05:36.722704 [info ] [MainThread]: 
[0m22:05:36.723382 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:36.728083 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:36.762965 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:36.763402 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:36.763796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:37.283239 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:37.284941 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:37.285896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:37.286517 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:37.294022 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.294449 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:37.294875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:37.295759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.297194 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.297593 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:37.298162 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.298554 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.298951 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:37.299519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.300431 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:37.300853 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.301232 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:37.301769 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.302192 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:37.303412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:37.308964 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:37.309370 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:37.309738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:37.310359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.310751 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:37.311162 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:37.324747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.326185 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:37.327384 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:37.327798 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:37.330070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee28a2d80>]}
[0m22:05:37.330569 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.330998 [debug] [MainThread]: On master: BEGIN
[0m22:05:37.331368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:37.331971 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.332379 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.332763 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.333167 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.333709 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.334138 [debug] [MainThread]: On master: Close
[0m22:05:37.334666 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:37.335186 [info ] [MainThread]: 
[0m22:05:37.346058 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:37.346638 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:37.347292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:37.347742 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:37.374340 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:37.375083 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:37.410663 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:37.411400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:34.969006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.969501 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:34.970134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.970574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.971029 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:34.971717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.974651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.975118 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:34.975792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.992244 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:34.992708 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.993160 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:34.994459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.999377 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.999907 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:35.001101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.003398 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:35.004902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedcf1e1e0>]}
[0m22:10:35.005578 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 297.66s]
[0m22:10:35.006422 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:35.007330 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:35.008000 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:35.008608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:35.009075 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:35.014580 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:35.015228 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:35.049595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.050100 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250318221035043664"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:35.050555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:35.060515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.067764 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.068243 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:35.068849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.069292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.069724 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250318221035043664'
      
      
      order by ordinal_position

  
[0m22:10:35.074054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.079020 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.079485 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:35.081771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.089204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.089678 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:35.091990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.109679 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:35.110347 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.110805 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250318221035043664"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250318221035043664"
    )
  
[0m22:10:35.161338 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.163307 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:35.163755 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:35.164197 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:35.171559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:35.172440 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:35.174054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62458529-4dbb-440d-bb42-5e2a55318e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeb4902f60>]}
[0m22:10:35.174725 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:35.175484 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:35.176757 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:35.177208 [debug] [MainThread]: On master: BEGIN
[0m22:10:35.177590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:35.178273 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:35.178686 [debug] [MainThread]: On master: COMMIT
[0m22:10:35.179126 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:35.179504 [debug] [MainThread]: On master: COMMIT
[0m22:10:35.180086 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:35.180498 [debug] [MainThread]: On master: Close
[0m22:10:35.181182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:35.181562 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:35.182033 [info ] [MainThread]: 
[0m22:10:35.182495 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 58.46 seconds (298.46s).
[0m22:10:35.183418 [debug] [MainThread]: Command end result
[0m22:10:35.208793 [info ] [MainThread]: 
[0m22:10:35.209355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:35.209806 [info ] [MainThread]: 
[0m22:10:35.210293 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:35.211186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 300.46573, "process_user_time": 5.168951, "process_kernel_time": 0.272155, "process_mem_max_rss": "302220", "process_in_blocks": "3816", "process_out_blocks": "95560"}
[0m22:10:35.211705 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:35.211607 after 300.47 seconds
[0m22:10:35.212190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbee51bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedce7dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec960a9c0>]}
[0m22:10:35.212621 [debug] [MainThread]: Flushing usage events
[0m22:10:36.990851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c80aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28af589b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28b23b7a0>]}


============================== 22:10:36.993671 | c33be216-440f-4c1b-9132-59f793b9a48d ==============================
[0m22:10:36.993671 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:36.994364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:10:37.131466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c33be216-440f-4c1b-9132-59f793b9a48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28b2af680>]}
[0m22:10:37.149226 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20844628, "process_user_time": 1.291474, "process_kernel_time": 0.114953, "process_mem_max_rss": "92700", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:37.149721 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:37.149625 after 0.21 seconds
[0m22:10:37.150174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28c49a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28ac41250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28ad028d0>]}
[0m22:10:37.150598 [debug] [MainThread]: Flushing usage events
[0m06:02:10.380482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0bf11cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0b7665d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0b688320>]}


============================== 06:02:10.389289 | 0997f727-7e0e-4699-8588-fdd1a91676cd ==============================
[0m06:02:10.389289 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.389960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.531583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0997f727-7e0e-4699-8588-fdd1a91676cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0b30ec00>]}
[0m06:02:10.545069 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lfpkyl91'
[0m06:02:10.545518 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.727025 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.727768 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.737687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.741635 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.815057 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.815610 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:10.816195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0997f727-7e0e-4699-8588-fdd1a91676cd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0b4b9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0b30cb30>]}
[0m06:02:10.816654 [info ] [MainThread]: 
[0m06:02:10.817166 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:10.819032 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48759076, "process_user_time": 1.500672, "process_kernel_time": 0.110754, "process_mem_max_rss": "94368", "process_in_blocks": "5744", "process_out_blocks": "4024"}
[0m06:02:10.819562 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.819461 after 0.49 seconds
[0m06:02:10.820047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0b6883e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0b79ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0b745130>]}
[0m06:02:10.820469 [debug] [MainThread]: Flushing usage events
[0m06:02:12.335280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51dffc6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e007b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51dffc4da0>]}


============================== 06:02:12.338238 | 662d04d6-be93-4ba0-83f1-2f5c27a5f078 ==============================
[0m06:02:12.338238 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.338951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.572565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e021cb60>]}
[0m06:02:12.631377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51dfdf1430>]}
[0m06:02:12.633935 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:12.650352 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.651089 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.651620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e24c1730>]}
[0m06:02:13.937547 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.938268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51dbd4f500>]}
[0m06:02:14.122768 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.172704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51dbcaf920>]}
[0m06:02:14.255941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51dbb59250>]}
[0m06:02:14.256486 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:14.257027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51dbb18200>]}
[0m06:02:14.258767 [info ] [MainThread]: 
[0m06:02:14.259481 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.264190 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.299669 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.300152 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:14.300544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.608621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.610259 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.611341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.611988 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.620041 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.620487 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:14.620977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.622037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.623565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.624014 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.624614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.625110 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.625596 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.626343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.627356 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.627770 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.628180 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.628784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.629204 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.630562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.636281 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.636685 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.637081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.637688 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.638108 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.638486 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:14.652310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.653778 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.655013 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.655416 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.657611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e1593500>]}
[0m06:02:14.658154 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.658550 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.658972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.659586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.660030 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.660420 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.660822 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.661362 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.661791 [debug] [MainThread]: On master: Close
[0m06:02:14.662329 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.662865 [info ] [MainThread]: 
[0m06:02:14.674762 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.675369 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.676031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:14.676483 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.704855 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.705603 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.741772 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.742513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:05.967975 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.968504 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:05.969212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.969657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.970108 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:05.970852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.973799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.974250 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:05.974954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.991574 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:05.992120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.992557 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:05.994331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.999548 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:06.000030 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:06.002613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.005008 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:06.006528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51da5b0f50>]}
[0m06:07:06.007235 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.33s]
[0m06:07:06.008082 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:06.009037 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:06.009674 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:06.010375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:06.010846 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:06.016860 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:06.017523 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:06.053061 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.053641 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250319060706046926"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:06.054145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:06.062502 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.070612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.071135 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:06.071830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.072295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.072740 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250319060706046926'
      
      
      order by ordinal_position

  
[0m06:07:06.077300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.082839 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.083327 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:06.086228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.094812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.095300 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:06.098137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.116279 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:06.117103 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.117573 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250319060706046926"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250319060706046926"
    )
  
[0m06:07:06.167966 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.169968 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:06.170430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:06.170873 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:06.178637 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:06.179591 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:06.181118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '662d04d6-be93-4ba0-83f1-2f5c27a5f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51a7f69ca0>]}
[0m06:07:06.181811 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:06.182561 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:06.184020 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:06.184445 [debug] [MainThread]: On master: BEGIN
[0m06:07:06.184873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:06.185568 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:06.186018 [debug] [MainThread]: On master: COMMIT
[0m06:07:06.186403 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:06.186808 [debug] [MainThread]: On master: COMMIT
[0m06:07:06.187383 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:06.187840 [debug] [MainThread]: On master: Close
[0m06:07:06.188441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:06.188862 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:06.189285 [info ] [MainThread]: 
[0m06:07:06.189821 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 51.93 seconds (291.93s).
[0m06:07:06.190807 [debug] [MainThread]: Command end result
[0m06:07:06.216759 [info ] [MainThread]: 
[0m06:07:06.217422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:06.217935 [info ] [MainThread]: 
[0m06:07:06.218446 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:06.219460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.9345, "process_user_time": 4.968424, "process_kernel_time": 0.292554, "process_mem_max_rss": "299492", "process_in_blocks": "3816", "process_out_blocks": "95544"}
[0m06:07:06.220013 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:06.219908 after 293.94 seconds
[0m06:07:06.220458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51e241fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bffa05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51dffc4da0>]}
[0m06:07:06.220913 [debug] [MainThread]: Flushing usage events
[0m06:07:08.191461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b244710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76bff7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76bff4470>]}


============================== 06:07:08.194734 | a4897309-a538-4fac-bff6-568de5c117bc ==============================
[0m06:07:08.194734 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:08.195421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:07:08.349812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4897309-a538-4fac-bff6-568de5c117bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b61c800>]}
[0m06:07:08.368490 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22922698, "process_user_time": 1.377573, "process_kernel_time": 0.099969, "process_mem_max_rss": "92944", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:08.369104 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:08.368979 after 0.23 seconds
[0m06:07:08.369555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76c395400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b456ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76b3cf770>]}
[0m06:07:08.370061 [debug] [MainThread]: Flushing usage events
[0m14:05:41.587663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4162629970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4161541880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4160ce5490>]}


============================== 14:05:41.616297 | cc47f085-2b16-431b-917e-796d78ce1567 ==============================
[0m14:05:41.616297 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:41.617017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:41.764009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc47f085-2b16-431b-917e-796d78ce1567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4160c9f7a0>]}
[0m14:05:41.777934 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xf5928sl'
[0m14:05:41.778467 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:41.903773 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:41.904539 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:41.934536 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:41.938626 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:42.012009 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:42.012683 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:42.013287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc47f085-2b16-431b-917e-796d78ce1567', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41609fc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41609ef980>]}
[0m14:05:42.013774 [info ] [MainThread]: 
[0m14:05:42.014290 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:42.027813 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49071428, "process_user_time": 1.514726, "process_kernel_time": 0.131062, "process_mem_max_rss": "94128", "process_in_blocks": "5728", "process_out_blocks": "4008"}
[0m14:05:42.028389 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:42.028283 after 0.49 seconds
[0m14:05:42.028832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4162629970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4160ce1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416159e570>]}
[0m14:05:42.029297 [debug] [MainThread]: Flushing usage events
[0m14:05:43.582398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452a2c8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452a2cbec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452a6cc770>]}


============================== 14:05:43.585486 | 56a08ce4-f0d8-4877-9986-63f9ccbf1d18 ==============================
[0m14:05:43.585486 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:43.586190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:43.821999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452a0e3d70>]}
[0m14:05:43.881538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452a0f3f50>]}
[0m14:05:43.884190 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:43.948675 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:43.949475 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:43.950035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452a612480>]}
[0m14:05:45.248667 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:45.249381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4525e7b560>]}
[0m14:05:45.437909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:45.489533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4525fa7560>]}
[0m14:05:45.573217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4525e238c0>]}
[0m14:05:45.573791 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:45.574341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4525fd3da0>]}
[0m14:05:45.576151 [info ] [MainThread]: 
[0m14:05:45.576877 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:45.581729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:45.617711 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:45.618238 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:45.618647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:45.975414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.976992 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:45.977987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:45.978559 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:45.986472 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:45.987007 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:45.987433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:45.988649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.990237 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:45.990643 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:45.991271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.991671 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:45.992063 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:45.992648 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.993588 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:45.993991 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:45.994409 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:45.995009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:45.995443 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:45.996706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:46.002699 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:46.003136 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:46.003521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:46.004150 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.004548 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:46.004935 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:46.019387 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:46.020883 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:46.022152 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:46.022566 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:46.024953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452b89acc0>]}
[0m14:05:46.025495 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.025886 [debug] [MainThread]: On master: BEGIN
[0m14:05:46.026303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:46.026909 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.027339 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.027721 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:46.028129 [debug] [MainThread]: On master: COMMIT
[0m14:05:46.028691 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:46.029109 [debug] [MainThread]: On master: Close
[0m14:05:46.029647 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:46.030185 [info ] [MainThread]: 
[0m14:05:46.041625 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:46.042248 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:46.042849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:46.043315 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:46.070359 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:46.071176 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:46.107776 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:46.108692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:38.334307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:38.334813 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:38.335451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.335908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:38.336366 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:38.337062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.339934 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:38.340402 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:38.341076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.357518 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:38.357993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:38.358455 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:38.359707 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.364618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:38.365098 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:38.366450 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.368770 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:38.370299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44fc107dd0>]}
[0m14:10:38.370975 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.33s]
[0m14:10:38.371797 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:38.372641 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:38.373229 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:38.373896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:38.374394 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:38.380123 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:38.380758 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:38.415709 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:38.416240 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250319141038409616"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:38.416707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:38.424505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.432294 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:38.432873 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:38.433690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.434155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:38.434609 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250319141038409616'
      
      
      order by ordinal_position

  
[0m14:10:38.439252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.444855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:38.445349 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:38.448774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.456551 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:38.457022 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:38.460390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.478697 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:38.479406 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:38.479865 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250319141038409616"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250319141038409616"
    )
  
[0m14:10:38.531155 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.533117 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:38.533571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:38.533994 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:38.541374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:38.542272 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:38.543889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a08ce4-f0d8-4877-9986-63f9ccbf1d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4524916840>]}
[0m14:10:38.544577 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:38.545337 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:38.546636 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:38.547080 [debug] [MainThread]: On master: BEGIN
[0m14:10:38.547478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:38.548138 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:38.548544 [debug] [MainThread]: On master: COMMIT
[0m14:10:38.548920 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:38.549325 [debug] [MainThread]: On master: COMMIT
[0m14:10:38.549857 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:38.550291 [debug] [MainThread]: On master: Close
[0m14:10:38.550881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:38.551316 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:38.551719 [info ] [MainThread]: 
[0m14:10:38.552280 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.97 seconds (292.98s).
[0m14:10:38.553277 [debug] [MainThread]: Command end result
[0m14:10:38.578296 [info ] [MainThread]: 
[0m14:10:38.578898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:38.579441 [info ] [MainThread]: 
[0m14:10:38.579964 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:38.580942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.05002, "process_user_time": 5.104531, "process_kernel_time": 0.281029, "process_mem_max_rss": "304328", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m14:10:38.581485 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:38.581386 after 295.05 seconds
[0m14:10:38.581933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452a2cbec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452acee480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4525ff0ef0>]}
[0m14:10:38.582387 [debug] [MainThread]: Flushing usage events
[0m14:10:40.417757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133e7acce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133efdf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133e7acb60>]}


============================== 14:10:40.420689 | 78bba60f-6907-4754-b2ac-b9203ff040d7 ==============================
[0m14:10:40.420689 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:40.421393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:40.565831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78bba60f-6907-4754-b2ac-b9203ff040d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133fcdb9e0>]}
[0m14:10:40.583855 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2166853, "process_user_time": 1.323139, "process_kernel_time": 0.108011, "process_mem_max_rss": "93092", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:40.584383 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:40.584283 after 0.22 seconds
[0m14:10:40.584813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133efdf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13403d99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f133e459f10>]}
[0m14:10:40.585282 [debug] [MainThread]: Flushing usage events
[0m22:05:31.944147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703dba9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703db63b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703db63ad0>]}


============================== 22:05:31.952476 | a760575b-a9fc-49fb-a009-5ce507d122af ==============================
[0m22:05:31.952476 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:31.953170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:32.094504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a760575b-a9fc-49fb-a009-5ce507d122af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703d981ee0>]}
[0m22:05:32.108049 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jj5gtsho'
[0m22:05:32.108541 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:32.211571 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:32.212198 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:32.234861 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:32.238843 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:32.308556 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:32.309112 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:32.309708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a760575b-a9fc-49fb-a009-5ce507d122af', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703d8e38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703d9b1a00>]}
[0m22:05:32.310159 [info ] [MainThread]: 
[0m22:05:32.310665 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:32.312469 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41738337, "process_user_time": 1.477032, "process_kernel_time": 0.104854, "process_mem_max_rss": "94504", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m22:05:32.312986 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:32.312885 after 0.42 seconds
[0m22:05:32.313454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703db63aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703d9de630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f703d9dd4f0>]}
[0m22:05:32.313908 [debug] [MainThread]: Flushing usage events
[0m22:05:33.823561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9856ddcb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9856a91070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985701a630>]}


============================== 22:05:33.826545 | 461f7d14-827f-4c18-bb7e-46ad1a723ff2 ==============================
[0m22:05:33.826545 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:33.827234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:34.058461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98527977d0>]}
[0m22:05:34.116803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9856739310>]}
[0m22:05:34.119250 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:34.152786 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:34.153515 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:34.154049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98566241d0>]}
[0m22:05:35.442364 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:35.443047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9852741d30>]}
[0m22:05:35.628304 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:35.685780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9852462210>]}
[0m22:05:35.770352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98524ec680>]}
[0m22:05:35.770944 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:35.771487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98523642f0>]}
[0m22:05:35.773273 [info ] [MainThread]: 
[0m22:05:35.774019 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:35.778783 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:35.815238 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:35.815782 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:35.816215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:36.251115 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:36.252953 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:36.254210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:36.254880 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:36.263378 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:36.263868 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:36.264262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:36.265231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:36.266724 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:36.267126 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:36.267794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:36.268193 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:36.268611 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:36.269196 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:36.270154 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:36.270575 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:36.270945 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:36.271494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:36.271899 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:36.273202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:36.278966 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:36.279374 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:36.279773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:36.280434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:36.280834 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:36.281216 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:36.296106 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:36.297660 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:36.298916 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:36.299326 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:36.301746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9857d9ac90>]}
[0m22:05:36.302264 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:36.302701 [debug] [MainThread]: On master: BEGIN
[0m22:05:36.303071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:36.303722 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:36.304140 [debug] [MainThread]: On master: COMMIT
[0m22:05:36.304558 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:36.304925 [debug] [MainThread]: On master: COMMIT
[0m22:05:36.305480 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:36.305881 [debug] [MainThread]: On master: Close
[0m22:05:36.306450 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:36.306932 [info ] [MainThread]: 
[0m22:05:36.318719 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:36.319334 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:36.320018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:36.320496 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:36.347523 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:36.348313 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:36.384140 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:36.385205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:29.259763 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:29.260289 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:29.260974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.261459 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:29.261903 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:29.262655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.265583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:29.266033 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:29.266763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.283645 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:29.284187 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:29.284639 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:29.286414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.291619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:29.292079 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:29.293572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.295950 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:29.297485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9829f2a000>]}
[0m22:10:29.298160 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.98s]
[0m22:10:29.298998 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:29.299910 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:29.300513 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:29.301170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:29.301741 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:29.307882 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:29.308566 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:29.343269 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:29.343784 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250319221029337266"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:29.344240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:29.352702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.360038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:29.360508 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:29.361136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.361597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:29.362026 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250319221029337266'
      
      
      order by ordinal_position

  
[0m22:10:29.366465 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.372389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:29.372869 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:29.375469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.382898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:29.383366 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:29.386112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.403781 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:29.404504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:29.404974 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250319221029337266"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250319221029337266"
    )
  
[0m22:10:29.457205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.459185 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:29.459654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:29.460072 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:29.467742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.468643 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:29.470313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '461f7d14-827f-4c18-bb7e-46ad1a723ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98500f52e0>]}
[0m22:10:29.471009 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:29.471765 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:29.473030 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:29.473479 [debug] [MainThread]: On master: BEGIN
[0m22:10:29.473871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:29.474513 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:29.474918 [debug] [MainThread]: On master: COMMIT
[0m22:10:29.475297 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:29.475700 [debug] [MainThread]: On master: COMMIT
[0m22:10:29.476260 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:29.476687 [debug] [MainThread]: On master: Close
[0m22:10:29.477269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:29.477674 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:29.478067 [info ] [MainThread]: 
[0m22:10:29.478605 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.70 seconds (293.70s).
[0m22:10:29.479665 [debug] [MainThread]: Command end result
[0m22:10:29.504438 [info ] [MainThread]: 
[0m22:10:29.505032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:29.505571 [info ] [MainThread]: 
[0m22:10:29.506097 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:29.507081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.73392, "process_user_time": 5.117519, "process_kernel_time": 0.292429, "process_mem_max_rss": "303872", "process_in_blocks": "3816", "process_out_blocks": "95568"}
[0m22:10:29.507638 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:29.507526 after 295.73 seconds
[0m22:10:29.508067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f985744dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9852346720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98524d2f60>]}
[0m22:10:29.508517 [debug] [MainThread]: Flushing usage events
[0m22:10:31.220483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db5490c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db5493500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db5490ce0>]}


============================== 22:10:31.223418 | 5c112138-bdbf-451c-8a23-0321a5f1d6f9 ==============================
[0m22:10:31.223418 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:31.224062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:31.362134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c112138-bdbf-451c-8a23-0321a5f1d6f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db521cec0>]}
[0m22:10:31.380036 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20916459, "process_user_time": 1.30876, "process_kernel_time": 0.098906, "process_mem_max_rss": "92824", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:10:31.380569 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:31.380468 after 0.21 seconds
[0m22:10:31.380997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db9363da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db51678c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db62f87a0>]}
[0m22:10:31.381438 [debug] [MainThread]: Flushing usage events
[0m06:02:16.358623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4860daa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4860b0f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4860841280>]}


============================== 06:02:16.388450 | 9f522ef0-ae69-4dd8-a0c8-c66e18346b7b ==============================
[0m06:02:16.388450 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.389208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.545178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f522ef0-ae69-4dd8-a0c8-c66e18346b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486089b2c0>]}
[0m06:02:16.560105 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ko0y9flc'
[0m06:02:16.560648 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:16.641740 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:16.642529 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:16.655675 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:16.659872 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:16.828177 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:16.828813 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:16.829417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f522ef0-ae69-4dd8-a0c8-c66e18346b7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486058a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4861eef3b0>]}
[0m06:02:16.829916 [info ] [MainThread]: 
[0m06:02:16.830430 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:16.838526 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5303888, "process_user_time": 1.549579, "process_kernel_time": 0.133791, "process_mem_max_rss": "94224", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m06:02:16.839087 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:16.838983 after 0.53 seconds
[0m06:02:16.839523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4861836510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486089b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486058a510>]}
[0m06:02:16.839976 [debug] [MainThread]: Flushing usage events
[0m06:02:18.454596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa979bed0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa979ea67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c4c4170>]}


============================== 06:02:18.457665 | 0f9d637a-e2fa-46a2-a70f-cee4c28da248 ==============================
[0m06:02:18.457665 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.458390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.700502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa979b76180>]}
[0m06:02:18.760437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b36ed20>]}
[0m06:02:18.763150 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:18.798739 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:18.799550 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:18.800109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa975b2ad50>]}
[0m06:02:20.105863 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:20.106536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa979b10560>]}
[0m06:02:20.297070 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:20.354338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97597f6e0>]}
[0m06:02:20.439136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9758378c0>]}
[0m06:02:20.439734 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:20.440246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9758825d0>]}
[0m06:02:20.442067 [info ] [MainThread]: 
[0m06:02:20.442831 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:20.447610 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:20.484195 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:20.484747 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:20.485157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:21.040340 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:21.042158 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:21.043221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:21.043879 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:21.051846 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.052297 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:21.052704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:21.053942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.055483 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.055907 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:21.056503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.056932 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.057312 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:21.057913 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.058846 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.059239 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.059606 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.060176 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.060583 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:21.061937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:21.067884 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:21.068297 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:21.068670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:21.069339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.069761 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:21.070156 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:21.084405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.086073 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:21.087355 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:21.087797 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:21.090236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b36f050>]}
[0m06:02:21.090790 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.091191 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.091568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:21.092311 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.092746 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.093140 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.093512 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.094101 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.094512 [debug] [MainThread]: On master: Close
[0m06:02:21.095281 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:21.095806 [info ] [MainThread]: 
[0m06:02:21.120138 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:21.120850 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:21.121571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:21.122050 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:21.149520 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:21.150438 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:21.186801 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:21.187698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:30.182489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:30.183065 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:14:30.183760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.184208 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:30.184646 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:14:30.185394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.188343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:30.188816 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:14:30.189503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.206176 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:14:30.206676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:30.207143 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:14:30.208737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.213841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:14:30.214302 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:14:30.215787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.218150 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:14:30.219704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9758a0dd0>]}
[0m06:14:30.220391 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 729.10s]
[0m06:14:30.221198 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:14:30.222127 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:14:30.222793 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:14:30.223400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:14:30.223870 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:14:30.229744 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:14:30.230412 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:14:30.267580 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:30.268183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250320061430260024"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:14:30.268648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:30.277368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.285242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:30.285731 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:14:30.286394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.286853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:30.287285 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250320061430260024'
      
      
      order by ordinal_position

  
[0m06:14:30.291835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.297047 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:30.297515 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:14:30.300076 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.307794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:30.308268 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:14:30.310779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.328972 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:14:30.329732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:30.330204 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250320061430260024"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250320061430260024"
    )
  
[0m06:14:30.381807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.383866 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:14:30.384365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:14:30.384828 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:14:30.392520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:14:30.393466 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:14:30.395179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9d637a-e2fa-46a2-a70f-cee4c28da248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa951f2ba40>]}
[0m06:14:30.395914 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:14:30.396756 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:14:30.398203 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:30.398617 [debug] [MainThread]: On master: BEGIN
[0m06:14:30.399039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:30.399715 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:30.400123 [debug] [MainThread]: On master: COMMIT
[0m06:14:30.400505 [debug] [MainThread]: Using duckdb connection "master"
[0m06:14:30.400908 [debug] [MainThread]: On master: COMMIT
[0m06:14:30.401456 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:14:30.401896 [debug] [MainThread]: On master: Close
[0m06:14:30.402503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:30.402910 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:14:30.403320 [info ] [MainThread]: 
[0m06:14:30.403869 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 12 minutes and 9.96 seconds (729.96s).
[0m06:14:30.404884 [debug] [MainThread]: Command end result
[0m06:14:30.430809 [info ] [MainThread]: 
[0m06:14:30.431476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:14:30.431995 [info ] [MainThread]: 
[0m06:14:30.432500 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:14:30.433519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 732.0297, "process_user_time": 5.398186, "process_kernel_time": 0.272261, "process_mem_max_rss": "304468", "process_in_blocks": "3816", "process_out_blocks": "95544"}
[0m06:14:30.434073 [debug] [MainThread]: Command `dbt run` succeeded at 06:14:30.433970 after 732.03 seconds
[0m06:14:30.434529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa979ea67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97ab7e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa979a85490>]}
[0m06:14:30.434993 [debug] [MainThread]: Flushing usage events
[0m06:14:32.363109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774ed6d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774f27e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774ed6cf50>]}


============================== 06:14:32.366253 | 18010659-6861-488d-bac1-2e86b394fa76 ==============================
[0m06:14:32.366253 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:14:32.366955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:14:32.518530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18010659-6861-488d-bac1-2e86b394fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774ed02510>]}
[0m06:14:32.537226 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22648807, "process_user_time": 1.375531, "process_kernel_time": 0.083971, "process_mem_max_rss": "92640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:14:32.537808 [debug] [MainThread]: Command `dbt clean` succeeded at 06:14:32.537671 after 0.23 seconds
[0m06:14:32.538271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774ed23ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774ec419a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774eed3f80>]}
[0m06:14:32.538738 [debug] [MainThread]: Flushing usage events
[0m14:05:38.615456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d756bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d7e6be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d9bcb0e0>]}


============================== 14:05:38.653393 | 7f6aa4d7-59b0-496f-a697-f54de680607b ==============================
[0m14:05:38.653393 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:38.654079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:38.800661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f6aa4d7-59b0-496f-a697-f54de680607b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d7369df0>]}
[0m14:05:38.815217 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rabrq4wa'
[0m14:05:38.815710 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:38.871127 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:38.871800 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:38.884362 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:38.888284 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:39.041666 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:39.042262 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:39.042799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f6aa4d7-59b0-496f-a697-f54de680607b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d736a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d7369c40>]}
[0m14:05:39.043288 [info ] [MainThread]: 
[0m14:05:39.043775 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:39.058720 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49330047, "process_user_time": 1.484502, "process_kernel_time": 0.11912, "process_mem_max_rss": "94164", "process_in_blocks": "5760", "process_out_blocks": "4008"}
[0m14:05:39.059284 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:39.059176 after 0.49 seconds
[0m14:05:39.059725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d7e6be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d73e1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d826b6b0>]}
[0m14:05:39.060194 [debug] [MainThread]: Flushing usage events
[0m14:05:40.666178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3c055820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3be2c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3bb075f0>]}


============================== 14:05:40.669349 | 698fec31-cff9-45b9-9b33-5891bf3edda8 ==============================
[0m14:05:40.669349 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:40.670082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:40.921690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3b704dd0>]}
[0m14:05:40.986403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3cb51940>]}
[0m14:05:40.989248 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:41.115492 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:41.116307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:41.116873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3bae17f0>]}
[0m14:05:42.557990 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:42.558703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb37848560>]}
[0m14:05:42.754309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:42.804887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb377cd9d0>]}
[0m14:05:42.891192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb37613e00>]}
[0m14:05:42.891761 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:42.892276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb37670e60>]}
[0m14:05:42.894079 [info ] [MainThread]: 
[0m14:05:42.894788 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:42.899685 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:42.936418 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:42.936890 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:42.937325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:43.251602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:43.253690 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:43.254903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:43.255701 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:43.263765 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:43.264234 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:43.264640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:43.265641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:43.267159 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:43.267564 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:43.268193 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:43.268627 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:43.269007 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:43.269655 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:43.270592 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:43.270993 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:43.271410 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:43.271938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:43.272376 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:43.273586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:43.279795 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:43.280258 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:43.280653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:43.281297 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:43.281714 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:43.282146 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:43.296207 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:43.297673 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:43.298913 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:43.299367 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:43.301677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb377f5be0>]}
[0m14:05:43.302216 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.302624 [debug] [MainThread]: On master: BEGIN
[0m14:05:43.303006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:43.303635 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.304071 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.304472 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.304858 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.305425 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.305832 [debug] [MainThread]: On master: Close
[0m14:05:43.306390 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:43.306913 [info ] [MainThread]: 
[0m14:05:43.318245 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:43.318838 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:43.319505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:43.319965 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:43.348074 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:43.348852 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:43.386861 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:43.387641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:34.581909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:34.582454 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:34.583125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.583603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:34.584072 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:34.584789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.587719 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:34.588204 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:34.588882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.605486 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:34.605958 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:34.606418 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:34.607778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.612928 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:34.613434 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:34.614615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.617091 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:34.618721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0cdd0a10>]}
[0m14:10:34.619467 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.30s]
[0m14:10:34.620349 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:34.621319 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:34.621880 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:34.622546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:34.622996 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:34.628847 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:34.629524 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:34.666557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:34.667103 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250320141034660115"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:34.667594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:34.675853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.683685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:34.684183 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:34.684811 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.685297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:34.685749 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250320141034660115'
      
      
      order by ordinal_position

  
[0m14:10:34.690146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.695267 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:34.695760 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:34.698193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.705768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:34.706280 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:34.708920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.726972 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:34.727673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:34.728173 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250320141034660115"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250320141034660115"
    )
  
[0m14:10:34.777189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.779214 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:34.779672 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:34.780136 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:34.787722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:34.788617 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:34.790131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '698fec31-cff9-45b9-9b33-5891bf3edda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0cd700b0>]}
[0m14:10:34.790818 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:34.791583 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:34.792868 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:34.793324 [debug] [MainThread]: On master: BEGIN
[0m14:10:34.793711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:34.794368 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:34.794777 [debug] [MainThread]: On master: COMMIT
[0m14:10:34.795195 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:34.795572 [debug] [MainThread]: On master: COMMIT
[0m14:10:34.796135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:34.796540 [debug] [MainThread]: On master: Close
[0m14:10:34.797178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:34.797560 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:34.797962 [info ] [MainThread]: 
[0m14:10:34.798470 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 51.90 seconds (291.90s).
[0m14:10:34.799473 [debug] [MainThread]: Command end result
[0m14:10:34.825775 [info ] [MainThread]: 
[0m14:10:34.826415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:34.826954 [info ] [MainThread]: 
[0m14:10:34.827529 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:34.828538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.21698, "process_user_time": 5.242214, "process_kernel_time": 0.301299, "process_mem_max_rss": "303296", "process_in_blocks": "3816", "process_out_blocks": "95544"}
[0m14:10:34.829114 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:34.828981 after 294.22 seconds
[0m14:10:34.829575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3deafa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3ca130b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb344be240>]}
[0m14:10:34.830020 [debug] [MainThread]: Flushing usage events
[0m14:10:36.616806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47026f1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4701e9ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4701fa2d20>]}


============================== 14:10:36.619786 | 4f90ce8d-15de-4130-abf6-57d0466f0c20 ==============================
[0m14:10:36.619786 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:36.620506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:36.760399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f90ce8d-15de-4130-abf6-57d0466f0c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47021f8860>]}
[0m14:10:36.778398 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21172963, "process_user_time": 1.341705, "process_kernel_time": 0.100977, "process_mem_max_rss": "92684", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:36.778905 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:36.778806 after 0.21 seconds
[0m14:10:36.779363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4701c2cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4701b79fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4701b79850>]}
[0m14:10:36.779787 [debug] [MainThread]: Flushing usage events
[0m22:05:36.983547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384afded20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384b1ec1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384afde8a0>]}


============================== 22:05:36.991678 | e95a3527-b897-4b85-9121-bd82c4bfcb45 ==============================
[0m22:05:36.991678 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:36.992373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.133726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e95a3527-b897-4b85-9121-bd82c4bfcb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384be33b30>]}
[0m22:05:37.147193 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9of74_ie'
[0m22:05:37.147659 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:37.278455 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:37.279135 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:37.289457 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:37.293371 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:37.343287 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:37.343836 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:37.344427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e95a3527-b897-4b85-9121-bd82c4bfcb45', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384ab08c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384ab8b4a0>]}
[0m22:05:37.344877 [info ] [MainThread]: 
[0m22:05:37.345417 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:37.347119 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41274133, "process_user_time": 1.483068, "process_kernel_time": 0.10993, "process_mem_max_rss": "94016", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m22:05:37.347662 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:37.347560 after 0.41 seconds
[0m22:05:37.348087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384d4ab9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384ae3d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f384ac3daf0>]}
[0m22:05:37.348531 [debug] [MainThread]: Flushing usage events
[0m22:05:38.784517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62ddf3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62d43cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62d43c980>]}


============================== 22:05:38.787379 | 053f3f19-35b5-45f4-83cc-e5618780f0be ==============================
[0m22:05:38.787379 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.788008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:39.033630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62d219970>]}
[0m22:05:39.100782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62e340350>]}
[0m22:05:39.103582 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:39.165050 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:39.165786 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:39.166373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62921dfa0>]}
[0m22:05:40.485072 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:40.485768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa629152de0>]}
[0m22:05:40.681139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:40.730746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6290724e0>]}
[0m22:05:41.014544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa628f38110>]}
[0m22:05:41.015347 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:41.016004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa628f70a70>]}
[0m22:05:41.018227 [info ] [MainThread]: 
[0m22:05:41.019063 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:41.024472 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:41.062382 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:41.063044 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:41.063665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:41.765385 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:41.766964 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:41.767986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:41.768566 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:41.775960 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.776411 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:41.776812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:41.777729 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.779121 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.779551 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:41.780119 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.780536 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.780908 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:41.781502 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.782432 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:41.782833 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:41.783222 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:41.783750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.784144 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:41.785354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:41.790932 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:41.791361 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:41.791735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:41.792365 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.792764 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:41.793147 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:41.806989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:41.808437 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:41.809662 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:41.810070 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:41.812247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62e99ee10>]}
[0m22:05:41.812756 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.813141 [debug] [MainThread]: On master: BEGIN
[0m22:05:41.813531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:41.814131 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.814577 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.814950 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.815335 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.815874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.816297 [debug] [MainThread]: On master: Close
[0m22:05:41.816817 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:41.817295 [info ] [MainThread]: 
[0m22:05:41.833923 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:41.834599 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:41.835205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:41.835659 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:41.862013 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:41.862763 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:41.898635 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:41.899380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:34.311556 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.312052 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:34.312698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.313143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.313592 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:34.314288 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.317081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.317547 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:34.318221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.334613 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:34.335085 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.335538 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:34.336702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.341581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:34.342038 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:34.343246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.345517 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:34.347009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6279b5a30>]}
[0m22:10:34.347696 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.51s]
[0m22:10:34.348532 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:34.349496 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:34.350065 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:34.350767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:34.351231 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:34.356745 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:34.357412 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:34.392008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.392522 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250320221034386056"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:34.392988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:34.400652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.407852 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.408318 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:34.408943 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.409417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.409848 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250320221034386056'
      
      
      order by ordinal_position

  
[0m22:10:34.414498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.419430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.419886 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:34.422337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.430037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.430534 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:34.432846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.450604 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:34.451296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.451759 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250320221034386056"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250320221034386056"
    )
  
[0m22:10:34.502072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.504094 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:34.504565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:34.504984 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:34.512645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:34.513537 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:34.515429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053f3f19-35b5-45f4-83cc-e5618780f0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa624027e90>]}
[0m22:10:34.516091 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:10:34.516908 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:34.518223 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:34.518636 [debug] [MainThread]: On master: BEGIN
[0m22:10:34.519010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:34.519656 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:34.520058 [debug] [MainThread]: On master: COMMIT
[0m22:10:34.520469 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:34.520835 [debug] [MainThread]: On master: COMMIT
[0m22:10:34.521389 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:34.521786 [debug] [MainThread]: On master: Close
[0m22:10:34.522433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:34.522824 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:34.523244 [info ] [MainThread]: 
[0m22:10:34.523760 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.50 seconds (293.50s).
[0m22:10:34.524752 [debug] [MainThread]: Command end result
[0m22:10:34.550039 [info ] [MainThread]: 
[0m22:10:34.550655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:34.551189 [info ] [MainThread]: 
[0m22:10:34.551717 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:34.552680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.81833, "process_user_time": 5.399634, "process_kernel_time": 0.315095, "process_mem_max_rss": "305116", "process_in_blocks": "3816", "process_out_blocks": "95584"}
[0m22:10:34.553224 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:34.553100 after 295.82 seconds
[0m22:10:34.553660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62d43c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa62d1656d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60c0dce00>]}
[0m22:10:34.554085 [debug] [MainThread]: Flushing usage events
[0m22:10:36.323602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f0fa2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f13b27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f1c51dc0>]}


============================== 22:10:36.326496 | 3e0cc18a-da33-44be-a28e-5e4ffffaa461 ==============================
[0m22:10:36.326496 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:36.327187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:36.465995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e0cc18a-da33-44be-a28e-5e4ffffaa461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f0bdcc20>]}
[0m22:10:36.483980 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2100603, "process_user_time": 1.297187, "process_kernel_time": 0.114928, "process_mem_max_rss": "92852", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:10:36.484509 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:36.484406 after 0.21 seconds
[0m22:10:36.484932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f1865fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f1941a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60f07e7b90>]}
[0m22:10:36.485374 [debug] [MainThread]: Flushing usage events
[0m06:02:10.761305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aaed41880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aaed1fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aae47f890>]}


============================== 06:02:10.774294 | 0c18af17-234b-4423-a8da-d952e34e6d80 ==============================
[0m06:02:10.774294 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.774983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.919734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c18af17-234b-4423-a8da-d952e34e6d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab03704a0>]}
[0m06:02:10.933283 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-synbt9v9'
[0m06:02:10.933788 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.166064 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.166866 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.200044 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.204089 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.584723 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.585363 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:11.585962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0c18af17-234b-4423-a8da-d952e34e6d80', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aae211c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aae212870>]}
[0m06:02:11.586454 [info ] [MainThread]: 
[0m06:02:11.586944 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:11.656599 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9450162, "process_user_time": 1.482653, "process_kernel_time": 0.126225, "process_mem_max_rss": "94244", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m06:02:11.657206 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.657105 after 0.95 seconds
[0m06:02:11.657717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab0b42ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab03704a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aae7255b0>]}
[0m06:02:11.658150 [debug] [MainThread]: Flushing usage events
[0m06:02:13.316448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f729ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f6e8eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f6e8d820>]}


============================== 06:02:13.319601 | c490a149-def0-47db-954f-3f2d8980c5ae ==============================
[0m06:02:13.319601 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.320265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.558280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f66ba3f0>]}
[0m06:02:13.617011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f6be0a70>]}
[0m06:02:13.619614 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:13.698760 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.699545 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.700093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f65c36b0>]}
[0m06:02:14.987760 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.988442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f26933e0>]}
[0m06:02:15.175550 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:15.239477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f25648f0>]}
[0m06:02:15.341215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f24168a0>]}
[0m06:02:15.341827 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:15.342334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f2432ff0>]}
[0m06:02:15.344130 [info ] [MainThread]: 
[0m06:02:15.344845 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:15.349640 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:15.386185 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:15.386721 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:15.387120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.927891 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:15.929762 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.930815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.931572 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.942227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.942901 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.943363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.944650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.946186 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.946622 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.947222 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.947650 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.948024 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.948647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.949602 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.949996 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.950363 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.950953 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.951353 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.952712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.958552 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.958962 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.959333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.960012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.960423 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.960812 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.975249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.976928 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.978216 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.978645 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.981003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f7e9f110>]}
[0m06:02:15.981557 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.981960 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.982336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.983048 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.983474 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.983858 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.984223 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.984809 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.985207 [debug] [MainThread]: On master: Close
[0m06:02:15.985784 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.986253 [info ] [MainThread]: 
[0m06:02:15.997953 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.998615 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.999214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:15.999681 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:16.026900 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:16.027809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:16.064118 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:16.064991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:10.460845 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.461352 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:10.462039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.462530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.462965 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:10.463722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.466603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.467062 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:10.467781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.484236 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:10.484721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.485151 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:10.486857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.491789 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.492246 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:10.493370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.495667 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:10.497162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7cdf5b860>]}
[0m06:07:10.497855 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 294.50s]
[0m06:07:10.498618 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:10.499427 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:10.500167 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:10.500784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:10.501226 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:10.506914 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:10.507568 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:10.542450 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.542943 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250321060710536533"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:10.543417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:10.551539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.558853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.559307 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:10.559942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.560380 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.560857 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250321060710536533'
      
      
      order by ordinal_position

  
[0m06:07:10.565446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.570416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.570889 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:10.573364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.580747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.581216 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:10.583708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.601662 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:10.602325 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.602808 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250321060710536533"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250321060710536533"
    )
  
[0m06:07:10.651865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.653836 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:10.654284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.654725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:10.662514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.663409 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:10.665066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c490a149-def0-47db-954f-3f2d8980c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f00b8920>]}
[0m06:07:10.665759 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:10.666515 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:10.667857 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:10.668277 [debug] [MainThread]: On master: BEGIN
[0m06:07:10.668696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:10.669324 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:10.669749 [debug] [MainThread]: On master: COMMIT
[0m06:07:10.670124 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:10.670525 [debug] [MainThread]: On master: COMMIT
[0m06:07:10.671077 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:10.671507 [debug] [MainThread]: On master: Close
[0m06:07:10.672124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:10.672541 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:10.672946 [info ] [MainThread]: 
[0m06:07:10.673459 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 55.33 seconds (295.33s).
[0m06:07:10.674399 [debug] [MainThread]: Command end result
[0m06:07:10.699839 [info ] [MainThread]: 
[0m06:07:10.700427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:10.700916 [info ] [MainThread]: 
[0m06:07:10.701421 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:10.702377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 297.43683, "process_user_time": 5.240606, "process_kernel_time": 0.284358, "process_mem_max_rss": "306100", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m06:07:10.702916 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:10.702818 after 297.44 seconds
[0m06:07:10.703348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f8ec7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f6894dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f6c9e660>]}
[0m06:07:10.703801 [debug] [MainThread]: Flushing usage events
[0m06:07:12.658827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69da8636e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d83d69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d87fa3c0>]}


============================== 06:07:12.661769 | bd1171be-7500-4a3c-bb41-e09a2de31533 ==============================
[0m06:07:12.661769 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:12.662434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:12.801659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd1171be-7500-4a3c-bb41-e09a2de31533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d931fce0>]}
[0m06:07:12.819295 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21047334, "process_user_time": 1.296196, "process_kernel_time": 0.109016, "process_mem_max_rss": "93092", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:12.819859 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:12.819760 after 0.21 seconds
[0m06:07:12.820282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69dc2d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d822bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d81de090>]}
[0m06:07:12.820725 [debug] [MainThread]: Flushing usage events
[0m14:05:17.797350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982144d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc981e875f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982eee660>]}


============================== 14:05:17.812735 | 3c104f68-da6d-4465-b0cb-150e780a15ff ==============================
[0m14:05:17.812735 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.813425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.954406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c104f68-da6d-4465-b0cb-150e780a15ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc981ba1340>]}
[0m14:05:17.967863 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-obrhkba8'
[0m14:05:17.968346 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:18.004153 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:18.004800 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:18.015998 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:18.019980 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:18.247275 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:18.247833 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:18.248383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3c104f68-da6d-4465-b0cb-150e780a15ff', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982d3ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982d3c9e0>]}
[0m14:05:18.248843 [info ] [MainThread]: 
[0m14:05:18.249346 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:18.251346 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5031369, "process_user_time": 1.475805, "process_kernel_time": 0.133162, "process_mem_max_rss": "94148", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:05:18.251871 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:18.251771 after 0.50 seconds
[0m14:05:18.252321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc985bbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc982624140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc981e2deb0>]}
[0m14:05:18.252744 [debug] [MainThread]: Flushing usage events
[0m14:05:19.937344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f1712840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f07f26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f07f38f0>]}


============================== 14:05:19.940238 | 6bb26fa5-6016-4fcf-a049-6b61a9ffac3b ==============================
[0m14:05:19.940238 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:19.940860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.175471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ebd1dfa0>]}
[0m14:05:20.234369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f0bae600>]}
[0m14:05:20.236854 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:20.263085 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:20.263804 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:20.264347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ebd48350>]}
[0m14:05:21.575799 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:21.576451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb961550>]}
[0m14:05:21.761473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:21.806900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ebadfe30>]}
[0m14:05:21.888691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb91cbf0>]}
[0m14:05:21.889253 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:21.889752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ebab4b30>]}
[0m14:05:21.891467 [info ] [MainThread]: 
[0m14:05:21.892156 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:21.896867 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:21.932246 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:21.932704 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:21.933104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:22.307914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.309564 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:22.310594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:22.311291 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:22.320241 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.320765 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:22.321254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.322242 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.323681 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.324089 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:22.324687 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.325089 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.325505 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:22.326089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.327028 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.327459 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:22.327850 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:22.328423 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.328830 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:22.330126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:22.335978 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.336445 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:22.336827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.337540 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.338147 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:22.338818 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:22.354185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:22.355803 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:22.357063 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:22.357501 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:22.359726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ebab4410>]}
[0m14:05:22.360272 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.360682 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.361054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:22.361696 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.362100 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.362514 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.362882 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.363445 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.363844 [debug] [MainThread]: On master: Close
[0m14:05:22.364394 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:22.364907 [info ] [MainThread]: 
[0m14:05:22.376421 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:22.377057 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:22.377645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:22.378094 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:22.405000 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:22.405768 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:22.441581 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:22.442328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:16.623257 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.623782 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:16.624427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.624896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.625356 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:16.626055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.628965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.629429 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:16.630092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.646508 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:16.647003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.647475 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:16.648734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.653750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:16.654217 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:16.655524 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.657851 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:16.659377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9dad54980>]}
[0m14:10:16.660056 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 294.28s]
[0m14:10:16.660836 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:16.661673 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:16.662263 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:16.663007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:16.663520 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:16.669188 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:16.669855 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:16.704754 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.705265 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250321141016698801"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:16.705736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:16.713891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.721254 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.721714 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:16.722317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.722760 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.723194 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250321141016698801'
      
      
      order by ordinal_position

  
[0m14:10:16.727548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.732524 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.733009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:16.735301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.742673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.743137 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:16.745724 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.763658 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:16.764346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.764819 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250321141016698801"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250321141016698801"
    )
  
[0m14:10:16.819509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.821472 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:16.821920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:16.822364 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:16.828955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:16.829844 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:16.831348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb26fa5-6016-4fcf-a049-6b61a9ffac3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb983620>]}
[0m14:10:16.832016 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:16.832761 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:16.834347 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:16.834757 [debug] [MainThread]: On master: BEGIN
[0m14:10:16.835136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:16.835787 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:16.836184 [debug] [MainThread]: On master: COMMIT
[0m14:10:16.836590 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:16.836955 [debug] [MainThread]: On master: COMMIT
[0m14:10:16.837509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:16.837903 [debug] [MainThread]: On master: Close
[0m14:10:16.838489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:16.838859 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:16.839284 [info ] [MainThread]: 
[0m14:10:16.839767 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.95 seconds (294.95s).
[0m14:10:16.840710 [debug] [MainThread]: Command end result
[0m14:10:16.865939 [info ] [MainThread]: 
[0m14:10:16.866539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:16.867022 [info ] [MainThread]: 
[0m14:10:16.867537 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:16.868522 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.98175, "process_user_time": 5.041259, "process_kernel_time": 0.310385, "process_mem_max_rss": "303928", "process_in_blocks": "3816", "process_out_blocks": "95544"}
[0m14:10:16.869036 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:16.868937 after 296.98 seconds
[0m14:10:16.869501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f3cd3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9efb65100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea3df8c0>]}
[0m14:10:16.869941 [debug] [MainThread]: Flushing usage events
[0m14:10:18.854241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6005fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6005e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5fc84bf0>]}


============================== 14:10:18.857094 | 0e5da7c3-56bb-4039-a390-36fe30f97e67 ==============================
[0m14:10:18.857094 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:18.857799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:10:18.998428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e5da7c3-56bb-4039-a390-36fe30f97e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6005e1b0>]}
[0m14:10:19.016399 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21222961, "process_user_time": 1.336195, "process_kernel_time": 0.096941, "process_mem_max_rss": "92952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:19.016905 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:19.016807 after 0.21 seconds
[0m14:10:19.017356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5faba8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6005e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5ff63320>]}
[0m14:10:19.017780 [debug] [MainThread]: Flushing usage events
[0m22:05:49.022049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ad49fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab43af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab43ac30>]}


============================== 22:05:49.037656 | 8a5d18de-082e-41c5-a1e0-1d5b974f4a62 ==============================
[0m22:05:49.037656 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:49.038328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:49.179038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a5d18de-082e-41c5-a1e0-1d5b974f4a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab43aed0>]}
[0m22:05:49.192100 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ldtwidd_'
[0m22:05:49.192603 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:49.306546 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:49.307178 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:49.318010 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:49.321922 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:49.369821 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:49.370365 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:49.370887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8a5d18de-082e-41c5-a1e0-1d5b974f4a62', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab148710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab0b6e40>]}
[0m22:05:49.371356 [info ] [MainThread]: 
[0m22:05:49.371809 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:49.373260 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39969286, "process_user_time": 1.464743, "process_kernel_time": 0.120978, "process_mem_max_rss": "94128", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m22:05:49.373812 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:49.373710 after 0.40 seconds
[0m22:05:49.374239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98af2d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab43aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab3eb950>]}
[0m22:05:49.374695 [debug] [MainThread]: Flushing usage events
[0m22:05:50.784079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a56fb31a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a57400fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a56deaa20>]}


============================== 22:05:50.786812 | 869a2631-de43-41be-8d2e-b40c381db5e2 ==============================
[0m22:05:50.786812 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.787434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:51.039868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a565d8bc0>]}
[0m22:05:51.104665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a57b650a0>]}
[0m22:05:51.107084 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:51.291364 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:51.292170 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:51.292726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a563b7bc0>]}
[0m22:05:52.639038 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:52.639727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a525c1c40>]}
[0m22:05:52.844761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:52.892484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a57ac4f80>]}
[0m22:05:52.993485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a52110980>]}
[0m22:05:52.994008 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:52.994527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a56f75d30>]}
[0m22:05:52.996234 [info ] [MainThread]: 
[0m22:05:52.996939 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:53.001614 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:53.036897 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:53.037353 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:53.037753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:53.639831 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:53.641935 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:53.642823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:53.643398 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:53.650821 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:53.651250 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:53.651668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:53.652563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:53.653973 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:53.654396 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:53.654956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:53.655369 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:53.655760 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:53.656369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:53.657273 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:53.657693 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:53.658064 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:53.658614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:53.659013 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:53.660406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:53.666020 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:53.666453 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:53.666829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:53.667446 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:53.667845 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:53.668230 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:53.682248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:53.683699 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:53.684936 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:53.685366 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:53.687551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a51f71070>]}
[0m22:05:53.688045 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:53.688467 [debug] [MainThread]: On master: BEGIN
[0m22:05:53.688834 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:53.689463 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:53.689867 [debug] [MainThread]: On master: COMMIT
[0m22:05:53.690242 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:53.690651 [debug] [MainThread]: On master: COMMIT
[0m22:05:53.691180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:53.691611 [debug] [MainThread]: On master: Close
[0m22:05:53.692128 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:53.692631 [info ] [MainThread]: 
[0m22:05:53.703508 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:53.704096 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:53.704747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:53.705197 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:53.731715 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:53.732477 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:53.768137 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:53.768881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:39.762851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:39.763372 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:39.764047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.764532 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:39.764959 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:39.765672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.768510 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:39.768957 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:39.769694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.786097 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:39.786584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:39.787013 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:39.788177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.793072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:39.793548 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:39.794689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.796973 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:39.798495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a489f0c20>]}
[0m22:10:39.799170 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 286.09s]
[0m22:10:39.799953 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:39.800757 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:39.801480 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:39.802136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:39.802646 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:39.808129 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:39.808773 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:39.843001 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:39.843506 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250321221039837104"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:39.843968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:39.851745 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.858898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:39.859371 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:39.859974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.860432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:39.860858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250321221039837104'
      
      
      order by ordinal_position

  
[0m22:10:39.865397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.870279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:39.870758 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:39.874071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.881484 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:39.881945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:39.885244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.902880 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:39.903558 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:39.904024 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250321221039837104"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250321221039837104"
    )
  
[0m22:10:39.953193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.955185 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:39.955652 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:39.956072 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:39.963650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:39.964550 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:39.966179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869a2631-de43-41be-8d2e-b40c381db5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a563b5340>]}
[0m22:10:39.966884 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:10:39.967731 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:39.969027 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:39.969487 [debug] [MainThread]: On master: BEGIN
[0m22:10:39.969878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:39.970531 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:39.970948 [debug] [MainThread]: On master: COMMIT
[0m22:10:39.971364 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:39.971748 [debug] [MainThread]: On master: COMMIT
[0m22:10:39.972277 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:39.972718 [debug] [MainThread]: On master: Close
[0m22:10:39.973327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:39.973714 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:39.974121 [info ] [MainThread]: 
[0m22:10:39.974633 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 46.98 seconds (286.98s).
[0m22:10:39.975585 [debug] [MainThread]: Command end result
[0m22:10:40.000799 [info ] [MainThread]: 
[0m22:10:40.001392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:40.001882 [info ] [MainThread]: 
[0m22:10:40.002393 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:40.003391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 289.26752, "process_user_time": 5.299045, "process_kernel_time": 0.311472, "process_mem_max_rss": "305168", "process_in_blocks": "3816", "process_out_blocks": "95584"}
[0m22:10:40.003912 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:40.003813 after 289.27 seconds
[0m22:10:40.004365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a57400fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a522fafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a56996720>]}
[0m22:10:40.004802 [debug] [MainThread]: Flushing usage events
[0m22:10:41.771730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9d3e9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9cfcf2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9cfcfd40>]}


============================== 22:10:41.774569 | 9ef64eb2-aa04-4036-9d00-692416e4654b ==============================
[0m22:10:41.774569 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:41.775214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:41.915262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ef64eb2-aa04-4036-9d00-692416e4654b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9c843140>]}
[0m22:10:41.933106 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21195124, "process_user_time": 1.320299, "process_kernel_time": 0.09202, "process_mem_max_rss": "93100", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:10:41.933634 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:41.933532 after 0.21 seconds
[0m22:10:41.934059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9d0119a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9f00f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aa05bbda0>]}
[0m22:10:41.934515 [debug] [MainThread]: Flushing usage events
[0m06:02:12.587743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91fc921be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91fbffc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91fbda95b0>]}


============================== 06:02:12.603201 | 9115fbe9-e9d1-484b-92ba-9bd061405043 ==============================
[0m06:02:12.603201 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.603882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.743693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9115fbe9-e9d1-484b-92ba-9bd061405043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91fb8062a0>]}
[0m06:02:12.757179 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uegzgt7w'
[0m06:02:12.757628 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:12.862696 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:12.863486 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:12.887208 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:12.891175 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.959702 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.960231 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:12.960758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9115fbe9-e9d1-484b-92ba-9bd061405043', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91fbda95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91fc9407d0>]}
[0m06:02:12.961244 [info ] [MainThread]: 
[0m06:02:12.961724 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:12.971084 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43245947, "process_user_time": 1.473649, "process_kernel_time": 0.138778, "process_mem_max_rss": "94320", "process_in_blocks": "5728", "process_out_blocks": "4000"}
[0m06:02:12.971620 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:12.971519 after 0.43 seconds
[0m06:02:12.972077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91fc995400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91fb9d8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91fc301ac0>]}
[0m06:02:12.972503 [debug] [MainThread]: Flushing usage events
[0m06:02:14.416337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972ceb39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972c518cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972ceb3d70>]}


============================== 06:02:14.419290 | 11ef3820-b967-42f8-a317-9b2bb72bebbd ==============================
[0m06:02:14.419290 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.419960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.651350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972c2b6cc0>]}
[0m06:02:14.710507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972c897ec0>]}
[0m06:02:14.713054 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:14.749585 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:14.750316 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:14.750845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972c1c7b90>]}
[0m06:02:16.043960 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.044641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97282c6c60>]}
[0m06:02:16.228918 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.274915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97281cc830>]}
[0m06:02:16.356966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97280381d0>]}
[0m06:02:16.357498 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:16.358054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97281fc6b0>]}
[0m06:02:16.359740 [info ] [MainThread]: 
[0m06:02:16.360411 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.365041 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.400298 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.400756 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.401181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:16.791498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.793452 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:16.794660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:16.795402 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:16.803107 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.803540 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:16.803927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.804806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.806227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.806626 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:16.807204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.807594 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.807996 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:16.808618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.809547 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.809964 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.810344 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.810905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.811328 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:16.812522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:16.818187 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.818592 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:16.818981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.819642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.820059 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.820446 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:16.834879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.836347 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:16.837581 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:16.838012 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:16.840266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972daa2f60>]}
[0m06:02:16.840777 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.841221 [debug] [MainThread]: On master: BEGIN
[0m06:02:16.841594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:16.842215 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.842617 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.843025 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.843399 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.843966 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.844373 [debug] [MainThread]: On master: Close
[0m06:02:16.844909 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:16.845433 [info ] [MainThread]: 
[0m06:02:16.856399 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:16.857007 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:16.857584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:16.858046 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:16.885008 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:16.885741 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:16.921741 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:16.922481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:08.531304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.531816 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:08.532479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.532924 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.533381 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:08.534122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.537086 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.537533 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:08.538218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.554736 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:08.555234 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.555669 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:08.556979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.561969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.562431 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:08.563635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.565971 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:08.567474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fc14fec0>]}
[0m06:07:08.568190 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.71s]
[0m06:07:08.569030 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:08.569823 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:08.570575 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:08.571237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:08.571688 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:08.577468 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:08.578134 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:08.613359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.613903 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250322060708607324"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:08.614392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:08.622395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.630106 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.630567 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:08.631277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.631715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.632169 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250322060708607324'
      
      
      order by ordinal_position

  
[0m06:07:08.636742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.641898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.642383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:08.644809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.652399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.652877 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:08.655260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.673188 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:08.673885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.674370 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250322060708607324"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250322060708607324"
    )
  
[0m06:07:08.726987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.728972 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:08.729440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.729866 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:08.736915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.737827 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:08.739239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11ef3820-b967-42f8-a317-9b2bb72bebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96fc17d0d0>]}
[0m06:07:08.739907 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:08.740739 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:08.742117 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:08.742532 [debug] [MainThread]: On master: BEGIN
[0m06:07:08.742914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:08.743595 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:08.744039 [debug] [MainThread]: On master: COMMIT
[0m06:07:08.744428 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:08.744801 [debug] [MainThread]: On master: COMMIT
[0m06:07:08.745384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:08.745781 [debug] [MainThread]: On master: Close
[0m06:07:08.746425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:08.746798 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:08.747221 [info ] [MainThread]: 
[0m06:07:08.747701 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.39 seconds (292.39s).
[0m06:07:08.748608 [debug] [MainThread]: Command end result
[0m06:07:08.774082 [info ] [MainThread]: 
[0m06:07:08.774657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:08.775151 [info ] [MainThread]: 
[0m06:07:08.775638 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:08.776620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.4103, "process_user_time": 5.044362, "process_kernel_time": 0.265124, "process_mem_max_rss": "299828", "process_in_blocks": "3816", "process_out_blocks": "95544"}
[0m06:07:08.777186 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:08.777082 after 294.41 seconds
[0m06:07:08.777627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972ceb2630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f971c5eee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972c8960c0>]}
[0m06:07:08.778084 [debug] [MainThread]: Flushing usage events
[0m06:07:10.604743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f79d23710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f777910d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f77b46a80>]}


============================== 06:07:10.607779 | 8b4ba8aa-3bac-4c88-95c0-5a3cfe807f9b ==============================
[0m06:07:10.607779 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:10.608467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:10.749857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b4ba8aa-3bac-4c88-95c0-5a3cfe807f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f77724e90>]}
[0m06:07:10.767740 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21353227, "process_user_time": 1.321867, "process_kernel_time": 0.104989, "process_mem_max_rss": "92776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:10.768290 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:10.768189 after 0.21 seconds
[0m06:07:10.768731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f778ecb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f7b7bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f77665640>]}
[0m06:07:10.769182 [debug] [MainThread]: Flushing usage events
[0m14:04:52.436014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2cf09ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2bc9a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2aedb8f0>]}


============================== 14:04:52.444641 | 119fa8d7-c0b9-4d5c-bd20-dce5ab028e52 ==============================
[0m14:04:52.444641 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:52.445370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:52.590564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '119fa8d7-c0b9-4d5c-bd20-dce5ab028e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2aba6bd0>]}
[0m14:04:52.604231 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hwj76h1v'
[0m14:04:52.604690 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:52.717137 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:52.717797 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:52.749298 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:52.753196 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:53.085710 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:53.086305 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:53.086848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '119fa8d7-c0b9-4d5c-bd20-dce5ab028e52', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2abecda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2abecd70>]}
[0m14:04:53.087333 [info ] [MainThread]: 
[0m14:04:53.087821 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:53.089634 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7030293, "process_user_time": 1.48595, "process_kernel_time": 0.127769, "process_mem_max_rss": "94508", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m14:04:53.090185 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:53.090059 after 0.70 seconds
[0m14:04:53.090621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2edbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2d5433e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2d541880>]}
[0m14:04:53.091083 [debug] [MainThread]: Flushing usage events
[0m14:04:54.886559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411e798ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411dc7c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411dddacc0>]}


============================== 14:04:54.889550 | 02ef1985-52d6-4f1b-ada9-dedf24f1bde8 ==============================
[0m14:04:54.889550 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:54.890265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:55.126565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411dc1d670>]}
[0m14:04:55.185487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411dc950a0>]}
[0m14:04:55.188059 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:04:55.213850 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:55.214593 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:55.215158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411dc1ede0>]}
[0m14:04:56.511682 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:56.512337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4119c56e70>]}
[0m14:04:56.697182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:56.745440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4119a77680>]}
[0m14:04:56.843805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411991e780>]}
[0m14:04:56.844359 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:04:56.844858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4119aea060>]}
[0m14:04:56.846611 [info ] [MainThread]: 
[0m14:04:56.847308 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:56.851952 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:56.887667 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:56.888151 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:56.888573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:57.397276 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:57.399042 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:57.400081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:57.400713 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:57.409260 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:57.409774 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:57.410248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:57.411331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.412928 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:57.413487 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:57.414188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.414618 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:57.415029 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:57.415644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.416657 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:57.417059 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:57.417462 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:57.418007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.418445 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:57.419683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:57.425466 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:57.425876 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:57.426274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:57.426883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.427317 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:57.427712 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:57.441646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:57.443149 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:57.444393 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:57.444796 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:57.447278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4119ad1580>]}
[0m14:04:57.447785 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.448210 [debug] [MainThread]: On master: BEGIN
[0m14:04:57.448584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:57.449230 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.449642 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.450025 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.450428 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.450999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.451423 [debug] [MainThread]: On master: Close
[0m14:04:57.451950 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:57.452484 [info ] [MainThread]: 
[0m14:04:57.464371 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:57.464970 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:57.465626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:04:57.466074 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:57.492828 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:57.493593 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:57.529427 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:57.530228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:58.546295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:58.546814 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:58.547466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.547917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:58.548367 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:58.549051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.551950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:58.552410 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:58.553061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.569370 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:58.569836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:58.570284 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:58.571374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.576334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:58.576792 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:09:58.578048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.580362 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:58.581857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4119b028a0>]}
[0m14:09:58.582547 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 301.12s]
[0m14:09:58.583311 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:58.584251 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:58.584794 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:58.585394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:58.585832 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:58.591397 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:58.592045 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:58.626327 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:58.626830 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250322140958620412"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:58.627325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:58.635740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.643183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:58.643636 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:58.644257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.644695 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:58.645146 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250322140958620412'
      
      
      order by ordinal_position

  
[0m14:09:58.649479 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.654530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:58.654993 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:58.657303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.664967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:58.665453 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:58.667778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.685539 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:58.686335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:58.686818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250322140958620412"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250322140958620412"
    )
  
[0m14:09:58.743391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.745353 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:58.745805 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:58.746246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:58.753502 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:58.754461 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:58.756061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02ef1985-52d6-4f1b-ada9-dedf24f1bde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4119c55a60>]}
[0m14:09:58.756755 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:58.757589 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:58.758932 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:58.759385 [debug] [MainThread]: On master: BEGIN
[0m14:09:58.759765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:58.760470 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:58.760879 [debug] [MainThread]: On master: COMMIT
[0m14:09:58.761291 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:58.761662 [debug] [MainThread]: On master: COMMIT
[0m14:09:58.762201 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:58.762597 [debug] [MainThread]: On master: Close
[0m14:09:58.763229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:58.763603 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:58.764012 [info ] [MainThread]: 
[0m14:09:58.764566 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 5 minutes and 1.92 seconds (301.92s).
[0m14:09:58.765555 [debug] [MainThread]: Command end result
[0m14:09:58.791112 [info ] [MainThread]: 
[0m14:09:58.791790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:58.792344 [info ] [MainThread]: 
[0m14:09:58.792931 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:58.794000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 303.95773, "process_user_time": 5.197625, "process_kernel_time": 0.275767, "process_mem_max_rss": "306784", "process_in_blocks": "3816", "process_out_blocks": "95544"}
[0m14:09:58.794581 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:58.794478 after 303.96 seconds
[0m14:09:58.795054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4121cd3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411db69460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411e1f9a00>]}
[0m14:09:58.795553 [debug] [MainThread]: Flushing usage events
[0m14:10:00.808457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a0f967b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89f4f38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89f8ae9f0>]}


============================== 14:10:00.811379 | bec8a88d-8372-475f-af24-ca75c156bb9e ==============================
[0m14:10:00.811379 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:00.812052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:00.952698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bec8a88d-8372-475f-af24-ca75c156bb9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89eb7cb00>]}
[0m14:10:00.970828 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21262076, "process_user_time": 1.323321, "process_kernel_time": 0.099024, "process_mem_max_rss": "92840", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:10:00.971364 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:00.971263 after 0.21 seconds
[0m14:10:00.971797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89eeaffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89e9028d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89eb7cb00>]}
[0m14:10:00.972251 [debug] [MainThread]: Flushing usage events
[0m22:05:53.326042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38795e3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387a4a6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38795e3920>]}


============================== 22:05:53.346208 | fd4cbaf0-d6a3-4c6f-bc52-611351dd5c7c ==============================
[0m22:05:53.346208 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.346895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.494440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd4cbaf0-d6a3-4c6f-bc52-611351dd5c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3879628200>]}
[0m22:05:53.508001 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gthvg_ts'
[0m22:05:53.508473 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:53.564487 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:53.565155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:53.577929 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:53.581821 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:53.716310 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:53.716865 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:53.717386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fd4cbaf0-d6a3-4c6f-bc52-611351dd5c7c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387a61d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387a61c9e0>]}
[0m22:05:53.717872 [info ] [MainThread]: 
[0m22:05:53.718352 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:53.733540 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4565566, "process_user_time": 1.477642, "process_kernel_time": 0.121299, "process_mem_max_rss": "94356", "process_in_blocks": "5728", "process_out_blocks": "4008"}
[0m22:05:53.734115 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:53.734011 after 0.46 seconds
[0m22:05:53.734547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387973ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38793e1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3879407a40>]}
[0m22:05:53.735010 [debug] [MainThread]: Flushing usage events
[0m22:05:55.221167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69aad0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69aef3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69aef0200>]}


============================== 22:05:55.224110 | 6a243c5b-39e2-45e7-b700-4444e38ca67a ==============================
[0m22:05:55.224110 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:55.224782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:55.457454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69a8aa720>]}
[0m22:05:55.516387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69ba1abd0>]}
[0m22:05:55.518860 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:55.559080 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:55.559823 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:55.560367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69a90b140>]}
[0m22:05:56.847846 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:56.848519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69bf411c0>]}
[0m22:05:57.036048 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:57.084378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6967aeb40>]}
[0m22:05:57.167722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6966642f0>]}
[0m22:05:57.168256 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:57.168734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6967b38f0>]}
[0m22:05:57.170465 [info ] [MainThread]: 
[0m22:05:57.171164 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:57.175743 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:57.210893 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:57.211342 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:57.211741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:57.649074 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.650687 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:57.651823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:57.652390 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:57.659967 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.660403 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:57.660824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:57.661864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.663326 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.663741 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:57.664334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.664726 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.665129 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:57.665704 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.666657 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:57.667086 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:57.667482 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:57.668054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.668464 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:57.669692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:57.675776 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:57.676280 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:57.676740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:57.677396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.677817 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:57.678217 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:57.693176 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:57.694707 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:57.696007 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:57.696427 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:57.698679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69c09aba0>]}
[0m22:05:57.699217 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.699607 [debug] [MainThread]: On master: BEGIN
[0m22:05:57.700019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:57.700637 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.701070 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.701460 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.701871 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.702416 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.702846 [debug] [MainThread]: On master: Close
[0m22:05:57.703376 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:57.703883 [info ] [MainThread]: 
[0m22:05:57.714928 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:57.715527 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:57.716185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:57.716639 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:57.743541 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:57.744305 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:57.780816 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:57.781565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:51.920131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:51.920634 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:51.921297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.921742 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:51.922198 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:51.922901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.925703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:51.926176 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:51.926879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.945198 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:51.945673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:51.946140 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:51.947380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.952493 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:51.952986 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:51.954245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.956543 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:51.958045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69c03bec0>]}
[0m22:10:51.958714 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 294.24s]
[0m22:10:51.959569 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:51.960507 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:51.961094 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:51.961682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:51.962157 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:51.967815 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:51.968444 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:52.003193 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.003683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250322221051997224"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:52.004167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:52.011929 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.019247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.019707 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:52.020368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.020845 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.021289 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250322221051997224'
      
      
      order by ordinal_position

  
[0m22:10:52.025836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.030805 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.031276 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:52.033882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.041383 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.041867 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:52.044998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.062911 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:52.063596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.064079 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250322221051997224"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250322221051997224"
    )
  
[0m22:10:52.119057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.121079 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:52.121557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:52.122007 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:52.129843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:52.130720 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:52.132401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a243c5b-39e2-45e7-b700-4444e38ca67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66cdbf6e0>]}
[0m22:10:52.133107 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:52.133872 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:52.135249 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:52.135692 [debug] [MainThread]: On master: BEGIN
[0m22:10:52.136126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:52.136822 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:52.137237 [debug] [MainThread]: On master: COMMIT
[0m22:10:52.137624 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:52.138029 [debug] [MainThread]: On master: COMMIT
[0m22:10:52.138580 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:52.139022 [debug] [MainThread]: On master: Close
[0m22:10:52.139619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:52.140030 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:52.140440 [info ] [MainThread]: 
[0m22:10:52.140952 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.97 seconds (294.97s).
[0m22:10:52.141945 [debug] [MainThread]: Command end result
[0m22:10:52.167393 [info ] [MainThread]: 
[0m22:10:52.167988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:52.168490 [info ] [MainThread]: 
[0m22:10:52.169004 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:52.169966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.9991, "process_user_time": 5.143423, "process_kernel_time": 0.25512, "process_mem_max_rss": "306020", "process_in_blocks": "3816", "process_out_blocks": "95576"}
[0m22:10:52.170493 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:52.170393 after 297.00 seconds
[0m22:10:52.170963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69aad0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff69c03bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67839fd40>]}
[0m22:10:52.171411 [debug] [MainThread]: Flushing usage events
[0m22:10:54.060061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9531d4f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95317a4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9531b0ee40>]}


============================== 22:10:54.062973 | 1c79fdd0-969d-4cd7-aadf-43695b980c68 ==============================
[0m22:10:54.062973 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:54.063653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:54.202966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c79fdd0-969d-4cd7-aadf-43695b980c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95326e3cb0>]}
[0m22:10:54.220971 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21073881, "process_user_time": 1.303265, "process_kernel_time": 0.10302, "process_mem_max_rss": "92948", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:54.221482 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:54.221382 after 0.21 seconds
[0m22:10:54.221937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9531a238f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95314c50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95314c4fe0>]}
[0m22:10:54.222373 [debug] [MainThread]: Flushing usage events
[0m06:02:02.576444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e203b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e5aa960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3eca7e60>]}


============================== 06:02:02.584272 | 4ac691c5-e6bb-4ae9-a9d9-14acd6bf3bf1 ==============================
[0m06:02:02.584272 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:02.584895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.722692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ac691c5-e6bb-4ae9-a9d9-14acd6bf3bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e0a38f0>]}
[0m06:02:02.735822 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nc7_2fdr'
[0m06:02:02.736314 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:02.806648 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:02.807271 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:02.865862 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:02.869816 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:03.095655 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:03.096287 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:03.096798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ac691c5-e6bb-4ae9-a9d9-14acd6bf3bf1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3f23cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3f23c6e0>]}
[0m06:02:03.097283 [info ] [MainThread]: 
[0m06:02:03.097736 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:03.112554 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.59104776, "process_user_time": 1.450341, "process_kernel_time": 0.129297, "process_mem_max_rss": "94476", "process_in_blocks": "5760", "process_out_blocks": "4008"}
[0m06:02:03.113219 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:03.113068 after 0.59 seconds
[0m06:02:03.113679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d420d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e046390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e252f30>]}
[0m06:02:03.114107 [debug] [MainThread]: Flushing usage events
[0m06:02:04.861790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10901e9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108f8775f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10901eb7d0>]}


============================== 06:02:04.866027 | dc99f874-ba2d-4e37-8518-b19ce4335f71 ==============================
[0m06:02:04.866027 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:04.866801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:05.110765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b70eea0>]}
[0m06:02:05.171179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10907387d0>]}
[0m06:02:05.173696 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:05.384579 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:05.385762 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:05.386527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b73bec0>]}
[0m06:02:06.746511 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:06.747165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b36fb90>]}
[0m06:02:06.931624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:06.979408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b49fef0>]}
[0m06:02:07.061718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b3170b0>]}
[0m06:02:07.062257 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:07.062795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b4d5340>]}
[0m06:02:07.064551 [info ] [MainThread]: 
[0m06:02:07.065246 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:07.069830 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:07.104658 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:07.105101 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:07.105520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:07.617426 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:07.619189 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:07.620182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:07.620899 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:07.628525 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:07.628954 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:07.629367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:07.630287 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.631689 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:07.632088 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:07.632663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.633056 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:07.633462 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:07.634074 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.635004 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:07.635420 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:07.635798 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:07.636359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.636766 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:07.637953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:07.643547 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:07.643957 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:07.644366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:07.644997 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.645430 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:07.645819 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:07.660602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.662073 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:07.663346 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:07.663755 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:07.665952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b53d1c0>]}
[0m06:02:07.666500 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:07.666896 [debug] [MainThread]: On master: BEGIN
[0m06:02:07.667280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:07.667879 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:07.668299 [debug] [MainThread]: On master: COMMIT
[0m06:02:07.668674 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:07.669043 [debug] [MainThread]: On master: COMMIT
[0m06:02:07.669607 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:07.670003 [debug] [MainThread]: On master: Close
[0m06:02:07.670568 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:07.671044 [info ] [MainThread]: 
[0m06:02:07.682512 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:07.683094 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:07.683752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:07.684220 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:07.710781 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:07.711578 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:07.747361 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:07.748089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:16:14.889666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:16:14.890182 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:16:14.890842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:14.891304 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:16:14.891726 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:16:14.892438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:14.895234 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:16:14.895682 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:16:14.896395 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:14.912777 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:16:14.913257 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:16:14.913686 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:16:14.914880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:14.919775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:16:14.920248 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:16:14.921611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:14.923888 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:16:14.925384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b7bcd40>]}
[0m06:16:14.926047 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 847.24s]
[0m06:16:14.926816 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:16:14.927775 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:16:14.928455 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:16:14.929085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:16:14.929559 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:16:14.934389 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:16:14.935012 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:16:14.969976 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:16:14.970481 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250323061614964073"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:16:14.970936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:16:14.978464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:14.985675 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:16:14.986144 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:16:14.986779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:14.987243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:16:14.987672 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250323061614964073'
      
      
      order by ordinal_position

  
[0m06:16:14.992053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:14.996982 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:16:14.997475 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:16:15.000787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:15.008187 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:16:15.008652 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:16:15.010990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:15.028716 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:16:15.029371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:16:15.029831 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250323061614964073"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250323061614964073"
    )
  
[0m06:16:15.080676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:15.082653 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:16:15.083104 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:16:15.083552 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:16:15.091611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:16:15.092482 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:16:15.093974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc99f874-ba2d-4e37-8518-b19ce4335f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1064270560>]}
[0m06:16:15.094657 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:16:15.095471 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:16:15.096740 [debug] [MainThread]: Using duckdb connection "master"
[0m06:16:15.097181 [debug] [MainThread]: On master: BEGIN
[0m06:16:15.097568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:16:15.098217 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:16:15.098625 [debug] [MainThread]: On master: COMMIT
[0m06:16:15.099006 [debug] [MainThread]: Using duckdb connection "master"
[0m06:16:15.099421 [debug] [MainThread]: On master: COMMIT
[0m06:16:15.099968 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:16:15.100419 [debug] [MainThread]: On master: Close
[0m06:16:15.100987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:16:15.101383 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:16:15.101782 [info ] [MainThread]: 
[0m06:16:15.102284 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 14 minutes and 8.04 seconds (848.04s).
[0m06:16:15.103224 [debug] [MainThread]: Command end result
[0m06:16:15.128039 [info ] [MainThread]: 
[0m06:16:15.128624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:16:15.129104 [info ] [MainThread]: 
[0m06:16:15.129618 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:16:15.130579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 850.32294, "process_user_time": 5.285031, "process_kernel_time": 0.290111, "process_mem_max_rss": "304960", "process_in_blocks": "3816", "process_out_blocks": "95472"}
[0m06:16:15.131089 [debug] [MainThread]: Command `dbt run` succeeded at 06:16:15.130992 after 850.32 seconds
[0m06:16:15.131550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1091c37650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10901eb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b77c080>]}
[0m06:16:15.131980 [debug] [MainThread]: Flushing usage events
[0m06:16:17.112580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bf3b59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bf67bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bf3b4290>]}


============================== 06:16:17.115448 | fbe3ce39-0fc8-44ea-83a6-c309442bc789 ==============================
[0m06:16:17.115448 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:16:17.116088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:16:17.254660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbe3ce39-0fc8-44ea-83a6-c309442bc789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bfd6fa40>]}
[0m06:16:17.272264 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20973484, "process_user_time": 1.294099, "process_kernel_time": 0.116008, "process_mem_max_rss": "92828", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:16:17.272758 [debug] [MainThread]: Command `dbt clean` succeeded at 06:16:17.272659 after 0.21 seconds
[0m06:16:17.273195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bfd13590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c2d2c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bfd6fa40>]}
[0m06:16:17.273622 [debug] [MainThread]: Flushing usage events
[0m14:04:47.016266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcb871a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcaf8a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcb37fc80>]}


============================== 14:04:47.030795 | c45ad59e-ad8a-4e5c-930c-015be8a653b9 ==============================
[0m14:04:47.030795 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.031476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.169639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45ad59e-ad8a-4e5c-930c-015be8a653b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcaf65b80>]}
[0m14:04:47.182519 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vtx7i7k5'
[0m14:04:47.182963 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:47.298631 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:47.299257 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:47.313444 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:47.317320 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:47.707827 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:47.708320 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:47.708778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c45ad59e-ad8a-4e5c-930c-015be8a653b9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedca6719d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedca671b20>]}
[0m14:04:47.709207 [info ] [MainThread]: 
[0m14:04:47.709644 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:47.755533 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.78831244, "process_user_time": 1.476806, "process_kernel_time": 0.134255, "process_mem_max_rss": "94308", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:04:47.756081 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:47.755942 after 0.79 seconds
[0m14:04:47.756516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedce7bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedca924bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcad0b7a0>]}
[0m14:04:47.756938 [debug] [MainThread]: Flushing usage events
[0m14:04:49.927931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd4d82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bee0a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd32d0d0>]}


============================== 14:04:49.930779 | 4e3f8f12-d5f7-45e5-884f-aa447f4af159 ==============================
[0m14:04:49.930779 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:49.931470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:50.177004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bea68fb0>]}
[0m14:04:50.246121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd2ea150>]}
[0m14:04:50.248566 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:04:50.488265 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:50.488992 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:50.489563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd146ed0>]}
[0m14:04:51.835353 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:51.835916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b9248560>]}
[0m14:04:52.009789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:52.052213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b91cc9b0>]}
[0m14:04:52.133151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b9034980>]}
[0m14:04:52.133654 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:04:52.134193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b906d7f0>]}
[0m14:04:52.135890 [info ] [MainThread]: 
[0m14:04:52.136612 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:52.141327 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:52.175887 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:52.176347 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:52.176738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:52.622636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.624107 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:52.625069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:52.625633 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:52.632625 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.633052 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:52.633431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.634243 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.635583 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.635953 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:52.636513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.636905 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.637304 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:52.637893 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.638801 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.639222 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.639598 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.640155 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.640534 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:52.641699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:52.647152 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.647527 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:52.647868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.648469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.648863 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.649274 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:52.661874 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.663217 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:52.664342 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:52.664720 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:52.666762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b91f5be0>]}
[0m14:04:52.667237 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.667602 [debug] [MainThread]: On master: BEGIN
[0m14:04:52.667944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:52.668642 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.669075 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.669463 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.669834 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.670394 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.670771 [debug] [MainThread]: On master: Close
[0m14:04:52.671267 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:52.671699 [info ] [MainThread]: 
[0m14:04:52.682006 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:52.682551 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:52.683075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:04:52.683485 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:52.708715 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:52.709465 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:52.743236 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:52.743897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:44.173175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:44.173713 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:44.174396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.174841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:44.175294 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:44.175985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.178865 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:44.179332 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:44.180011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.196386 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:44.196856 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:44.197308 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:44.198390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.203291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:44.203744 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:09:44.204910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.207206 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:44.208690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bea68110>]}
[0m14:09:44.209380 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.52s]
[0m14:09:44.210202 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:44.211010 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:44.211698 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:44.212365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:44.212918 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:44.218461 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:44.219102 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:44.253301 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:44.253787 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250323140944247377"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:44.254273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:44.264396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.271588 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:44.272057 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:44.272651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.273106 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:44.273537 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250323140944247377'
      
      
      order by ordinal_position

  
[0m14:09:44.278064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.282972 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:44.283457 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:44.286541 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.293873 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:44.294358 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:44.297388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.315156 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:44.315787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:44.316267 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250323140944247377"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250323140944247377"
    )
  
[0m14:09:44.365527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.367487 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:44.367935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:44.368383 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:44.376870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:44.377773 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:44.379260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e3f8f12-d5f7-45e5-884f-aa447f4af159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa19406a300>]}
[0m14:09:44.379924 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:44.380665 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:44.382006 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:44.382473 [debug] [MainThread]: On master: BEGIN
[0m14:09:44.382866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:44.383528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:44.383937 [debug] [MainThread]: On master: COMMIT
[0m14:09:44.384358 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:44.384733 [debug] [MainThread]: On master: COMMIT
[0m14:09:44.385297 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:44.385698 [debug] [MainThread]: On master: Close
[0m14:09:44.386326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:44.386708 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:44.387134 [info ] [MainThread]: 
[0m14:09:44.387652 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.25 seconds (292.25s).
[0m14:09:44.388662 [debug] [MainThread]: Command end result
[0m14:09:44.413743 [info ] [MainThread]: 
[0m14:09:44.414352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:44.414874 [info ] [MainThread]: 
[0m14:09:44.415439 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:44.416401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.54446, "process_user_time": 4.684163, "process_kernel_time": 0.307404, "process_mem_max_rss": "305424", "process_in_blocks": "3816", "process_out_blocks": "95552"}
[0m14:09:44.416910 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:44.416815 after 294.55 seconds
[0m14:09:44.417369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bee0a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bd48cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1b7a47350>]}
[0m14:09:44.417794 [debug] [MainThread]: Flushing usage events
[0m14:09:46.686239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd050773170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0500e9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04f9b3830>]}


============================== 14:09:46.689076 | 94fc5f85-f227-48d6-87ef-b31af877e659 ==============================
[0m14:09:46.689076 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:46.689736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:46.828195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94fc5f85-f227-48d6-87ef-b31af877e659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04ff1f890>]}
[0m14:09:46.845711 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20950465, "process_user_time": 1.292529, "process_kernel_time": 0.110959, "process_mem_max_rss": "92948", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:09:46.846298 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:46.846177 after 0.21 seconds
[0m14:09:46.846723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04f03ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04ee07b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04ed9e540>]}
[0m14:09:46.847170 [debug] [MainThread]: Flushing usage events
[0m22:05:42.731012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ce3786b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ce8469c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ce81ac60>]}


============================== 22:05:42.739381 | ced575f4-f1c6-4336-870d-3b062ba575fd ==============================
[0m22:05:42.739381 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.740033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.877942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ced575f4-f1c6-4336-870d-3b062ba575fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83cdd9e2a0>]}
[0m22:05:42.891126 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rs9modz9'
[0m22:05:42.891617 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:43.074986 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:43.075731 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:43.093626 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:43.097608 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:43.458748 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:43.459366 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:43.459899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ced575f4-f1c6-4336-870d-3b062ba575fd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ce3519a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83cdfc4440>]}
[0m22:05:43.460380 [info ] [MainThread]: 
[0m22:05:43.460873 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:43.462704 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.780362, "process_user_time": 1.466802, "process_kernel_time": 0.114827, "process_mem_max_rss": "94160", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m22:05:43.463235 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:43.463134 after 0.78 seconds
[0m22:05:43.463711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ce3786b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83ce12c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83cddf57c0>]}
[0m22:05:43.464131 [debug] [MainThread]: Flushing usage events
[0m22:05:45.198582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be1ef2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be1241c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be1241b50>]}


============================== 22:05:45.201658 | dc466d2e-eef4-486a-b56d-5953a4ea64ac ==============================
[0m22:05:45.201658 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:45.202403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:45.434487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be12ebce0>]}
[0m22:05:45.493443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be1836f30>]}
[0m22:05:45.495893 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:45.544258 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:45.545018 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:45.545568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bdd31f770>]}
[0m22:05:46.819610 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:46.820300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bdd351760>]}
[0m22:05:47.003201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:47.051963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bdd165dc0>]}
[0m22:05:47.135024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bdd015310>]}
[0m22:05:47.135585 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:47.136068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bdd1ffbc0>]}
[0m22:05:47.137786 [info ] [MainThread]: 
[0m22:05:47.138479 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:47.143119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:47.178360 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:47.178809 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:47.179214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:47.646867 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.648473 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:47.649545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:47.650194 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:47.658034 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.658515 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:47.658913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:47.659846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.661393 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.661823 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:47.662460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.662898 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.663303 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:47.663939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.664908 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:47.665391 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.665870 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:47.666551 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.666957 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:47.668194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:47.673948 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:47.674380 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:47.674757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:47.675398 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.675797 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:47.676184 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:47.689907 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.691365 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:47.692584 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:47.692989 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:47.695177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bdd1feb40>]}
[0m22:05:47.695733 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:47.696151 [debug] [MainThread]: On master: BEGIN
[0m22:05:47.696589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:47.697362 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:47.697779 [debug] [MainThread]: On master: COMMIT
[0m22:05:47.698181 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:47.698599 [debug] [MainThread]: On master: COMMIT
[0m22:05:47.699154 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:47.699615 [debug] [MainThread]: On master: Close
[0m22:05:47.700194 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:47.700709 [info ] [MainThread]: 
[0m22:05:47.712143 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:47.712745 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:47.713388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:47.713829 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:47.747839 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:47.748598 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:47.783826 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:47.784571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:41.875301 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.875807 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:41.876491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.876941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.877402 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:41.878115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.881040 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.881507 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:41.882207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.898953 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:41.899437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.899869 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:41.900998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.905979 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:41.906456 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:41.907641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.909917 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:41.911414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bdce90260>]}
[0m22:10:41.912082 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 294.20s]
[0m22:10:41.912831 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:41.913744 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:41.914351 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:41.915012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:41.915480 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:41.921130 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:41.921791 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:41.956212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.956726 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250323221041950313"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:41.957184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:41.965450 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.972807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.973264 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:41.973875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.974329 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.974761 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250323221041950313'
      
      
      order by ordinal_position

  
[0m22:10:41.979087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.984093 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.984576 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:41.987944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:41.995394 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:41.995860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:41.998950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:42.016691 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:42.017399 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:42.017855 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250323221041950313"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250323221041950313"
    )
  
[0m22:10:42.068898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:42.070905 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:42.071371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:42.071795 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:42.079102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:42.080023 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:42.081529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc466d2e-eef4-486a-b56d-5953a4ea64ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd2353320>]}
[0m22:10:42.082205 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:42.083035 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:42.084422 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:42.084847 [debug] [MainThread]: On master: BEGIN
[0m22:10:42.085228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:42.085926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:42.086354 [debug] [MainThread]: On master: COMMIT
[0m22:10:42.086739 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:42.087114 [debug] [MainThread]: On master: COMMIT
[0m22:10:42.087680 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:42.088080 [debug] [MainThread]: On master: Close
[0m22:10:42.088768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:42.089147 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:42.089572 [info ] [MainThread]: 
[0m22:10:42.090032 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.95 seconds (294.95s).
[0m22:10:42.090938 [debug] [MainThread]: Command end result
[0m22:10:42.118841 [info ] [MainThread]: 
[0m22:10:42.119440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:42.119898 [info ] [MainThread]: 
[0m22:10:42.120386 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:42.121299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.97626, "process_user_time": 4.667369, "process_kernel_time": 0.290396, "process_mem_max_rss": "283848", "process_in_blocks": "3816", "process_out_blocks": "95576"}
[0m22:10:42.121824 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:42.121725 after 296.98 seconds
[0m22:10:42.122259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be157d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be1241b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be18d5ac0>]}
[0m22:10:42.122708 [debug] [MainThread]: Flushing usage events
[0m22:10:44.104401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe454883c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe455806750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe454e677a0>]}


============================== 22:10:44.107385 | 2d116d41-ec62-4753-b404-68bf8f622dd5 ==============================
[0m22:10:44.107385 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:44.108035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:10:44.252384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d116d41-ec62-4753-b404-68bf8f622dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45422dbe0>]}
[0m22:10:44.270565 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21679662, "process_user_time": 1.323653, "process_kernel_time": 0.107971, "process_mem_max_rss": "92976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:44.271075 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:44.270976 after 0.22 seconds
[0m22:10:44.271531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe454883c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe453cafbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe454b09a60>]}
[0m22:10:44.271967 [debug] [MainThread]: Flushing usage events
[0m06:02:11.585920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9684981280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9686fdf9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96860c1a60>]}


============================== 06:02:11.593753 | cf5f3cdd-f1ef-4438-ad3b-59a2ff89ede6 ==============================
[0m06:02:11.593753 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.594449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.734756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf5f3cdd-f1ef-4438-ad3b-59a2ff89ede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96847ad310>]}
[0m06:02:11.747951 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-03l1c4j9'
[0m06:02:11.748453 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.854306 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.855009 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.866614 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.870528 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.001964 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.002484 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:12.002989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cf5f3cdd-f1ef-4438-ad3b-59a2ff89ede6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96859c9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96847f8890>]}
[0m06:02:12.003445 [info ] [MainThread]: 
[0m06:02:12.003926 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:12.006316 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46920082, "process_user_time": 1.452378, "process_kernel_time": 0.11595, "process_mem_max_rss": "94388", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m06:02:12.006823 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:12.006725 after 0.47 seconds
[0m06:02:12.007294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9684982de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9684731340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96853fd5b0>]}
[0m06:02:12.007711 [debug] [MainThread]: Flushing usage events
[0m06:02:13.482464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba5eeb320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba5cf91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba5cf9a00>]}


============================== 06:02:13.485898 | 1526e381-de81-4555-82cf-eaf972f6b6dc ==============================
[0m06:02:13.485898 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.486568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.719477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba5bad5b0>]}
[0m06:02:13.777904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba1d36ff0>]}
[0m06:02:13.780292 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:13.810246 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.810953 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.811510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba1c15130>]}
[0m06:02:15.161772 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:15.162435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba1b1c560>]}
[0m06:02:15.348161 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:15.391969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba1a58e60>]}
[0m06:02:15.585986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba1a7d130>]}
[0m06:02:15.586517 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:15.587042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba1a95a00>]}
[0m06:02:15.588761 [info ] [MainThread]: 
[0m06:02:15.589472 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:15.594141 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:15.628954 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:15.629416 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:15.629809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.981539 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.983307 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.984295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.984918 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.992760 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.993211 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.993607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.994544 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.995960 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.996382 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.996932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.997350 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.997727 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.998314 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.999245 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.999646 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.000027 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.000630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.001032 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:16.002294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:16.008053 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.008484 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:16.008852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.009474 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.009866 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.010279 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:16.024129 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.025575 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:16.026782 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:16.027204 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:16.029465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba1a94c20>]}
[0m06:02:16.029962 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.030393 [debug] [MainThread]: On master: BEGIN
[0m06:02:16.030764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:16.031381 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.031782 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.032181 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.032550 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.033081 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.033481 [debug] [MainThread]: On master: Close
[0m06:02:16.034004 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:16.034553 [info ] [MainThread]: 
[0m06:02:16.045344 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:16.045928 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:16.046580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:16.047025 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:16.073782 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:16.074536 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:16.110327 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:16.111047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:05.753562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.754057 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:05.754699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.755179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.755621 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:05.756334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.759160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.759607 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:05.760292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.776590 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:05.777055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.777513 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:05.778681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.783596 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:05.784060 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:05.785193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.787455 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:05.788935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b78005940>]}
[0m06:07:05.789626 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 289.74s]
[0m06:07:05.790412 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:05.791228 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:05.791786 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:05.792404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:05.792858 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:05.798574 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:05.799244 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:05.833624 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.834135 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250324060705827710"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:05.834607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:05.842584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.849758 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.850231 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:05.850827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.851292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.851724 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250324060705827710'
      
      
      order by ordinal_position

  
[0m06:07:05.856099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.861026 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.861513 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:05.864653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.872040 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.872523 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:05.875654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.893445 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:05.894094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.894560 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250324060705827710"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250324060705827710"
    )
  
[0m06:07:05.944226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.946190 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:05.946640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:05.947058 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:05.953576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:05.954449 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:05.956028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1526e381-de81-4555-82cf-eaf972f6b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b78074a70>]}
[0m06:07:05.956714 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:05.957459 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:05.958743 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:05.959198 [debug] [MainThread]: On master: BEGIN
[0m06:07:05.959587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:05.960222 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:05.960633 [debug] [MainThread]: On master: COMMIT
[0m06:07:05.961010 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:05.961435 [debug] [MainThread]: On master: COMMIT
[0m06:07:05.961985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:05.962423 [debug] [MainThread]: On master: Close
[0m06:07:05.963010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:05.963416 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:05.963820 [info ] [MainThread]: 
[0m06:07:05.964301 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 50.37 seconds (290.37s).
[0m06:07:05.965215 [debug] [MainThread]: Command end result
[0m06:07:05.989897 [info ] [MainThread]: 
[0m06:07:05.990449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:05.990904 [info ] [MainThread]: 
[0m06:07:05.991390 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:05.992310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 292.56107, "process_user_time": 5.047787, "process_kernel_time": 0.294395, "process_mem_max_rss": "304504", "process_in_blocks": "3816", "process_out_blocks": "95552"}
[0m06:07:05.992822 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:05.992723 after 292.56 seconds
[0m06:07:05.993272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba5cf9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b980eade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba5eeb320>]}
[0m06:07:05.993699 [debug] [MainThread]: Flushing usage events
[0m06:07:07.655900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa100093d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0e4f36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0e319ac0>]}


============================== 06:07:07.658738 | 38728a61-11b7-4dea-9550-7f4a29587ca5 ==============================
[0m06:07:07.658738 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:07.659448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:07:07.798895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38728a61-11b7-4dea-9550-7f4a29587ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0d924e90>]}
[0m06:07:07.816712 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21140182, "process_user_time": 1.298819, "process_kernel_time": 0.099986, "process_mem_max_rss": "92704", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:07.817260 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:07.817156 after 0.21 seconds
[0m06:07:07.817693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0e319ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0ea41a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0d867b90>]}
[0m06:07:07.818153 [debug] [MainThread]: Flushing usage events
[0m14:05:28.356348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bceb0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ba977230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ba9770b0>]}


============================== 14:05:28.364287 | 37d7b7cc-62f9-4dda-bb79-2c0ce033dc92 ==============================
[0m14:05:28.364287 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.364938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.505759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37d7b7cc-62f9-4dda-bb79-2c0ce033dc92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ba7aa000>]}
[0m14:05:28.519228 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u_8fin7c'
[0m14:05:28.519693 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:28.582165 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:28.582874 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:28.594817 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:28.598812 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:28.748702 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:28.749323 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:28.749855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '37d7b7cc-62f9-4dda-bb79-2c0ce033dc92', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ba7f89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2ba7f81a0>]}
[0m14:05:28.750337 [info ] [MainThread]: 
[0m14:05:28.750809 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:28.752570 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44498116, "process_user_time": 1.483967, "process_kernel_time": 0.113767, "process_mem_max_rss": "94516", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m14:05:28.753114 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:28.753012 after 0.45 seconds
[0m14:05:28.753552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bb384350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bb1f9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bb2c57c0>]}
[0m14:05:28.753987 [debug] [MainThread]: Flushing usage events
[0m14:05:30.337362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e5ab68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e5097c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e5094bf0>]}


============================== 14:05:30.340333 | b8116f4a-11e0-43db-9a87-c2fd452e9b05 ==============================
[0m14:05:30.340333 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.340999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:30.569239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e52e4cb0>]}
[0m14:05:30.627905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e546d640>]}
[0m14:05:30.630428 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:30.654674 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:30.655429 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:30.655976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e4dc6870>]}
[0m14:05:31.943787 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:31.944484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e0e4efc0>]}
[0m14:05:32.131338 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:32.182275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e0d73fe0>]}
[0m14:05:32.264443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e0c19e20>]}
[0m14:05:32.265022 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:32.265503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e0dff5f0>]}
[0m14:05:32.267264 [info ] [MainThread]: 
[0m14:05:32.267977 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:32.272695 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:32.308399 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:32.308911 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:32.309340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:32.761340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.763251 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:32.764402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:32.765103 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:32.772756 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.773207 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:32.773594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:32.774455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.775860 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.776282 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:32.776880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.777306 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.777687 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:32.778280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.779203 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:32.779607 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:32.780007 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:32.780575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.781008 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:32.782394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:32.788014 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:32.788422 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:32.788791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:32.789414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.789807 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:32.790223 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:32.804122 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:32.805583 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:32.806816 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:32.807240 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:32.809452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e0a944d0>]}
[0m14:05:32.809957 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.810390 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.810763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:32.811414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.811821 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.812247 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:32.812620 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.813175 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:32.813576 [debug] [MainThread]: On master: Close
[0m14:05:32.814121 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:32.814586 [info ] [MainThread]: 
[0m14:05:32.825569 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:32.826190 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:32.826779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:32.827251 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:32.853938 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:32.854712 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:32.890571 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:32.891383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:20.147101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:20.147605 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:20.148272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.148723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:20.149188 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:20.149888 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.152749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:20.153225 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:20.153900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.170269 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:20.170743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:20.171194 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:20.172327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.177307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:20.177762 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:20.178923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.181236 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:20.182743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e666c290>]}
[0m14:10:20.183431 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 287.36s]
[0m14:10:20.184200 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:20.185028 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:20.185589 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:20.186246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:20.186721 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:20.192569 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:20.193256 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:20.227823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:20.228347 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250324141020221896"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:20.228801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:20.236307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.243785 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:20.244267 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:20.244890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.245358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:20.245794 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250324141020221896'
      
      
      order by ordinal_position

  
[0m14:10:20.250179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.255296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:20.255762 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:20.259047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.266613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:20.267121 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:20.269387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.287210 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:20.287894 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:20.288375 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250324141020221896"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250324141020221896"
    )
  
[0m14:10:20.338414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.340428 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:20.340879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:20.341339 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:20.348150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:20.349051 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:20.350680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8116f4a-11e0-43db-9a87-c2fd452e9b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e0dac470>]}
[0m14:10:20.351430 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m14:10:20.352172 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:20.353460 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:20.353884 [debug] [MainThread]: On master: BEGIN
[0m14:10:20.354317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:20.355010 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:20.355422 [debug] [MainThread]: On master: COMMIT
[0m14:10:20.355794 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:20.356198 [debug] [MainThread]: On master: COMMIT
[0m14:10:20.356723 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:20.357159 [debug] [MainThread]: On master: Close
[0m14:10:20.357737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:20.358132 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:20.358532 [info ] [MainThread]: 
[0m14:10:20.359069 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 48.09 seconds (288.09s).
[0m14:10:20.360070 [debug] [MainThread]: Command end result
[0m14:10:20.385284 [info ] [MainThread]: 
[0m14:10:20.385895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:20.386445 [info ] [MainThread]: 
[0m14:10:20.386989 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:20.387988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 290.10077, "process_user_time": 5.155461, "process_kernel_time": 0.264434, "process_mem_max_rss": "304980", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m14:10:20.388516 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:20.388418 after 290.10 seconds
[0m14:10:20.388954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e62f4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e5094b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54e4d42600>]}
[0m14:10:20.389415 [debug] [MainThread]: Flushing usage events
[0m14:10:22.202559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f321011d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3212284290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f321011d520>]}


============================== 14:10:22.205544 | 0e069933-291b-4657-b5cc-7752a82c5660 ==============================
[0m14:10:22.205544 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:22.206225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:22.345780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e069933-291b-4657-b5cc-7752a82c5660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32113ab800>]}
[0m14:10:22.363872 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21143425, "process_user_time": 1.32092, "process_kernel_time": 0.096994, "process_mem_max_rss": "92732", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:22.364418 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:22.364316 after 0.21 seconds
[0m14:10:22.364848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3210ada8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f321140fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32118554f0>]}
[0m14:10:22.365311 [debug] [MainThread]: Flushing usage events
[0m22:05:50.562319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2ed13a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2dbcbfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2dbcbec0>]}


============================== 22:05:50.570452 | a58ad8f7-febb-4aaf-a4d4-f9837750687e ==============================
[0m22:05:50.570452 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.571129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.721947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a58ad8f7-febb-4aaf-a4d4-f9837750687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2cfa70e0>]}
[0m22:05:50.736082 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zl0enhgp'
[0m22:05:50.736667 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:50.844239 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:50.844968 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:50.867251 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:50.871285 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:50.947138 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:50.947768 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:50.948357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a58ad8f7-febb-4aaf-a4d4-f9837750687e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2ce7a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2da8f620>]}
[0m22:05:50.948850 [info ] [MainThread]: 
[0m22:05:50.949374 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:50.950973 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43943393, "process_user_time": 1.485289, "process_kernel_time": 0.137563, "process_mem_max_rss": "93996", "process_in_blocks": "5760", "process_out_blocks": "4008"}
[0m22:05:50.951506 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:50.951406 after 0.44 seconds
[0m22:05:50.951985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c30fbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2cfa70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c2cfa5c70>]}
[0m22:05:50.952444 [debug] [MainThread]: Flushing usage events
[0m22:05:52.521121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00abe360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00f6a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab01c70590>]}


============================== 22:05:52.524282 | 27edacb1-1ab0-4c19-8647-81a591806441 ==============================
[0m22:05:52.524282 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.525059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.785775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab02dd7230>]}
[0m22:05:52.846111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab003b3ce0>]}
[0m22:05:52.848773 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:53.070650 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:53.071426 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:53.071974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab004a3c80>]}
[0m22:05:54.491387 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:54.492253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0042de20>]}
[0m22:05:54.692179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:54.757498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafc3b5160>]}
[0m22:05:54.915067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafc21ddc0>]}
[0m22:05:54.915698 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:54.916194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafc3a2c60>]}
[0m22:05:54.918036 [info ] [MainThread]: 
[0m22:05:54.918765 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:54.923653 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:54.960860 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:54.961387 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:54.961833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.387988 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.389902 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:55.391118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:55.391791 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:55.399037 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.399479 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:55.399907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.400727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.402133 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.402538 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:55.403114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.403503 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.403902 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:55.404470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.405386 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.405802 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.406169 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.406726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.407128 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:55.408400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:55.414444 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.414952 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:55.415332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.416160 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.416557 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.416995 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:55.431150 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.432928 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:55.434258 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:55.434695 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:55.437206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab01ca6e40>]}
[0m22:05:55.437794 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.438227 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.438641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:55.439435 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.439881 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.440264 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.440659 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.441218 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.441639 [debug] [MainThread]: On master: Close
[0m22:05:55.442235 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:55.442737 [info ] [MainThread]: 
[0m22:05:55.459072 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:55.459785 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:55.460486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:55.460970 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:55.487859 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:55.488668 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:55.524241 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:55.525170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:00.095524 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:00.096034 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:11:00.096674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.097119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:00.097547 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:11:00.098247 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.101096 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:00.101542 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:11:00.102243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.118664 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:00.119131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:00.119561 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:00.121137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.126107 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:00.126568 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:11:00.127700 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.129978 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:11:00.131466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad0de8bc0>]}
[0m22:11:00.132159 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 304.67s]
[0m22:11:00.133008 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:11:00.133817 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:11:00.134393 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:11:00.135080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:11:00.135544 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:11:00.141216 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:11:00.141872 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:11:00.176289 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:00.176798 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250324221100170311"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:11:00.177258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:00.186068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.193415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:00.193888 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:11:00.194487 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.194955 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:00.195386 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250324221100170311'
      
      
      order by ordinal_position

  
[0m22:11:00.199739 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.204727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:00.205204 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:00.208478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.215961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:00.216425 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:00.219711 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.237506 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:11:00.238166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:00.238650 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250324221100170311"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250324221100170311"
    )
  
[0m22:11:00.288041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.290037 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:00.290491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:00.290940 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:00.298232 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:00.299126 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:11:00.300616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27edacb1-1ab0-4c19-8647-81a591806441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafc540fe0>]}
[0m22:11:00.301289 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:11:00.302096 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:11:00.303379 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:00.303827 [debug] [MainThread]: On master: BEGIN
[0m22:11:00.304207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:00.304871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:00.305280 [debug] [MainThread]: On master: COMMIT
[0m22:11:00.305703 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:00.306079 [debug] [MainThread]: On master: COMMIT
[0m22:11:00.306654 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:00.307062 [debug] [MainThread]: On master: Close
[0m22:11:00.307670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:00.308048 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:11:00.308445 [info ] [MainThread]: 
[0m22:11:00.308957 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 5 minutes and 5.39 seconds (305.39s).
[0m22:11:00.309948 [debug] [MainThread]: Command end result
[0m22:11:00.334985 [info ] [MainThread]: 
[0m22:11:00.335614 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:00.336139 [info ] [MainThread]: 
[0m22:11:00.336681 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:11:00.337663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 307.87024, "process_user_time": 4.956433, "process_kernel_time": 0.306717, "process_mem_max_rss": "284576", "process_in_blocks": "3816", "process_out_blocks": "95568"}
[0m22:11:00.338179 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:00.338080 after 307.87 seconds
[0m22:11:00.338633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab02cc7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafc3a2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faafc439910>]}
[0m22:11:00.339072 [debug] [MainThread]: Flushing usage events
[0m22:11:02.035613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad42efaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad41196d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad38ccd40>]}


============================== 22:11:02.038658 | fc3d8775-d765-48d5-b5a5-4ca024f0453d ==============================
[0m22:11:02.038658 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:02.039315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:02.180738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc3d8775-d765-48d5-b5a5-4ca024f0453d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad38cf5f0>]}
[0m22:11:02.198433 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21335073, "process_user_time": 1.302357, "process_kernel_time": 0.09995, "process_mem_max_rss": "92832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:11:02.198967 [debug] [MainThread]: Command `dbt clean` succeeded at 22:11:02.198869 after 0.21 seconds
[0m22:11:02.199389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad46aa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad454ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad481acc0>]}
[0m22:11:02.199840 [debug] [MainThread]: Flushing usage events
[0m06:02:17.223624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f026b019610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f026bc778c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f026addacc0>]}


============================== 06:02:17.231816 | fb48ac15-c188-4748-ba31-d42aa8beb74a ==============================
[0m06:02:17.231816 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.232472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.378869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb48ac15-c188-4748-ba31-d42aa8beb74a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f026a61fd40>]}
[0m06:02:17.392276 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ixa6zv13'
[0m06:02:17.392776 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:17.544278 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:17.544942 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:17.659192 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:17.663067 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:18.056502 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:18.057009 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:18.057551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fb48ac15-c188-4748-ba31-d42aa8beb74a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02694019a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f026a63ca70>]}
[0m06:02:18.058006 [info ] [MainThread]: 
[0m06:02:18.058497 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:18.060409 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.88595647, "process_user_time": 1.472699, "process_kernel_time": 0.118894, "process_mem_max_rss": "94484", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m06:02:18.060934 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:18.060835 after 0.89 seconds
[0m06:02:18.061395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0269645ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f026cdd7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02694bc860>]}
[0m06:02:18.061824 [debug] [MainThread]: Flushing usage events
[0m06:02:19.774509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48eef7f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ee7d9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48eef7fe30>]}


============================== 06:02:19.777377 | 0b40702f-d629-4fd5-9e35-8869bc01cd0f ==============================
[0m06:02:19.777377 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.778031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.008793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ee3198e0>]}
[0m06:02:20.067372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ee378950>]}
[0m06:02:20.069803 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:20.112772 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:20.113512 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:20.114044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ee3f0f80>]}
[0m06:02:21.402282 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:21.402985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ea177440>]}
[0m06:02:21.585295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:21.636848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ea2645c0>]}
[0m06:02:21.718190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ea11ab10>]}
[0m06:02:21.718705 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:21.719179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ea2cfe60>]}
[0m06:02:21.720895 [info ] [MainThread]: 
[0m06:02:21.721589 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:21.726158 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:21.761247 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:21.761707 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:21.762100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:22.279800 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:22.282108 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:22.283440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:22.284452 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:22.291913 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.292372 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:22.293023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.294152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.296098 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.296657 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:22.297401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.297843 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.298217 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:22.298843 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.299834 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.300236 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.300643 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.301209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.301644 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:22.302864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.308488 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.308904 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.309274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.309909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.310304 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.310714 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:22.325179 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.326643 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.327856 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.328270 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.330640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ef6a4410>]}
[0m06:02:22.331149 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.331584 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.331951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.332552 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.332956 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.333357 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.333734 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.334266 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.334687 [debug] [MainThread]: On master: Close
[0m06:02:22.335214 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.335732 [info ] [MainThread]: 
[0m06:02:22.346910 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:22.347509 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:22.348148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:22.348617 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:22.375109 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:22.375868 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:22.411636 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:22.412384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:16.861077 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:16.861603 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:16.862231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:16.862700 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:16.863139 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:16.863834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:16.866628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:16.867070 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:16.867738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:16.884109 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:16.884591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:16.885022 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:16.886355 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:16.891193 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:16.891670 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:16.892864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:16.895157 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:16.896664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e3f1bd40>]}
[0m06:07:16.897353 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 294.55s]
[0m06:07:16.898113 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:16.899083 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:16.899655 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:16.900242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:16.900703 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:16.906268 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:16.906918 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:16.941381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:16.941881 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250325060716935491"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:16.942368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:16.950091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:16.957314 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:16.957783 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:16.958381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:16.958819 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:16.959239 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250325060716935491'
      
      
      order by ordinal_position

  
[0m06:07:16.963793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:16.968716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:16.969176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:16.972313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:16.979687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:16.980156 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:16.983122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:17.000905 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:17.001585 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:17.002048 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250325060716935491"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250325060716935491"
    )
  
[0m06:07:17.050447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:17.052477 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:17.052950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:17.053405 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:17.060965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:17.061871 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:17.063467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b40702f-d629-4fd5-9e35-8869bc01cd0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c414cd40>]}
[0m06:07:17.064145 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:17.064969 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:17.066577 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:17.066998 [debug] [MainThread]: On master: BEGIN
[0m06:07:17.067413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:17.068065 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:17.068502 [debug] [MainThread]: On master: COMMIT
[0m06:07:17.068893 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:17.069263 [debug] [MainThread]: On master: COMMIT
[0m06:07:17.069827 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:17.070229 [debug] [MainThread]: On master: Close
[0m06:07:17.070862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:17.071232 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:17.071672 [info ] [MainThread]: 
[0m06:07:17.072193 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 55.35 seconds (295.35s).
[0m06:07:17.073240 [debug] [MainThread]: Command end result
[0m06:07:17.098617 [info ] [MainThread]: 
[0m06:07:17.099220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:17.099765 [info ] [MainThread]: 
[0m06:07:17.100305 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:17.101291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 297.3773, "process_user_time": 5.210597, "process_kernel_time": 0.262634, "process_mem_max_rss": "298272", "process_in_blocks": "3816", "process_out_blocks": "95552"}
[0m06:07:17.101835 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:17.101736 after 297.38 seconds
[0m06:07:17.102273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48eef7e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ea4471d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e8ba4650>]}
[0m06:07:17.102728 [debug] [MainThread]: Flushing usage events
[0m06:07:18.993562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3236ae7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323750e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323750e240>]}


============================== 06:07:18.996888 | 691b28a2-e0ed-4d1f-a5be-b4796d35591d ==============================
[0m06:07:18.996888 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:18.997586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:07:19.137441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '691b28a2-e0ed-4d1f-a5be-b4796d35591d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32368d4e90>]}
[0m06:07:19.155187 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21167721, "process_user_time": 1.289458, "process_kernel_time": 0.117859, "process_mem_max_rss": "92820", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:19.155711 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:19.155614 after 0.21 seconds
[0m06:07:19.156142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32374eb740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32368d4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323688a3f0>]}
[0m06:07:19.156600 [debug] [MainThread]: Flushing usage events
[0m14:05:59.141861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6993d35820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6993210e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699350bad0>]}


============================== 14:05:59.149877 | 74ac7d1c-0d65-4022-a9b4-b25cdccca4d2 ==============================
[0m14:05:59.149877 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:59.150594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:59.289629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74ac7d1c-0d65-4022-a9b4-b25cdccca4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6992396e40>]}
[0m14:05:59.302980 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kowrjjjk'
[0m14:05:59.303441 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:59.330043 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:59.330645 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:59.341234 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:59.345063 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:59.557162 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:59.557706 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:59.558259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '74ac7d1c-0d65-4022-a9b4-b25cdccca4d2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f699238c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69921facf0>]}
[0m14:05:59.558711 [info ] [MainThread]: 
[0m14:05:59.559226 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:59.565075 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47220144, "process_user_time": 1.45982, "process_kernel_time": 0.136515, "process_mem_max_rss": "94076", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:05:59.565597 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:59.565497 after 0.47 seconds
[0m14:05:59.566050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6994b06450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6995b2c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69924a5400>]}
[0m14:05:59.566468 [debug] [MainThread]: Flushing usage events
[0m14:06:01.307807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e4ce9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e5449d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e7293410>]}


============================== 14:06:01.310816 | c10eb5b1-0155-4dc1-a199-09001288947e ==============================
[0m14:06:01.310816 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:06:01.311480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:06:01.680003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e0d23590>]}
[0m14:06:01.739895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e6506f00>]}
[0m14:06:01.742389 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:06:01.859478 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:06:01.860285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:01.860842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e0d228d0>]}
[0m14:06:03.232833 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:03.233501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e0c40b30>]}
[0m14:06:03.418779 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:06:03.464180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e0a6f440>]}
[0m14:06:03.562768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e091a210>]}
[0m14:06:03.563316 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:06:03.563818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e0adea20>]}
[0m14:06:03.565538 [info ] [MainThread]: 
[0m14:06:03.566237 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:03.572114 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:06:03.607394 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:06:03.607850 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:06:03.608269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:03.978382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:03.980274 [debug] [ThreadPool]: On list_petro: Close
[0m14:06:03.981469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:06:03.982159 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:06:03.990063 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:03.990499 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:06:03.990906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:03.991865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:03.993341 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:03.993741 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:06:03.994310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:03.994702 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:03.995103 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:06:03.995678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:03.996600 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:03.997011 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:06:03.997381 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:06:03.997948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:03.998357 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:06:03.999542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:06:04.005248 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:04.005665 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:06:04.006076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:04.006679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:04.007095 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:06:04.007488 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:06:04.021940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:06:04.023393 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:06:04.024615 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:06:04.025045 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:06:04.027473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e646aa20>]}
[0m14:06:04.027996 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:04.028389 [debug] [MainThread]: On master: BEGIN
[0m14:06:04.028761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:04.029377 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:04.029783 [debug] [MainThread]: On master: COMMIT
[0m14:06:04.030196 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:04.030572 [debug] [MainThread]: On master: COMMIT
[0m14:06:04.031118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:06:04.031513 [debug] [MainThread]: On master: Close
[0m14:06:04.032051 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:06:04.032558 [info ] [MainThread]: 
[0m14:06:04.044697 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:06:04.045312 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:06:04.045974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:06:04.046426 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:06:04.073044 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:06:04.073786 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:06:04.109693 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:06:04.110502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:56.469734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:56.470261 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:56.470912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.471360 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:56.471784 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:56.472486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.475343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:56.475799 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:56.476481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.493113 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:56.493588 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:56.494039 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:56.495656 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.500619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:56.501109 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:56.502437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.504738 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:56.506264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16cc1cd7f0>]}
[0m14:10:56.506962 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.46s]
[0m14:10:56.507707 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:56.508687 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:56.509264 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:56.509833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:56.510301 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:56.515898 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:56.516546 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:56.551228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:56.551754 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250325141056545227"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:56.552239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:56.560117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.567611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:56.568087 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:56.568688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.569149 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:56.569577 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250325141056545227'
      
      
      order by ordinal_position

  
[0m14:10:56.573872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.578871 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:56.579364 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:56.581676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.589152 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:56.589619 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:56.591851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.609861 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:56.610562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:56.611053 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250325141056545227"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250325141056545227"
    )
  
[0m14:10:56.662157 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.664116 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:56.664565 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:56.665014 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:56.672905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:56.673773 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:56.675411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c10eb5b1-0155-4dc1-a199-09001288947e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b4d23a40>]}
[0m14:10:56.676116 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:56.676866 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:56.678204 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:56.678617 [debug] [MainThread]: On master: BEGIN
[0m14:10:56.679026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:56.679676 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:56.680117 [debug] [MainThread]: On master: COMMIT
[0m14:10:56.680510 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:56.680905 [debug] [MainThread]: On master: COMMIT
[0m14:10:56.681461 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:56.681859 [debug] [MainThread]: On master: Close
[0m14:10:56.682479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:56.682850 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:56.683274 [info ] [MainThread]: 
[0m14:10:56.683736 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.12 seconds (293.12s).
[0m14:10:56.684657 [debug] [MainThread]: Command end result
[0m14:10:56.710117 [info ] [MainThread]: 
[0m14:10:56.710677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:56.711155 [info ] [MainThread]: 
[0m14:10:56.711624 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:56.712551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.45673, "process_user_time": 5.157996, "process_kernel_time": 0.281835, "process_mem_max_rss": "305120", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m14:10:56.713112 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:56.713009 after 295.46 seconds
[0m14:10:56.713554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e5692690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ce3fa870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e0942cc0>]}
[0m14:10:56.714010 [debug] [MainThread]: Flushing usage events
[0m14:10:58.679013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46aaeec350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a94fbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a97af5f0>]}


============================== 14:10:58.682049 | 05c535a8-5a95-49cf-b480-915325528791 ==============================
[0m14:10:58.682049 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:58.682742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:10:58.827903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05c535a8-5a95-49cf-b480-915325528791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a936ce90>]}
[0m14:10:58.846085 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21766938, "process_user_time": 1.333217, "process_kernel_time": 0.106857, "process_mem_max_rss": "92948", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:58.846603 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:58.846501 after 0.22 seconds
[0m14:10:58.847062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a92ad400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46aa3b8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46aa233f80>]}
[0m14:10:58.847501 [debug] [MainThread]: Flushing usage events
[0m22:06:06.769760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5693ba600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56a6b1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56822d1f0>]}


============================== 22:06:06.811828 | 89ada9df-86c5-4235-b78b-c0687eee08ad ==============================
[0m22:06:06.811828 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:06.812529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:06.954181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ada9df-86c5-4235-b78b-c0687eee08ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5680087a0>]}
[0m22:06:06.967825 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fcwpgygd'
[0m22:06:06.968283 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:07.035174 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:07.035906 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:07.048254 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:07.052277 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:07.267258 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:07.267886 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:07.268456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '89ada9df-86c5-4235-b78b-c0687eee08ad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56920c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5691efd70>]}
[0m22:06:07.268921 [info ] [MainThread]: 
[0m22:06:07.269422 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:07.291778 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5710181, "process_user_time": 1.488138, "process_kernel_time": 0.120091, "process_mem_max_rss": "94380", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m22:06:07.292390 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:07.292239 after 0.57 seconds
[0m22:06:07.292860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56c0d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff567eb7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5680087a0>]}
[0m22:06:07.293331 [debug] [MainThread]: Flushing usage events
[0m22:06:08.978661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef5ff6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef5e21790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef5e21d90>]}


============================== 22:06:08.981578 | 371dda94-fe7f-431a-9196-e2e7ab86fb9d ==============================
[0m22:06:08.981578 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:08.982211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:09.211477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef154e2a0>]}
[0m22:06:09.271061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef5413aa0>]}
[0m22:06:09.273646 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:06:09.356574 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:09.357314 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:09.357846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef15d3080>]}
[0m22:06:10.645712 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:10.646395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef1215820>]}
[0m22:06:10.832133 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:10.881172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef12748c0>]}
[0m22:06:10.962837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef111c6b0>]}
[0m22:06:10.963379 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:06:10.963886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef12dd3a0>]}
[0m22:06:10.965662 [info ] [MainThread]: 
[0m22:06:10.966373 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:10.971093 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:11.006668 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:11.007123 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:11.007544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:11.450414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:11.452146 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:11.453342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:11.453949 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:11.461994 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:11.462446 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:11.462832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:11.463777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:11.465229 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:11.465660 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:11.466280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:11.466706 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:11.467080 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:11.467673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:11.468592 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:11.468993 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:11.469392 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:11.469932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:11.470349 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:11.471598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:11.477333 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:11.477746 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:11.478115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:11.478738 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:11.479131 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:11.479553 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:11.493305 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:11.494765 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:11.495988 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:11.496411 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:11.499791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef6544410>]}
[0m22:06:11.500603 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:11.501212 [debug] [MainThread]: On master: BEGIN
[0m22:06:11.501857 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:11.502751 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:11.503409 [debug] [MainThread]: On master: COMMIT
[0m22:06:11.504073 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:11.504749 [debug] [MainThread]: On master: COMMIT
[0m22:06:11.505593 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:11.506280 [debug] [MainThread]: On master: Close
[0m22:06:11.507183 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:11.507782 [info ] [MainThread]: 
[0m22:06:11.525177 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:11.525819 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:11.526499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:11.526956 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:11.553384 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:11.554146 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:11.589949 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:11.590714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:09.439901 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:18:09.440451 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:18:09.441143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.441606 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:18:09.442035 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:18:09.442762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.445749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:18:09.446195 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:18:09.446904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.463465 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:18:09.463961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:18:09.464411 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:18:09.466516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.471631 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:18:09.472093 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:18:09.473369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.475728 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:18:09.477255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef6b683b0>]}
[0m22:18:09.477965 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 717.95s]
[0m22:18:09.478722 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:18:09.479627 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:18:09.480275 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:18:09.480895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:18:09.481358 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:18:09.487395 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:18:09.488054 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:18:09.522940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:18:09.523536 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250325221809516883"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:18:09.523989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:09.532123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.539864 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:18:09.540345 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:18:09.541010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.541468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:18:09.541893 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250325221809516883'
      
      
      order by ordinal_position

  
[0m22:18:09.546435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.551787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:18:09.552260 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:18:09.554961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.562743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:18:09.563208 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:18:09.565695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.583359 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:18:09.584050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:18:09.584527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250325221809516883"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250325221809516883"
    )
  
[0m22:18:09.636582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.638554 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:18:09.639004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:18:09.639436 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:18:09.646413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:18:09.647338 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:18:09.648954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '371dda94-fe7f-431a-9196-e2e7ab86fb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ed96effb0>]}
[0m22:18:09.649641 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:18:09.650448 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:18:09.651777 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:09.652193 [debug] [MainThread]: On master: BEGIN
[0m22:18:09.652613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:09.653318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:18:09.653728 [debug] [MainThread]: On master: COMMIT
[0m22:18:09.654105 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:09.654517 [debug] [MainThread]: On master: COMMIT
[0m22:18:09.655079 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:18:09.655508 [debug] [MainThread]: On master: Close
[0m22:18:09.656106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:09.656510 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:18:09.656916 [info ] [MainThread]: 
[0m22:18:09.657456 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 11 minutes and 58.69 seconds (718.69s).
[0m22:18:09.658478 [debug] [MainThread]: Command end result
[0m22:18:09.683597 [info ] [MainThread]: 
[0m22:18:09.684230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:18:09.684778 [info ] [MainThread]: 
[0m22:18:09.685320 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:18:09.686330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 720.75775, "process_user_time": 5.103807, "process_kernel_time": 0.266512, "process_mem_max_rss": "302896", "process_in_blocks": "3816", "process_out_blocks": "95552"}
[0m22:18:09.686839 [debug] [MainThread]: Command `dbt run` succeeded at 22:18:09.686743 after 720.76 seconds
[0m22:18:09.687271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef55fb320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef145ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eccd0b8c0>]}
[0m22:18:09.687729 [debug] [MainThread]: Flushing usage events
[0m22:18:11.859167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930e58b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930e612600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930e588cb0>]}


============================== 22:18:11.862270 | a2bbbd21-def7-431b-9bf8-10dc73ae80d1 ==============================
[0m22:18:11.862270 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:18:11.862953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:18:12.006854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2bbbd21-def7-431b-9bf8-10dc73ae80d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930e3bb7d0>]}
[0m22:18:12.024933 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21640284, "process_user_time": 1.326212, "process_kernel_time": 0.106936, "process_mem_max_rss": "92960", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:18:12.025498 [debug] [MainThread]: Command `dbt clean` succeeded at 22:18:12.025390 after 0.22 seconds
[0m22:18:12.025943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930e6107a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930f5399a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930e3dbad0>]}
[0m22:18:12.026402 [debug] [MainThread]: Flushing usage events
[0m06:02:22.314318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43a14da900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439faa4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439fd22fc0>]}


============================== 06:02:22.338781 | da13549b-03e3-4d03-a595-ab772f030f9c ==============================
[0m06:02:22.338781 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.339418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.484066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da13549b-03e3-4d03-a595-ab772f030f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439fbc8aa0>]}
[0m06:02:22.497722 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pdfkdn4i'
[0m06:02:22.498189 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:22.543250 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:22.543991 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:22.557137 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:22.561147 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:22.881597 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:22.882192 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:22.882723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da13549b-03e3-4d03-a595-ab772f030f9c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439f63d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439f784050>]}
[0m06:02:22.883178 [info ] [MainThread]: 
[0m06:02:22.883660 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:22.891731 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.62688476, "process_user_time": 1.483075, "process_kernel_time": 0.127662, "process_mem_max_rss": "94376", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m06:02:22.892259 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:22.892156 after 0.63 seconds
[0m06:02:22.892714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439fd22fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439fbc8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43a1dc8740>]}
[0m06:02:22.893141 [debug] [MainThread]: Flushing usage events
[0m06:02:24.646653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4be3ef64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4be37606e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4be53da9f0>]}


============================== 06:02:24.649689 | 64edb175-1f31-4029-8d2d-6f17ed753d59 ==============================
[0m06:02:24.649689 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.650338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.882834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4be35e3aa0>]}
[0m06:02:24.941727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4be50b7d40>]}
[0m06:02:24.944203 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:25.000401 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:25.001132 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:25.001689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bdf75ad50>]}
[0m06:02:26.278381 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:26.279101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bdf553380>]}
[0m06:02:26.464624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:26.515162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bdf5e7f50>]}
[0m06:02:26.606728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bdf4398b0>]}
[0m06:02:26.607263 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:26.607784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bdf488b60>]}
[0m06:02:26.609552 [info ] [MainThread]: 
[0m06:02:26.610210 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:26.614875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:26.650204 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:26.650691 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:26.651091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:27.043867 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.045674 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:27.046809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:27.047429 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:27.054707 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:27.055136 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:27.055551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:27.056898 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.058320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:27.058746 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:27.059393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.059815 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:27.060189 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:27.060793 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.061750 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:27.062163 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:27.062564 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:27.063115 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.063536 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:27.064769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:27.070640 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:27.071061 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:27.071437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:27.072096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.072498 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:27.072929 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:27.087586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:27.089068 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:27.090334 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:27.090792 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:27.093041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4be4eabbc0>]}
[0m06:02:27.093592 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.093998 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.094372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:27.095036 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.095446 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.095861 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.096240 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.096823 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.097237 [debug] [MainThread]: On master: Close
[0m06:02:27.097847 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:27.098372 [info ] [MainThread]: 
[0m06:02:27.110267 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:27.110929 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:27.111612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:27.112078 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:27.139015 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:27.139810 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:27.175337 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:27.176099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:20.417386 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:20.417942 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:20.418610 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.419061 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:20.419500 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:20.420238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.423178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:20.423652 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:20.424319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.440950 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:20.441421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:20.441880 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:20.443143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.448147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:20.448629 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:20.449916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.452255 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:20.453773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bddfa28d0>]}
[0m06:07:20.454455 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.34s]
[0m06:07:20.455270 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:20.456265 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:20.456853 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:20.457449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:20.457929 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:20.463696 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:20.464350 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:20.499370 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:20.499913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250326060720493378"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:20.500376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:20.508505 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.516004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:20.516466 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:20.517112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.517573 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:20.518018 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250326060720493378'
      
      
      order by ordinal_position

  
[0m06:07:20.522446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.527561 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:20.528028 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:20.530397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.537935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:20.538404 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:20.540804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.558484 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:20.559184 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:20.559664 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250326060720493378"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250326060720493378"
    )
  
[0m06:07:20.607909 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.609925 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:20.610382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:20.610836 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:20.617777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:20.618700 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:20.620204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64edb175-1f31-4029-8d2d-6f17ed753d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4be3592bd0>]}
[0m06:07:20.620903 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:20.621668 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:20.622927 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:20.623353 [debug] [MainThread]: On master: BEGIN
[0m06:07:20.623775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:20.624443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:20.624882 [debug] [MainThread]: On master: COMMIT
[0m06:07:20.625256 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:20.625686 [debug] [MainThread]: On master: COMMIT
[0m06:07:20.626224 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:20.626653 [debug] [MainThread]: On master: Close
[0m06:07:20.627245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:20.627653 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:20.628059 [info ] [MainThread]: 
[0m06:07:20.628601 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.02 seconds (294.02s).
[0m06:07:20.629617 [debug] [MainThread]: Command end result
[0m06:07:20.654648 [info ] [MainThread]: 
[0m06:07:20.655259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:20.655809 [info ] [MainThread]: 
[0m06:07:20.656342 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:20.657348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.06085, "process_user_time": 4.649274, "process_kernel_time": 0.299468, "process_mem_max_rss": "286508", "process_in_blocks": "3816", "process_out_blocks": "95528"}
[0m06:07:20.657915 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:20.657812 after 296.06 seconds
[0m06:07:20.658354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4be44b9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4be3cda630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb419d4c0>]}
[0m06:07:20.658810 [debug] [MainThread]: Flushing usage events
[0m06:07:22.655169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4dc6e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b511842f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d705ee0>]}


============================== 06:07:22.658180 | 800945ee-3c9c-4655-80d6-c99147d4b90d ==============================
[0m06:07:22.658180 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:22.658873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:22.805698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '800945ee-3c9c-4655-80d6-c99147d4b90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4da71880>]}
[0m06:07:22.824297 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22146459, "process_user_time": 1.359957, "process_kernel_time": 0.104996, "process_mem_max_rss": "92996", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:22.824879 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:22.824770 after 0.22 seconds
[0m06:07:22.825335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d705dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4d706090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4dbdd280>]}
[0m06:07:22.825944 [debug] [MainThread]: Flushing usage events
[0m14:05:47.080259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5200425a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa520042db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa520042480>]}


============================== 14:05:47.095385 | e5b696a4-dc91-4271-870a-673c5961eeba ==============================
[0m14:05:47.095385 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:47.096079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:47.246066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5b696a4-dc91-4271-870a-673c5961eeba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5202906e0>]}
[0m14:05:47.260257 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yms3_daj'
[0m14:05:47.260754 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:47.283988 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:47.284744 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:47.296564 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:47.300523 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:47.513221 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:47.513853 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:47.514494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e5b696a4-dc91-4271-870a-673c5961eeba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51ff1c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51ff1c6b0>]}
[0m14:05:47.515019 [info ] [MainThread]: 
[0m14:05:47.515567 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:47.544443 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.51360166, "process_user_time": 1.50229, "process_kernel_time": 0.143878, "process_mem_max_rss": "94356", "process_in_blocks": "5760", "process_out_blocks": "4016"}
[0m14:05:47.545132 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:47.544988 after 0.51 seconds
[0m14:05:47.545609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5200b6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa520159310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51ffd9c10>]}
[0m14:05:47.546072 [debug] [MainThread]: Flushing usage events
[0m14:05:49.357969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab167a5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab17358b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1819f3b0>]}


============================== 14:05:49.361065 | a5b42d96-cae5-4a03-b40d-794582daf6e9 ==============================
[0m14:05:49.361065 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:49.361801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:49.609038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab15b66420>]}
[0m14:05:49.668861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab16af9460>]}
[0m14:05:49.671526 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:49.722524 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:49.723334 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:49.723900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab11d8c200>]}
[0m14:05:51.031107 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:51.031830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab11916d20>]}
[0m14:05:51.222348 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:51.286695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab11ac07d0>]}
[0m14:05:51.375153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab11914680>]}
[0m14:05:51.375749 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:51.376305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab11ae9b50>]}
[0m14:05:51.378120 [info ] [MainThread]: 
[0m14:05:51.378843 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:51.383797 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:51.420566 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:51.421128 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:51.421562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:51.958150 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:51.959771 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:51.960739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:51.961319 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:51.968956 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:51.969483 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:51.969880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:51.971221 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.972819 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:51.973253 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:51.973857 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.974279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:51.974664 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:51.975284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.976254 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:51.976661 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:51.977041 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:51.977643 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.978070 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:51.979582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:51.985873 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:51.986354 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:51.986735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:51.987565 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:51.987971 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:51.988401 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:52.003295 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:52.005077 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:52.006435 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:52.006865 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:52.009181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1738bc20>]}
[0m14:05:52.009722 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:52.010141 [debug] [MainThread]: On master: BEGIN
[0m14:05:52.010524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:52.011297 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:52.011707 [debug] [MainThread]: On master: COMMIT
[0m14:05:52.012105 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:52.012490 [debug] [MainThread]: On master: COMMIT
[0m14:05:52.013059 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:52.013509 [debug] [MainThread]: On master: Close
[0m14:05:52.014118 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:52.014617 [info ] [MainThread]: 
[0m14:05:52.030668 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:52.031390 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:52.032114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:52.032572 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:52.060272 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:52.061191 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:52.098230 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:52.099226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:47.289350 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:47.289882 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:47.290570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.291016 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:47.291465 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:47.292201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.295182 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:47.295628 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:47.296312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.312840 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:47.313376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:47.313818 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:47.315185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.320376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:47.320840 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:47.322267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.324683 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:47.326254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab17358f50>]}
[0m14:10:47.326957 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.29s]
[0m14:10:47.327811 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:47.328629 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:47.329209 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:47.329870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:47.330343 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:47.336509 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:47.337406 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:47.372657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:47.373275 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250326141047366558"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:47.373747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:47.381949 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.389944 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:47.390457 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:47.391202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.391647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:47.392074 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250326141047366558'
      
      
      order by ordinal_position

  
[0m14:10:47.396668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.402194 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:47.402684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:47.406268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.414406 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:47.414922 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:47.418498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.437113 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:47.437919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:47.438423 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250326141047366558"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250326141047366558"
    )
  
[0m14:10:47.489400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.491430 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:47.491885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:47.492336 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:47.499343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:47.500255 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:47.501796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b42d96-cae5-4a03-b40d-794582daf6e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab180cf0b0>]}
[0m14:10:47.502493 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:47.503251 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:47.504639 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:47.505055 [debug] [MainThread]: On master: BEGIN
[0m14:10:47.505478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:47.506132 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:47.506539 [debug] [MainThread]: On master: COMMIT
[0m14:10:47.506917 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:47.507338 [debug] [MainThread]: On master: COMMIT
[0m14:10:47.507910 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:47.508349 [debug] [MainThread]: On master: Close
[0m14:10:47.508933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:47.509346 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:47.509754 [info ] [MainThread]: 
[0m14:10:47.510272 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 56.13 seconds (296.13s).
[0m14:10:47.511295 [debug] [MainThread]: Command end result
[0m14:10:47.536769 [info ] [MainThread]: 
[0m14:10:47.537458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:47.537993 [info ] [MainThread]: 
[0m14:10:47.538549 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:47.539556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 298.2334, "process_user_time": 5.409982, "process_kernel_time": 0.302054, "process_mem_max_rss": "302600", "process_in_blocks": "3816", "process_out_blocks": "95512"}
[0m14:10:47.540077 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:47.539973 after 298.23 seconds
[0m14:10:47.540571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1638ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1819f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab119144d0>]}
[0m14:10:47.541010 [debug] [MainThread]: Flushing usage events
[0m14:10:49.543002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a70b2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a6cd1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a6b71dc0>]}


============================== 14:10:49.546084 | 7fcea6cb-18f7-4009-8725-05b37acf4e00 ==============================
[0m14:10:49.546084 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:49.546826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:49.698999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fcea6cb-18f7-4009-8725-05b37acf4e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a6b2b530>]}
[0m14:10:49.717292 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22486986, "process_user_time": 1.337961, "process_kernel_time": 0.113911, "process_mem_max_rss": "92772", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:49.717820 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:49.717720 after 0.23 seconds
[0m14:10:49.718280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a7de6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a6cb36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a72f5ac0>]}
[0m14:10:49.718738 [debug] [MainThread]: Flushing usage events
[0m22:05:44.513646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e5ff650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e0e7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e5ffe30>]}


============================== 22:05:44.521344 | 6e9db051-41f7-4e25-98f2-2ac466a04e7a ==============================
[0m22:05:44.521344 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.522061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.660968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e9db051-41f7-4e25-98f2-2ac466a04e7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773db2bb00>]}
[0m22:05:44.674561 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jz3dwvti'
[0m22:05:44.675013 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:44.882937 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:44.883683 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:44.906919 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:44.910811 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:44.979060 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:44.979620 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:44.980170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6e9db051-41f7-4e25-98f2-2ac466a04e7a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773dd2fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773dabe960>]}
[0m22:05:44.980656 [info ] [MainThread]: 
[0m22:05:44.981169 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:44.982846 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5183269, "process_user_time": 1.503619, "process_kernel_time": 0.089917, "process_mem_max_rss": "94420", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m22:05:44.983396 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:44.983283 after 0.52 seconds
[0m22:05:44.983899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e5fc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e5fe840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e5ffe30>]}
[0m22:05:44.984313 [debug] [MainThread]: Flushing usage events
[0m22:05:46.417856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab36f7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab1ccd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab405c470>]}


============================== 22:05:46.420701 | c669faee-ad0d-41d6-b7a5-18dd5bbe78fe ==============================
[0m22:05:46.420701 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:46.421343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:46.647873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaadb417c0>]}
[0m22:05:46.706254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab2d45e80>]}
[0m22:05:46.708838 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:46.751951 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:46.752673 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:46.753200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab195dfd0>]}
[0m22:05:48.024444 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:48.025052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaad766600>]}
[0m22:05:48.208586 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:48.259623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaad8c1610>]}
[0m22:05:48.340511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaad723e00>]}
[0m22:05:48.341025 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:48.341541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaad8f5790>]}
[0m22:05:48.343215 [info ] [MainThread]: 
[0m22:05:48.343898 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:48.348464 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:48.383717 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:48.384172 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:48.384587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:48.836012 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.837808 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:48.838915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:48.839561 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:48.847797 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:48.848243 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:48.848663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:48.849530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.850926 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:48.851325 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:48.851891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.852280 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:48.852677 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:48.853237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.854183 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:48.854623 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:48.855009 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:48.855551 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.855956 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:48.857135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:48.862745 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:48.863165 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:48.863573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:48.864216 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.864646 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:48.865026 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:48.878135 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:48.879592 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:48.880795 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:48.881203 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:48.883311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaad58d130>]}
[0m22:05:48.883838 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.884220 [debug] [MainThread]: On master: BEGIN
[0m22:05:48.884604 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:48.885196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.885619 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.885991 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.886349 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.886891 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.887279 [debug] [MainThread]: On master: Close
[0m22:05:48.887814 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:48.888306 [info ] [MainThread]: 
[0m22:05:48.899494 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:48.900073 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:48.900719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:48.901162 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:48.927441 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:48.928183 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:48.963469 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:48.964190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:40.462038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:40.462550 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:40.463173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.463643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:40.464073 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:40.464762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.467598 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:40.468049 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:40.468715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.485135 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:40.485625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:40.486063 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:40.487356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.492312 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:40.492832 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:40.494326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.496649 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:40.498153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba840461b0>]}
[0m22:10:40.498850 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.60s]
[0m22:10:40.499667 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:40.500616 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:40.501246 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:40.501865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:40.502308 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:40.508051 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:40.508717 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:40.543232 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:40.543744 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250326221040537295"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:40.544211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:40.552003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.559312 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:40.559790 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:40.560378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.560836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:40.561269 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250326221040537295'
      
      
      order by ordinal_position

  
[0m22:10:40.565557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.570510 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:40.570978 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:40.574176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.581631 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:40.582096 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:40.585027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.602876 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:40.603587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:40.604059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250326221040537295"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250326221040537295"
    )
  
[0m22:10:40.656237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.658253 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:40.658736 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:40.659161 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:40.666033 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:40.666934 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:40.668528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c669faee-ad0d-41d6-b7a5-18dd5bbe78fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba78d776b0>]}
[0m22:10:40.669215 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:40.669965 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:40.671219 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:40.671668 [debug] [MainThread]: On master: BEGIN
[0m22:10:40.672048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:40.672679 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:40.673084 [debug] [MainThread]: On master: COMMIT
[0m22:10:40.673485 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:40.673856 [debug] [MainThread]: On master: COMMIT
[0m22:10:40.674387 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:40.674818 [debug] [MainThread]: On master: Close
[0m22:10:40.675429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:40.675801 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:40.676199 [info ] [MainThread]: 
[0m22:10:40.676687 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.33 seconds (292.33s).
[0m22:10:40.677579 [debug] [MainThread]: Command end result
[0m22:10:40.702438 [info ] [MainThread]: 
[0m22:10:40.702976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:40.703441 [info ] [MainThread]: 
[0m22:10:40.703904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:40.704799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.33664, "process_user_time": 4.609824, "process_kernel_time": 0.283558, "process_mem_max_rss": "289176", "process_in_blocks": "3816", "process_out_blocks": "95560"}
[0m22:10:40.705302 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:40.705207 after 294.34 seconds
[0m22:10:40.705753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab405c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbab1be9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaad8a2000>]}
[0m22:10:40.706174 [debug] [MainThread]: Flushing usage events
[0m22:10:42.419670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae749019d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae740afa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae73de39e0>]}


============================== 22:10:42.422578 | 46b66af4-0db0-4572-bbcb-9c4a119b2cce ==============================
[0m22:10:42.422578 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:42.423251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:10:42.562756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46b66af4-0db0-4572-bbcb-9c4a119b2cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae741bc3b0>]}
[0m22:10:42.580841 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21104136, "process_user_time": 1.302258, "process_kernel_time": 0.10502, "process_mem_max_rss": "93096", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:10:42.581352 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:42.581253 after 0.21 seconds
[0m22:10:42.581818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7388cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7354df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7349af00>]}
[0m22:10:42.582246 [debug] [MainThread]: Flushing usage events
[0m06:02:14.473797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc7246e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc72613770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6faa1250>]}


============================== 06:02:14.482132 | 058faae3-d6b9-4660-868f-6b8460bdabe7 ==============================
[0m06:02:14.482132 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.482798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.628544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '058faae3-d6b9-4660-868f-6b8460bdabe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6ee3e0f0>]}
[0m06:02:14.642167 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4p0fkxq8'
[0m06:02:14.642691 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:14.749445 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:14.750140 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:14.772275 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:14.776195 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:14.873911 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:14.874527 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:14.875051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '058faae3-d6b9-4660-868f-6b8460bdabe7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6f6b4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6edd25a0>]}
[0m06:02:14.875548 [info ] [MainThread]: 
[0m06:02:14.876019 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:14.877963 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45377728, "process_user_time": 1.494162, "process_kernel_time": 0.123343, "process_mem_max_rss": "94548", "process_in_blocks": "5760", "process_out_blocks": "4024"}
[0m06:02:14.878518 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:14.878414 after 0.45 seconds
[0m06:02:14.878957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6fd5cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6eee5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6eee58b0>]}
[0m06:02:14.879415 [debug] [MainThread]: Flushing usage events
[0m06:02:16.517129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eb2ef530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eaaa3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eaaa3c50>]}


============================== 06:02:16.520234 | 1b0ce873-9c9c-4098-8302-d2ea82c60741 ==============================
[0m06:02:16.520234 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.520941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:16.756160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ead0d7c0>]}
[0m06:02:16.815051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ea911af0>]}
[0m06:02:16.817585 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:16.834549 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:16.835275 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:16.835852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ea855490>]}
[0m06:02:18.121865 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:18.122533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e6954ce0>]}
[0m06:02:18.309655 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:18.363877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e67e4aa0>]}
[0m06:02:18.447311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e66263c0>]}
[0m06:02:18.447894 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:18.448407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e67ff770>]}
[0m06:02:18.450114 [info ] [MainThread]: 
[0m06:02:18.450777 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:18.455504 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:18.491322 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:18.491850 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:18.492250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:18.883985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.885795 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:18.886929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:18.887600 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:18.895520 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.895951 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:18.896339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.897334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.898787 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.899189 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:18.899789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.900182 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.900616 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:18.901190 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.902139 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.902562 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:18.902943 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:18.903500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.903910 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:18.905131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:18.910865 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.911283 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:18.911698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:18.912331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.912752 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:18.913147 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:18.927027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:18.928539 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:18.929785 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:18.930194 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:18.932534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ec0b3bf0>]}
[0m06:02:18.933048 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.933471 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.933845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:18.934485 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.934894 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.935280 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.935679 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.936216 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.936640 [debug] [MainThread]: On master: Close
[0m06:02:18.937171 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:18.937739 [info ] [MainThread]: 
[0m06:02:18.950111 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:18.950733 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:18.951383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:18.951839 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:18.978743 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:18.979533 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:19.015556 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:19.016297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:12.075852 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.076384 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:12.077024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.077487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.077915 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:12.078846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.081759 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.082208 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:12.082907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.099346 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:12.099841 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.100286 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:12.101482 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.106480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.106934 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:12.108259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.110557 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:12.112075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44c838e090>]}
[0m06:07:12.112771 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.16s]
[0m06:07:12.113526 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:12.114343 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:12.114929 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:12.115684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:12.116129 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:12.121025 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:12.121694 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:12.157170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.157732 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250327060712151180"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:12.158197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:12.165932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.173660 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.174123 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:12.174767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.175207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.175666 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250327060712151180'
      
      
      order by ordinal_position

  
[0m06:07:12.180194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.185263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.185752 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:12.188380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.195851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.196316 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:12.198594 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.216405 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:12.217121 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.217613 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250327060712151180"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250327060712151180"
    )
  
[0m06:07:12.266851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.268849 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:12.269317 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.269765 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:12.276773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.277684 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:12.279268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b0ce873-9c9c-4098-8302-d2ea82c60741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44bcd97080>]}
[0m06:07:12.279963 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:12.280727 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:12.282062 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:12.282507 [debug] [MainThread]: On master: BEGIN
[0m06:07:12.282886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:12.283547 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:12.283950 [debug] [MainThread]: On master: COMMIT
[0m06:07:12.284320 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:12.284723 [debug] [MainThread]: On master: COMMIT
[0m06:07:12.285270 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:12.285689 [debug] [MainThread]: On master: Close
[0m06:07:12.286311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:12.286754 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:12.287162 [info ] [MainThread]: 
[0m06:07:12.287670 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.84 seconds (293.84s).
[0m06:07:12.288617 [debug] [MainThread]: Command end result
[0m06:07:12.314291 [info ] [MainThread]: 
[0m06:07:12.314901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:12.315401 [info ] [MainThread]: 
[0m06:07:12.315906 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:12.316886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.85043, "process_user_time": 5.079947, "process_kernel_time": 0.272889, "process_mem_max_rss": "304228", "process_in_blocks": "3816", "process_out_blocks": "95120"}
[0m06:07:12.317425 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:12.317301 after 295.85 seconds
[0m06:07:12.317863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d49edd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eaeb8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eaeba930>]}
[0m06:07:12.318288 [debug] [MainThread]: Flushing usage events
[0m06:07:14.113165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889efe1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889e603080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889e602000>]}


============================== 06:07:14.116131 | 655e3dee-5ce1-4a81-9c22-9cf24d51659e ==============================
[0m06:07:14.116131 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:14.116847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:14.259793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '655e3dee-5ce1-4a81-9c22-9cf24d51659e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889e7b2720>]}
[0m06:07:14.278268 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21510422, "process_user_time": 1.333941, "process_kernel_time": 0.096995, "process_mem_max_rss": "93028", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:14.278832 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:14.278729 after 0.22 seconds
[0m06:07:14.279272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889e6d67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889e596030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889e7b2720>]}
[0m06:07:14.279736 [debug] [MainThread]: Flushing usage events
[0m14:05:36.499563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32120c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc321874d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32120c8c0>]}


============================== 14:05:36.548434 | 6ac21521-66ec-4889-81d1-4eb10715d08f ==============================
[0m14:05:36.548434 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.549182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.700288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ac21521-66ec-4889-81d1-4eb10715d08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32075e750>]}
[0m14:05:36.714556 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vx76u6bn'
[0m14:05:36.715060 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:36.755253 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:36.756106 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:36.767377 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:36.771581 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:36.982168 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:36.982770 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:36.983355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6ac21521-66ec-4889-81d1-4eb10715d08f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc32063d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3206f6870>]}
[0m14:05:36.983823 [info ] [MainThread]: 
[0m14:05:36.984328 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:36.998915 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54837584, "process_user_time": 1.509554, "process_kernel_time": 0.116505, "process_mem_max_rss": "94436", "process_in_blocks": "5728", "process_out_blocks": "4008"}
[0m14:05:36.999630 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:36.999520 after 0.55 seconds
[0m14:05:37.000216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc320fb3bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc320d175c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3206e7980>]}
[0m14:05:37.000691 [debug] [MainThread]: Flushing usage events
[0m14:05:38.771854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba125e91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba125b7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba130b6ff0>]}


============================== 14:05:38.775026 | b29214cf-6de6-4564-b3c8-11f86d9b1823 ==============================
[0m14:05:38.775026 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:38.775793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:39.016709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1324c650>]}
[0m14:05:39.076207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1387dc40>]}
[0m14:05:39.078876 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:39.108184 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:39.108956 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:39.109511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba11fa2930>]}
[0m14:05:40.391490 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:40.392139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba0e0efaa0>]}
[0m14:05:40.578345 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:40.634535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba0dfbc260>]}
[0m14:05:40.773892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba0de321b0>]}
[0m14:05:40.774515 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:40.775042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba0de6bcb0>]}
[0m14:05:40.776825 [info ] [MainThread]: 
[0m14:05:40.777522 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:40.782288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:40.819460 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:40.819962 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:40.820399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:41.286194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.287844 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:41.288928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:41.289542 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:41.297211 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.297647 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:41.298041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:41.299175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.300602 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.301004 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:41.301657 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.302054 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.302462 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:41.303077 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.304015 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:41.304441 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.304819 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:41.305391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.305797 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:41.307051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:41.312794 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:41.313236 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:41.313615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:41.314252 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.314660 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:41.315057 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:41.329302 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.330784 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:41.332019 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:41.332466 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:41.334871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba0de4b020>]}
[0m14:05:41.335457 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:41.335847 [debug] [MainThread]: On master: BEGIN
[0m14:05:41.336243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:41.336878 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:41.337320 [debug] [MainThread]: On master: COMMIT
[0m14:05:41.337714 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:41.338083 [debug] [MainThread]: On master: COMMIT
[0m14:05:41.338648 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:41.339048 [debug] [MainThread]: On master: Close
[0m14:05:41.339590 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:41.340055 [info ] [MainThread]: 
[0m14:05:41.365076 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:41.365737 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:41.366376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:41.366826 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:41.393657 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:41.394456 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:41.430220 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:41.430987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:35.513651 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:35.514205 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:17:35.514891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.515373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:35.515812 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:17:35.516597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.519643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:35.520116 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:17:35.520878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.537519 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:17:35.538039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:35.538519 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:17:35.539963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.545186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:17:35.545655 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:17:35.547426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.549846 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:17:35.551407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1387cc80>]}
[0m14:17:35.552088 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 714.18s]
[0m14:17:35.552892 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:17:35.553721 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:17:35.554304 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:17:35.555079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:17:35.555570 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:17:35.561618 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:17:35.562332 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:17:35.597410 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:35.597991 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250327141735591294"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:17:35.598494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:35.606839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.614838 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:35.615344 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:17:35.616042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.616518 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:35.616949 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250327141735591294'
      
      
      order by ordinal_position

  
[0m14:17:35.621546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.626963 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:35.627463 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:17:35.630016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.637811 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:35.638312 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:17:35.641354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.659562 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:17:35.660411 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:35.660893 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250327141735591294"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250327141735591294"
    )
  
[0m14:17:35.715280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.717331 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:17:35.717831 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:17:35.718281 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:17:35.725925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:17:35.727023 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:17:35.728560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29214cf-6de6-4564-b3c8-11f86d9b1823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9e41f74d0>]}
[0m14:17:35.729280 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:17:35.730101 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:17:35.731558 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:35.731986 [debug] [MainThread]: On master: BEGIN
[0m14:17:35.732412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:35.733271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:17:35.733690 [debug] [MainThread]: On master: COMMIT
[0m14:17:35.734072 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:35.734484 [debug] [MainThread]: On master: COMMIT
[0m14:17:35.735056 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:17:35.735500 [debug] [MainThread]: On master: Close
[0m14:17:35.736187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:35.736569 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:17:35.736995 [info ] [MainThread]: 
[0m14:17:35.737540 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 11 minutes and 54.96 seconds (714.96s).
[0m14:17:35.738609 [debug] [MainThread]: Command end result
[0m14:17:35.765873 [info ] [MainThread]: 
[0m14:17:35.766605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:35.767171 [info ] [MainThread]: 
[0m14:17:35.767722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:17:35.768855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 717.0481, "process_user_time": 5.245689, "process_kernel_time": 0.285581, "process_mem_max_rss": "298568", "process_in_blocks": "3816", "process_out_blocks": "95536"}
[0m14:17:35.769427 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:35.769319 after 717.05 seconds
[0m14:17:35.769897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9fc1dee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba0de32420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba126ab170>]}
[0m14:17:35.770368 [debug] [MainThread]: Flushing usage events
[0m14:17:37.940615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5607555340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560816d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5608020fe0>]}


============================== 14:17:37.943765 | d4f693fb-0d52-4c2c-8531-9dbf435a3fb5 ==============================
[0m14:17:37.943765 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:17:37.944492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:17:38.098346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4f693fb-0d52-4c2c-8531-9dbf435a3fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5607bed4c0>]}
[0m14:17:38.117166 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2276848, "process_user_time": 1.360305, "process_kernel_time": 0.114941, "process_mem_max_rss": "92844", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:17:38.117717 [debug] [MainThread]: Command `dbt clean` succeeded at 14:17:38.117612 after 0.23 seconds
[0m14:17:38.118185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f560b4d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5607bed4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5608920680>]}
[0m14:17:38.118648 [debug] [MainThread]: Flushing usage events
[0m22:05:50.554597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21dcf7e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21dd54f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21dfacc140>]}


============================== 22:05:50.588455 | 61c8ddce-668a-455a-808c-613dd1b94c5b ==============================
[0m22:05:50.588455 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.589185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.700249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61c8ddce-668a-455a-808c-613dd1b94c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21dd8272f0>]}
[0m22:05:50.716213 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u2rrea1e'
[0m22:05:50.716743 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:50.768660 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:50.769364 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:50.779815 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:50.783696 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:50.999837 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:51.000447 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:51.001089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '61c8ddce-668a-455a-808c-613dd1b94c5b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21de0ee3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21dccdef90>]}
[0m22:05:51.001580 [info ] [MainThread]: 
[0m22:05:51.002109 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:51.013726 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5096464, "process_user_time": 1.635693, "process_kernel_time": 0.119684, "process_mem_max_rss": "99948", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m22:05:51.014367 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:51.014245 after 0.51 seconds
[0m22:05:51.014861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21dcea6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21dddb78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21dcc82f30>]}
[0m22:05:51.015295 [debug] [MainThread]: Flushing usage events
[0m22:05:52.817798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577b6ea7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577b042d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577b55d4c0>]}


============================== 22:05:52.820835 | f7991ce8-6bba-419a-8f50-cb1b790877f0 ==============================
[0m22:05:52.820835 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.821545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.023262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577a942ae0>]}
[0m22:05:53.082200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577aa71820>]}
[0m22:05:53.084727 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:53.132225 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:53.133027 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:53.133578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577a96ab40>]}
[0m22:05:54.415671 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:54.416335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5776ba61b0>]}
[0m22:05:54.649660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:54.654931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577aa83cb0>]}
[0m22:05:54.740107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5776980f50>]}
[0m22:05:54.740689 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:54.741184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5776a28aa0>]}
[0m22:05:54.743528 [info ] [MainThread]: 
[0m22:05:54.744242 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:54.748953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:54.784239 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:54.784750 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:54.785148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.283973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.285910 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:55.287078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:55.287773 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:55.295974 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.296409 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:55.296826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.297748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.299200 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.299629 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:55.300184 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.300612 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.300993 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:55.301600 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.302541 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.302947 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.303323 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.303904 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.304314 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:55.305636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:55.311603 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.312018 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:55.312394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.313089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.313521 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.313968 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:55.328617 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.330168 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:55.331416 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:55.331854 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:55.334275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5776983aa0>]}
[0m22:05:55.334822 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.335218 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.335616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:55.336246 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.336677 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.337067 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.337442 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.338007 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.338404 [debug] [MainThread]: On master: Close
[0m22:05:55.338959 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:55.339435 [info ] [MainThread]: 
[0m22:05:55.349473 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:55.350124 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:55.350740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:55.351184 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:55.379712 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:55.380555 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:55.416991 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:55.417835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:47.656540 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:47.657143 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:17:47.658079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.658580 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:47.659023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:17:47.660040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.663479 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:47.664005 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:17:47.664988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.682854 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:17:47.683451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:47.683929 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:17:47.685572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.691432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:17:47.692023 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:17:47.693945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.696680 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:17:47.698421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5742d34ad0>]}
[0m22:17:47.699203 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 712.35s]
[0m22:17:47.700076 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:17:47.701070 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:17:47.701742 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:17:47.702468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:17:47.703077 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:17:47.708772 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:17:47.709602 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:17:47.747345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:47.748029 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250327221747740617"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:17:47.748593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:47.757448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.766432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:47.766995 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:17:47.767784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.768230 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:47.768688 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250327221747740617'
      
      
      order by ordinal_position

  
[0m22:17:47.773659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.780034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:47.780530 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:17:47.782888 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.790420 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:47.790923 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:17:47.793523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.811400 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:17:47.812108 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:47.812602 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250327221747740617"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250327221747740617"
    )
  
[0m22:17:47.869161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.871239 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:17:47.871765 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:17:47.872199 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:17:47.880968 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:17:47.882080 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:17:47.883768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7991ce8-6bba-419a-8f50-cb1b790877f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577ac50e60>]}
[0m22:17:47.884552 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m22:17:47.885396 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:17:47.886808 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:47.887238 [debug] [MainThread]: On master: BEGIN
[0m22:17:47.887665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:47.888536 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:47.888960 [debug] [MainThread]: On master: COMMIT
[0m22:17:47.889343 [debug] [MainThread]: Using duckdb connection "master"
[0m22:17:47.889758 [debug] [MainThread]: On master: COMMIT
[0m22:17:47.890378 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:17:47.890861 [debug] [MainThread]: On master: Close
[0m22:17:47.891553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:47.891945 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:17:47.892381 [info ] [MainThread]: 
[0m22:17:47.892935 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 11 minutes and 53.15 seconds (713.15s).
[0m22:17:47.893993 [debug] [MainThread]: Command end result
[0m22:17:47.920822 [info ] [MainThread]: 
[0m22:17:47.921582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:47.922145 [info ] [MainThread]: 
[0m22:17:47.922719 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:17:47.923808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 715.1558, "process_user_time": 5.174393, "process_kernel_time": 0.271755, "process_mem_max_rss": "304796", "process_in_blocks": "1184", "process_out_blocks": "94400"}
[0m22:17:47.924340 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:47.924238 after 715.16 seconds
[0m22:17:47.924826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577d581820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f577b086db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5742d34f80>]}
[0m22:17:47.925287 [debug] [MainThread]: Flushing usage events
[0m22:17:50.020187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12b5aaff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12ab39160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12c76c410>]}


============================== 22:17:50.023694 | dd937ff5-bcbb-440e-b3c6-67c9916f4399 ==============================
[0m22:17:50.023694 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:17:50.024422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:50.145678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd937ff5-bcbb-440e-b3c6-67c9916f4399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12aa1d3d0>]}
[0m22:17:50.165565 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19725211, "process_user_time": 1.412947, "process_kernel_time": 0.116995, "process_mem_max_rss": "98732", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:17:50.166113 [debug] [MainThread]: Command `dbt clean` succeeded at 22:17:50.166000 after 0.20 seconds
[0m22:17:50.166580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12b499fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12aa1fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12aa1d3d0>]}
[0m22:17:50.167015 [debug] [MainThread]: Flushing usage events
[0m06:02:10.787308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6516fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a655cfc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a655cde80>]}


============================== 06:02:10.795538 | f3bff6af-a9ab-40dd-9770-ded142003e0a ==============================
[0m06:02:10.795538 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.796249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.906329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3bff6af-a9ab-40dd-9770-ded142003e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a64ae4230>]}
[0m06:02:10.921578 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ppmhh69k'
[0m06:02:10.922031 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.075114 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.075801 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.127805 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.131673 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.261892 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.262440 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:11.262960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3bff6af-a9ab-40dd-9770-ded142003e0a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a64857bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a64857e90>]}
[0m06:02:11.263437 [info ] [MainThread]: 
[0m06:02:11.263915 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:11.286378 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54858893, "process_user_time": 1.578482, "process_kernel_time": 0.136041, "process_mem_max_rss": "99804", "process_in_blocks": "8392", "process_out_blocks": "5184"}
[0m06:02:11.286932 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.286835 after 0.55 seconds
[0m06:02:11.287388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a64ae4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a655cd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6555d0d0>]}
[0m06:02:11.287834 [debug] [MainThread]: Flushing usage events
[0m06:02:12.878628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9deba4f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dea9e93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9deb4f2900>]}


============================== 06:02:12.881649 | 031d5f11-6949-4cc3-8a25-c72f703c2332 ==============================
[0m06:02:12.881649 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.882325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.083840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9deb441ee0>]}
[0m06:02:13.142880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9deae8adb0>]}
[0m06:02:13.145407 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:13.189406 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.190116 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.190697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dea7873e0>]}
[0m06:02:14.485304 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.485914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9de68f8f80>]}
[0m06:02:14.719858 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.725090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9deb3a6a80>]}
[0m06:02:14.828919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9de6615a90>]}
[0m06:02:14.829455 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:14.829934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9de6621d60>]}
[0m06:02:14.831736 [info ] [MainThread]: 
[0m06:02:14.832421 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.836947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.871025 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.871488 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:14.871885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.229914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.231569 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.232654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.233279 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.240698 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.241135 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.241556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.242949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.244449 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.244857 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.245445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.245843 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.246240 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.246847 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.247797 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.248212 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.248598 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.249156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.249602 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.250798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.256551 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.256965 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.257387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.258016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.258445 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.258830 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.272637 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.274076 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.275327 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.275738 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.277953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dec53e150>]}
[0m06:02:15.278493 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.278885 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.279273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.279880 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.280316 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.280688 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.281051 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.281592 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.281986 [debug] [MainThread]: On master: Close
[0m06:02:15.282524 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.283031 [info ] [MainThread]: 
[0m06:02:15.292783 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.293380 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.294020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:15.294492 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.322434 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.323189 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.358869 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.359622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:07.609205 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:07.609718 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:07.610378 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.610830 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:07.611280 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:07.611971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.614887 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:07.615356 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:07.616100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.632601 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:07.633072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:07.633528 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:07.634759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.639722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:07.640208 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:07.641430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.643766 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:07.645304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbcd24aa0>]}
[0m06:07:07.645990 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.35s]
[0m06:07:07.646834 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:07.647653 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:07.648236 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:07.648885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:07.649355 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:07.654320 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:07.655164 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:07.690292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:07.690808 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250328060707684249"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:07.691283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:07.699511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.707050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:07.707538 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:07.708143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.708608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:07.709043 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250328060707684249'
      
      
      order by ordinal_position

  
[0m06:07:07.713792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.720012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:07.720508 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:07.723668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.731222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:07.731693 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:07.734784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.752731 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:07.753439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:07.753901 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250328060707684249"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250328060707684249"
    )
  
[0m06:07:07.809425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.811440 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:07.811895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:07.812345 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:07.819489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:07.820395 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:07.822091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031d5f11-6949-4cc3-8a25-c72f703c2332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbcdcb230>]}
[0m06:07:07.822788 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:07.823529 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:07.824811 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:07.825268 [debug] [MainThread]: On master: BEGIN
[0m06:07:07.825670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:07.826372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:07.826785 [debug] [MainThread]: On master: COMMIT
[0m06:07:07.827169 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:07.827577 [debug] [MainThread]: On master: COMMIT
[0m06:07:07.828127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:07.828563 [debug] [MainThread]: On master: Close
[0m06:07:07.829147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:07.829566 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:07.829975 [info ] [MainThread]: 
[0m06:07:07.830465 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.00 seconds (293.00s).
[0m06:07:07.831388 [debug] [MainThread]: Command end result
[0m06:07:07.856377 [info ] [MainThread]: 
[0m06:07:07.857002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:07.857482 [info ] [MainThread]: 
[0m06:07:07.857951 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:07.858891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.03018, "process_user_time": 4.661757, "process_kernel_time": 0.266986, "process_mem_max_rss": "298036", "process_in_blocks": "1184", "process_out_blocks": "94352"}
[0m06:07:07.859456 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:07.859352 after 295.03 seconds
[0m06:07:07.859901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9deb3a5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dd414e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9de66d93d0>]}
[0m06:07:07.860359 [debug] [MainThread]: Flushing usage events
[0m06:07:09.717065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e8ea2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e877db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e8acef60>]}


============================== 06:07:09.719962 | a25eb863-1353-4555-82b2-702efb6f5463 ==============================
[0m06:07:09.719962 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:09.720631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:07:09.831081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a25eb863-1353-4555-82b2-702efb6f5463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e85243e0>]}
[0m06:07:09.850098 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18229239, "process_user_time": 1.337294, "process_kernel_time": 0.113024, "process_mem_max_rss": "98736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:09.850626 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:09.850526 after 0.18 seconds
[0m06:07:09.851050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e92651c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e85243e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e84bcfb0>]}
[0m06:07:09.851494 [debug] [MainThread]: Flushing usage events
[0m14:05:30.829406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd423174cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd422aa2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd422790bf0>]}


============================== 14:05:30.887156 | 08f877c1-f8fc-4526-849c-8e2e63cc9ee1 ==============================
[0m14:05:30.887156 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.888120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.010332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f877c1-f8fc-4526-849c-8e2e63cc9ee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42305d910>]}
[0m14:05:31.030606 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zh072hd8'
[0m14:05:31.031259 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:31.097408 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:31.098288 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:31.110219 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:31.114423 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:31.252456 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:31.253172 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:31.253834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '08f877c1-f8fc-4526-849c-8e2e63cc9ee1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4223d3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4223d3ad0>]}
[0m14:05:31.254402 [info ] [MainThread]: 
[0m14:05:31.254986 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:31.291304 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5172007, "process_user_time": 1.686415, "process_kernel_time": 0.17194, "process_mem_max_rss": "99772", "process_in_blocks": "8560", "process_out_blocks": "5176"}
[0m14:05:31.292073 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:31.291932 after 0.52 seconds
[0m14:05:31.292599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42549bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42345c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42236f9b0>]}
[0m14:05:31.293123 [debug] [MainThread]: Flushing usage events
[0m14:05:33.134293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f959f0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f95d39b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f95d3a6f0>]}


============================== 14:05:33.137680 | ecae25ca-0899-41e5-b5ab-4d903db0033b ==============================
[0m14:05:33.137680 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.138402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.351274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f9592a390>]}
[0m14:05:33.412893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f96aafda0>]}
[0m14:05:33.416476 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:33.463921 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:33.464763 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:33.465343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f91986300>]}
[0m14:05:34.761231 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:34.761928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f916341d0>]}
[0m14:05:35.020157 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:35.025822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f916d3650>]}
[0m14:05:35.152374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f916e3e00>]}
[0m14:05:35.153019 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:35.153576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f916617f0>]}
[0m14:05:35.155587 [info ] [MainThread]: 
[0m14:05:35.156349 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:35.161266 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:35.197639 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:35.198213 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:35.198619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:35.530126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.531755 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:35.532780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:35.533373 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:35.541061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.541522 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:35.541940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.543378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.544954 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.545364 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:35.545979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.546380 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.546758 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:35.547455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.548533 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:35.549026 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.549477 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:35.550189 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.550726 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:35.552267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:35.558415 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:35.558842 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:35.559252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.559968 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.560375 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:35.560765 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:35.575471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.577297 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:35.578621 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:35.579070 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:35.581599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f91662420>]}
[0m14:05:35.582213 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.582628 [debug] [MainThread]: On master: BEGIN
[0m14:05:35.583053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:35.583863 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.584322 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.584710 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.585118 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.585693 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.586162 [debug] [MainThread]: On master: Close
[0m14:05:35.586759 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:35.587286 [info ] [MainThread]: 
[0m14:05:35.609479 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:35.610251 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:35.610936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:35.611415 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:35.640847 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:35.641789 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:35.678963 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:35.679984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:26.606238 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:26.606772 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:26.607513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.607976 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:26.608441 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:26.609197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.612244 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:26.612696 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:26.613415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.630211 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:26.630722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:26.631179 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:26.632652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.637852 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:26.638345 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:26.639691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.642116 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:26.643684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f5cd34b60>]}
[0m14:10:26.644412 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.03s]
[0m14:10:26.645178 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:26.646199 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:26.646837 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:26.647514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:26.647978 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:26.652957 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:26.653630 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:26.689342 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:26.689918 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250328141026683230"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:26.690399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:26.698720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.706595 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:26.707097 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:26.707785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.708271 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:26.708706 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250328141026683230'
      
      
      order by ordinal_position

  
[0m14:10:26.713917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.720990 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:26.721515 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:26.724517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.732560 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:26.733064 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:26.735604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.753887 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:26.754647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:26.755143 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250328141026683230"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250328141026683230"
    )
  
[0m14:10:26.806627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.808765 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:26.809247 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:26.809671 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:26.817112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:26.818066 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:26.819704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecae25ca-0899-41e5-b5ab-4d903db0033b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f80807440>]}
[0m14:10:26.820412 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:26.821184 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:26.822517 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:26.823015 [debug] [MainThread]: On master: BEGIN
[0m14:10:26.823446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:26.824187 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:26.824604 [debug] [MainThread]: On master: COMMIT
[0m14:10:26.825025 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:26.825406 [debug] [MainThread]: On master: COMMIT
[0m14:10:26.825968 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:26.826378 [debug] [MainThread]: On master: Close
[0m14:10:26.827006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:26.827392 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:26.827803 [info ] [MainThread]: 
[0m14:10:26.828330 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 51.67 seconds (291.67s).
[0m14:10:26.829291 [debug] [MainThread]: Command end result
[0m14:10:26.855190 [info ] [MainThread]: 
[0m14:10:26.855903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:26.856423 [info ] [MainThread]: 
[0m14:10:26.856957 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:26.858020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.77548, "process_user_time": 5.208058, "process_kernel_time": 0.293172, "process_mem_max_rss": "304988", "process_in_blocks": "1184", "process_out_blocks": "94368"}
[0m14:10:26.858559 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:26.858456 after 293.78 seconds
[0m14:10:26.859042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f95ea63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f75fdba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f918a0920>]}
[0m14:10:26.859492 [debug] [MainThread]: Flushing usage events
[0m14:10:28.963403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf6b58ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf6f23530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf7115040>]}


============================== 14:10:28.966603 | e957ca82-cfe2-4b6c-8830-5ef072e38483 ==============================
[0m14:10:28.966603 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:28.967300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:29.081430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e957ca82-cfe2-4b6c-8830-5ef072e38483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf6b88f80>]}
[0m14:10:29.102278 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1906158, "process_user_time": 1.423459, "process_kernel_time": 0.112957, "process_mem_max_rss": "98716", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:10:29.102836 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:29.102730 after 0.19 seconds
[0m14:10:29.103323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfb163da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf793e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf7115040>]}
[0m14:10:29.103774 [debug] [MainThread]: Flushing usage events
[0m22:05:58.493305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62968015b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62965953d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6296595400>]}


============================== 22:05:58.512582 | 4c5612a8-e5b3-405a-80f4-893beb12e982 ==============================
[0m22:05:58.512582 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:58.513372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:58.625014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c5612a8-e5b3-405a-80f4-893beb12e982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62958e5f10>]}
[0m22:05:58.641323 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cno1x349'
[0m22:05:58.641869 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:58.679011 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:58.679703 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:58.693026 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:58.696975 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:58.910387 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:58.911095 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:58.911725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4c5612a8-e5b3-405a-80f4-893beb12e982', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62958fa000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6295f00830>]}
[0m22:05:58.912219 [info ] [MainThread]: 
[0m22:05:58.912786 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:58.920343 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47709852, "process_user_time": 1.612016, "process_kernel_time": 0.136085, "process_mem_max_rss": "99940", "process_in_blocks": "8360", "process_out_blocks": "5176"}
[0m22:05:58.920933 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:58.920825 after 0.48 seconds
[0m22:05:58.921377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f629642e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f629588af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6295c5fb60>]}
[0m22:05:58.921840 [debug] [MainThread]: Flushing usage events
[0m22:06:00.724202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20ac5f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20cde8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20a591760>]}


============================== 22:06:00.727274 | be3095e6-1f60-4b81-95b1-ba61924d2398 ==============================
[0m22:06:00.727274 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:00.727993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:00.930511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20a1de2a0>]}
[0m22:06:00.989919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20a2d0980>]}
[0m22:06:00.992425 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:06:01.013315 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:01.014038 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:01.014574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20a6dc470>]}
[0m22:06:02.300097 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:02.300797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe205f1fd10>]}
[0m22:06:02.545419 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:02.550779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20cfb60c0>]}
[0m22:06:02.640960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe205f74290>]}
[0m22:06:02.641553 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:06:02.642083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe205f62690>]}
[0m22:06:02.643963 [info ] [MainThread]: 
[0m22:06:02.644746 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:02.649553 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:02.685694 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:02.686181 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:02.686598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:03.112213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.113948 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:03.115029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:03.115585 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:03.123221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.123679 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:03.124079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:03.125037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.126426 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.126854 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:03.127412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.127851 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.128254 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:03.128845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.129780 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:03.130185 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.130563 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:03.131146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.131553 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:03.132818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:03.138468 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:03.138929 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:03.139326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:03.139980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.140378 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:03.140797 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:03.155611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.157117 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:03.158356 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:03.158790 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:03.161126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe205fe26f0>]}
[0m22:06:03.161689 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.162093 [debug] [MainThread]: On master: BEGIN
[0m22:06:03.162473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:03.163139 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.163550 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.163974 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.164350 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.164907 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.165322 [debug] [MainThread]: On master: Close
[0m22:06:03.165891 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:03.166390 [info ] [MainThread]: 
[0m22:06:03.182673 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:03.183263 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:03.183861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:03.184306 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:03.212306 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:03.213063 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:03.249300 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:03.250064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:55.390844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.391346 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:55.391999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.392447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.392900 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:55.393594 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.396488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.396958 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:55.397622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.414017 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:55.414485 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.414998 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:55.416209 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.421141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.421606 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:55.422819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.425096 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:55.426613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e9f42f00>]}
[0m22:10:55.427312 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.24s]
[0m22:10:55.428095 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:55.428919 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:55.429486 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:55.430254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:55.430756 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:55.435757 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:55.436403 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:55.471396 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.471917 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250328221055465398"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:55.472377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:55.479908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.487341 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.487852 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:55.488465 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.488948 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.489385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250328221055465398'
      
      
      order by ordinal_position

  
[0m22:10:55.493922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.498957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.499442 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:55.502725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.510306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.510803 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:55.513115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.532534 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:55.533241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.533733 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250328221055465398"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250328221055465398"
    )
  
[0m22:10:55.585020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.587048 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:55.587502 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.587967 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:55.594863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.595753 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:55.597486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be3095e6-1f60-4b81-95b1-ba61924d2398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dc301e50>]}
[0m22:10:55.598190 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:55.598932 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:55.600468 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:55.600924 [debug] [MainThread]: On master: BEGIN
[0m22:10:55.601311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:55.601964 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:55.602373 [debug] [MainThread]: On master: COMMIT
[0m22:10:55.602786 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:55.603161 [debug] [MainThread]: On master: COMMIT
[0m22:10:55.603714 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:55.604109 [debug] [MainThread]: On master: Close
[0m22:10:55.604716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:55.605093 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:55.605489 [info ] [MainThread]: 
[0m22:10:55.606023 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.96 seconds (292.96s).
[0m22:10:55.606986 [debug] [MainThread]: Command end result
[0m22:10:55.631016 [info ] [MainThread]: 
[0m22:10:55.631629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:55.632173 [info ] [MainThread]: 
[0m22:10:55.632716 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:55.633694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.95966, "process_user_time": 5.064832, "process_kernel_time": 0.280824, "process_mem_max_rss": "309792", "process_in_blocks": "1184", "process_out_blocks": "93976"}
[0m22:10:55.634198 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:55.634103 after 294.96 seconds
[0m22:10:55.634622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20a420800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe206025850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dc3cac30>]}
[0m22:10:55.635072 [debug] [MainThread]: Flushing usage events
[0m22:10:57.665202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f548a1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f546914c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5475fc20>]}


============================== 22:10:57.668141 | acc6de4a-1a7b-4027-981c-bedabac1c68d ==============================
[0m22:10:57.668141 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:57.668851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:57.778675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acc6de4a-1a7b-4027-981c-bedabac1c68d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f545b2e70>]}
[0m22:10:57.797853 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18223435, "process_user_time": 1.339715, "process_kernel_time": 0.106977, "process_mem_max_rss": "98720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:57.798365 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:57.798266 after 0.18 seconds
[0m22:10:57.798817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f546b85f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f543452b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f545b2e70>]}
[0m22:10:57.799245 [debug] [MainThread]: Flushing usage events
[0m06:02:06.944733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b96c26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b7d3c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b7ef83b0>]}


============================== 06:02:06.975071 | 3a6bc86c-6c6b-4d1f-bf2e-49bd8ddc780c ==============================
[0m06:02:06.975071 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.975798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.086840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a6bc86c-6c6b-4d1f-bf2e-49bd8ddc780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b7d3c170>]}
[0m06:02:07.102850 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-849x2__m'
[0m06:02:07.103351 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.297484 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.298296 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.371143 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.375281 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.433341 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.433942 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:07.434543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3a6bc86c-6c6b-4d1f-bf2e-49bd8ddc780c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b7151a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b85f45f0>]}
[0m06:02:07.435023 [info ] [MainThread]: 
[0m06:02:07.435553 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:07.455240 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.560709, "process_user_time": 1.592128, "process_kernel_time": 0.133178, "process_mem_max_rss": "100064", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m06:02:07.455801 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.455697 after 0.56 seconds
[0m06:02:07.456233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7bb7bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b71d7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b85cc860>]}
[0m06:02:07.456695 [debug] [MainThread]: Flushing usage events
[0m06:02:09.046091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360b513f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3608d0ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3608d770b0>]}


============================== 06:02:09.049145 | 3f34c031-7062-4cdd-a3cd-7e433926e822 ==============================
[0m06:02:09.049145 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.049860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.253550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3608b84bc0>]}
[0m06:02:09.313492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36085f7fe0>]}
[0m06:02:09.316167 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:09.332865 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.333591 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.334124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3608750d70>]}
[0m06:02:10.619107 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:10.619786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36044632f0>]}
[0m06:02:10.849939 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:10.855326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36044e95b0>]}
[0m06:02:10.959032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36044dc470>]}
[0m06:02:10.959603 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:10.960126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3604571fa0>]}
[0m06:02:10.961962 [info ] [MainThread]: 
[0m06:02:10.962715 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:10.967386 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.002233 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.002714 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.003119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:11.366782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.368407 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:11.369492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:11.370081 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:11.377442 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.377897 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:11.378298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.379237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.380710 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.381114 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:11.381744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.382144 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.382538 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:11.383133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.384064 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.384465 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.384879 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.385411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.385837 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:11.387057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:11.392837 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.393252 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:11.393648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.394260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.394683 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.395073 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:11.408652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.410108 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:11.411336 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:11.411776 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:11.413929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36044cd8e0>]}
[0m06:02:11.414447 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.414857 [debug] [MainThread]: On master: BEGIN
[0m06:02:11.415225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:11.415862 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.416262 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.416661 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.417033 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.417563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.417966 [debug] [MainThread]: On master: Close
[0m06:02:11.418483 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:11.418990 [info ] [MainThread]: 
[0m06:02:11.429099 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:11.429726 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:11.430368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:11.430843 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:11.458821 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:11.459577 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:11.495394 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:11.496165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:03.580486 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.581016 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:03.581697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.582142 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.582600 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:03.583295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.586208 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.586673 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:03.587381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.603968 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:03.604435 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.604932 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:03.606184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.611101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.611663 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:03.612832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.615179 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:03.616718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360a470e60>]}
[0m06:07:03.617401 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.19s]
[0m06:07:03.618239 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:03.619057 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:03.619736 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:03.620456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:03.620946 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:03.625879 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:03.626540 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:03.661637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.662138 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250329060703655587"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:03.662617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:03.670575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.678098 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.678579 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:03.679214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.679685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.680115 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250329060703655587'
      
      
      order by ordinal_position

  
[0m06:07:03.684460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.690612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.691081 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:03.694204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.701762 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.702231 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:03.705220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.723136 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:03.723840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.724300 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250329060703655587"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250329060703655587"
    )
  
[0m06:07:03.773534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.775499 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:03.775964 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.776380 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:03.784738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.785626 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:03.787198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f34c031-7062-4cdd-a3cd-7e433926e822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d8344740>]}
[0m06:07:03.787882 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:03.788696 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:03.790069 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:03.790483 [debug] [MainThread]: On master: BEGIN
[0m06:07:03.790906 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:03.791562 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:03.791971 [debug] [MainThread]: On master: COMMIT
[0m06:07:03.792351 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:03.792753 [debug] [MainThread]: On master: COMMIT
[0m06:07:03.793275 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:03.793701 [debug] [MainThread]: On master: Close
[0m06:07:03.794310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:03.794729 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:03.795134 [info ] [MainThread]: 
[0m06:07:03.795682 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.83 seconds (292.83s).
[0m06:07:03.796711 [debug] [MainThread]: Command end result
[0m06:07:03.820869 [info ] [MainThread]: 
[0m06:07:03.821473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:03.822016 [info ] [MainThread]: 
[0m06:07:03.822864 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:03.823940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.82782, "process_user_time": 4.658794, "process_kernel_time": 0.254207, "process_mem_max_rss": "295064", "process_in_blocks": "1184", "process_out_blocks": "94368"}
[0m06:07:03.824448 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:03.824351 after 294.83 seconds
[0m06:07:03.824905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36092ddac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3609009670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3608b41cd0>]}
[0m06:07:03.825336 [debug] [MainThread]: Flushing usage events
[0m06:07:05.700008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be776f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be7015460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be7015850>]}


============================== 06:07:05.703058 | 1522ab49-fcf5-4cca-b381-1d2bfda2068c ==============================
[0m06:07:05.703058 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:05.703768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:05.815581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1522ab49-fcf5-4cca-b381-1d2bfda2068c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be7e8c1a0>]}
[0m06:07:05.834851 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18542206, "process_user_time": 1.34074, "process_kernel_time": 0.104979, "process_mem_max_rss": "98772", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:05.835359 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:05.835260 after 0.19 seconds
[0m06:07:05.835844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5beb2d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be6c16180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5be7e8c1a0>]}
[0m06:07:05.836273 [debug] [MainThread]: Flushing usage events
[0m14:04:54.291838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a34c07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a306d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a306ff50>]}


============================== 14:04:54.310416 | 0165a51b-dbc4-4070-9d73-ef1953b5d750 ==============================
[0m14:04:54.310416 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:54.311075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:54.421010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0165a51b-dbc4-4070-9d73-ef1953b5d750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a3b927b0>]}
[0m14:04:54.436568 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7z67pa8w'
[0m14:04:54.437069 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:54.541256 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:54.541919 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:54.554574 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:54.558452 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:54.694119 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:54.694620 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:54.695181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0165a51b-dbc4-4070-9d73-ef1953b5d750', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a2931df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a2932180>]}
[0m14:04:54.695615 [info ] [MainThread]: 
[0m14:04:54.696119 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:54.711131 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46867907, "process_user_time": 1.559356, "process_kernel_time": 0.13303, "process_mem_max_rss": "99944", "process_in_blocks": "8368", "process_out_blocks": "5176"}
[0m14:04:54.711681 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:54.711582 after 0.47 seconds
[0m14:04:54.712128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a27e4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a2e7cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85a2ac21b0>]}
[0m14:04:54.712559 [debug] [MainThread]: Flushing usage events
[0m14:04:56.234454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3f656660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3f8c3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3ef9cda0>]}


============================== 14:04:56.237369 | 9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf ==============================
[0m14:04:56.237369 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:56.238074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:56.438816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3eaf8b00>]}
[0m14:04:56.497604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3fa79910>]}
[0m14:04:56.499979 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:04:56.532943 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:56.533627 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:56.534190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3f7ebfe0>]}
[0m14:04:57.816554 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:57.817201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3abc18e0>]}
[0m14:04:58.042430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:58.047569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3a9be180>]}
[0m14:04:58.135624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3a9a2060>]}
[0m14:04:58.136135 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:04:58.136620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3a9de9c0>]}
[0m14:04:58.138404 [info ] [MainThread]: 
[0m14:04:58.139146 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:58.143669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:58.177550 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:58.178012 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:58.178410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:58.558607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.560644 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:58.561999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:58.562724 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:58.570159 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:58.570596 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:58.571011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:58.572360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.573841 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:58.574251 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:58.574824 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.575225 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:58.575608 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:58.576214 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.577163 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:58.577568 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:58.578054 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:58.578603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.579044 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:58.580301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:58.585963 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:58.586373 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:58.586740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:58.587399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.587848 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:58.588243 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:58.602311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:58.603741 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:58.604974 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:58.605388 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:58.607531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3a9dafc0>]}
[0m14:04:58.608070 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.608463 [debug] [MainThread]: On master: BEGIN
[0m14:04:58.608869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:58.609463 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.609892 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.610272 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.610637 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.611195 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.611590 [debug] [MainThread]: On master: Close
[0m14:04:58.612151 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:58.612616 [info ] [MainThread]: 
[0m14:04:58.627750 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:58.628353 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:58.628942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:04:58.629392 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:58.657276 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:58.658041 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:58.693637 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:58.694384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:50.128764 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:50.129281 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:50.129945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.130418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:50.130878 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:50.131576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.134417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:50.134889 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:50.135751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.153908 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:50.154381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:50.154833 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:50.156031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.160935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:50.161397 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:09:50.162652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.164968 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:50.166464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f1009fec0>]}
[0m14:09:50.167158 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.54s]
[0m14:09:50.167934 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:50.168721 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:50.169389 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:50.170027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:50.170498 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:50.175561 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:50.176243 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:50.211183 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:50.211677 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250329140950205172"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:50.212170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:50.219807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.227145 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:50.227606 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:50.228260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.228703 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:50.229169 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250329140950205172'
      
      
      order by ordinal_position

  
[0m14:09:50.233444 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.239315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:50.239803 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:50.242136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.249628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:50.250120 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:50.252548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.270492 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:50.271156 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:50.271618 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250329140950205172"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250329140950205172"
    )
  
[0m14:09:50.326604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.328573 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:50.329045 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:50.329466 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:50.337311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:50.338193 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:50.339765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eaa7c7e-c472-4cf8-ac06-4744e66a0eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f313b5dc0>]}
[0m14:09:50.340456 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:50.341208 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:50.342694 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:50.343144 [debug] [MainThread]: On master: BEGIN
[0m14:09:50.343528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:50.344184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:50.344592 [debug] [MainThread]: On master: COMMIT
[0m14:09:50.345011 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:50.345384 [debug] [MainThread]: On master: COMMIT
[0m14:09:50.345937 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:50.346340 [debug] [MainThread]: On master: Close
[0m14:09:50.347007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:50.347391 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:50.347813 [info ] [MainThread]: 
[0m14:09:50.348306 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.21 seconds (292.21s).
[0m14:09:50.349313 [debug] [MainThread]: Command end result
[0m14:09:50.373496 [info ] [MainThread]: 
[0m14:09:50.374107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:50.374627 [info ] [MainThread]: 
[0m14:09:50.375178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:50.376144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.19138, "process_user_time": 4.60694, "process_kernel_time": 0.261882, "process_mem_max_rss": "293936", "process_in_blocks": "1184", "process_out_blocks": "94368"}
[0m14:09:50.376651 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:50.376554 after 294.19 seconds
[0m14:09:50.377114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3f657200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f3f655490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f07fda7e0>]}
[0m14:09:50.377539 [debug] [MainThread]: Flushing usage events
[0m14:09:52.192466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33383b5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3338d71670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3339492b10>]}


============================== 14:09:52.195510 | f63039f0-54d9-4538-9a71-4ea7ae4d676a ==============================
[0m14:09:52.195510 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:52.196182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:09:52.306324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f63039f0-54d9-4538-9a71-4ea7ae4d676a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3338768a10>]}
[0m14:09:52.325064 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18247432, "process_user_time": 1.322662, "process_kernel_time": 0.106972, "process_mem_max_rss": "98600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:52.325576 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:52.325477 after 0.18 seconds
[0m14:09:52.326043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333c8d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33381152b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333937f380>]}
[0m14:09:52.326477 [debug] [MainThread]: Flushing usage events
[0m22:05:27.780512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80562692b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80566c6de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80566c4c80>]}


============================== 22:05:27.799096 | 3c7a8afa-987d-4073-8155-d03517304b2f ==============================
[0m22:05:27.799096 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:27.799814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:27.910408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c7a8afa-987d-4073-8155-d03517304b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8057d3c260>]}
[0m22:05:27.926201 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zbdq4pe4'
[0m22:05:27.926675 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:27.967128 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:27.967784 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:27.985590 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:27.989394 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:28.193598 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:28.194256 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:28.194870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3c7a8afa-987d-4073-8155-d03517304b2f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8055dbf950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8055e1ffb0>]}
[0m22:05:28.195368 [info ] [MainThread]: 
[0m22:05:28.195923 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:28.202540 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47149575, "process_user_time": 1.61684, "process_kernel_time": 0.130744, "process_mem_max_rss": "99708", "process_in_blocks": "8392", "process_out_blocks": "5184"}
[0m22:05:28.203103 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:28.202997 after 0.47 seconds
[0m22:05:28.203537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80562640b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8056c505f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f805654afc0>]}
[0m22:05:28.204002 [debug] [MainThread]: Flushing usage events
[0m22:05:30.008152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbc2d2e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbc6bd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbc590bf0>]}


============================== 22:05:30.011137 | aa605fb2-d0d4-47fe-8f95-1d429f046715 ==============================
[0m22:05:30.011137 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:30.011818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:30.213091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbc06c470>]}
[0m22:05:30.272575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbc062990>]}
[0m22:05:30.275169 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:30.298232 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:30.298960 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:30.299494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbc0bfa10>]}
[0m22:05:31.575976 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:31.576610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb81d2120>]}
[0m22:05:31.806550 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:31.811789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb7fda9c0>]}
[0m22:05:31.930849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb7fa4110>]}
[0m22:05:31.931443 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:31.931954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb7fec7a0>]}
[0m22:05:31.933828 [info ] [MainThread]: 
[0m22:05:31.934539 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:31.939338 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:31.974359 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:31.974869 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:31.975277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:32.366893 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.368473 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:32.369505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:32.370086 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:32.377507 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:32.377957 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:32.378349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:32.379450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.380885 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:32.381294 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:32.381877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.382279 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:32.382660 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:32.383299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.384237 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:32.384643 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:32.385054 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:32.385587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.386018 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:32.387231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:32.393004 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:32.393420 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:32.393820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:32.394443 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.394873 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:32.395268 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:32.409481 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:32.410987 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:32.412217 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:32.412626 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:32.414811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb7df11f0>]}
[0m22:05:32.415330 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:32.415733 [debug] [MainThread]: On master: BEGIN
[0m22:05:32.416132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:32.416729 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:32.417166 [debug] [MainThread]: On master: COMMIT
[0m22:05:32.417552 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:32.417949 [debug] [MainThread]: On master: COMMIT
[0m22:05:32.418501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:32.418944 [debug] [MainThread]: On master: Close
[0m22:05:32.419472 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:32.419983 [info ] [MainThread]: 
[0m22:05:32.439974 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:32.440561 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:32.441148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:32.441592 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:32.469722 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:32.470500 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:32.506543 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:32.507310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:28.799650 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:28.800171 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:28.800819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.801264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:28.801685 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:28.802432 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.805257 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:28.805708 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:28.806391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.822839 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:28.823305 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:28.823736 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:28.824960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.829857 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:28.830319 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:28.831572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.833906 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:28.835398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbdf6ccb0>]}
[0m22:10:28.836093 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 296.39s]
[0m22:10:28.836937 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:28.837789 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:28.838427 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:28.839138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:28.839584 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:28.844419 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:28.845073 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:28.879743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:28.880251 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250329221028873787"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:28.880706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:28.888430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.895770 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:28.896240 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:28.896893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.897336 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:28.897776 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250329221028873787'
      
      
      order by ordinal_position

  
[0m22:10:28.902198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.908223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:28.908700 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:28.911064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.918468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:28.918948 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:28.921354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.939355 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:28.940104 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:28.940595 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250329221028873787"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250329221028873787"
    )
  
[0m22:10:28.994091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:28.996066 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:28.996519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:28.996960 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:29.004626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:29.005525 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:29.007178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa605fb2-d0d4-47fe-8f95-1d429f046715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8c0d4260>]}
[0m22:10:29.007867 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:29.008593 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:29.009883 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:29.010303 [debug] [MainThread]: On master: BEGIN
[0m22:10:29.010692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:29.011353 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:29.011776 [debug] [MainThread]: On master: COMMIT
[0m22:10:29.012170 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:29.012547 [debug] [MainThread]: On master: COMMIT
[0m22:10:29.013139 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:29.013532 [debug] [MainThread]: On master: Close
[0m22:10:29.014184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:29.014554 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:29.014986 [info ] [MainThread]: 
[0m22:10:29.015446 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 57.08 seconds (297.08s).
[0m22:10:29.016363 [debug] [MainThread]: Command end result
[0m22:10:29.040409 [info ] [MainThread]: 
[0m22:10:29.040969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:29.041413 [info ] [MainThread]: 
[0m22:10:29.041898 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:29.042799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 299.08487, "process_user_time": 5.020892, "process_kernel_time": 0.262203, "process_mem_max_rss": "307552", "process_in_blocks": "1184", "process_out_blocks": "94400"}
[0m22:10:29.043313 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:29.043217 after 299.09 seconds
[0m22:10:29.043740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbc6bd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbcb208f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cbc1b5c10>]}
[0m22:10:29.044181 [debug] [MainThread]: Flushing usage events
[0m22:10:31.127750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d54e0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d3254680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d5b08290>]}


============================== 22:10:31.130693 | eebdecbc-c42d-4e11-a30e-90b22e0d269c ==============================
[0m22:10:31.130693 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:31.131402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:31.243526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eebdecbc-c42d-4e11-a30e-90b22e0d269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d40d0920>]}
[0m22:10:31.262695 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18476556, "process_user_time": 1.329669, "process_kernel_time": 0.11988, "process_mem_max_rss": "98848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:31.263237 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:31.263139 after 0.19 seconds
[0m22:10:31.263675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d7563da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d39f63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d3140980>]}
[0m22:10:31.264130 [debug] [MainThread]: Flushing usage events
[0m06:02:08.174654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a315cee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a30c5e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a315cd130>]}


============================== 06:02:08.200715 | 21c47495-620a-4924-b479-d9806b4c75ce ==============================
[0m06:02:08.200715 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.201517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.317471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21c47495-620a-4924-b479-d9806b4c75ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3093bfb0>]}
[0m06:02:08.335051 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yg7sigw5'
[0m06:02:08.335584 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:08.419610 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:08.420470 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:08.433435 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:08.437607 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:08.496589 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:08.497295 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:08.497951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21c47495-620a-4924-b479-d9806b4c75ce', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a30973ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a30f0c560>]}
[0m06:02:08.498448 [info ] [MainThread]: 
[0m06:02:08.499012 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:08.595884 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4780223, "process_user_time": 1.773344, "process_kernel_time": 0.117553, "process_mem_max_rss": "99588", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m06:02:08.596921 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:08.596728 after 0.48 seconds
[0m06:02:08.597543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a31eff2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a30b10ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a3086bc50>]}
[0m06:02:08.598061 [debug] [MainThread]: Flushing usage events
[0m06:02:10.462841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b62569f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b6810260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b7734c20>]}


============================== 06:02:10.466031 | cd865104-df00-47d0-8dd0-8da7ed6e8044 ==============================
[0m06:02:10.466031 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.466687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.675929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b7565df0>]}
[0m06:02:10.737067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b5841520>]}
[0m06:02:10.739771 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:10.761724 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:10.762551 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:10.763153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b56be8d0>]}
[0m06:02:12.069003 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:12.069730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b17645f0>]}
[0m06:02:12.326205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:12.331992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b58e4d70>]}
[0m06:02:12.436645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b1541e80>]}
[0m06:02:12.437298 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:12.437843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b1512e10>]}
[0m06:02:12.439838 [info ] [MainThread]: 
[0m06:02:12.440588 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:12.445560 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:12.481819 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:12.482362 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:12.482777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.848957 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.850660 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.851694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.852320 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.860319 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.860839 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.861255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.862475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.864168 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.864584 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.865213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.865647 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.866132 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.866808 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.867842 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.868251 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.868642 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.869266 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.869717 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.871111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.877108 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.877530 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.877952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.878642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.879078 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.879481 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.893855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.895593 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.896909 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.897328 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.899687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b759bbf0>]}
[0m06:02:12.900263 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.900662 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.901071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.901851 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.902275 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.902656 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.903058 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.903640 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.904087 [debug] [MainThread]: On master: Close
[0m06:02:12.904664 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.905163 [info ] [MainThread]: 
[0m06:02:12.924945 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.925629 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.926287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:12.926734 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.955617 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.956557 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.993852 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.994804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:03.810968 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.811494 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:03.812193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.812636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.813085 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:03.813829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.816761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.817237 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:03.817926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.834359 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:03.834870 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.835305 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:03.836764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.841785 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:03.842287 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:03.843760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.846120 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:03.847639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b75650d0>]}
[0m06:07:03.848333 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 290.92s]
[0m06:07:03.849194 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:03.850022 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:03.850741 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:03.851453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:03.851932 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:03.857016 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:03.857702 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:03.893378 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.893977 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250330060703887209"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:03.894457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:03.903383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.911554 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.912089 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:03.912857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.913299 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.913727 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250330060703887209'
      
      
      order by ordinal_position

  
[0m06:07:03.918534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.925513 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.926239 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:03.928976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.937139 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.937634 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:03.940309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:03.959035 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:03.959889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:03.960364 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250330060703887209"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250330060703887209"
    )
  
[0m06:07:04.015282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:04.017274 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:04.017730 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:04.018172 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:04.026354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:04.027375 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:04.028828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd865104-df00-47d0-8dd0-8da7ed6e8044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2278bd44d0>]}
[0m06:07:04.029499 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:07:04.030259 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:04.031636 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:04.032092 [debug] [MainThread]: On master: BEGIN
[0m06:07:04.032474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:04.033221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:04.033634 [debug] [MainThread]: On master: COMMIT
[0m06:07:04.034058 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:04.034430 [debug] [MainThread]: On master: COMMIT
[0m06:07:04.035008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:04.035413 [debug] [MainThread]: On master: Close
[0m06:07:04.036051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:04.036429 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:04.036859 [info ] [MainThread]: 
[0m06:07:04.037339 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 51.60 seconds (291.60s).
[0m06:07:04.038255 [debug] [MainThread]: Command end result
[0m06:07:04.063881 [info ] [MainThread]: 
[0m06:07:04.064517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:04.065024 [info ] [MainThread]: 
[0m06:07:04.065486 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:04.066470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 293.65515, "process_user_time": 5.225158, "process_kernel_time": 0.294685, "process_mem_max_rss": "301104", "process_in_blocks": "1184", "process_out_blocks": "94368"}
[0m06:07:04.067029 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:04.066916 after 293.66 seconds
[0m06:07:04.067481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b58be4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2288de8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b5cae7e0>]}
[0m06:07:04.067931 [debug] [MainThread]: Flushing usage events
[0m06:07:06.053525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa005fe61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0025ac5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0025ac290>]}


============================== 06:07:06.056687 | 753814ff-d4c9-46cb-a75e-94eeb4a4e281 ==============================
[0m06:07:06.056687 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:06.057411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:07:06.169632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '753814ff-d4c9-46cb-a75e-94eeb4a4e281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa00244d9a0>]}
[0m06:07:06.189513 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18642023, "process_user_time": 1.372232, "process_kernel_time": 0.104941, "process_mem_max_rss": "98892", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:06.190116 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:06.190011 after 0.19 seconds
[0m06:07:06.190562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa003023980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa002622840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa006bbbda0>]}
[0m06:07:06.191042 [debug] [MainThread]: Flushing usage events
[0m14:04:56.624807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab1ad3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab1ad0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab2dfda00>]}


============================== 14:04:56.632913 | 6e067ef4-2c87-489c-99c1-e81f2327b8de ==============================
[0m14:04:56.632913 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:56.633597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:56.740867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e067ef4-2c87-489c-99c1-e81f2327b8de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab191cbc0>]}
[0m14:04:56.755797 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3jkxfp3a'
[0m14:04:56.756260 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:56.817539 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:56.818188 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:56.830739 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:56.834681 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:56.966891 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:56.967459 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:56.968014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6e067ef4-2c87-489c-99c1-e81f2327b8de', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab22029c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab1603ef0>]}
[0m14:04:56.968471 [info ] [MainThread]: 
[0m14:04:56.968962 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:56.970890 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.39446127, "process_user_time": 1.545524, "process_kernel_time": 0.123201, "process_mem_max_rss": "99928", "process_in_blocks": "8392", "process_out_blocks": "5184"}
[0m14:04:56.971428 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:56.971328 after 0.40 seconds
[0m14:04:56.971864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab5ed3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab18babd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab1702f30>]}
[0m14:04:56.972323 [debug] [MainThread]: Flushing usage events
[0m14:04:58.587680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d8533c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d88b9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d8ef4c80>]}


============================== 14:04:58.590609 | 25145e4d-9a61-4f72-ad71-bce1cc4e1c2f ==============================
[0m14:04:58.590609 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:58.591320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:04:58.805033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d7f68950>]}
[0m14:04:58.869345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d8cb3dd0>]}
[0m14:04:58.871859 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:04:58.937820 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:58.938552 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:58.939104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d3b81e20>]}
[0m14:05:00.298852 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:00.299551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d3ac89e0>]}
[0m14:05:00.522667 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:00.527905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d38d9730>]}
[0m14:05:00.610042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d383b6e0>]}
[0m14:05:00.610569 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:00.611105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d389cb90>]}
[0m14:05:00.612860 [info ] [MainThread]: 
[0m14:05:00.613588 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:00.618222 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:00.652389 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:00.652839 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:00.653260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:01.050782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.052373 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:01.053403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:01.054033 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:01.061797 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:01.062247 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:01.062635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:01.063565 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.064978 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:01.065400 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:01.065979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.066402 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:01.066783 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:01.067390 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.068317 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:01.068719 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:01.069119 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:01.069692 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.070121 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:01.071327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:01.076940 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:01.077372 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:01.077752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:01.078375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.078768 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:01.079178 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:01.093349 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:01.094799 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:01.096048 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:01.096479 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:01.098637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d389fa70>]}
[0m14:05:01.099186 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.099575 [debug] [MainThread]: On master: BEGIN
[0m14:05:01.099938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:01.100565 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:01.100966 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.101386 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.101752 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.102316 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:01.102707 [debug] [MainThread]: On master: Close
[0m14:05:01.103251 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:01.103762 [info ] [MainThread]: 
[0m14:05:01.113590 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:01.114203 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:01.114846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:01.115329 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:01.143170 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:01.143917 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:01.179389 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:01.180142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:53.693058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:53.693548 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:09:53.694181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.694619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:53.695062 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:09:53.695765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.698605 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:53.699070 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:09:53.699756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.716047 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:53.716516 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:53.716942 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:09:53.719732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.724615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:09:53.725096 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:09:53.726842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.729118 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:09:53.730616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a8230f50>]}
[0m14:09:53.731304 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.61s]
[0m14:09:53.732136 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:09:53.733083 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:09:53.733622 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:09:53.734268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:09:53.734716 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:09:53.739607 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:09:53.740273 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:09:53.775082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:53.775599 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250330140953769130"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:09:53.776077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:53.784391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.791810 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:53.792283 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:09:53.792893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.793359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:53.793790 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250330140953769130'
      
      
      order by ordinal_position

  
[0m14:09:53.798115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.804131 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:53.804615 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:53.806934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.814357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:53.814819 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:09:53.818081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.835864 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:09:53.836562 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:53.837045 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250330140953769130"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250330140953769130"
    )
  
[0m14:09:53.889293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.891242 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:53.891691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:09:53.892132 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:09:53.900927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:09:53.901816 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:09:53.903272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25145e4d-9a61-4f72-ad71-bce1cc4e1c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a8289550>]}
[0m14:09:53.903945 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:09:53.904763 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:09:53.906063 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:53.906489 [debug] [MainThread]: On master: BEGIN
[0m14:09:53.906875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:53.907557 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:53.907960 [debug] [MainThread]: On master: COMMIT
[0m14:09:53.908370 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:53.908753 [debug] [MainThread]: On master: COMMIT
[0m14:09:53.909313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:09:53.909705 [debug] [MainThread]: On master: Close
[0m14:09:53.910357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:53.910732 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:09:53.911169 [info ] [MainThread]: 
[0m14:09:53.911636 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.30 seconds (293.30s).
[0m14:09:53.912536 [debug] [MainThread]: Command end result
[0m14:09:53.936946 [info ] [MainThread]: 
[0m14:09:53.937523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:53.937975 [info ] [MainThread]: 
[0m14:09:53.938467 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:09:53.939387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.40106, "process_user_time": 4.712381, "process_kernel_time": 0.28684, "process_mem_max_rss": "297092", "process_in_blocks": "1192", "process_out_blocks": "94376"}
[0m14:09:53.939892 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:53.939796 after 295.40 seconds
[0m14:09:53.940360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d8ef4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d7e1ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d8cb2db0>]}
[0m14:09:53.940788 [debug] [MainThread]: Flushing usage events
[0m14:09:56.183262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec7b61340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec853e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec98074d0>]}


============================== 14:09:56.186188 | f4fa23dc-cb15-4ccf-9296-f3d67e4cad56 ==============================
[0m14:09:56.186188 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:09:56.186869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:56.296602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4fa23dc-cb15-4ccf-9296-f3d67e4cad56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec9475d60>]}
[0m14:09:56.315782 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18170665, "process_user_time": 1.329051, "process_kernel_time": 0.105083, "process_mem_max_rss": "98856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:56.316329 [debug] [MainThread]: Command `dbt clean` succeeded at 14:09:56.316229 after 0.18 seconds
[0m14:09:56.316759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecbcd3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec76f28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ec7b61670>]}
[0m14:09:56.317216 [debug] [MainThread]: Flushing usage events
[0m22:05:23.205222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98409c2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984112c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9840958bf0>]}


============================== 22:05:23.213487 | f6255b42-a376-4545-b5cf-56a7e8da6fdf ==============================
[0m22:05:23.213487 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:23.214195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:23.324425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6255b42-a376-4545-b5cf-56a7e8da6fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9840958bf0>]}
[0m22:05:23.340964 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xaulh5f7'
[0m22:05:23.341497 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:23.472403 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:23.473230 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:23.497300 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:23.501454 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:23.636475 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:23.637134 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:23.637732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f6255b42-a376-4545-b5cf-56a7e8da6fdf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984055f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984055e3c0>]}
[0m22:05:23.638241 [info ] [MainThread]: 
[0m22:05:23.638774 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:23.644833 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48958915, "process_user_time": 1.575163, "process_kernel_time": 0.146386, "process_mem_max_rss": "99796", "process_in_blocks": "8392", "process_out_blocks": "5184"}
[0m22:05:23.645378 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:23.645279 after 0.49 seconds
[0m22:05:23.645814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98407bb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98405579b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9840535340>]}
[0m22:05:23.646258 [debug] [MainThread]: Flushing usage events
[0m22:05:25.292692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e9196e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e90f8c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e91933b30>]}


============================== 22:05:25.295756 | b867f501-e565-42b1-9157-2ad76d234f31 ==============================
[0m22:05:25.295756 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.296476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:25.498991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e8cf1e510>]}
[0m22:05:25.558463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e92c8f950>]}
[0m22:05:25.561070 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:25.578351 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:25.579136 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:25.579669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e90d8c470>]}
[0m22:05:26.875084 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:26.875746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e8ceb0f80>]}
[0m22:05:27.116245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:27.121821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e90f51490>]}
[0m22:05:27.208059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e8cc71a00>]}
[0m22:05:27.208633 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:27.209165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e8cd61ac0>]}
[0m22:05:27.211030 [info ] [MainThread]: 
[0m22:05:27.211764 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:27.216597 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:27.252027 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:27.252555 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:27.253007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:27.862063 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:27.863897 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:27.865148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:27.865768 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:27.874013 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.874447 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:27.874842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:27.875923 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.877327 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.877734 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:27.878353 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.878749 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.879158 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:27.879746 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.880702 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:27.881124 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.881501 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:27.882059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.882467 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:27.883665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:27.889383 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:27.889802 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:27.890209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:27.890831 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.891252 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:27.891641 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:27.906273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.907746 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:27.908986 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:27.909411 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:27.911659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e92c8fc20>]}
[0m22:05:27.912208 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:27.912620 [debug] [MainThread]: On master: BEGIN
[0m22:05:27.913028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:27.913657 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:27.914091 [debug] [MainThread]: On master: COMMIT
[0m22:05:27.914478 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:27.914851 [debug] [MainThread]: On master: COMMIT
[0m22:05:27.915432 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:27.915832 [debug] [MainThread]: On master: Close
[0m22:05:27.916405 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:27.916945 [info ] [MainThread]: 
[0m22:05:27.926816 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:27.927456 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:27.928116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:27.928574 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:27.956739 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:27.957530 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:27.993655 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:27.994451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:22.277722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:22.278293 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:22.279002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.279451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:22.279894 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:22.280653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.283755 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:22.284230 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:22.284954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.301646 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:22.302189 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:22.302629 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:22.304218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.309457 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:22.309946 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:22.311251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.313791 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:22.315441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e8ccc9820>]}
[0m22:10:22.316169 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 294.39s]
[0m22:10:22.317028 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:22.317845 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:22.318586 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:22.319289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:22.319741 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:22.324996 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:22.325667 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:22.361307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:22.361854 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250330221022355210"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:22.362337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:22.370845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.378735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:22.379237 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:22.379916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.380363 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:22.380791 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250330221022355210'
      
      
      order by ordinal_position

  
[0m22:10:22.385465 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.391827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:22.392326 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:22.394679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.402272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:22.402748 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:22.405372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.423410 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:22.424165 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:22.424633 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250330221022355210"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250330221022355210"
    )
  
[0m22:10:22.475529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.478379 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:22.479037 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:22.479674 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:22.488333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:22.489375 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:22.491017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b867f501-e565-42b1-9157-2ad76d234f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e78185940>]}
[0m22:10:22.491737 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:22.492522 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:22.493933 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:22.494374 [debug] [MainThread]: On master: BEGIN
[0m22:10:22.494763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:22.495541 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:22.495979 [debug] [MainThread]: On master: COMMIT
[0m22:10:22.496369 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:22.496746 [debug] [MainThread]: On master: COMMIT
[0m22:10:22.497367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:22.497786 [debug] [MainThread]: On master: Close
[0m22:10:22.498496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:22.498906 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:22.499346 [info ] [MainThread]: 
[0m22:10:22.499827 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 55.29 seconds (295.29s).
[0m22:10:22.500767 [debug] [MainThread]: Command end result
[0m22:10:22.525986 [info ] [MainThread]: 
[0m22:10:22.526625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:22.527107 [info ] [MainThread]: 
[0m22:10:22.527584 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:22.528556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 297.2856, "process_user_time": 5.288677, "process_kernel_time": 0.275774, "process_mem_max_rss": "307872", "process_in_blocks": "1184", "process_out_blocks": "94400"}
[0m22:10:22.529105 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:22.529003 after 297.29 seconds
[0m22:10:22.529550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e954d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e92ba8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e700ec4a0>]}
[0m22:10:22.530021 [debug] [MainThread]: Flushing usage events
[0m22:10:24.411966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dda48f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dda48d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82de82edb0>]}


============================== 22:10:24.415063 | f1e5af69-9414-4e9b-abc5-cd7497e338c0 ==============================
[0m22:10:24.415063 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:24.415720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:24.528607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1e5af69-9414-4e9b-abc5-cd7497e338c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ddfeeea0>]}
[0m22:10:24.548329 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18641901, "process_user_time": 1.348703, "process_kernel_time": 0.106897, "process_mem_max_rss": "98724", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:24.548858 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:24.548755 after 0.19 seconds
[0m22:10:24.549349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ddbf7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ddac9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dda03440>]}
[0m22:10:24.549779 [debug] [MainThread]: Flushing usage events
[0m06:02:06.403623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79a056db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb799fa98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb799c0e000>]}


============================== 06:02:06.419281 | 3aa38e92-1630-4864-9d67-d582872050da ==============================
[0m06:02:06.419281 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.419982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.531027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aa38e92-1630-4864-9d67-d582872050da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb799ba2cc0>]}
[0m06:02:06.546560 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y9m1qc9u'
[0m06:02:06.547041 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:06.667128 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:06.667791 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.691783 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.695566 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.792019 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.792587 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:06.793136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3aa38e92-1630-4864-9d67-d582872050da', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb799a84f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79994a6f0>]}
[0m06:02:06.793608 [info ] [MainThread]: 
[0m06:02:06.794123 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:06.799804 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.445198, "process_user_time": 1.597582, "process_kernel_time": 0.128207, "process_mem_max_rss": "99484", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m06:02:06.800336 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.800234 after 0.45 seconds
[0m06:02:06.800765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79e1bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb799d767b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79aa69b80>]}
[0m06:02:06.801186 [debug] [MainThread]: Flushing usage events
[0m06:02:08.334517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b6c3c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b620a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b62089e0>]}


============================== 06:02:08.337518 | 9afa79cf-95cf-4022-996a-6fa1b77011d1 ==============================
[0m06:02:08.337518 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.338222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.537488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b5c34170>]}
[0m06:02:08.595772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b6f17110>]}
[0m06:02:08.598165 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:08.631637 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.632355 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.632900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b63bbfe0>]}
[0m06:02:09.907721 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:09.908377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b1b3bf20>]}
[0m06:02:10.130951 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:10.136221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b1bec5c0>]}
[0m06:02:10.222507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b1b813a0>]}
[0m06:02:10.223000 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:10.223556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b1b6ac60>]}
[0m06:02:10.225346 [info ] [MainThread]: 
[0m06:02:10.226043 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:10.230654 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:10.264320 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:10.264766 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:10.265165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.631380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.634004 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.635479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.636303 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.643554 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.643990 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.644413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.645778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.647209 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.647626 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.648222 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.648631 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.649007 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.649625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.650577 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.650981 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.651397 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.651937 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.652363 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.653561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.659232 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.659656 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.660035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.660644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.661044 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.661465 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.674763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.676220 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.677443 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.677850 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.680210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b1b682c0>]}
[0m06:02:10.680714 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.681104 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.681497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.682084 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.682506 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.682877 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.683262 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.683784 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.684172 [debug] [MainThread]: On master: Close
[0m06:02:10.684711 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.685239 [info ] [MainThread]: 
[0m06:02:10.698845 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.699434 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.700033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:10.700497 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.727909 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.728653 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.763684 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.764417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:00.816318 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.816822 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:00.817456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.817900 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.818345 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:00.819028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.821838 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.822300 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:00.822974 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.840385 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:00.841023 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.841742 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:00.843077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.847990 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.848473 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:00.849607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.851917 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:00.853414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0288dc1a90>]}
[0m06:07:00.854090 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 290.15s]
[0m06:07:00.854855 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:00.855792 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:00.856373 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:00.856975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:00.857441 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:00.862306 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:00.862932 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:00.897369 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.897864 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250331060700891442"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:00.898354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:00.906053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.913212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.913673 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:00.914309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.914758 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.915202 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250331060700891442'
      
      
      order by ordinal_position

  
[0m06:07:00.919490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.925335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.925819 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:00.928914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.936339 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.936805 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:00.939751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.957437 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:00.958081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.958563 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250331060700891442"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250331060700891442"
    )
  
[0m06:07:01.013906 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.015895 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:01.016358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:01.016778 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:01.024590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:01.025482 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:01.027104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afa79cf-95cf-4022-996a-6fa1b77011d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028829af30>]}
[0m06:07:01.027799 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:01.028544 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:01.029806 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:01.030264 [debug] [MainThread]: On master: BEGIN
[0m06:07:01.030656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:01.031305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:01.031712 [debug] [MainThread]: On master: COMMIT
[0m06:07:01.032087 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:01.032482 [debug] [MainThread]: On master: COMMIT
[0m06:07:01.033008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:01.033442 [debug] [MainThread]: On master: Close
[0m06:07:01.034031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:01.034474 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:01.034878 [info ] [MainThread]: 
[0m06:07:01.035410 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 50.81 seconds (290.81s).
[0m06:07:01.036393 [debug] [MainThread]: Command end result
[0m06:07:01.060225 [info ] [MainThread]: 
[0m06:07:01.060824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:01.061362 [info ] [MainThread]: 
[0m06:07:01.061889 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:01.062870 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 292.77783, "process_user_time": 4.591296, "process_kernel_time": 0.248232, "process_mem_max_rss": "295904", "process_in_blocks": "1184", "process_out_blocks": "94368"}
[0m06:07:01.063420 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:01.063317 after 292.78 seconds
[0m06:07:01.063848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ba396d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b1bfaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02b620a030>]}
[0m06:07:01.064306 [debug] [MainThread]: Flushing usage events
[0m06:07:02.792452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a3d33b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a3fc54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a4492b10>]}


============================== 06:07:02.795373 | cafe2bdc-a371-47b2-80c6-9c49a79ca217 ==============================
[0m06:07:02.795373 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:02.796018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:02.905538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cafe2bdc-a371-47b2-80c6-9c49a79ca217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a31041d0>]}
[0m06:07:02.924586 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18134859, "process_user_time": 1.330728, "process_kernel_time": 0.098979, "process_mem_max_rss": "98856", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:02.925090 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:02.924990 after 0.18 seconds
[0m06:07:02.925556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a3d32720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a31041d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a5eb8620>]}
[0m06:07:02.925987 [debug] [MainThread]: Flushing usage events
[0m14:05:33.185184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbae5a3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbae157dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbae157a40>]}


============================== 14:05:33.193912 | 28ae9ed7-85d2-4313-99d2-22b1e31feaf5 ==============================
[0m14:05:33.193912 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.194711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.307260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28ae9ed7-85d2-4313-99d2-22b1e31feaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbae154320>]}
[0m14:05:33.324639 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-uz2idh_d'
[0m14:05:33.325182 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:33.448661 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:33.449524 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:33.464103 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:33.468244 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:33.611846 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:33.612560 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:33.613220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '28ae9ed7-85d2-4313-99d2-22b1e31feaf5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbae011a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbae013cb0>]}
[0m14:05:33.613764 [info ] [MainThread]: 
[0m14:05:33.614312 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:33.616074 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4823387, "process_user_time": 1.665265, "process_kernel_time": 0.126247, "process_mem_max_rss": "99552", "process_in_blocks": "8392", "process_out_blocks": "5176"}
[0m14:05:33.616673 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:33.616558 after 0.48 seconds
[0m14:05:33.617130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbae5a3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbae51b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbae157d40>]}
[0m14:05:33.617630 [debug] [MainThread]: Flushing usage events
[0m14:05:35.428488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891063bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89121f54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8910f73d70>]}


============================== 14:05:35.431731 | cef573c6-ab73-4f4f-9e1e-0eef3817940f ==============================
[0m14:05:35.431731 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:35.432516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.653746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8910408290>]}
[0m14:05:35.716458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89116915b0>]}
[0m14:05:35.720115 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:35.810422 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:35.811633 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:35.812418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c5953a0>]}
[0m14:05:37.145175 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:37.145917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c2b0290>]}
[0m14:05:37.398799 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:37.404561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8910397500>]}
[0m14:05:37.505794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c231730>]}
[0m14:05:37.506416 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:37.506950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c26a360>]}
[0m14:05:37.508913 [info ] [MainThread]: 
[0m14:05:37.509683 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:37.514567 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:37.550547 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:37.551083 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:37.551515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:38.016776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:38.018502 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:38.019559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:38.020130 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:38.028222 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:38.028766 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:38.029183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:38.030539 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:38.032117 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:38.032579 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:38.033230 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:38.033710 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:38.034162 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:38.034856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:38.035935 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:38.036398 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:38.036857 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:38.037542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:38.038004 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:38.039435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:38.045524 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:38.045957 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:38.046350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:38.047123 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:38.047563 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:38.047963 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:38.062775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:38.064513 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:38.065781 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:38.066198 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:38.068655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c2d9ca0>]}
[0m14:05:38.069196 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:38.069632 [debug] [MainThread]: On master: BEGIN
[0m14:05:38.070010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:38.070782 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:38.071194 [debug] [MainThread]: On master: COMMIT
[0m14:05:38.071610 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:38.071987 [debug] [MainThread]: On master: COMMIT
[0m14:05:38.072553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:38.072963 [debug] [MainThread]: On master: Close
[0m14:05:38.073520 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:38.074046 [info ] [MainThread]: 
[0m14:05:38.084291 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:38.084991 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:38.085723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:38.086182 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:38.115273 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:38.116249 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:38.153304 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:38.154271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:30.520052 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.520653 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:30.521543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.522011 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.522504 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:30.523316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.526583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.527043 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:30.527840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.545189 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:30.545788 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.546231 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:30.548050 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.553530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:30.554045 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:30.556123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.558606 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:30.560170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8912274b30>]}
[0m14:10:30.560899 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.47s]
[0m14:10:30.561697 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:30.562650 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:30.563229 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:30.563978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:30.564472 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:30.569820 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:30.570543 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:30.606853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.607470 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250331141030600545"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:30.607946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:30.616381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.624694 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.625241 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:30.626036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.626506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.626943 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250331141030600545'
      
      
      order by ordinal_position

  
[0m14:10:30.631932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.639078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.639673 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:30.642646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.651306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.651928 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:30.655057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.674200 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:30.675053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.675562 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250331141030600545"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250331141030600545"
    )
  
[0m14:10:30.726642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.728669 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:30.729132 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:30.729576 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:30.737094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:30.738082 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:30.739658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cef573c6-ab73-4f4f-9e1e-0eef3817940f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ed9f1a00>]}
[0m14:10:30.740374 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m14:10:30.741201 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:30.742547 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:30.742984 [debug] [MainThread]: On master: BEGIN
[0m14:10:30.743447 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:30.744239 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:30.744692 [debug] [MainThread]: On master: COMMIT
[0m14:10:30.745085 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:30.745522 [debug] [MainThread]: On master: COMMIT
[0m14:10:30.746081 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:30.746530 [debug] [MainThread]: On master: Close
[0m14:10:30.747146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:30.747599 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:30.748019 [info ] [MainThread]: 
[0m14:10:30.748516 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.24 seconds (293.24s).
[0m14:10:30.749460 [debug] [MainThread]: Command end result
[0m14:10:30.774870 [info ] [MainThread]: 
[0m14:10:30.775602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:30.776090 [info ] [MainThread]: 
[0m14:10:30.776600 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:30.777607 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.40808, "process_user_time": 5.398641, "process_kernel_time": 0.28898, "process_mem_max_rss": "302424", "process_in_blocks": "1192", "process_out_blocks": "94376"}
[0m14:10:30.778142 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:30.778042 after 295.41 seconds
[0m14:10:30.778639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8910b1dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8910955970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8910ad6c00>]}
[0m14:10:30.779086 [debug] [MainThread]: Flushing usage events
[0m14:10:32.826810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109684dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10971cc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f109506bbf0>]}


============================== 14:10:32.830072 | a68bde30-bfd3-420c-846a-34689f9f2a1b ==============================
[0m14:10:32.830072 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:32.830767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:10:32.944594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a68bde30-bfd3-420c-846a-34689f9f2a1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1094622150>]}
[0m14:10:32.965082 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1890374, "process_user_time": 1.412557, "process_kernel_time": 0.116963, "process_mem_max_rss": "98592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:32.965662 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:32.965556 after 0.19 seconds
[0m14:10:32.966114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1094ba6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10949259a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1094623440>]}
[0m14:10:32.966592 [debug] [MainThread]: Flushing usage events
[0m22:06:23.580597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bf710470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bf933a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bf931760>]}


============================== 22:06:23.596403 | d254a96e-a71a-4456-9547-56bb3228636b ==============================
[0m22:06:23.596403 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:23.597078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:06:23.706922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd254a96e-a71a-4456-9547-56bb3228636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bf377bf0>]}
[0m22:06:23.722276 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cevm4ll0'
[0m22:06:23.722748 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:23.805927 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:23.806655 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:23.867417 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:23.871198 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:24.202369 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:24.202945 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:24.203477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd254a96e-a71a-4456-9547-56bb3228636b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bf5594f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c06f1d00>]}
[0m22:06:24.203976 [info ] [MainThread]: 
[0m22:06:24.204458 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:24.209714 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.67913306, "process_user_time": 1.594604, "process_kernel_time": 0.140086, "process_mem_max_rss": "99860", "process_in_blocks": "8400", "process_out_blocks": "5192"}
[0m22:06:24.210236 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:24.210135 after 0.68 seconds
[0m22:06:24.210687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c033ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bfe3f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bf375ee0>]}
[0m22:06:24.211115 [debug] [MainThread]: Flushing usage events
[0m22:06:25.950882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9ac56b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9ac57e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9ac558e0>]}


============================== 22:06:25.953837 | 5b18735f-eefb-43bf-9bc9-c9ab091ca8fc ==============================
[0m22:06:25.953837 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:25.954486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.157610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9a0ce5a0>]}
[0m22:06:26.216580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9a100980>]}
[0m22:06:26.218993 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:06:26.238309 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:26.239035 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:26.239585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9a0ccf80>]}
[0m22:06:27.520602 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:27.521251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e96053d40>]}
[0m22:06:27.749544 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:27.754684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9d026300>]}
[0m22:06:27.854207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e95f43bc0>]}
[0m22:06:27.854724 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:06:27.855214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e95f786b0>]}
[0m22:06:27.856997 [info ] [MainThread]: 
[0m22:06:27.857681 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:27.862288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:27.896238 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:27.896712 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:27.897115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:28.531841 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:28.533426 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:28.534489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:28.535277 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:28.543122 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.543571 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:28.543972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:28.544909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.546319 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.546747 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:28.547310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.547731 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.548116 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:28.548744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.549693 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:28.550096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:28.550468 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:28.551036 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.551443 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:28.552688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:28.558334 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:28.558773 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:28.559146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:28.559770 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.560179 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:28.560595 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:28.574570 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:28.576001 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:28.577208 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:28.577637 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:28.579818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9490e690>]}
[0m22:06:28.580331 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:28.580751 [debug] [MainThread]: On master: BEGIN
[0m22:06:28.581127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:28.581752 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:28.582163 [debug] [MainThread]: On master: COMMIT
[0m22:06:28.582581 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:28.582958 [debug] [MainThread]: On master: COMMIT
[0m22:06:28.583533 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:28.583946 [debug] [MainThread]: On master: Close
[0m22:06:28.584475 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:28.584974 [info ] [MainThread]: 
[0m22:06:28.599476 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:28.600101 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:28.600691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:28.601133 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:28.629053 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:28.629817 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:28.665961 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:28.666724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:22.414384 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:22.414905 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:11:22.415581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.416027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:22.416453 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:11:22.417179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.420003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:22.420452 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:11:22.421192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.437678 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:22.438141 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:22.438590 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:22.439725 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.444612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:22.445067 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:11:22.446196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.448472 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:11:22.449977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9bf64fb0>]}
[0m22:11:22.450667 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 293.85s]
[0m22:11:22.451426 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:11:22.452317 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:11:22.452960 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:11:22.453574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:11:22.454017 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:11:22.458857 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:11:22.459478 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:11:22.494179 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:22.494698 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250331221122488216"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:11:22.495170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:22.503109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.510618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:22.511069 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:11:22.511679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.512120 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:22.512580 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250331221122488216'
      
      
      order by ordinal_position

  
[0m22:11:22.516978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.522989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:22.523453 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:22.525826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.533200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:22.533680 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:22.536065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.553596 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:11:22.554268 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:22.554752 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250331221122488216"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250331221122488216"
    )
  
[0m22:11:22.604352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.606298 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:22.606763 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:22.607176 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:22.614740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:22.615624 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:11:22.617298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b18735f-eefb-43bf-9bc9-c9ab091ca8fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e701d85f0>]}
[0m22:11:22.617981 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:11:22.618803 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:11:22.620067 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:22.620480 [debug] [MainThread]: On master: BEGIN
[0m22:11:22.620897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:22.621563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:22.621971 [debug] [MainThread]: On master: COMMIT
[0m22:11:22.622344 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:22.622748 [debug] [MainThread]: On master: COMMIT
[0m22:11:22.623295 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:22.623722 [debug] [MainThread]: On master: Close
[0m22:11:22.624295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:22.624701 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:11:22.625100 [info ] [MainThread]: 
[0m22:11:22.625649 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 54.77 seconds (294.77s).
[0m22:11:22.626592 [debug] [MainThread]: Command end result
[0m22:11:22.650623 [info ] [MainThread]: 
[0m22:11:22.651190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:22.651694 [info ] [MainThread]: 
[0m22:11:22.652186 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:11:22.653135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 296.75183, "process_user_time": 5.190173, "process_kernel_time": 0.302057, "process_mem_max_rss": "306636", "process_in_blocks": "1184", "process_out_blocks": "94408"}
[0m22:11:22.653673 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:22.653570 after 296.75 seconds
[0m22:11:22.654106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e94284e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9a6ae870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9a6ae540>]}
[0m22:11:22.654549 [debug] [MainThread]: Flushing usage events
[0m22:11:24.699186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52bf32fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52bfa8e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c0302660>]}


============================== 22:11:24.702155 | 86df685a-a6b0-48f0-83d8-8a91f5d055e1 ==============================
[0m22:11:24.702155 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:24.702874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:11:24.812988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86df685a-a6b0-48f0-83d8-8a91f5d055e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52be920e30>]}
[0m22:11:24.831880 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18236323, "process_user_time": 1.319836, "process_kernel_time": 0.112986, "process_mem_max_rss": "98968", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:11:24.832388 [debug] [MainThread]: Command `dbt clean` succeeded at 22:11:24.832286 after 0.18 seconds
[0m22:11:24.832857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52be885b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52bed0c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52bf36e900>]}
[0m22:11:24.833280 [debug] [MainThread]: Flushing usage events
[0m06:02:11.965827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972f4f66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972fb25430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972fc3ca70>]}


============================== 06:02:11.974381 | f6104c1d-a379-4470-ab8d-147d17428710 ==============================
[0m06:02:11.974381 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.975047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.096984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6104c1d-a379-4470-ab8d-147d17428710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972f11d4c0>]}
[0m06:02:12.114649 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r_ukazoz'
[0m06:02:12.115219 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:12.221924 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:12.222790 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:12.235224 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:12.239237 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.450760 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.451434 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:12.451996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f6104c1d-a379-4470-ab8d-147d17428710', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972ef98650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972ee316a0>]}
[0m06:02:12.452496 [info ] [MainThread]: 
[0m06:02:12.452990 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:12.464117 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.553078, "process_user_time": 1.767078, "process_kernel_time": 0.138397, "process_mem_max_rss": "99872", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m06:02:12.464842 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:12.464730 after 0.55 seconds
[0m06:02:12.465295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972f4f66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972ef72000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f972f11d4c0>]}
[0m06:02:12.465767 [debug] [MainThread]: Flushing usage events
[0m06:02:14.455615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca01f60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca2304620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca029c320>]}


============================== 06:02:14.459051 | b3c1ff07-75f2-40eb-bf8b-a91881264a05 ==============================
[0m06:02:14.459051 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.459818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.684671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9f57e0c0>]}
[0m06:02:14.750533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca08cc5c0>]}
[0m06:02:14.753450 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:14.802485 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:14.803304 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:14.803866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9b78e150>]}
[0m06:02:16.131050 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.131763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9b4412b0>]}
[0m06:02:16.397806 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.403682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9b4c3530>]}
[0m06:02:16.495339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9b4c4620>]}
[0m06:02:16.495958 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:16.496472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9b54a4b0>]}
[0m06:02:16.498418 [info ] [MainThread]: 
[0m06:02:16.499155 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.504335 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.540487 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.541049 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.541498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.131006 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:17.132684 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.133640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.134213 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.142036 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.142551 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.142957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.144504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.146092 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.146525 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.147136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.147570 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.147959 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.148613 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.149595 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.150014 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.150415 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.150993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.151447 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.152963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.159171 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.159632 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.160021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.160833 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.161256 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.161692 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.176435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.178172 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.179541 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.179982 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.182562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9b440770>]}
[0m06:02:17.183233 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.183712 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.184103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.184856 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.185278 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.185721 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.186108 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.186713 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.187122 [debug] [MainThread]: On master: Close
[0m06:02:17.187714 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.188198 [info ] [MainThread]: 
[0m06:02:17.202681 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.203407 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.204071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:17.204560 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.233948 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.234892 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.272127 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.273080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:12.567442 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.567989 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:12.568758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.569217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.569676 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:12.570452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.573612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.574091 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:12.574955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.592308 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:12.592943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.593418 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:12.595464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.601064 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:12.601597 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:12.603206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.605765 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:12.607418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc74362270>]}
[0m06:07:12.608145 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.40s]
[0m06:07:12.609034 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:12.610087 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:12.610683 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:12.611292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:12.611758 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:12.616992 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:12.617707 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:12.653890 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.654507 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250401060712647619"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:12.654982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:12.664094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.672300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.672834 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:12.673604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.674056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.674520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250401060712647619'
      
      
      order by ordinal_position

  
[0m06:07:12.679503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.686258 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.686805 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:12.689776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.698017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.698548 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:12.701291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.720091 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:12.720930 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.721443 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250401060712647619"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250401060712647619"
    )
  
[0m06:07:12.771422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.773432 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:12.773902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:12.774330 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:12.782858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:12.783885 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:12.785609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c1ff07-75f2-40eb-bf8b-a91881264a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc743db950>]}
[0m06:07:12.786291 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:12.787140 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:12.788565 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:12.788999 [debug] [MainThread]: On master: BEGIN
[0m06:07:12.789418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:12.790170 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:12.790629 [debug] [MainThread]: On master: COMMIT
[0m06:07:12.791013 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:12.791422 [debug] [MainThread]: On master: COMMIT
[0m06:07:12.791985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:12.792416 [debug] [MainThread]: On master: Close
[0m06:07:12.793053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:12.793456 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:12.793872 [info ] [MainThread]: 
[0m06:07:12.794375 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 56.29 seconds (296.29s).
[0m06:07:12.795287 [debug] [MainThread]: Command end result
[0m06:07:12.820816 [info ] [MainThread]: 
[0m06:07:12.821509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:12.822032 [info ] [MainThread]: 
[0m06:07:12.822557 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:12.823583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 298.42343, "process_user_time": 5.553547, "process_kernel_time": 0.289393, "process_mem_max_rss": "308088", "process_in_blocks": "1184", "process_out_blocks": "94384"}
[0m06:07:12.824120 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:12.824015 after 298.42 seconds
[0m06:07:12.824611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca0205100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdca08b2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9fb4df40>]}
[0m06:07:12.825067 [debug] [MainThread]: Flushing usage events
[0m06:07:15.114002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b3b38140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b4523ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b45219a0>]}


============================== 06:07:15.117571 | 2129239d-3c46-45b7-9555-6ea15cf38451 ==============================
[0m06:07:15.117571 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:15.118342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:07:15.240649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2129239d-3c46-45b7-9555-6ea15cf38451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b44b5e20>]}
[0m06:07:15.262265 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20432884, "process_user_time": 1.5274, "process_kernel_time": 0.10196, "process_mem_max_rss": "98552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:15.262918 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:15.262806 after 0.21 seconds
[0m06:07:15.263424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b401e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b391bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b39c9040>]}
[0m06:07:15.263920 [debug] [MainThread]: Flushing usage events
[0m14:05:36.561454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b4bf90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b5ba9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b4b80ce0>]}


============================== 14:05:36.590153 | 307c93d6-752f-467c-8e3b-02a797c78f59 ==============================
[0m14:05:36.590153 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:36.590797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.699935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '307c93d6-752f-467c-8e3b-02a797c78f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b5068140>]}
[0m14:05:36.714920 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3jxoe6y6'
[0m14:05:36.715388 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:36.825813 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:36.826448 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:36.858428 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:36.862311 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:37.237214 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:37.237745 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:37.238282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '307c93d6-752f-467c-8e3b-02a797c78f59', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b5654560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b4758aa0>]}
[0m14:05:37.238744 [info ] [MainThread]: 
[0m14:05:37.239242 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:37.260658 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7486667, "process_user_time": 1.56991, "process_kernel_time": 0.134248, "process_mem_max_rss": "99944", "process_in_blocks": "8392", "process_out_blocks": "5184"}
[0m14:05:37.261209 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:37.261080 after 0.75 seconds
[0m14:05:37.261641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b50060f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b502dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b474d160>]}
[0m14:05:37.262065 [debug] [MainThread]: Flushing usage events
[0m14:05:39.007899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5373e329c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5374d1c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5373d58f20>]}


============================== 14:05:39.010921 | 5f3f09a5-3e30-42a4-9c33-70a7a99bdff4 ==============================
[0m14:05:39.010921 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:39.011575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:39.213269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5374eaba40>]}
[0m14:05:39.271725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5373bb00e0>]}
[0m14:05:39.274127 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:39.321931 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:39.322659 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:39.323208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5373d58d70>]}
[0m14:05:40.617461 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:40.618133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536faad640>]}
[0m14:05:40.842055 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:40.847364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536fae5cd0>]}
[0m14:05:40.929964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536faa03b0>]}
[0m14:05:40.930478 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:40.930970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536faf5d30>]}
[0m14:05:40.932802 [info ] [MainThread]: 
[0m14:05:40.933480 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:40.938132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:40.971748 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:40.972210 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:40.972611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:41.419054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.420750 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:41.421871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:41.422611 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:41.432157 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.432703 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:41.433240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:41.434370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.435821 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.436244 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:41.436807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.437225 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.437607 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:41.438208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.439138 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:41.439536 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:41.439909 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:41.440471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.440876 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:41.442148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:41.447847 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:41.448287 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:41.448664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:41.449304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.449705 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:41.450114 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:41.464551 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:41.465977 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:41.467207 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:41.467618 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:41.470001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536fa3d730>]}
[0m14:05:41.470560 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:41.470961 [debug] [MainThread]: On master: BEGIN
[0m14:05:41.471367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:41.471995 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:41.472448 [debug] [MainThread]: On master: COMMIT
[0m14:05:41.472835 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:41.473239 [debug] [MainThread]: On master: COMMIT
[0m14:05:41.473792 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:41.474217 [debug] [MainThread]: On master: Close
[0m14:05:41.474754 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:41.475252 [info ] [MainThread]: 
[0m14:05:41.484889 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:41.485493 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:41.486057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:41.486526 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:41.514565 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:41.515321 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:41.551136 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:41.551860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:33.702621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:33.703138 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:33.703764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.704228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:33.704659 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:33.705408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.708257 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:33.708721 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:33.709408 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.725821 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:33.726312 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:33.726745 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:33.728556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.733488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:33.733953 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:33.735794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.738115 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:33.739612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53747a0080>]}
[0m14:10:33.740329 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.25s]
[0m14:10:33.741156 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:33.742078 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:33.742764 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:33.743382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:33.743826 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:33.748746 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:33.749386 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:33.784018 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:33.784539 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250401141033778027"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:33.785001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:33.792624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.799907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:33.800385 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:33.800981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.801457 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:33.801890 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250401141033778027'
      
      
      order by ordinal_position

  
[0m14:10:33.806242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.812176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:33.812648 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:33.816038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.823549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:33.824015 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:33.826335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.844184 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:33.844838 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:33.845322 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250401141033778027"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250401141033778027"
    )
  
[0m14:10:33.896366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.898377 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:33.898826 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:33.899270 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:33.907490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:33.908396 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:33.909936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3f09a5-3e30-42a4-9c33-70a7a99bdff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53443d7a40>]}
[0m14:10:33.910628 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:33.911376 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:33.912765 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:33.913214 [debug] [MainThread]: On master: BEGIN
[0m14:10:33.913599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:33.914262 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:33.914676 [debug] [MainThread]: On master: COMMIT
[0m14:10:33.915058 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:33.915474 [debug] [MainThread]: On master: COMMIT
[0m14:10:33.916016 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:33.916468 [debug] [MainThread]: On master: Close
[0m14:10:33.917042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:33.917464 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:33.917870 [info ] [MainThread]: 
[0m14:10:33.918380 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.98 seconds (292.98s).
[0m14:10:33.919380 [debug] [MainThread]: Command end result
[0m14:10:33.943663 [info ] [MainThread]: 
[0m14:10:33.944285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:33.944811 [info ] [MainThread]: 
[0m14:10:33.945365 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:33.946361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.98837, "process_user_time": 5.046141, "process_kernel_time": 0.259161, "process_mem_max_rss": "303212", "process_in_blocks": "1184", "process_out_blocks": "94376"}
[0m14:10:33.946880 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:33.946781 after 294.99 seconds
[0m14:10:33.947341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5373e329c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53743327b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536fcde0c0>]}
[0m14:10:33.947775 [debug] [MainThread]: Flushing usage events
[0m14:10:35.930328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dec865760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dec42d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dec002c30>]}


============================== 14:10:35.933308 | e4f147c5-c200-4aeb-ac05-70898a3e7f43 ==============================
[0m14:10:35.933308 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:35.933945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:10:36.043780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4f147c5-c200-4aeb-ac05-70898a3e7f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dec10d9a0>]}
[0m14:10:36.062793 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1818724, "process_user_time": 1.332349, "process_kernel_time": 0.109946, "process_mem_max_rss": "98988", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:36.063392 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:36.063283 after 0.18 seconds
[0m14:10:36.063819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df01bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dec10d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dec865760>]}
[0m14:10:36.064279 [debug] [MainThread]: Flushing usage events
[0m22:06:14.206111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2dee660f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e0ddd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2dec0d160>]}


============================== 22:06:14.221733 | 54792a41-2857-409d-b76d-6e62051c28d4 ==============================
[0m22:06:14.221733 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:14.222411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:14.332768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54792a41-2857-409d-b76d-6e62051c28d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de899070>]}
[0m22:06:14.348576 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-en2ujhpt'
[0m22:06:14.349085 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:14.518391 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:14.519168 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:14.544251 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:14.548328 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:14.627431 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:14.628096 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:14.628681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '54792a41-2857-409d-b76d-6e62051c28d4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2dea3ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2dea3bb90>]}
[0m22:06:14.629181 [info ] [MainThread]: 
[0m22:06:14.629702 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:14.636659 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4804496, "process_user_time": 1.558242, "process_kernel_time": 0.142838, "process_mem_max_rss": "99436", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m22:06:14.637221 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:14.637116 after 0.48 seconds
[0m22:06:14.637665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e13a7e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de76dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e18b1610>]}
[0m22:06:14.638135 [debug] [MainThread]: Flushing usage events
[0m22:06:16.234059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9559473dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9559473b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9558e6aa20>]}


============================== 22:06:16.237124 | 5ff5f38e-419f-420f-8249-23822efefc55 ==============================
[0m22:06:16.237124 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:16.237817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:16.438474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95588911c0>]}
[0m22:06:16.498220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9558eacd70>]}
[0m22:06:16.500859 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:06:16.526391 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:16.527223 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:16.527756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f955875be90>]}
[0m22:06:17.813056 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:17.813703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95547bfd10>]}
[0m22:06:18.045786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:18.051309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95547bb0b0>]}
[0m22:06:18.135203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95547ad010>]}
[0m22:06:18.135765 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:06:18.136297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f955477d160>]}
[0m22:06:18.138148 [info ] [MainThread]: 
[0m22:06:18.138876 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:18.143585 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:18.178730 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:18.179215 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:18.179611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:18.548649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.550329 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:18.551285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:18.551843 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:18.559317 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:18.559748 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:18.560165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:18.561052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.562470 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:18.562881 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:18.563479 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.563871 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:18.564278 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:18.564853 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.565810 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:18.566227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:18.566601 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:18.567160 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.567567 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:18.568764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:18.574509 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:18.574920 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:18.575321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:18.575919 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.576341 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:18.576727 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:18.591041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:18.592527 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:18.593768 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:18.594198 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:18.596388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95547e2f00>]}
[0m22:06:18.596897 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:18.597335 [debug] [MainThread]: On master: BEGIN
[0m22:06:18.597710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:18.598355 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:18.598761 [debug] [MainThread]: On master: COMMIT
[0m22:06:18.599182 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:18.599555 [debug] [MainThread]: On master: COMMIT
[0m22:06:18.600103 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:18.600519 [debug] [MainThread]: On master: Close
[0m22:06:18.601124 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:18.601651 [info ] [MainThread]: 
[0m22:06:18.611716 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:18.612344 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:18.612906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:18.613381 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:18.641844 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:18.642655 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:18.678924 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:18.679712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:10.948111 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:10.948608 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:11:10.949239 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:10.949681 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:10.950130 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:11:10.950819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:10.953680 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:10.954144 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:11:10.954804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:10.971339 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:10.971819 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:10.972275 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:11:10.974101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:10.979119 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:11:10.979575 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:11:10.980984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:10.983324 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:11:10.984848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f955a784fb0>]}
[0m22:11:10.985543 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.37s]
[0m22:11:10.986327 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:11:10.987226 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:11:10.987858 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:11:10.988451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:11:10.988903 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:11:10.994002 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:11:10.994661 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:11:11.029925 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:11.030442 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250401221111023914"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:11:11.030912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:11.039270 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:11.046701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:11.047172 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:11:11.047762 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:11.048222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:11.048650 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250401221111023914'
      
      
      order by ordinal_position

  
[0m22:11:11.052932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:11.059015 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:11.059501 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:11.062069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:11.069671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:11.070158 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:11:11.072729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:11.090614 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:11:11.091361 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:11.091826 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250401221111023914"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250401221111023914"
    )
  
[0m22:11:11.141875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:11.143875 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:11.144345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:11:11.144772 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:11:11.152424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:11:11.153332 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:11:11.154878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ff5f38e-419f-420f-8249-23822efefc55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95282420c0>]}
[0m22:11:11.155571 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:11:11.156329 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:11:11.157618 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:11.158070 [debug] [MainThread]: On master: BEGIN
[0m22:11:11.158451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:11.159091 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:11.159499 [debug] [MainThread]: On master: COMMIT
[0m22:11:11.159889 [debug] [MainThread]: Using duckdb connection "master"
[0m22:11:11.160307 [debug] [MainThread]: On master: COMMIT
[0m22:11:11.160876 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:11:11.161331 [debug] [MainThread]: On master: Close
[0m22:11:11.161930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:11.162336 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:11:11.162744 [info ] [MainThread]: 
[0m22:11:11.163227 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.02 seconds (293.02s).
[0m22:11:11.164136 [debug] [MainThread]: Command end result
[0m22:11:11.188446 [info ] [MainThread]: 
[0m22:11:11.189010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:11.189470 [info ] [MainThread]: 
[0m22:11:11.189955 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:11:11.190852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.00684, "process_user_time": 5.027062, "process_kernel_time": 0.264318, "process_mem_max_rss": "307808", "process_in_blocks": "1184", "process_out_blocks": "94408"}
[0m22:11:11.191419 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:11.191320 after 295.01 seconds
[0m22:11:11.191851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95589d92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9559b927e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9558e6aae0>]}
[0m22:11:11.192304 [debug] [MainThread]: Flushing usage events
[0m22:11:13.024993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3f031fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ebb7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ebb54c0>]}


============================== 22:11:13.028073 | 64ccbcc5-63a3-4853-bcee-b02bc141a1bf ==============================
[0m22:11:13.028073 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:13.028745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:11:13.140304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64ccbcc5-63a3-4853-bcee-b02bc141a1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3ea94d70>]}
[0m22:11:13.159670 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1847365, "process_user_time": 1.333294, "process_kernel_time": 0.116938, "process_mem_max_rss": "98636", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:11:13.160233 [debug] [MainThread]: Command `dbt clean` succeeded at 22:11:13.160130 after 0.19 seconds
[0m22:11:13.160669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec42bbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3e5166c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3e616480>]}
[0m22:11:13.161256 [debug] [MainThread]: Flushing usage events
[0m06:02:06.289050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f147216aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1474a7be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1471ed39e0>]}


============================== 06:02:06.306466 | f47604f0-cb90-4599-a740-91547c8cb94b ==============================
[0m06:02:06.306466 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.307196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.417371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f47604f0-cb90-4599-a740-91547c8cb94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1471b3bc50>]}
[0m06:02:06.433896 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-if96hv03'
[0m06:02:06.434394 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:06.583621 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:06.584398 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.607835 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.611792 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.683726 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.684333 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:06.684992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f47604f0-cb90-4599-a740-91547c8cb94b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1471b98da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1471a66330>]}
[0m06:02:06.685460 [info ] [MainThread]: 
[0m06:02:06.686004 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:06.697932 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45861617, "process_user_time": 1.570812, "process_kernel_time": 0.134641, "process_mem_max_rss": "99944", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m06:02:06.698525 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.698385 after 0.46 seconds
[0m06:02:06.698989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14721ad340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1472795130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1472795220>]}
[0m06:02:06.699431 [debug] [MainThread]: Flushing usage events
[0m06:02:08.358698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9515695910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95145127b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9513e08bf0>]}


============================== 06:02:08.361755 | a4974a4c-f11f-406a-91bf-93574c2a5daa ==============================
[0m06:02:08.361755 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.362447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.563056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9517dbbda0>]}
[0m06:02:08.622523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951374a990>]}
[0m06:02:08.625153 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:08.662571 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.663335 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.663901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951377b920>]}
[0m06:02:09.947633 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:09.948305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950f7a9c40>]}
[0m06:02:10.185567 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:10.190949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950f793ad0>]}
[0m06:02:10.292825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950f77be00>]}
[0m06:02:10.293394 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:10.293956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950f7e5d30>]}
[0m06:02:10.295864 [info ] [MainThread]: 
[0m06:02:10.296616 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:10.301347 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:10.336304 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:10.336802 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:10.337207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.720673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.722558 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.723783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.724463 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.732698 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.733134 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.733545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.734417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.735870 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.736280 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.736862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.737261 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.737670 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.738256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.739189 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.739617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.740069 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.740641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.741054 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.742391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.748259 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.748699 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.749078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.749698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.750107 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.750521 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.764510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.765982 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.767217 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.767648 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.769894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950f606780>]}
[0m06:02:10.770411 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.770848 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.771227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.771913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.772331 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.772759 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.773133 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.773694 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.774099 [debug] [MainThread]: On master: Close
[0m06:02:10.774665 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.775146 [info ] [MainThread]: 
[0m06:02:10.784920 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.785545 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.786128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:10.786597 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.815004 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.815889 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.852257 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.853078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:00.387912 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.388410 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:00.389056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.389520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.389951 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:00.390680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.393524 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.393978 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:00.394671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.410797 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:00.411263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.411718 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:00.412828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.417712 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:00.418176 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:00.419566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.421835 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:00.423326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950f7e2870>]}
[0m06:07:00.424043 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 289.64s]
[0m06:07:00.424839 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:00.425750 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:00.426383 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:00.427033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:00.427468 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:00.432254 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:00.432894 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:00.467609 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.468124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250402060700461613"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:00.468600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:00.476982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.484310 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.484790 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:00.485422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.485887 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.486313 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250402060700461613'
      
      
      order by ordinal_position

  
[0m06:07:00.490640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.496654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.497131 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:00.499415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.506798 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.507265 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:00.509802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.527591 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:00.528273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.528750 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250402060700461613"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250402060700461613"
    )
  
[0m06:07:00.577503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.579454 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:00.579920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:00.580336 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:00.587793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:00.588675 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:00.590294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4974a4c-f11f-406a-91bf-93574c2a5daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9506d17d10>]}
[0m06:07:00.590985 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:07:00.591808 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:00.593103 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:00.593562 [debug] [MainThread]: On master: BEGIN
[0m06:07:00.593958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:00.594614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:00.595027 [debug] [MainThread]: On master: COMMIT
[0m06:07:00.595412 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:00.595819 [debug] [MainThread]: On master: COMMIT
[0m06:07:00.596359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:00.596795 [debug] [MainThread]: On master: Close
[0m06:07:00.597399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:00.597845 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:00.598250 [info ] [MainThread]: 
[0m06:07:00.598726 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 50.30 seconds (290.30s).
[0m06:07:00.599668 [debug] [MainThread]: Command end result
[0m06:07:00.624045 [info ] [MainThread]: 
[0m06:07:00.624615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:00.625076 [info ] [MainThread]: 
[0m06:07:00.625570 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:00.626477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 292.31714, "process_user_time": 5.023809, "process_kernel_time": 0.265778, "process_mem_max_rss": "308120", "process_in_blocks": "1184", "process_out_blocks": "94384"}
[0m06:07:00.627024 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:00.626925 after 292.32 seconds
[0m06:07:00.627455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9513ae7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e5f61820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e4d96ff0>]}
[0m06:07:00.627909 [debug] [MainThread]: Flushing usage events
[0m06:07:02.446389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64b46570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64050ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d659351c0>]}


============================== 06:07:02.449602 | 78cf30f6-8d42-42ee-ba68-2c76b0793cc5 ==============================
[0m06:07:02.449602 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:02.450324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:07:02.562378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78cf30f6-8d42-42ee-ba68-2c76b0793cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d650afda0>]}
[0m06:07:02.582321 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18588264, "process_user_time": 1.348112, "process_kernel_time": 0.119009, "process_mem_max_rss": "98472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:02.582882 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:02.582779 after 0.19 seconds
[0m06:07:02.583321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d68563da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d63daa8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d63f312b0>]}
[0m06:07:02.583776 [debug] [MainThread]: Flushing usage events
[0m14:05:26.660587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec82ede0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec820547a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec820549b0>]}


============================== 14:05:26.668785 | 24dc7f95-9b5a-46af-b676-81e333e43f3a ==============================
[0m14:05:26.668785 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.669465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.779668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24dc7f95-9b5a-46af-b676-81e333e43f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec81ed5430>]}
[0m14:05:26.795422 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ngn20574'
[0m14:05:26.795897 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:26.930896 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:26.931662 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:26.960307 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:26.964378 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:27.200498 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:27.201102 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:27.201707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '24dc7f95-9b5a-46af-b676-81e333e43f3a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec81c5b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec81c5a750>]}
[0m14:05:27.202164 [info ] [MainThread]: 
[0m14:05:27.202674 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:27.218145 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.607361, "process_user_time": 1.570657, "process_kernel_time": 0.13597, "process_mem_max_rss": "99612", "process_in_blocks": "8392", "process_out_blocks": "5184"}
[0m14:05:27.218841 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:27.218714 after 0.61 seconds
[0m14:05:27.219347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec82922ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec82fd4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec81d5af30>]}
[0m14:05:27.219789 [debug] [MainThread]: Flushing usage events
[0m14:05:28.960776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f90e2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f9ab29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f9193560>]}


============================== 14:05:28.963786 | f7fece44-37ab-4668-a871-2eec6a8bcad9 ==============================
[0m14:05:28.963786 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.964455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.172535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f8fc5790>]}
[0m14:05:29.232587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f9492990>]}
[0m14:05:29.235228 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:29.402161 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:29.402955 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:29.403507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f8d4ee10>]}
[0m14:05:30.731527 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:30.732169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f8deaf60>]}
[0m14:05:30.962623 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:30.967984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f4dc20f0>]}
[0m14:05:31.052547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f4d2fbc0>]}
[0m14:05:31.053121 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:31.053623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f90e1b50>]}
[0m14:05:31.055469 [info ] [MainThread]: 
[0m14:05:31.056165 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:31.060902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:31.095772 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:31.096299 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:31.096719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:31.460361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.461949 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:31.462964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:31.463547 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:31.470998 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.471450 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:31.471847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.472740 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.474162 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.474588 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:31.475183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.475617 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.476001 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:31.476596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.477537 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:31.477942 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:31.478345 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:31.478943 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.479388 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:31.480618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:31.486289 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:31.486708 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:31.487078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:31.487703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.488100 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:31.488510 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:31.502198 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:31.503812 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:31.505079 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:31.505503 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:31.507744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3fadb77a0>]}
[0m14:05:31.508296 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.508705 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.509085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:31.509748 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.510153 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.510561 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.510932 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.511475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.511881 [debug] [MainThread]: On master: Close
[0m14:05:31.512440 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:31.512920 [info ] [MainThread]: 
[0m14:05:31.523144 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:31.523772 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:31.524452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:31.524912 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:31.553186 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:31.554013 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:31.590069 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:31.590909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:29.386087 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:29.386629 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:29.387284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.387751 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:29.388189 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:29.388905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.391775 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:29.392232 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:29.392940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.409584 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:29.410058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:29.410523 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:29.411729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.416696 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:29.417161 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:29.418444 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.420739 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:29.422240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f9ab03e0>]}
[0m14:10:29.422938 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 297.90s]
[0m14:10:29.423778 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:29.424566 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:29.425325 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:29.425922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:29.426402 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:29.431330 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:29.431975 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:29.466818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:29.467359 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250402141029460741"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:29.467843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:29.476190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.483750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:29.484211 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:29.484850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.485313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:29.485751 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250402141029460741'
      
      
      order by ordinal_position

  
[0m14:10:29.490009 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.496079 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:29.496570 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:29.498838 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.506343 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:29.506832 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:29.510073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.528048 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:29.528745 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:29.529203 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250402141029460741"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250402141029460741"
    )
  
[0m14:10:29.581123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.583143 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:29.583613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:29.584046 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:29.591766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:29.592672 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:29.594337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7fece44-37ab-4668-a871-2eec6a8bcad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c0d589e0>]}
[0m14:10:29.595010 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:29.595750 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:29.597002 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:29.597472 [debug] [MainThread]: On master: BEGIN
[0m14:10:29.597867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:29.598543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:29.598963 [debug] [MainThread]: On master: COMMIT
[0m14:10:29.599382 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:29.599758 [debug] [MainThread]: On master: COMMIT
[0m14:10:29.600317 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:29.600723 [debug] [MainThread]: On master: Close
[0m14:10:29.601382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:29.601766 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:29.602175 [info ] [MainThread]: 
[0m14:10:29.602723 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 58.55 seconds (298.55s).
[0m14:10:29.603722 [debug] [MainThread]: Command end result
[0m14:10:29.628094 [info ] [MainThread]: 
[0m14:10:29.628735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:29.629284 [info ] [MainThread]: 
[0m14:10:29.629826 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:29.630842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 300.72275, "process_user_time": 5.083879, "process_kernel_time": 0.286218, "process_mem_max_rss": "306964", "process_in_blocks": "1184", "process_out_blocks": "94384"}
[0m14:10:29.631392 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:29.631289 after 300.72 seconds
[0m14:10:29.631839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f90e2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f4c1cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c1ec7ec0>]}
[0m14:10:29.632300 [debug] [MainThread]: Flushing usage events
[0m14:10:31.568996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098a99a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098a45ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098b0f7ec0>]}


============================== 14:10:31.572004 | 3d351cb8-0628-4dbf-9b31-f29171c55004 ==============================
[0m14:10:31.572004 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:31.572692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:10:31.683259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d351cb8-0628-4dbf-9b31-f29171c55004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098a898a70>]}
[0m14:10:31.702942 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18377152, "process_user_time": 1.367128, "process_kernel_time": 0.089942, "process_mem_max_rss": "98852", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:10:31.703503 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:31.703398 after 0.18 seconds
[0m14:10:31.703944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098a9b4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098a45ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098c048b60>]}
[0m14:10:31.704405 [debug] [MainThread]: Flushing usage events
[0m22:05:53.518809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8a026150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd89a2e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd889c92b0>]}


============================== 22:05:53.527331 | 89dd1f74-e9d7-41e3-9bef-894d843e53a6 ==============================
[0m22:05:53.527331 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.528019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.642603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89dd1f74-e9d7-41e3-9bef-894d843e53a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd87d935c0>]}
[0m22:05:53.658546 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ih8selcv'
[0m22:05:53.659053 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:53.763749 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:53.764481 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:53.796507 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:53.800401 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:54.171277 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:54.171917 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:54.172476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '89dd1f74-e9d7-41e3-9bef-894d843e53a6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd87ccfe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd87ccfce0>]}
[0m22:05:54.172970 [info ] [MainThread]: 
[0m22:05:54.173457 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:54.193803 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.72419024, "process_user_time": 1.565151, "process_kernel_time": 0.135272, "process_mem_max_rss": "99800", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m22:05:54.194553 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:54.194439 after 0.73 seconds
[0m22:05:54.195061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd88d33920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd88104f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd88104e60>]}
[0m22:05:54.195543 [debug] [MainThread]: Flushing usage events
[0m22:05:55.990805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cd74e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cd77e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cfb4bd40>]}


============================== 22:05:55.993805 | 160928f4-69e5-499e-a5c0-d79a7b28f4db ==============================
[0m22:05:55.993805 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:55.994479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:56.195479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ce39be90>]}
[0m22:05:56.254888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cfb4bd40>]}
[0m22:05:56.257775 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:56.313387 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:56.314142 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:56.314680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ceeb9fd0>]}
[0m22:05:57.617813 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:57.618519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c8f88620>]}
[0m22:05:57.848741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:57.854175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cd695190>]}
[0m22:05:57.937136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c8f521b0>]}
[0m22:05:57.937696 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:57.938244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c8fe7740>]}
[0m22:05:57.940105 [info ] [MainThread]: 
[0m22:05:57.940824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:57.945454 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:57.979882 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:57.980357 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:57.980757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:59.856294 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m22:05:59.858146 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:59.859255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:59.859880 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:59.868261 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.868742 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:59.869229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.870198 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.871621 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.872056 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:59.872613 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.873044 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.873427 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:59.874024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.874962 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.875365 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.875747 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.876333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.876742 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:59.877992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:59.883666 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.884121 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:59.884495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.885131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.885527 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.885909 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:59.900743 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.902343 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:59.903595 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:59.904020 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:59.906131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c8feb050>]}
[0m22:05:59.906637 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.907067 [debug] [MainThread]: On master: BEGIN
[0m22:05:59.907433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:59.908096 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.908498 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.908871 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.909261 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.909789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.910204 [debug] [MainThread]: On master: Close
[0m22:05:59.910707 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:59.911222 [info ] [MainThread]: 
[0m22:05:59.921462 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:59.922081 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:59.922728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:59.923199 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:59.951512 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:59.952317 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:59.988482 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:59.989395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:55.521995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.522495 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:55.523163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.523611 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.524066 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:55.524757 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.527692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.528162 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:55.528837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.545223 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:55.545695 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.546167 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:55.547383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.552329 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:55.552802 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:55.554164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.556497 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:55.558018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a4271880>]}
[0m22:10:55.558700 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.63s]
[0m22:10:55.559481 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:55.560309 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:55.560871 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:55.561504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:55.561995 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:55.567136 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:55.567796 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:55.602781 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.603309 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250402221055596705"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:55.603772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:55.611778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.619280 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.619748 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:55.620407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.620854 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.621319 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250402221055596705'
      
      
      order by ordinal_position

  
[0m22:10:55.625953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.632069 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.632548 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:55.634890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.642420 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.642892 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:55.645235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.663219 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:55.663898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.664391 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250402221055596705"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250402221055596705"
    )
  
[0m22:10:55.718001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.720059 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:55.720519 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:55.720970 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:55.728556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:55.729452 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:55.731040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160928f4-69e5-499e-a5c0-d79a7b28f4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe694d277d0>]}
[0m22:10:55.731754 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:55.732482 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:55.733867 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:55.734337 [debug] [MainThread]: On master: BEGIN
[0m22:10:55.734733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:55.735423 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:55.735836 [debug] [MainThread]: On master: COMMIT
[0m22:10:55.736260 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:55.736642 [debug] [MainThread]: On master: COMMIT
[0m22:10:55.737235 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:55.737637 [debug] [MainThread]: On master: Close
[0m22:10:55.738290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:55.738669 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:55.739101 [info ] [MainThread]: 
[0m22:10:55.739624 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 57.80 seconds (297.80s).
[0m22:10:55.740619 [debug] [MainThread]: Command end result
[0m22:10:55.765081 [info ] [MainThread]: 
[0m22:10:55.765688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:55.766240 [info ] [MainThread]: 
[0m22:10:55.766773 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:55.767789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 299.82675, "process_user_time": 6.534087, "process_kernel_time": 0.299324, "process_mem_max_rss": "309460", "process_in_blocks": "1184", "process_out_blocks": "94408"}
[0m22:10:55.768334 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:55.768233 after 299.83 seconds
[0m22:10:55.768768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cd406d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe695e9fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cd6564e0>]}
[0m22:10:55.769221 [debug] [MainThread]: Flushing usage events
[0m22:10:57.771606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84cad2de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84d008230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84ca7d6d0>]}


============================== 22:10:57.774700 | 9f565e07-5d92-4620-9f11-f65cf9b85826 ==============================
[0m22:10:57.774700 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:57.775381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:10:57.886610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f565e07-5d92-4620-9f11-f65cf9b85826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84ce7ca70>]}
[0m22:10:57.906081 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1842317, "process_user_time": 1.341562, "process_kernel_time": 0.107964, "process_mem_max_rss": "99016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:57.906612 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:57.906512 after 0.18 seconds
[0m22:10:57.907067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb850dbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84d022330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c8b9910>]}
[0m22:10:57.907511 [debug] [MainThread]: Flushing usage events
[0m06:02:09.136236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dd04f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dca69100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dd04d1f0>]}


============================== 06:02:09.144529 | 21bfcff5-7214-44c6-bcbc-fa6cf9e673b6 ==============================
[0m06:02:09.144529 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.145234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.255727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21bfcff5-7214-44c6-bcbc-fa6cf9e673b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4de1ed9a0>]}
[0m06:02:09.271587 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zqa94vtg'
[0m06:02:09.272091 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:09.451400 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:09.452062 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:09.474885 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:09.478705 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:09.554424 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:09.554956 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:09.555472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '21bfcff5-7214-44c6-bcbc-fa6cf9e673b6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dc36d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dd5a77d0>]}
[0m06:02:09.555939 [info ] [MainThread]: 
[0m06:02:09.556420 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:09.558107 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47174892, "process_user_time": 1.592157, "process_kernel_time": 0.118011, "process_mem_max_rss": "99636", "process_in_blocks": "8392", "process_out_blocks": "5184"}
[0m06:02:09.558613 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:09.558517 after 0.47 seconds
[0m06:02:09.559083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e0bbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dc8091c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dc36d8e0>]}
[0m06:02:09.559516 [debug] [MainThread]: Flushing usage events
[0m06:02:11.116278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7deae73590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dea438a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dea438f50>]}


============================== 06:02:11.119207 | dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556 ==============================
[0m06:02:11.119207 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.119857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.322828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dea894bc0>]}
[0m06:02:11.381706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dea41a600>]}
[0m06:02:11.384130 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:11.407787 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:11.408485 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:11.409037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dea463920>]}
[0m06:02:12.691372 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:12.692085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de63d18b0>]}
[0m06:02:12.920191 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:12.925424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de61cb0b0>]}
[0m06:02:13.007899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de617b770>]}
[0m06:02:13.008421 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:13.008958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dea8c8b30>]}
[0m06:02:13.010779 [info ] [MainThread]: 
[0m06:02:13.011494 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:13.016099 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:13.050154 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:13.050599 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:13.051032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:13.420038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.422154 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:13.423447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:13.424253 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:13.434323 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.434967 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:13.435557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.437256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.438930 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.439342 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:13.439980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.440376 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.440789 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:13.441393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.442333 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.442767 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:13.443148 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:13.443754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.444183 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:13.445375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:13.451054 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.451469 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:13.451866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:13.452471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.452889 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:13.453275 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:13.467382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:13.468820 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:13.470014 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:13.470425 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:13.472740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7de6133110>]}
[0m06:02:13.473248 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.473632 [debug] [MainThread]: On master: BEGIN
[0m06:02:13.474027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:13.474614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.475037 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.475412 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:13.475800 [debug] [MainThread]: On master: COMMIT
[0m06:02:13.476332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:13.476753 [debug] [MainThread]: On master: Close
[0m06:02:13.477290 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:13.477817 [info ] [MainThread]: 
[0m06:02:13.487518 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:13.488121 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:13.488774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:13.489227 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:13.516804 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:13.517530 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:13.552950 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:13.553691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:08.213812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.214322 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:08.214979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.215428 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.215872 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:08.216573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.219463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.219964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:08.220630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.237025 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:08.237509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.237963 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:08.239206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.244298 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:08.244781 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:08.246143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.248488 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:08.250025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbdfcfec0>]}
[0m06:07:08.250722 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 294.76s]
[0m06:07:08.251551 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:08.252374 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:08.252946 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:08.253591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:08.254066 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:08.259250 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:08.260162 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:08.295530 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.296122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250403060708289405"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:08.296604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:08.304912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.312922 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.313433 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:08.314242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.314723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.315165 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250403060708289405'
      
      
      order by ordinal_position

  
[0m06:07:08.319891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.326550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.327070 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:08.329532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.337209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.337698 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:08.340082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.358094 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:08.358810 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.359274 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250403060708289405"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250403060708289405"
    )
  
[0m06:07:08.409262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.411272 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:08.411793 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:08.412234 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:08.419318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:08.420216 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:08.421871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd8beaf1-0133-4bc8-bcb5-92f9fd1ac556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbc11d0a0>]}
[0m06:07:08.422562 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m06:07:08.423400 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:08.424765 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:08.425191 [debug] [MainThread]: On master: BEGIN
[0m06:07:08.425576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:08.426283 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:08.426716 [debug] [MainThread]: On master: COMMIT
[0m06:07:08.427106 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:08.427476 [debug] [MainThread]: On master: COMMIT
[0m06:07:08.428084 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:08.428484 [debug] [MainThread]: On master: Close
[0m06:07:08.429101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:08.429472 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:08.429896 [info ] [MainThread]: 
[0m06:07:08.430368 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 55.42 seconds (295.42s).
[0m06:07:08.431277 [debug] [MainThread]: Command end result
[0m06:07:08.456002 [info ] [MainThread]: 
[0m06:07:08.456564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:08.457048 [info ] [MainThread]: 
[0m06:07:08.457515 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:08.458440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 297.3916, "process_user_time": 4.598344, "process_kernel_time": 0.276441, "process_mem_max_rss": "295084", "process_in_blocks": "1184", "process_out_blocks": "94376"}
[0m06:07:08.458979 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:08.458881 after 297.39 seconds
[0m06:07:08.459417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7deaeb1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dec051d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbdf60ef0>]}
[0m06:07:08.459882 [debug] [MainThread]: Flushing usage events
[0m06:07:10.343904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ba3981550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ba2b09af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ba3981850>]}


============================== 06:07:10.346932 | b49e8814-f3b1-4b81-b605-67cd638a5c9c ==============================
[0m06:07:10.346932 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:10.347583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:07:10.458628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b49e8814-f3b1-4b81-b605-67cd638a5c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ba267d9a0>]}
[0m06:07:10.478411 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18477, "process_user_time": 1.362956, "process_kernel_time": 0.102996, "process_mem_max_rss": "98980", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:07:10.478965 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:10.478861 after 0.19 seconds
[0m06:07:10.479398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ba2b6cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ba280a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ba2e77020>]}
[0m06:07:10.479855 [debug] [MainThread]: Flushing usage events
[0m14:05:43.724033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3700f24fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3700c06570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370112bc20>]}


============================== 14:05:43.745390 | 58ae9fb4-0002-4012-83d7-ff43148cc0d2 ==============================
[0m14:05:43.745390 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:43.746052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:43.854754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58ae9fb4-0002-4012-83d7-ff43148cc0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3700484770>]}
[0m14:05:43.871434 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yfm1xt4e'
[0m14:05:43.871969 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:44.051226 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:44.052009 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:44.084860 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:44.088851 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:44.475682 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:44.476314 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:44.476876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '58ae9fb4-0002-4012-83d7-ff43148cc0d2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3701788ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37003c3ec0>]}
[0m14:05:44.477350 [info ] [MainThread]: 
[0m14:05:44.477857 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:44.485766 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.81098443, "process_user_time": 1.577392, "process_kernel_time": 0.141675, "process_mem_max_rss": "99712", "process_in_blocks": "8400", "process_out_blocks": "5192"}
[0m14:05:44.486310 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:44.486208 after 0.81 seconds
[0m14:05:44.486759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370034e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37007f6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37011c61e0>]}
[0m14:05:44.487200 [debug] [MainThread]: Flushing usage events
[0m14:05:46.257566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fd180380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fc361820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fca90080>]}


============================== 14:05:46.260622 | 56d8bda8-94bc-46fb-89d1-3717b6dabe6f ==============================
[0m14:05:46.260622 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:46.261308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.462218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fc44cc20>]}
[0m14:05:46.520819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fbe4a600>]}
[0m14:05:46.523388 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:46.565098 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:46.565875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:46.566419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fcbfc740>]}
[0m14:05:47.861785 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:47.862418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f7d8f830>]}
[0m14:05:48.097822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:48.103269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f7dda3f0>]}
[0m14:05:48.230764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f7d86780>]}
[0m14:05:48.231347 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:48.231913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fd1aede0>]}
[0m14:05:48.233764 [info ] [MainThread]: 
[0m14:05:48.234488 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:48.239250 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:48.274403 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:48.274888 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:48.275295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:48.811131 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:48.812775 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:48.813834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:48.814789 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:48.826856 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.827304 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:48.827707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.828610 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.830050 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.830475 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:48.831098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.831494 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.831922 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:48.832537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.833492 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.833920 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.834298 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.834857 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.835263 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:48.836520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:48.842159 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.842573 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:48.842989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.843622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.844067 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.844461 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:48.858562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.860101 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:48.861343 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:48.861784 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:48.864135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f673c770>]}
[0m14:05:48.864687 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.865130 [debug] [MainThread]: On master: BEGIN
[0m14:05:48.865504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:48.866180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.866594 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.867028 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.867412 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.868001 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.868414 [debug] [MainThread]: On master: Close
[0m14:05:48.868973 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:48.869490 [info ] [MainThread]: 
[0m14:05:48.888405 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:48.889031 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:48.889676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:48.890151 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:48.918970 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:48.919767 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:48.956379 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:48.957159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:44.429224 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:44.429757 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:44.430409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.430886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:44.431321 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:44.432064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.434985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:44.435439 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:44.436189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.452685 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:44.453181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:44.453612 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:44.455755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.460628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:44.461127 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:44.462777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.465094 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:44.466595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fdd44fb0>]}
[0m14:10:44.467310 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.58s]
[0m14:10:44.468145 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:44.469156 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:44.469757 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:44.470387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:44.470880 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:44.475829 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:44.476489 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:44.511284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:44.511811 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250403141044505259"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:44.512297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:44.520114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.527580 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:44.528059 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:44.528683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.529166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:44.529594 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250403141044505259'
      
      
      order by ordinal_position

  
[0m14:10:44.534213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.540266 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:44.540772 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:44.543053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.550546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:44.551076 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:44.553375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.571349 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:44.572068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:44.572540 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250403141044505259"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250403141044505259"
    )
  
[0m14:10:44.628010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.630094 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:44.630557 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:44.631021 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:44.639255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:44.640170 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:44.641732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d8bda8-94bc-46fb-89d1-3717b6dabe6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98d0293da0>]}
[0m14:10:44.642430 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:44.643187 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:44.644535 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:44.644998 [debug] [MainThread]: On master: BEGIN
[0m14:10:44.645392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:44.646095 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:44.646508 [debug] [MainThread]: On master: COMMIT
[0m14:10:44.646942 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:44.647325 [debug] [MainThread]: On master: COMMIT
[0m14:10:44.647892 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:44.648312 [debug] [MainThread]: On master: Close
[0m14:10:44.648936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:44.649324 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:44.649753 [info ] [MainThread]: 
[0m14:10:44.650247 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 56.42 seconds (296.42s).
[0m14:10:44.651179 [debug] [MainThread]: Command end result
[0m14:10:44.675887 [info ] [MainThread]: 
[0m14:10:44.676445 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:44.676914 [info ] [MainThread]: 
[0m14:10:44.677381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:44.678326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 298.47012, "process_user_time": 5.198387, "process_kernel_time": 0.278913, "process_mem_max_rss": "304624", "process_in_blocks": "1184", "process_out_blocks": "94376"}
[0m14:10:44.678891 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:44.678787 after 298.47 seconds
[0m14:10:44.679345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fd180380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f7d6f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fc40a630>]}
[0m14:10:44.679796 [debug] [MainThread]: Flushing usage events
[0m14:10:46.780794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735909d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735a2b9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f735909d310>]}


============================== 14:10:46.783858 | 1ffee548-80a1-44d5-8860-51b22b442bfa ==============================
[0m14:10:46.783858 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:46.784506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:46.894408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ffee548-80a1-44d5-8860-51b22b442bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7358e47b00>]}
[0m14:10:46.913554 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18230477, "process_user_time": 1.345428, "process_kernel_time": 0.109953, "process_mem_max_rss": "98716", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:10:46.914095 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:46.913995 after 0.18 seconds
[0m14:10:46.914534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7359a90ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7358ec98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7358eca090>]}
[0m14:10:46.914983 [debug] [MainThread]: Flushing usage events
[0m22:06:00.637856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1c902030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b19ac8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1b6a03b0>]}


============================== 22:06:00.683891 | bedef4cb-1ad2-417f-be82-9a9362b4c857 ==============================
[0m22:06:00.683891 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:00.684606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:00.793473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bedef4cb-1ad2-417f-be82-9a9362b4c857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b18a9ce30>]}
[0m22:06:00.808935 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1l8m1adi'
[0m22:06:00.809421 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:00.930972 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:00.931632 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:00.945755 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:00.949617 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:01.108276 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:01.108880 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:01.109448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bedef4cb-1ad2-417f-be82-9a9362b4c857', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b18937620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b18935070>]}
[0m22:06:01.109908 [info ] [MainThread]: 
[0m22:06:01.110423 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:01.133033 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54404795, "process_user_time": 1.567541, "process_kernel_time": 0.125443, "process_mem_max_rss": "99772", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m22:06:01.133685 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:01.133581 after 0.54 seconds
[0m22:06:01.134155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1d0d3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b18a9ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b198aff20>]}
[0m22:06:01.134615 [debug] [MainThread]: Flushing usage events
[0m22:06:02.776979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0151fc8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014f88b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014f538bf0>]}


============================== 22:06:02.780074 | 2f0c4291-55aa-4b83-8188-cc4f97e34e2f ==============================
[0m22:06:02.780074 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:02.780815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:02.981719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0150597e60>]}
[0m22:06:03.040660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0150259580>]}
[0m22:06:03.043116 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:06:03.087052 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:03.087804 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:03.088359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014f23b380>]}
[0m22:06:04.367355 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:04.367965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014f39d9a0>]}
[0m22:06:04.595199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:04.600403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014b15f3b0>]}
[0m22:06:04.717509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014b150530>]}
[0m22:06:04.718016 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:06:04.718541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014b1027b0>]}
[0m22:06:04.720343 [info ] [MainThread]: 
[0m22:06:04.721023 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:04.725637 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:04.760024 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:04.760483 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:04.760884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:05.194941 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.196952 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:05.198249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:05.199054 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:05.207887 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.208439 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:05.208968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:05.210488 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.211962 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.212392 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:05.212948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.213365 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.213749 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:05.214343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.215259 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:05.215692 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:05.216076 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:05.216648 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.217054 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:05.218275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:05.223983 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:05.224413 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:05.224789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:05.225399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.225801 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:05.226199 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:05.239692 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:05.241129 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:05.242360 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:05.242765 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:05.244889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014b186570>]}
[0m22:06:05.245425 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:05.245816 [debug] [MainThread]: On master: BEGIN
[0m22:06:05.246176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:05.246799 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:05.247200 [debug] [MainThread]: On master: COMMIT
[0m22:06:05.247602 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:05.247967 [debug] [MainThread]: On master: COMMIT
[0m22:06:05.248499 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:05.248898 [debug] [MainThread]: On master: Close
[0m22:06:05.249444 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:05.249957 [info ] [MainThread]: 
[0m22:06:05.272693 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:05.273276 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:05.273915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:06:05.274376 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:05.302081 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:05.302849 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:05.337910 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:05.338649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:58.046094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:58.046614 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:58.047229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.047691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:58.048114 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:58.048807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.051636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:58.052095 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:58.052777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.068994 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:58.069475 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:58.069905 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:58.071460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.076371 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:58.076827 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:58.078807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.081097 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:58.082595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013802d100>]}
[0m22:10:58.083266 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 292.81s]
[0m22:10:58.084118 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:58.084955 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:58.085529 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:58.086266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:58.086770 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:58.091645 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:58.092399 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:58.126708 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:58.127237 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250403221058120681"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:58.127727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:58.135828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.143692 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:58.144154 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:58.144857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.145295 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:58.145768 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250403221058120681'
      
      
      order by ordinal_position

  
[0m22:10:58.150091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.156392 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:58.156876 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:58.159236 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.166667 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:58.167128 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:58.170241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.188107 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:58.188797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:58.189246 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250403221058120681"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250403221058120681"
    )
  
[0m22:10:58.243497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.245474 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:58.245921 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:58.246356 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:58.254851 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:58.255780 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:58.257441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f0c4291-55aa-4b83-8188-cc4f97e34e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0120185b20>]}
[0m22:10:58.258107 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:58.258937 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:58.260206 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:58.260663 [debug] [MainThread]: On master: BEGIN
[0m22:10:58.261051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:58.261728 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:58.262132 [debug] [MainThread]: On master: COMMIT
[0m22:10:58.262545 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:58.262930 [debug] [MainThread]: On master: COMMIT
[0m22:10:58.263499 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:58.263917 [debug] [MainThread]: On master: Close
[0m22:10:58.264523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:58.264909 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:58.265315 [info ] [MainThread]: 
[0m22:10:58.265838 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 53.54 seconds (293.54s).
[0m22:10:58.266741 [debug] [MainThread]: Command end result
[0m22:10:58.290792 [info ] [MainThread]: 
[0m22:10:58.291362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:58.291821 [info ] [MainThread]: 
[0m22:10:58.292291 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:58.293228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 295.56628, "process_user_time": 4.625516, "process_kernel_time": 0.264315, "process_mem_max_rss": "295848", "process_in_blocks": "1184", "process_out_blocks": "94400"}
[0m22:10:58.293772 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:58.293672 after 295.57 seconds
[0m22:10:58.294208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014ffa0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014fa951f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01203036b0>]}
[0m22:10:58.294664 [debug] [MainThread]: Flushing usage events
[0m22:11:00.163656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dac768290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1daa0611c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da9ca8bf0>]}


============================== 22:11:00.166668 | 0afd3d55-ef01-4a52-a37f-27d894ad43ba ==============================
[0m22:11:00.166668 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:11:00.167341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:00.278107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0afd3d55-ef01-4a52-a37f-27d894ad43ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1daaeef620>]}
[0m22:11:00.297232 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18302737, "process_user_time": 1.342805, "process_kernel_time": 0.107064, "process_mem_max_rss": "98532", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:11:00.297798 [debug] [MainThread]: Command `dbt clean` succeeded at 22:11:00.297696 after 0.18 seconds
[0m22:11:00.298235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1daa7b53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1daa18dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da9da08c0>]}
[0m22:11:00.298737 [debug] [MainThread]: Flushing usage events
[0m06:02:10.978871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f045275dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0450255c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0450257aa0>]}


============================== 06:02:10.987416 | 786f7715-82b2-4369-be5a-b511a8409c31 ==============================
[0m06:02:10.987416 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.988159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.100223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '786f7715-82b2-4369-be5a-b511a8409c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044f84c320>]}
[0m06:02:11.117995 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0sg3br2y'
[0m06:02:11.118521 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.354907 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.355750 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.451679 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.455750 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.736084 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.736747 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:11.737369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '786f7715-82b2-4369-be5a-b511a8409c31', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044f556540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044fc276e0>]}
[0m06:02:11.737876 [info ] [MainThread]: 
[0m06:02:11.738366 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:11.740270 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8117961, "process_user_time": 1.660103, "process_kernel_time": 0.150465, "process_mem_max_rss": "100004", "process_in_blocks": "8400", "process_out_blocks": "5192"}
[0m06:02:11.740904 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.740787 after 0.81 seconds
[0m06:02:11.741356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044f90a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f045022ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f044f560a70>]}
[0m06:02:11.741849 [debug] [MainThread]: Flushing usage events
[0m06:02:13.692185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4feb808c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fe93c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa501166b10>]}


============================== 06:02:13.695239 | e850a74d-ace8-472e-9a5c-ab9c91b89c81 ==============================
[0m06:02:13.695239 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.695956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.904192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ff74da30>]}
[0m06:02:13.963851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fecf0980>]}
[0m06:02:13.966523 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:13.986866 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.987600 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.988164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fe57c080>]}
[0m06:02:15.286227 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:15.286907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fa7915b0>]}
[0m06:02:15.538098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:15.543640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fa5f6120>]}
[0m06:02:15.652579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fa638320>]}
[0m06:02:15.653194 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:15.653690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fa688380>]}
[0m06:02:15.655561 [info ] [MainThread]: 
[0m06:02:15.656293 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:15.661085 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:15.696419 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:15.696975 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:15.697381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:16.095537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.097486 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:16.098707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:16.099673 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:16.109376 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.109865 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:16.110258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.111634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.113225 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.113630 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:16.114237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.114631 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.115032 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:16.115616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.116573 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.116997 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:16.117367 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:16.117924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.118337 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:16.119648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:16.125954 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.126451 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:16.126867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:16.127819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.128229 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:16.128622 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:16.143265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:16.145024 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:16.146327 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:16.146760 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:16.149110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fa5f56d0>]}
[0m06:02:16.149638 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.150068 [debug] [MainThread]: On master: BEGIN
[0m06:02:16.150451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:16.151148 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.151558 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.151995 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.152372 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.152949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.153359 [debug] [MainThread]: On master: Close
[0m06:02:16.153917 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:16.154417 [info ] [MainThread]: 
[0m06:02:16.168859 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:16.169471 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:16.170150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:16.170601 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:16.199615 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:16.200526 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:16.236615 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:16.237452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:10.832101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.832622 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:07:10.833267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.833735 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.834174 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:07:10.834903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.837791 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.838254 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:07:10.838997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.855951 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:10.856536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.857009 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:07:10.858898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.864056 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:07:10.864522 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:07:10.866221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.868565 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:07:10.870165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d1ff5d60>]}
[0m06:07:10.870878 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 294.70s]
[0m06:07:10.871702 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:07:10.872743 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:07:10.873310 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:07:10.873909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:07:10.874363 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:07:10.879909 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:07:10.880654 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:07:10.916065 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.916620 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250404060710910028"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:07:10.917108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:10.925104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.932535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.933021 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:07:10.933702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.934237 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.934789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250404060710910028'
      
      
      order by ordinal_position

  
[0m06:07:10.939626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.946356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.946853 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:10.949501 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.957168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.957641 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:07:10.959973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:10.978340 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:07:10.979169 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:10.979633 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250404060710910028"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250404060710910028"
    )
  
[0m06:07:11.034927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:11.036900 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:11.037346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:07:11.037783 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:07:11.046951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:07:11.047945 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:07:11.049402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e850a74d-ace8-472e-9a5c-ab9c91b89c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d0353b90>]}
[0m06:07:11.050090 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.18s]
[0m06:07:11.050822 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:07:11.052126 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:11.052557 [debug] [MainThread]: On master: BEGIN
[0m06:07:11.052981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:11.053672 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:11.054110 [debug] [MainThread]: On master: COMMIT
[0m06:07:11.054496 [debug] [MainThread]: Using duckdb connection "master"
[0m06:07:11.054916 [debug] [MainThread]: On master: COMMIT
[0m06:07:11.055472 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:07:11.055929 [debug] [MainThread]: On master: Close
[0m06:07:11.056586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:11.057013 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:07:11.057430 [info ] [MainThread]: 
[0m06:07:11.057994 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 55.40 seconds (295.40s).
[0m06:07:11.059028 [debug] [MainThread]: Command end result
[0m06:07:11.084907 [info ] [MainThread]: 
[0m06:07:11.085590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:11.086147 [info ] [MainThread]: 
[0m06:07:11.086684 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:07:11.087777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 297.44568, "process_user_time": 5.159257, "process_kernel_time": 0.297418, "process_mem_max_rss": "311960", "process_in_blocks": "1184", "process_out_blocks": "94384"}
[0m06:07:11.088297 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:11.088198 after 297.45 seconds
[0m06:07:11.088756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fea0ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dc1db800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4fa577350>]}
[0m06:07:11.089201 [debug] [MainThread]: Flushing usage events
[0m06:07:13.678034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0ce4d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d76a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d76bd10>]}


============================== 06:07:13.681055 | e6e400a0-4ae1-4c34-843b-39969a97e5b6 ==============================
[0m06:07:13.681055 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:13.681764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:07:13.795279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e400a0-4ae1-4c34-843b-39969a97e5b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0cbed9a0>]}
[0m06:07:13.816710 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18854778, "process_user_time": 1.397546, "process_kernel_time": 0.114044, "process_mem_max_rss": "98528", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:13.817341 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:13.817230 after 0.19 seconds
[0m06:07:13.817830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0d7ab4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0cc136e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a0cc13da0>]}
[0m06:07:13.818298 [debug] [MainThread]: Flushing usage events
[0m14:05:18.680686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92176468d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9215d7d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921660e0f0>]}


============================== 14:05:18.689398 | 05a5b349-31b6-422f-a308-92e38f26ee6d ==============================
[0m14:05:18.689398 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.690088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.799584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05a5b349-31b6-422f-a308-92e38f26ee6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9215715b50>]}
[0m14:05:18.814997 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lc2g7waz'
[0m14:05:18.815486 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:18.982303 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:18.983057 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:18.995508 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:18.999566 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:19.050191 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:19.050743 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:19.051315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '05a5b349-31b6-422f-a308-92e38f26ee6d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92156f7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921544e510>]}
[0m14:05:19.051777 [info ] [MainThread]: 
[0m14:05:19.052302 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:19.075809 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4440676, "process_user_time": 1.565777, "process_kernel_time": 0.134238, "process_mem_max_rss": "99836", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m14:05:19.076495 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:19.076384 after 0.44 seconds
[0m14:05:19.076952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92168cef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92167d78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92156f7170>]}
[0m14:05:19.077431 [debug] [MainThread]: Flushing usage events
[0m14:05:20.653566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1463619b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146361a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1463df7620>]}


============================== 14:05:20.656590 | 3d613b56-2736-40ea-8b1f-309a904a2f1b ==============================
[0m14:05:20.656590 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:20.657271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.858469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146320a390>]}
[0m14:05:20.917090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1464fd0230>]}
[0m14:05:20.919564 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:05:20.949548 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:20.950307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:20.950842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1462f9f080>]}
[0m14:05:22.230342 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:22.231015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145efd8fe0>]}
[0m14:05:22.472200 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:22.478117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145efab6e0>]}
[0m14:05:22.563697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145effc7a0>]}
[0m14:05:22.564283 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:05:22.564775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145f075ee0>]}
[0m14:05:22.566634 [info ] [MainThread]: 
[0m14:05:22.567328 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:22.571941 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:22.608153 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:22.608608 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:22.609006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:23.108177 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.110353 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:23.111649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:23.112437 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:23.120366 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.120801 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:23.121222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.122217 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.123622 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.124029 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:23.124613 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.125009 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.125411 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:23.125994 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.126937 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:23.127363 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.127743 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:23.128347 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.128759 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:23.129978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:23.135676 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:23.136088 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:23.136486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.137103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.137524 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:23.137909 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:23.152023 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.153489 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:23.154718 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:23.155127 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:23.157585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1464fabef0>]}
[0m14:05:23.158097 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.158528 [debug] [MainThread]: On master: BEGIN
[0m14:05:23.158895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:23.159532 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.159933 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.160345 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.160718 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.161269 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.161669 [debug] [MainThread]: On master: Close
[0m14:05:23.162224 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:23.162694 [info ] [MainThread]: 
[0m14:05:23.172708 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:23.173317 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:23.173880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:05:23.174343 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:23.204372 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:23.205194 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:23.241212 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:23.241952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:14.489806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:14.490320 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:14.490932 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.491397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:14.491822 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:14.492532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.495517 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:14.496029 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:14.496736 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.513228 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:14.513689 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:14.514115 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:14.515809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.520701 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:14.521178 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:14.522735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.525022 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:14.526542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1464f75010>]}
[0m14:10:14.527234 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.35s]
[0m14:10:14.527969 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:14.528863 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:14.529444 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:14.530085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:14.530569 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:14.535429 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:14.536055 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:14.570807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:14.571363 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250404141014564756"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:14.571821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:14.579933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.587591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:14.588060 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:14.588709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.589164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:14.589598 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250404141014564756'
      
      
      order by ordinal_position

  
[0m14:10:14.594073 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.600657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:14.601184 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:14.603977 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.611694 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:14.612181 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:14.614936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.632895 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:14.633619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:14.634075 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250404141014564756"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250404141014564756"
    )
  
[0m14:10:14.682914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.684950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:14.685417 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:14.685833 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:14.693914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:14.694815 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:14.696542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d613b56-2736-40ea-8b1f-309a904a2f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1434090260>]}
[0m14:10:14.697234 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:14.697970 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:14.699407 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:14.699824 [debug] [MainThread]: On master: BEGIN
[0m14:10:14.700236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:14.700894 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:14.701332 [debug] [MainThread]: On master: COMMIT
[0m14:10:14.701712 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:14.702078 [debug] [MainThread]: On master: COMMIT
[0m14:10:14.702673 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:14.703071 [debug] [MainThread]: On master: Close
[0m14:10:14.703713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:14.704088 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:14.704535 [info ] [MainThread]: 
[0m14:10:14.704993 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.14 seconds (292.14s).
[0m14:10:14.705906 [debug] [MainThread]: Command end result
[0m14:10:14.730482 [info ] [MainThread]: 
[0m14:10:14.731027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:14.731504 [info ] [MainThread]: 
[0m14:10:14.731965 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:14.732891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.12936, "process_user_time": 5.121312, "process_kernel_time": 0.291074, "process_mem_max_rss": "307436", "process_in_blocks": "1184", "process_out_blocks": "94376"}
[0m14:10:14.733435 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:14.733334 after 294.13 seconds
[0m14:10:14.733864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1463df7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1467596d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146421c440>]}
[0m14:10:14.734313 [debug] [MainThread]: Flushing usage events
[0m14:10:16.501128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7bc3e11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7bd47ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7bc3e1310>]}


============================== 14:10:16.504167 | 60f74bc1-99f5-4b4f-a418-708bb25967e4 ==============================
[0m14:10:16.504167 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:16.504854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:16.615567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60f74bc1-99f5-4b4f-a418-708bb25967e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7be06db20>]}
[0m14:10:16.634973 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18372628, "process_user_time": 1.356496, "process_kernel_time": 0.089966, "process_mem_max_rss": "98724", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:16.635531 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:16.635428 after 0.18 seconds
[0m14:10:16.635962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0963da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7bc201be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7bc35b7d0>]}
[0m14:10:16.636414 [debug] [MainThread]: Flushing usage events
[0m22:05:51.197534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe566921c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe566cc9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5670121e0>]}


============================== 22:05:51.206020 | 0e74d3a5-867b-4d6f-be5e-716e56ba057c ==============================
[0m22:05:51.206020 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:51.206768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:51.317061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e74d3a5-867b-4d6f-be5e-716e56ba057c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe564f55340>]}
[0m22:05:51.333010 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ahywsl7x'
[0m22:05:51.333464 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:51.496706 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:51.497470 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:51.507115 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:51.511219 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:51.570094 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:51.570658 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:51.571259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0e74d3a5-867b-4d6f-be5e-716e56ba057c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe565106d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe564ef2d20>]}
[0m22:05:51.571743 [info ] [MainThread]: 
[0m22:05:51.572283 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:51.573970 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42599636, "process_user_time": 1.571712, "process_kernel_time": 0.129976, "process_mem_max_rss": "99964", "process_in_blocks": "8400", "process_out_blocks": "5184"}
[0m22:05:51.574508 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:51.574405 after 0.43 seconds
[0m22:05:51.574977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5653a0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe565106d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe566b40b60>]}
[0m22:05:51.575434 [debug] [MainThread]: Flushing usage events
[0m22:05:53.161820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe665bb5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66436e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66436fd10>]}


============================== 22:05:53.164853 | a08fa800-911b-49cb-9a7b-f6f8d5210fc4 ==============================
[0m22:05:53.164853 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:53.165496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:53.368022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65f92f4a0>]}
[0m22:05:53.427743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe663f24320>]}
[0m22:05:53.430247 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:53.464742 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:53.465465 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:53.466034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65f94b4a0>]}
[0m22:05:54.748502 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:54.749209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65f6e9b20>]}
[0m22:05:54.988168 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:54.993624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe663d52810>]}
[0m22:05:55.113301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65f670e00>]}
[0m22:05:55.113885 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:55.114380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65f666ed0>]}
[0m22:05:55.116243 [info ] [MainThread]: 
[0m22:05:55.116964 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:55.121666 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:55.156636 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:55.157132 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:55.157563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.627789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.629871 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:55.631129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:55.631855 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:55.640045 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.640505 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:55.640969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.641855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.643361 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.643812 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:55.644400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.644863 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.645271 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:55.645893 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.646877 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.647302 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.647706 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.648315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.648774 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:55.650421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:55.656440 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.656893 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:55.657278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.657933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.658350 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.658786 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:55.673546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.675067 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:55.676336 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:55.676768 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:55.679136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65f665760>]}
[0m22:05:55.679661 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.680095 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.680474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:55.681177 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.681587 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.681996 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.682375 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.682947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.683352 [debug] [MainThread]: On master: Close
[0m22:05:55.683886 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:55.684380 [info ] [MainThread]: 
[0m22:05:55.694153 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:55.694789 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:55.695475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:55.695968 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:55.723951 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:55.724737 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:55.762923 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:55.763686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:50.975039 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:50.975540 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:50.976225 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:50.976665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:50.977113 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:50.977816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:50.980628 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:50.981098 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:50.981783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:50.998697 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:50.999194 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:50.999633 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:51.000774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.005691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:51.006172 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:51.007342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.009659 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:51.011188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe665658ad0>]}
[0m22:10:51.011894 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 295.31s]
[0m22:10:51.012655 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:51.013490 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:51.014064 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:51.014679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:51.015340 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:51.020228 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:51.020887 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:51.055525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:51.056037 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250404221051049596"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:51.056495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:51.065299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.072933 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:51.073451 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:51.074130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.074571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:51.075056 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250404221051049596'
      
      
      order by ordinal_position

  
[0m22:10:51.079528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.085583 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:51.086077 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:51.088502 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.095951 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:51.096436 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:51.099863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.117812 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:51.118534 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:51.119084 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250404221051049596"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250404221051049596"
    )
  
[0m22:10:51.174443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.176458 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:51.176928 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:51.177352 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:51.184530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:51.185444 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:51.187082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a08fa800-911b-49cb-9a7b-f6f8d5210fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe64cf4f8f0>]}
[0m22:10:51.187811 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m22:10:51.188577 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:51.189987 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:51.190452 [debug] [MainThread]: On master: BEGIN
[0m22:10:51.190915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:51.191624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:51.192093 [debug] [MainThread]: On master: COMMIT
[0m22:10:51.192499 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:51.192929 [debug] [MainThread]: On master: COMMIT
[0m22:10:51.193503 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:51.193966 [debug] [MainThread]: On master: Close
[0m22:10:51.194570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:51.194989 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:51.195399 [info ] [MainThread]: 
[0m22:10:51.195916 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 56.08 seconds (296.08s).
[0m22:10:51.196891 [debug] [MainThread]: Command end result
[0m22:10:51.223084 [info ] [MainThread]: 
[0m22:10:51.223669 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:51.224188 [info ] [MainThread]: 
[0m22:10:51.224682 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:51.225655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 298.11343, "process_user_time": 5.162457, "process_kernel_time": 0.260376, "process_mem_max_rss": "300896", "process_in_blocks": "1184", "process_out_blocks": "94400"}
[0m22:10:51.226213 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:51.226109 after 298.11 seconds
[0m22:10:51.226654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66394d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe664774b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe663d0e5d0>]}
[0m22:10:51.227119 [debug] [MainThread]: Flushing usage events
[0m22:10:53.063537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08556e0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08587cacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085580b8c0>]}


============================== 22:10:53.066688 | f55ff643-5f82-45b5-a000-edcec00c73fe ==============================
[0m22:10:53.066688 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:53.067406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:53.179163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f55ff643-5f82-45b5-a000-edcec00c73fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08559c81a0>]}
[0m22:10:53.198894 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18519211, "process_user_time": 1.338602, "process_kernel_time": 0.119964, "process_mem_max_rss": "98840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:53.199421 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:53.199319 after 0.19 seconds
[0m22:10:53.199957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08564367b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085548a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0855489070>]}
[0m22:10:53.200389 [debug] [MainThread]: Flushing usage events
[0m06:02:03.007047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45f2160f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45ed5ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45ed88bf0>]}


============================== 06:02:03.027024 | 69548821-135e-4a81-81ee-2d912abafd52 ==============================
[0m06:02:03.027024 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.027700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:03.137542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69548821-135e-4a81-81ee-2d912abafd52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45f8e59a0>]}
[0m06:02:03.153298 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q0l7f0s9'
[0m06:02:03.153764 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:03.321092 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:03.321787 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:03.331591 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:03.335472 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:03.381654 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:03.382199 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:03.382731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69548821-135e-4a81-81ee-2d912abafd52', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45fdd1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45fdd2300>]}
[0m06:02:03.383207 [info ] [MainThread]: 
[0m06:02:03.383697 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:03.391080 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43375096, "process_user_time": 1.593708, "process_kernel_time": 0.121434, "process_mem_max_rss": "99724", "process_in_blocks": "8360", "process_out_blocks": "5176"}
[0m06:02:03.391606 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:03.391505 after 0.43 seconds
[0m06:02:03.392080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45f197170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45f781190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45ee06d80>]}
[0m06:02:03.392511 [debug] [MainThread]: Flushing usage events
[0m06:02:05.077525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2033d9f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20336323f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2034ea2900>]}


============================== 06:02:05.080516 | 7506d8dd-b07c-4981-a3f1-d38d44a13f93 ==============================
[0m06:02:05.080516 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.081179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:05.282741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2032a6e2a0>]}
[0m06:02:05.342077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2032a8e2d0>]}
[0m06:02:05.344639 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m06:02:05.366501 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:05.367235 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:05.367774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2032950d70>]}
[0m06:02:06.654482 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:06.655156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202eb35f70>]}
[0m06:02:06.881865 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:06.887192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202e9da690>]}
[0m06:02:06.999436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202e96afc0>]}
[0m06:02:06.999974 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m06:02:07.000511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20369269c0>]}
[0m06:02:07.002651 [info ] [MainThread]: 
[0m06:02:07.003439 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:07.008131 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:07.042679 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:07.043149 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:07.043551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:07.503256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.505124 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:07.506255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:07.506859 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:07.514609 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:07.515065 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:07.515501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:07.516512 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.518067 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:07.518520 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:07.519113 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.519511 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:07.519963 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:07.520585 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.521558 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:07.522026 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:07.522474 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:07.523126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.523589 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:07.524973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:07.531394 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:07.531864 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:07.532267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:07.532900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.533342 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:07.533727 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:07.547281 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:07.548760 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:07.550008 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:07.550419 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:07.552594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202e801e80>]}
[0m06:02:07.553125 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:07.553516 [debug] [MainThread]: On master: BEGIN
[0m06:02:07.553882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:07.554511 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:07.554915 [debug] [MainThread]: On master: COMMIT
[0m06:02:07.555322 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:07.555694 [debug] [MainThread]: On master: COMMIT
[0m06:02:07.556237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:07.556637 [debug] [MainThread]: On master: Close
[0m06:02:07.557179 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:07.557687 [info ] [MainThread]: 
[0m06:02:07.573421 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:07.574049 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:07.574702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m06:02:07.575176 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:07.603253 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:07.604014 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:07.639739 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:07.640656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:59.517030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.517549 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:06:59.518201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.518648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.519097 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:06:59.519794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.522792 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.523261 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:06:59.523933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.540428 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.540902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.541363 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:06:59.542645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.547553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:06:59.548042 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:06:59.549530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.551838 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:06:59.553366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2034970bc0>]}
[0m06:06:59.554063 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 291.98s]
[0m06:06:59.554893 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:06:59.555815 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:06:59.556495 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:06:59.557160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:06:59.557609 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:06:59.562545 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:06:59.563220 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:06:59.598012 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.598517 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250405060659592061"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:06:59.599015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:59.606902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.614300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.614757 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:06:59.615375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.615822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.616283 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250405060659592061'
      
      
      order by ordinal_position

  
[0m06:06:59.620539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.626625 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.627115 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:59.629399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.636823 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.637314 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:06:59.640606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.658421 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:06:59.659123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.659583 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250405060659592061"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250405060659592061"
    )
  
[0m06:06:59.708902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.710910 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:59.711381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:06:59.711822 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:06:59.719544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:06:59.720461 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:06:59.721970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7506d8dd-b07c-4981-a3f1-d38d44a13f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ffadc5ac0>]}
[0m06:06:59.722654 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m06:06:59.723409 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:06:59.724679 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:59.725133 [debug] [MainThread]: On master: BEGIN
[0m06:06:59.725520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:06:59.726179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:59.726597 [debug] [MainThread]: On master: COMMIT
[0m06:06:59.727009 [debug] [MainThread]: Using duckdb connection "master"
[0m06:06:59.727389 [debug] [MainThread]: On master: COMMIT
[0m06:06:59.727942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:06:59.728359 [debug] [MainThread]: On master: Close
[0m06:06:59.728987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:06:59.729372 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:06:59.729781 [info ] [MainThread]: 
[0m06:06:59.730299 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 52.73 seconds (292.73s).
[0m06:06:59.731304 [debug] [MainThread]: Command end result
[0m06:06:59.755773 [info ] [MainThread]: 
[0m06:06:59.756402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:06:59.756942 [info ] [MainThread]: 
[0m06:06:59.757489 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:06:59.758469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 294.73056, "process_user_time": 4.687142, "process_kernel_time": 0.264064, "process_mem_max_rss": "288916", "process_in_blocks": "1184", "process_out_blocks": "94384"}
[0m06:06:59.759018 [debug] [MainThread]: Command `dbt run` succeeded at 06:06:59.758878 after 294.73 seconds
[0m06:06:59.759457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2033d9ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202d3be270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2033055d00>]}
[0m06:06:59.759883 [debug] [MainThread]: Flushing usage events
[0m06:07:01.627621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a2d5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184aecfec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a2d52e0>]}


============================== 06:07:01.630629 | 7368fe10-3a40-478a-b629-fde257adbadd ==============================
[0m06:07:01.630629 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:07:01.631299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:07:01.741123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7368fe10-3a40-478a-b629-fde257adbadd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a684bf0>]}
[0m06:07:01.760210 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18164408, "process_user_time": 1.329985, "process_kernel_time": 0.118909, "process_mem_max_rss": "98816", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:07:01.760734 [debug] [MainThread]: Command `dbt clean` succeeded at 06:07:01.760634 after 0.18 seconds
[0m06:07:01.761188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a2d5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a3fed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f184a20af30>]}
[0m06:07:01.761616 [debug] [MainThread]: Flushing usage events
[0m14:04:46.550005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482bba0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482b0bd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482aa14890>]}


============================== 14:04:46.558245 | 2db72dc3-fae3-4289-8845-e29a3e25cc32 ==============================
[0m14:04:46.558245 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:46.558939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:46.668331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2db72dc3-fae3-4289-8845-e29a3e25cc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482aa59610>]}
[0m14:04:46.683312 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l1kfku1n'
[0m14:04:46.683758 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:46.854244 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:46.854930 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:46.892042 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:46.895932 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:47.173550 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:47.174068 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:47.174574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2db72dc3-fae3-4289-8845-e29a3e25cc32', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a8d5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a79a9c0>]}
[0m14:04:47.175051 [info ] [MainThread]: 
[0m14:04:47.175529 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:47.177093 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6765421, "process_user_time": 1.568, "process_kernel_time": 0.126, "process_mem_max_rss": "99744", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m14:04:47.177596 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:47.177499 after 0.68 seconds
[0m14:04:47.178049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482bba0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482aa59610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482edbbda0>]}
[0m14:04:47.178469 [debug] [MainThread]: Flushing usage events
[0m14:04:48.831945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc63d6f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc646a94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc65910f50>]}


============================== 14:04:48.834863 | a47c0365-fa67-488b-bccb-e5aced55b5f1 ==============================
[0m14:04:48.834863 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:48.835549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.038375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6374f2c0>]}
[0m14:04:49.096943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc63872780>]}
[0m14:04:49.099350 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:04:49.143436 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:49.144145 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:49.144672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc63866300>]}
[0m14:04:50.426966 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:50.427619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5f786f60>]}
[0m14:04:50.650929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:50.656088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc63887ec0>]}
[0m14:04:50.764183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5f7818b0>]}
[0m14:04:50.764679 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m14:04:50.765196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5f765f40>]}
[0m14:04:50.767012 [info ] [MainThread]: 
[0m14:04:50.767683 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:50.772334 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:50.806561 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:50.807020 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:50.807420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:51.246929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:51.250023 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:51.251807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:51.252968 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:51.260631 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:51.261086 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:51.261477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:51.262522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:51.263940 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:51.264352 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:51.264940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:51.265346 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:51.265726 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:51.266335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:51.267279 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:51.267689 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:51.268107 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:51.268667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:51.269110 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:51.270316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:51.275953 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:51.276370 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:51.276744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:51.277394 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:51.277793 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:51.278207 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:51.293126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:51.294568 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:51.295779 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:51.296208 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:51.298392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc5f7fdd00>]}
[0m14:04:51.298956 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:51.299361 [debug] [MainThread]: On master: BEGIN
[0m14:04:51.299732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:51.300357 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:51.300765 [debug] [MainThread]: On master: COMMIT
[0m14:04:51.301171 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:51.301542 [debug] [MainThread]: On master: COMMIT
[0m14:04:51.302079 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:51.302482 [debug] [MainThread]: On master: Close
[0m14:04:51.303030 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:51.303546 [info ] [MainThread]: 
[0m14:04:51.313601 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:51.314221 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:51.314865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m14:04:51.315334 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:51.343499 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:51.344263 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:51.380179 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:51.380930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:22.165837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:22.166354 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:10:22.167001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.167447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:22.167887 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:10:22.168576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.171386 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:22.171844 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:10:22.172531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.188804 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:22.189290 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:22.189726 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:10:22.191597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.196469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:10:22.196950 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:10:22.198102 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.200368 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:10:22.201848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc35fe2270>]}
[0m14:10:22.202535 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 330.89s]
[0m14:10:22.203326 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:10:22.204136 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:10:22.204686 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:10:22.205392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:10:22.205863 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:10:22.210814 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:10:22.211456 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:10:22.245961 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:22.246452 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250405141022240063"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:10:22.246932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:22.254534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.261671 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:22.262197 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:10:22.262786 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.263243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:22.263670 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250405141022240063'
      
      
      order by ordinal_position

  
[0m14:10:22.268072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.273901 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:22.274383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:22.277520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.284868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:22.285347 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:10:22.287987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.305731 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:10:22.306437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:22.306913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250405141022240063"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250405141022240063"
    )
  
[0m14:10:22.359453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.361495 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:22.361973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:10:22.362405 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:10:22.369779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:10:22.370678 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:10:22.372305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a47c0365-fa67-488b-bccb-e5aced55b5f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc34266c90>]}
[0m14:10:22.372993 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.17s]
[0m14:10:22.373719 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:10:22.375093 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:22.375517 [debug] [MainThread]: On master: BEGIN
[0m14:10:22.375928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:22.376570 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:22.377014 [debug] [MainThread]: On master: COMMIT
[0m14:10:22.377401 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:22.377774 [debug] [MainThread]: On master: COMMIT
[0m14:10:22.378345 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:10:22.378743 [debug] [MainThread]: On master: Close
[0m14:10:22.379377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:22.379759 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:10:22.380184 [info ] [MainThread]: 
[0m14:10:22.380671 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 5 minutes and 31.61 seconds (331.61s).
[0m14:10:22.381648 [debug] [MainThread]: Command end result
[0m14:10:22.405506 [info ] [MainThread]: 
[0m14:10:22.406128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:22.406655 [info ] [MainThread]: 
[0m14:10:22.407209 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:22.408189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 333.62555, "process_user_time": 5.005879, "process_kernel_time": 0.275103, "process_mem_max_rss": "309404", "process_in_blocks": "1184", "process_out_blocks": "94376"}
[0m14:10:22.408704 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:22.408605 after 333.63 seconds
[0m14:10:22.409165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6449ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc401ca3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc43fbff50>]}
[0m14:10:22.409593 [debug] [MainThread]: Flushing usage events
[0m14:10:24.329717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe562f5e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5626929f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe562f5fb60>]}


============================== 14:10:24.332624 | 2459f16f-a371-4630-94bc-76ecd8da4624 ==============================
[0m14:10:24.332624 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:10:24.333312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:24.443980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2459f16f-a371-4630-94bc-76ecd8da4624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56253e2a0>]}
[0m14:10:24.463063 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18271254, "process_user_time": 1.328546, "process_kernel_time": 0.111045, "process_mem_max_rss": "98776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:24.463559 [debug] [MainThread]: Command `dbt clean` succeeded at 14:10:24.463460 after 0.18 seconds
[0m14:10:24.463997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56369f2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56369ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5633368a0>]}
[0m14:10:24.464413 [debug] [MainThread]: Flushing usage events
[0m22:05:35.968749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f199b484530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f199894ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19992bd4c0>]}


============================== 22:05:35.976592 | 1c072327-11bf-4d74-b2e2-15abd52b60c6 ==============================
[0m22:05:35.976592 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.977298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:36.085324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c072327-11bf-4d74-b2e2-15abd52b60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1998662f60>]}
[0m22:05:36.100311 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dzvpglnh'
[0m22:05:36.100758 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:36.265307 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:36.265917 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:36.276000 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:36.279676 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:36.337843 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:36.338380 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:36.338901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1c072327-11bf-4d74-b2e2-15abd52b60c6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19986c1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19986c0ce0>]}
[0m22:05:36.339368 [info ] [MainThread]: 
[0m22:05:36.339844 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:36.346869 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42691845, "process_user_time": 1.573572, "process_kernel_time": 0.14496, "process_mem_max_rss": "99620", "process_in_blocks": "8392", "process_out_blocks": "5192"}
[0m22:05:36.347389 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:36.347291 after 0.43 seconds
[0m22:05:36.347804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19997ac680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19985bff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f199a5442f0>]}
[0m22:05:36.348255 [debug] [MainThread]: Flushing usage events
[0m22:05:37.933391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd5124b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cf7cc6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd66b380>]}


============================== 22:05:37.936284 | a058e337-1f0c-468b-90ab-2dd56f44a30b ==============================
[0m22:05:37.936284 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.936997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.134055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cddabec0>]}
[0m22:05:38.192106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd861a00>]}
[0m22:05:38.194503 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m22:05:38.216196 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:38.216882 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:38.217442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cca680b0>]}
[0m22:05:39.493832 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:39.494496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c892aea0>]}
[0m22:05:39.717026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:39.722190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c8983800>]}
[0m22:05:39.820011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c896ecf0>]}
[0m22:05:39.820514 [info ] [MainThread]: Found 2 models, 1 test, 523 macros
[0m22:05:39.821013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c89b3770>]}
[0m22:05:39.822855 [info ] [MainThread]: 
[0m22:05:39.823536 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:39.828118 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:39.861743 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:39.862205 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:39.862610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:40.338040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.340012 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:40.341423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:40.342188 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:40.351379 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.351816 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:40.352237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.353258 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.354675 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.355099 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:40.355670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.356095 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.356471 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:40.357088 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.358029 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.358428 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.358804 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.359379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.359783 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:40.361024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:40.366618 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.367057 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:40.367437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.368067 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.368469 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.368857 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:40.382433 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.383875 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:40.385091 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:40.385499 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:40.387655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c896ca10>]}
[0m22:05:40.388187 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.388578 [debug] [MainThread]: On master: BEGIN
[0m22:05:40.388942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:40.389544 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.389946 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.390345 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.390709 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.391245 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.391638 [debug] [MainThread]: On master: Close
[0m22:05:40.392176 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:40.392688 [info ] [MainThread]: 
[0m22:05:40.413269 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.413850 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.414508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_petro_main, now model.petro.stg_petro)
[0m22:05:40.414950 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.442694 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.443445 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.479039 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.479760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:30.044386 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:30.044880 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:10:30.045533 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.046003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:30.046443 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:10:30.047154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.049988 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:30.050442 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:10:30.051126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.067452 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:30.067921 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:30.068374 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:10:30.069611 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.074501 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:10:30.074964 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:10:30.076135 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.078414 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:10:30.079904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85ce964e30>]}
[0m22:10:30.080610 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 289.66s]
[0m22:10:30.081376 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:10:30.082307 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:10:30.082864 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:10:30.083480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:10:30.083927 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:10:30.088840 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:10:30.089478 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:10:30.124038 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:30.124533 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20250405221030118065"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:10:30.125008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:30.132058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.139225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:30.139678 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:10:30.140281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.140717 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:30.141225 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20250405221030118065'
      
      
      order by ordinal_position

  
[0m22:10:30.145564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.151474 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:30.151954 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:30.154207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.161570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:30.162060 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:10:30.164321 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.182141 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:10:30.182787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:30.183277 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20250405221030118065"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20250405221030118065"
    )
  
[0m22:10:30.235604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.237615 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:30.238112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:10:30.238542 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:10:30.245817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:10:30.246723 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:10:30.248216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a058e337-1f0c-468b-90ab-2dd56f44a30b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f859cd056a0>]}
[0m22:10:30.248897 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.16s]
[0m22:10:30.249663 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:10:30.250960 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:30.251421 [debug] [MainThread]: On master: BEGIN
[0m22:10:30.251808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:30.252488 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:30.252901 [debug] [MainThread]: On master: COMMIT
[0m22:10:30.253321 [debug] [MainThread]: Using duckdb connection "master"
[0m22:10:30.253693 [debug] [MainThread]: On master: COMMIT
[0m22:10:30.254257 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:10:30.254660 [debug] [MainThread]: On master: Close
[0m22:10:30.255304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:30.255687 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:10:30.256121 [info ] [MainThread]: 
[0m22:10:30.256616 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 4 minutes and 50.43 seconds (290.43s).
[0m22:10:30.257563 [debug] [MainThread]: Command end result
[0m22:10:30.282132 [info ] [MainThread]: 
[0m22:10:30.282710 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:30.283218 [info ] [MainThread]: 
[0m22:10:30.283717 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:10:30.284679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 292.3999, "process_user_time": 5.03748, "process_kernel_time": 0.230342, "process_mem_max_rss": "304168", "process_in_blocks": "1184", "process_out_blocks": "94408"}
[0m22:10:30.285221 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:30.285120 after 292.40 seconds
[0m22:10:30.285652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85cd1ca6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bc813290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f859df55580>]}
[0m22:10:30.286105 [debug] [MainThread]: Flushing usage events
[0m22:10:32.133613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4aa57ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a9e8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d49f47830>]}


============================== 22:10:32.136499 | 570583f9-a7cd-4528-82ea-0a1240baa1b2 ==============================
[0m22:10:32.136499 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:10:32.137208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:32.246434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '570583f9-a7cd-4528-82ea-0a1240baa1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d49aff4d0>]}
[0m22:10:32.265371 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18051416, "process_user_time": 1.30115, "process_kernel_time": 0.113925, "process_mem_max_rss": "98776", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:10:32.265864 [debug] [MainThread]: Command `dbt clean` succeeded at 22:10:32.265765 after 0.18 seconds
[0m22:10:32.266307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d49bf5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a1170b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d49ad92b0>]}
[0m22:10:32.266726 [debug] [MainThread]: Flushing usage events
