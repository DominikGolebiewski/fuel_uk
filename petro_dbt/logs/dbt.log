[0m06:02:09.649918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad8e7b0>]}
[0m06:02:09.651722 [info ] [MainThread]: 
[0m06:02:09.652425 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.657165 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.692544 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.693029 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:09.693441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.261445 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.263007 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.265159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.265719 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.272928 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.273363 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.273763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.280185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.281687 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.282088 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.282625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.283017 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.283390 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.283977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.284929 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.285331 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.285703 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.286238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.286642 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.288539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.295660 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.296071 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.296485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.302644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.303059 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.303459 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.327573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.329185 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.330451 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.330870 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.334493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303b80dd0>]}
[0m06:02:10.335038 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.335437 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.335813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.342252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.342680 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343067 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.343443 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.343976 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.344414 [debug] [MainThread]: On master: Close
[0m06:02:10.345736 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.346281 [info ] [MainThread]: 
[0m06:02:10.372933 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.373536 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.374273 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.374721 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.400593 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.401345 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.436877 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.437661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:18.192676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.193188 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:18.193857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.194307 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.194739 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:18.195442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.198374 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.198855 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:18.199531 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.220328 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.220827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.221263 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:18.223188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.228133 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:18.228625 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:18.229823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.232119 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:18.261362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93034fe930>]}
[0m06:02:18.262116 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.89s]
[0m06:02:18.262874 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:18.263886 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:18.264490 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:18.265076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:18.265531 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:18.270840 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:18.271496 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:18.305170 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.305686 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027060218299187"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:18.306159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:18.320021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.327426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.327886 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:18.328570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.329034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.329476 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027060218299187'
      
      
      order by ordinal_position

  
[0m06:02:18.349766 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.356284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.356796 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.360937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.368443 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.368929 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:18.371629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.389509 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:18.390200 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.390664 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027060218299187"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027060218299187"
    )
  
[0m06:02:18.422636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.424602 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.425070 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:18.425492 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:18.433663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:18.434559 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:18.626046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b984407-dac4-4939-a612-47febfcaedc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b79650d0>]}
[0m06:02:18.626860 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:18.627614 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:18.629128 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.629594 [debug] [MainThread]: On master: BEGIN
[0m06:02:18.630015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:18.637134 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.637802 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.638440 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:18.639067 [debug] [MainThread]: On master: COMMIT
[0m06:02:18.639938 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:18.640626 [debug] [MainThread]: On master: Close
[0m06:02:18.642446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:18.642881 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:18.643278 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:18.643731 [info ] [MainThread]: 
[0m06:02:18.644274 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m06:02:18.645340 [debug] [MainThread]: Command end result
[0m06:02:18.673207 [info ] [MainThread]: 
[0m06:02:18.673854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:18.674389 [info ] [MainThread]: 
[0m06:02:18.674937 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:18.675949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.988357, "process_user_time": 5.635993, "process_kernel_time": 0.319999, "process_mem_max_rss": "291348", "process_in_blocks": "3808", "process_out_blocks": "116200"}
[0m06:02:18.676626 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:18.676515 after 10.99 seconds
[0m06:02:18.677137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9303398590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad60f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9302a747d0>]}
[0m06:02:18.677620 [debug] [MainThread]: Flushing usage events
[0m06:02:20.358883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b792570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97c0c3b60>]}


============================== 06:02:20.361679 | 4262b812-ebd9-4f29-9045-c1575eadd653 ==============================
[0m06:02:20.361679 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.362399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.503733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4262b812-ebd9-4f29-9045-c1575eadd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b6f6b40>]}
[0m06:02:20.520439 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20978114, "process_user_time": 1.4195, "process_kernel_time": 0.087969, "process_mem_max_rss": "92276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:20.521010 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:20.520908 after 0.21 seconds
[0m06:02:20.521433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97ba5f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b5b1070>]}
[0m06:02:20.521850 [debug] [MainThread]: Flushing usage events
[0m14:05:16.133926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa339460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa45a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa33bf20>]}


============================== 14:05:16.141725 | 78023bc8-b36b-4e15-8dbb-9e1204979c39 ==============================
[0m14:05:16.141725 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.142500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.286222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa00b260>]}
[0m14:05:16.299845 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-099ghjmk'
[0m14:05:16.300322 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.326602 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.327230 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.338031 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.341870 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.557757 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.558339 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.558902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '78023bc8-b36b-4e15-8dbb-9e1204979c39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1a2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea9f03d10>]}
[0m14:05:16.559370 [info ] [MainThread]: 
[0m14:05:16.559857 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.561652 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47698292, "process_user_time": 1.583668, "process_kernel_time": 0.134611, "process_mem_max_rss": "93512", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:16.562249 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.562145 after 0.48 seconds
[0m14:05:16.562742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa3371d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa1dc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab1b6b40>]}
[0m14:05:16.563165 [debug] [MainThread]: Flushing usage events
[0m14:05:18.540090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f7320>]}


============================== 14:05:18.543201 | cefd4d58-25b2-4a5b-9398-c93bead4f291 ==============================
[0m14:05:18.543201 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.543966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.793095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2298e660>]}
[0m14:05:18.853624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29865af0>]}
[0m14:05:18.856407 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.931958 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.932772 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.933327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e298b3800>]}
[0m14:05:20.175385 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:20.176098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227d0350>]}
[0m14:05:20.363487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:20.369172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e227331d0>]}
[0m14:05:20.510975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2218fb90>]}
[0m14:05:20.511585 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:20.512131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e222e19a0>]}
[0m14:05:20.514002 [info ] [MainThread]: 
[0m14:05:20.514805 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:20.519774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:20.556651 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:20.557188 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:20.557627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.007736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.009411 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:21.011778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:21.012363 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:21.019736 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.020177 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:21.020622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.027359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.028853 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.029264 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:21.029826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.030221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.030640 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:21.031213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.032133 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.032551 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.032925 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.033465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.033873 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:21.036016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:21.043578 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.043991 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:21.044366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.050268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.050726 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.051125 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:21.075283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.077179 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:21.078596 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:21.079048 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:21.083255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e2bf11340>]}
[0m14:05:21.083816 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.084226 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.084617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:21.091686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.092129 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.092543 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.092930 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.093567 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.093987 [debug] [MainThread]: On master: Close
[0m14:05:21.095895 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:21.096411 [info ] [MainThread]: 
[0m14:05:21.106564 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:21.107237 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:21.107981 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:21.108445 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:21.135946 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:21.136902 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:21.174126 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:21.175093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:30.068868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.069469 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.070311 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.070822 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.071273 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.072130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.075574 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.076049 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.076828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.100428 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.101171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.101686 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.114045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.120552 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.121056 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:30.145156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.149021 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.208242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e221b8a70>]}
[0m14:05:30.209234 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.10s]
[0m14:05:30.210238 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.211494 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.212410 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.213314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.213879 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.223198 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.224161 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.268421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.269063 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027140530261605"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.269580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.287902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.296323 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.296837 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.297567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.298034 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.298505 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027140530261605'
      
      
      order by ordinal_position

  
[0m14:05:30.323366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.334147 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.334937 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.339807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.351373 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.351860 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.354832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.373289 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.374027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.374561 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027140530261605"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027140530261605"
    )
  
[0m14:05:30.411051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.413283 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.413799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.414246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.561348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.562508 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:30.754709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cefd4d58-25b2-4a5b-9398-c93bead4f291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d56b40>]}
[0m14:05:30.755538 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.54s]
[0m14:05:30.756296 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:30.757739 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.758217 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.758757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:30.765582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.766063 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.766542 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:30.766967 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.767586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:30.768038 [debug] [MainThread]: On master: Close
[0m14:05:30.769509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:30.769940 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:30.770339 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:30.770884 [info ] [MainThread]: 
[0m14:05:30.771481 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m14:05:30.772614 [debug] [MainThread]: Command end result
[0m14:05:30.801005 [info ] [MainThread]: 
[0m14:05:30.801753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:30.802365 [info ] [MainThread]: 
[0m14:05:30.803009 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:30.804135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.313357, "process_user_time": 5.773754, "process_kernel_time": 0.323874, "process_mem_max_rss": "302296", "process_in_blocks": "3808", "process_out_blocks": "116696"}
[0m14:05:30.804785 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:30.804673 after 12.31 seconds
[0m14:05:30.805288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e299f6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e29eb4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de2d9f7a0>]}
[0m14:05:30.805783 [debug] [MainThread]: Flushing usage events
[0m14:05:32.764828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f962660>]}


============================== 14:05:32.767764 | 71eccba0-e1bc-4284-8aef-e2ee42a7aeeb ==============================
[0m14:05:32.767764 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:32.768481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:32.908977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71eccba0-e1bc-4284-8aef-e2ee42a7aeeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fb3b200>]}
[0m14:05:32.925760 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20939516, "process_user_time": 1.402786, "process_kernel_time": 0.107906, "process_mem_max_rss": "92196", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:32.926347 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:32.926246 after 0.21 seconds
[0m14:05:32.926826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57406c8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573fa0fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f9aa060>]}
[0m14:05:32.927248 [debug] [MainThread]: Flushing usage events
[0m22:06:37.818970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd1479340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd185d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3822270>]}


============================== 22:06:37.826466 | 90ac5466-6416-4b1c-85b1-1e85a1d0e0ad ==============================
[0m22:06:37.826466 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:37.827200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:37.979993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd147bd40>]}
[0m22:06:37.994808 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mnavaskj'
[0m22:06:37.995340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:38.062625 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:38.063472 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:38.098596 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:38.102810 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:38.462267 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:38.462926 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:38.463490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '90ac5466-6416-4b1c-85b1-1e85a1d0e0ad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12afc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd12ac3e0>]}
[0m22:06:38.463984 [info ] [MainThread]: 
[0m22:06:38.464510 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:38.466498 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6955928, "process_user_time": 1.603294, "process_kernel_time": 0.140288, "process_mem_max_rss": "93640", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:38.467094 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:38.466989 after 0.70 seconds
[0m22:06:38.467535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd18ea360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd11efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd117e7e0>]}
[0m22:06:38.467969 [debug] [MainThread]: Flushing usage events
[0m22:06:40.277643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219afef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219cb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3219af6b0>]}


============================== 22:06:40.280812 | 33dad61b-4949-4309-8e77-a24b0795d7a0 ==============================
[0m22:06:40.280812 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:40.281603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:40.546518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa320ef8410>]}
[0m22:06:40.609342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321abfef0>]}
[0m22:06:40.612131 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:40.632020 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:40.632875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:40.633460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa321c05af0>]}
[0m22:06:41.875403 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:41.876121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31987a000>]}
[0m22:06:42.059627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:42.065035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319f3ad80>]}
[0m22:06:42.193864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3197a8440>]}
[0m22:06:42.194451 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:42.194931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319817ce0>]}
[0m22:06:42.196701 [info ] [MainThread]: 
[0m22:06:42.197466 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:42.202403 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:42.238996 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:42.239516 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:42.239922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:42.932482 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:42.934054 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:42.936259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:42.936887 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:42.944032 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.944502 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:42.944898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.951491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.953061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.953476 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:42.954021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.954423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.954799 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:42.955418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.956386 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.956786 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:42.957159 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:42.957699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.958106 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:42.960208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:42.967557 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.967981 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:42.968397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:42.974563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:42.974999 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:42.975403 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:42.999698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:43.001525 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:43.002845 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:43.003264 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:43.007359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3215ff860>]}
[0m22:06:43.007903 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.008343 [debug] [MainThread]: On master: BEGIN
[0m22:06:43.008740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:43.016047 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.016639 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.017044 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:43.017436 [debug] [MainThread]: On master: COMMIT
[0m22:06:43.018005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:43.018436 [debug] [MainThread]: On master: Close
[0m22:06:43.020478 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:43.021041 [info ] [MainThread]: 
[0m22:06:43.030895 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:43.031554 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:43.032269 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:43.032768 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:43.060219 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:43.061163 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:43.098459 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:43.099537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:54.141664 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.142226 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:54.142945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.143402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.143843 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:54.144705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.147879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.148383 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:54.149198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.171129 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.171738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.172198 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:54.175132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.180832 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:54.181370 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:54.182898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.185439 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:54.216838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31970bb00>]}
[0m22:06:54.217685 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.18s]
[0m22:06:54.218484 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:54.219513 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:54.220082 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:54.220817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:54.221283 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:54.226786 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:54.227500 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:54.262615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.263238 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241027220654256372"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:54.263725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:54.279952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.288496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.289063 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:54.289882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.290335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.290781 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241027220654256372'
      
      
      order by ordinal_position

  
[0m22:06:54.312563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.319878 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.320447 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.323597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.331691 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.332216 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:54.335620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.354596 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:54.355433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.355923 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241027220654256372"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241027220654256372"
    )
  
[0m22:06:54.389710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.391779 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.392246 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:54.392704 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:54.402481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:54.403507 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:55.415250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dad61b-4949-4309-8e77-a24b0795d7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de439610>]}
[0m22:06:55.416103 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 1.19s]
[0m22:06:55.416903 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:55.418423 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.418930 [debug] [MainThread]: On master: BEGIN
[0m22:06:55.419397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:55.426669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.427244 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.427692 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:55.428122 [debug] [MainThread]: On master: COMMIT
[0m22:06:55.428761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:55.429217 [debug] [MainThread]: On master: Close
[0m22:06:55.430946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:55.431384 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:55.431787 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:55.432256 [info ] [MainThread]: 
[0m22:06:55.432907 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 13.23 seconds (13.23s).
[0m22:06:55.434057 [debug] [MainThread]: Command end result
[0m22:06:55.462748 [info ] [MainThread]: 
[0m22:06:55.463515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:55.464121 [info ] [MainThread]: 
[0m22:06:55.464761 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:55.465895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.238665, "process_user_time": 6.932973, "process_kernel_time": 0.301608, "process_mem_max_rss": "356188", "process_in_blocks": "3808", "process_out_blocks": "130560"}
[0m22:06:55.466559 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:55.466442 after 15.24 seconds
[0m22:06:55.467080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3214d7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32160c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2de4d2f60>]}
[0m22:06:55.467567 [debug] [MainThread]: Flushing usage events
[0m22:06:57.437108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e375f860>]}


============================== 22:06:57.440420 | f3b777d2-4608-4fbe-ac6d-442a18d0d0d2 ==============================
[0m22:06:57.440420 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:57.441225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:57.601557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b777d2-4608-4fbe-ac6d-442a18d0d0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e2c5f710>]}
[0m22:06:57.619386 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23291159, "process_user_time": 1.489889, "process_kernel_time": 0.100126, "process_mem_max_rss": "91996", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:57.620025 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:57.619911 after 0.23 seconds
[0m22:06:57.620553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3348140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e32497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e31f3980>]}
[0m22:06:57.621025 [debug] [MainThread]: Flushing usage events
[0m06:02:18.359027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1569605d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15695a1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567f94fe0>]}


============================== 06:02:18.367875 | c20095a7-de61-4d0b-86b7-e546f68a3dc1 ==============================
[0m06:02:18.367875 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.368546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.506673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20095a7-de61-4d0b-86b7-e546f68a3dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156704ae70>]}
[0m06:02:18.520055 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8g6ssrag'
[0m06:02:18.520511 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:18.585227 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:18.585906 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:18.609355 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:18.613273 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:18.686458 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:18.686971 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:18.687480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c20095a7-de61-4d0b-86b7-e546f68a3dc1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1566f04e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1567235280>]}
[0m06:02:18.687964 [info ] [MainThread]: 
[0m06:02:18.688445 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:18.712703 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4020372, "process_user_time": 1.556321, "process_kernel_time": 0.132709, "process_mem_max_rss": "93536", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:18.713299 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:18.713195 after 0.40 seconds
[0m06:02:18.713734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156761d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f156709fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15673b4a70>]}
[0m06:02:18.714163 [debug] [MainThread]: Flushing usage events
[0m06:02:20.269689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b2ee120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10898fdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10898fcb00>]}


============================== 06:02:20.272646 | 73826b8e-2dee-4ff6-966e-395ab8ee36d9 ==============================
[0m06:02:20.272646 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:20.273297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:20.510547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088d69880>]}
[0m06:02:20.569138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10892c8320>]}
[0m06:02:20.571617 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:20.593170 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:20.593909 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:20.594447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081d2fb90>]}
[0m06:02:21.818318 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:21.818975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088df49b0>]}
[0m06:02:21.998149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:22.003079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081bf06e0>]}
[0m06:02:22.133076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10816a3200>]}
[0m06:02:22.133654 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:22.134137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108172ba70>]}
[0m06:02:22.135823 [info ] [MainThread]: 
[0m06:02:22.136482 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:22.141288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:22.176435 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:22.176876 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:22.177277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:22.540197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.541832 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:22.544257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:22.544854 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:22.552162 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.552602 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:22.552993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.559537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.561020 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.561434 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:22.561976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.562368 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.562746 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:22.563306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.564247 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.564653 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:22.565029 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:22.565550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.565956 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:22.568074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.574509 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.574922 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.575292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.581009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.581414 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.581804 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:22.603795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.605251 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.606439 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.606838 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.610088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108c4268a0>]}
[0m06:02:22.610603 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.610991 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.611358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.617832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.618254 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.618652 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.619028 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.619553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.620001 [debug] [MainThread]: On master: Close
[0m06:02:22.621406 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.621949 [info ] [MainThread]: 
[0m06:02:22.636945 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:22.637537 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:22.638262 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:22.638716 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:22.665045 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:22.665809 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:22.701619 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:22.702361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:29.756974 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.757477 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:29.758127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.758592 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.759029 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:29.759760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.762599 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.763053 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:29.763755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.784649 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.785127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.785568 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.787100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.792068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.792535 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:29.793668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.795986 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:29.825065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088cc2060>]}
[0m06:02:29.825768 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.19s]
[0m06:02:29.826537 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:29.827490 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:29.828079 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:29.828652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:29.829115 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:29.834081 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:29.834728 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.868053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.868559 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028060229862204"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.869037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.883587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.890959 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.891434 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.892079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.892520 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.892970 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028060229862204'
      
      
      order by ordinal_position

  
[0m06:02:29.915824 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.921889 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.922385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.925185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.932645 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.933121 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.936011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.953642 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.954335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.954797 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028060229862204"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028060229862204"
    )
  
[0m06:02:29.984503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.986490 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.986946 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.987370 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.995603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.996522 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:30.136153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73826b8e-2dee-4ff6-966e-395ab8ee36d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10422ec8c0>]}
[0m06:02:30.136968 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m06:02:30.137720 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:30.139189 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.139666 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.140141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:30.146992 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.147469 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.147950 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.148377 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.148956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.149409 [debug] [MainThread]: On master: Close
[0m06:02:30.150854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:30.151291 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:30.151743 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:30.152241 [info ] [MainThread]: 
[0m06:02:30.152753 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m06:02:30.153745 [debug] [MainThread]: Command end result
[0m06:02:30.181928 [info ] [MainThread]: 
[0m06:02:30.182587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:30.183093 [info ] [MainThread]: 
[0m06:02:30.183612 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:30.184681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.96344, "process_user_time": 4.969685, "process_kernel_time": 0.314839, "process_mem_max_rss": "297320", "process_in_blocks": "3808", "process_out_blocks": "112624"}
[0m06:02:30.185331 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:30.185219 after 9.96 seconds
[0m06:02:30.185826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108b2ee120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1088f3a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104214e510>]}
[0m06:02:30.186313 [debug] [MainThread]: Flushing usage events
[0m06:02:31.831184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e627140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e6269c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d7d2570>]}


============================== 06:02:31.834361 | 2ee77072-d821-4900-9789-821437692a7a ==============================
[0m06:02:31.834361 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.835114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.993074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ee77072-d821-4900-9789-821437692a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d562240>]}
[0m06:02:32.009945 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22726344, "process_user_time": 1.442231, "process_kernel_time": 0.095882, "process_mem_max_rss": "92276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:32.010536 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:32.010433 after 0.23 seconds
[0m06:02:32.010980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d611bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5d57bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5e5c5070>]}
[0m06:02:32.011409 [debug] [MainThread]: Flushing usage events
[0m14:05:43.781127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d9c3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e491160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333dc9c770>]}


============================== 14:05:43.799641 | 454ab71b-5d52-4fe9-a35a-634712aa6b74 ==============================
[0m14:05:43.799641 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:43.800427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:43.961611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '454ab71b-5d52-4fe9-a35a-634712aa6b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d3e8230>]}
[0m14:05:43.976818 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wktfb13p'
[0m14:05:43.977353 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:44.104878 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:44.105759 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:44.179463 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:44.183914 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:44.360156 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:44.360838 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:44.361424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '454ab71b-5d52-4fe9-a35a-634712aa6b74', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d3e8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d54bdd0>]}
[0m14:05:44.361927 [info ] [MainThread]: 
[0m14:05:44.362433 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:44.390756 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.661077, "process_user_time": 1.735637, "process_kernel_time": 0.107977, "process_mem_max_rss": "93768", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:44.391570 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:44.391446 after 0.66 seconds
[0m14:05:44.392072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333ec21640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d8c9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333d861730>]}
[0m14:05:44.392542 [debug] [MainThread]: Flushing usage events
[0m14:05:46.156727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6426540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6e3e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e8795d00>]}


============================== 14:05:46.159939 | ca1f2f26-aca7-4c38-9221-1bfdeee532f7 ==============================
[0m14:05:46.159939 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:46.160693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.425161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e61f8aa0>]}
[0m14:05:46.487802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e64f26c0>]}
[0m14:05:46.490644 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:46.516229 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:46.517081 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:46.517629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77df342b40>]}
[0m14:05:47.829796 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:47.830516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dedb0b60>]}
[0m14:05:48.026393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:48.032360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ded3e660>]}
[0m14:05:48.199016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77deb6c7a0>]}
[0m14:05:48.199639 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:48.200193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77dec256a0>]}
[0m14:05:48.202160 [info ] [MainThread]: 
[0m14:05:48.202970 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:48.208117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:48.247755 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:48.248342 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:48.248820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:48.768037 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:48.769813 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:48.772266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:48.772943 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:48.780676 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.781206 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:48.781624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.788873 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.790570 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.790992 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:48.791579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.791981 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.792396 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:48.793019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.794009 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.794436 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:48.794828 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:48.795396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.795823 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:48.798396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:48.806394 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.806841 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:48.807246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.814053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.814530 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:48.814952 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:48.839235 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:48.841053 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:48.842431 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:48.842878 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:48.847005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e6d6c6e0>]}
[0m14:05:48.847601 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.848029 [debug] [MainThread]: On master: BEGIN
[0m14:05:48.848428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:48.855524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.856006 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.856417 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.856869 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.857473 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.857912 [debug] [MainThread]: On master: Close
[0m14:05:48.859999 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:48.860565 [info ] [MainThread]: 
[0m14:05:48.879979 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:48.880705 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:48.881552 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:48.882035 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:48.909454 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:48.910364 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:48.948134 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:48.949183 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:56.930571 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.931174 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:56.932051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.932549 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.933060 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:56.933960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.937499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.937981 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:56.938789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.961034 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.961640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.962109 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:56.963776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.969644 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:56.970155 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:56.971552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:56.974183 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:57.006216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77decc08c0>]}
[0m14:05:57.007157 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.12s]
[0m14:05:57.007987 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:57.009092 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:57.009714 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:57.010389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:57.010883 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:57.016725 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:57.017547 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:57.053973 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.054602 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028140557047475"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:57.055105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:57.071428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.079986 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.080502 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:57.081243 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.081711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.082157 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028140557047475'
      
      
      order by ordinal_position

  
[0m14:05:57.105092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.112743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.113364 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:57.117315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.126028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.126562 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:57.129934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.149054 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:57.149908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.150420 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028140557047475"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028140557047475"
    )
  
[0m14:05:57.183889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.186207 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:57.186761 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:57.187250 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:57.196562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:57.197629 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:57.337692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca1f2f26-aca7-4c38-9221-1bfdeee532f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f779b420d40>]}
[0m14:05:57.338585 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m14:05:57.339395 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:57.340971 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.341583 [debug] [MainThread]: On master: BEGIN
[0m14:05:57.342121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:57.349793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.350375 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.350839 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:57.351288 [debug] [MainThread]: On master: COMMIT
[0m14:05:57.351913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:57.352399 [debug] [MainThread]: On master: Close
[0m14:05:57.354457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:57.354918 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:57.355341 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:57.355854 [info ] [MainThread]: 
[0m14:05:57.356484 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m14:05:57.357739 [debug] [MainThread]: Command end result
[0m14:05:57.388195 [info ] [MainThread]: 
[0m14:05:57.389036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:57.389584 [info ] [MainThread]: 
[0m14:05:57.390138 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:57.391288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.286792, "process_user_time": 5.839365, "process_kernel_time": 0.391421, "process_mem_max_rss": "281868", "process_in_blocks": "3808", "process_out_blocks": "112616"}
[0m14:05:57.391992 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:57.391870 after 11.29 seconds
[0m14:05:57.392522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e69639e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e69a21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77e61f8560>]}
[0m14:05:57.393075 [debug] [MainThread]: Flushing usage events
[0m14:05:59.320466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fd5ffec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fda0bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fda0a870>]}


============================== 14:05:59.323774 | 46d2110e-44fd-4b6b-8cbf-c6fa57daab8a ==============================
[0m14:05:59.323774 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:59.324510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:59.488817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d2110e-44fd-4b6b-8cbf-c6fa57daab8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcf0bce0>]}
[0m14:05:59.507518 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23926263, "process_user_time": 1.571253, "process_kernel_time": 0.08396, "process_mem_max_rss": "92252", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:59.508167 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:59.508051 after 0.24 seconds
[0m14:05:59.508643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcf5f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fce5f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2fcef2ed0>]}
[0m14:05:59.509163 [debug] [MainThread]: Flushing usage events
[0m22:05:38.658088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54406d3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5441648440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544073f830>]}


============================== 22:05:38.665394 | b1329918-f83e-4a5d-bf4e-a180b24ce659 ==============================
[0m22:05:38.665394 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.666087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.803293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1329918-f83e-4a5d-bf4e-a180b24ce659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fbbae70>]}
[0m22:05:38.816893 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u8ddbmzd'
[0m22:05:38.817357 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:38.869130 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:38.869807 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:38.892432 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:38.896331 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:38.994011 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:38.994622 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:38.995248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b1329918-f83e-4a5d-bf4e-a180b24ce659', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fb4b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543fa4d6d0>]}
[0m22:05:38.995751 [info ] [MainThread]: 
[0m22:05:38.996285 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:38.998117 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3881039, "process_user_time": 1.530194, "process_kernel_time": 0.149385, "process_mem_max_rss": "93508", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:38.998722 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:38.998618 after 0.39 seconds
[0m22:05:38.999162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544016c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5440af9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f544073f830>]}
[0m22:05:38.999586 [debug] [MainThread]: Flushing usage events
[0m22:05:40.611452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002fa97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9003e21910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9003e230e0>]}


============================== 22:05:40.614428 | edb8cd76-1e0e-46db-bcb7-e9820d35e989 ==============================
[0m22:05:40.614428 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.615175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.853051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002da64b0>]}
[0m22:05:40.912515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002e45370>]}
[0m22:05:40.915132 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:40.937314 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:40.938057 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:40.938576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90039b6de0>]}
[0m22:05:42.172007 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:42.172654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb8f35c0>]}
[0m22:05:42.352392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:42.357589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb92b020>]}
[0m22:05:42.481000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb8d83b0>]}
[0m22:05:42.481565 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:42.482071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb6920c0>]}
[0m22:05:42.483770 [info ] [MainThread]: 
[0m22:05:42.484453 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:42.489232 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:42.524802 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:42.525271 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:42.525668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.138197 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:43.139806 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:43.141963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:43.142515 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:43.149724 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.150154 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:43.150544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.157071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.158565 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.158965 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:43.159582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.160003 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.160381 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:43.160952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.161880 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.162288 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.162663 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.163199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.163603 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:43.165716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:43.173081 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.173502 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:43.173870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.180152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.180561 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.180958 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:43.204925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.206515 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:43.207763 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:43.208166 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:43.212047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffb7dbdd0>]}
[0m22:05:43.212590 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.212990 [debug] [MainThread]: On master: BEGIN
[0m22:05:43.213368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:43.219974 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.220406 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.220800 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.221173 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.221712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.222119 [debug] [MainThread]: On master: Close
[0m22:05:43.223732 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:43.224229 [info ] [MainThread]: 
[0m22:05:43.233892 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:43.234510 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:43.235146 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:43.235585 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:43.261552 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:43.262395 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:43.297929 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:43.298749 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:50.066806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.067328 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:50.068038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.068496 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.068943 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:50.069651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.072575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.073034 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:50.073717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.094460 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:50.094943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.095388 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:50.097609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.102648 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:50.103115 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:50.104532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.106880 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:50.137412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900445a150>]}
[0m22:05:50.138216 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.90s]
[0m22:05:50.138984 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:50.139990 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:50.140560 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:50.141139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:50.141598 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:50.146942 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:50.147619 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:50.181636 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.182168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241028220550175642"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:50.182641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:50.198174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.206275 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.206756 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:50.207427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.207917 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.208361 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241028220550175642'
      
      
      order by ordinal_position

  
[0m22:05:50.229210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.235641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.236176 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:50.239370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.247207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.247684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:50.250561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.268531 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:50.269300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.269774 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241028220550175642"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241028220550175642"
    )
  
[0m22:05:50.298689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.300704 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:50.301159 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:50.301580 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:50.309703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:50.310596 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:50.451578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb8cd76-1e0e-46db-bcb7-e9820d35e989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc12d0200>]}
[0m22:05:50.452426 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m22:05:50.453170 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:50.454649 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.455117 [debug] [MainThread]: On master: BEGIN
[0m22:05:50.455545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:50.462423 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.462901 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.463328 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:50.463776 [debug] [MainThread]: On master: COMMIT
[0m22:05:50.464359 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:50.464799 [debug] [MainThread]: On master: Close
[0m22:05:50.466280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:50.466715 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:50.467117 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:50.467569 [info ] [MainThread]: 
[0m22:05:50.468189 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m22:05:50.469276 [debug] [MainThread]: Command end result
[0m22:05:50.496958 [info ] [MainThread]: 
[0m22:05:50.497662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:50.498267 [info ] [MainThread]: 
[0m22:05:50.498858 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:50.499994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.936945, "process_user_time": 5.479856, "process_kernel_time": 0.311991, "process_mem_max_rss": "287164", "process_in_blocks": "3808", "process_out_blocks": "113160"}
[0m22:05:50.500666 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:50.500553 after 9.94 seconds
[0m22:05:50.501161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90038fc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc0216090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ffa4807a0>]}
[0m22:05:50.501664 [debug] [MainThread]: Flushing usage events
[0m22:05:52.196621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d254ca900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2539fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d26915550>]}


============================== 22:05:52.199505 | e335a262-b8c2-4cbc-974f-c79ee515e094 ==============================
[0m22:05:52.199505 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.200259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.348253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e335a262-b8c2-4cbc-974f-c79ee515e094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d251026c0>]}
[0m22:05:52.365379 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21789801, "process_user_time": 1.404242, "process_kernel_time": 0.136023, "process_mem_max_rss": "92388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:52.365981 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:52.365877 after 0.22 seconds
[0m22:05:52.366432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d251026c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d24d4b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d24e5cc50>]}
[0m22:05:52.366873 [debug] [MainThread]: Flushing usage events
[0m06:02:05.874699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618a92420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618a90e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61874de20>]}


============================== 06:02:05.893234 | 1fc0631d-75df-47e4-9d2e-ae5618b5a5d6 ==============================
[0m06:02:05.893234 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.893872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.033358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fc0631d-75df-47e4-9d2e-ae5618b5a5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61831d580>]}
[0m06:02:06.047041 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_msqsnw1'
[0m06:02:06.047532 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:06.108637 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:06.109380 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.119567 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.123504 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.170299 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.170888 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:06.171461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1fc0631d-75df-47e4-9d2e-ae5618b5a5d6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61808bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61808bbf0>]}
[0m06:02:06.171932 [info ] [MainThread]: 
[0m06:02:06.172387 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:06.179134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35275716, "process_user_time": 1.568156, "process_kernel_time": 0.130002, "process_mem_max_rss": "93900", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:06.179878 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.179770 after 0.35 seconds
[0m06:02:06.180319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618d545c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb618587bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6197d06e0>]}
[0m06:02:06.180753 [debug] [MainThread]: Flushing usage events
[0m06:02:07.742006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470265a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8ec380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8ed2b0>]}


============================== 06:02:07.744856 | b76403ca-1e77-4730-8cf1-a90ddf729293 ==============================
[0m06:02:07.744856 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.745555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.977242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f63b590>]}
[0m06:02:08.036224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470adbec0>]}
[0m06:02:08.038637 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:08.074822 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.075554 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.076085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f692e70>]}
[0m06:02:09.311566 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:09.312222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f63afc0>]}
[0m06:02:09.493636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:09.498648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64682e9d60>]}
[0m06:02:09.617822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64680588c0>]}
[0m06:02:09.618375 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:09.618874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64682cb470>]}
[0m06:02:09.620603 [info ] [MainThread]: 
[0m06:02:09.621293 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:09.626211 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:09.661656 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:09.662104 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:09.662508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:10.226649 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:10.228280 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:10.230511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:10.231101 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:10.238472 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.238909 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:10.239334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.245839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.247352 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.247765 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:10.248324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.248721 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.249098 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:10.249676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.250597 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.250999 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:10.251405 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:10.251946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.252352 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:10.254399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:10.261642 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.262062 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:10.262437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:10.268396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.268819 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:10.269280 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:10.294420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:10.296101 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:10.297382 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:10.297807 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:10.301642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6468041250>]}
[0m06:02:10.302177 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.302582 [debug] [MainThread]: On master: BEGIN
[0m06:02:10.302961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:10.309589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.310030 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.310424 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:10.310805 [debug] [MainThread]: On master: COMMIT
[0m06:02:10.311367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:10.311778 [debug] [MainThread]: On master: Close
[0m06:02:10.313471 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:10.313965 [info ] [MainThread]: 
[0m06:02:10.329825 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:10.330458 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:10.331130 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:10.331634 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:10.358185 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:10.359029 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:10.396225 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:10.397147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:19.112879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.113397 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:19.114027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.114478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.114914 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:19.115747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.118575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.119026 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:19.119820 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.140907 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.141441 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.141882 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.143101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.148206 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.148679 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:19.150171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.152637 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:19.182112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470d2f920>]}
[0m06:02:19.182869 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.85s]
[0m06:02:19.183673 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:19.184677 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:19.185242 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:19.185807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:19.186260 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:19.191587 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:19.192257 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:19.226190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.226699 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029060219220278"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:19.227186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:19.241483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.249053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.249520 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:19.250117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.250569 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.251006 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029060219220278'
      
      
      order by ordinal_position

  
[0m06:02:19.271620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.277827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.278304 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.281510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.290225 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.290913 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.295071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.320612 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:19.321525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.322196 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029060219220278"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029060219220278"
    )
  
[0m06:02:19.361662 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.364610 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.365231 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.365863 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.374679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.375971 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.524689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76403ca-1e77-4730-8cf1-a90ddf729293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64248bf920>]}
[0m06:02:19.525518 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m06:02:19.526258 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.527631 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.528104 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.528529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.535183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.535692 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.536133 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.536557 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.537150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.537609 [debug] [MainThread]: On master: Close
[0m06:02:19.538946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.539438 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.539848 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.540305 [info ] [MainThread]: 
[0m06:02:19.540816 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m06:02:19.541815 [debug] [MainThread]: Command end result
[0m06:02:19.570216 [info ] [MainThread]: 
[0m06:02:19.570846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.571401 [info ] [MainThread]: 
[0m06:02:19.571939 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.572962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.879456, "process_user_time": 5.548978, "process_kernel_time": 0.387509, "process_mem_max_rss": "291988", "process_in_blocks": "3808", "process_out_blocks": "114152"}
[0m06:02:19.573638 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.573523 after 11.88 seconds
[0m06:02:19.574145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6471bd8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646fd3c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f8a76b0>]}
[0m06:02:19.574643 [debug] [MainThread]: Flushing usage events
[0m06:02:21.187484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccce570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539cccdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccce3f0>]}


============================== 06:02:21.190278 | 1b9b4c32-9f56-4c57-9946-8b2f5078bbad ==============================
[0m06:02:21.190278 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.191018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.335199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b9b4c32-9f56-4c57-9946-8b2f5078bbad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ccfef60>]}
[0m06:02:21.351940 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21317771, "process_user_time": 1.417532, "process_kernel_time": 0.099826, "process_mem_max_rss": "92252", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:21.352514 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:21.352410 after 0.21 seconds
[0m06:02:21.352952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539cca58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539ca5fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f539c97ae10>]}
[0m06:02:21.353369 [debug] [MainThread]: Flushing usage events
[0m14:05:10.367174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae49f647d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a3334d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a332ba0>]}


============================== 14:05:10.451220 | 292209e1-b5ab-4cce-9172-a518335c84bd ==============================
[0m14:05:10.451220 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:10.451882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:10.600081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '292209e1-b5ab-4cce-9172-a518335c84bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a57dd60>]}
[0m14:05:10.614301 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pa36i0j9'
[0m14:05:10.614790 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:10.668567 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:10.669285 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:10.683746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:10.687715 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:10.741294 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:10.741936 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:10.742547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '292209e1-b5ab-4cce-9172-a518335c84bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae498acc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae498ac5c0>]}
[0m14:05:10.743008 [info ] [MainThread]: 
[0m14:05:10.743523 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:10.753908 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43490958, "process_user_time": 1.555751, "process_kernel_time": 0.154387, "process_mem_max_rss": "93584", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:10.754633 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:10.754508 after 0.44 seconds
[0m14:05:10.755088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae49cc61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4ab5e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae4a8f9fa0>]}
[0m14:05:10.755517 [debug] [MainThread]: Flushing usage events
[0m14:05:12.355713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60e8fca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60dfb2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60e3cfe00>]}


============================== 14:05:12.358735 | fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd ==============================
[0m14:05:12.358735 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.359404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.598903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60dcb7740>]}
[0m14:05:12.659096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60ddf55e0>]}
[0m14:05:12.661748 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:12.688183 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:12.688919 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:12.689445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6113e20f0>]}
[0m14:05:13.949441 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:13.950152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606df2b40>]}
[0m14:05:14.134732 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:14.140036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60680a6f0>]}
[0m14:05:14.297145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60688aab0>]}
[0m14:05:14.297773 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:14.298269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606603740>]}
[0m14:05:14.300008 [info ] [MainThread]: 
[0m14:05:14.300725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:14.305735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:14.342693 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:14.343190 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:14.343600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.986012 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.987583 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.989812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.990369 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.997462 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.997923 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:14.998316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.004695 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.006227 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.006642 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:15.007194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.007586 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.007958 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:15.008517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.009431 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.009878 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.010257 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.010794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.011209 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:15.013263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:15.020534 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.020948 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:15.021324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.028039 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.028459 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.028853 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:15.052772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.054443 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:15.055705 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:15.056121 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:15.059729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606730c20>]}
[0m14:05:15.060280 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.060676 [debug] [MainThread]: On master: BEGIN
[0m14:05:15.061074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:15.067638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.068068 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.068458 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.068834 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.069414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.069870 [debug] [MainThread]: On master: Close
[0m14:05:15.071293 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:15.071829 [info ] [MainThread]: 
[0m14:05:15.087772 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:15.088393 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:15.089135 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:15.089610 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.115770 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.116579 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.152099 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.152921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:22.230115 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.230647 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:22.231293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.231740 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.232177 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:22.232904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.235896 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.236351 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:22.237141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.258084 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.258584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.259032 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:22.260280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.265344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:22.265829 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:22.267171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.269533 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:22.300366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa606691eb0>]}
[0m14:05:22.301208 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.21s]
[0m14:05:22.302130 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:22.303163 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:22.303731 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:22.304417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:22.304877 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:22.310315 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:22.310997 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:22.344927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.345495 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029140522338961"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:22.346002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:22.363044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.371204 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.371692 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:22.372368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.372812 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.373243 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029140522338961'
      
      
      order by ordinal_position

  
[0m14:05:22.394917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.402421 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.402957 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.406005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.413906 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.414393 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:22.417309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.435559 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:22.436339 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.436818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029140522338961"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029140522338961"
    )
  
[0m14:05:22.471605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.473776 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.474292 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:22.474743 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:22.483075 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:22.484011 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:22.639918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdf7aaa2-af6e-412d-a2a9-9c57b8af19bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bf18a870>]}
[0m14:05:22.640804 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:22.641779 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:22.643471 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.643952 [debug] [MainThread]: On master: BEGIN
[0m14:05:22.644386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:22.651501 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.652000 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.652436 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:22.652851 [debug] [MainThread]: On master: COMMIT
[0m14:05:22.653459 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:22.653958 [debug] [MainThread]: On master: Close
[0m14:05:22.655819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:22.656257 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:22.656661 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:22.657124 [info ] [MainThread]: 
[0m14:05:22.657749 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m14:05:22.658894 [debug] [MainThread]: Command end result
[0m14:05:22.687959 [info ] [MainThread]: 
[0m14:05:22.688675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:22.689275 [info ] [MainThread]: 
[0m14:05:22.689903 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:22.691037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.384087, "process_user_time": 5.714859, "process_kernel_time": 0.401391, "process_mem_max_rss": "294364", "process_in_blocks": "3808", "process_out_blocks": "114152"}
[0m14:05:22.691689 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:22.691574 after 10.38 seconds
[0m14:05:22.692197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60df49f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60efaa570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60f3534a0>]}
[0m14:05:22.692687 [debug] [MainThread]: Flushing usage events
[0m14:05:24.418543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb815610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cc2f5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ca8fc7d0>]}


============================== 14:05:24.421379 | 4fd3362d-e9d3-472c-a9cb-212b66df31cc ==============================
[0m14:05:24.421379 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:24.422053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.564935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd3362d-e9d3-472c-a9cb-212b66df31cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9fad580>]}
[0m14:05:24.581814 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21180631, "process_user_time": 1.422238, "process_kernel_time": 0.087891, "process_mem_max_rss": "91988", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:24.582399 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:24.582296 after 0.21 seconds
[0m14:05:24.582837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9fd21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9d62b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9d7bfe0>]}
[0m14:05:24.583273 [debug] [MainThread]: Flushing usage events
[0m22:05:57.746303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12f22bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ef7f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12f9c8140>]}


============================== 22:05:57.772972 | 25706527-9c62-458e-9755-fb3b7007d402 ==============================
[0m22:05:57.772972 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:57.773618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:57.913991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25706527-9c62-458e-9755-fb3b7007d402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ed95fd0>]}
[0m22:05:57.927147 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2bglhr2j'
[0m22:05:57.927603 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:58.029304 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:58.029996 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:58.062140 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:58.066049 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:58.449277 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:58.449838 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:58.450371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '25706527-9c62-458e-9755-fb3b7007d402', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ecc3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ed06e70>]}
[0m22:05:58.450858 [info ] [MainThread]: 
[0m22:05:58.451336 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:58.470990 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.77256787, "process_user_time": 1.507564, "process_kernel_time": 0.183946, "process_mem_max_rss": "93800", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:58.471681 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:58.471577 after 0.77 seconds
[0m22:05:58.472119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12f22bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12efc5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12ee25b50>]}
[0m22:05:58.472550 [debug] [MainThread]: Flushing usage events
[0m22:06:00.193745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf3451f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290d3d0>]}


============================== 22:06:00.196518 | cdb16e28-fbc7-4be0-8730-f3c8f8873f08 ==============================
[0m22:06:00.196518 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:00.197220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:00.428046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf299faa0>]}
[0m22:06:00.486932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf29ab770>]}
[0m22:06:00.489358 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:00.531852 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:00.532567 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:00.533102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290fa40>]}
[0m22:06:01.754999 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:01.755671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf2894230>]}
[0m22:06:01.936875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:01.941954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf3f57290>]}
[0m22:06:02.060270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdeb2bf260>]}
[0m22:06:02.060822 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:02.061367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdeb3e9040>]}
[0m22:06:02.063134 [info ] [MainThread]: 
[0m22:06:02.063850 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:02.068770 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:02.103990 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:02.104437 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:02.104834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:03.431608 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:03.433174 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:03.435366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:03.435930 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:03.443130 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.443562 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:03.443952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:03.450291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.451743 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.452145 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:03.452693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.453089 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.453465 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:03.454040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.455004 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:03.455423 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:03.455800 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:03.456328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.456728 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:03.458574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:03.465594 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:03.466006 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:03.466373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:03.472197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.472615 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:03.473007 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:03.496246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:03.497674 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:03.498880 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:03.499284 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:03.502422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdeb3e8a70>]}
[0m22:06:03.502973 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.503362 [debug] [MainThread]: On master: BEGIN
[0m22:06:03.503726 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:03.509965 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.510387 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.510811 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.511184 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.511711 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.512107 [debug] [MainThread]: On master: Close
[0m22:06:03.513560 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:03.514073 [info ] [MainThread]: 
[0m22:06:03.534610 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:03.535257 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:03.535915 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:03.536356 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:03.562357 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:03.563141 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:03.598710 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:03.599446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:16.244279 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.244797 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:16.245426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.245886 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.246322 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:16.247094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.249980 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.250433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:16.251128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.271958 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:16.272437 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.272871 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:16.274123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.279058 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:16.279519 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:16.281142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.283479 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:16.316156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdace13680>]}
[0m22:06:16.316871 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.78s]
[0m22:06:16.317746 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:16.318735 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:16.319310 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:16.319981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:16.320440 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:16.325682 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:16.326327 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:16.359941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.360452 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241029220616353997"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:16.360915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:16.375828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.383734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.384218 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:16.384933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.385382 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.385817 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241029220616353997'
      
      
      order by ordinal_position

  
[0m22:06:16.406606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.413028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.413520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:16.416559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.424050 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.424520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:16.427361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.445234 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:16.445927 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.446397 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241029220616353997"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241029220616353997"
    )
  
[0m22:06:16.476121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.478088 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:16.478551 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:16.479023 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:16.488004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:16.488891 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:16.641202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb16e28-fbc7-4be0-8730-f3c8f8873f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efda7fc45c0>]}
[0m22:06:16.641963 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m22:06:16.642858 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:16.644383 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.644853 [debug] [MainThread]: On master: BEGIN
[0m22:06:16.645282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:16.652138 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.652615 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.653050 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:16.653472 [debug] [MainThread]: On master: COMMIT
[0m22:06:16.654057 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:16.654518 [debug] [MainThread]: On master: Close
[0m22:06:16.655998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:16.656439 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:16.656840 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:16.657315 [info ] [MainThread]: 
[0m22:06:16.657902 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.59 seconds (14.59s).
[0m22:06:16.659053 [debug] [MainThread]: Command end result
[0m22:06:16.686672 [info ] [MainThread]: 
[0m22:06:16.687362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:16.687956 [info ] [MainThread]: 
[0m22:06:16.688556 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:16.689650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.543995, "process_user_time": 6.293094, "process_kernel_time": 0.307272, "process_mem_max_rss": "280620", "process_in_blocks": "3808", "process_out_blocks": "114176"}
[0m22:06:16.690297 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:16.690186 after 16.54 seconds
[0m22:06:16.690818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf2ae2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf290f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdacf0acf0>]}
[0m22:06:16.691318 [debug] [MainThread]: Flushing usage events
[0m22:06:18.560099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b2435670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b14997c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b4913410>]}


============================== 22:06:18.562811 | 14f338cd-18cf-44db-bf88-63698db3d5d7 ==============================
[0m22:06:18.562811 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:18.563527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:18.698287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f338cd-18cf-44db-bf88-63698db3d5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b2b0b260>]}
[0m22:06:18.714595 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20253853, "process_user_time": 1.419757, "process_kernel_time": 0.096254, "process_mem_max_rss": "92260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:18.715201 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:18.715098 after 0.20 seconds
[0m22:06:18.715639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b1db6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b12d2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b1a1e480>]}
[0m22:06:18.716057 [debug] [MainThread]: Flushing usage events
[0m07:11:15.198521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c4f2b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c3cd6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c6001a00>]}


============================== 07:11:15.233989 | 87a3f4fb-973d-4c9c-85fa-8639e458323e ==============================
[0m07:11:15.233989 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:11:15.234689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:11:15.380805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a3f4fb-973d-4c9c-85fa-8639e458323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c45c9c40>]}
[0m07:11:15.394188 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-34hfxtla'
[0m07:11:15.394651 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:11:15.428105 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:11:15.428817 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:11:15.439299 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:11:15.443124 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:11:15.669528 [info ] [MainThread]: Installed from version 1.2.0
[0m07:11:15.670134 [info ] [MainThread]: Updated version available: 1.3.0
[0m07:11:15.670682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '87a3f4fb-973d-4c9c-85fa-8639e458323e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c3e3d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c39c44a0>]}
[0m07:11:15.671143 [info ] [MainThread]: 
[0m07:11:15.671630 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m07:11:15.684543 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5342621, "process_user_time": 1.596632, "process_kernel_time": 0.113754, "process_mem_max_rss": "93684", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m07:11:15.685218 [debug] [MainThread]: Command `dbt deps` succeeded at 07:11:15.685110 after 0.54 seconds
[0m07:11:15.685654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c4491640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c4492840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c45c9c40>]}
[0m07:11:15.686082 [debug] [MainThread]: Flushing usage events
[0m07:11:17.473514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d8bd4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d8bd47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d8541d30>]}


============================== 07:11:17.476323 | cdf66772-a414-4a00-9847-d689f5777c4d ==============================
[0m07:11:17.476323 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:11:17.476985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:11:17.711988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1320f80>]}
[0m07:11:17.771175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d82797f0>]}
[0m07:11:17.773668 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m07:11:17.825154 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:11:17.825872 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:11:17.826410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1226900>]}
[0m07:11:19.047705 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:11:19.048374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d1254b90>]}
[0m07:11:19.231174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m07:11:19.236418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0b194f0>]}
[0m07:11:19.358842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0de5310>]}
[0m07:11:19.359415 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m07:11:19.359942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0c04a70>]}
[0m07:11:19.361723 [info ] [MainThread]: 
[0m07:11:19.362460 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:11:19.367372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m07:11:19.403287 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m07:11:19.403747 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m07:11:19.404146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:19.783536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.785139 [debug] [ThreadPool]: On list_petro: Close
[0m07:11:19.787306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m07:11:19.787867 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m07:11:19.795096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.795535 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m07:11:19.795929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:11:19.802298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.803832 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.804248 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m07:11:19.804837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.805239 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.805623 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m07:11:19.806200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.807137 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:11:19.807541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m07:11:19.807920 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m07:11:19.808478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.808942 [debug] [ThreadPool]: On create_petro_main: Close
[0m07:11:19.811193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m07:11:19.818616 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:11:19.819033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m07:11:19.819414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:11:19.825556 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.825980 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m07:11:19.826379 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m07:11:19.849803 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:11:19.851395 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m07:11:19.852684 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m07:11:19.853104 [debug] [ThreadPool]: On list_petro_main: Close
[0m07:11:19.856694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d0df8ad0>]}
[0m07:11:19.857240 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:19.857639 [debug] [MainThread]: On master: BEGIN
[0m07:11:19.858015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:11:19.864509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:19.864978 [debug] [MainThread]: On master: COMMIT
[0m07:11:19.865380 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:19.865763 [debug] [MainThread]: On master: COMMIT
[0m07:11:19.866313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:19.866728 [debug] [MainThread]: On master: Close
[0m07:11:19.868271 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m07:11:19.868832 [info ] [MainThread]: 
[0m07:11:19.885848 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m07:11:19.886469 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m07:11:19.887156 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m07:11:19.887596 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m07:11:19.913624 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m07:11:19.914496 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m07:11:19.950443 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m07:11:19.951242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:11:29.906241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.906767 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m07:11:29.907428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.907885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.908327 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m07:11:29.909293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.912242 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.912731 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m07:11:29.913417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.934306 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:11:29.934811 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.935261 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m07:11:29.936658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.941710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m07:11:29.942182 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m07:11:29.943387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:29.945769 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m07:11:29.976502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d08bbb60>]}
[0m07:11:29.977340 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.09s]
[0m07:11:29.978104 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m07:11:29.979135 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m07:11:29.979699 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m07:11:29.980277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m07:11:29.980754 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m07:11:29.986109 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m07:11:29.986766 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m07:11:30.020860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.021385 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241030071130014858"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m07:11:30.021870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:11:30.036782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.044877 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.045373 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m07:11:30.046028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.046482 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.046915 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241030071130014858'
      
      
      order by ordinal_position

  
[0m07:11:30.067865 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.074853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.075361 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m07:11:30.078576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.086296 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.086778 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m07:11:30.089657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.107669 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m07:11:30.108438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.108941 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241030071130014858"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241030071130014858"
    )
  
[0m07:11:30.139863 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.141962 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:11:30.142438 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m07:11:30.142880 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m07:11:30.151647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m07:11:30.152600 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m07:11:30.318028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf66772-a414-4a00-9847-d689f5777c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18923cba70>]}
[0m07:11:30.318847 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m07:11:30.319603 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m07:11:30.321078 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:30.321557 [debug] [MainThread]: On master: BEGIN
[0m07:11:30.321989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:11:30.328838 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:30.329323 [debug] [MainThread]: On master: COMMIT
[0m07:11:30.329761 [debug] [MainThread]: Using duckdb connection "master"
[0m07:11:30.330182 [debug] [MainThread]: On master: COMMIT
[0m07:11:30.330761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:11:30.331210 [debug] [MainThread]: On master: Close
[0m07:11:30.332805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:11:30.333243 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m07:11:30.333648 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m07:11:30.334118 [info ] [MainThread]: 
[0m07:11:30.334720 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.97 seconds (10.97s).
[0m07:11:30.335857 [debug] [MainThread]: Command end result
[0m07:11:30.363905 [info ] [MainThread]: 
[0m07:11:30.364618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:11:30.365263 [info ] [MainThread]: 
[0m07:11:30.365871 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:11:30.366969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.94198, "process_user_time": 5.388263, "process_kernel_time": 0.358412, "process_mem_max_rss": "297756", "process_in_blocks": "3808", "process_out_blocks": "114672"}
[0m07:11:30.367625 [debug] [MainThread]: Command `dbt run` succeeded at 07:11:30.367511 after 12.94 seconds
[0m07:11:30.368149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18dc167d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1891ac92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d88a3e00>]}
[0m07:11:30.368673 [debug] [MainThread]: Flushing usage events
[0m07:11:32.303395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f02202d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f01d79640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f022011f0>]}


============================== 07:11:32.306376 | 2f9347f4-2d38-4d45-b71f-73cb8db84ab3 ==============================
[0m07:11:32.306376 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:11:32.307044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:11:32.446961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f9347f4-2d38-4d45-b71f-73cb8db84ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f02b37f20>]}
[0m07:11:32.463275 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20883814, "process_user_time": 1.457047, "process_kernel_time": 0.06387, "process_mem_max_rss": "92156", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:11:32.463856 [debug] [MainThread]: Command `dbt clean` succeeded at 07:11:32.463754 after 0.21 seconds
[0m07:11:32.464288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f01daa360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0198aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0244e240>]}
[0m07:11:32.464747 [debug] [MainThread]: Flushing usage events
[0m14:05:31.318715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e931f84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e93c41c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91a6d070>]}


============================== 14:05:31.337988 | 772986b1-c385-433d-a285-388cd31a4cd3 ==============================
[0m14:05:31.337988 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:31.338724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.483950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '772986b1-c385-433d-a285-388cd31a4cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e919317c0>]}
[0m14:05:31.502058 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x1q6uvtx'
[0m14:05:31.502768 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:31.575977 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:31.576884 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:31.605729 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:31.610171 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:31.685858 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:31.686514 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:31.687173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '772986b1-c385-433d-a285-388cd31a4cd3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91620d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91622a80>]}
[0m14:05:31.687652 [info ] [MainThread]: 
[0m14:05:31.688137 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:31.736188 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46638042, "process_user_time": 1.566557, "process_kernel_time": 0.165538, "process_mem_max_rss": "93772", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:31.736965 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:31.736853 after 0.47 seconds
[0m14:05:31.737451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e91b9a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e93c41c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e919317c0>]}
[0m14:05:31.738137 [debug] [MainThread]: Flushing usage events
[0m14:05:33.321146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979cb66510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b1d5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b1d59a0>]}


============================== 14:05:33.323859 | 533fe736-a419-4f65-a286-321973f941b4 ==============================
[0m14:05:33.323859 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.324589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.555308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979bfbd280>]}
[0m14:05:33.614592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b235580>]}
[0m14:05:33.617041 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:33.644784 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:33.645482 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:33.646043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979a8c4440>]}
[0m14:05:34.870868 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:34.871529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9793715a60>]}
[0m14:05:35.053715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:35.059081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97932a83b0>]}
[0m14:05:35.193511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97933bfad0>]}
[0m14:05:35.194095 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:35.194601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979311daf0>]}
[0m14:05:35.196348 [info ] [MainThread]: 
[0m14:05:35.197080 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:35.201963 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:35.237376 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:35.237876 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:35.238281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:35.759731 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:35.761323 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:35.763475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:35.764058 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:35.771331 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.771780 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:35.772187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.778513 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.779962 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.780387 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:35.780993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.781401 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.781822 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:35.782423 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.783343 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:35.783758 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:35.784144 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:35.784694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.785119 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:35.787941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:35.794587 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:35.795007 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:35.795379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.801489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.801942 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:35.802364 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:35.824658 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:35.826316 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:35.827567 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:35.827980 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:35.831554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97933f4e00>]}
[0m14:05:35.832078 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.832477 [debug] [MainThread]: On master: BEGIN
[0m14:05:35.832851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:35.839372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.839804 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.840202 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:35.840578 [debug] [MainThread]: On master: COMMIT
[0m14:05:35.841112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:35.841517 [debug] [MainThread]: On master: Close
[0m14:05:35.842899 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:35.843408 [info ] [MainThread]: 
[0m14:05:35.875738 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:35.876351 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:35.877026 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:35.877481 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:35.903921 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:35.904693 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:35.940700 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:35.941474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:43.507498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.508036 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:43.508738 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.509190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.509661 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:43.510509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.513489 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.513978 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:43.514686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.535678 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:43.536212 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.536675 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:43.538839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.544191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:43.544672 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:43.546018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.548455 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:43.578943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97753affb0>]}
[0m14:05:43.579818 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.70s]
[0m14:05:43.580611 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:43.581649 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:43.582234 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:43.582851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:43.583327 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:43.588748 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:43.589459 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:43.623802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.624397 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241030140543617789"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:43.624876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:43.639954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.648077 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.648589 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:43.649254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.649737 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.650189 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241030140543617789'
      
      
      order by ordinal_position

  
[0m14:05:43.671578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.678654 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.679177 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:43.682513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.690591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.691091 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:43.694278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.712758 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:43.713591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.714122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241030140543617789"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241030140543617789"
    )
  
[0m14:05:43.744897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.746998 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:43.747478 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:43.747907 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:43.757025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:43.758054 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:43.934847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533fe736-a419-4f65-a286-321973f941b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975c249340>]}
[0m14:05:43.935672 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m14:05:43.936519 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:43.938240 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.938720 [debug] [MainThread]: On master: BEGIN
[0m14:05:43.939156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:43.946303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.946830 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.947279 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:43.947710 [debug] [MainThread]: On master: COMMIT
[0m14:05:43.948314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:43.948770 [debug] [MainThread]: On master: Close
[0m14:05:43.950524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:43.950965 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:43.951383 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:43.951876 [info ] [MainThread]: 
[0m14:05:43.952430 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.75 seconds (8.75s).
[0m14:05:43.953484 [debug] [MainThread]: Command end result
[0m14:05:43.981922 [info ] [MainThread]: 
[0m14:05:43.982651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:43.983205 [info ] [MainThread]: 
[0m14:05:43.983771 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:43.984841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.711764, "process_user_time": 5.053734, "process_kernel_time": 0.341146, "process_mem_max_rss": "293228", "process_in_blocks": "3808", "process_out_blocks": "114664"}
[0m14:05:43.985499 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:43.985384 after 10.71 seconds
[0m14:05:43.986058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979aad5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97931c36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9793778ce0>]}
[0m14:05:43.986555 [debug] [MainThread]: Flushing usage events
[0m14:05:45.767052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dcb3e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dcb3f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dcb3f3e0>]}


============================== 14:05:45.770041 | 0a2fed02-361e-46a6-b20a-3f32bd5c472e ==============================
[0m14:05:45.770041 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:45.770721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:45.924937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a2fed02-361e-46a6-b20a-3f32bd5c472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8de063140>]}
[0m14:05:45.942147 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22490598, "process_user_time": 1.439913, "process_kernel_time": 0.135991, "process_mem_max_rss": "92392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:45.942761 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:45.942652 after 0.23 seconds
[0m14:05:45.943225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e05bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dc9f78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8dc983650>]}
[0m14:05:45.943667 [debug] [MainThread]: Flushing usage events
[0m22:05:32.794375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2d4e74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2d8e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2d8e7770>]}


============================== 22:05:32.801468 | a933c01e-a343-4572-b32d-fd2451372a03 ==============================
[0m22:05:32.801468 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:32.802123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:32.939746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a933c01e-a343-4572-b32d-fd2451372a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2ce0ba10>]}
[0m22:05:32.952884 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qzgos0nv'
[0m22:05:32.953334 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:33.061691 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:33.062296 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:33.085334 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:33.089129 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:33.159277 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:33.159851 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:33.160354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a933c01e-a343-4572-b32d-fd2451372a03', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2cefbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2cf535c0>]}
[0m22:05:33.160790 [info ] [MainThread]: 
[0m22:05:33.161247 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:33.162867 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41637897, "process_user_time": 1.548966, "process_kernel_time": 0.116072, "process_mem_max_rss": "93764", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:05:33.163482 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:33.163375 after 0.42 seconds
[0m22:05:33.163909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c30dbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2ce949e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2cefbd40>]}
[0m22:05:33.164323 [debug] [MainThread]: Flushing usage events
[0m22:05:34.748591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608b05d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608ec0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608136930>]}


============================== 22:05:34.751354 | 57ca03ca-2167-4b8c-8d10-a26d604438f3 ==============================
[0m22:05:34.751354 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:34.752057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:34.985796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6608000ef0>]}
[0m22:05:35.045579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6607fe6090>]}
[0m22:05:35.048225 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:35.079159 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:35.079927 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:35.080466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6607ec7860>]}
[0m22:05:36.320608 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:36.321298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6607e50c50>]}
[0m22:05:36.505043 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:36.510331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660083c830>]}
[0m22:05:36.632646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660089cd40>]}
[0m22:05:36.633190 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:36.633669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600891f40>]}
[0m22:05:36.635367 [info ] [MainThread]: 
[0m22:05:36.636038 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:36.640869 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:36.675557 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:36.675999 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:36.676458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:37.229363 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:37.230861 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:37.232848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:37.233393 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:37.240440 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.240870 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:37.241256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:37.247813 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.249236 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.249640 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:37.250182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.250597 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.250969 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:37.251571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.252479 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:37.252875 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:37.253246 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:37.253791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.254198 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:37.256121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:37.262653 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:37.263068 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:37.263502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:37.269467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.269877 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:37.270271 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:37.292316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:37.293817 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:37.295009 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:37.295439 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:37.298745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600891340>]}
[0m22:05:37.299251 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.299681 [debug] [MainThread]: On master: BEGIN
[0m22:05:37.300048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:37.306271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.306697 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.307083 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.307505 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.308032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.308441 [debug] [MainThread]: On master: Close
[0m22:05:37.309909 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:37.310442 [info ] [MainThread]: 
[0m22:05:37.319718 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:37.320305 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:37.321022 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:37.321464 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:37.347257 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:37.348018 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:37.383655 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:37.384385 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:44.510440 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.510952 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:44.511604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.512060 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.512500 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:44.513219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.516091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.516549 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:44.517237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.538239 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:44.538728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.539164 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:44.541283 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.546241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:44.546714 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:44.548312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.550613 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:44.580629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c1c8f710>]}
[0m22:05:44.581334 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.26s]
[0m22:05:44.582203 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:44.583143 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:44.583741 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:44.584401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:44.584854 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:44.589850 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:44.590498 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:44.623987 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.624488 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241030220544618078"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:44.624962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:44.639291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.646688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.647152 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:44.647777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.648229 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.648666 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241030220544618078'
      
      
      order by ordinal_position

  
[0m22:05:44.669402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.675536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.676032 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:44.679631 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.687186 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.687703 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:44.690459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.708090 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:44.708772 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.709314 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241030220544618078"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241030220544618078"
    )
  
[0m22:05:44.741712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.743723 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:44.744185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:44.744614 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:44.756578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:44.757481 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:44.926557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ca03ca-2167-4b8c-8d10-a26d604438f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c143bf80>]}
[0m22:05:44.927389 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:05:44.928256 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:44.929783 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.930263 [debug] [MainThread]: On master: BEGIN
[0m22:05:44.930689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:44.937543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.938010 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.938443 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.938859 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.939458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.939912 [debug] [MainThread]: On master: Close
[0m22:05:44.941338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:44.941767 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:44.942170 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:44.942623 [info ] [MainThread]: 
[0m22:05:44.943168 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m22:05:44.944227 [debug] [MainThread]: Command end result
[0m22:05:44.971878 [info ] [MainThread]: 
[0m22:05:44.972508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:44.973045 [info ] [MainThread]: 
[0m22:05:44.973596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:44.974614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.27466, "process_user_time": 5.08905, "process_kernel_time": 0.2689, "process_mem_max_rss": "286544", "process_in_blocks": "3808", "process_out_blocks": "114696"}
[0m22:05:44.975261 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:44.975150 after 10.28 seconds
[0m22:05:44.975778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66081370b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c142ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600b31370>]}
[0m22:05:44.976263 [debug] [MainThread]: Flushing usage events
[0m22:05:46.584643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034b3e8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034a1f2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034a1f2510>]}


============================== 22:05:46.587402 | e7756a84-6256-4e5b-acf6-d96d48fd696b ==============================
[0m22:05:46.587402 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:46.588064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:46.725969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7756a84-6256-4e5b-acf6-d96d48fd696b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034b20d940>]}
[0m22:05:46.741959 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2059205, "process_user_time": 1.385844, "process_kernel_time": 0.112474, "process_mem_max_rss": "92012", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:46.742524 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:46.742421 after 0.21 seconds
[0m22:05:46.742967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034b3e8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034a107ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034dfbbd10>]}
[0m22:05:46.743419 [debug] [MainThread]: Flushing usage events
[0m06:02:01.986404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0825b244d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08243dd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08243dd310>]}


============================== 06:02:02.006284 | 35459be1-507c-48e0-9371-9a69039d33f6 ==============================
[0m06:02:02.006284 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:02.006904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:02.142201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35459be1-507c-48e0-9371-9a69039d33f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0827bbbd10>]}
[0m06:02:02.155510 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ft1eyf1u'
[0m06:02:02.155979 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:02.277965 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:02.278582 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:02.304997 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:02.308819 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:02.382360 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:02.382851 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:02.383340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35459be1-507c-48e0-9371-9a69039d33f6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0823f6d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0823f6f9e0>]}
[0m06:02:02.383771 [info ] [MainThread]: 
[0m06:02:02.384216 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:02.390664 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45213374, "process_user_time": 1.483572, "process_kernel_time": 0.184943, "process_mem_max_rss": "93608", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:02.391248 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:02.391145 after 0.45 seconds
[0m06:02:02.391677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08243dd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0824b5ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08245c9bb0>]}
[0m06:02:02.392099 [debug] [MainThread]: Flushing usage events
[0m06:02:03.943982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1519e5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150439640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1501424b0>]}


============================== 06:02:03.946672 | aa4d2281-1e50-4130-9028-1638e6de0f08 ==============================
[0m06:02:03.946672 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:03.947334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.183135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14fe2fe90>]}
[0m06:02:04.242109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1532a0560>]}
[0m06:02:04.244554 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:04.269189 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:04.269902 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:04.270440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14fdd4ad0>]}
[0m06:02:05.490512 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:05.491191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb148b59bb0>]}
[0m06:02:05.670467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:05.675383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb148988ce0>]}
[0m06:02:05.795687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1488a0260>]}
[0m06:02:05.796224 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:05.796734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14892f590>]}
[0m06:02:05.798413 [info ] [MainThread]: 
[0m06:02:05.799091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:05.804012 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:05.838929 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:05.839369 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:05.839759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:06.360715 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:06.362322 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:06.364431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:06.365038 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:06.372167 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.372598 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:06.373025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.379354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.380811 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.381257 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:06.381852 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.382241 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.382612 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:06.383231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.384138 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.384538 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:06.384949 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:06.385486 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.385883 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:06.387824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:06.394942 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.395351 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:06.395715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:06.401660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.402063 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:06.402447 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:06.425850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:06.427285 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:06.428484 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:06.428935 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:06.432240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb148ad2e70>]}
[0m06:02:06.432743 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.433167 [debug] [MainThread]: On master: BEGIN
[0m06:02:06.433533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:06.439796 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.440215 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.440599 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:06.441063 [debug] [MainThread]: On master: COMMIT
[0m06:02:06.441624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:06.442021 [debug] [MainThread]: On master: Close
[0m06:02:06.443450 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:06.443947 [info ] [MainThread]: 
[0m06:02:06.458742 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:06.459329 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:06.459975 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:06.460402 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:06.485959 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:06.486678 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:06.521833 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:06.522572 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:14.879463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.879979 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:14.880613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.881095 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.881525 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:14.882220 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.885071 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.885532 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:14.886211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.907127 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:14.907601 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.908032 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:14.909447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.914291 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:14.914749 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:14.916342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:14.918669 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:14.948431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb109452390>]}
[0m06:02:14.949170 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.49s]
[0m06:02:14.949935 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:14.950920 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:14.951546 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:14.952215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:14.952667 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:14.957734 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:14.958376 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:14.991704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:14.992197 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241031060214985881"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:14.992666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:15.006712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.013936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.014402 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:15.014984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.015426 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.015858 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241031060214985881'
      
      
      order by ordinal_position

  
[0m06:02:15.036555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.042846 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.043335 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.046386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.053911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.054386 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.057337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.075043 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:15.075717 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.076178 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241031060214985881"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241031060214985881"
    )
  
[0m06:02:15.108527 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.110499 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.110954 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.111374 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.119452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.120328 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:15.300105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa4d2281-1e50-4130-9028-1638e6de0f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1093946e0>]}
[0m06:02:15.300899 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:15.301757 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:15.303195 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.303659 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.304085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:15.310875 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.311338 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.311771 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.312191 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.312832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.313319 [debug] [MainThread]: On master: Close
[0m06:02:15.314710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:15.315137 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:15.315530 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:15.315976 [info ] [MainThread]: 
[0m06:02:15.316555 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.52 seconds (9.52s).
[0m06:02:15.317692 [debug] [MainThread]: Command end result
[0m06:02:15.345269 [info ] [MainThread]: 
[0m06:02:15.345900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:15.346431 [info ] [MainThread]: 
[0m06:02:15.346978 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:15.347988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.452166, "process_user_time": 5.543529, "process_kernel_time": 0.299758, "process_mem_max_rss": "299564", "process_in_blocks": "3808", "process_out_blocks": "115184"}
[0m06:02:15.348630 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:15.348510 after 11.45 seconds
[0m06:02:15.349198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150b286b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1405874d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1093811f0>]}
[0m06:02:15.349678 [debug] [MainThread]: Flushing usage events
[0m06:02:16.970623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d85f85e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d862fcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d85ee7140>]}


============================== 06:02:16.973353 | c4d4a696-e598-4cba-9999-7b567f7ee9dd ==============================
[0m06:02:16.973353 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:16.973984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.108624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d4a696-e598-4cba-9999-7b567f7ee9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d85bbd580>]}
[0m06:02:17.124601 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20221986, "process_user_time": 1.383761, "process_kernel_time": 0.108294, "process_mem_max_rss": "92376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:17.125200 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:17.125097 after 0.20 seconds
[0m06:02:17.125626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8631f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8705b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d8609bc80>]}
[0m06:02:17.126045 [debug] [MainThread]: Flushing usage events
[0m14:05:12.585509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee23681f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee22098c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee220987a0>]}


============================== 14:05:12.592857 | cb83d02c-2efc-4e50-93da-4ebfb92ac636 ==============================
[0m14:05:12.592857 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:12.593570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.734086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb83d02c-2efc-4e50-93da-4ebfb92ac636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2136a690>]}
[0m14:05:12.747329 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ffqantpp'
[0m14:05:12.747778 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:12.794977 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:12.795628 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:12.828058 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:12.832045 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:13.046322 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:13.046896 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:13.047428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cb83d02c-2efc-4e50-93da-4ebfb92ac636', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee21058770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee21050740>]}
[0m14:05:13.047891 [info ] [MainThread]: 
[0m14:05:13.048362 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:13.049963 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5126817, "process_user_time": 1.559167, "process_kernel_time": 0.148683, "process_mem_max_rss": "93780", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m14:05:13.050565 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:13.050459 after 0.51 seconds
[0m14:05:13.051005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee23681f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee210738c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee215c7bf0>]}
[0m14:05:13.051444 [debug] [MainThread]: Flushing usage events
[0m14:05:14.896621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13ec7e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a14e214c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a142c4bf0>]}


============================== 14:05:14.899523 | bf2d6929-e44b-4a94-b22b-c4285fb0f905 ==============================
[0m14:05:14.899523 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.900163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:15.139888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1328ddc0>]}
[0m14:05:15.199482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1350a030>]}
[0m14:05:15.202119 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:15.235901 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:15.236665 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:15.237294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a132ba990>]}
[0m14:05:16.461048 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:16.461721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07d9e750>]}
[0m14:05:16.642721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:16.647935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13ff4770>]}
[0m14:05:16.793510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0c1adeb0>]}
[0m14:05:16.794098 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:16.794624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07d23d10>]}
[0m14:05:16.796380 [info ] [MainThread]: 
[0m14:05:16.797119 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:16.802119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:16.838024 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:16.838507 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:16.838966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:17.257459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.259013 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:17.261257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:17.261874 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:17.269008 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.269475 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:17.269885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:17.276417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.277975 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.278382 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:17.278970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.279367 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.279746 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:17.280323 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.281245 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:17.281683 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:17.282055 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:17.282593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.282997 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:17.285098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:17.292487 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:17.292915 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:17.293289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:17.299650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.300118 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:17.300523 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:17.324251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:17.325967 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:17.327228 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:17.327638 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:17.331422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07de8110>]}
[0m14:05:17.331950 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.332354 [debug] [MainThread]: On master: BEGIN
[0m14:05:17.332731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:17.339425 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.339871 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.340265 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:17.340644 [debug] [MainThread]: On master: COMMIT
[0m14:05:17.341174 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:17.341634 [debug] [MainThread]: On master: Close
[0m14:05:17.343134 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:17.343631 [info ] [MainThread]: 
[0m14:05:17.353212 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:17.353879 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:17.354580 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:17.355016 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:17.381433 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:17.382306 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:17.418959 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:17.419883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:25.631404 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.631956 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:25.632625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.633091 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.633568 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:25.634297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.637324 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.637831 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:25.638545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.659588 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:25.660083 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.660536 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:25.662832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.667908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:25.668372 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:25.669730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.672090 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:25.702279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a07d3bb00>]}
[0m14:05:25.703073 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.35s]
[0m14:05:25.703979 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:25.705005 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:25.705612 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:25.706299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:25.706755 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:25.712102 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:25.712784 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:25.746943 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.747469 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241031140525740986"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:25.747949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:25.764752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.772632 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.773118 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:25.773755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.774201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.774633 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241031140525740986'
      
      
      order by ordinal_position

  
[0m14:05:25.795579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.802228 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.802720 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:25.805904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.813619 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.814104 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:25.816955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.834985 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:25.835722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.836200 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241031140525740986"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241031140525740986"
    )
  
[0m14:05:25.868880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.870949 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:25.871418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:25.871849 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:25.880608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:25.881580 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.062825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2d6929-e44b-4a94-b22b-c4285fb0f905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d0816510>]}
[0m14:05:26.063692 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:26.064582 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.066105 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.066586 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.067014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.074362 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.074869 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.075307 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.075730 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.076326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.076783 [debug] [MainThread]: On master: Close
[0m14:05:26.078698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.079134 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:26.079536 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.080006 [info ] [MainThread]: 
[0m14:05:26.080597 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m14:05:26.081803 [debug] [MainThread]: Command end result
[0m14:05:26.110722 [info ] [MainThread]: 
[0m14:05:26.111448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.112040 [info ] [MainThread]: 
[0m14:05:26.112639 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.113773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.26582, "process_user_time": 5.358878, "process_kernel_time": 0.324174, "process_mem_max_rss": "292860", "process_in_blocks": "3808", "process_out_blocks": "115168"}
[0m14:05:26.114427 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.114315 after 11.27 seconds
[0m14:05:26.114923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13abbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a13841bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0c1eb830>]}
[0m14:05:26.115410 [debug] [MainThread]: Flushing usage events
[0m14:05:28.063396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2602cd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe262215910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe26027bf80>]}


============================== 14:05:28.066329 | 1f7360ab-b46d-477c-9cfb-b51f8446c6ec ==============================
[0m14:05:28.066329 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.066990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.207716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f7360ab-b46d-477c-9cfb-b51f8446c6ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25fe364b0>]}
[0m14:05:28.224098 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20950903, "process_user_time": 1.40454, "process_kernel_time": 0.128049, "process_mem_max_rss": "92328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:28.224702 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.224597 after 0.21 seconds
[0m14:05:28.225158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe261387590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25fca7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe262215910>]}
[0m14:05:28.225634 [debug] [MainThread]: Flushing usage events
[0m22:05:50.547394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cabc9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cab85340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb336ab0>]}


============================== 22:05:50.555050 | 896cb817-78f7-4e3c-9afc-9303f170ab11 ==============================
[0m22:05:50.555050 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.555747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.690793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '896cb817-78f7-4e3c-9afc-9303f170ab11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca857800>]}
[0m22:05:50.703982 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-71b2j33o'
[0m22:05:50.704422 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:50.791180 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:50.791782 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:50.802869 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:50.806665 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:50.979886 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:50.980385 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:50.980888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '896cb817-78f7-4e3c-9afc-9303f170ab11', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca90e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52ca90f2c0>]}
[0m22:05:50.981365 [info ] [MainThread]: 
[0m22:05:50.981836 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:50.983609 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48344803, "process_user_time": 1.596709, "process_kernel_time": 0.112049, "process_mem_max_rss": "93812", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:05:50.984180 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:50.984081 after 0.48 seconds
[0m22:05:50.984603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52caf8fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cdfe5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cb6ff530>]}
[0m22:05:50.985015 [debug] [MainThread]: Flushing usage events
[0m22:05:52.688488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce1101d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce2015610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce0bcaf90>]}


============================== 22:05:52.691204 | 2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93 ==============================
[0m22:05:52.691204 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:52.691839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:52.921719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce057f860>]}
[0m22:05:52.980437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce05616d0>]}
[0m22:05:52.983002 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:52.999221 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:52.999980 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:53.000514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce047a1b0>]}
[0m22:05:54.235856 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:54.236849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd912e900>]}
[0m22:05:54.416701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:54.421806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8fda180>]}
[0m22:05:54.541379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8e01fd0>]}
[0m22:05:54.541933 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:54.542428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8ea3410>]}
[0m22:05:54.544137 [info ] [MainThread]: 
[0m22:05:54.544857 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:54.549760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:54.585012 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:54.585480 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:54.585877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:55.085357 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.086992 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:55.089326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:55.089916 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:55.097309 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.097748 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:55.098160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.104581 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.106102 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.106515 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:55.107064 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.107460 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.107841 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:55.108450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.109414 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.109824 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:55.110205 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:55.110759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.111164 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:55.113144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:55.120446 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.120860 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:55.121265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:55.127175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.127590 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:55.127987 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:55.151447 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:55.152912 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:55.154166 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:55.154571 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:55.157964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce1ca4e30>]}
[0m22:05:55.158506 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.158897 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.159270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:55.165585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.166009 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.166401 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.166776 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.167314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.167716 [debug] [MainThread]: On master: Close
[0m22:05:55.169219 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:55.169755 [info ] [MainThread]: 
[0m22:05:55.179060 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:55.179654 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:55.180379 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:55.180831 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:55.206934 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:55.207688 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:55.243703 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:55.244432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:02.881780 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.882313 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:02.882945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.883403 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.883860 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:02.884583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.887553 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.888011 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:02.888702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.909748 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:02.910235 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.910677 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:02.912512 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.917504 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:02.917977 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:02.919106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:02.921429 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:02.951395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd8e01280>]}
[0m22:06:02.952144 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.77s]
[0m22:06:02.952908 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:02.953941 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:02.954515 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:02.955096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:02.955548 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:02.960698 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:02.961403 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:02.995306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:02.995818 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241031220602989380"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:02.996307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:03.010495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.018043 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.018518 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:03.019125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.019578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.020017 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241031220602989380'
      
      
      order by ordinal_position

  
[0m22:06:03.041815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.048007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.048499 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.051540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.059123 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.059607 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.062429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.080486 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:03.081203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.081682 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241031220602989380"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241031220602989380"
    )
  
[0m22:06:03.112576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.114746 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.115249 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.115688 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.124226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.125148 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:03.322167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ef1e0ca-293c-43c3-a1b4-3c3fd8dc6d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c99a25940>]}
[0m22:06:03.322988 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:03.323745 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:03.325246 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.325734 [debug] [MainThread]: On master: BEGIN
[0m22:06:03.326178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:03.333008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.333557 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.333996 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:03.334418 [debug] [MainThread]: On master: COMMIT
[0m22:06:03.335003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:03.335457 [debug] [MainThread]: On master: Close
[0m22:06:03.336860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:03.337339 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:03.337753 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:03.338216 [info ] [MainThread]: 
[0m22:06:03.338810 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m22:06:03.339915 [debug] [MainThread]: Command end result
[0m22:06:03.369171 [info ] [MainThread]: 
[0m22:06:03.369999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:03.370651 [info ] [MainThread]: 
[0m22:06:03.371319 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:03.372444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.732155, "process_user_time": 5.594649, "process_kernel_time": 0.303276, "process_mem_max_rss": "299264", "process_in_blocks": "3808", "process_out_blocks": "116744"}
[0m22:06:03.373084 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:03.372974 after 10.73 seconds
[0m22:06:03.373611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce41bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ce0802690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd90a0350>]}
[0m22:06:03.374094 [debug] [MainThread]: Flushing usage events
[0m22:06:05.124654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81959d63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8195cea6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81959d6390>]}


============================== 22:06:05.128356 | e32a2e0d-9351-43a4-be55-5e36bfad6a5e ==============================
[0m22:06:05.128356 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.129195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:05.275400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e32a2e0d-9351-43a4-be55-5e36bfad6a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8198d13410>]}
[0m22:06:05.291799 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23422936, "process_user_time": 1.426607, "process_kernel_time": 0.123879, "process_mem_max_rss": "91956", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:06:05.292360 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:05.292259 after 0.23 seconds
[0m22:06:05.292789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81959d6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8195ab2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8198d13410>]}
[0m22:06:05.293236 [debug] [MainThread]: Flushing usage events
[0m06:02:04.993052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04473c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a055046e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a044713d0>]}


============================== 06:02:05.000317 | 69dd1be5-e3d3-455a-9ffd-bf5bd6f4a8e0 ==============================
[0m06:02:05.000317 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:05.000922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:05.140503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69dd1be5-e3d3-455a-9ffd-bf5bd6f4a8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a048e1e80>]}
[0m06:02:05.154002 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-972_4mpt'
[0m06:02:05.154464 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:05.314249 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:05.314946 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:05.324576 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:05.328536 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:05.371412 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:05.371996 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:05.372594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '69dd1be5-e3d3-455a-9ffd-bf5bd6f4a8e0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a043168a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04c75970>]}
[0m06:02:05.373208 [info ] [MainThread]: 
[0m06:02:05.373743 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:05.375448 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43069765, "process_user_time": 1.564496, "process_kernel_time": 0.141491, "process_mem_max_rss": "93540", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:05.376075 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:05.375968 after 0.43 seconds
[0m06:02:05.376514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04c260c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04858770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04d87530>]}
[0m06:02:05.376942 [debug] [MainThread]: Flushing usage events
[0m06:02:06.927941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079d2c47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079d101a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079cf05b50>]}


============================== 06:02:06.930959 | b5f6ec7f-4054-438d-a628-8c3493bafe55 ==============================
[0m06:02:06.930959 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.931719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.170972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c303590>]}
[0m06:02:07.231571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c3873e0>]}
[0m06:02:07.234233 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:07.270207 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:07.270970 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:07.271505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c2c6060>]}
[0m06:02:08.514687 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:08.515383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07953132f0>]}
[0m06:02:08.699580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:08.705094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0794d72270>]}
[0m06:02:08.866522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0794ca87d0>]}
[0m06:02:08.867122 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:08.867652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0794c0d6a0>]}
[0m06:02:08.869472 [info ] [MainThread]: 
[0m06:02:08.870216 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:08.875178 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:08.911466 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:08.912010 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:08.912417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:09.416364 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:09.417919 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:09.420165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:09.420722 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:09.427938 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.428366 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:09.428758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.435010 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.436462 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.436868 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:09.437396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.437788 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.438162 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:09.438715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.439622 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.440072 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:09.440456 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:09.441008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.441425 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:09.443335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:09.450397 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.450812 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:09.451191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:09.457126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.457545 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:09.457941 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:09.481142 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:09.482612 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:09.483822 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:09.484268 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:09.487625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07951acd40>]}
[0m06:02:09.488176 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.488579 [debug] [MainThread]: On master: BEGIN
[0m06:02:09.488962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:09.495141 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.495565 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.496011 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:09.496389 [debug] [MainThread]: On master: COMMIT
[0m06:02:09.496922 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:09.497330 [debug] [MainThread]: On master: Close
[0m06:02:09.498617 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:09.499114 [info ] [MainThread]: 
[0m06:02:09.508468 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:09.509069 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:09.509729 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:09.510172 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:09.536755 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:09.537521 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:09.573846 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:09.574598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:15.403486 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.404014 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:15.404644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.405090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.405520 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:15.406204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.409094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.409551 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:15.410234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.431128 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.431608 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.432080 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:15.433506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.438423 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:15.438893 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:15.440044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.442370 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:15.472469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0755781100>]}
[0m06:02:15.473223 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 5.96s]
[0m06:02:15.474097 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:15.475084 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:15.475643 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:15.476352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:15.476842 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:15.482053 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:15.482709 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:15.516714 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.517223 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241101060215510750"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:15.517695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:15.532942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.540542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.541021 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:15.541626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.542071 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.542511 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241101060215510750'
      
      
      order by ordinal_position

  
[0m06:02:15.563990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.570192 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.570680 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.575213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.582750 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.583230 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:15.587424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.605900 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:15.606618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.607093 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241101060215510750"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241101060215510750"
    )
  
[0m06:02:15.638292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.640380 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.640843 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:15.641271 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:15.649177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:15.650144 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:15.850414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f6ec7f-4054-438d-a628-8c3493bafe55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075552a930>]}
[0m06:02:15.851264 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:15.852180 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:15.853601 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.854071 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.854497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:15.861398 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.861879 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.862317 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.862743 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.863326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.863787 [debug] [MainThread]: On master: Close
[0m06:02:15.865260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:15.865702 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:15.866103 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:15.866569 [info ] [MainThread]: 
[0m06:02:15.867163 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m06:02:15.868320 [debug] [MainThread]: Command end result
[0m06:02:15.896956 [info ] [MainThread]: 
[0m06:02:15.897647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:15.898236 [info ] [MainThread]: 
[0m06:02:15.898845 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:15.899975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.021043, "process_user_time": 5.706056, "process_kernel_time": 0.281681, "process_mem_max_rss": "301804", "process_in_blocks": "3808", "process_out_blocks": "116720"}
[0m06:02:15.900626 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:15.900513 after 9.02 seconds
[0m06:02:15.901117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c5b2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07949a17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079c9d7e00>]}
[0m06:02:15.901611 [debug] [MainThread]: Flushing usage events
[0m06:02:17.628215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452c33da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845226ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845226e8a0>]}


============================== 06:02:17.631022 | 32bee49d-3509-4c81-9b35-2dbab30d16ea ==============================
[0m06:02:17.631022 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.631698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.771062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32bee49d-3509-4c81-9b35-2dbab30d16ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8451ade6f0>]}
[0m06:02:17.787571 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20873599, "process_user_time": 1.400191, "process_kernel_time": 0.116015, "process_mem_max_rss": "92160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:17.788206 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:17.788099 after 0.21 seconds
[0m06:02:17.788657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452c33da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f845224f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8453e21d00>]}
[0m06:02:17.789089 [debug] [MainThread]: Flushing usage events
[0m14:05:05.291813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48b2ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a49238e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48627830>]}


============================== 14:05:05.299424 | 745946be-bb89-43aa-bf37-4278c0a7748d ==============================
[0m14:05:05.299424 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.300223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.446470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '745946be-bb89-43aa-bf37-4278c0a7748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a4804dfa0>]}
[0m14:05:05.460507 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y0rizk24'
[0m14:05:05.461061 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:05.498907 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:05.499668 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:05.511187 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:05.515260 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:05.725801 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:05.726494 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:05.727211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '745946be-bb89-43aa-bf37-4278c0a7748d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a481e7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a481e7c80>]}
[0m14:05:05.727746 [info ] [MainThread]: 
[0m14:05:05.728300 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:05.730197 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4872031, "process_user_time": 1.611376, "process_kernel_time": 0.112515, "process_mem_max_rss": "93596", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m14:05:05.730823 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:05.730710 after 0.49 seconds
[0m14:05:05.731287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48173350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48b2ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a48b2ede0>]}
[0m14:05:05.731743 [debug] [MainThread]: Flushing usage events
[0m14:05:07.588077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61fd21550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e88fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e3fac30>]}


============================== 14:05:07.591124 | 49f7080f-8fb1-4611-9f8b-b26c5584d473 ==============================
[0m14:05:07.591124 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:07.591894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:07.833700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e2b7aa0>]}
[0m14:05:07.892764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61f4aed50>]}
[0m14:05:07.895414 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:07.911356 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:07.912099 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:07.912639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6172302f0>]}
[0m14:05:09.148575 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:09.149309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e2b72f0>]}
[0m14:05:09.333538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:09.338696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616b40860>]}
[0m14:05:09.464655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e6fc7a0>]}
[0m14:05:09.465245 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:09.465758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616bae840>]}
[0m14:05:09.467452 [info ] [MainThread]: 
[0m14:05:09.468157 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:09.472850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:09.507949 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:09.508409 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:09.508871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:10.138564 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:10.140177 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:10.142555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:10.143151 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:10.150534 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.150988 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:10.151394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:10.157811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.159311 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.159733 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:10.160456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.160891 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.161296 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:10.161959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.162881 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:10.163283 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:10.163664 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:10.164265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.164676 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:10.166734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:10.174091 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:10.174540 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:10.174913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:10.181450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.181907 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:10.182307 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:10.207452 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:10.209153 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:10.210434 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:10.210853 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:10.214788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61f9119a0>]}
[0m14:05:10.215379 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:10.215790 [debug] [MainThread]: On master: BEGIN
[0m14:05:10.216165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:10.222884 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:10.223322 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.223718 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:10.224098 [debug] [MainThread]: On master: COMMIT
[0m14:05:10.224671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:10.225129 [debug] [MainThread]: On master: Close
[0m14:05:10.226677 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:10.227188 [info ] [MainThread]: 
[0m14:05:10.236730 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:10.237391 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:10.238050 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:10.238490 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:10.265137 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:10.266030 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:10.302603 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:10.303557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:20.860589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.861140 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:20.861791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.862241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.862673 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:20.863392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.866346 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.866806 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:20.867503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.888297 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.888855 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.889296 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:20.901520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.906827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:20.907296 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:20.908910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:20.911353 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:20.942575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616df7830>]}
[0m14:05:20.943387 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.70s]
[0m14:05:20.944179 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:20.945202 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:20.945781 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:20.946393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:20.946855 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:20.952172 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:20.952866 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:20.986754 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:20.987316 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241101140520980721"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:20.987796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:21.003735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.011824 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.012313 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:21.012967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.013418 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.013851 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241101140520980721'
      
      
      order by ordinal_position

  
[0m14:05:21.034686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.041432 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.041925 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.044715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.052389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.052887 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.055996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.074142 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:21.074920 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.075408 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241101140520980721"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241101140520980721"
    )
  
[0m14:05:21.108384 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.110461 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.110951 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.111388 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.121425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.122361 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:21.771691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f7080f-8fb1-4611-9f8b-b26c5584d473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d74674a0>]}
[0m14:05:21.772515 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.83s]
[0m14:05:21.773408 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:21.774864 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.775340 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.775773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:21.782546 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.783035 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.783473 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.783896 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.784482 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.784991 [debug] [MainThread]: On master: Close
[0m14:05:21.786464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.786897 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:21.787299 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:21.787758 [info ] [MainThread]: 
[0m14:05:21.788357 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.32 seconds (12.32s).
[0m14:05:21.789518 [debug] [MainThread]: Command end result
[0m14:05:21.817232 [info ] [MainThread]: 
[0m14:05:21.817931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:21.818528 [info ] [MainThread]: 
[0m14:05:21.819120 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:21.820214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.280946, "process_user_time": 6.644992, "process_kernel_time": 0.36673, "process_mem_max_rss": "363868", "process_in_blocks": "3808", "process_out_blocks": "131536"}
[0m14:05:21.820888 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:21.820747 after 14.28 seconds
[0m14:05:21.821384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e494bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61e21e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d7457c80>]}
[0m14:05:21.821873 [debug] [MainThread]: Flushing usage events
[0m14:05:23.752115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752ab5fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752aafaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752b8f8260>]}


============================== 14:05:23.755023 | 61fbd707-4de4-44f4-a33c-00e585185648 ==============================
[0m14:05:23.755023 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.755656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.912025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61fbd707-4de4-44f4-a33c-00e585185648', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752bfc8650>]}
[0m14:05:23.928866 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22524585, "process_user_time": 1.440011, "process_kernel_time": 0.084, "process_mem_max_rss": "92128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:23.929458 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:23.929358 after 0.23 seconds
[0m14:05:23.929893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752b8f8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752a61ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752a618fe0>]}
[0m14:05:23.930325 [debug] [MainThread]: Flushing usage events
[0m22:05:42.232615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834fc13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83716dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd835ee5100>]}


============================== 22:05:42.240308 | 2cb9c6a7-8d64-4bfe-a41a-c8206efeb61b ==============================
[0m22:05:42.240308 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.241054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.383012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cb9c6a7-8d64-4bfe-a41a-c8206efeb61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd836315760>]}
[0m22:05:42.396685 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-re6v8gi2'
[0m22:05:42.397151 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:42.430559 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:42.431271 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:42.440645 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:42.444515 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:42.647989 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:42.648633 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:42.649328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2cb9c6a7-8d64-4bfe-a41a-c8206efeb61b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834c911f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834c93050>]}
[0m22:05:42.649789 [info ] [MainThread]: 
[0m22:05:42.650303 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:42.651909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46755692, "process_user_time": 1.5731, "process_kernel_time": 0.136095, "process_mem_max_rss": "93736", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:05:42.652543 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:42.652438 after 0.47 seconds
[0m22:05:42.652980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd835aa8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834b03f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8353945c0>]}
[0m22:05:42.653398 [debug] [MainThread]: Flushing usage events
[0m22:05:44.518340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be0a4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be1706b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be3bae40>]}


============================== 22:05:44.521201 | dac8e806-ee3c-45c8-b95e-abb1e46c0c53 ==============================
[0m22:05:44.521201 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.521923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.757152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bdec5100>]}
[0m22:05:44.816305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b6f21880>]}
[0m22:05:44.818918 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:44.834670 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:44.835391 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:44.835923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b6e5a780>]}
[0m22:05:46.063951 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:46.064614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b685e510>]}
[0m22:05:46.245913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:46.251353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b68f5bb0>]}
[0m22:05:46.383865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b67edb80>]}
[0m22:05:46.384474 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:46.384992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b687b7d0>]}
[0m22:05:46.386773 [info ] [MainThread]: 
[0m22:05:46.387522 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:46.392487 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:46.428594 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:46.429103 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:46.429503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:46.876662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.878208 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:46.880633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:46.881188 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:46.888393 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.888828 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:46.889221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.895622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.897099 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.897512 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:46.898108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.898517 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.898901 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:46.899504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.900460 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.900879 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:46.901264 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:46.901802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.902215 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:46.904088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:46.911157 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.911574 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:46.911949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:46.917929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.918346 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:46.918741 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:46.942315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:46.943935 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:46.945232 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:46.945639 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:46.949475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90bf5b9400>]}
[0m22:05:46.950013 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.950406 [debug] [MainThread]: On master: BEGIN
[0m22:05:46.950780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:46.957380 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.957820 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.958213 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:46.958601 [debug] [MainThread]: On master: COMMIT
[0m22:05:46.959129 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:46.959542 [debug] [MainThread]: On master: Close
[0m22:05:46.960985 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:46.961492 [info ] [MainThread]: 
[0m22:05:46.971519 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:46.972205 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:46.972898 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:46.973339 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:46.999473 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:47.000323 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:47.036218 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:47.037077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:55.562160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.562685 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:55.563341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.563813 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.564275 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:55.564997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.567879 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.568394 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:55.569081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.589735 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:55.590236 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.590685 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:55.592170 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.597188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:55.597655 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:55.598962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.601348 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:55.631410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90732809e0>]}
[0m22:05:55.632289 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.66s]
[0m22:05:55.633069 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:55.634058 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:55.634623 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:55.635209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:55.635665 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:55.641083 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:55.641761 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:55.675538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.676122 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241101220555669595"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:55.676627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:55.692356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.700164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.700638 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:55.701262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.701712 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.702145 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241101220555669595'
      
      
      order by ordinal_position

  
[0m22:05:55.723138 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.729685 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.730183 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:55.734761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.742536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.743013 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:55.745956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.764000 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:55.764774 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.765246 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241101220555669595"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241101220555669595"
    )
  
[0m22:05:55.795718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.797812 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:55.798277 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:55.798711 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:55.808281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:55.809228 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:55.968891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac8e806-ee3c-45c8-b95e-abb1e46c0c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b69707a0>]}
[0m22:05:55.969759 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.33s]
[0m22:05:55.970519 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:55.972140 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.972623 [debug] [MainThread]: On master: BEGIN
[0m22:05:55.973055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:55.980146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.980653 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.981088 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:55.981516 [debug] [MainThread]: On master: COMMIT
[0m22:05:55.982108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:55.982563 [debug] [MainThread]: On master: Close
[0m22:05:55.984351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:55.984793 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:55.985196 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:55.985675 [info ] [MainThread]: 
[0m22:05:55.986220 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.60 seconds (9.60s).
[0m22:05:55.987247 [debug] [MainThread]: Command end result
[0m22:05:56.015540 [info ] [MainThread]: 
[0m22:05:56.016254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:56.016774 [info ] [MainThread]: 
[0m22:05:56.017292 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:56.018337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.547948, "process_user_time": 5.506517, "process_kernel_time": 0.306581, "process_mem_max_rss": "278320", "process_in_blocks": "3808", "process_out_blocks": "114176"}
[0m22:05:56.018987 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:56.018875 after 11.55 seconds
[0m22:05:56.019493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be3ba2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a5f3f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90be4c80e0>]}
[0m22:05:56.019984 [debug] [MainThread]: Flushing usage events
[0m22:05:57.997255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec656acf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec66f1d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6567e5a0>]}


============================== 22:05:58.000315 | 1de55447-30d0-4e4c-a4fe-a57c1c4f56a9 ==============================
[0m22:05:58.000315 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:58.001064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:58.151679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1de55447-30d0-4e4c-a4fe-a57c1c4f56a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec654b4ce0>]}
[0m22:05:58.168353 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22000042, "process_user_time": 1.448446, "process_kernel_time": 0.108033, "process_mem_max_rss": "92212", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:58.168945 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:58.168841 after 0.22 seconds
[0m22:05:58.169381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec66208140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6549f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6575a300>]}
[0m22:05:58.169820 [debug] [MainThread]: Flushing usage events
[0m06:02:09.929212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f4879cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f485ba780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f4879de80>]}


============================== 06:02:09.936338 | 785e5a75-c4b0-4128-b9d4-86c53d4f39ff ==============================
[0m06:02:09.936338 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.936990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.071983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '785e5a75-c4b0-4128-b9d4-86c53d4f39ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f486ba720>]}
[0m06:02:10.085115 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k6v538hr'
[0m06:02:10.085581 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.168308 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.168988 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.180181 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.184185 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.233548 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.234099 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:10.234686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '785e5a75-c4b0-4128-b9d4-86c53d4f39ff', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47d5b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47b93e60>]}
[0m06:02:10.235135 [info ] [MainThread]: 
[0m06:02:10.235663 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:10.237281 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35559773, "process_user_time": 1.542609, "process_kernel_time": 0.139873, "process_mem_max_rss": "93696", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m06:02:10.237867 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.237766 after 0.36 seconds
[0m06:02:10.238296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f48166840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f48deac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f47d5b230>]}
[0m06:02:10.238717 [debug] [MainThread]: Flushing usage events
[0m06:02:11.771254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe2b10>]}


============================== 06:02:11.773919 | de4c2218-d05e-42d4-942d-a1f4f3e337d6 ==============================
[0m06:02:11.773919 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.774550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.007521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454ea8530>]}
[0m06:02:12.066105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45604fec0>]}
[0m06:02:12.068485 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:12.116495 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.117307 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.117948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44dfbdd60>]}
[0m06:02:13.329823 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.330474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d85f380>]}
[0m06:02:13.509895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.514899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44ddec9e0>]}
[0m06:02:13.633800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d809d00>]}
[0m06:02:13.634344 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:13.634874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d8e43e0>]}
[0m06:02:13.636534 [info ] [MainThread]: 
[0m06:02:13.637271 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:13.641907 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:13.676295 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:13.676741 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:13.677170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.151735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.153350 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.155534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.156094 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.163234 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.163666 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:14.164057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.170514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.171958 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.172373 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.172977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.173422 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.173805 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.174399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.175323 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.175722 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.176102 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.176652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.177057 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.179000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.185934 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.186341 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.186714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.192375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.192790 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.193226 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:14.216471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.217920 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.219126 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.219530 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.222715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d70e840>]}
[0m06:02:14.223226 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.223620 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.223990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.230397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.230823 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.231265 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.231645 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.232235 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.232640 [debug] [MainThread]: On master: Close
[0m06:02:14.234248 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.234748 [info ] [MainThread]: 
[0m06:02:14.243661 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.244247 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.244877 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.245359 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.270754 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.271491 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.306665 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.307388 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.563749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.564250 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.564877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.565365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.565802 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.566509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.569345 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.569799 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.570483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.591083 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.591559 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.592002 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.593238 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.598143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.598608 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.600029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.602328 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.631606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44d9c4380>]}
[0m06:02:20.632299 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.39s]
[0m06:02:20.633060 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.634053 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.634610 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.635207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.635665 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.640581 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.641266 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:20.674368 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.674866 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241102060220668525"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:20.675331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:20.689776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.697208 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.697676 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:20.698303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.698748 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.699178 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241102060220668525'
      
      
      order by ordinal_position

  
[0m06:02:20.721198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.727198 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.727677 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.730492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.737955 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.738423 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:20.741115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.758817 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:20.759492 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.759969 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241102060220668525"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241102060220668525"
    )
  
[0m06:02:20.789962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.791855 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.792319 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.792747 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:20.801082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.801998 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:20.960186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de4c2218-d05e-42d4-942d-a1f4f3e337d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44df847a0>]}
[0m06:02:20.960940 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.32s]
[0m06:02:20.961842 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:20.963200 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.963668 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.964105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:20.970817 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.971290 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.971726 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:20.972141 [debug] [MainThread]: On master: COMMIT
[0m06:02:20.972743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:20.973228 [debug] [MainThread]: On master: Close
[0m06:02:20.974736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:20.975166 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:20.975568 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:20.976027 [info ] [MainThread]: 
[0m06:02:20.976569 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m06:02:20.977621 [debug] [MainThread]: Command end result
[0m06:02:21.005344 [info ] [MainThread]: 
[0m06:02:21.005981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.006514 [info ] [MainThread]: 
[0m06:02:21.007061 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.008065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.284931, "process_user_time": 5.409922, "process_kernel_time": 0.322208, "process_mem_max_rss": "294952", "process_in_blocks": "3808", "process_out_blocks": "114648"}
[0m06:02:21.008704 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.008592 after 9.29 seconds
[0m06:02:21.009208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45507fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb454fe2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4122c8830>]}
[0m06:02:21.009690 [debug] [MainThread]: Flushing usage events
[0m06:02:22.613335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a2bdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58ab67080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a2bdd30>]}


============================== 06:02:22.616015 | d98ad81c-143f-4b53-aa0d-07964270d717 ==============================
[0m06:02:22.616015 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:22.616732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:22.751854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd98ad81c-143f-4b53-aa0d-07964270d717', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5899cad50>]}
[0m06:02:22.768078 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20298095, "process_user_time": 1.381521, "process_kernel_time": 0.123777, "process_mem_max_rss": "92196", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:22.768640 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:22.768537 after 0.20 seconds
[0m06:02:22.769076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc589808c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a48b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5897cc7a0>]}
[0m06:02:22.769547 [debug] [MainThread]: Flushing usage events
[0m14:04:51.675244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0d769250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0b182cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ca28860>]}


============================== 14:04:51.682616 | 6b5feb64-1a56-4aec-ad7d-7c565a8298d4 ==============================
[0m14:04:51.682616 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:51.683291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:51.821889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b5feb64-1a56-4aec-ad7d-7c565a8298d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0b139400>]}
[0m14:04:51.835063 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r2ef8ipp'
[0m14:04:51.835518 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:51.897474 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:51.898059 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:51.907735 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:51.911537 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:52.117431 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:52.117988 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:52.118512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6b5feb64-1a56-4aec-ad7d-7c565a8298d4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ae7a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0ae7a720>]}
[0m14:04:52.118966 [info ] [MainThread]: 
[0m14:04:52.119432 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:52.125278 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49795356, "process_user_time": 1.5226, "process_kernel_time": 0.162569, "process_mem_max_rss": "93508", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:04:52.125865 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:52.125763 after 0.50 seconds
[0m14:04:52.126290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0af2fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0afa3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0b543890>]}
[0m14:04:52.126703 [debug] [MainThread]: Flushing usage events
[0m14:04:53.893055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200f358890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ee1b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200f359bb0>]}


============================== 14:04:53.895872 | b090d282-05c8-4230-b986-1233940ce519 ==============================
[0m14:04:53.895872 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:53.896600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:54.136053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200e864e60>]}
[0m14:04:54.196393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200f190620>]}
[0m14:04:54.198921 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:54.214532 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:54.215243 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:54.215776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ea56270>]}
[0m14:04:55.447626 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:55.448290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200738abd0>]}
[0m14:04:55.629886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:55.635069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2007761580>]}
[0m14:04:55.756378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2007102750>]}
[0m14:04:55.756933 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:55.757481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2007279fd0>]}
[0m14:04:55.759209 [info ] [MainThread]: 
[0m14:04:55.759937 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:55.764712 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:55.800203 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:55.800675 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:55.801070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:56.400450 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:56.402014 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:56.404047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:56.404614 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:56.411747 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.412174 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:56.412566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:56.419273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.420666 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.421065 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:56.421660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.422052 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.422431 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:56.423021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.423931 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:56.424327 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:56.424697 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:56.425245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.425644 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:56.427436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:56.434409 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:56.434819 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:56.435186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:56.441127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.441577 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:56.441972 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:56.465054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:56.466514 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:56.467695 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:56.468124 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:56.471345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2005fa28d0>]}
[0m14:04:56.471861 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:56.472259 [debug] [MainThread]: On master: BEGIN
[0m14:04:56.472634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:56.478810 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:56.479239 [debug] [MainThread]: On master: COMMIT
[0m14:04:56.479626 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:56.480010 [debug] [MainThread]: On master: COMMIT
[0m14:04:56.480543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:56.480948 [debug] [MainThread]: On master: Close
[0m14:04:56.482558 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:56.483082 [info ] [MainThread]: 
[0m14:04:56.492661 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:56.493281 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:56.493937 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:56.494380 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:56.520280 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:56.521032 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:56.557052 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:56.557833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:06.895637 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.896148 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:06.896777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.897259 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.897707 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:06.898446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.901969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.902590 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:06.903422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.929564 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:06.930221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.930770 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:06.932021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.936932 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:06.937432 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:06.938607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:06.940922 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:06.970671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ff06240>]}
[0m14:05:06.971433 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 10.48s]
[0m14:05:06.972384 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:06.973606 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:06.974185 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:06.974879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:06.975336 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:06.980652 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:06.981347 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:07.015942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.016456 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241102140507009980"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:07.016940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:07.032256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.040221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.040695 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:07.041353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.041800 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.042233 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241102140507009980'
      
      
      order by ordinal_position

  
[0m14:05:07.063383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.069969 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.070461 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:07.073528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.081197 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.081683 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:07.084411 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.102439 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:07.103151 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.103628 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241102140507009980"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241102140507009980"
    )
  
[0m14:05:07.134902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.136857 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:07.137365 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:07.137817 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:07.145513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:07.146415 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:07.310585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b090d282-05c8-4230-b986-1233940ce519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc3b7c8f0>]}
[0m14:05:07.311409 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m14:05:07.312174 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:07.313671 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.314162 [debug] [MainThread]: On master: BEGIN
[0m14:05:07.314602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:07.321290 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.321768 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.322213 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:07.322640 [debug] [MainThread]: On master: COMMIT
[0m14:05:07.323237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:07.323696 [debug] [MainThread]: On master: Close
[0m14:05:07.325014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:07.325510 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:07.325930 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:07.326398 [info ] [MainThread]: 
[0m14:05:07.326947 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 11.57 seconds (11.57s).
[0m14:05:07.327982 [debug] [MainThread]: Command end result
[0m14:05:07.356488 [info ] [MainThread]: 
[0m14:05:07.357167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:07.357717 [info ] [MainThread]: 
[0m14:05:07.358272 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:07.359305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.515763, "process_user_time": 5.674154, "process_kernel_time": 0.28471, "process_mem_max_rss": "291952", "process_in_blocks": "3808", "process_out_blocks": "114640"}
[0m14:05:07.359969 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:07.359857 after 13.52 seconds
[0m14:05:07.360467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200ffbc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fc811ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20073dd940>]}
[0m14:05:07.360962 [debug] [MainThread]: Flushing usage events
[0m14:05:09.227647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7d64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772e628f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7b2540>]}


============================== 14:05:09.230512 | 4376a041-977e-4c72-8442-5e24e84b13e9 ==============================
[0m14:05:09.230512 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:09.231319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:09.402820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4376a041-977e-4c72-8442-5e24e84b13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772e104a10>]}
[0m14:05:09.419209 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.24267696, "process_user_time": 1.404137, "process_kernel_time": 0.135626, "process_mem_max_rss": "92156", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:09.419787 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:09.419678 after 0.24 seconds
[0m14:05:09.420217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772df93860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772e104a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d7b0560>]}
[0m14:05:09.420647 [debug] [MainThread]: Flushing usage events
[0m22:06:20.006241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06148d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc063668440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06148d400>]}


============================== 22:06:20.013622 | 35c5634e-10bd-4a4a-86aa-2a36a90c453c ==============================
[0m22:06:20.013622 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:20.014286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:20.152981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35c5634e-10bd-4a4a-86aa-2a36a90c453c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0614b03e0>]}
[0m22:06:20.166336 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xbrengfd'
[0m22:06:20.166820 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:20.256328 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:20.256940 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:20.279108 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:20.282976 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:20.352894 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:20.353407 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:20.353937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35c5634e-10bd-4a4a-86aa-2a36a90c453c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06107bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc06103f680>]}
[0m22:06:20.354383 [info ] [MainThread]: 
[0m22:06:20.354858 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:20.356397 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3983425, "process_user_time": 1.611859, "process_kernel_time": 0.073081, "process_mem_max_rss": "93680", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:20.356965 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:20.356863 after 0.40 seconds
[0m22:06:20.357388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc061aad160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0618686e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0614b03e0>]}
[0m22:06:20.357805 [debug] [MainThread]: Flushing usage events
[0m22:06:21.960411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d32ec7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d6213410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2f96570>]}


============================== 22:06:21.963156 | 912133c3-7dac-409e-ab03-c2c3f5c562d9 ==============================
[0m22:06:21.963156 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:21.963829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:22.194966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2db5100>]}
[0m22:06:22.253988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d6213410>]}
[0m22:06:22.256406 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:22.341631 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:22.342361 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:22.342905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2c38470>]}
[0m22:06:23.570235 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:23.570918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cbdc3470>]}
[0m22:06:23.751047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:23.756027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cb7064e0>]}
[0m22:06:23.874893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cb7e10a0>]}
[0m22:06:23.875446 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:23.875954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38cb71ca40>]}
[0m22:06:23.877618 [info ] [MainThread]: 
[0m22:06:23.878295 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:23.883132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:23.919653 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:23.920100 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:23.920499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:24.407723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.409268 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:24.411564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:24.412131 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:24.419272 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.419708 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:24.420104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.426303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.427738 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.428152 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:24.428689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.429082 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.429460 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:24.430024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.430978 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.431387 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:24.431778 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:24.432311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.432713 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:24.434532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:24.441551 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.441963 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:24.442344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:24.448058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.448474 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:24.448874 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:24.472018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:24.473517 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:24.474778 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:24.475184 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:24.478568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d34c9730>]}
[0m22:06:24.479129 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.479526 [debug] [MainThread]: On master: BEGIN
[0m22:06:24.479900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:24.486196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.486663 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.487066 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:24.487447 [debug] [MainThread]: On master: COMMIT
[0m22:06:24.488003 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:24.488416 [debug] [MainThread]: On master: Close
[0m22:06:24.489917 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:24.490406 [info ] [MainThread]: 
[0m22:06:24.500428 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:24.501409 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:24.502388 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:24.502935 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:24.528863 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:24.529625 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:24.565220 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:24.565951 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:30.832527 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.833077 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:30.833704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.834158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.834595 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:30.835377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.838185 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.838673 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:30.839350 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.860182 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.860665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.861106 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:30.863077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.867993 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:30.868461 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:30.869595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.871918 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:30.901085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388c2c1a00>]}
[0m22:06:30.901800 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.40s]
[0m22:06:30.902721 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:30.903695 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:30.904263 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:30.904928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:30.905387 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:30.910345 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:30.911025 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:30.944746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.945264 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241102220630938766"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:30.945738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:30.960021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.967507 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.967971 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:30.968558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.969004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.969449 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241102220630938766'
      
      
      order by ordinal_position

  
[0m22:06:30.989683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:30.995728 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:30.996214 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:30.999360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.006810 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.007282 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:31.009945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.027858 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:31.028536 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.029009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241102220630938766"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241102220630938766"
    )
  
[0m22:06:31.059190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.061179 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.061638 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:31.062066 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:31.071293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:31.072233 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:31.241388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '912133c3-7dac-409e-ab03-c2c3f5c562d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f388c243cb0>]}
[0m22:06:31.242194 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.34s]
[0m22:06:31.242979 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:31.244434 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.244934 [debug] [MainThread]: On master: BEGIN
[0m22:06:31.245596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:31.252390 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.252867 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.253306 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:31.253740 [debug] [MainThread]: On master: COMMIT
[0m22:06:31.254318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:31.254819 [debug] [MainThread]: On master: Close
[0m22:06:31.256285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:31.256729 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:31.257139 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:31.257604 [info ] [MainThread]: 
[0m22:06:31.258142 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m22:06:31.259177 [debug] [MainThread]: Command end result
[0m22:06:31.287299 [info ] [MainThread]: 
[0m22:06:31.287919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:31.288426 [info ] [MainThread]: 
[0m22:06:31.288945 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:31.289936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.377785, "process_user_time": 5.462315, "process_kernel_time": 0.342639, "process_mem_max_rss": "290648", "process_in_blocks": "3808", "process_out_blocks": "114672"}
[0m22:06:31.290581 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:31.290471 after 9.38 seconds
[0m22:06:31.291121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38d2f96480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a5916540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a59f94c0>]}
[0m22:06:31.291604 [debug] [MainThread]: Flushing usage events
[0m22:06:32.914970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d9e5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9ca71e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9ca71d30>]}


============================== 22:06:32.917689 | 7ee3cd1d-106d-47a1-bc73-17cf6ccb94c1 ==============================
[0m22:06:32.917689 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:32.918425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:33.055249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ee3cd1d-106d-47a1-bc73-17cf6ccb94c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d01c0b0>]}
[0m22:06:33.071740 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20546384, "process_user_time": 1.398796, "process_kernel_time": 0.095917, "process_mem_max_rss": "92180", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:33.072310 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:33.072207 after 0.21 seconds
[0m22:06:33.072745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9c170f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9d1c9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9c11c500>]}
[0m22:06:33.073176 [debug] [MainThread]: Flushing usage events
[0m06:02:13.091116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342a81460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342bce1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342edb0e0>]}


============================== 06:02:13.098493 | 52aede50-c798-4277-9122-14f1a7110e1b ==============================
[0m06:02:13.098493 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.099155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.242479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52aede50-c798-4277-9122-14f1a7110e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342e957f0>]}
[0m06:02:13.256349 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3czfyp_v'
[0m06:02:13.256827 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:13.298178 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:13.298909 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:13.309948 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:13.313788 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:13.542158 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:13.542761 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:13.543311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '52aede50-c798-4277-9122-14f1a7110e1b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3428b4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34287b4d0>]}
[0m06:02:13.543782 [info ] [MainThread]: 
[0m06:02:13.544233 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.545799 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50323534, "process_user_time": 1.592267, "process_kernel_time": 0.104279, "process_mem_max_rss": "93768", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m06:02:13.546393 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.546290 after 0.50 seconds
[0m06:02:13.546837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342e8ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3432bc140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342e957f0>]}
[0m06:02:13.547312 [debug] [MainThread]: Flushing usage events
[0m06:02:15.367547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cab37500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cab36ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cab36f30>]}


============================== 06:02:15.370432 | fcd65862-d22f-44ea-969e-3bc4a9e41c7f ==============================
[0m06:02:15.370432 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:15.371105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.607972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cba2a870>]}
[0m06:02:15.667730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cbbc4590>]}
[0m06:02:15.670391 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:15.686594 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.687385 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.687925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ca8b0140>]}
[0m06:02:16.921508 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.922227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c34da000>]}
[0m06:02:17.103353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:17.108634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c34bf140>]}
[0m06:02:17.238989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c34858b0>]}
[0m06:02:17.239578 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:17.240079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c3294380>]}
[0m06:02:17.241802 [info ] [MainThread]: 
[0m06:02:17.242512 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:17.247468 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:17.283611 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:17.284104 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:17.284515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.768683 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.770292 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.772632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.773251 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.780689 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.781140 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.781547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.788099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.789605 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.790014 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.790562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.790960 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.791376 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.791948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.792882 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.793285 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.793667 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.794207 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.794619 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.796794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.803579 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.803993 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.804371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.810607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.811021 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.811446 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.833329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.834946 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.836270 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.836678 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.840296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c218ca40>]}
[0m06:02:17.840821 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.841214 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.841589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.848162 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.848601 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.848995 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.849375 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.849909 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.850325 [debug] [MainThread]: On master: Close
[0m06:02:17.851812 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.852310 [info ] [MainThread]: 
[0m06:02:17.861912 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.862558 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.863268 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:17.863713 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.890240 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.890988 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.927312 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.928135 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:29.057568 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.058124 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:29.058826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.059328 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.059766 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:29.060500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.063480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.063941 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:29.064625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.085762 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.086243 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.086682 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.087925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.092989 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.093457 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:29.094825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.097221 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:29.126837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0c33fcf80>]}
[0m06:02:29.127647 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.26s]
[0m06:02:29.128430 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:29.129413 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:29.129977 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:29.130549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:29.131012 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:29.136419 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:29.137098 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.171643 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.172196 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241103060229165603"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.172688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.188257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.196389 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.196896 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.197568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.198026 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.198479 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241103060229165603'
      
      
      order by ordinal_position

  
[0m06:02:29.220364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.226995 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.227515 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.230770 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.238642 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.239125 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.242116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.260321 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.261043 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.261516 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241103060229165603"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241103060229165603"
    )
  
[0m06:02:29.294029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.296130 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.296631 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.297074 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.306458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.307436 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:29.491387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd65862-d22f-44ea-969e-3bc4a9e41c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe080159490>]}
[0m06:02:29.492220 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m06:02:29.492972 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:29.494485 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.494969 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.495451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:29.502454 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.502939 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.503431 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.503862 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.504506 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.504961 [debug] [MainThread]: On master: Close
[0m06:02:29.506479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:29.506921 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:29.507367 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:29.507834 [info ] [MainThread]: 
[0m06:02:29.508372 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.27 seconds (12.27s).
[0m06:02:29.509370 [debug] [MainThread]: Command end result
[0m06:02:29.537185 [info ] [MainThread]: 
[0m06:02:29.537906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:29.538500 [info ] [MainThread]: 
[0m06:02:29.539094 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:29.540217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.220985, "process_user_time": 5.122275, "process_kernel_time": 0.346799, "process_mem_max_rss": "293356", "process_in_blocks": "3808", "process_out_blocks": "115152"}
[0m06:02:29.540859 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:29.540748 after 14.22 seconds
[0m06:02:29.541375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ce5bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe081341940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cb4cb680>]}
[0m06:02:29.541865 [debug] [MainThread]: Flushing usage events
[0m06:02:31.455312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b4e67620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b5075ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b4e66690>]}


============================== 06:02:31.458261 | 142e5287-c8c6-4cfe-a17a-edc6976be168 ==============================
[0m06:02:31.458261 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.458974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.603338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '142e5287-c8c6-4cfe-a17a-edc6976be168', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b53d26f0>]}
[0m06:02:31.620244 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21368173, "process_user_time": 1.417774, "process_kernel_time": 0.10783, "process_mem_max_rss": "92228", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:31.620828 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:31.620725 after 0.21 seconds
[0m06:02:31.621266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b5e2c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b4e66510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0b6462f30>]}
[0m06:02:31.621692 [debug] [MainThread]: Flushing usage events
[0m14:04:47.087650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d357d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d3827e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d3965070>]}


============================== 14:04:47.095216 | ac2919ac-830a-4970-bb66-1542c1b40a12 ==============================
[0m14:04:47.095216 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:47.095957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.241029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2919ac-830a-4970-bb66-1542c1b40a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d357f7a0>]}
[0m14:04:47.255273 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7avzfb1s'
[0m14:04:47.255742 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:47.365785 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:47.366551 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:47.397157 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:47.401146 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:47.763042 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:47.763608 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:47.764220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ac2919ac-830a-4970-bb66-1542c1b40a12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d33028d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d3302cc0>]}
[0m14:04:47.764673 [info ] [MainThread]: 
[0m14:04:47.765185 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:47.789317 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7526818, "process_user_time": 1.661102, "process_kernel_time": 0.100308, "process_mem_max_rss": "93620", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:04:47.789997 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:47.789893 after 0.75 seconds
[0m14:04:47.790504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d35c2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d324f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5d324df70>]}
[0m14:04:47.790969 [debug] [MainThread]: Flushing usage events
[0m14:04:49.674098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526da01ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526f4259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d109640>]}


============================== 14:04:49.677085 | 5cc27099-a5ff-4a04-900a-4b7330874407 ==============================
[0m14:04:49.677085 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:49.677846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.924176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d03ed80>]}
[0m14:04:49.988258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265f11b20>]}
[0m14:04:49.991003 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:50.007350 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:50.008086 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:50.008633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526cefbb60>]}
[0m14:04:51.254831 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:51.255505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265d37380>]}
[0m14:04:51.450535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:51.456000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52658ebb60>]}
[0m14:04:51.582181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52659d5dc0>]}
[0m14:04:51.582774 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:51.583316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52657b32c0>]}
[0m14:04:51.585050 [info ] [MainThread]: 
[0m14:04:51.585781 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:51.590584 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:51.626928 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:51.627396 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:51.627816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:52.190992 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:52.192610 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:52.194864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:52.195456 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:52.202868 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.203302 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:52.203703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.210131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.211643 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.212047 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:52.212659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.213057 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.213433 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:52.214000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.214954 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.215366 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:52.215748 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:52.216276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.216682 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:52.218634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:52.225745 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.226156 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:52.226559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:52.232175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.232598 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:52.233001 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:52.256225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:52.257652 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:52.258895 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:52.259306 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:52.262548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526e5ace30>]}
[0m14:04:52.263076 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.263470 [debug] [MainThread]: On master: BEGIN
[0m14:04:52.263842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:52.270184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.270647 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.271037 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:52.271415 [debug] [MainThread]: On master: COMMIT
[0m14:04:52.271985 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:52.272390 [debug] [MainThread]: On master: Close
[0m14:04:52.273997 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:52.274536 [info ] [MainThread]: 
[0m14:04:52.283898 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:52.284508 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:52.285189 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:52.285644 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:52.312622 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:52.313388 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:52.350629 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:52.351372 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:05.238268 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.238824 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:05.239483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.239952 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.240407 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:05.241113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.243975 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.244433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:05.245107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.266979 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:05.267480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.267953 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:05.269409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.274498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:05.274985 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:05.276352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.278709 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:05.307874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f522a30f9e0>]}
[0m14:05:05.308663 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.02s]
[0m14:05:05.309574 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:05.310586 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:05.311150 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:05.311807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:05.312259 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:05.317221 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:05.317874 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:05.351512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.352041 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241103140505345535"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:05.352532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:05.367068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.374581 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.375049 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:05.375645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.376090 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.376527 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241103140505345535'
      
      
      order by ordinal_position

  
[0m14:05:05.397248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.403588 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.404084 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:05.407519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.415004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.415478 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:05.418219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.436909 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:05.437613 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.438086 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241103140505345535"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241103140505345535"
    )
  
[0m14:05:05.470477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.472447 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:05.472911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:05.473334 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:05.482096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:05.483026 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:05.668595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc27099-a5ff-4a04-900a-4b7330874407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f522a36e2a0>]}
[0m14:05:05.669446 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m14:05:05.670213 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:05.671660 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.672185 [debug] [MainThread]: On master: BEGIN
[0m14:05:05.672637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:05.679330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.679790 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.680219 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:05.680634 [debug] [MainThread]: On master: COMMIT
[0m14:05:05.681201 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:05.681650 [debug] [MainThread]: On master: Close
[0m14:05:05.683028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:05.683463 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:05.683912 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:05.684367 [info ] [MainThread]: 
[0m14:05:05.684897 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.10 seconds (14.10s).
[0m14:05:05.685887 [debug] [MainThread]: Command end result
[0m14:05:05.713938 [info ] [MainThread]: 
[0m14:05:05.714577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:05.715099 [info ] [MainThread]: 
[0m14:05:05.715630 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:05.716635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.094795, "process_user_time": 5.616873, "process_kernel_time": 0.299194, "process_mem_max_rss": "297624", "process_in_blocks": "3808", "process_out_blocks": "115152"}
[0m14:05:05.717293 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:05.717179 after 16.10 seconds
[0m14:05:05.717792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526f4259d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526d4fc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f526580c2c0>]}
[0m14:05:05.718281 [debug] [MainThread]: Flushing usage events
[0m14:05:07.676126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c544620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c3371a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c4aa450>]}


============================== 14:05:07.678901 | f4fdb7f4-ddc7-4b89-9ee0-b88436b70c0d ==============================
[0m14:05:07.678901 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:07.679534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:07.821418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4fdb7f4-ddc7-4b89-9ee0-b88436b70c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c2e2e70>]}
[0m14:05:07.838175 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21326722, "process_user_time": 1.44353, "process_kernel_time": 0.124303, "process_mem_max_rss": "91996", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:07.838809 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:07.838701 after 0.21 seconds
[0m14:05:07.839257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c7bf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c3369c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53db61e80>]}
[0m14:05:07.839696 [debug] [MainThread]: Flushing usage events
[0m22:06:02.406512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00e83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f013b6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00cb2540>]}


============================== 22:06:02.427473 | 45b4c90b-ac99-4044-86a8-cea3e0e25a53 ==============================
[0m22:06:02.427473 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:02.428204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:02.577784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45b4c90b-ac99-4044-86a8-cea3e0e25a53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00439190>]}
[0m22:06:02.591810 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hc86e2ec'
[0m22:06:02.592307 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:02.782126 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:02.782957 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:02.851506 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:02.855723 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:03.240764 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:03.241393 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:03.241959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '45b4c90b-ac99-4044-86a8-cea3e0e25a53', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00174b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00198a10>]}
[0m22:06:03.242434 [info ] [MainThread]: 
[0m22:06:03.242950 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:03.276993 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.92011005, "process_user_time": 1.659421, "process_kernel_time": 0.126733, "process_mem_max_rss": "93272", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m22:06:03.277732 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:03.277609 after 0.92 seconds
[0m22:06:03.278218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00e83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00174b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f00176240>]}
[0m22:06:03.278693 [debug] [MainThread]: Flushing usage events
[0m22:06:05.225739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6273a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb63b1a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6273a600>]}


============================== 22:06:05.228696 | 5f3375ed-83f4-4373-8016-5b1343c314d8 ==============================
[0m22:06:05.228696 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:05.229451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:05.473803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb624feb40>]}
[0m22:06:05.534994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6273b170>]}
[0m22:06:05.537659 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:05.605719 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:05.606503 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:05.607076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b50ff50>]}
[0m22:06:06.863239 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:06.863946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b08a300>]}
[0m22:06:07.050814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:07.056373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae026f0>]}
[0m22:06:07.196455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae03260>]}
[0m22:06:07.197065 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:07.197595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae389e0>]}
[0m22:06:07.199460 [info ] [MainThread]: 
[0m22:06:07.200183 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:07.205286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:07.241836 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:07.242361 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:07.242790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:07.895967 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:07.897504 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:07.899727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:07.900292 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:07.907517 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.907997 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:07.908395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:07.914885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.916444 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.916848 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:07.917445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.917879 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.918259 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:07.918879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.919814 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:07.920213 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:07.920589 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:07.921183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.921605 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:07.923832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:07.931202 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:07.931637 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:07.932013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:07.938230 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.938648 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:07.939100 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:07.962285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:07.963966 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:07.965255 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:07.965689 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:07.969465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5ae87c50>]}
[0m22:06:07.970010 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.970405 [debug] [MainThread]: On master: BEGIN
[0m22:06:07.970811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:07.977241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.977697 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.978089 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.978466 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.979112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.979533 [debug] [MainThread]: On master: Close
[0m22:06:07.981049 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:07.981562 [info ] [MainThread]: 
[0m22:06:07.995018 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:07.995685 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:07.996373 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:07.996833 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:08.023487 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:08.024342 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:08.061049 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:08.061958 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:23.413181 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.413703 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:23.414371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.414840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.415275 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:23.415999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.419036 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.419492 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:23.420224 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.441575 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:23.442166 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.442624 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:23.445131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.450794 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:23.451317 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:23.452986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.455485 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:23.485518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b0a6ab0>]}
[0m22:06:23.486327 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 15.49s]
[0m22:06:23.487233 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:23.488269 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:23.488835 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:23.489515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:23.489974 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:23.495378 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:23.496052 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:23.530640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.531263 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241103220623524547"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:23.531740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:23.546317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.554357 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.554877 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:23.555579 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.556033 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.556475 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241103220623524547'
      
      
      order by ordinal_position

  
[0m22:06:23.577414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.585073 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.585681 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:23.589240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.598029 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.598653 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:23.602027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.620788 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:23.621598 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.622109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241103220623524547"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241103220623524547"
    )
  
[0m22:06:23.653143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.655353 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:23.655892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:23.656377 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:23.666385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:23.667565 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:23.856255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3375ed-83f4-4373-8016-5b1343c314d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb13900590>]}
[0m22:06:23.857162 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m22:06:23.858077 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:23.859758 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.860276 [debug] [MainThread]: On master: BEGIN
[0m22:06:23.860705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:23.867783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.868317 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.868752 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:23.869170 [debug] [MainThread]: On master: COMMIT
[0m22:06:23.869847 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:23.870302 [debug] [MainThread]: On master: Close
[0m22:06:23.872084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:23.872519 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:23.872933 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:23.873402 [info ] [MainThread]: 
[0m22:06:23.873930 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 16.67 seconds (16.67s).
[0m22:06:23.874976 [debug] [MainThread]: Command end result
[0m22:06:23.903641 [info ] [MainThread]: 
[0m22:06:23.904355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:23.904869 [info ] [MainThread]: 
[0m22:06:23.905384 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:23.906412 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.73013, "process_user_time": 5.888711, "process_kernel_time": 0.342181, "process_mem_max_rss": "295324", "process_in_blocks": "3808", "process_out_blocks": "116720"}
[0m22:06:23.907089 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:23.906975 after 18.73 seconds
[0m22:06:23.907594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb661bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb182664e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb5b0a4e60>]}
[0m22:06:23.908080 [debug] [MainThread]: Flushing usage events
[0m22:06:25.916681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d42bab950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d433a8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d43309280>]}


============================== 22:06:25.919635 | 0a9b469d-6bb7-467e-a409-cce609170678 ==============================
[0m22:06:25.919635 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:25.920373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:06:26.066211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a9b469d-6bb7-467e-a409-cce609170678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d4266f980>]}
[0m22:06:26.083405 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2158262, "process_user_time": 1.431461, "process_kernel_time": 0.119954, "process_mem_max_rss": "92376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:26.084004 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:26.083898 after 0.22 seconds
[0m22:06:26.084444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d44c15dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d438d2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d426fdbe0>]}
[0m22:06:26.084875 [debug] [MainThread]: Flushing usage events
[0m06:02:12.614348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750da867b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d4e7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d48eb70>]}


============================== 06:02:12.622064 | 1ae96c92-0028-4679-bbdf-87e0d01fd870 ==============================
[0m06:02:12.622064 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.622849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.771297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ae96c92-0028-4679-bbdf-87e0d01fd870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750ce9a750>]}
[0m06:02:12.785239 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6n__ac87'
[0m06:02:12.785728 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:12.831023 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:12.831672 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:12.843184 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:12.847088 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:12.997740 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:12.998389 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:12.999091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1ae96c92-0028-4679-bbdf-87e0d01fd870', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750cc4bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750cc4bc20>]}
[0m06:02:12.999572 [info ] [MainThread]: 
[0m06:02:13.000111 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:13.001866 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4384962, "process_user_time": 1.594374, "process_kernel_time": 0.142779, "process_mem_max_rss": "93576", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:13.002477 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:13.002371 after 0.44 seconds
[0m06:02:13.002956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d9dfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d23b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f750d2391f0>]}
[0m06:02:13.003394 [debug] [MainThread]: Flushing usage events
[0m06:02:14.696480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da55dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da55ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da55d5b0>]}


============================== 06:02:14.699547 | 6e0b30ee-2e98-44e5-964d-c2a2f6d6392a ==============================
[0m06:02:14.699547 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:14.700206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:14.940562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d2b34b90>]}
[0m06:02:15.000258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d9a370e0>]}
[0m06:02:15.002993 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:15.018783 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:15.019546 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:15.020070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d9b7aff0>]}
[0m06:02:16.247075 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:16.247700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d25df380>]}
[0m06:02:16.430705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:16.436093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d291ac00>]}
[0m06:02:16.564426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d24b9460>]}
[0m06:02:16.564994 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:16.565474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d234bbf0>]}
[0m06:02:16.567211 [info ] [MainThread]: 
[0m06:02:16.567915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:16.572603 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:16.608708 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:16.609195 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:16.609608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:17.057181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.058790 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:17.061049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:17.061599 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:17.068758 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.069188 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:17.069576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.076075 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.077541 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.077945 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:17.078498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.078936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.079313 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:17.079880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.080800 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.081192 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:17.081560 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:17.082157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.082574 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:17.084672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:17.091923 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.092333 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:17.092703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:17.098841 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.099250 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:17.099639 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:17.123144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:17.124714 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:17.125932 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:17.126327 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:17.129844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d2423a10>]}
[0m06:02:17.130360 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.130781 [debug] [MainThread]: On master: BEGIN
[0m06:02:17.131166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:17.137620 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.138059 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.138445 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:17.138857 [debug] [MainThread]: On master: COMMIT
[0m06:02:17.139447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:17.139851 [debug] [MainThread]: On master: Close
[0m06:02:17.141452 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:17.141947 [info ] [MainThread]: 
[0m06:02:17.151928 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:17.152542 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:17.153206 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:17.153641 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:17.179537 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:17.180310 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:17.216113 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:17.216905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:24.655862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.656384 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:24.657031 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.657487 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.657919 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:24.658625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.661512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.661963 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:24.662734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.683556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.684035 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.684468 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:24.685777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.690721 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:24.691208 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:24.692352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.694672 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:24.724142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84933c1cd0>]}
[0m06:02:24.724902 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.57s]
[0m06:02:24.725779 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:24.726809 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:24.727438 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:24.728113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:24.728563 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:24.733762 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:24.734420 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:24.768270 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.768835 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241104060224762235"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:24.769305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:24.786556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.794614 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.795129 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:24.795767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.796209 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.796639 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241104060224762235'
      
      
      order by ordinal_position

  
[0m06:02:24.822978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.829673 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.830168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.833158 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.840892 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.841383 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:24.844396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.862541 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:24.863351 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.863835 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241104060224762235"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241104060224762235"
    )
  
[0m06:02:24.897188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.899272 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.899727 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:24.900147 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:24.909483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:24.910379 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:25.103326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e0b30ee-2e98-44e5-964d-c2a2f6d6392a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8492e46b10>]}
[0m06:02:25.104403 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:25.105381 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:25.106850 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.107316 [debug] [MainThread]: On master: BEGIN
[0m06:02:25.107750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:25.114779 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.115263 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.115695 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:25.116109 [debug] [MainThread]: On master: COMMIT
[0m06:02:25.116725 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:25.117174 [debug] [MainThread]: On master: Close
[0m06:02:25.118794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:25.119229 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:25.119628 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:25.120082 [info ] [MainThread]: 
[0m06:02:25.120665 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m06:02:25.121776 [debug] [MainThread]: Command end result
[0m06:02:25.149997 [info ] [MainThread]: 
[0m06:02:25.150784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:25.151378 [info ] [MainThread]: 
[0m06:02:25.151973 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:25.153085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.5054865, "process_user_time": 5.537707, "process_kernel_time": 0.376115, "process_mem_max_rss": "301460", "process_in_blocks": "3808", "process_out_blocks": "116696"}
[0m06:02:25.153729 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:25.153616 after 10.51 seconds
[0m06:02:25.154224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84dbf7dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84da03c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d25bd1c0>]}
[0m06:02:25.154713 [debug] [MainThread]: Flushing usage events
[0m06:02:26.940397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4326709220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4325c1e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4325c1c860>]}


============================== 06:02:26.943338 | 7253273c-a5ea-4a00-97f3-65cd194a0604 ==============================
[0m06:02:26.943338 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.944085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.090336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7253273c-a5ea-4a00-97f3-65cd194a0604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f432575fc20>]}
[0m06:02:27.107697 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21862893, "process_user_time": 1.466848, "process_kernel_time": 0.095924, "process_mem_max_rss": "92152", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:27.108311 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:27.108195 after 0.22 seconds
[0m06:02:27.108770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43287bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4324ec0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4324beb290>]}
[0m06:02:27.109213 [debug] [MainThread]: Flushing usage events
[0m14:05:18.773590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978e49a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978ce3c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978ce3cf80>]}


============================== 14:05:18.790519 | f3de81ee-c081-45d9-a940-1fbe67adde03 ==============================
[0m14:05:18.790519 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.791279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.927918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3de81ee-c081-45d9-a940-1fbe67adde03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978ce94d70>]}
[0m14:05:18.941414 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f_mcs2p2'
[0m14:05:18.941870 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:19.039840 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:19.040488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:19.064011 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:19.067801 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:19.140852 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:19.141356 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:19.141875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3de81ee-c081-45d9-a940-1fbe67adde03', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978da07830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978c28fb00>]}
[0m14:05:19.142328 [info ] [MainThread]: 
[0m14:05:19.142797 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:19.151455 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42592555, "process_user_time": 1.5428, "process_kernel_time": 0.149825, "process_mem_max_rss": "93792", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:19.152132 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:19.152028 after 0.43 seconds
[0m14:05:19.152586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f978c66a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97901bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97901bbd40>]}
[0m14:05:19.153002 [debug] [MainThread]: Flushing usage events
[0m14:05:20.742051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8c55850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8f48b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8c57c50>]}


============================== 14:05:20.744880 | 83d04a3e-2fc7-413b-bf01-8b87665c6015 ==============================
[0m14:05:20.744880 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:20.745608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:20.985014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff1b94080>]}
[0m14:05:21.043771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ffa7d7920>]}
[0m14:05:21.046264 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:21.073215 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:21.073980 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:21.074503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff1a12120>]}
[0m14:05:22.303560 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:22.304215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff148ee40>]}
[0m14:05:22.483350 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:22.488458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff196b710>]}
[0m14:05:22.612192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff13bc710>]}
[0m14:05:22.612728 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:22.613206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff137caa0>]}
[0m14:05:22.614860 [info ] [MainThread]: 
[0m14:05:22.615536 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:22.620264 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:22.655348 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:22.655789 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:22.656213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:23.357105 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:23.358648 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:23.360840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:23.361430 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:23.368650 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.369085 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:23.369480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.375651 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.377135 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.377545 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:23.378084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.378475 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.378850 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:23.379419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.380373 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:23.380782 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:23.381163 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:23.381701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.382103 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:23.384075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:23.390684 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:23.391111 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:23.391501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.397415 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.397825 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:23.398223 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:23.419972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:23.421470 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:23.422687 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:23.423094 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:23.426355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff130baa0>]}
[0m14:05:23.426863 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.427252 [debug] [MainThread]: On master: BEGIN
[0m14:05:23.427614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:23.433794 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.434217 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.434615 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.434987 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.435507 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.435906 [debug] [MainThread]: On master: Close
[0m14:05:23.437271 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:23.437760 [info ] [MainThread]: 
[0m14:05:23.452761 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:23.453357 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:23.454013 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:23.454446 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:23.480247 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:23.480989 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:23.517243 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:23.518054 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:30.730358 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.730877 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:30.731504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.731957 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.732433 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:30.733136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.735981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.736462 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:30.737133 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.757920 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.758401 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.758844 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:30.761097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.766027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:30.766503 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:30.768346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.770651 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:30.802733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fadf0c290>]}
[0m14:05:30.803447 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.35s]
[0m14:05:30.804245 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:30.805236 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:30.805817 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:30.806388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:30.806841 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:30.811890 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:30.812573 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:30.846704 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.847224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241104140530840770"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:30.847699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:30.861879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.869570 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.870032 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:30.870624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.871068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.871499 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241104140530840770'
      
      
      order by ordinal_position

  
[0m14:05:30.891972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.898223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.898709 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.901542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.909136 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.909612 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:30.912671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.930760 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:30.931451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.931932 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241104140530840770"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241104140530840770"
    )
  
[0m14:05:30.963534 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.965544 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.966017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:30.966447 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:30.976400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:30.977303 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:31.649384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83d04a3e-2fc7-413b-bf01-8b87665c6015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fadf101d0>]}
[0m14:05:31.650233 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.84s]
[0m14:05:31.651033 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:31.652507 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.652985 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.653417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:31.659987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.660499 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.660939 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:31.661375 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.661953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:31.662404 [debug] [MainThread]: On master: Close
[0m14:05:31.663965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:31.664451 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:31.664861 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:31.665333 [info ] [MainThread]: 
[0m14:05:31.665875 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.05 seconds (9.05s).
[0m14:05:31.666910 [debug] [MainThread]: Command end result
[0m14:05:31.694894 [info ] [MainThread]: 
[0m14:05:31.695579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:31.696193 [info ] [MainThread]: 
[0m14:05:31.696800 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:31.697897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.004663, "process_user_time": 5.943849, "process_kernel_time": 0.3893, "process_mem_max_rss": "358632", "process_in_blocks": "3808", "process_out_blocks": "132656"}
[0m14:05:31.698539 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:31.698427 after 11.01 seconds
[0m14:05:31.699029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8c55850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff13881a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faebec710>]}
[0m14:05:31.699509 [debug] [MainThread]: Flushing usage events
[0m14:05:33.350566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b1980e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83bec8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b96c2f0>]}


============================== 14:05:33.353441 | f7e8d24d-c08b-4f0e-b167-4559fa1e2f51 ==============================
[0m14:05:33.353441 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:33.354160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.496572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e8d24d-c08b-4f0e-b167-4559fa1e2f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83af02900>]}
[0m14:05:33.513656 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21192129, "process_user_time": 1.417222, "process_kernel_time": 0.099804, "process_mem_max_rss": "92120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:33.514250 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:33.514145 after 0.21 seconds
[0m14:05:33.514684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83b237c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83af27ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83af43890>]}
[0m14:05:33.515112 [debug] [MainThread]: Flushing usage events
[0m22:05:35.092821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd931f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd32f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd2fd070>]}


============================== 22:05:35.153181 | 285d845e-7a49-4900-8f66-4ac27f9495c6 ==============================
[0m22:05:35.153181 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.153857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.296748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '285d845e-7a49-4900-8f66-4ac27f9495c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd1792b0>]}
[0m22:05:35.310198 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ojz9cll9'
[0m22:05:35.310669 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:35.408302 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:35.408952 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:35.422877 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:35.426762 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:35.600707 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:35.601353 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:35.601978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '285d845e-7a49-4900-8f66-4ac27f9495c6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddcf3ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddcf3fe60>]}
[0m22:05:35.602445 [info ] [MainThread]: 
[0m22:05:35.602994 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:35.613089 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.56825286, "process_user_time": 1.595094, "process_kernel_time": 0.100194, "process_mem_max_rss": "93748", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:05:35.613776 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:35.613671 after 0.57 seconds
[0m22:05:35.614228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd299ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddd983d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddcf3fe60>]}
[0m22:05:35.614658 [debug] [MainThread]: Flushing usage events
[0m22:05:37.272038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb660d7e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66034e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66034e5d0>]}


============================== 22:05:37.274862 | d6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e ==============================
[0m22:05:37.274862 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:37.275597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:37.516818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65ffeb590>]}
[0m22:05:37.576767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65ffbf290>]}
[0m22:05:37.579373 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:37.629812 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:37.630569 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:37.631164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6615c7830>]}
[0m22:05:38.874651 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:38.875330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6591b1a60>]}
[0m22:05:39.062331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:39.067797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb658b6de50>]}
[0m22:05:39.250231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb658a9c8f0>]}
[0m22:05:39.250869 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:39.251390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb658bd1130>]}
[0m22:05:39.253174 [info ] [MainThread]: 
[0m22:05:39.253883 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:39.259030 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:39.295992 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:39.296522 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:39.296949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:39.909140 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:39.910738 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:39.913178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:39.913780 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:39.921250 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.921697 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:39.922106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.928475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.929981 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.930406 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:39.931050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.931454 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.931835 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:39.932461 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.933403 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.933804 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:39.934177 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:39.934706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.935169 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:39.937292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:39.944674 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.945094 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:39.945472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:39.951642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.952057 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:39.952456 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:39.975837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:39.977394 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:39.978634 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:39.979100 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:39.982738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6618810a0>]}
[0m22:05:39.983305 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.983704 [debug] [MainThread]: On master: BEGIN
[0m22:05:39.984086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:39.990526 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.990992 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.991396 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:39.991780 [debug] [MainThread]: On master: COMMIT
[0m22:05:39.992371 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:39.992786 [debug] [MainThread]: On master: Close
[0m22:05:39.994370 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:39.994922 [info ] [MainThread]: 
[0m22:05:40.036115 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.036794 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.037513 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:40.037959 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.063877 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.064734 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.102956 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.104080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:48.524199 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.524721 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:48.525413 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.525874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.526311 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:48.527071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.530000 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.530458 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:48.531184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.552110 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.552603 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.553131 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.554918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.559956 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.560427 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:48.561970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.564373 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:48.595259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb661836240>]}
[0m22:05:48.596086 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.56s]
[0m22:05:48.596893 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:48.597924 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:48.598502 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:48.599149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:48.599609 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:48.604996 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:48.605654 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:48.639851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.640420 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241104220548633884"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:48.640900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:48.655503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.663444 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.663934 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:48.664569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.665021 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.665465 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241104220548633884'
      
      
      order by ordinal_position

  
[0m22:05:48.686539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.693284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.693789 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.697181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.704918 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.705400 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.708405 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.726371 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:48.727143 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.727623 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241104220548633884"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241104220548633884"
    )
  
[0m22:05:48.757973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.760131 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.760640 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.761094 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.771154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.772207 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:48.945571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6bd5867-2e3d-44cc-bcc7-ac502c9bbe1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6155e6300>]}
[0m22:05:48.946407 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m22:05:48.947213 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:48.948814 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.949295 [debug] [MainThread]: On master: BEGIN
[0m22:05:48.949730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:48.956659 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.957142 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.957584 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.958012 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.958601 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.959100 [debug] [MainThread]: On master: Close
[0m22:05:48.960903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:48.961342 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:48.961755 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:48.962227 [info ] [MainThread]: 
[0m22:05:48.962780 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.71 seconds (9.71s).
[0m22:05:48.963871 [debug] [MainThread]: Command end result
[0m22:05:48.992353 [info ] [MainThread]: 
[0m22:05:48.993044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:48.993604 [info ] [MainThread]: 
[0m22:05:48.994166 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:48.995272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.772239, "process_user_time": 5.767354, "process_kernel_time": 0.332193, "process_mem_max_rss": "294664", "process_in_blocks": "3808", "process_out_blocks": "114760"}
[0m22:05:48.995933 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:48.995818 after 11.77 seconds
[0m22:05:48.996450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb660d7e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6618809e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66002d280>]}
[0m22:05:48.996950 [debug] [MainThread]: Flushing usage events
[0m22:05:50.779321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea3c54980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea206d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea3c1e300>]}


============================== 22:05:50.782297 | 1284abb4-7818-4c0e-8978-9a75e0d5201c ==============================
[0m22:05:50.782297 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.783010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.949320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1284abb4-7818-4c0e-8978-9a75e0d5201c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea18b79e0>]}
[0m22:05:50.966227 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23743306, "process_user_time": 1.485748, "process_kernel_time": 0.076089, "process_mem_max_rss": "92388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:50.966819 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:50.966715 after 0.24 seconds
[0m22:05:50.967302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea3c54980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea1cd86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea1cd9730>]}
[0m22:05:50.967737 [debug] [MainThread]: Flushing usage events
[0m06:02:11.348815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e68da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e8d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e68500>]}


============================== 06:02:11.356424 | fed73414-93e1-4e3b-9949-138817aff127 ==============================
[0m06:02:11.356424 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:11.357110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m06:02:11.505756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed73414-93e1-4e3b-9949-138817aff127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44624f1280>]}
[0m06:02:11.519788 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-037hb3to'
[0m06:02:11.520252 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:11.592707 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:11.593342 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:11.604639 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:11.608520 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:11.657363 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:11.657872 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:11.658391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fed73414-93e1-4e3b-9949-138817aff127', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446224fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446224ffe0>]}
[0m06:02:11.658842 [info ] [MainThread]: 
[0m06:02:11.659322 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:11.662917 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3746829, "process_user_time": 1.613286, "process_kernel_time": 0.135771, "process_mem_max_rss": "93648", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:11.663527 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:11.663424 after 0.38 seconds
[0m06:02:11.664006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462e39f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f446252cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4462bf5ca0>]}
[0m06:02:11.664428 [debug] [MainThread]: Flushing usage events
[0m06:02:13.295087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452a16540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452d0a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452cc2540>]}


============================== 06:02:13.297936 | 4b681688-2b1b-45d5-b609-69665da476b7 ==============================
[0m06:02:13.297936 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:13.298682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:13.538091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b930c80>]}
[0m06:02:13.600172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84532ac830>]}
[0m06:02:13.602686 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:13.622700 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:13.623419 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:13.623990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8453aa1280>]}
[0m06:02:14.851237 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.851916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452a9e840>]}
[0m06:02:15.031493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:15.036472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b378f50>]}
[0m06:02:15.158448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b35f6e0>]}
[0m06:02:15.158984 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:15.159488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b294920>]}
[0m06:02:15.161168 [info ] [MainThread]: 
[0m06:02:15.161941 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:15.166618 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:15.202275 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:15.202733 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:15.203148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.680119 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.681697 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.683966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.684547 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.691759 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.692198 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.692584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.698811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.700323 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.700725 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.701261 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.701650 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.702025 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.702605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.703512 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.703957 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.704332 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.704866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.705269 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.707077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.714208 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.714626 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.715001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.720853 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.721260 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.721649 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.745089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.746655 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.747899 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.748312 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.751779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844b2ba5d0>]}
[0m06:02:15.752300 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.752696 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.753066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.759392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.759857 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.760248 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.760622 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.761172 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.761577 [debug] [MainThread]: On master: Close
[0m06:02:15.762881 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.763412 [info ] [MainThread]: 
[0m06:02:15.773242 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.773852 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.774585 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.775030 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.801147 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.801897 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.837620 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.838381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:23.464202 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.464716 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:23.465379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.465836 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.466263 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:23.467025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.469990 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.470443 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:23.471122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.491620 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.492112 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.492542 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:23.494703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.499663 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:23.500125 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:23.501442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.503770 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:23.532921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84208d2ae0>]}
[0m06:02:23.533693 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.76s]
[0m06:02:23.534464 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:23.535465 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:23.536064 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:23.536648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:23.537104 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:23.542335 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:23.542995 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:23.576768 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.577310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241105060223570864"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:23.577798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:23.592657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.600402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.600870 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:23.601477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.601919 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.602355 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241105060223570864'
      
      
      order by ordinal_position

  
[0m06:02:23.623295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.629744 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.630224 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.633072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.640694 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.641170 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:23.643998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.661942 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:23.662657 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.663124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241105060223570864"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241105060223570864"
    )
  
[0m06:02:23.694185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.696246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.696708 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:23.697133 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:23.706572 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:23.707535 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:23.887598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b681688-2b1b-45d5-b609-69665da476b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840bbf67b0>]}
[0m06:02:23.888448 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.35s]
[0m06:02:23.889216 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:23.890621 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.891104 [debug] [MainThread]: On master: BEGIN
[0m06:02:23.891541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:23.898364 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.898841 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.899279 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:23.899734 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.900323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:23.900776 [debug] [MainThread]: On master: Close
[0m06:02:23.902328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:23.902764 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:23.903165 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:23.903625 [info ] [MainThread]: 
[0m06:02:23.904274 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m06:02:23.905417 [debug] [MainThread]: Command end result
[0m06:02:23.934314 [info ] [MainThread]: 
[0m06:02:23.935060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:23.935673 [info ] [MainThread]: 
[0m06:02:23.936275 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:23.937379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.692699, "process_user_time": 5.507336, "process_kernel_time": 0.375137, "process_mem_max_rss": "297000", "process_in_blocks": "3808", "process_out_blocks": "115256"}
[0m06:02:23.938048 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:23.937935 after 10.69 seconds
[0m06:02:23.938545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452d0a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8440f537a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8452e3c4a0>]}
[0m06:02:23.939034 [debug] [MainThread]: Flushing usage events
[0m06:02:25.608459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a620064e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a616fbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a63999b50>]}


============================== 06:02:25.611334 | 17908328-82f3-490a-ab5d-45f8ee3bef09 ==============================
[0m06:02:25.611334 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.612096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.758420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17908328-82f3-490a-ab5d-45f8ee3bef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a61b83170>]}
[0m06:02:25.775715 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21762906, "process_user_time": 1.391092, "process_kernel_time": 0.148329, "process_mem_max_rss": "91872", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:25.776307 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:25.776202 after 0.22 seconds
[0m06:02:25.776745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a615f1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a61e86b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a62b0da60>]}
[0m06:02:25.777170 [debug] [MainThread]: Flushing usage events
[0m14:05:14.536027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af2cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af2db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9af2dc10>]}


============================== 14:05:14.573405 | 262606af-4a34-4d76-9ae1-27c56102b9e5 ==============================
[0m14:05:14.573405 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:14.574116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:14.717796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '262606af-4a34-4d76-9ae1-27c56102b9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9aff6840>]}
[0m14:05:14.731708 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5r9e4o4a'
[0m14:05:14.732188 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:14.772428 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:14.773155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:14.798831 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:14.802831 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:14.894164 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:14.894896 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:14.895559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '262606af-4a34-4d76-9ae1-27c56102b9e5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a56b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a5dec60>]}
[0m14:05:14.896068 [info ] [MainThread]: 
[0m14:05:14.896604 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:14.898744 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41106024, "process_user_time": 1.586378, "process_kernel_time": 0.139857, "process_mem_max_rss": "93764", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m14:05:14.899362 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:14.899254 after 0.41 seconds
[0m14:05:14.899819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a8c5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9a56b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a9abe7bc0>]}
[0m14:05:14.900265 [debug] [MainThread]: Flushing usage events
[0m14:05:16.585832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3287e02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3295821e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd329582e40>]}


============================== 14:05:16.588878 | 96fbab98-9525-4d6e-8e9a-f6721b8d98fb ==============================
[0m14:05:16.588878 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.589533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.833092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd321511400>]}
[0m14:05:16.892480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3284f97c0>]}
[0m14:05:16.895065 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:17.004678 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:17.005507 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:17.006084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd321434ce0>]}
[0m14:05:18.249057 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:18.249812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320e61100>]}
[0m14:05:18.436493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:18.441862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32144ade0>]}
[0m14:05:18.681548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320fd45f0>]}
[0m14:05:18.682139 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:18.682726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320ee6a80>]}
[0m14:05:18.684480 [info ] [MainThread]: 
[0m14:05:18.685218 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:18.690359 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:18.726627 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:18.727129 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:18.727531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:19.259998 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:19.261547 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:19.263607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:19.264250 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:19.271356 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.271786 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:19.272176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.278519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.280006 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.280442 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:19.280991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.281389 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.281771 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:19.282414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.283327 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:19.283730 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:19.284100 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:19.284704 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.285117 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:19.287104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:19.294231 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:19.294699 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:19.295077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.301000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.301410 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:19.301802 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:19.325269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:19.326897 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:19.328137 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:19.328544 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:19.332201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320d9aff0>]}
[0m14:05:19.332758 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.333160 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.333541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:19.340305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.340749 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.341141 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:19.341517 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.342051 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:19.342501 [debug] [MainThread]: On master: Close
[0m14:05:19.343925 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:19.344434 [info ] [MainThread]: 
[0m14:05:19.388071 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:19.388751 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:19.389465 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:19.389907 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:19.416144 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:19.416894 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:19.453255 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:19.454151 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:26.224003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.224543 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:26.225275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.225739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.226184 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:26.227041 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.230169 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.230676 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:26.231454 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.252311 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.252807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.253255 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:26.255642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.260759 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:26.261244 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:26.262659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.265039 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:26.295312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e15ff9e0>]}
[0m14:05:26.296107 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.90s]
[0m14:05:26.296899 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:26.297881 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:26.298484 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:26.299092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:26.299546 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:26.304957 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:26.305660 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:26.340011 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.340544 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241105140526334003"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:26.341027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.356330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.364213 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.364693 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:26.365320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.365777 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.366222 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241105140526334003'
      
      
      order by ordinal_position

  
[0m14:05:26.387581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.394862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.395401 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.398398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.406364 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.406911 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:26.409997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.428447 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:26.429203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.429684 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241105140526334003"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241105140526334003"
    )
  
[0m14:05:26.466012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.468069 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.468535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:26.468964 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:26.477447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:26.478397 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:26.671301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fbab98-9525-4d6e-8e9a-f6721b8d98fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e16403e0>]}
[0m14:05:26.672135 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:26.673007 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:26.674502 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.674981 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.675413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:26.682243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.682775 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.683217 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:26.683649 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.684221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:26.684671 [debug] [MainThread]: On master: Close
[0m14:05:26.686324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:26.686805 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:26.687212 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:26.687677 [info ] [MainThread]: 
[0m14:05:26.688232 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m14:05:26.689280 [debug] [MainThread]: Command end result
[0m14:05:26.717501 [info ] [MainThread]: 
[0m14:05:26.718204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:26.718776 [info ] [MainThread]: 
[0m14:05:26.719332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:26.720407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.183106, "process_user_time": 5.700784, "process_kernel_time": 0.312701, "process_mem_max_rss": "297680", "process_in_blocks": "3808", "process_out_blocks": "115760"}
[0m14:05:26.721078 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:26.720955 after 10.18 seconds
[0m14:05:26.721583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2e15fbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd328afc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd328467530>]}
[0m14:05:26.722069 [debug] [MainThread]: Flushing usage events
[0m14:05:28.404737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd7b4a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd48e3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd4814fe0>]}


============================== 14:05:28.407660 | 0dba4e3c-45dd-4478-b028-296cf15c1ed2 ==============================
[0m14:05:28.407660 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:28.408374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.562931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dba4e3c-45dd-4478-b028-296cf15c1ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd53a7fb0>]}
[0m14:05:28.579854 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22388662, "process_user_time": 1.430672, "process_kernel_time": 0.103903, "process_mem_max_rss": "92120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:28.580473 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:28.580364 after 0.22 seconds
[0m14:05:28.580923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd81bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd44e7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabd45e9d00>]}
[0m14:05:28.581370 [debug] [MainThread]: Flushing usage events
[0m22:05:54.149361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48651c3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865eda060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865343b30>]}


============================== 22:05:54.157295 | 3fde295f-1b91-4f70-9c8f-773c2248c5a3 ==============================
[0m22:05:54.157295 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.157962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.297740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fde295f-1b91-4f70-9c8f-773c2248c5a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865c99dc0>]}
[0m22:05:54.310949 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-skspxlxs'
[0m22:05:54.311383 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:54.452348 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:54.453015 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:54.485167 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:54.489012 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:54.826834 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:54.827377 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:54.827887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3fde295f-1b91-4f70-9c8f-773c2248c5a3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4864ae49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4864ae7c50>]}
[0m22:05:54.828344 [info ] [MainThread]: 
[0m22:05:54.828842 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:54.830468 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7293067, "process_user_time": 1.552266, "process_kernel_time": 0.108297, "process_mem_max_rss": "93680", "process_in_blocks": "6280", "process_out_blocks": "3992"}
[0m22:05:54.831048 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:54.830947 after 0.73 seconds
[0m22:05:54.831483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48687bbd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48651a2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865219bb0>]}
[0m22:05:54.831883 [debug] [MainThread]: Flushing usage events
[0m22:05:56.528629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec5c70>]}


============================== 22:05:56.531334 | c2c8c150-3144-4779-8307-0ebd15f36244 ==============================
[0m22:05:56.531334 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:56.531997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:56.759343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079423590>]}
[0m22:05:56.817806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90793d93d0>]}
[0m22:05:56.820355 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:56.836494 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:56.837266 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:56.837797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90792bf830>]}
[0m22:05:58.064305 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:58.064949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9072192090>]}
[0m22:05:58.244835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:58.249981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9071d2db20>]}
[0m22:05:58.368748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9071c489e0>]}
[0m22:05:58.369304 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:58.369781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9071de9d30>]}
[0m22:05:58.371450 [info ] [MainThread]: 
[0m22:05:58.372124 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:58.376872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:58.412455 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:58.412962 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:58.413371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:59.042620 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:59.044089 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:59.046201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:59.046764 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:59.053648 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.054040 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:59.054397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.060606 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.062010 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.062412 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:59.062955 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.063358 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.063736 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:59.064304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.065249 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.065651 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:59.066021 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:59.066551 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.066951 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:59.068932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:59.075904 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.076320 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:59.076727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:59.082571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.083025 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:59.083423 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:59.106917 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:59.108393 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:59.109658 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:59.110061 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:59.113456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907234ae70>]}
[0m22:05:59.113985 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.114380 [debug] [MainThread]: On master: BEGIN
[0m22:05:59.114748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:59.121310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.121731 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.122122 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:59.122497 [debug] [MainThread]: On master: COMMIT
[0m22:05:59.123020 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:59.123419 [debug] [MainThread]: On master: Close
[0m22:05:59.125109 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:59.125603 [info ] [MainThread]: 
[0m22:05:59.135206 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:59.135897 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:59.136572 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:59.137029 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:59.163113 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:59.163868 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:59.199563 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:59.200300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:12.311499 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.312034 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:12.312748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.313201 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.313690 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:12.314489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.317542 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.318004 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:12.318688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.339424 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:12.339909 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.340343 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:12.341621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.346684 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:12.347143 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:12.348357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.350763 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:12.380469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9079ec6540>]}
[0m22:06:12.381355 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 13.24s]
[0m22:06:12.382179 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:12.383202 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:12.383774 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:12.384398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:12.384893 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:12.390347 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:12.391025 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:12.424747 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.425316 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241105220612418769"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:12.425786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:12.441173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.448910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.449385 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:12.450002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.450447 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.450881 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241105220612418769'
      
      
      order by ordinal_position

  
[0m22:06:12.472017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.478779 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.479282 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:12.482650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.490463 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.490940 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:12.494070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.511950 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:12.512725 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.513211 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241105220612418769"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241105220612418769"
    )
  
[0m22:06:12.547069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.549189 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:12.549665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:12.550098 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:12.558397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:12.559329 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:12.785807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c8c150-3144-4779-8307-0ebd15f36244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90327e90a0>]}
[0m22:06:12.786721 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.40s]
[0m22:06:12.787601 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:12.789391 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.789900 [debug] [MainThread]: On master: BEGIN
[0m22:06:12.790413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:12.798075 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.798609 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.799065 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:12.799535 [debug] [MainThread]: On master: COMMIT
[0m22:06:12.800142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:12.800678 [debug] [MainThread]: On master: Close
[0m22:06:12.802459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:12.802907 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:12.803309 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:12.803896 [info ] [MainThread]: 
[0m22:06:12.804700 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.43 seconds (14.43s).
[0m22:06:12.806316 [debug] [MainThread]: Command end result
[0m22:06:12.857781 [info ] [MainThread]: 
[0m22:06:12.858516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:12.859147 [info ] [MainThread]: 
[0m22:06:12.859711 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:12.861082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.380198, "process_user_time": 5.677478, "process_kernel_time": 0.363582, "process_mem_max_rss": "294552", "process_in_blocks": "3808", "process_out_blocks": "116816"}
[0m22:06:12.861735 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:12.861619 after 16.38 seconds
[0m22:06:12.862306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907998ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907950dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90794fa5d0>]}
[0m22:06:12.863004 [debug] [MainThread]: Flushing usage events
[0m22:06:14.898577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd062780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd965e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd062810>]}


============================== 22:06:14.901449 | e1b4e3d8-5a47-4988-8bc8-0bcde87c0d9f ==============================
[0m22:06:14.901449 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:14.902097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:15.046388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b4e3d8-5a47-4988-8bc8-0bcde87c0d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8300bbbd10>]}
[0m22:06:15.062937 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21310821, "process_user_time": 1.416649, "process_kernel_time": 0.115726, "process_mem_max_rss": "92164", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:15.063523 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:15.063419 after 0.21 seconds
[0m22:06:15.063955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fd1adee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fcfabbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fdb007d0>]}
[0m22:06:15.064370 [debug] [MainThread]: Flushing usage events
[0m06:02:25.118227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde38628470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3752ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde3752dc40>]}


============================== 06:02:25.125710 | 66f8a0fe-2865-42fb-8d52-02182d002859 ==============================
[0m06:02:25.125710 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:25.126372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:25.267404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66f8a0fe-2865-42fb-8d52-02182d002859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde379e05f0>]}
[0m06:02:25.281258 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-an1o0rai'
[0m06:02:25.281753 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:25.404893 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:25.405616 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:25.418293 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:25.422230 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:25.637285 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:25.637873 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:25.638409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '66f8a0fe-2865-42fb-8d52-02182d002859', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36dc1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36a4cd70>]}
[0m06:02:25.638878 [info ] [MainThread]: 
[0m06:02:25.639364 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:25.641089 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.571136, "process_user_time": 1.598108, "process_kernel_time": 0.139834, "process_mem_max_rss": "93720", "process_in_blocks": "6280", "process_out_blocks": "4000"}
[0m06:02:25.641682 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:25.641579 after 0.57 seconds
[0m06:02:25.642135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde37186b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36dc1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde36be7890>]}
[0m06:02:25.642555 [debug] [MainThread]: Flushing usage events
[0m06:02:27.412753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef1a55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0efe87bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef301a30>]}


============================== 06:02:27.415513 | b9c75bd4-c779-4d14-8ffc-8f2178b9db36 ==============================
[0m06:02:27.415513 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:27.416180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:27.650850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ee6bcef0>]}
[0m06:02:27.709893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ee6bf2f0>]}
[0m06:02:27.712372 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:27.728344 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:27.729055 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:27.729592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e7717b90>]}
[0m06:02:28.989420 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:28.990090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e73623f0>]}
[0m06:02:29.171153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:29.176401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e717f5c0>]}
[0m06:02:29.296861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e70b0560>]}
[0m06:02:29.297406 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:29.297885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e708fa10>]}
[0m06:02:29.299577 [info ] [MainThread]: 
[0m06:02:29.300268 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:29.305044 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:29.340649 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:29.341133 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:29.341538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:29.952645 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:29.954217 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:29.956413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:29.956972 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:29.964120 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.964568 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:29.964967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.971127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.972577 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.972990 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:29.973529 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.973925 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.974303 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:29.974895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.975811 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.976276 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:29.976655 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:29.977209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.977610 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:29.979440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:29.986452 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.986871 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:29.987244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:29.993198 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:29.993609 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:29.994014 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:30.017487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:30.019026 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:30.020289 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:30.020700 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:30.024169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef7a6b70>]}
[0m06:02:30.024704 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.025101 [debug] [MainThread]: On master: BEGIN
[0m06:02:30.025476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:30.031855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.032316 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.032704 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:30.033082 [debug] [MainThread]: On master: COMMIT
[0m06:02:30.033640 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:30.034044 [debug] [MainThread]: On master: Close
[0m06:02:30.035521 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:30.036067 [info ] [MainThread]: 
[0m06:02:30.045760 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:30.046358 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:30.047097 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:30.047540 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:30.073322 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:30.074101 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:30.109678 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:30.110417 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:38.537997 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.538538 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:38.539267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.539736 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.540216 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:38.540947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.543935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.544432 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:38.545203 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.566253 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.566732 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.567170 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:38.568749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.573724 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:38.574193 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:38.575404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.577778 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:38.607673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0efe5a300>]}
[0m06:02:38.608531 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.56s]
[0m06:02:38.609312 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:38.610334 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:38.610905 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:38.611494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:38.611956 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:38.617327 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:38.617997 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:38.651468 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.651988 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241106060238645552"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:38.652504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:38.667222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.674618 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.675087 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:38.675694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.676163 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.676603 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241106060238645552'
      
      
      order by ordinal_position

  
[0m06:02:38.697623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.704176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.704673 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.707514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.715460 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.715940 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:38.718809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.736720 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:38.737439 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.737910 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241106060238645552"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241106060238645552"
    )
  
[0m06:02:38.771652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.773714 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.774207 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:38.774644 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:38.783509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:38.784481 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:38.976995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c75bd4-c779-4d14-8ffc-8f2178b9db36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a3b7c650>]}
[0m06:02:38.977825 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:38.978575 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:38.980060 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.980563 [debug] [MainThread]: On master: BEGIN
[0m06:02:38.981003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:38.987888 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.988413 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.988852 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:38.989273 [debug] [MainThread]: On master: COMMIT
[0m06:02:38.989850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:38.990325 [debug] [MainThread]: On master: Close
[0m06:02:38.991841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:38.992323 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:38.992724 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:38.993175 [info ] [MainThread]: 
[0m06:02:38.993766 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.69 seconds (9.69s).
[0m06:02:38.994887 [debug] [MainThread]: Command end result
[0m06:02:39.023175 [info ] [MainThread]: 
[0m06:02:39.023851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:39.024467 [info ] [MainThread]: 
[0m06:02:39.025077 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:39.026154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.661576, "process_user_time": 5.544053, "process_kernel_time": 0.312906, "process_mem_max_rss": "294832", "process_in_blocks": "3808", "process_out_blocks": "116792"}
[0m06:02:39.026795 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:39.026686 after 11.66 seconds
[0m06:02:39.027283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ef3fd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e7100890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e7100b60>]}
[0m06:02:39.027764 [debug] [MainThread]: Flushing usage events
[0m06:02:40.931510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50c2cff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50b9c6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50b9c5970>]}


============================== 06:02:40.934368 | 42db5966-42ba-4e3d-948e-79fa91632c3a ==============================
[0m06:02:40.934368 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:40.935093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:41.078186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42db5966-42ba-4e3d-948e-79fa91632c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50bceefc0>]}
[0m06:02:41.094411 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21129295, "process_user_time": 1.438648, "process_kernel_time": 0.091913, "process_mem_max_rss": "92132", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:41.094990 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:41.094887 after 0.21 seconds
[0m06:02:41.095461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50ba62720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f5bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50c2cc680>]}
[0m06:02:41.095901 [debug] [MainThread]: Flushing usage events
[0m14:05:15.825078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f56853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f5aea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f5685400>]}


============================== 14:05:15.842729 | 33e25c7e-3f8a-428b-bd38-81a5fbab4214 ==============================
[0m14:05:15.842729 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:15.843428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:15.986484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e25c7e-3f8a-428b-bd38-81a5fbab4214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f5ab4c20>]}
[0m14:05:15.999931 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cordz5z4'
[0m14:05:16.000392 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.017748 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.018393 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.031184 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.034991 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.084597 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.085108 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.085606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '33e25c7e-3f8a-428b-bd38-81a5fbab4214', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f55289b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f53dfb60>]}
[0m14:05:16.086054 [info ] [MainThread]: 
[0m14:05:16.086512 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.118012 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.34073734, "process_user_time": 1.5602, "process_kernel_time": 0.138142, "process_mem_max_rss": "93920", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:16.118717 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.118614 after 0.34 seconds
[0m14:05:16.119202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f56853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f54efad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f53dfb60>]}
[0m14:05:16.119643 [debug] [MainThread]: Flushing usage events
[0m14:05:17.706808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e9d62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e94d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0ea726f0>]}


============================== 14:05:17.709661 | 24172f70-c997-40a7-9995-c516096820b7 ==============================
[0m14:05:17.709661 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:17.710335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:17.947926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e64d2e0>]}
[0m14:05:18.007260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e64eb10>]}
[0m14:05:18.009854 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.096102 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.096886 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.097425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0e7f5070>]}
[0m14:05:19.322271 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:19.322934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd072a8080>]}
[0m14:05:19.505102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:19.510170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0703d220>]}
[0m14:05:19.733004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0703d580>]}
[0m14:05:19.733596 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:19.734102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd07087170>]}
[0m14:05:19.735806 [info ] [MainThread]: 
[0m14:05:19.736538 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:19.741428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:19.777529 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:19.778023 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:19.778430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:20.346178 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:20.347768 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:20.349979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:20.350567 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:20.357925 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.358367 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:20.358762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:20.364985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.366450 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.366853 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:20.367394 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.367785 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.368159 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:20.368801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.369730 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:20.370136 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:20.370522 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:20.371066 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.371476 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:20.374172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:20.381005 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:20.381426 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:20.381800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:20.388220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.388666 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:20.389065 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:20.412391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:20.413955 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:20.415172 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:20.415581 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:20.418958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0716d640>]}
[0m14:05:20.419474 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:20.419857 [debug] [MainThread]: On master: BEGIN
[0m14:05:20.420224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:20.426444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:20.426863 [debug] [MainThread]: On master: COMMIT
[0m14:05:20.427245 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:20.427615 [debug] [MainThread]: On master: COMMIT
[0m14:05:20.428139 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:20.428532 [debug] [MainThread]: On master: Close
[0m14:05:20.429957 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:20.430454 [info ] [MainThread]: 
[0m14:05:20.466258 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:20.466873 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:20.467519 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:20.467953 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:20.493744 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:20.494531 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:20.530509 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:20.531268 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:28.066491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.067002 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:28.067650 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.068101 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.068531 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:28.069296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.072164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.072653 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:28.073329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.094011 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.094488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.094925 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.096150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.101134 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.101598 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:28.102846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.105199 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:28.134453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc4d262d0>]}
[0m14:05:28.135204 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.67s]
[0m14:05:28.136084 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:28.137078 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:28.137642 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:28.138320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:28.138781 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:28.144029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:28.144728 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:28.178019 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.178530 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241106140528172194"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:28.178998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:28.193821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.201381 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.201852 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:28.202438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.202877 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.203305 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241106140528172194'
      
      
      order by ordinal_position

  
[0m14:05:28.223907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.230156 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.230642 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.233593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.241148 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.241628 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.244628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.262547 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:28.263241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.263710 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241106140528172194"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241106140528172194"
    )
  
[0m14:05:28.297403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.299453 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.299907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.300332 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.310582 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.311515 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:29.145768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24172f70-c997-40a7-9995-c516096820b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcbfb9d790>]}
[0m14:05:29.146606 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 1.01s]
[0m14:05:29.147473 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:29.149090 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.149568 [debug] [MainThread]: On master: BEGIN
[0m14:05:29.149996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:29.156951 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.157425 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.157858 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:29.158277 [debug] [MainThread]: On master: COMMIT
[0m14:05:29.158857 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:29.159306 [debug] [MainThread]: On master: Close
[0m14:05:29.160925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:29.161361 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:29.161764 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:29.162227 [info ] [MainThread]: 
[0m14:05:29.162773 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m14:05:29.163816 [debug] [MainThread]: Command end result
[0m14:05:29.191820 [info ] [MainThread]: 
[0m14:05:29.192457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:29.193016 [info ] [MainThread]: 
[0m14:05:29.193563 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:29.194597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.536099, "process_user_time": 6.094646, "process_kernel_time": 0.371673, "process_mem_max_rss": "365744", "process_in_blocks": "3808", "process_out_blocks": "133680"}
[0m14:05:29.195253 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:29.195141 after 11.54 seconds
[0m14:05:29.195745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0712d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0ecea540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc4af4e60>]}
[0m14:05:29.196230 [debug] [MainThread]: Flushing usage events
[0m14:05:30.872968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706186690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706636270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e00920>]}


============================== 14:05:30.875854 | 440c7741-2344-4658-b3d4-743037d571a8 ==============================
[0m14:05:30.875854 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.876624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.021011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '440c7741-2344-4658-b3d4-743037d571a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb706aa4d10>]}
[0m14:05:31.037844 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21315528, "process_user_time": 1.429201, "process_kernel_time": 0.08407, "process_mem_max_rss": "92268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:31.038428 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:31.038324 after 0.21 seconds
[0m14:05:31.038864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705d64710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e008c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb705e00920>]}
[0m14:05:31.039299 [debug] [MainThread]: Flushing usage events
[0m22:05:35.984242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f519b018350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199c725a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199c90fe0>]}


============================== 22:05:35.992164 | 59b432ba-8ea5-4ce1-9242-5216517fa8c6 ==============================
[0m22:05:35.992164 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.992923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:36.146462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59b432ba-8ea5-4ce1-9242-5216517fa8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f519958f770>]}
[0m22:05:36.161425 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rdvgq2b3'
[0m22:05:36.162004 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:36.215079 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:36.215859 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:36.227313 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:36.231323 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:36.385363 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:36.386014 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:36.386553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '59b432ba-8ea5-4ce1-9242-5216517fa8c6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199483b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199483fe0>]}
[0m22:05:36.387024 [info ] [MainThread]: 
[0m22:05:36.387497 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:36.397496 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46209285, "process_user_time": 1.620861, "process_kernel_time": 0.120063, "process_mem_max_rss": "93660", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:36.398260 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:36.398134 after 0.46 seconds
[0m22:05:36.398761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51998bbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f519941c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5199437a10>]}
[0m22:05:36.399188 [debug] [MainThread]: Flushing usage events
[0m22:05:38.106003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20eade3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea9fbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea9fa540>]}


============================== 22:05:38.108856 | ef8e5f1d-7c53-44f2-b1f1-82ee3175054e ==============================
[0m22:05:38.108856 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.109577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.347876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea2ca9f0>]}
[0m22:05:38.408219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea9a3950>]}
[0m22:05:38.410924 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:38.454235 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:38.454998 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:38.455517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea8a21b0>]}
[0m22:05:39.711797 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:39.712497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea3f72f0>]}
[0m22:05:39.896619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:39.901999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea41aa20>]}
[0m22:05:40.070476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e2ecc230>]}
[0m22:05:40.071087 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:40.071563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e2dbd280>]}
[0m22:05:40.073335 [info ] [MainThread]: 
[0m22:05:40.074081 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:40.079045 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:40.116099 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:40.116627 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:40.117029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:40.487850 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.489438 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:40.491732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:40.492292 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:40.499550 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.499993 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:40.500388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.507019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.508611 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.509034 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:40.509612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.510015 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.510396 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:40.511008 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.511935 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.512340 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:40.512723 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:40.513309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.513752 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:40.515972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:40.523433 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.523877 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:40.524321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:40.530802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.531237 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:40.531631 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:40.555615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:40.557259 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:40.558552 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:40.558965 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:40.562922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e2c87bf0>]}
[0m22:05:40.563465 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.563862 [debug] [MainThread]: On master: BEGIN
[0m22:05:40.564241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:40.570828 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.571266 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.571658 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.572032 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.572578 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.572998 [debug] [MainThread]: On master: Close
[0m22:05:40.574624 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:40.575156 [info ] [MainThread]: 
[0m22:05:40.585497 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:40.586202 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:40.586963 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:40.587408 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:40.613549 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:40.614427 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:40.651269 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:40.652144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:48.155073 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.155594 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:48.156241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.156684 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.157120 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:48.157882 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.160850 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.161300 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:48.162018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.182877 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.183395 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.183833 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:48.185847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.191005 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:48.191474 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:48.192869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.195318 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:48.226412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e1b868a0>]}
[0m22:05:48.227248 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.64s]
[0m22:05:48.228033 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:48.229057 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:48.229657 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:48.230278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:48.230734 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:48.236138 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:48.236810 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:48.270772 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.271352 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241106220548264714"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:48.271837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:48.287124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.295180 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.295662 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:48.296296 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.296752 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.297199 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241106220548264714'
      
      
      order by ordinal_position

  
[0m22:05:48.318708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.325979 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.326506 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.329553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.337488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.338003 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:48.340833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.359061 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:48.359851 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.360328 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241106220548264714"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241106220548264714"
    )
  
[0m22:05:48.392435 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.394504 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.394965 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:48.395396 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:48.404436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:48.405340 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:48.590152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef8e5f1d-7c53-44f2-b1f1-82ee3175054e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20a75d6480>]}
[0m22:05:48.590978 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.36s]
[0m22:05:48.591760 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:48.593382 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.593903 [debug] [MainThread]: On master: BEGIN
[0m22:05:48.594337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:48.601294 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.601807 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.602247 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:48.602674 [debug] [MainThread]: On master: COMMIT
[0m22:05:48.603250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:48.603704 [debug] [MainThread]: On master: Close
[0m22:05:48.605311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:48.605799 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:48.606206 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:48.606677 [info ] [MainThread]: 
[0m22:05:48.607270 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m22:05:48.608546 [debug] [MainThread]: Command end result
[0m22:05:48.638202 [info ] [MainThread]: 
[0m22:05:48.638989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:48.639591 [info ] [MainThread]: 
[0m22:05:48.640193 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:48.641325 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.583901, "process_user_time": 5.386291, "process_kernel_time": 0.319457, "process_mem_max_rss": "290752", "process_in_blocks": "3808", "process_out_blocks": "115792"}
[0m22:05:48.642015 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:48.641899 after 10.58 seconds
[0m22:05:48.642529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea461fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e021ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20ea2ca570>]}
[0m22:05:48.643020 [debug] [MainThread]: Flushing usage events
[0m22:05:50.444591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b898b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017bc5cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b7b4fe0>]}


============================== 22:05:50.447620 | 0940f7c1-9bcd-4008-8485-a0edd4f2a2cb ==============================
[0m22:05:50.447620 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:50.448336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:50.604417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0940f7c1-9bcd-4008-8485-a0edd4f2a2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b32e060>]}
[0m22:05:50.622250 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22670075, "process_user_time": 1.481416, "process_kernel_time": 0.099825, "process_mem_max_rss": "92024", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:50.622871 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:50.622763 after 0.23 seconds
[0m22:05:50.623338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b20a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b274d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017b14f440>]}
[0m22:05:50.623783 [debug] [MainThread]: Flushing usage events
[0m06:02:15.640841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b7258a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ba513470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b9599c70>]}


============================== 06:02:15.664102 | 88085911-d50c-4ad5-831e-1e4dc0dbb627 ==============================
[0m06:02:15.664102 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:15.664776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:15.802959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88085911-d50c-4ad5-831e-1e4dc0dbb627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b7027410>]}
[0m06:02:15.816951 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j38tj8t3'
[0m06:02:15.817440 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:15.862327 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:15.862953 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:15.873126 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:15.876885 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:15.920612 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:15.921199 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:15.921772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '88085911-d50c-4ad5-831e-1e4dc0dbb627', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b705f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b76819a0>]}
[0m06:02:15.922226 [info ] [MainThread]: 
[0m06:02:15.922718 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:15.928641 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.33622625, "process_user_time": 1.589677, "process_kernel_time": 0.104109, "process_mem_max_rss": "93676", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:15.929328 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:15.929223 after 0.34 seconds
[0m06:02:15.929758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ba513470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b7e55e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8b7258980>]}
[0m06:02:15.930186 [debug] [MainThread]: Flushing usage events
[0m06:02:17.502274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df7664320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df58e6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df5602f90>]}


============================== 06:02:17.505176 | 886e995d-e821-4c51-88cb-a0a69d13d8b9 ==============================
[0m06:02:17.505176 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.505809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.739724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df53834a0>]}
[0m06:02:17.799992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df6bf2330>]}
[0m06:02:17.802617 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:17.823534 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:17.824272 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:17.824814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df5536a20>]}
[0m06:02:19.053135 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:19.053789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedef8ec0>]}
[0m06:02:19.233618 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:19.238810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedcd7e30>]}
[0m06:02:19.385870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedea01a0>]}
[0m06:02:19.386428 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:19.386993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedd2b470>]}
[0m06:02:19.388679 [info ] [MainThread]: 
[0m06:02:19.389404 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:19.394289 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:19.430037 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:19.430536 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:19.430989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:19.916774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.918316 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:19.920546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:19.921103 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:19.928240 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.928669 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:19.929062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.935430 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.936875 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.937276 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:19.937815 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.938206 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.938581 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:19.939201 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.940112 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.940519 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:19.940895 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:19.941409 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.941813 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:19.943808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:19.950863 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.951285 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:19.951655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:19.957393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.957800 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:19.958189 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:19.981627 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:19.983123 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:19.984335 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:19.984729 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:19.987928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dee3ee960>]}
[0m06:02:19.988460 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.988849 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.989216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:19.995614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.996046 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.996438 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.996815 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.997395 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.997809 [debug] [MainThread]: On master: Close
[0m06:02:19.999616 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:20.000150 [info ] [MainThread]: 
[0m06:02:20.015060 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:20.015675 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:20.016427 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:20.016877 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:20.043354 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:20.044136 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:20.080330 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:20.081098 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:27.014376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.014920 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:27.015553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.016016 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.016455 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:27.017173 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.020030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.020487 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:27.021186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.041934 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.042419 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.042931 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:27.044200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.049109 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:27.049586 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:27.050782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.053095 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:27.082708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dedec8500>]}
[0m06:02:27.083446 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.07s]
[0m06:02:27.084209 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:27.085196 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:27.085756 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:27.086323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:27.086805 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:27.091934 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:27.092600 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:27.126017 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.126533 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241107060227120141"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:27.127027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:27.141604 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.149020 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.149493 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:27.150087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.150550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.151017 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241107060227120141'
      
      
      order by ordinal_position

  
[0m06:02:27.171944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.178137 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.178626 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.181681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.189512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.189983 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:27.192733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.210806 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:27.211480 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.211945 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241107060227120141"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241107060227120141"
    )
  
[0m06:02:27.248926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.250930 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.251385 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:27.251810 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:27.261169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:27.262040 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:27.451577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '886e995d-e821-4c51-88cb-a0a69d13d8b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4daa860440>]}
[0m06:02:27.452408 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m06:02:27.453163 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:27.454575 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.455087 [debug] [MainThread]: On master: BEGIN
[0m06:02:27.455515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:27.462232 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.462743 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.463187 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:27.463608 [debug] [MainThread]: On master: COMMIT
[0m06:02:27.464192 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:27.464640 [debug] [MainThread]: On master: Close
[0m06:02:27.466046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:27.466480 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:27.466925 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:27.467386 [info ] [MainThread]: 
[0m06:02:27.467941 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m06:02:27.468960 [debug] [MainThread]: Command end result
[0m06:02:27.496751 [info ] [MainThread]: 
[0m06:02:27.497392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:27.497941 [info ] [MainThread]: 
[0m06:02:27.498495 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:27.499559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.045883, "process_user_time": 5.503848, "process_kernel_time": 0.355731, "process_mem_max_rss": "296008", "process_in_blocks": "3808", "process_out_blocks": "116800"}
[0m06:02:27.500205 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:27.500094 after 10.05 seconds
[0m06:02:27.500693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df6031d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4db3fca6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dec195670>]}
[0m06:02:27.501175 [debug] [MainThread]: Flushing usage events
[0m06:02:29.138348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb35ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefc1eec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb9f2180>]}


============================== 06:02:29.141216 | 81c4c674-d8b1-42cc-92d2-e6497a092f8c ==============================
[0m06:02:29.141216 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:29.141854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.279829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81c4c674-d8b1-42cc-92d2-e6497a092f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefe813470>]}
[0m06:02:29.296248 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20813411, "process_user_time": 1.423048, "process_kernel_time": 0.10393, "process_mem_max_rss": "92136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:29.296819 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:29.296718 after 0.21 seconds
[0m06:02:29.297263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefbd6f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefc323290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb432cf0>]}
[0m06:02:29.297684 [debug] [MainThread]: Flushing usage events
[0m14:05:11.452252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e35fe840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e48d0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e35fe8a0>]}


============================== 14:05:11.459476 | 034a2525-a7ea-4759-8470-0da95ead0dae ==============================
[0m14:05:11.459476 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:11.460143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:11.595099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '034a2525-a7ea-4759-8470-0da95ead0dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e3003800>]}
[0m14:05:11.608291 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jddigt7m'
[0m14:05:11.608740 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:11.670786 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:11.671396 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:11.681586 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:11.685342 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:11.820923 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:11.821486 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:11.822047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '034a2525-a7ea-4759-8470-0da95ead0dae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e3217e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e4219970>]}
[0m14:05:11.822484 [info ] [MainThread]: 
[0m14:05:11.823047 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:11.843932 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4396419, "process_user_time": 1.545338, "process_kernel_time": 0.130759, "process_mem_max_rss": "93500", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m14:05:11.844518 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:11.844415 after 0.44 seconds
[0m14:05:11.844941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e48d0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e3077ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e3217e60>]}
[0m14:05:11.845369 [debug] [MainThread]: Flushing usage events
[0m14:05:13.410108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce422f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce423fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce4234a0>]}


============================== 14:05:13.412847 | ad7fc489-224d-42bf-995e-6dca15675f33 ==============================
[0m14:05:13.412847 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:13.413558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:13.644621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce4a3e30>]}
[0m14:05:13.703594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39cfb612e0>]}
[0m14:05:13.706066 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:13.721336 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:13.722047 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:13.722587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ceaba8a0>]}
[0m14:05:14.944773 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:14.945401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c74c2360>]}
[0m14:05:15.126809 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:15.132102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c6d3c3b0>]}
[0m14:05:15.265953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c6d05ac0>]}
[0m14:05:15.266526 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:15.267036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c6e69eb0>]}
[0m14:05:15.268723 [info ] [MainThread]: 
[0m14:05:15.269422 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:15.274122 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:15.309851 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:15.310305 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:15.310708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:15.819763 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:15.821302 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:15.823367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:15.823927 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:15.831184 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.831634 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:15.832028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.838110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.839583 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.839991 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:15.840546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.841008 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.841402 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:15.841969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.842913 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.843325 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:15.843752 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:15.844383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.844839 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:15.846656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:15.853617 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.854033 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:15.854420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:15.860197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.860610 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:15.861007 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:15.884454 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:15.885885 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:15.887142 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:15.887547 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:15.890754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39cfba8e00>]}
[0m14:05:15.891303 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.891701 [debug] [MainThread]: On master: BEGIN
[0m14:05:15.892073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:15.898223 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.898650 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.899083 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:15.899474 [debug] [MainThread]: On master: COMMIT
[0m14:05:15.900015 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:15.900417 [debug] [MainThread]: On master: Close
[0m14:05:15.901940 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:15.902423 [info ] [MainThread]: 
[0m14:05:15.912015 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:15.912614 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:15.913240 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:15.913681 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:15.939729 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:15.940482 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:15.975965 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:15.976704 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:23.280590 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.281096 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:23.281723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.282180 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.282609 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:23.283356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.286188 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.286637 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:23.287346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.308102 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.308576 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.309030 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:23.311543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.316467 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:23.316937 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:23.318605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.321011 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:23.351395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39880f0bc0>]}
[0m14:05:23.352127 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.44s]
[0m14:05:23.352932 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:23.353960 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:23.354530 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:23.355165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:23.355618 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:23.360816 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:23.361471 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:23.395223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.395745 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241107140523389325"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:23.396215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:23.411046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.418506 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.418994 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:23.419599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.420046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.420480 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241107140523389325'
      
      
      order by ordinal_position

  
[0m14:05:23.449517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.455716 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.456203 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.459099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.466582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.467080 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:23.469868 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.487739 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:23.488434 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.488905 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241107140523389325"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241107140523389325"
    )
  
[0m14:05:23.522897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.524902 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.525359 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:23.525784 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:23.534802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:23.535718 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:23.732115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7fc489-224d-42bf-995e-6dca15675f33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39838715e0>]}
[0m14:05:23.732926 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m14:05:23.733692 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:23.735190 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.735665 [debug] [MainThread]: On master: BEGIN
[0m14:05:23.736098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:23.742666 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.743181 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.743616 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:23.744034 [debug] [MainThread]: On master: COMMIT
[0m14:05:23.744607 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:23.745057 [debug] [MainThread]: On master: Close
[0m14:05:23.746384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:23.746823 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:23.747281 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:23.747750 [info ] [MainThread]: 
[0m14:05:23.748294 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m14:05:23.749311 [debug] [MainThread]: Command end result
[0m14:05:23.777329 [info ] [MainThread]: 
[0m14:05:23.777965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:23.778496 [info ] [MainThread]: 
[0m14:05:23.779067 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:23.780096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.417994, "process_user_time": 5.595816, "process_kernel_time": 0.331278, "process_mem_max_rss": "297304", "process_in_blocks": "3808", "process_out_blocks": "116784"}
[0m14:05:23.780747 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:23.780637 after 10.42 seconds
[0m14:05:23.781238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ce5f6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ceab8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c5aad250>]}
[0m14:05:23.781731 [debug] [MainThread]: Flushing usage events
[0m14:05:25.488003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561bf975f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561ba9c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561bdd6ab0>]}


============================== 14:05:25.490774 | 608cd604-6b93-40df-b583-736722a1d479 ==============================
[0m14:05:25.490774 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.491444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.637991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '608cd604-6b93-40df-b583-736722a1d479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561b47b9b0>]}
[0m14:05:25.654975 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21483752, "process_user_time": 1.424165, "process_kernel_time": 0.080234, "process_mem_max_rss": "92280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:25.655709 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:25.655604 after 0.22 seconds
[0m14:05:25.656336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561bbcba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561bbca3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f561b973aa0>]}
[0m14:05:25.656868 [debug] [MainThread]: Flushing usage events
[0m22:05:40.068530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb9598920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb9147a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb9147e30>]}


============================== 22:05:40.075971 | 651283ab-ff6e-4b2c-b61e-6e7eff22ec50 ==============================
[0m22:05:40.075971 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.076713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.220470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '651283ab-ff6e-4b2c-b61e-6e7eff22ec50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb887d790>]}
[0m22:05:40.234179 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qzh62x6f'
[0m22:05:40.234656 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:40.391427 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:40.392189 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:40.419480 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:40.423366 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:40.468591 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:40.469178 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:40.469727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '651283ab-ff6e-4b2c-b61e-6e7eff22ec50', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb86dc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb8839310>]}
[0m22:05:40.470211 [info ] [MainThread]: 
[0m22:05:40.470696 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:40.472272 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45164326, "process_user_time": 1.590065, "process_kernel_time": 0.111304, "process_mem_max_rss": "93496", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:40.472868 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:40.472763 after 0.45 seconds
[0m22:05:40.473307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb98dc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb8fed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeb853e6f0>]}
[0m22:05:40.473730 [debug] [MainThread]: Flushing usage events
[0m22:05:42.161333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02eed2cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02eeca22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ef9f1580>]}


============================== 22:05:42.164235 | ae91fada-c27c-4824-97cb-abf566c11902 ==============================
[0m22:05:42.164235 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.164859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.404347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ee67b590>]}
[0m22:05:42.465865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ee7e57c0>]}
[0m22:05:42.468542 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:42.484157 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:42.484909 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:42.485424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ee6b0710>]}
[0m22:05:43.725704 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:43.726379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e72f0b60>]}
[0m22:05:43.908798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:43.914148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ee6eca10>]}
[0m22:05:44.067952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e72ceb40>]}
[0m22:05:44.068541 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:44.069027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e70a41a0>]}
[0m22:05:44.070816 [info ] [MainThread]: 
[0m22:05:44.071524 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:44.076526 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:44.113185 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:44.113745 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:44.114182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:44.617202 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:44.618780 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:44.620989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:44.621539 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:44.628698 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:44.629130 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:44.629529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:44.635763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.637229 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:44.637633 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:44.638281 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.638674 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:44.639047 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:44.639621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.640600 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:44.640996 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:44.641369 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:44.641949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.642357 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:44.644276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:44.651475 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:44.651893 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:44.652263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:44.658314 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.658724 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:44.659116 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:44.682626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:44.684196 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:44.685449 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:44.685879 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:44.689379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e70a7530>]}
[0m22:05:44.689938 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.690346 [debug] [MainThread]: On master: BEGIN
[0m22:05:44.690724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:44.697115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.697562 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.697990 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:44.698366 [debug] [MainThread]: On master: COMMIT
[0m22:05:44.698900 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:44.699299 [debug] [MainThread]: On master: Close
[0m22:05:44.700736 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:44.701225 [info ] [MainThread]: 
[0m22:05:44.710898 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:44.711495 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:44.712144 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:44.712582 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:44.738739 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:44.739534 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:44.775261 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:44.776113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.449738 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.450309 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.451040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.451498 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.451935 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.452692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.455769 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.456226 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.456908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.477911 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.478428 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.478863 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.480200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.485297 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.485760 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.487055 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.489439 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.520561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e7110da0>]}
[0m22:05:51.521399 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.81s]
[0m22:05:51.522338 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.523377 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.523958 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.524562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.525020 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.530453 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.531119 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:51.565008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.565543 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241107220551559086"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:51.566046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:51.581120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.589024 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.589511 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:51.590177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.590624 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.591059 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241107220551559086'
      
      
      order by ordinal_position

  
[0m22:05:51.612901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.619971 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.620569 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.623922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.631955 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.632474 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.635686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.654457 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:51.655313 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.655802 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241107220551559086"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241107220551559086"
    )
  
[0m22:05:51.693472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.695681 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.696167 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.696601 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.707114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.708200 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:52.389705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae91fada-c27c-4824-97cb-abf566c11902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ac57aea0>]}
[0m22:05:52.390562 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.87s]
[0m22:05:52.391298 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:52.392716 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.393237 [debug] [MainThread]: On master: BEGIN
[0m22:05:52.393678 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:52.400556 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.401035 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.401464 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.401916 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.402558 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.403013 [debug] [MainThread]: On master: Close
[0m22:05:52.404516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:52.404950 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:52.405351 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:52.405810 [info ] [MainThread]: 
[0m22:05:52.406456 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m22:05:52.407579 [debug] [MainThread]: Command end result
[0m22:05:52.436318 [info ] [MainThread]: 
[0m22:05:52.437088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:52.437676 [info ] [MainThread]: 
[0m22:05:52.438317 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:52.439433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.326224, "process_user_time": 6.643873, "process_kernel_time": 0.332795, "process_mem_max_rss": "360160", "process_in_blocks": "3808", "process_out_blocks": "134240"}
[0m22:05:52.440083 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:52.439971 after 10.33 seconds
[0m22:05:52.440582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02eeab2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02eedf8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e72cdeb0>]}
[0m22:05:52.441066 [debug] [MainThread]: Flushing usage events
[0m22:05:54.196487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a5073fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a5072210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a5071a30>]}


============================== 22:05:54.199516 | bf5a78ac-373d-4787-8aa8-ad14506361b1 ==============================
[0m22:05:54.199516 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.200226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.348862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf5a78ac-373d-4787-8aa8-ad14506361b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a4ed5640>]}
[0m22:05:54.365695 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21793306, "process_user_time": 1.432446, "process_kernel_time": 0.100031, "process_mem_max_rss": "92184", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:54.366330 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:54.366227 after 0.22 seconds
[0m22:05:54.366774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a526fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a4abeb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5a44e35f0>]}
[0m22:05:54.367203 [debug] [MainThread]: Flushing usage events
[0m06:02:09.968720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fd35c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc400313410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fd3c8440>]}


============================== 06:02:09.976414 | b77b6c74-5749-412a-abb5-6b1d65749d57 ==============================
[0m06:02:09.976414 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.977165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.120192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b77b6c74-5749-412a-abb5-6b1d65749d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fcc475f0>]}
[0m06:02:10.133439 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5wdw7f4u'
[0m06:02:10.133890 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.188833 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.189423 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.201508 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.205353 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.379778 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.380337 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:10.380939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b77b6c74-5749-412a-abb5-6b1d65749d57', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fcdaac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fcd8a1e0>]}
[0m06:02:10.381397 [info ] [MainThread]: 
[0m06:02:10.381911 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:10.384011 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46458668, "process_user_time": 1.587035, "process_kernel_time": 0.114773, "process_mem_max_rss": "93580", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:10.384593 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.384491 after 0.47 seconds
[0m06:02:10.385068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fd752360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fdbdb440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3fd3c59d0>]}
[0m06:02:10.385486 [debug] [MainThread]: Flushing usage events
[0m06:02:12.023398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e28c1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e1ff50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e42adbe0>]}


============================== 06:02:12.026217 | cd6f45cf-79ef-4bc4-a45b-18ddd71c569c ==============================
[0m06:02:12.026217 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.026931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.260184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e1da1a00>]}
[0m06:02:12.319315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e3968320>]}
[0m06:02:12.321778 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:12.346567 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.347283 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.347813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e1d1a1b0>]}
[0m06:02:13.583219 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:13.583868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6da800170>]}
[0m06:02:13.766264 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:13.771746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6dadd2b10>]}
[0m06:02:13.898785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6da694470>]}
[0m06:02:13.899343 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:13.899855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6da67b5c0>]}
[0m06:02:13.901631 [info ] [MainThread]: 
[0m06:02:13.902368 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:13.907286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:13.942698 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:13.943149 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:13.943547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:14.272359 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.273970 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:14.276239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:14.276856 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:14.284017 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.284447 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:14.284879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.290991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.292394 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.292842 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:14.293436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.293831 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.294205 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:14.294759 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.295677 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.296082 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:14.296465 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:14.297056 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.297465 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:14.299252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:14.306230 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.306662 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:14.307046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:14.312811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.313218 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:14.313820 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:14.351253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:14.352820 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:14.354058 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:14.354466 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:14.357909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e225e180>]}
[0m06:02:14.358432 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.358829 [debug] [MainThread]: On master: BEGIN
[0m06:02:14.359195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:14.365403 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.365825 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.366215 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:14.366589 [debug] [MainThread]: On master: COMMIT
[0m06:02:14.367130 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:14.367534 [debug] [MainThread]: On master: Close
[0m06:02:14.368852 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:14.369408 [info ] [MainThread]: 
[0m06:02:14.407060 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:14.407655 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:14.408382 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:14.408848 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:14.434742 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:14.435488 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:14.471481 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:14.472225 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:21.982107 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.982611 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:21.983277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.983733 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.984173 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:21.984940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.987781 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:21.988246 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:21.988944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.009701 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.010190 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.010638 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:22.013960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.018898 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:22.019366 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:22.021500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.023790 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:22.053356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e44095b0>]}
[0m06:02:22.054065 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.64s]
[0m06:02:22.054836 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:22.055797 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:22.056350 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:22.056960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:22.057408 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:22.062405 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:22.063054 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:22.097285 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.097848 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241108060222091320"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:22.098325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:22.114211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.122450 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.122961 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:22.123703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.124160 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.124600 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241108060222091320'
      
      
      order by ordinal_position

  
[0m06:02:22.146299 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.153210 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.153711 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.156622 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.164397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.164915 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:22.167876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.186310 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:22.187074 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.187551 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241108060222091320"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241108060222091320"
    )
  
[0m06:02:22.222244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.224277 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.224770 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:22.225203 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:22.234873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:22.235867 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:22.437539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f45cf-79ef-4bc4-a45b-18ddd71c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa696fa60f0>]}
[0m06:02:22.438364 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:22.439094 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:22.440610 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.441134 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.441567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:22.448259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.448760 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.449200 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.449625 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.450196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.450647 [debug] [MainThread]: On master: Close
[0m06:02:22.452155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:22.452612 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:22.453086 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:22.453556 [info ] [MainThread]: 
[0m06:02:22.454167 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m06:02:22.455309 [debug] [MainThread]: Command end result
[0m06:02:22.483357 [info ] [MainThread]: 
[0m06:02:22.484042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:22.484731 [info ] [MainThread]: 
[0m06:02:22.485334 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:22.486415 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.511561, "process_user_time": 5.511014, "process_kernel_time": 0.292159, "process_mem_max_rss": "301976", "process_in_blocks": "3808", "process_out_blocks": "116792"}
[0m06:02:22.487060 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:22.486950 after 10.51 seconds
[0m06:02:22.487553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e1f6e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa696f5e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e23b4a70>]}
[0m06:02:22.488036 [debug] [MainThread]: Flushing usage events
[0m06:02:24.183575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15bd368a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15c1be1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15be82390>]}


============================== 06:02:24.186470 | e5350ec6-dd00-444e-8bd1-b2ac7b05be3d ==============================
[0m06:02:24.186470 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:24.187214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.329309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5350ec6-dd00-444e-8bd1-b2ac7b05be3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15c3b17f0>]}
[0m06:02:24.346019 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21138436, "process_user_time": 1.449978, "process_kernel_time": 0.075894, "process_mem_max_rss": "91976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:24.346609 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:24.346503 after 0.21 seconds
[0m06:02:24.347048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15be82390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15bce3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd15cd4a030>]}
[0m06:02:24.347468 [debug] [MainThread]: Flushing usage events
[0m14:05:03.536883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa66899e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6681e92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6681e9250>]}


============================== 14:05:03.544640 | 9c585040-95cb-4496-a737-a843da610496 ==============================
[0m14:05:03.544640 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:03.545310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:03.683168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c585040-95cb-4496-a737-a843da610496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa668eec650>]}
[0m14:05:03.696615 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l8gvcf_a'
[0m14:05:03.697064 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:03.782788 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:03.783413 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:03.806328 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:03.810172 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:03.881996 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:03.882514 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:03.883046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c585040-95cb-4496-a737-a843da610496', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6680152b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa667dafda0>]}
[0m14:05:03.883520 [info ] [MainThread]: 
[0m14:05:03.884029 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:03.886693 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3979453, "process_user_time": 1.55859, "process_kernel_time": 0.123255, "process_mem_max_rss": "93484", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:03.887280 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:03.887175 after 0.40 seconds
[0m14:05:03.887716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa669af0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa66b600170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa668ad1790>]}
[0m14:05:03.888230 [debug] [MainThread]: Flushing usage events
[0m14:05:05.567422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cad419bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cacce66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cacf4c980>]}


============================== 14:05:05.570266 | 3536305c-bb86-4a40-8718-ea272933472e ==============================
[0m14:05:05.570266 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:05.571004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:05.803884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2caca93ad0>]}
[0m14:05:05.863014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cacabf050>]}
[0m14:05:05.865587 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:05.881177 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:05.881896 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:05.882443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca5a402c0>]}
[0m14:05:07.112012 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:07.112683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca55d4ec0>]}
[0m14:05:07.294013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:07.299207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca593aa20>]}
[0m14:05:07.427172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca53bcbc0>]}
[0m14:05:07.427752 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:07.428259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca5316e40>]}
[0m14:05:07.429945 [info ] [MainThread]: 
[0m14:05:07.430651 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:07.435669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:07.472179 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:07.472680 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:07.473093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:08.066941 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:08.068530 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:08.070480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:08.071036 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:08.079575 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:08.080046 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:08.080448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:08.087147 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.088673 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:08.089078 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:08.089611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.090001 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:08.090375 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:08.090978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.091905 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:08.092366 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:08.092738 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:08.093271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.093668 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:08.095549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:08.101169 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:08.101578 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:08.101947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:08.107594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.108047 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:08.108449 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:08.131649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:08.133099 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:08.134324 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:08.134725 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:08.137829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca538e720>]}
[0m14:05:08.138343 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:08.138740 [debug] [MainThread]: On master: BEGIN
[0m14:05:08.139110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:08.145417 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:08.145841 [debug] [MainThread]: On master: COMMIT
[0m14:05:08.146231 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:08.146607 [debug] [MainThread]: On master: COMMIT
[0m14:05:08.147137 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:08.147547 [debug] [MainThread]: On master: Close
[0m14:05:08.149003 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:08.149534 [info ] [MainThread]: 
[0m14:05:08.159181 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:08.159767 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:08.160517 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:08.160961 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:08.186539 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:08.187293 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:08.223388 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:08.224162 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:15.866563 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.867087 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:15.867746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.868227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.868663 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:15.869364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.872272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.872743 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:15.873429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.893984 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:15.894472 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.894911 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:15.896840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.901782 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:15.902246 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:15.903651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:15.906014 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:15.938012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c87f49100>]}
[0m14:05:15.938810 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.78s]
[0m14:05:15.939599 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:15.940628 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:15.941196 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:15.941800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:15.942257 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:15.947569 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:15.948277 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:15.982135 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:15.982706 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241108140515976229"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:15.983179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:15.997616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.005632 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.006183 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:16.006839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.007286 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.007722 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241108140515976229'
      
      
      order by ordinal_position

  
[0m14:05:16.028826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.035809 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.036346 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:16.039348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.047100 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.047575 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:16.050740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.068845 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:16.069621 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.070109 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241108140515976229"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241108140515976229"
    )
  
[0m14:05:16.103926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.105938 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:16.106386 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:16.106811 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:16.115361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:16.116350 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:16.311177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3536305c-bb86-4a40-8718-ea272933472e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c65f12150>]}
[0m14:05:16.312020 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.37s]
[0m14:05:16.312872 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:16.314317 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:16.314814 [debug] [MainThread]: On master: BEGIN
[0m14:05:16.315281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:16.322164 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:16.322644 [debug] [MainThread]: On master: COMMIT
[0m14:05:16.323079 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:16.323500 [debug] [MainThread]: On master: COMMIT
[0m14:05:16.324092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:16.324551 [debug] [MainThread]: On master: Close
[0m14:05:16.326058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:16.326496 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:16.326900 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:16.327360 [info ] [MainThread]: 
[0m14:05:16.327887 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.90 seconds (8.90s).
[0m14:05:16.328920 [debug] [MainThread]: Command end result
[0m14:05:16.356716 [info ] [MainThread]: 
[0m14:05:16.357369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:16.357876 [info ] [MainThread]: 
[0m14:05:16.358392 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:16.359384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.839843, "process_user_time": 5.447297, "process_kernel_time": 0.359689, "process_mem_max_rss": "293804", "process_in_blocks": "3808", "process_out_blocks": "116792"}
[0m14:05:16.360055 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:16.359908 after 10.84 seconds
[0m14:05:16.360550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2caccc3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cadbba360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca55fc260>]}
[0m14:05:16.361030 [debug] [MainThread]: Flushing usage events
[0m14:05:18.027730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359a60e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359a83a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359d813410>]}


============================== 14:05:18.030725 | 9f8c6f55-af3c-4edb-aa59-1a4c69a0b2b7 ==============================
[0m14:05:18.030725 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.031478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.179579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f8c6f55-af3c-4edb-aa59-1a4c69a0b2b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359afee5a0>]}
[0m14:05:18.196603 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21709374, "process_user_time": 1.402203, "process_kernel_time": 0.131831, "process_mem_max_rss": "92024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:18.197190 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:18.197086 after 0.22 seconds
[0m14:05:18.197625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359b2b85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359ba5b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359a3cbc50>]}
[0m14:05:18.198049 [debug] [MainThread]: Flushing usage events
[0m22:05:38.825441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa2dcce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa2fc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cad213470>]}


============================== 22:05:38.875987 | c398911c-ac94-4cf9-ae21-86d012eb656d ==============================
[0m22:05:38.875987 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:38.876753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:39.017091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c398911c-ac94-4cf9-ae21-86d012eb656d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca9d27410>]}
[0m22:05:39.030491 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u4gyf1sm'
[0m22:05:39.030949 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:39.103076 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:39.103700 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:39.115777 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:39.119606 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:39.271760 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:39.272374 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:39.272911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c398911c-ac94-4cf9-ae21-86d012eb656d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca9cf7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca9cf7e30>]}
[0m22:05:39.273386 [info ] [MainThread]: 
[0m22:05:39.273867 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:39.275583 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49857712, "process_user_time": 1.592262, "process_kernel_time": 0.095775, "process_mem_max_rss": "93512", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:39.276171 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:39.276067 after 0.50 seconds
[0m22:05:39.276642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa1e1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caa90a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8caadaeb40>]}
[0m22:05:39.277070 [debug] [MainThread]: Flushing usage events
[0m22:05:40.903650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78bf6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78bf6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78bf69f0>]}


============================== 22:05:40.906463 | 28b46b92-6040-40fd-b097-6f246274f560 ==============================
[0m22:05:40.906463 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:40.907189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.140247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78a43aa0>]}
[0m22:05:41.209107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff79468470>]}
[0m22:05:41.211693 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:41.243924 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:41.244680 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:41.245218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff78c90d40>]}
[0m22:05:42.471331 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:42.471965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff79ddb530>]}
[0m22:05:42.651736 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:42.656885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff71bb43b0>]}
[0m22:05:42.793751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff714e0290>]}
[0m22:05:42.794300 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:42.794788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff713d7d10>]}
[0m22:05:42.796478 [info ] [MainThread]: 
[0m22:05:42.797175 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:42.801824 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:42.837436 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:42.837878 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:42.838282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:43.376977 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:43.378648 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:43.380679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:43.381268 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:43.389435 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.389877 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:43.390269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.396470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.397918 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.398324 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:43.398922 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.399320 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.399707 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:43.400343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.401275 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.401672 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:43.402058 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:43.402599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.403012 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:43.404991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:43.410640 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.411063 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:43.411440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:43.417151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.417574 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:43.417972 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:43.439858 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:43.441459 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:43.442704 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:43.443114 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:43.447104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff79581a90>]}
[0m22:05:43.447626 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.448026 [debug] [MainThread]: On master: BEGIN
[0m22:05:43.448455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:43.454883 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.455317 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.455717 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:43.456100 [debug] [MainThread]: On master: COMMIT
[0m22:05:43.456728 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:43.457135 [debug] [MainThread]: On master: Close
[0m22:05:43.458604 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:43.459133 [info ] [MainThread]: 
[0m22:05:43.480574 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:43.481196 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:43.481940 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:43.482387 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:43.508191 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:43.508996 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:43.544833 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:43.545680 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:51.344316 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.344822 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:51.345490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.345950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.346382 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:51.347088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.349962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.350422 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:51.351099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.371578 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.372057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.372534 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:51.374706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.379587 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:51.380051 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:51.381207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.383499 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:51.412733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff79b2dca0>]}
[0m22:05:51.413438 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.93s]
[0m22:05:51.414314 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:51.415304 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:51.415863 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:51.416548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:51.417000 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:51.421985 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:51.422636 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:51.456461 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.456974 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241108220551450634"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:51.457450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:51.472128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.479429 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.479893 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:51.480495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.480947 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.481379 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241108220551450634'
      
      
      order by ordinal_position

  
[0m22:05:51.502177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.508302 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.508788 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.513037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.520720 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.521253 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:51.524518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.542379 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:51.543078 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.543544 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241108220551450634"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241108220551450634"
    )
  
[0m22:05:51.582460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.584457 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.584914 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:51.585333 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:51.595012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:51.595913 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:52.281567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b46b92-6040-40fd-b097-6f246274f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff31e8dd60>]}
[0m22:05:52.282442 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.86s]
[0m22:05:52.283208 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:52.284674 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.285151 [debug] [MainThread]: On master: BEGIN
[0m22:05:52.285581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:52.292244 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.292728 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.293167 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:52.293592 [debug] [MainThread]: On master: COMMIT
[0m22:05:52.294170 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:52.294626 [debug] [MainThread]: On master: Close
[0m22:05:52.295937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:52.296417 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:52.296832 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:52.297293 [info ] [MainThread]: 
[0m22:05:52.297841 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.50 seconds (9.50s).
[0m22:05:52.298871 [debug] [MainThread]: Command end result
[0m22:05:52.326585 [info ] [MainThread]: 
[0m22:05:52.327290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:52.327892 [info ] [MainThread]: 
[0m22:05:52.328513 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:52.329597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.473636, "process_user_time": 6.072802, "process_kernel_time": 0.311221, "process_mem_max_rss": "360004", "process_in_blocks": "3808", "process_out_blocks": "135264"}
[0m22:05:52.330243 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:52.330128 after 11.47 seconds
[0m22:05:52.330733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff7146a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff32fdf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff71416180>]}
[0m22:05:52.331225 [debug] [MainThread]: Flushing usage events
[0m22:05:53.999767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c303a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c263e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c279b830>]}


============================== 22:05:54.002503 | a99c3b02-a464-455b-b4c8-073e5fae4589 ==============================
[0m22:05:54.002503 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:54.003213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m22:05:54.139621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a99c3b02-a464-455b-b4c8-073e5fae4589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c225e510>]}
[0m22:05:54.156451 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20452245, "process_user_time": 1.371849, "process_kernel_time": 0.111662, "process_mem_max_rss": "92128", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:54.157022 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:54.156918 after 0.21 seconds
[0m22:05:54.157450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c257a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c2df9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1c27e2210>]}
[0m22:05:54.157871 [debug] [MainThread]: Flushing usage events
[0m06:02:06.323260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e663963c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6626f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e66a2cce0>]}


============================== 06:02:06.337993 | 7d473249-fe07-482c-afb3-c81017f8a927 ==============================
[0m06:02:06.337993 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.338721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.474205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d473249-fe07-482c-afb3-c81017f8a927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e6608a7b0>]}
[0m06:02:06.487387 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-crq6j1iy'
[0m06:02:06.487903 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:06.559772 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:06.560370 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:06.572707 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:06.576563 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:06.789324 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:06.789821 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:06.790333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7d473249-fe07-482c-afb3-c81017f8a927', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e666a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e65f784a0>]}
[0m06:02:06.790775 [info ] [MainThread]: 
[0m06:02:06.791273 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:06.797642 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5223003, "process_user_time": 1.500268, "process_kernel_time": 0.167138, "process_mem_max_rss": "93540", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m06:02:06.798315 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:06.798213 after 0.52 seconds
[0m06:02:06.798742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e66a2ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e662bc8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e662a62a0>]}
[0m06:02:06.799160 [debug] [MainThread]: Flushing usage events
[0m06:02:08.628627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657a92420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6583c1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6583c3320>]}


============================== 06:02:08.631359 | a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb ==============================
[0m06:02:08.631359 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:08.632083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:08.861323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb650971c40>]}
[0m06:02:08.919971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6587c0320>]}
[0m06:02:08.922319 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:08.942189 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:08.942887 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:08.943408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6509702f0>]}
[0m06:02:10.174321 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:10.174988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb659da9970>]}
[0m06:02:10.355054 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:10.360064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6503e0140>]}
[0m06:02:10.485874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6503d2d80>]}
[0m06:02:10.486403 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:10.486909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6501b2450>]}
[0m06:02:10.488597 [info ] [MainThread]: 
[0m06:02:10.489259 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:10.494129 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:10.528853 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:10.529299 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:10.529704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:11.059349 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:11.060936 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:11.063049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:11.063645 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:11.072294 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.072741 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:11.073143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.079269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.080762 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.081169 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:11.081709 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.082110 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.082489 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:11.083061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.084020 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.084436 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:11.084814 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:11.085355 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.085762 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:11.087716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:11.093362 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.093773 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:11.094151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:11.099995 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.100407 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:11.100803 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:11.124007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:11.125430 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:11.126639 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:11.127045 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:11.130328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6502170e0>]}
[0m06:02:11.130846 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.131242 [debug] [MainThread]: On master: BEGIN
[0m06:02:11.131676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:11.138095 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.138521 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.138910 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:11.139286 [debug] [MainThread]: On master: COMMIT
[0m06:02:11.139841 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:11.140243 [debug] [MainThread]: On master: Close
[0m06:02:11.141626 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:11.142107 [info ] [MainThread]: 
[0m06:02:11.155812 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:11.156393 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:11.157028 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:11.157464 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:11.183338 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:11.184106 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:11.219809 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:11.220534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.862460 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.862984 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.863661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.864124 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.864565 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.865295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.868284 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.868750 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.869429 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.890191 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.890666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.891104 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.892918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.897862 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.898333 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.899634 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.901969 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.932142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb62c169550>]}
[0m06:02:20.932873 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.77s]
[0m06:02:20.933658 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.934636 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.935202 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.935808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.936262 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.941416 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.942073 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:20.975908 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.976412 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241109060220969925"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:20.976880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:20.991004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.998415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:20.998879 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:20.999467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.999939 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.000377 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241109060220969925'
      
      
      order by ordinal_position

  
[0m06:02:21.020806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.026949 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.027434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.030731 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.038265 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.038744 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.041755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.059931 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.060630 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.061101 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241109060220969925"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241109060220969925"
    )
  
[0m06:02:21.097472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.099497 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.099998 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.100427 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.109809 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.110735 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.319630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6db5bf2-dbf6-4c33-aa5a-1a6a616ee6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb614d0f0b0>]}
[0m06:02:21.320442 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m06:02:21.321300 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.322765 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.323248 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.323724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.330396 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.330873 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.331308 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.331767 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.332392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.332841 [debug] [MainThread]: On master: Close
[0m06:02:21.334239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.334670 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.335073 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.335525 [info ] [MainThread]: 
[0m06:02:21.336169 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.85 seconds (10.85s).
[0m06:02:21.337322 [debug] [MainThread]: Command end result
[0m06:02:21.364968 [info ] [MainThread]: 
[0m06:02:21.365665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.366264 [info ] [MainThread]: 
[0m06:02:21.366866 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.367951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.787818, "process_user_time": 5.58164, "process_kernel_time": 0.342627, "process_mem_max_rss": "296336", "process_in_blocks": "3808", "process_out_blocks": "116792"}
[0m06:02:21.368604 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.368492 after 12.79 seconds
[0m06:02:21.369094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657ac6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6579f6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6509374d0>]}
[0m06:02:21.369575 [debug] [MainThread]: Flushing usage events
[0m06:02:23.267401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eb8e26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ebb52300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ee913410>]}


============================== 06:02:23.270191 | bebe304b-2f36-4941-8728-b22c42e2dcd1 ==============================
[0m06:02:23.270191 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.270918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:23.407921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bebe304b-2f36-4941-8728-b22c42e2dcd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4ebb53d40>]}
[0m06:02:23.424563 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20534755, "process_user_time": 1.375793, "process_kernel_time": 0.119634, "process_mem_max_rss": "92148", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:23.425143 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:23.425039 after 0.21 seconds
[0m06:02:23.425587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eb8e26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eb99f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4eba6af30>]}
[0m06:02:23.426016 [debug] [MainThread]: Flushing usage events
[0m14:04:50.529711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559ba75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559ba7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559ba7b00>]}


============================== 14:04:50.537223 | aebab7e6-dc6a-4b92-923d-162bbbf757ca ==============================
[0m14:04:50.537223 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:50.537897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:50.680900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aebab7e6-dc6a-4b92-923d-162bbbf757ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559cd5b80>]}
[0m14:04:50.694369 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0_7yaaya'
[0m14:04:50.694831 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:50.780687 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:50.781410 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:50.821121 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:50.824934 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:50.868422 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:50.868915 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:50.869426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aebab7e6-dc6a-4b92-923d-162bbbf757ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05599e73b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05598ef2f0>]}
[0m14:04:50.869874 [info ] [MainThread]: 
[0m14:04:50.870341 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:50.872781 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3912747, "process_user_time": 1.499297, "process_kernel_time": 0.17019, "process_mem_max_rss": "93512", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:04:50.873347 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:50.873248 after 0.39 seconds
[0m14:04:50.873766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559bcbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0559a1eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f055b2be5d0>]}
[0m14:04:50.874180 [debug] [MainThread]: Flushing usage events
[0m14:04:52.411141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f3cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5fa5a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f5dd070>]}


============================== 14:04:52.413942 | 05ade806-c04f-49ac-a4bc-1ea5596fd653 ==============================
[0m14:04:52.413942 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:52.414605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:52.651377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5fb6bd40>]}
[0m14:04:52.711297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda6010a960>]}
[0m14:04:52.713857 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:52.729345 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:52.730070 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:52.730613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda58026570>]}
[0m14:04:53.967422 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:53.968090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda57a51100>]}
[0m14:04:54.151027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:54.156195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda57a25a60>]}
[0m14:04:54.280935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda579852b0>]}
[0m14:04:54.281481 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:54.281965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda57935370>]}
[0m14:04:54.283660 [info ] [MainThread]: 
[0m14:04:54.284389 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:54.289086 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:54.324266 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:54.324714 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:54.325116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:54.841762 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:54.843282 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:54.845309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:54.845870 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:54.854419 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:54.854854 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:54.855247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:54.861379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.862795 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:54.863196 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:54.863734 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.864166 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:54.864556 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:54.865112 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.866022 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:54.866427 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:54.866801 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:54.867334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.867732 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:54.869662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:54.875249 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:54.875660 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:54.876074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:54.881781 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.882191 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:54.882580 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:54.905474 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:54.906906 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:54.908129 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:54.908535 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:54.911810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda57986840>]}
[0m14:04:54.912361 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:54.912764 [debug] [MainThread]: On master: BEGIN
[0m14:04:54.913141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:54.919327 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:54.919758 [debug] [MainThread]: On master: COMMIT
[0m14:04:54.920204 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:54.920586 [debug] [MainThread]: On master: COMMIT
[0m14:04:54.921117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:54.921521 [debug] [MainThread]: On master: Close
[0m14:04:54.922945 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:54.923478 [info ] [MainThread]: 
[0m14:04:54.933492 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:54.934100 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:54.934830 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:54.935273 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:54.960944 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:54.961688 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:54.997226 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:54.997964 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:01.357941 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.358452 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:01.359077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.359535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.359993 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:01.360686 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.363550 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.364057 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:01.364768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.385541 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:01.386022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.386460 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:01.387639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.392561 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:01.393033 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:01.394128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.396484 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:01.425862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda144dffb0>]}
[0m14:05:01.426593 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.49s]
[0m14:05:01.427484 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:01.428489 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:01.429053 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:01.429731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:01.430201 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:01.435316 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:01.436009 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:01.469639 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.470153 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241109140501463725"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:01.470630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:01.485258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.492646 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.493116 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:01.493713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.494175 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.494618 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241109140501463725'
      
      
      order by ordinal_position

  
[0m14:05:01.514956 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.521027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.521520 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:01.524557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.532028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.532506 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:01.535286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.553277 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:01.553970 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.554445 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241109140501463725"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241109140501463725"
    )
  
[0m14:05:01.588857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.590834 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:01.591298 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:01.591725 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:01.601666 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:01.602558 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:02.295021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ade806-c04f-49ac-a4bc-1ea5596fd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda144f80e0>]}
[0m14:05:02.295840 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.87s]
[0m14:05:02.296743 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:02.298020 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:02.298492 [debug] [MainThread]: On master: BEGIN
[0m14:05:02.298925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:02.305503 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:02.305980 [debug] [MainThread]: On master: COMMIT
[0m14:05:02.306417 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:02.306844 [debug] [MainThread]: On master: COMMIT
[0m14:05:02.307422 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:02.307916 [debug] [MainThread]: On master: Close
[0m14:05:02.309223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:02.309663 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:02.310075 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:02.310538 [info ] [MainThread]: 
[0m14:05:02.311126 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.03 seconds (8.03s).
[0m14:05:02.312284 [debug] [MainThread]: Command end result
[0m14:05:02.340015 [info ] [MainThread]: 
[0m14:05:02.340703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:02.341297 [info ] [MainThread]: 
[0m14:05:02.341904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:02.342978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.980723, "process_user_time": 6.473965, "process_kernel_time": 0.41289, "process_mem_max_rss": "368636", "process_in_blocks": "3808", "process_out_blocks": "135216"}
[0m14:05:02.343624 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:02.343511 after 9.98 seconds
[0m14:05:02.344148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f395670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f6c2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5f6ec9e0>]}
[0m14:05:02.344643 [debug] [MainThread]: Flushing usage events
[0m14:05:03.989183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8bc1a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8afd51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8d2eddc0>]}


============================== 14:05:03.992101 | 1c651672-44ac-4e89-aaa7-0ab782849755 ==============================
[0m14:05:03.992101 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:03.992747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.138232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c651672-44ac-4e89-aaa7-0ab782849755', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8b3f9a00>]}
[0m14:05:04.155061 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21418615, "process_user_time": 1.436826, "process_kernel_time": 0.08805, "process_mem_max_rss": "92400", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:04.155667 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:04.155545 after 0.21 seconds
[0m14:05:04.156158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8bcf1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8aca7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b8c425070>]}
[0m14:05:04.156592 [debug] [MainThread]: Flushing usage events
[0m22:05:20.406907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ff30a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fd6a2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fd6a0da0>]}


============================== 22:05:20.441809 | 1eeab9f8-9247-4e95-b237-7fc1e50b942d ==============================
[0m22:05:20.441809 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:20.442549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:20.582626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eeab9f8-9247-4e95-b237-7fc1e50b942d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fc957950>]}
[0m22:05:20.596220 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zbbo4j92'
[0m22:05:20.596701 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:20.674991 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:20.675741 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:20.688278 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:20.692194 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:20.861992 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:20.862612 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:20.863250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1eeab9f8-9247-4e95-b237-7fc1e50b942d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fc9c4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fca9ec30>]}
[0m22:05:20.863765 [info ] [MainThread]: 
[0m22:05:20.864289 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:20.865941 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5068396, "process_user_time": 1.579013, "process_kernel_time": 0.107932, "process_mem_max_rss": "93912", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:20.866531 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:20.866429 after 0.51 seconds
[0m22:05:20.866963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fcc57350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fc9c60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fd051730>]}
[0m22:05:20.867387 [debug] [MainThread]: Flushing usage events
[0m22:05:22.545628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053bec5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053bec6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053d8e5d30>]}


============================== 22:05:22.548401 | 5bc92653-f410-49b8-b6d6-03a4e2c5fd6e ==============================
[0m22:05:22.548401 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.549042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.784155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053ca5f1a0>]}
[0m22:05:22.843225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053c3effb0>]}
[0m22:05:22.845734 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:22.861703 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:22.862443 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:22.862980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053b27ecc0>]}
[0m22:05:24.104102 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:24.104769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052fd1a540>]}
[0m22:05:24.286187 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:24.291648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05341e7110>]}
[0m22:05:24.443148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05341ab530>]}
[0m22:05:24.443786 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:24.444267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052fd051c0>]}
[0m22:05:24.446008 [info ] [MainThread]: 
[0m22:05:24.446725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:24.451879 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:24.487931 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:24.488435 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:24.488838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.927116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.928719 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:24.930951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:24.931515 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:24.940159 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.940587 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:24.940970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.947141 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.948601 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.949004 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:24.949594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.949984 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.950355 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:24.950924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.951864 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.952263 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:24.952638 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:24.953174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.953590 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:24.955410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:24.960945 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.961351 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:24.961723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:24.967450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.967887 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:24.968283 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:24.991326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:24.992775 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:24.993963 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:24.994365 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:24.997736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052fc9e7e0>]}
[0m22:05:24.998281 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:24.998682 [debug] [MainThread]: On master: BEGIN
[0m22:05:24.999054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:25.005287 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.005723 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.006116 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:25.006503 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.007061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:25.007472 [debug] [MainThread]: On master: Close
[0m22:05:25.009009 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:25.009534 [info ] [MainThread]: 
[0m22:05:25.024856 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:25.025457 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:25.026186 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:25.026630 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:25.052413 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:25.053164 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:25.088873 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:25.089617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:03.618921 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.619454 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:03.620118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.620575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.621009 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:03.621701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.624607 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.625087 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:03.625814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.646505 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:03.646981 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.647419 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:03.648858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.653739 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:03.654207 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:03.655947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.658259 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:03.689382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053ca5e210>]}
[0m22:06:03.690140 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 38.66s]
[0m22:06:03.691022 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:03.692020 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:03.692584 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:03.693257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:03.693722 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:03.698897 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:03.699586 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:03.733003 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.733507 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241109220603727098"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:03.733979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:03.748249 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.755688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.756161 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:03.756754 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.757205 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.757640 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241109220603727098'
      
      
      order by ordinal_position

  
[0m22:06:03.778529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.784722 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.785205 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.788320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.795828 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.796294 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:03.799149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.816940 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:03.817635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.818110 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241109220603727098"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241109220603727098"
    )
  
[0m22:06:03.856241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.858261 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.858743 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:03.859178 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:03.870200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:03.871108 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:04.567769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc92653-f410-49b8-b6d6-03a4e2c5fd6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04f8854680>]}
[0m22:06:04.568617 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.87s]
[0m22:06:04.569390 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:04.570801 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:04.571275 [debug] [MainThread]: On master: BEGIN
[0m22:06:04.571756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:04.578554 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:04.579070 [debug] [MainThread]: On master: COMMIT
[0m22:06:04.579516 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:04.579997 [debug] [MainThread]: On master: COMMIT
[0m22:06:04.580582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:04.581035 [debug] [MainThread]: On master: Close
[0m22:06:04.582495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:04.582933 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:04.583340 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:04.583871 [info ] [MainThread]: 
[0m22:06:04.584392 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 40.14 seconds (40.14s).
[0m22:06:04.585381 [debug] [MainThread]: Command end result
[0m22:06:04.613040 [info ] [MainThread]: 
[0m22:06:04.613657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:04.614156 [info ] [MainThread]: 
[0m22:06:04.614664 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:04.615672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 42.118546, "process_user_time": 6.537428, "process_kernel_time": 0.332072, "process_mem_max_rss": "376100", "process_in_blocks": "3808", "process_out_blocks": "135264"}
[0m22:06:04.616309 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:04.616202 after 42.12 seconds
[0m22:06:04.616797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053efbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053b98bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05341ee810>]}
[0m22:06:04.617274 [debug] [MainThread]: Flushing usage events
[0m22:06:06.295920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3f479880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3d1d65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3dd810a0>]}


============================== 22:06:06.298729 | e10033c9-1dd7-4794-8b8a-550b6b4d95f0 ==============================
[0m22:06:06.298729 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:06.299474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:06.438612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e10033c9-1dd7-4794-8b8a-550b6b4d95f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3d13b350>]}
[0m22:06:06.456307 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20816721, "process_user_time": 1.37967, "process_kernel_time": 0.115637, "process_mem_max_rss": "92268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:06.456880 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:06.456777 after 0.21 seconds
[0m22:06:06.457311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3dd810a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3ce4d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3d2dc8c0>]}
[0m22:06:06.457742 [debug] [MainThread]: Flushing usage events
[0m06:02:07.274847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2f326180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2f327e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2f82a1b0>]}


============================== 06:02:07.289619 | 7a6d831a-357f-445b-9549-4f57c320ce66 ==============================
[0m06:02:07.289619 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.290404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.438582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a6d831a-357f-445b-9549-4f57c320ce66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba30164410>]}
[0m06:02:07.452500 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u1an8qs1'
[0m06:02:07.452994 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.495090 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.495787 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.506227 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.510098 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.752502 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.753138 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:07.753751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7a6d831a-357f-445b-9549-4f57c320ce66', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ec93d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ec92db0>]}
[0m06:02:07.754229 [info ] [MainThread]: 
[0m06:02:07.754823 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:07.760606 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53457224, "process_user_time": 1.605205, "process_kernel_time": 0.128096, "process_mem_max_rss": "93348", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m06:02:07.761333 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.761208 after 0.54 seconds
[0m06:02:07.761776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ef15370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ed20cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba2ef5d7f0>]}
[0m06:02:07.762203 [debug] [MainThread]: Flushing usage events
[0m06:02:09.601616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabccb064b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc302540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabccc375f0>]}


============================== 06:02:09.604628 | 335ea2b4-af6a-4731-b7c9-654823e6765c ==============================
[0m06:02:09.604628 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.605358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.852601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc3c57f0>]}
[0m06:02:09.912694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc012ab0>]}
[0m06:02:09.915360 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:09.938546 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.939301 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.939834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc03a1b0>]}
[0m06:02:11.169963 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.170642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc50e8440>]}
[0m06:02:11.354403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.359872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc4fcafc0>]}
[0m06:02:11.494764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc4b7b7d0>]}
[0m06:02:11.495357 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:11.495890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabc4a0caa0>]}
[0m06:02:11.497744 [info ] [MainThread]: 
[0m06:02:11.498540 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.503619 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.540044 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.540556 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.540967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.031913 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.033509 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.035987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.036583 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.045487 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.045936 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.046330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.052924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.054631 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.055109 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.055706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.056111 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.056496 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.057095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.058037 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.058434 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.058852 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.059392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.059803 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.062566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.069067 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.069497 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.069877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.076288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.076717 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.077115 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.101088 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.102742 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.104014 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.104429 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.108370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabce741d90>]}
[0m06:02:12.108918 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.109321 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.109699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.116321 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.116770 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.117169 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.117554 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.118155 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.118612 [debug] [MainThread]: On master: Close
[0m06:02:12.120374 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.120921 [info ] [MainThread]: 
[0m06:02:12.157054 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.157730 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.158555 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:12.159016 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.186029 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.186900 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.225206 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.226126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:20.891615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.892181 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:20.892986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.893456 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.893899 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:20.894701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.897902 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.898380 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:20.899202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.920547 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.921130 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.921579 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:20.924242 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.929601 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:20.930074 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:20.931440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:20.933955 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:20.964347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabce6096a0>]}
[0m06:02:20.965200 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.80s]
[0m06:02:20.966017 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:20.967110 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:20.967710 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:20.968313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:20.968780 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:20.974239 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:20.974980 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:21.009452 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.010055 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241110060221003356"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:21.010587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:21.025578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.033928 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.034453 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:21.035213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.035666 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.036107 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241110060221003356'
      
      
      order by ordinal_position

  
[0m06:02:21.057617 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.064861 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.065405 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.068904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.077145 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.077665 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:21.080915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.099543 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:21.100362 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.100847 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241110060221003356"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241110060221003356"
    )
  
[0m06:02:21.138530 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.140619 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.141084 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:21.141512 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:21.152935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:21.154066 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:21.870172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335ea2b4-af6a-4731-b7c9-654823e6765c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab895f02c0>]}
[0m06:02:21.871051 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.90s]
[0m06:02:21.871812 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:21.873303 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.873809 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.874248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:21.881424 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.881946 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.882397 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.882884 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.883493 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.883951 [debug] [MainThread]: On master: Close
[0m06:02:21.885982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:21.886424 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:21.886886 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:21.887362 [info ] [MainThread]: 
[0m06:02:21.887967 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m06:02:21.889153 [debug] [MainThread]: Command end result
[0m06:02:21.918461 [info ] [MainThread]: 
[0m06:02:21.919283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:21.919913 [info ] [MainThread]: 
[0m06:02:21.920526 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:21.921668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.370506, "process_user_time": 6.691383, "process_kernel_time": 0.366869, "process_mem_max_rss": "377236", "process_in_blocks": "3808", "process_out_blocks": "135208"}
[0m06:02:21.922324 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:21.922209 after 12.37 seconds
[0m06:02:21.922869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc7b8980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabccc35f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabcc663f20>]}
[0m06:02:21.923379 [debug] [MainThread]: Flushing usage events
[0m06:02:23.969098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68384464e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6838447ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68384465a0>]}


============================== 06:02:23.972250 | 145f60a3-f508-406a-80b1-88a8ebba7d58 ==============================
[0m06:02:23.972250 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:23.973019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:24.129755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '145f60a3-f508-406a-80b1-88a8ebba7d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6838f31fa0>]}
[0m06:02:24.147739 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22895674, "process_user_time": 1.465179, "process_kernel_time": 0.115777, "process_mem_max_rss": "92388", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:24.148377 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:24.148264 after 0.23 seconds
[0m06:02:24.148855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683883a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68392f1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68382d2210>]}
[0m06:02:24.149308 [debug] [MainThread]: Flushing usage events
[0m14:04:45.952315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e4ff0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e4ff8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e4fd8e0>]}


============================== 14:04:45.968530 | 8a1c1fbc-2e20-40d2-90de-86c214da8b0c ==============================
[0m14:04:45.968530 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:45.969191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:46.113044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a1c1fbc-2e20-40d2-90de-86c214da8b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773dedf7a0>]}
[0m14:04:46.126783 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ulq2gpew'
[0m14:04:46.127346 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:46.223502 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:46.224220 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:46.247407 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:46.251278 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:46.333193 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:46.333821 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:46.334432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8a1c1fbc-2e20-40d2-90de-86c214da8b0c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773df1fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773df53920>]}
[0m14:04:46.334929 [info ] [MainThread]: 
[0m14:04:46.335455 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:46.371216 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46791857, "process_user_time": 1.614835, "process_kernel_time": 0.104964, "process_mem_max_rss": "93492", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:04:46.371914 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:46.371808 after 0.47 seconds
[0m14:04:46.372357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e4fd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e918710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773e96d700>]}
[0m14:04:46.372801 [debug] [MainThread]: Flushing usage events
[0m14:04:48.007923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b7bba000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b95a60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b730d070>]}


============================== 14:04:48.010848 | 45d64d9a-f735-425a-98ea-d052c8eaffad ==============================
[0m14:04:48.010848 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:48.011510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:48.256598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b709e9c0>]}
[0m14:04:48.316199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b01332f0>]}
[0m14:04:48.318887 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:48.339398 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:48.340145 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:48.340685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b0029b50>]}
[0m14:04:49.574891 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:49.575579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16afbc0080>]}
[0m14:04:49.761284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:49.767794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16af93c6b0>]}
[0m14:04:49.905686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16af97c710>]}
[0m14:04:49.906269 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:49.906833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16af98f1d0>]}
[0m14:04:49.908669 [info ] [MainThread]: 
[0m14:04:49.909419 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:49.914391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:49.950729 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:49.951293 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:49.951696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:50.479315 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:04:50.480848 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:50.482953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:50.483517 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:50.492086 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.492522 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:50.492924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:50.499262 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.500748 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.501166 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:50.501703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.502096 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.502469 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:50.503070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.503980 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:50.504377 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:50.504749 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:50.505340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.505746 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:50.508152 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro_main'
[0m14:04:50.513974 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:50.514382 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:50.514756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:50.522292 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.522713 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:50.523135 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:50.546378 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:50.547918 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:50.549184 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:50.549595 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:50.553111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b7269dc0>]}
[0m14:04:50.553651 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:50.554055 [debug] [MainThread]: On master: BEGIN
[0m14:04:50.554428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:50.561190 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:50.561610 [debug] [MainThread]: On master: COMMIT
[0m14:04:50.561997 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:50.562370 [debug] [MainThread]: On master: COMMIT
[0m14:04:50.562914 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:50.563316 [debug] [MainThread]: On master: Close
[0m14:04:50.564719 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:50.565249 [info ] [MainThread]: 
[0m14:04:50.578497 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:50.579142 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:50.579731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_petro_main, now model.petro.stg_petro)
[0m14:04:50.580168 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:50.606518 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:50.607422 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:50.643841 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:50.644726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:57.947546 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.948084 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:57.948748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.949203 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.949637 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:57.950367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.953376 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.953828 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:57.954545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.975506 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:57.976020 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.976495 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:57.978898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.984030 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.984499 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:57.986615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.989027 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:58.021414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16afb305f0>]}
[0m14:04:58.022241 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.44s]
[0m14:04:58.023149 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:58.024133 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:58.024701 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:58.025389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:58.025846 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:58.031200 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:58.031855 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:58.065807 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.066382 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241110140458059849"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:58.066895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:58.081436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.089430 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.089916 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:58.090578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.091046 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.091483 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241110140458059849'
      
      
      order by ordinal_position

  
[0m14:04:58.112925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.119940 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.120442 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:58.123448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.131280 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.131772 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:58.134720 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.152834 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:58.153612 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.154098 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241110140458059849"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241110140458059849"
    )
  
[0m14:04:58.192195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.194245 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:58.194711 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:58.195167 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:58.209038 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:58.210073 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:58.409637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d64d9a-f735-425a-98ea-d052c8eaffad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167423b9b0>]}
[0m14:04:58.410471 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.38s]
[0m14:04:58.411251 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:58.412618 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.413089 [debug] [MainThread]: On master: BEGIN
[0m14:04:58.413519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:58.420230 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.420710 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.421143 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:58.421565 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.422158 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:58.422608 [debug] [MainThread]: On master: Close
[0m14:04:58.424168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:58.424603 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:58.425008 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:58.425469 [info ] [MainThread]: 
[0m14:04:58.426016 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m14:04:58.427082 [debug] [MainThread]: Command end result
[0m14:04:58.455133 [info ] [MainThread]: 
[0m14:04:58.455875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:58.456475 [info ] [MainThread]: 
[0m14:04:58.457081 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:58.458179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.499041, "process_user_time": 5.527343, "process_kernel_time": 0.354007, "process_mem_max_rss": "302932", "process_in_blocks": "3808", "process_out_blocks": "117288"}
[0m14:04:58.458844 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:58.458703 after 10.50 seconds
[0m14:04:58.459350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b95a60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b712c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16afbedf70>]}
[0m14:04:58.460095 [debug] [MainThread]: Flushing usage events
[0m14:05:00.145258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee486a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee63097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee3e86ae0>]}


============================== 14:05:00.148175 | 8847e53d-a10d-47ef-9c44-e2c411f2773b ==============================
[0m14:05:00.148175 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:00.148837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:00.291921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8847e53d-a10d-47ef-9c44-e2c411f2773b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee4388c80>]}
[0m14:05:00.308647 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21214902, "process_user_time": 1.428047, "process_kernel_time": 0.103712, "process_mem_max_rss": "92396", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:00.309239 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:00.309135 after 0.21 seconds
[0m14:05:00.309693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee3eab260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee3dc1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcee3d57f50>]}
[0m14:05:00.310127 [debug] [MainThread]: Flushing usage events
[0m22:05:22.942568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241072dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24117abec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24117a9b80>]}


============================== 22:05:22.950611 | f962e772-7c5d-4bf5-a5b2-5f1353be28f6 ==============================
[0m22:05:22.950611 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.951382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:23.110176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f962e772-7c5d-4bf5-a5b2-5f1353be28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2411621640>]}
[0m22:05:23.124488 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6sebl8rf'
[0m22:05:23.125017 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:23.241845 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:23.242575 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:23.255206 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:23.259208 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:23.490881 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:23.491520 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:23.492068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f962e772-7c5d-4bf5-a5b2-5f1353be28f6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241053c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f241053f050>]}
[0m22:05:23.492535 [info ] [MainThread]: 
[0m22:05:23.493018 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:23.494763 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6015157, "process_user_time": 1.625958, "process_kernel_time": 0.138463, "process_mem_max_rss": "93648", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:23.495362 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:23.495255 after 0.60 seconds
[0m22:05:23.495801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2411ced880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2410401ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24104026f0>]}
[0m22:05:23.496227 [debug] [MainThread]: Flushing usage events
[0m22:05:25.391620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc39f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc39f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc39f0e0>]}


============================== 22:05:25.394745 | 0d83f569-b54f-4d43-a7c7-34ab21386646 ==============================
[0m22:05:25.394745 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.395446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:25.645668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dbfdb590>]}
[0m22:05:25.706861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc3e2360>]}
[0m22:05:25.709670 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:25.725794 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:25.726600 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:25.727143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc3476b0>]}
[0m22:05:26.973141 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:26.973890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d4c40080>]}
[0m22:05:27.162330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:27.168088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d4cd3230>]}
[0m22:05:27.328369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d4c40230>]}
[0m22:05:27.328990 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:27.329538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d4a3e420>]}
[0m22:05:27.331426 [info ] [MainThread]: 
[0m22:05:27.332183 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:27.337521 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:27.374931 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:27.375471 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:27.375885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:27.893538 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:27.895122 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:27.897293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:27.897876 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:27.906907 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.907427 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:27.907826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:27.914678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.916457 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.916899 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:27.917575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.917973 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.918357 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:27.918938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.919886 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:27.920286 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:27.920670 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:27.921249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.921668 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:27.924126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:27.930282 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:27.930750 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:27.931155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:27.937646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.938139 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:27.938555 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:27.962317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:27.964103 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:27.965435 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:27.965849 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:27.970131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dd88d130>]}
[0m22:05:27.970687 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:27.971089 [debug] [MainThread]: On master: BEGIN
[0m22:05:27.971491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:27.978384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:27.978907 [debug] [MainThread]: On master: COMMIT
[0m22:05:27.979306 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:27.979691 [debug] [MainThread]: On master: COMMIT
[0m22:05:27.980240 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:27.980657 [debug] [MainThread]: On master: Close
[0m22:05:27.982991 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:27.983530 [info ] [MainThread]: 
[0m22:05:27.994074 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:27.994751 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:27.995526 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:27.995970 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:28.023259 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:28.024154 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:28.061807 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:28.062722 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:37.554075 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.554640 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:37.555409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.555868 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.556308 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:37.557074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.560278 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.560749 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:37.561576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.582915 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.583494 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.583940 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:37.586145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.591589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:37.592093 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:37.593452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.595894 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:37.626949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f999a465550>]}
[0m22:05:37.627787 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.63s]
[0m22:05:37.628582 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:37.629630 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:37.630208 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:37.630847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:37.631299 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:37.636791 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:37.637567 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:37.672162 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.672768 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241110220537665875"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:37.673291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:37.687970 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.696155 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.696686 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:37.697444 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.697893 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.698330 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241110220537665875'
      
      
      order by ordinal_position

  
[0m22:05:37.719380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.726589 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.727139 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:37.730519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.738833 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.739364 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:37.742673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.761367 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:37.762196 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.762685 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241110220537665875"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241110220537665875"
    )
  
[0m22:05:37.795668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.797767 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:37.798241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:37.798676 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:37.806569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:37.807583 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:37.852421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d83f569-b54f-4d43-a7c7-34ab21386646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9999517830>]}
[0m22:05:37.853312 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.22s]
[0m22:05:37.854192 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:37.855693 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.856173 [debug] [MainThread]: On master: BEGIN
[0m22:05:37.856604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:37.863572 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.864106 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.864545 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:37.864974 [debug] [MainThread]: On master: COMMIT
[0m22:05:37.865660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:37.866129 [debug] [MainThread]: On master: Close
[0m22:05:37.867940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:37.868380 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:37.868785 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:37.869313 [info ] [MainThread]: 
[0m22:05:37.869884 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.54 seconds (10.54s).
[0m22:05:37.870943 [debug] [MainThread]: Command end result
[0m22:05:37.899961 [info ] [MainThread]: 
[0m22:05:37.900687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:37.901248 [info ] [MainThread]: 
[0m22:05:37.901803 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:37.902911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.560802, "process_user_time": 5.487418, "process_kernel_time": 0.314819, "process_mem_max_rss": "288552", "process_in_blocks": "3808", "process_out_blocks": "108104"}
[0m22:05:37.903577 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:37.903466 after 12.56 seconds
[0m22:05:37.904078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc711ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99dc316a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99994eeb40>]}
[0m22:05:37.904573 [debug] [MainThread]: Flushing usage events
[0m22:05:39.950659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f204feaf1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20521913a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f204ff24fe0>]}


============================== 22:05:39.953768 | 1f0c1f09-41a2-4925-b6b0-c1c2a70ad1e2 ==============================
[0m22:05:39.953768 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:39.954533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:40.112860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f0c1f09-41a2-4925-b6b0-c1c2a70ad1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f204fdabf20>]}
[0m22:05:40.131167 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2307221, "process_user_time": 1.441697, "process_kernel_time": 0.132155, "process_mem_max_rss": "92160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:40.131775 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:40.131667 after 0.23 seconds
[0m22:05:40.132231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2050b94950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2051860320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f204fdabf20>]}
[0m22:05:40.132667 [debug] [MainThread]: Flushing usage events
[0m06:02:04.494858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f54d868a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f5661f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f558adaf0>]}


============================== 06:02:04.501663 | 8bd4b2c6-62fe-4995-adb7-dbfc4a21295c ==============================
[0m06:02:04.501663 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:04.502301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:04.638480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bd4b2c6-62fe-4995-adb7-dbfc4a21295c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f5572ddc0>]}
[0m06:02:04.651463 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bh4y7oa1'
[0m06:02:04.651909 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:04.770030 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:04.770736 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:04.847911 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:04.851882 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:04.923805 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:04.924333 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:04.924901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8bd4b2c6-62fe-4995-adb7-dbfc4a21295c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f54cf7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f54cf7320>]}
[0m06:02:04.925336 [info ] [MainThread]: 
[0m06:02:04.925847 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:04.927470 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48067597, "process_user_time": 1.502616, "process_kernel_time": 0.148654, "process_mem_max_rss": "93776", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:04.928039 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:04.927939 after 0.48 seconds
[0m06:02:04.928464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f553d6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f5572ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f557b1640>]}
[0m06:02:04.928889 [debug] [MainThread]: Flushing usage events
[0m06:02:06.501583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc29d9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc2317ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc299dc10>]}


============================== 06:02:06.504288 | a56c9828-c5b9-47b0-b680-688dd5c71c1b ==============================
[0m06:02:06.504288 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:06.505009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:06.738785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc20a75c0>]}
[0m06:02:06.798679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc3b391f0>]}
[0m06:02:06.801076 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:06.816451 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:06.817156 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:06.817695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc2076c30>]}
[0m06:02:08.045327 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:08.045964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba9b8560>]}
[0m06:02:08.228047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:08.233128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbad629f0>]}
[0m06:02:08.372661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba9e5190>]}
[0m06:02:08.373193 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:08.373676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba8ff110>]}
[0m06:02:08.375359 [info ] [MainThread]: 
[0m06:02:08.376027 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:08.380631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:08.415443 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:08.415883 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:08.416282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:08.866027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.867781 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:08.870716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:08.871530 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:08.880071 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.880497 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:08.880884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:08.887004 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.888473 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.888877 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:08.889429 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.889823 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.890205 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:08.890776 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.891716 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:08.892125 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:08.892500 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:08.893033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.893442 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:08.895292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:08.900800 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:08.901211 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:08.901583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:08.907313 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.907723 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:08.908116 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:08.930882 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:08.932316 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:08.933496 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:08.933890 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:08.937080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba786ff0>]}
[0m06:02:08.937592 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:08.937983 [debug] [MainThread]: On master: BEGIN
[0m06:02:08.938348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:08.944376 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:08.944792 [debug] [MainThread]: On master: COMMIT
[0m06:02:08.945181 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:08.945565 [debug] [MainThread]: On master: COMMIT
[0m06:02:08.946093 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:08.946494 [debug] [MainThread]: On master: Close
[0m06:02:08.947951 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:08.948452 [info ] [MainThread]: 
[0m06:02:08.957780 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:08.958360 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:08.959012 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:08.959499 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:08.984787 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:08.985528 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:09.020764 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:09.021488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:16.349253 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.350056 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:16.350997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.351488 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.351918 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:16.352633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.355491 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.355941 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:16.356613 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.377205 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:16.377688 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.378135 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:16.440314 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.445227 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:16.445690 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:16.483359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.485643 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:16.515173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc355a4b0>]}
[0m06:02:16.515872 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.56s]
[0m06:02:16.516627 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:16.517620 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:16.518180 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:16.518748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:16.519232 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:16.524241 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:16.524884 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:16.558300 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.558804 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241111060216552457"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:16.559299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:16.572698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.579935 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.580398 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:16.581022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.581473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.581914 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241111060216552457'
      
      
      order by ordinal_position

  
[0m06:02:16.603499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.609409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.609894 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:16.614180 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.621641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.622124 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:16.626330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.644279 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:16.644947 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.645429 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241111060216552457"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241111060216552457"
    )
  
[0m06:02:16.678354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.680338 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:16.680799 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:16.681225 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:16.688366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:16.689258 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:16.737560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56c9828-c5b9-47b0-b680-688dd5c71c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7705b2c0>]}
[0m06:02:16.738265 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.22s]
[0m06:02:16.739150 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:16.740634 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.741090 [debug] [MainThread]: On master: BEGIN
[0m06:02:16.741519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:16.747865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.748330 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.748761 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:16.749177 [debug] [MainThread]: On master: COMMIT
[0m06:02:16.749747 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:16.750193 [debug] [MainThread]: On master: Close
[0m06:02:16.751658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:16.752095 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:16.752502 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:16.752955 [info ] [MainThread]: 
[0m06:02:16.753494 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m06:02:16.754507 [debug] [MainThread]: Command end result
[0m06:02:16.782012 [info ] [MainThread]: 
[0m06:02:16.782647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:16.783206 [info ] [MainThread]: 
[0m06:02:16.783753 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:16.784757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.332499, "process_user_time": 5.225873, "process_kernel_time": 0.30811, "process_mem_max_rss": "277932", "process_in_blocks": "3808", "process_out_blocks": "109104"}
[0m06:02:16.785396 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:16.785286 after 10.33 seconds
[0m06:02:16.785882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc2db87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc59bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedba8fda30>]}
[0m06:02:16.786362 [debug] [MainThread]: Flushing usage events
[0m06:02:18.379558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87eddf5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87eccc0c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec4ba6f0>]}


============================== 06:02:18.382207 | cae8370f-392f-4676-ba38-b79d8a9fe7f1 ==============================
[0m06:02:18.382207 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:18.382854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:18.516956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cae8370f-392f-4676-ba38-b79d8a9fe7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f01bbd10>]}
[0m06:02:18.532895 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20142232, "process_user_time": 1.38019, "process_kernel_time": 0.108014, "process_mem_max_rss": "92112", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:18.533448 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:18.533348 after 0.20 seconds
[0m06:02:18.533871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec54eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec3d70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ed0bbd70>]}
[0m06:02:18.534284 [debug] [MainThread]: Flushing usage events
[0m14:05:16.614014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f5edaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280fb61640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280fe96120>]}


============================== 14:05:16.621830 | e2cc433d-89c1-4981-a268-3496b7d182c2 ==============================
[0m14:05:16.621830 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:16.622505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:16.760507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2cc433d-89c1-4981-a268-3496b7d182c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f8a1670>]}
[0m14:05:16.774180 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ilny5kei'
[0m14:05:16.774635 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:16.867266 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:16.867998 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:16.890228 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:16.894177 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:16.971498 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:16.972107 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:16.972674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e2cc433d-89c1-4981-a268-3496b7d182c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f618680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f463110>]}
[0m14:05:16.973139 [info ] [MainThread]: 
[0m14:05:16.973610 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:16.975435 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40969405, "process_user_time": 1.585343, "process_kernel_time": 0.103305, "process_mem_max_rss": "93640", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:16.976025 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:16.975920 after 0.41 seconds
[0m14:05:16.976463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f5eb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2812fbbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280f89bb30>]}
[0m14:05:16.976948 [debug] [MainThread]: Flushing usage events
[0m14:05:18.596620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d9c196d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d88aebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d8ca1d30>]}


============================== 14:05:18.599493 | 3cbd51f9-f165-4511-bbee-0796e5c41787 ==============================
[0m14:05:18.599493 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.600199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.843294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d985f440>]}
[0m14:05:18.903261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0da0b77a0>]}
[0m14:05:18.905861 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:18.922068 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:18.922821 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:18.923384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d9225a90>]}
[0m14:05:20.180554 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:20.181255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0fc8800>]}
[0m14:05:20.364364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:20.369685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d805d370>]}
[0m14:05:20.491026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0fa80e0>]}
[0m14:05:20.491581 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:20.492108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0a952b0>]}
[0m14:05:20.493867 [info ] [MainThread]: 
[0m14:05:20.494565 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:20.499505 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:20.535851 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:20.536353 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:20.536800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:21.086035 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:21.087566 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:21.089653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:21.090216 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:21.099061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.099550 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:21.099943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.106683 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.108299 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.108760 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:21.109312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.109701 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.110072 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:21.110669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.111976 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.112532 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:21.112960 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:21.113542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.113953 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:21.116407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:21.123094 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.123535 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:21.123906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:21.130485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.130958 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:21.131356 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:21.154965 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:21.156715 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:21.157966 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:21.158371 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:21.162258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d08a3ce0>]}
[0m14:05:21.162805 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.163204 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.163583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:21.170163 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.170597 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.170990 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.171366 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.171907 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.172311 [debug] [MainThread]: On master: Close
[0m14:05:21.173906 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:21.174430 [info ] [MainThread]: 
[0m14:05:21.184654 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:21.185276 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:21.186017 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:21.186463 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:21.212602 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:21.213443 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:21.249643 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:21.250523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:28.024415 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.024977 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:28.025673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.026129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.026562 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:28.027298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.030272 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.030733 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:28.031414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.052374 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.052910 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.053350 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:28.055605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.060676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:28.061151 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:28.062643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.065041 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:28.095316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0b3cfb0>]}
[0m14:05:28.096136 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.91s]
[0m14:05:28.097042 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:28.098041 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:28.098611 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:28.099301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:28.099759 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:28.105248 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:28.105939 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:28.140088 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.140690 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241111140528134102"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:28.141173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:28.156143 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.164168 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.164694 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:28.165352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.165802 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.166239 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241111140528134102'
      
      
      order by ordinal_position

  
[0m14:05:28.187789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.194676 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.195175 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.198301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.205962 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.206438 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:28.209245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.227374 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:28.228094 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.228599 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241111140528134102"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241111140528134102"
    )
  
[0m14:05:28.264244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.266294 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.266751 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:28.267179 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:28.275196 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:28.276283 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:28.326002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cbd51f9-f165-4511-bbee-0796e5c41787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0913617f0>]}
[0m14:05:28.326820 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.23s]
[0m14:05:28.327681 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:28.329239 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.329716 [debug] [MainThread]: On master: BEGIN
[0m14:05:28.330146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:28.337229 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.337850 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.338292 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.338715 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.339307 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.339758 [debug] [MainThread]: On master: Close
[0m14:05:28.341480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:28.341920 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:28.342325 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:28.342795 [info ] [MainThread]: 
[0m14:05:28.343391 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.85 seconds (7.85s).
[0m14:05:28.344547 [debug] [MainThread]: Command end result
[0m14:05:28.373316 [info ] [MainThread]: 
[0m14:05:28.374089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:28.374704 [info ] [MainThread]: 
[0m14:05:28.375311 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:28.376407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.828882, "process_user_time": 5.414613, "process_kernel_time": 0.319681, "process_mem_max_rss": "291200", "process_in_blocks": "3808", "process_out_blocks": "109096"}
[0m14:05:28.377098 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:28.376984 after 9.83 seconds
[0m14:05:28.377601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d912e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0da62a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0d0ff7ef0>]}
[0m14:05:28.378091 [debug] [MainThread]: Flushing usage events
[0m14:05:30.091316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1299fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1299d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1321a180>]}


============================== 14:05:30.094361 | 6bab8285-69d2-4821-bcb8-156a3338a2b0 ==============================
[0m14:05:30.094361 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:30.095125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:30.242174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bab8285-69d2-4821-bcb8-156a3338a2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c12d4c770>]}
[0m14:05:30.264887 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22295587, "process_user_time": 1.453322, "process_kernel_time": 0.099816, "process_mem_max_rss": "92392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:30.265787 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:30.265643 after 0.22 seconds
[0m14:05:30.266530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c12393410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1299fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1299eb40>]}
[0m14:05:30.267149 [debug] [MainThread]: Flushing usage events
[0m22:05:25.942905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3f424200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3db79c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3db79a60>]}


============================== 22:05:25.971106 | 1b6460e1-a816-42e0-bea4-d2266fe913d0 ==============================
[0m22:05:25.971106 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:25.971776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:26.111563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b6460e1-a816-42e0-bea4-d2266fe913d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3db75580>]}
[0m22:05:26.125296 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fei3dr1g'
[0m22:05:26.125774 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:26.307527 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:26.308244 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:26.339421 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:26.343356 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:26.700176 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:26.700723 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:26.701302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1b6460e1-a816-42e0-bea4-d2266fe913d0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d845a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d845220>]}
[0m22:05:26.701763 [info ] [MainThread]: 
[0m22:05:26.702255 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:26.727429 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.83252406, "process_user_time": 1.60043, "process_kernel_time": 0.104288, "process_mem_max_rss": "93456", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:05:26.728043 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:26.727940 after 0.83 seconds
[0m22:05:26.728468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3dfa8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d9ec4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3d9807d0>]}
[0m22:05:26.728868 [debug] [MainThread]: Flushing usage events
[0m22:05:28.433481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e0de180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e88ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e681d60>]}


============================== 22:05:28.436439 | 43ea7bc3-3505-4882-9707-320302d1383d ==============================
[0m22:05:28.436439 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:28.437194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:28.665935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e9068a0>]}
[0m22:05:28.723862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097f8dc590>]}
[0m22:05:28.726343 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:28.759790 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:28.760506 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:28.761064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097d653950>]}
[0m22:05:29.983097 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:29.983738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09760162d0>]}
[0m22:05:30.176251 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:30.181468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0976057620>]}
[0m22:05:30.312156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09761af560>]}
[0m22:05:30.312725 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:30.313291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09760bd3a0>]}
[0m22:05:30.315003 [info ] [MainThread]: 
[0m22:05:30.315729 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:30.320517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:30.356088 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:30.356540 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:30.357026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:30.992727 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:30.994296 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:30.996528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:30.997133 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:31.005254 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.005691 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:31.006087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:31.012448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.013934 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.014378 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:31.014927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.015322 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.015700 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:31.016244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.017120 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:31.017492 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:31.017873 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:31.018412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.018815 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:31.020868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:31.026407 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:31.026813 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:31.027186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:31.032915 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.033329 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:31.033721 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:31.057341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:31.058770 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:31.059970 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:31.060379 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:31.063577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0974d50140>]}
[0m22:05:31.064078 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:31.064469 [debug] [MainThread]: On master: BEGIN
[0m22:05:31.064836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:31.071209 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:31.071630 [debug] [MainThread]: On master: COMMIT
[0m22:05:31.072010 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:31.072384 [debug] [MainThread]: On master: COMMIT
[0m22:05:31.072957 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:31.073356 [debug] [MainThread]: On master: Close
[0m22:05:31.074737 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:31.075233 [info ] [MainThread]: 
[0m22:05:31.093407 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:31.094006 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:31.094676 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:31.095122 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:31.121282 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:31.122027 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:31.157474 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:31.158219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:42.547820 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.548338 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:42.549026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.549473 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.549903 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:42.550641 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.553584 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.554041 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:42.554773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.575625 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.576103 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.576536 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:42.577816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.582741 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:42.583208 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:42.584456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.586816 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:42.616052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e172360>]}
[0m22:05:42.616773 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.52s]
[0m22:05:42.617573 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:42.618550 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:42.619112 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:42.619714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:42.620164 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:42.625381 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:42.626049 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:42.658508 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.659019 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241111220542652744"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:42.659494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:42.673914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.681315 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.681788 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:42.682380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.682820 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.683252 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241111220542652744'
      
      
      order by ordinal_position

  
[0m22:05:42.705122 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.711171 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.711656 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.716218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.723682 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.724168 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:42.726886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.744392 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:42.745057 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.745519 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241111220542652744"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241111220542652744"
    )
  
[0m22:05:42.776715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.778619 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.779068 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:42.779485 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:42.787542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:42.788413 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:42.843952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43ea7bc3-3505-4882-9707-320302d1383d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0939a43320>]}
[0m22:05:42.844681 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.22s]
[0m22:05:42.845461 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:42.846840 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.847307 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.847739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:42.854293 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.854759 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.855197 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:42.855619 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.856225 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:42.856673 [debug] [MainThread]: On master: Close
[0m22:05:42.858021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:42.858449 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:42.858860 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:42.859313 [info ] [MainThread]: 
[0m22:05:42.859832 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m22:05:42.860826 [debug] [MainThread]: Command end result
[0m22:05:42.888439 [info ] [MainThread]: 
[0m22:05:42.889084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:42.889596 [info ] [MainThread]: 
[0m22:05:42.890115 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:42.891093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.506494, "process_user_time": 4.786452, "process_kernel_time": 0.312682, "process_mem_max_rss": "284300", "process_in_blocks": "3808", "process_out_blocks": "109128"}
[0m22:05:42.891742 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:42.891632 after 14.51 seconds
[0m22:05:42.892225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0976118560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097d78bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0976182330>]}
[0m22:05:42.892708 [debug] [MainThread]: Flushing usage events
[0m22:05:44.669181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23d1e0deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfe9d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfe9fda0>]}


============================== 22:05:44.671834 | f26a8edc-1fe1-4357-807c-87481273e699 ==============================
[0m22:05:44.671834 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.672542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.806356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f26a8edc-1fe1-4357-807c-87481273e699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfad63c0>]}
[0m22:05:44.822424 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19968787, "process_user_time": 1.369118, "process_kernel_time": 0.104085, "process_mem_max_rss": "92176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:44.822989 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:44.822886 after 0.20 seconds
[0m22:05:44.823421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23d0291ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfba20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cfba2ab0>]}
[0m22:05:44.823844 [debug] [MainThread]: Flushing usage events
[0m06:02:17.446152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e9cd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f304050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e9cdd60>]}


============================== 06:02:17.453823 | c528ab05-81a6-4a70-ab53-3b245d77f70b ==============================
[0m06:02:17.453823 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.454595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.595465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c528ab05-81a6-4a70-ab53-3b245d77f70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2dffb8c0>]}
[0m06:02:17.608939 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kvi6nfsi'
[0m06:02:17.609388 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:17.672669 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:17.673392 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:17.686329 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:17.690254 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:17.864585 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:17.865183 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:17.865727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c528ab05-81a6-4a70-ab53-3b245d77f70b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e03bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f12a060>]}
[0m06:02:17.866190 [info ] [MainThread]: 
[0m06:02:17.866675 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:17.868403 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47084993, "process_user_time": 1.537233, "process_kernel_time": 0.163281, "process_mem_max_rss": "93640", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:17.868995 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:17.868890 after 0.47 seconds
[0m06:02:17.869431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e25c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e5fd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2e074800>]}
[0m06:02:17.869861 [debug] [MainThread]: Flushing usage events
[0m06:02:19.514636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c6f6f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c718ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c6f6f230>]}


============================== 06:02:19.517492 | e92634c8-0694-4a55-8ec7-95b9a2114e1c ==============================
[0m06:02:19.517492 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.518257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:19.758177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bff600b0>]}
[0m06:02:19.817794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c91c0320>]}
[0m06:02:19.820396 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:19.845371 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:19.846112 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:19.846661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bffb8050>]}
[0m06:02:21.078759 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:21.079419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf9af380>]}
[0m06:02:21.262452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:21.267769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf8ec8c0>]}
[0m06:02:21.389937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf9ff590>]}
[0m06:02:21.390503 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:21.391065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf712c60>]}
[0m06:02:21.392790 [info ] [MainThread]: 
[0m06:02:21.393486 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:21.398212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:21.433857 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:21.434322 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:21.434807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:21.968263 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:21.969837 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:21.971996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:21.972558 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:21.981216 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.981653 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:21.982056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:21.988382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.989843 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.990242 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:21.990822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.991221 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.991598 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:21.992163 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.993084 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.993492 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.993873 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.994471 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.994929 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:21.996793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:22.002440 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.002884 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:22.003261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:22.009124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.009536 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:22.009932 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:22.033257 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:22.034743 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:22.035956 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:22.036360 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:22.039785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3be5b26c0>]}
[0m06:02:22.040302 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.040697 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.041066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:22.047662 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.048091 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.048485 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:22.048867 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.049436 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:22.049841 [debug] [MainThread]: On master: Close
[0m06:02:22.051172 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:22.051661 [info ] [MainThread]: 
[0m06:02:22.061154 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:22.061756 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:22.062427 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:22.062927 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:22.089409 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:22.090179 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:22.126348 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:22.127115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:29.610647 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.611203 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:29.611826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.612287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.612723 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:29.613428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.616344 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.616800 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:29.617483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.638394 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.638907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.639354 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:29.641150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.646161 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:29.646703 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:29.647859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.650195 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:29.681616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c7a0a570>]}
[0m06:02:29.682373 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.62s]
[0m06:02:29.683320 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:29.684332 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:29.684899 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:29.685570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:29.686032 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:29.691252 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:29.691901 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.725538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.726043 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241112060229719694"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.726527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.741103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.748891 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.749369 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.749985 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.750436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.750900 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241112060229719694'
      
      
      order by ordinal_position

  
[0m06:02:29.772000 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.778416 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.778961 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.781716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.789281 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.789758 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.792987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.810595 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.811306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.811777 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241112060229719694"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241112060229719694"
    )
  
[0m06:02:29.848890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.850935 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.851397 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.851825 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.859064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.859969 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:29.921517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e92634c8-0694-4a55-8ec7-95b9a2114e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37ff96cf0>]}
[0m06:02:29.922331 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.24s]
[0m06:02:29.923228 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:29.924574 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.925047 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.925481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:29.932103 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.932587 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.933029 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.933456 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.934113 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.934587 [debug] [MainThread]: On master: Close
[0m06:02:29.936004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:29.936447 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:29.936853 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:29.937318 [info ] [MainThread]: 
[0m06:02:29.937847 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.54 seconds (8.54s).
[0m06:02:29.938958 [debug] [MainThread]: Command end result
[0m06:02:29.966554 [info ] [MainThread]: 
[0m06:02:29.967215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:29.967734 [info ] [MainThread]: 
[0m06:02:29.968257 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:29.969249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.5028105, "process_user_time": 5.365373, "process_kernel_time": 0.323359, "process_mem_max_rss": "295596", "process_in_blocks": "3808", "process_out_blocks": "109624"}
[0m06:02:29.969893 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:29.969782 after 10.50 seconds
[0m06:02:29.970389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bff834a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3bf711c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c6f6f230>]}
[0m06:02:29.970927 [debug] [MainThread]: Flushing usage events
[0m06:02:31.708155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636968ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636992f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636bc5ed50>]}


============================== 06:02:31.710943 | dad52457-a907-4f28-84c4-6a32add6026b ==============================
[0m06:02:31.710943 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:31.711642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.855309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dad52457-a907-4f28-84c4-6a32add6026b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6369753110>]}
[0m06:02:31.872159 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21244165, "process_user_time": 1.381834, "process_kernel_time": 0.144191, "process_mem_max_rss": "91980", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:31.872750 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:31.872644 after 0.21 seconds
[0m06:02:31.873197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6369a05460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f636995bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6369aaf0e0>]}
[0m06:02:31.873630 [debug] [MainThread]: Flushing usage events
[0m14:05:23.298014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecb731cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecda99d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecc498980>]}


============================== 14:05:23.305962 | 2f6684ec-cc50-4e9c-828f-7e9921082d2b ==============================
[0m14:05:23.305962 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.306744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.453283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f6684ec-cc50-4e9c-828f-7e9921082d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecc7dbd40>]}
[0m14:05:23.466957 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3f8dgcju'
[0m14:05:23.467442 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:23.525994 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:23.526709 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:23.539855 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:23.543728 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:23.713985 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:23.714606 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:23.715236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f6684ec-cc50-4e9c-828f-7e9921082d2b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecb465be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecb4b3980>]}
[0m14:05:23.715714 [info ] [MainThread]: 
[0m14:05:23.716232 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:23.724416 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47449955, "process_user_time": 1.597636, "process_kernel_time": 0.121033, "process_mem_max_rss": "93672", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:23.725017 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:23.724911 after 0.48 seconds
[0m14:05:23.725530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecda99d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecbfa7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eccc21880>]}
[0m14:05:23.725978 [debug] [MainThread]: Flushing usage events
[0m14:05:25.364836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cc74c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ce2edb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cc74c440>]}


============================== 14:05:25.367730 | 36e6ca87-5ce2-4597-871a-bfd91e8052e5 ==============================
[0m14:05:25.367730 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.368479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.617556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cbc3bd40>]}
[0m14:05:25.678051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cbdd1d90>]}
[0m14:05:25.680774 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:25.720050 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:25.720852 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:25.721390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c4d14050>]}
[0m14:05:27.040013 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:27.040723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c4d14320>]}
[0m14:05:27.236096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:27.241834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c4df1400>]}
[0m14:05:27.390742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c48a5c10>]}
[0m14:05:27.391335 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:27.391851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c463d580>]}
[0m14:05:27.393731 [info ] [MainThread]: 
[0m14:05:27.394479 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:27.399579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:27.436305 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:27.436857 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:27.437292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:27.984719 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:27.986328 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:27.988578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:27.989163 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:27.997436 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:27.997876 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:27.998273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.004612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.006085 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.006489 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:28.007098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.007494 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.007870 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:28.008506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.009446 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.009852 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.010237 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.010780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.011190 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:28.013271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:28.019047 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.019466 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:28.019846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.025745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.026162 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.026560 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:28.048742 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.050412 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:28.051686 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:28.052103 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:28.056180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cd4a93a0>]}
[0m14:05:28.056751 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.057150 [debug] [MainThread]: On master: BEGIN
[0m14:05:28.057524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:28.064270 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.064819 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.065222 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.065602 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.066197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.066615 [debug] [MainThread]: On master: Close
[0m14:05:28.068211 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:28.068757 [info ] [MainThread]: 
[0m14:05:28.090297 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:28.090927 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:28.091586 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:28.092020 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:28.117913 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:28.118687 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:28.154387 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:28.155272 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:35.714840 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.715408 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:35.716123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.716623 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.717075 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:35.717874 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.721049 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.721513 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:35.722219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.743358 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:35.743891 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.744369 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:35.746550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.751806 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:35.752319 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:35.753644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.756102 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:35.786089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cd45e540>]}
[0m14:05:35.786933 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.69s]
[0m14:05:35.787746 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:35.788794 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:35.789393 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:35.790003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:35.790457 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:35.795962 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:35.796695 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:35.831299 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.831891 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241112140535825255"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:35.832397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:35.846982 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.854985 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.855470 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:35.856106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.856591 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.857030 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241112140535825255'
      
      
      order by ordinal_position

  
[0m14:05:35.878025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.884818 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.885310 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:35.888130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.896027 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.896552 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:35.899483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.917583 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:35.918334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.918815 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241112140535825255"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241112140535825255"
    )
  
[0m14:05:35.952816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.954871 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:35.955339 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:35.955766 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:35.963960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:35.964939 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:36.030208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e6ca87-5ce2-4597-871a-bfd91e8052e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28d20a690>]}
[0m14:05:36.031069 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.24s]
[0m14:05:36.031865 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:36.033463 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:36.033953 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.034388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:36.041318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:36.041804 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.042241 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:36.042665 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.043261 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:36.043726 [debug] [MainThread]: On master: Close
[0m14:05:36.045377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:36.045820 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:36.046228 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:36.046698 [info ] [MainThread]: 
[0m14:05:36.047297 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m14:05:36.048495 [debug] [MainThread]: Command end result
[0m14:05:36.076875 [info ] [MainThread]: 
[0m14:05:36.077614 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:36.078211 [info ] [MainThread]: 
[0m14:05:36.078809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:36.079911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.764102, "process_user_time": 4.974925, "process_kernel_time": 0.334582, "process_mem_max_rss": "281804", "process_in_blocks": "3808", "process_out_blocks": "110128"}
[0m14:05:36.080597 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:36.080483 after 10.76 seconds
[0m14:05:36.081095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cc059bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28e1bab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2c48dcce0>]}
[0m14:05:36.081582 [debug] [MainThread]: Flushing usage events
[0m14:05:37.972362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f153620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f5afc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f46c350>]}


============================== 14:05:37.975323 | c3f46b5d-b60a-466c-8873-45dd45c140fd ==============================
[0m14:05:37.975323 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:37.976051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:38.133359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f46b5d-b60a-466c-8873-45dd45c140fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f0a6cf0>]}
[0m14:05:38.150699 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22837326, "process_user_time": 1.51242, "process_kernel_time": 0.095773, "process_mem_max_rss": "92112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:38.151308 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:38.151203 after 0.23 seconds
[0m14:05:38.151771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f373da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9403a3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93f318d70>]}
[0m14:05:38.152225 [debug] [MainThread]: Flushing usage events
[0m22:05:29.053427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f038b85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f038b8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f038b8140>]}


============================== 22:05:29.077950 | d5613411-2be5-4a47-9867-88acff4e89c4 ==============================
[0m22:05:29.077950 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:29.078681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:29.220489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5613411-2be5-4a47-9867-88acff4e89c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f039f38c0>]}
[0m22:05:29.234056 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-aby2bwmd'
[0m22:05:29.234512 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:29.286515 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:29.287148 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:29.301916 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:29.305826 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:29.371890 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:29.372496 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:29.373155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd5613411-2be5-4a47-9867-88acff4e89c4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f037147a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f0361c590>]}
[0m22:05:29.373627 [info ] [MainThread]: 
[0m22:05:29.374162 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:29.385576 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38109642, "process_user_time": 1.629056, "process_kernel_time": 0.076236, "process_mem_max_rss": "93564", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m22:05:29.386180 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:29.386075 after 0.38 seconds
[0m22:05:29.386626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f03e29c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f03a31880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f038babd0>]}
[0m22:05:29.387064 [debug] [MainThread]: Flushing usage events
[0m22:05:30.988003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2432b6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2436c1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2436c0950>]}


============================== 22:05:30.990870 | bbbdc3f1-4c2d-4442-83dc-a42160e1019a ==============================
[0m22:05:30.990870 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:30.991567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:31.220896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc242e0fb90>]}
[0m22:05:31.279788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc243680320>]}
[0m22:05:31.282205 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:31.311208 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:31.311960 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:31.312493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc242ba24b0>]}
[0m22:05:32.538229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:32.538909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc23b58f9e0>]}
[0m22:05:32.718698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:32.723989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc23ba5e8a0>]}
[0m22:05:32.874068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc23b40a480>]}
[0m22:05:32.874643 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:32.875148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc242bbc590>]}
[0m22:05:32.876941 [info ] [MainThread]: 
[0m22:05:32.877681 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:32.882631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:32.918972 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:32.919465 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:32.919893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:33.449648 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:33.451169 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:33.453227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:33.453786 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:33.461706 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.462142 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:33.462533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.468860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.470305 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.470712 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:33.471247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.471642 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.472056 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:33.472622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.473525 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.473936 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.474306 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.474844 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.475251 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:33.477654 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro_main'
[0m22:05:33.483567 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.484027 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:33.484405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:33.492034 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.492452 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.492848 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:33.518269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.519839 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:33.521067 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:33.521483 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:33.525200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2452abad0>]}
[0m22:05:33.525731 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.526120 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.526504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:33.533580 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.534016 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.534411 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.534793 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.535374 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.535816 [debug] [MainThread]: On master: Close
[0m22:05:33.537486 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:33.537972 [info ] [MainThread]: 
[0m22:05:33.552794 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:33.553410 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:33.553999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_petro_main, now model.petro.stg_petro)
[0m22:05:33.554459 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:33.580434 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:33.581194 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:33.616989 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:33.617770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:41.257043 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.257570 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:41.258264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.258730 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.259172 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:41.259914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.262797 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.263255 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:41.263965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.284738 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:41.285217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.285658 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:41.287258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.292191 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:41.292667 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:41.294980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.297325 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:41.326546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc24425a840>]}
[0m22:05:41.327271 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.77s]
[0m22:05:41.328101 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:41.329078 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:41.329645 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:41.330231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:41.330722 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:41.335893 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:41.336553 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:41.370127 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.370640 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241112220541364268"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:41.371115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:41.385308 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.392766 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.393237 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:41.393844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.394299 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.394742 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241112220541364268'
      
      
      order by ordinal_position

  
[0m22:05:41.415898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.422113 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.422615 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:41.425369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.432871 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.433350 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:41.436364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.454236 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:41.454950 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.455431 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241112220541364268"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241112220541364268"
    )
  
[0m22:05:41.489097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.491116 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:41.491577 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:41.492035 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:41.499848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:41.500742 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:41.570581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbdc3f1-4c2d-4442-83dc-a42160e1019a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f3fdfd70>]}
[0m22:05:41.571382 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.24s]
[0m22:05:41.572164 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:41.573452 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.573927 [debug] [MainThread]: On master: BEGIN
[0m22:05:41.574362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:41.581027 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.581516 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.581958 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:41.582392 [debug] [MainThread]: On master: COMMIT
[0m22:05:41.582976 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:41.583429 [debug] [MainThread]: On master: Close
[0m22:05:41.584993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:41.585453 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:41.585899 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:41.586357 [info ] [MainThread]: 
[0m22:05:41.586952 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m22:05:41.588112 [debug] [MainThread]: Command end result
[0m22:05:41.615597 [info ] [MainThread]: 
[0m22:05:41.616298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:41.616889 [info ] [MainThread]: 
[0m22:05:41.617491 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:41.618558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.680231, "process_user_time": 4.768944, "process_kernel_time": 0.312323, "process_mem_max_rss": "274720", "process_in_blocks": "3808", "process_out_blocks": "110160"}
[0m22:05:41.619197 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:41.619089 after 10.68 seconds
[0m22:05:41.619686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2432b6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc242a0ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc23b510cb0>]}
[0m22:05:41.620234 [debug] [MainThread]: Flushing usage events
[0m22:05:43.264912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb285dcdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2860b0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb285dccc50>]}


============================== 22:05:43.267666 | 6d1f809d-bfbe-41e4-87a5-1a33043299bb ==============================
[0m22:05:43.267666 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:43.268426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:43.412796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d1f809d-bfbe-41e4-87a5-1a33043299bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb285229f10>]}
[0m22:05:43.429827 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21292807, "process_user_time": 1.390445, "process_kernel_time": 0.124218, "process_mem_max_rss": "92056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:43.430416 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:43.430312 after 0.21 seconds
[0m22:05:43.430858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28554e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2858c1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28532f0e0>]}
[0m22:05:43.431288 [debug] [MainThread]: Flushing usage events
[0m06:02:07.457542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144cf15d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144d6ce510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144d6cce30>]}


============================== 06:02:07.465259 | 302df935-0ca9-4e1a-af82-87eab44f7488 ==============================
[0m06:02:07.465259 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:07.465910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:07.607230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '302df935-0ca9-4e1a-af82-87eab44f7488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144cd76600>]}
[0m06:02:07.621143 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6ahpvji3'
[0m06:02:07.621618 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:07.726890 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:07.727616 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:07.791416 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:07.795440 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:07.945989 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:07.946603 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:07.947130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '302df935-0ca9-4e1a-af82-87eab44f7488', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144ccfbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144cd3fad0>]}
[0m06:02:07.947602 [info ] [MainThread]: 
[0m06:02:07.948062 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:07.977136 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5683222, "process_user_time": 1.595437, "process_kernel_time": 0.120259, "process_mem_max_rss": "93564", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:07.977787 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:07.977682 after 0.57 seconds
[0m06:02:07.978286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144dfa53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144de500e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144f27dcd0>]}
[0m06:02:07.978727 [debug] [MainThread]: Flushing usage events
[0m06:02:09.646859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda16fcb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda2615370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda16fef30>]}


============================== 06:02:09.649747 | dac827e8-8482-448a-b1b5-6f922fdbd0db ==============================
[0m06:02:09.649747 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:09.650447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:09.890265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda0b7b650>]}
[0m06:02:09.950575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda0bbb890>]}
[0m06:02:09.953228 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:09.969095 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:09.969828 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:09.970389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda119b8f0>]}
[0m06:02:11.216154 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:11.216814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd999e3d40>]}
[0m06:02:11.400076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:11.405255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd999e3560>]}
[0m06:02:11.571645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd999f27b0>]}
[0m06:02:11.572243 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:11.572780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9948f710>]}
[0m06:02:11.574538 [info ] [MainThread]: 
[0m06:02:11.575258 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:11.580226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:11.616718 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:11.617205 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:11.617620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:12.072373 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.073990 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:12.076429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:12.077031 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:12.086218 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.086671 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:12.087072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.093686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.095282 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.095697 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:12.096260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.096676 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.097063 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:12.097643 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.098603 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.099013 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:12.099405 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:12.100006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.100423 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:12.102488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:12.108460 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.108907 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:12.109296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:12.115543 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.116029 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:12.116439 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:12.140252 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:12.141864 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:12.143159 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:12.143579 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:12.147159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda22a50d0>]}
[0m06:02:12.147697 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.148098 [debug] [MainThread]: On master: BEGIN
[0m06:02:12.148628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:12.155553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.156009 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.156408 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:12.156789 [debug] [MainThread]: On master: COMMIT
[0m06:02:12.157384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:12.157804 [debug] [MainThread]: On master: Close
[0m06:02:12.159402 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:12.159916 [info ] [MainThread]: 
[0m06:02:12.169923 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:12.170592 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:12.171281 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:12.171731 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:12.198306 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:12.199077 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:12.235251 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:12.236046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:19.574322 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.574852 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:19.575564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.576022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.576458 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:19.577198 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.580176 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.580638 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:19.581367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.602556 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.603053 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.603501 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:19.605883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.610911 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:19.611383 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:19.613112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.615477 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:19.646373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda225a450>]}
[0m06:02:19.647210 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.47s]
[0m06:02:19.648097 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:19.649102 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:19.649674 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:19.650387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:19.650861 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:19.656304 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:19.656974 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:19.691206 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.691733 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241113060219685142"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:19.692228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:19.707469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.715762 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.716321 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:19.717011 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.717465 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.717907 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241113060219685142'
      
      
      order by ordinal_position

  
[0m06:02:19.739228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.745710 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.746231 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.749397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.757072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.757558 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:19.760385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.778667 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:19.779375 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.779853 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241113060219685142"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241113060219685142"
    )
  
[0m06:02:19.813939 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.816035 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.816512 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:19.816950 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:19.825280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:19.826259 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:19.909254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac827e8-8482-448a-b1b5-6f922fdbd0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd560ae270>]}
[0m06:02:19.910072 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m06:02:19.910966 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:19.912463 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.912941 [debug] [MainThread]: On master: BEGIN
[0m06:02:19.913376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:19.920203 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.920694 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.921141 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:19.921568 [debug] [MainThread]: On master: COMMIT
[0m06:02:19.922226 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:19.922688 [debug] [MainThread]: On master: Close
[0m06:02:19.924208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:19.924660 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:19.925075 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:19.925541 [info ] [MainThread]: 
[0m06:02:19.926187 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.35 seconds (8.35s).
[0m06:02:19.927323 [debug] [MainThread]: Command end result
[0m06:02:19.955587 [info ] [MainThread]: 
[0m06:02:19.956320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:19.956920 [info ] [MainThread]: 
[0m06:02:19.957530 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:19.958675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.360856, "process_user_time": 5.429172, "process_kernel_time": 0.322643, "process_mem_max_rss": "285428", "process_in_blocks": "3808", "process_out_blocks": "110648"}
[0m06:02:19.959358 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:19.959244 after 10.36 seconds
[0m06:02:19.959871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda1c79bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9948f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd55f40140>]}
[0m06:02:19.960367 [debug] [MainThread]: Flushing usage events
[0m06:02:21.671384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7e989fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7e989c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7e989f40>]}


============================== 06:02:21.674260 | 27d491af-2252-43c5-9daf-41b970f212df ==============================
[0m06:02:21.674260 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:21.674919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:21.818745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27d491af-2252-43c5-9daf-41b970f212df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7de04470>]}
[0m06:02:21.835395 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21288227, "process_user_time": 1.416838, "process_kernel_time": 0.100059, "process_mem_max_rss": "92236", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:02:21.836003 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:21.835898 after 0.21 seconds
[0m06:02:21.836444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7e989eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf819bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7ef11e80>]}
[0m06:02:21.836874 [debug] [MainThread]: Flushing usage events
[0m14:05:09.603496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105ab84170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105ab852e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105ab84200>]}


============================== 14:05:09.654146 | 5f2d7208-f902-42e5-a889-9302e33ebf6b ==============================
[0m14:05:09.654146 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:09.654845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:09.793883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f2d7208-f902-42e5-a889-9302e33ebf6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105abf4650>]}
[0m14:05:09.807694 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g557xvbp'
[0m14:05:09.808167 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:09.894990 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:09.895650 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:09.917198 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:09.921084 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:09.989992 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:09.990623 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:09.991207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5f2d7208-f902-42e5-a889-9302e33ebf6b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105abdc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105bc29eb0>]}
[0m14:05:09.991672 [info ] [MainThread]: 
[0m14:05:09.992132 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:10.011590 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45677763, "process_user_time": 1.620101, "process_kernel_time": 0.104782, "process_mem_max_rss": "93588", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m14:05:10.012249 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:10.012141 after 0.46 seconds
[0m14:05:10.012718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105b5295b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105c2219d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f105aba77a0>]}
[0m14:05:10.013168 [debug] [MainThread]: Flushing usage events
[0m14:05:11.598280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4706f6d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470660a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4706609e80>]}


============================== 14:05:11.601170 | 3b5ed487-b290-41e1-a1d8-2cdf9533b057 ==============================
[0m14:05:11.601170 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:11.601831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:11.840277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4707b2b4d0>]}
[0m14:05:11.900192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4707388c20>]}
[0m14:05:11.902929 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:11.918884 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:11.919659 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:11.920187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46ff447b90>]}
[0m14:05:13.148265 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:13.148946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fef87e30>]}
[0m14:05:13.331340 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:13.336707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fefb6a50>]}
[0m14:05:13.524304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fefa1670>]}
[0m14:05:13.524906 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:13.525413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46fee98c20>]}
[0m14:05:13.527170 [info ] [MainThread]: 
[0m14:05:13.527899 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:13.532731 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:13.568727 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:13.569235 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:13.569651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:14.270880 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:14.272469 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:14.274715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:14.275273 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:14.283867 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.284298 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:14.284722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.291197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.292751 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.293152 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:14.293766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.294163 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.294537 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:14.295114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.296026 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.296432 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:14.296863 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:14.297401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.297811 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:14.299786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:14.305614 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.306027 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:14.306397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:14.312413 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.312862 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:14.313258 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:14.336562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:14.338156 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:14.339387 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:14.339790 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:14.343256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4707b71490>]}
[0m14:05:14.343772 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.344176 [debug] [MainThread]: On master: BEGIN
[0m14:05:14.344549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:14.351005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.351440 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.351831 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:14.352203 [debug] [MainThread]: On master: COMMIT
[0m14:05:14.352755 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:14.353161 [debug] [MainThread]: On master: Close
[0m14:05:14.354621 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:14.355156 [info ] [MainThread]: 
[0m14:05:14.365087 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:14.365698 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:14.366438 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:14.366877 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:14.392641 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:14.393426 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:14.428821 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:14.429598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:21.250746 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.251268 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:21.251923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.252379 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.252836 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:21.253542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.256469 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.256953 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:21.257643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.278259 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:21.278734 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.279168 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:21.280988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.285936 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:21.286405 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:21.287573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.289937 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:21.318928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46d7f0aa80>]}
[0m14:05:21.319660 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.95s]
[0m14:05:21.320526 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:21.321633 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:21.322202 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:21.322893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:21.323349 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:21.328624 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:21.329289 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:21.363105 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.363645 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241113140521357100"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:21.364118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:21.379517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.387367 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.387840 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:21.388458 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.388924 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.389359 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241113140521357100'
      
      
      order by ordinal_position

  
[0m14:05:21.411592 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.418535 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.419035 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.422030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.429525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.430002 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:21.432795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.450580 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:21.451273 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.451741 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241113140521357100"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241113140521357100"
    )
  
[0m14:05:21.484894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.486897 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.487360 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:21.487780 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:21.495876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:21.496800 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:21.586147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b5ed487-b290-41e1-a1d8-2cdf9533b057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bf2409e0>]}
[0m14:05:21.586993 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m14:05:21.587742 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:21.589317 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.589793 [debug] [MainThread]: On master: BEGIN
[0m14:05:21.590223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:21.596934 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.597527 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.597986 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:21.598408 [debug] [MainThread]: On master: COMMIT
[0m14:05:21.599037 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:21.599493 [debug] [MainThread]: On master: Close
[0m14:05:21.601298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:21.601734 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:21.602135 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:21.602595 [info ] [MainThread]: 
[0m14:05:21.603145 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m14:05:21.604195 [debug] [MainThread]: Command end result
[0m14:05:21.634074 [info ] [MainThread]: 
[0m14:05:21.634976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:21.635561 [info ] [MainThread]: 
[0m14:05:21.636104 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:21.637155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.088455, "process_user_time": 5.652616, "process_kernel_time": 0.293277, "process_mem_max_rss": "296936", "process_in_blocks": "3808", "process_out_blocks": "111152"}
[0m14:05:21.637796 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:21.637687 after 10.09 seconds
[0m14:05:21.638295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470754b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bf75b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4706a68170>]}
[0m14:05:21.638783 [debug] [MainThread]: Flushing usage events
[0m14:05:23.317717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a85c3c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a86b45c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a8603b530>]}


============================== 14:05:23.320520 | caf68d7a-b156-40af-8a60-0f6ae856c7ff ==============================
[0m14:05:23.320520 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.321187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:23.461480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caf68d7a-b156-40af-8a60-0f6ae856c7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a85d0e360>]}
[0m14:05:23.478375 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2087948, "process_user_time": 1.405301, "process_kernel_time": 0.111785, "process_mem_max_rss": "92168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:23.478956 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:23.478853 after 0.21 seconds
[0m14:05:23.479394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a863b3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a85a4ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a85d0e360>]}
[0m14:05:23.479820 [debug] [MainThread]: Flushing usage events
[0m22:05:28.963895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770b88470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770650f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770667050>]}


============================== 22:05:28.979120 | 06fb6858-7662-4cc0-81df-d637162b40dd ==============================
[0m22:05:28.979120 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:28.979795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:29.118653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06fb6858-7662-4cc0-81df-d637162b40dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770a8a630>]}
[0m22:05:29.131977 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mgdrfgn5'
[0m22:05:29.132447 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:29.196493 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:29.197135 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:29.222848 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:29.226684 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:29.297166 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:29.297679 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:29.298199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '06fb6858-7662-4cc0-81df-d637162b40dd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37702ed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770370b60>]}
[0m22:05:29.298660 [info ] [MainThread]: 
[0m22:05:29.299136 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:29.304905 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38960716, "process_user_time": 1.628909, "process_kernel_time": 0.099323, "process_mem_max_rss": "93652", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:29.305498 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:29.305393 after 0.39 seconds
[0m22:05:29.305931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770667050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37708c2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377161b380>]}
[0m22:05:29.306357 [debug] [MainThread]: Flushing usage events
[0m22:05:30.890595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792edd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792a50e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792a52180>]}


============================== 22:05:30.893427 | 436822b1-7665-4cd8-b81d-e898cd04780c ==============================
[0m22:05:30.893427 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:30.894097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:31.124749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37929057c0>]}
[0m22:05:31.183958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37928c0320>]}
[0m22:05:31.186434 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:31.225339 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:31.226051 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:31.226587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37928900e0>]}
[0m22:05:32.454828 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:32.455484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3793f9a630>]}
[0m22:05:32.636374 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:32.641493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378b739100>]}
[0m22:05:32.797354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378b3bbb90>]}
[0m22:05:32.797922 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:32.798414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378b19f560>]}
[0m22:05:32.800140 [info ] [MainThread]: 
[0m22:05:32.800839 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:32.805703 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:32.841474 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:32.841923 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:32.842316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:33.209023 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.210553 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:33.212763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:33.213331 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:33.221843 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.222280 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:33.222677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.228940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.230439 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.230854 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:33.231406 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.231842 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.232232 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:33.232800 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.233731 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.234132 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:33.234511 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:33.235051 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.235462 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:33.237440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:33.243144 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.243589 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:33.243983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:33.249896 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.250323 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:33.250724 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:33.276081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:33.277705 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:33.278963 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:33.279381 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:33.283008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3789fb2360>]}
[0m22:05:33.283589 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.284008 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.284387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:33.290910 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.291341 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.291786 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.292175 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.292718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.293128 [debug] [MainThread]: On master: Close
[0m22:05:33.294797 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:33.295325 [info ] [MainThread]: 
[0m22:05:33.305669 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:33.306356 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:33.307015 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:33.307465 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:33.333502 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:33.334295 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:33.369851 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:33.370624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:39.901458 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.901967 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:39.902619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.903076 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.903513 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:39.904245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.907082 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.907538 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:39.908256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.929108 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:39.929597 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.930041 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:39.932164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.937129 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:39.937606 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:39.938796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:39.941142 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:39.970437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3794f659a0>]}
[0m22:05:39.971193 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.66s]
[0m22:05:39.972004 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:39.972996 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:39.973561 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:39.974139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:39.974599 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:39.979794 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:39.980450 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:40.014245 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.014767 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241113220540008356"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:40.015248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:40.029636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.037004 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.037472 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:40.038060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.038525 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.038968 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241113220540008356'
      
      
      order by ordinal_position

  
[0m22:05:40.061006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.067108 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.067618 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:40.070812 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.078333 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.078816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:40.081832 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.099661 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:40.100340 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.100816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241113220540008356"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241113220540008356"
    )
  
[0m22:05:40.136418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.138409 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:40.138874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:40.139302 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:40.147676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:40.148557 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:40.233427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '436822b1-7665-4cd8-b81d-e898cd04780c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374bfe0530>]}
[0m22:05:40.234190 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.26s]
[0m22:05:40.234929 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:40.236391 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.236868 [debug] [MainThread]: On master: BEGIN
[0m22:05:40.237302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:40.244035 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.244522 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.244962 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:40.245391 [debug] [MainThread]: On master: COMMIT
[0m22:05:40.245978 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:40.246441 [debug] [MainThread]: On master: Close
[0m22:05:40.248002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:40.248448 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:40.248860 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:40.249326 [info ] [MainThread]: 
[0m22:05:40.249880 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m22:05:40.250914 [debug] [MainThread]: Command end result
[0m22:05:40.278399 [info ] [MainThread]: 
[0m22:05:40.279039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:40.279595 [info ] [MainThread]: 
[0m22:05:40.280149 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:40.281157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.442213, "process_user_time": 5.206948, "process_kernel_time": 0.363368, "process_mem_max_rss": "293184", "process_in_blocks": "3808", "process_out_blocks": "111184"}
[0m22:05:40.281803 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:40.281693 after 9.44 seconds
[0m22:05:40.282294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3794e0a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792ab1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3792f08bf0>]}
[0m22:05:40.282780 [debug] [MainThread]: Flushing usage events
[0m22:05:41.944825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1752f05e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1752683650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1752eab920>]}


============================== 22:05:41.947662 | e1ab6e5c-0a3f-4aca-b480-b2f8444d8216 ==============================
[0m22:05:41.947662 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:41.948407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.090445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1ab6e5c-0a3f-4aca-b480-b2f8444d8216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17525d6e70>]}
[0m22:05:42.107305 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21326675, "process_user_time": 1.445142, "process_kernel_time": 0.120094, "process_mem_max_rss": "92168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:42.107992 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:42.107849 after 0.21 seconds
[0m22:05:42.108547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1752683650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1753a0dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175253b290>]}
[0m22:05:42.108993 [debug] [MainThread]: Flushing usage events
[0m06:02:26.320203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067da77740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dd8e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dd8e240>]}


============================== 06:02:26.327545 | eeccea30-b464-4457-90e3-5f9ef9ada99b ==============================
[0m06:02:26.327545 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:26.328305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:26.466966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eeccea30-b464-4457-90e3-5f9ef9ada99b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dadfb90>]}
[0m06:02:26.480285 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qx4j1dn6'
[0m06:02:26.480748 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:26.515963 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:26.516563 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:26.528538 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:26.532415 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:27.001173 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:27.001785 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:27.002394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'eeccea30-b464-4457-90e3-5f9ef9ada99b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067d75d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067d606210>]}
[0m06:02:27.002856 [info ] [MainThread]: 
[0m06:02:27.003364 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:27.025914 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.75383484, "process_user_time": 1.576191, "process_kernel_time": 0.135672, "process_mem_max_rss": "93756", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:27.026512 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:27.026409 after 0.75 seconds
[0m06:02:27.026948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067e490a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dea04a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f067dea1880>]}
[0m06:02:27.027386 [debug] [MainThread]: Flushing usage events
[0m06:02:28.806974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f8782e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f8b72300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f8b70fb0>]}


============================== 06:02:28.809859 | 9229ab49-a5b9-412a-9e78-551204169ba6 ==============================
[0m06:02:28.809859 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:28.810583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:29.045768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9753140>]}
[0m06:02:29.105367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f957a7e0>]}
[0m06:02:29.107992 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:29.153318 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:29.154081 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:29.154625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f1007b90>]}
[0m06:02:30.383892 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:30.384556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0b4ac90>]}
[0m06:02:30.567534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:30.572786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0be3260>]}
[0m06:02:30.716078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f095c770>]}
[0m06:02:30.716628 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:30.717198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f0a0d250>]}
[0m06:02:30.718909 [info ] [MainThread]: 
[0m06:02:30.719634 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:30.724623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:30.760215 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:30.760665 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:30.761089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:31.452863 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:31.454429 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:31.456506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:31.457097 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:31.465623 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.466051 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:31.466440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.472610 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.474109 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.474507 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:31.475081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.475474 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.475853 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:31.476463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.477427 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.477836 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:31.478235 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:31.478772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.479184 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:31.481097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:31.486745 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.487160 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:31.487538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:31.493341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.493757 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:31.494152 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:31.516851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:31.518462 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:31.519714 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:31.520130 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:31.523731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f093e4b0>]}
[0m06:02:31.524259 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.524655 [debug] [MainThread]: On master: BEGIN
[0m06:02:31.525068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:31.531387 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.531818 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.532205 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:31.532581 [debug] [MainThread]: On master: COMMIT
[0m06:02:31.533142 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:31.533555 [debug] [MainThread]: On master: Close
[0m06:02:31.534896 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:31.535422 [info ] [MainThread]: 
[0m06:02:31.562498 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:31.563097 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:31.563844 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:31.564288 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:31.590274 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:31.591014 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:31.626572 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:31.627300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:45.890641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.891184 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:45.891910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.892386 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.892823 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:45.893675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.896560 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.897073 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:45.897767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.918737 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:45.919217 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.919655 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:45.921933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.926860 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:45.927335 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:45.928537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:45.930870 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:45.960540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f093f620>]}
[0m06:02:45.961315 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 14.40s]
[0m06:02:45.962092 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:45.963051 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:45.963611 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:45.964218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:45.964675 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:45.969840 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:45.970492 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:46.004055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.004572 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241114060245998198"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:46.005071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:46.020052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.027667 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.028138 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:46.028745 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.029223 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.029672 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241114060245998198'
      
      
      order by ordinal_position

  
[0m06:02:46.052418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.058786 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.059266 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:46.062352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.069948 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.070434 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:46.073193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.091313 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:46.092028 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.092499 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241114060245998198"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241114060245998198"
    )
  
[0m06:02:46.125246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.127246 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:46.127699 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:46.128119 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:46.136684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:46.137595 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:46.229566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9229ab49-a5b9-412a-9e78-551204169ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b11e0f50>]}
[0m06:02:46.230327 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.27s]
[0m06:02:46.231196 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:46.232684 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:46.233200 [debug] [MainThread]: On master: BEGIN
[0m06:02:46.233639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:46.240779 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:46.241297 [debug] [MainThread]: On master: COMMIT
[0m06:02:46.241733 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:46.242158 [debug] [MainThread]: On master: COMMIT
[0m06:02:46.242744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:46.243209 [debug] [MainThread]: On master: Close
[0m06:02:46.244694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:46.245211 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:46.245624 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:46.246126 [info ] [MainThread]: 
[0m06:02:46.246722 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 15.53 seconds (15.53s).
[0m06:02:46.247843 [debug] [MainThread]: Command end result
[0m06:02:46.275724 [info ] [MainThread]: 
[0m06:02:46.276421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:46.277035 [info ] [MainThread]: 
[0m06:02:46.277637 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:46.278704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.520178, "process_user_time": 5.584928, "process_kernel_time": 0.289916, "process_mem_max_rss": "297056", "process_in_blocks": "3808", "process_out_blocks": "111168"}
[0m06:02:46.279343 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:46.279234 after 17.52 seconds
[0m06:02:46.279832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8fbbbbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f8253770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c00caab0>]}
[0m06:02:46.280313 [debug] [MainThread]: Flushing usage events
[0m06:02:48.176332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda10e6df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda105f2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda1050e1b0>]}


============================== 06:02:48.179033 | 09883b42-763f-4889-8785-27d9d1af4529 ==============================
[0m06:02:48.179033 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:48.179683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:48.315980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09883b42-763f-4889-8785-27d9d1af4529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda11a2b0b0>]}
[0m06:02:48.332425 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20411718, "process_user_time": 1.401532, "process_kernel_time": 0.087845, "process_mem_max_rss": "92244", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:48.333059 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:48.332952 after 0.20 seconds
[0m06:02:48.333490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda113fbef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda113f9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda10372db0>]}
[0m06:02:48.333928 [debug] [MainThread]: Flushing usage events
[0m14:05:23.857426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed38ef650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed3b3ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed3505070>]}


============================== 14:05:23.908842 | d1246452-b161-46af-9100-1d2a52f41138 ==============================
[0m14:05:23.908842 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:23.909577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:05:24.049153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1246452-b161-46af-9100-1d2a52f41138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed452d0d0>]}
[0m14:05:24.062450 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jp0zysu6'
[0m14:05:24.062889 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:24.131553 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:24.132289 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:24.164362 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:24.168467 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:24.550471 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:24.551057 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:24.551652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd1246452-b161-46af-9100-1d2a52f41138', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed2ebf650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed2ebf620>]}
[0m14:05:24.552103 [info ] [MainThread]: 
[0m14:05:24.552654 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:24.577734 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.76840174, "process_user_time": 1.53829, "process_kernel_time": 0.136202, "process_mem_max_rss": "93140", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m14:05:24.578447 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:24.578320 after 0.77 seconds
[0m14:05:24.578948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed3a72330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed38ed730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faed441bc20>]}
[0m14:05:24.579393 [debug] [MainThread]: Flushing usage events
[0m14:05:26.327028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e3bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e3b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e39760>]}


============================== 14:05:26.329744 | c22ac58d-29b0-4797-85a1-84f250a5e56a ==============================
[0m14:05:26.329744 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:26.330449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:26.559816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc484d130>]}
[0m14:05:26.618789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc5758320>]}
[0m14:05:26.621340 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:26.637322 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:26.638079 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:26.638621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd9a4da0>]}
[0m14:05:27.848288 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:27.849094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd21f9e0>]}
[0m14:05:28.027486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:28.032490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd7cc110>]}
[0m14:05:28.166808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd39f3b0>]}
[0m14:05:28.167337 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:28.167804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd134e00>]}
[0m14:05:28.169449 [info ] [MainThread]: 
[0m14:05:28.170112 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:28.174676 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:28.209535 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:28.209974 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:28.210371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:28.804918 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:28.806453 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:28.808429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:28.808990 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:28.815988 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.816466 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:28.816864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.823382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.824834 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.825237 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:28.825826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.826220 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.826592 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:28.827154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.828054 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.828495 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:28.828881 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:28.829425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.829834 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:28.831753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:28.837565 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.837978 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:28.838350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:28.844078 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.844520 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:28.844930 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:28.868287 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:28.869737 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:28.870939 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:28.871341 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:28.874533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb7f85790>]}
[0m14:05:28.875034 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.875423 [debug] [MainThread]: On master: BEGIN
[0m14:05:28.875793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:28.882066 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.882486 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.882874 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:28.883250 [debug] [MainThread]: On master: COMMIT
[0m14:05:28.883782 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:28.884180 [debug] [MainThread]: On master: Close
[0m14:05:28.885493 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:28.885985 [info ] [MainThread]: 
[0m14:05:28.895451 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:28.896038 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:28.896707 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:28.897143 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:28.922669 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:28.923427 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:28.958642 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:28.959392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:40.609967 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.610745 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:40.611628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.612276 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.612947 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:40.613896 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.617306 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.617770 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:40.618550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.639230 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:40.639706 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.640143 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:40.641393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.646334 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:40.646799 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:40.648127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.650499 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:40.680894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd8b2000>]}
[0m14:05:40.681609 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 11.78s]
[0m14:05:40.682487 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:40.683471 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:40.684023 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:40.684713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:40.685170 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:40.690116 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:40.690757 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:40.724178 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.724715 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241114140540718343"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:40.725183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:40.739483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.746895 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.747358 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:40.747951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.748420 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.748864 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241114140540718343'
      
      
      order by ordinal_position

  
[0m14:05:40.769825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.776449 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.776939 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:40.780083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.787669 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.788147 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:40.791848 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.809939 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:40.810635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.811105 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241114140540718343"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241114140540718343"
    )
  
[0m14:05:40.848840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.850771 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:40.851222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:40.851643 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:40.860131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:40.861032 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:40.958059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22ac58d-29b0-4797-85a1-84f250a5e56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7d41c080>]}
[0m14:05:40.958812 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.27s]
[0m14:05:40.959665 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:40.961005 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:40.961483 [debug] [MainThread]: On master: BEGIN
[0m14:05:40.961913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:40.969046 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:40.969522 [debug] [MainThread]: On master: COMMIT
[0m14:05:40.969955 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:40.970378 [debug] [MainThread]: On master: COMMIT
[0m14:05:40.971008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:40.971458 [debug] [MainThread]: On master: Close
[0m14:05:40.972788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:40.973223 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:40.973620 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:40.974082 [info ] [MainThread]: 
[0m14:05:40.974669 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 12.80 seconds (12.80s).
[0m14:05:40.975772 [debug] [MainThread]: Command end result
[0m14:05:41.003565 [info ] [MainThread]: 
[0m14:05:41.004199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:41.004751 [info ] [MainThread]: 
[0m14:05:41.005294 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:41.006294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.726929, "process_user_time": 5.437077, "process_kernel_time": 0.319124, "process_mem_max_rss": "288776", "process_in_blocks": "3808", "process_out_blocks": "111136"}
[0m14:05:41.006926 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:41.006818 after 14.73 seconds
[0m14:05:41.007421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc83bbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e39760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc4e3b470>]}
[0m14:05:41.007904 [debug] [MainThread]: Flushing usage events
[0m14:05:42.828539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c62470b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c6621640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c6247140>]}


============================== 14:05:42.831537 | e2f14679-947f-4f61-a4ed-6c7bd3acb322 ==============================
[0m14:05:42.831537 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:42.832434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:42.991423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2f14679-947f-4f61-a4ed-6c7bd3acb322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c7333590>]}
[0m14:05:43.007694 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2312623, "process_user_time": 1.385493, "process_kernel_time": 0.127768, "process_mem_max_rss": "92260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:43.008269 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:43.008167 after 0.23 seconds
[0m14:05:43.008776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c8152150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c5c7bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c7333590>]}
[0m14:05:43.009203 [debug] [MainThread]: Flushing usage events
[0m22:05:42.160283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896cf6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c619640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896cf6a510>]}


============================== 22:05:42.167561 | cc84d3b7-d48e-43f8-926c-d182b827779a ==============================
[0m22:05:42.167561 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:42.168302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:05:42.308900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc84d3b7-d48e-43f8-926c-d182b827779a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c62fec0>]}
[0m22:05:42.322180 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ykaput48'
[0m22:05:42.322625 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:42.360757 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:42.361351 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:42.372349 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:42.376144 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:42.847346 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:42.847954 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:42.848581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc84d3b7-d48e-43f8-926c-d182b827779a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c364980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c660650>]}
[0m22:05:42.849055 [info ] [MainThread]: 
[0m22:05:42.849576 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:42.851062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.73878896, "process_user_time": 1.570198, "process_kernel_time": 0.147081, "process_mem_max_rss": "93460", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:42.851705 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:42.851600 after 0.74 seconds
[0m22:05:42.852138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896cf6bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c62fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c663800>]}
[0m22:05:42.852557 [debug] [MainThread]: Flushing usage events
[0m22:05:44.622145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcdec1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd55a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd65a5a0>]}


============================== 22:05:44.624946 | 859f9dc2-dd56-41ef-99e6-fb67096186f1 ==============================
[0m22:05:44.624946 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:44.625665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:44.858649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcdec1bb0>]}
[0m22:05:44.917604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd20e960>]}
[0m22:05:44.920131 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:44.935595 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:44.936303 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:44.936834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd20fdd0>]}
[0m22:05:46.159242 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:46.159935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc61d03e0>]}
[0m22:05:46.340990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:46.346053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5c44b30>]}
[0m22:05:46.487701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5c458e0>]}
[0m22:05:46.488256 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:46.488727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5c952e0>]}
[0m22:05:46.490408 [info ] [MainThread]: 
[0m22:05:46.491102 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:46.495989 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:46.532145 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:46.532627 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:46.533033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:47.066412 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:47.068094 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:47.070282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:47.070893 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:47.078293 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.078736 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:47.079144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:47.085713 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.087216 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.087674 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:47.088286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.088692 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.089076 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:47.089650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.090595 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:47.091011 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:47.091446 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:47.092026 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.092446 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:47.094652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:47.100483 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:47.100898 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:47.101283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:47.107131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.107588 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:47.107985 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:47.132084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:47.133704 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:47.134967 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:47.135427 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:47.138872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5cdb0b0>]}
[0m22:05:47.139456 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:47.139858 [debug] [MainThread]: On master: BEGIN
[0m22:05:47.140231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:47.147183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:47.147641 [debug] [MainThread]: On master: COMMIT
[0m22:05:47.148030 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:47.148402 [debug] [MainThread]: On master: COMMIT
[0m22:05:47.148923 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:47.149322 [debug] [MainThread]: On master: Close
[0m22:05:47.150948 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:47.151494 [info ] [MainThread]: 
[0m22:05:47.161104 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:47.161714 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:47.162386 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:47.162822 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:47.189329 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:47.190202 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:47.225951 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:47.226719 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:56.838158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.838682 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:56.839373 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.839827 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.840257 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:56.841006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.844081 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.844540 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:56.845222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.866127 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:56.866615 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.867054 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:56.868553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.873508 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:56.873972 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:56.875139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.877493 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:56.906995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcea5e330>]}
[0m22:05:56.907786 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 9.74s]
[0m22:05:56.908669 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:56.909648 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:56.910205 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:56.910876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:56.911362 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:56.916679 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:56.917342 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:56.950907 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:56.951453 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241114220556945028"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:56.951937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:56.967039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.974665 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:56.975135 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:56.975781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:56.976222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:56.976650 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241114220556945028'
      
      
      order by ordinal_position

  
[0m22:05:57.007908 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.014222 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:57.014702 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:57.017926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.025433 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:57.025910 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:57.030219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.048173 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:57.048872 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:57.049339 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241114220556945028"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241114220556945028"
    )
  
[0m22:05:57.083464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.085495 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:57.085977 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:57.086437 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:57.095141 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:57.096108 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:57.198841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '859f9dc2-dd56-41ef-99e6-fb67096186f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b865f8260>]}
[0m22:05:57.199722 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m22:05:57.200613 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:57.202148 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.202639 [debug] [MainThread]: On master: BEGIN
[0m22:05:57.203072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:57.210034 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.210510 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.210943 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:57.211410 [debug] [MainThread]: On master: COMMIT
[0m22:05:57.211997 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:57.212461 [debug] [MainThread]: On master: Close
[0m22:05:57.214169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:57.214605 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:57.215017 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:57.215539 [info ] [MainThread]: 
[0m22:05:57.216077 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m22:05:57.217081 [debug] [MainThread]: Command end result
[0m22:05:57.246268 [info ] [MainThread]: 
[0m22:05:57.246954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:57.247510 [info ] [MainThread]: 
[0m22:05:57.248034 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:57.249081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.675212, "process_user_time": 5.512611, "process_kernel_time": 0.27603, "process_mem_max_rss": "286444", "process_in_blocks": "3808", "process_out_blocks": "111680"}
[0m22:05:57.249750 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:57.249639 after 12.68 seconds
[0m22:05:57.250253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcd98baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc5d2ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc61e67e0>]}
[0m22:05:57.250741 [debug] [MainThread]: Flushing usage events
[0m22:05:59.175875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d852e7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d859eae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d866f1c70>]}


============================== 22:05:59.178780 | a94fdfd2-a106-4937-a791-20ecb0ca3767 ==============================
[0m22:05:59.178780 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:59.179492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:59.322309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a94fdfd2-a106-4937-a791-20ecb0ca3767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d85701e50>]}
[0m22:05:59.338566 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2116017, "process_user_time": 1.411667, "process_kernel_time": 0.10427, "process_mem_max_rss": "92060", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m22:05:59.339146 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:59.339038 after 0.21 seconds
[0m22:05:59.339633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d852e7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d86263200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d870f9f40>]}
[0m22:05:59.340051 [debug] [MainThread]: Flushing usage events
[0m06:02:09.966997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7844320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7a82f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe78440b0>]}


============================== 06:02:10.034873 | e85f4b51-7b5d-4dcf-893d-978d9b76871b ==============================
[0m06:02:10.034873 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:10.035547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:10.171708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e85f4b51-7b5d-4dcf-893d-978d9b76871b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7bb1640>]}
[0m06:02:10.184898 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-aji4bxr7'
[0m06:02:10.185340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:10.321809 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:10.322484 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:10.355687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:10.359597 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:10.744814 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:10.745446 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:10.746058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e85f4b51-7b5d-4dcf-893d-978d9b76871b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7a35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe8932db0>]}
[0m06:02:10.746535 [info ] [MainThread]: 
[0m06:02:10.747085 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:10.783397 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8642106, "process_user_time": 1.576648, "process_kernel_time": 0.099035, "process_mem_max_rss": "93516", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m06:02:10.784006 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:10.783899 after 0.86 seconds
[0m06:02:10.784462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7a37ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7a35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe7e1d430>]}
[0m06:02:10.784897 [debug] [MainThread]: Flushing usage events
[0m06:02:12.517769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b73032c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b68671a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b7506d20>]}


============================== 06:02:12.520610 | 4754fd98-e186-4bb7-b08b-a655ef73009d ==============================
[0m06:02:12.520610 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:12.521325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:02:12.751390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b6ee57f0>]}
[0m06:02:12.810123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b6dfb050>]}
[0m06:02:12.812623 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:12.845365 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:12.846083 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:12.846623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b6a3ed80>]}
[0m06:02:14.070307 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:14.070990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af6b13a0>]}
[0m06:02:14.251900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:14.257208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af150f80>]}
[0m06:02:14.377847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af5adc70>]}
[0m06:02:14.378412 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:14.378894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af096630>]}
[0m06:02:14.380586 [info ] [MainThread]: 
[0m06:02:14.381265 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:14.386127 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:14.421651 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:14.422108 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:14.422501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:15.037471 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:15.039073 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:15.041237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:15.041802 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:15.048969 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.049403 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:15.049817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.056062 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.057511 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.057912 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:15.058451 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.058843 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.059273 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:15.059875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.060785 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.061179 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:15.061548 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:15.062084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.062490 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:15.064367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:15.070013 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.070432 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:15.070807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:15.076669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.077079 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:15.077472 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:15.100922 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:15.102368 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:15.103616 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:15.104022 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:15.107300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b7ead340>]}
[0m06:02:15.107808 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.108194 [debug] [MainThread]: On master: BEGIN
[0m06:02:15.108555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:15.114802 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.115274 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.115675 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:15.116048 [debug] [MainThread]: On master: COMMIT
[0m06:02:15.116585 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:15.116994 [debug] [MainThread]: On master: Close
[0m06:02:15.118731 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:15.119286 [info ] [MainThread]: 
[0m06:02:15.164347 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:15.164990 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:15.165748 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:15.166195 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:15.192718 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:15.193482 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:15.229642 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:15.230384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:28.016002 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.016531 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:28.017177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.017632 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.018073 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:28.018803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.021705 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.022164 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:28.022870 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.043772 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.044257 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.044699 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.049294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.054264 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.054733 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:28.056032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.058362 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:28.088416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b7302600>]}
[0m06:02:28.089182 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 12.92s]
[0m06:02:28.089951 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:28.090993 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:28.091568 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:28.092171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:28.092633 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:28.097900 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:28.098550 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:28.132453 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.132967 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241115060228126485"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:28.133445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:28.148555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.156008 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.156477 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:28.157126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.157575 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.158018 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241115060228126485'
      
      
      order by ordinal_position

  
[0m06:02:28.179030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.185174 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.185675 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.188930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.196609 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.197089 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:28.199924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.217927 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:28.218620 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.219128 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241115060228126485"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241115060228126485"
    )
  
[0m06:02:28.253371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.255423 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:28.255885 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:28.256361 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:28.264518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.265419 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:28.377725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4754fd98-e186-4bb7-b08b-a655ef73009d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06ba5af30>]}
[0m06:02:28.378526 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m06:02:28.379328 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:28.380927 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.381414 [debug] [MainThread]: On master: BEGIN
[0m06:02:28.381847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:28.388687 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.389159 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.389594 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:28.390014 [debug] [MainThread]: On master: COMMIT
[0m06:02:28.390579 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:28.391083 [debug] [MainThread]: On master: Close
[0m06:02:28.392521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:28.392956 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:28.393370 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:28.393831 [info ] [MainThread]: 
[0m06:02:28.394370 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 14.01 seconds (14.01s).
[0m06:02:28.395411 [debug] [MainThread]: Command end result
[0m06:02:28.423180 [info ] [MainThread]: 
[0m06:02:28.423782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:28.424274 [info ] [MainThread]: 
[0m06:02:28.424777 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:28.425761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.956129, "process_user_time": 5.450622, "process_kernel_time": 0.368989, "process_mem_max_rss": "292296", "process_in_blocks": "3808", "process_out_blocks": "112168"}
[0m06:02:28.426399 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:28.426290 after 15.96 seconds
[0m06:02:28.426894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0b6dfac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af124800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0af10c1a0>]}
[0m06:02:28.427444 [debug] [MainThread]: Flushing usage events
[0m06:02:30.299282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8af19790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f89bf9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8a007230>]}


============================== 06:02:30.302039 | 9e4ad980-53b3-4d58-b957-a270205ff90d ==============================
[0m06:02:30.302039 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:30.302688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:30.439946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e4ad980-53b3-4d58-b957-a270205ff90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f8947be00>]}
[0m06:02:30.456665 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20594522, "process_user_time": 1.449128, "process_kernel_time": 0.091818, "process_mem_max_rss": "92412", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:30.457259 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:30.457155 after 0.21 seconds
[0m06:02:30.457705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f896d6d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f89780c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f89562960>]}
[0m06:02:30.458133 [debug] [MainThread]: Flushing usage events
[0m14:05:35.139852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b49b2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b4c5ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b4c1a600>]}


============================== 14:05:35.156217 | 35778c99-d289-42e5-9d4f-8fc7ced7d2d3 ==============================
[0m14:05:35.156217 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:35.156905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:35.304681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35778c99-d289-42e5-9d4f-8fc7ced7d2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b48f1190>]}
[0m14:05:35.318190 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pzit68t5'
[0m14:05:35.318641 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:35.367174 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:35.367818 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:35.379351 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:35.383189 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:35.538246 [info ] [MainThread]: Installed from version 1.2.0
[0m14:05:35.538793 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:05:35.539297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '35778c99-d289-42e5-9d4f-8fc7ced7d2d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b45e0c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b46859d0>]}
[0m14:05:35.539789 [info ] [MainThread]: 
[0m14:05:35.540247 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:05:35.567769 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4760477, "process_user_time": 1.568583, "process_kernel_time": 0.142598, "process_mem_max_rss": "93524", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:05:35.568485 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:35.568375 after 0.48 seconds
[0m14:05:35.568939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b49b2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b4973800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b5042360>]}
[0m14:05:35.569376 [debug] [MainThread]: Flushing usage events
[0m14:05:37.198839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e07560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e07a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350e07680>]}


============================== 14:05:37.201608 | 51746001-b8ac-4c2b-9ffd-893f059b0ed6 ==============================
[0m14:05:37.201608 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:37.202285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:37.440062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe349f5d2b0>]}
[0m14:05:37.498899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe351dc8a40>]}
[0m14:05:37.501433 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:05:37.527658 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:37.528383 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:37.528911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe350ec8050>]}
[0m14:05:38.755645 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:38.756287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3498a4440>]}
[0m14:05:38.936330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:05:38.941375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3498ec110>]}
[0m14:05:39.109779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3499fa480>]}
[0m14:05:39.110368 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:05:39.110846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34974cb60>]}
[0m14:05:39.112614 [info ] [MainThread]: 
[0m14:05:39.113320 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:39.118110 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:05:39.153592 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:05:39.154032 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:05:39.154442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:39.723773 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m14:05:39.725360 [debug] [ThreadPool]: On list_petro: Close
[0m14:05:39.727487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:05:39.728108 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:05:39.735240 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.735711 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:05:39.736116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:39.742517 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.744067 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.744475 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:05:39.745069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.745464 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.745838 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:05:39.746399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.747314 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:39.747754 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:05:39.748127 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:05:39.748666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.749073 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:05:39.751116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:05:39.756746 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:39.757153 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:05:39.757517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:39.763199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.763606 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:05:39.764038 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:05:39.787453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:05:39.788914 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:05:39.790127 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:05:39.790534 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:05:39.793864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe349710c80>]}
[0m14:05:39.794375 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.794767 [debug] [MainThread]: On master: BEGIN
[0m14:05:39.795132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:39.801574 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.802006 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.802401 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:39.802784 [debug] [MainThread]: On master: COMMIT
[0m14:05:39.803310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:39.803760 [debug] [MainThread]: On master: Close
[0m14:05:39.805257 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:39.805759 [info ] [MainThread]: 
[0m14:05:39.823835 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:05:39.824444 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:05:39.825106 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:05:39.825554 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:05:39.851600 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:05:39.852373 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:05:39.888414 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:05:39.889207 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:47.752635 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.753165 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:05:47.753816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.754287 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.754737 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:05:47.755539 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.758509 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.758979 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:05:47.759704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.780444 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:47.780924 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.781369 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:05:47.783262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.788211 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:05:47.788685 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:05:47.789892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.792269 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:05:47.821769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3519c68d0>]}
[0m14:05:47.822506 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 8.00s]
[0m14:05:47.823386 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:05:47.824423 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:05:47.824994 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:05:47.825669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:05:47.826133 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:05:47.831346 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:05:47.832057 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:05:47.866006 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.866519 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241115140547860105"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:05:47.866989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:47.881542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.889051 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.889528 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:05:47.890139 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.890594 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.891045 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241115140547860105'
      
      
      order by ordinal_position

  
[0m14:05:47.911963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.918356 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.918849 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:47.921679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.929335 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.929816 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:05:47.932645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.950696 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:05:47.951451 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.951987 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241115140547860105"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241115140547860105"
    )
  
[0m14:05:47.984550 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:47.986663 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:47.987158 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:05:47.987597 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:05:47.999746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:05:48.000681 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:05:48.111335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51746001-b8ac-4c2b-9ffd-893f059b0ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30a16b800>]}
[0m14:05:48.112176 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m14:05:48.113061 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:05:48.114443 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.114946 [debug] [MainThread]: On master: BEGIN
[0m14:05:48.115387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:48.122198 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.122671 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.123106 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.123528 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.124138 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:05:48.124588 [debug] [MainThread]: On master: Close
[0m14:05:48.126204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:48.126636 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:05:48.127038 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:05:48.127489 [info ] [MainThread]: 
[0m14:05:48.128054 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 9.01 seconds (9.01s).
[0m14:05:48.129043 [debug] [MainThread]: Command end result
[0m14:05:48.156966 [info ] [MainThread]: 
[0m14:05:48.157568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:48.158066 [info ] [MainThread]: 
[0m14:05:48.158579 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:05:48.159568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.00877, "process_user_time": 5.518457, "process_kernel_time": 0.32696, "process_mem_max_rss": "293740", "process_in_blocks": "3808", "process_out_blocks": "112160"}
[0m14:05:48.160251 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:48.160142 after 11.01 seconds
[0m14:05:48.160738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe351f58110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30b003740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3499e8650>]}
[0m14:05:48.161218 [debug] [MainThread]: Flushing usage events
[0m14:05:49.893928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36313f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe364b9a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe363f9de20>]}


============================== 14:05:49.896884 | aab219f2-8279-470f-80b3-b85617a4635e ==============================
[0m14:05:49.896884 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:49.897629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:05:50.039054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aab219f2-8279-470f-80b3-b85617a4635e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3633ade50>]}
[0m14:05:50.055746 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21065614, "process_user_time": 1.418729, "process_kernel_time": 0.091917, "process_mem_max_rss": "92260", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:05:50.056346 [debug] [MainThread]: Command `dbt clean` succeeded at 14:05:50.056241 after 0.21 seconds
[0m14:05:50.056794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3628e2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe36268bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362cdaf00>]}
[0m14:05:50.057227 [debug] [MainThread]: Flushing usage events
[0m22:06:02.411751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61baa2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61a2fef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff619b65040>]}


============================== 22:06:02.419453 | 811dbf86-e491-483c-9b1c-579575570a0d ==============================
[0m22:06:02.419453 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:02.420121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:06:02.562496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '811dbf86-e491-483c-9b1c-579575570a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61992fd70>]}
[0m22:06:02.575747 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jrn0hx1f'
[0m22:06:02.576194 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:06:02.658220 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:06:02.658828 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:06:02.685496 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:06:02.690454 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:06:02.761221 [info ] [MainThread]: Installed from version 1.2.0
[0m22:06:02.761810 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:06:02.762414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '811dbf86-e491-483c-9b1c-579575570a0d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6197f1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61986bd40>]}
[0m22:06:02.762889 [info ] [MainThread]: 
[0m22:06:02.763440 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:06:02.806670 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.44377574, "process_user_time": 1.576055, "process_kernel_time": 0.125921, "process_mem_max_rss": "93384", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:06:02.807286 [debug] [MainThread]: Command `dbt deps` succeeded at 22:06:02.807181 after 0.44 seconds
[0m22:06:02.807769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff619c998e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff61a3e2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff619dc7f80>]}
[0m22:06:02.808223 [debug] [MainThread]: Flushing usage events
[0m22:06:04.398784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a021229c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a028f2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a02221ee0>]}


============================== 22:06:04.401690 | 3b1f2142-1491-49c8-84a7-bc610f9b882d ==============================
[0m22:06:04.401690 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:04.402358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:04.635756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a01e35400>]}
[0m22:06:04.694938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a01f60b60>]}
[0m22:06:04.697425 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:06:04.713285 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:06:04.714006 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:04.714531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a01f41a00>]}
[0m22:06:05.946848 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:06:05.947526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fab87380>]}
[0m22:06:06.128201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:06:06.133278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fab05370>]}
[0m22:06:06.270406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19faa59ac0>]}
[0m22:06:06.270981 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:06:06.271511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19faad2cf0>]}
[0m22:06:06.273237 [info ] [MainThread]: 
[0m22:06:06.273940 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:06:06.278875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:06:06.314211 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:06:06.314666 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:06:06.315066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:06.924925 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:06:06.926499 [debug] [ThreadPool]: On list_petro: Close
[0m22:06:06.928820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:06:06.929408 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:06:06.936553 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.936984 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:06:06.937374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:06.943611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.945061 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.945462 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:06:06.946053 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.946448 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.946821 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:06:06.947432 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.948349 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:06.948759 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:06:06.949132 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:06:06.949677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.950079 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:06:06.952005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:06:06.957513 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:06.957923 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:06:06.958297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:06.964151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.964578 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:06:06.964972 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:06:06.988557 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:06:06.990110 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:06:06.991365 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:06:06.991791 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:06:06.995559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f973b470>]}
[0m22:06:06.996080 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:06.996473 [debug] [MainThread]: On master: BEGIN
[0m22:06:06.996842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:07.003237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.003697 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.004084 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:07.004457 [debug] [MainThread]: On master: COMMIT
[0m22:06:07.004990 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:07.005393 [debug] [MainThread]: On master: Close
[0m22:06:07.006946 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:06:07.007488 [info ] [MainThread]: 
[0m22:06:07.017249 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:06:07.017855 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:06:07.018496 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:06:07.018947 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:06:07.044988 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:06:07.045751 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:06:07.081928 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:06:07.082772 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:14.087022 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.087575 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:06:14.088222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.088683 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.089124 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:06:14.089850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.092754 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.093213 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:06:14.093907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.114664 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:14.115164 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.115631 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:06:14.116871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.121749 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:06:14.122217 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:06:14.123580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.125883 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:06:14.156692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19bbb32390>]}
[0m22:06:14.157477 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.14s]
[0m22:06:14.158354 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:06:14.159396 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:06:14.159967 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:06:14.160639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:06:14.161106 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:06:14.166317 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:06:14.166971 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:06:14.200698 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.201210 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241115220614194825"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:06:14.201694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:14.217495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.225153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.225642 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:06:14.226240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.226696 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.227132 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241115220614194825'
      
      
      order by ordinal_position

  
[0m22:06:14.249492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.256241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.256751 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:14.259954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.267531 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.268009 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:06:14.270836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.288767 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:06:14.289466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.289932 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241115220614194825"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241115220614194825"
    )
  
[0m22:06:14.324899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.326899 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:14.327402 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:06:14.327840 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:06:14.335778 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:06:14.336736 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:06:14.463266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1f2142-1491-49c8-84a7-bc610f9b882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19bb137560>]}
[0m22:06:14.464119 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m22:06:14.464911 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:06:14.466430 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.466936 [debug] [MainThread]: On master: BEGIN
[0m22:06:14.467445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:14.474303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.474780 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.475225 [debug] [MainThread]: Using duckdb connection "master"
[0m22:06:14.475697 [debug] [MainThread]: On master: COMMIT
[0m22:06:14.476305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:06:14.476752 [debug] [MainThread]: On master: Close
[0m22:06:14.478467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:14.478899 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:06:14.479299 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:06:14.479822 [info ] [MainThread]: 
[0m22:06:14.480356 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m22:06:14.481359 [debug] [MainThread]: Command end result
[0m22:06:14.509249 [info ] [MainThread]: 
[0m22:06:14.509871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:14.510380 [info ] [MainThread]: 
[0m22:06:14.510900 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:06:14.511935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.161415, "process_user_time": 5.536103, "process_kernel_time": 0.391441, "process_mem_max_rss": "292524", "process_in_blocks": "3808", "process_out_blocks": "112704"}
[0m22:06:14.512587 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:14.512477 after 10.16 seconds
[0m22:06:14.513078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a05dbbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a02a71d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19bb167f20>]}
[0m22:06:14.513566 [debug] [MainThread]: Flushing usage events
[0m22:06:16.225698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0662f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c08049a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c060b4440>]}


============================== 22:06:16.228609 | b9e1e41e-40f5-4b95-bf70-9741ece32379 ==============================
[0m22:06:16.228609 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:06:16.229273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:16.368343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9e1e41e-40f5-4b95-bf70-9741ece32379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c05d6aff0>]}
[0m22:06:16.384741 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20734015, "process_user_time": 1.364068, "process_kernel_time": 0.139597, "process_mem_max_rss": "92372", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:16.385334 [debug] [MainThread]: Command `dbt clean` succeeded at 22:06:16.385230 after 0.21 seconds
[0m22:06:16.385772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c05e3cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c05d9e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c06be9be0>]}
[0m22:06:16.386206 [debug] [MainThread]: Flushing usage events
[0m06:02:17.276174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9a1fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9f2a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9f29c40>]}


============================== 06:02:17.297146 | f4b8ba99-9a89-46d9-995f-11dc47e98bf1 ==============================
[0m06:02:17.297146 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:17.297817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:17.432699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4b8ba99-9a89-46d9-995f-11dc47e98bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9584170>]}
[0m06:02:17.446039 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_co7evfb'
[0m06:02:17.446485 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:17.579212 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:17.579815 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:17.602152 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:17.606023 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:17.689018 [info ] [MainThread]: Installed from version 1.2.0
[0m06:02:17.689569 [info ] [MainThread]: Updated version available: 1.3.0
[0m06:02:17.690167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f4b8ba99-9a89-46d9-995f-11dc47e98bf1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d94497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9449cd0>]}
[0m06:02:17.690611 [info ] [MainThread]: 
[0m06:02:17.691164 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m06:02:17.713913 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48564953, "process_user_time": 1.587725, "process_kernel_time": 0.101516, "process_mem_max_rss": "93768", "process_in_blocks": "6296", "process_out_blocks": "3992"}
[0m06:02:17.714671 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:17.714542 after 0.49 seconds
[0m06:02:17.715110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9ce4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d94c1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d9563d70>]}
[0m06:02:17.715537 [debug] [MainThread]: Flushing usage events
[0m06:02:19.277503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2a116cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2a8fd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2a8fd2e0>]}


============================== 06:02:19.280177 | 4c097125-fa86-46ce-9ffa-b4ea6015f113 ==============================
[0m06:02:19.280177 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:19.280928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:19.509277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f29ef0380>]}
[0m06:02:19.567641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f29df85c0>]}
[0m06:02:19.570015 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m06:02:19.597578 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:02:19.598292 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:02:19.598829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f22f03680>]}
[0m06:02:20.820482 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:02:20.821117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f22a79bb0>]}
[0m06:02:21.001273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m06:02:21.006347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f22a42cc0>]}
[0m06:02:21.155420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f22a596d0>]}
[0m06:02:21.155961 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m06:02:21.156469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f229f0770>]}
[0m06:02:21.158244 [info ] [MainThread]: 
[0m06:02:21.158954 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:02:21.163697 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m06:02:21.198231 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m06:02:21.198669 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m06:02:21.199072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:21.790728 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m06:02:21.792298 [debug] [ThreadPool]: On list_petro: Close
[0m06:02:21.794443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m06:02:21.795021 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m06:02:21.802193 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.802632 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m06:02:21.803024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:21.809697 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.811172 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.811594 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m06:02:21.812204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.812598 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.812972 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m06:02:21.813531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.814481 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.814882 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m06:02:21.815260 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m06:02:21.815861 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.816270 [debug] [ThreadPool]: On create_petro_main: Close
[0m06:02:21.818283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m06:02:21.823930 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:21.824341 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m06:02:21.824713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:21.830604 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.831013 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m06:02:21.831408 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m06:02:21.854667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:02:21.856130 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m06:02:21.857326 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m06:02:21.857767 [debug] [ThreadPool]: On list_petro_main: Close
[0m06:02:21.860978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f229f0230>]}
[0m06:02:21.861482 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.861917 [debug] [MainThread]: On master: BEGIN
[0m06:02:21.862296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:21.868506 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.868938 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.869330 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:21.869743 [debug] [MainThread]: On master: COMMIT
[0m06:02:21.870288 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:21.870695 [debug] [MainThread]: On master: Close
[0m06:02:21.872197 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m06:02:21.872747 [info ] [MainThread]: 
[0m06:02:21.898267 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m06:02:21.898867 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m06:02:21.899599 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m06:02:21.900042 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m06:02:21.925580 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m06:02:21.926343 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m06:02:21.961726 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m06:02:21.962462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:28.894436 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.894944 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m06:02:28.895596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.896055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.896494 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m06:02:28.897269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.900146 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.900601 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m06:02:28.901297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.922983 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.923466 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.923908 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m06:02:28.925012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.929926 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m06:02:28.930396 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m06:02:28.931912 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:28.934220 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m06:02:28.964714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f216636e0>]}
[0m06:02:28.965421 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.06s]
[0m06:02:28.966236 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m06:02:28.967207 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m06:02:28.967762 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m06:02:28.968352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m06:02:28.968799 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m06:02:28.973871 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m06:02:28.974510 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m06:02:29.007715 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.008217 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241116060229001945"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m06:02:29.008689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:29.022756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.029994 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.030456 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m06:02:29.031048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.031578 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.032034 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241116060229001945'
      
      
      order by ordinal_position

  
[0m06:02:29.052986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.059072 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.059558 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.062620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.070153 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.070634 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m06:02:29.073407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.091203 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m06:02:29.091874 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.092342 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241116060229001945"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241116060229001945"
    )
  
[0m06:02:29.126590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.128587 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.129055 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m06:02:29.129480 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m06:02:29.137709 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:02:29.138613 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m06:02:29.259390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c097125-fa86-46ce-9ffa-b4ea6015f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ef019b170>]}
[0m06:02:29.260171 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.29s]
[0m06:02:29.260911 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m06:02:29.262313 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.262795 [debug] [MainThread]: On master: BEGIN
[0m06:02:29.263241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:29.270043 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.270513 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.270950 [debug] [MainThread]: Using duckdb connection "master"
[0m06:02:29.271370 [debug] [MainThread]: On master: COMMIT
[0m06:02:29.271954 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:02:29.272412 [debug] [MainThread]: On master: Close
[0m06:02:29.273870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:29.274305 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m06:02:29.274708 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m06:02:29.275164 [info ] [MainThread]: 
[0m06:02:29.275752 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.12 seconds (8.12s).
[0m06:02:29.276869 [debug] [MainThread]: Command end result
[0m06:02:29.304754 [info ] [MainThread]: 
[0m06:02:29.305423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:29.306059 [info ] [MainThread]: 
[0m06:02:29.306656 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:02:29.307728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.078036, "process_user_time": 5.453427, "process_kernel_time": 0.309214, "process_mem_max_rss": "299540", "process_in_blocks": "3808", "process_out_blocks": "112176"}
[0m06:02:29.308365 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:29.308256 after 10.08 seconds
[0m06:02:29.308850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f29df8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f2ddbbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ee38bacc0>]}
[0m06:02:29.309331 [debug] [MainThread]: Flushing usage events
[0m06:02:30.912445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c70cc800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6741a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c70cfd70>]}


============================== 06:02:30.915133 | 216bdfab-8159-4fc1-b176-d7130e47c0f6 ==============================
[0m06:02:30.915133 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:02:30.915853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.058363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '216bdfab-8159-4fc1-b176-d7130e47c0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6799640>]}
[0m06:02:31.075042 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21053475, "process_user_time": 1.36596, "process_kernel_time": 0.127809, "process_mem_max_rss": "92036", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:02:31.075627 [debug] [MainThread]: Command `dbt clean` succeeded at 06:02:31.075522 after 0.21 seconds
[0m06:02:31.076071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6f0a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c65b7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c65035c0>]}
[0m06:02:31.076504 [debug] [MainThread]: Flushing usage events
[0m14:04:44.975438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf931ed1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf931ec0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf931ec080>]}


============================== 14:04:44.991035 | fd21bc0f-7611-4875-8b32-995ae42ff9a9 ==============================
[0m14:04:44.991035 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:44.991773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:45.134797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd21bc0f-7611-4875-8b32-995ae42ff9a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf933d3c80>]}
[0m14:04:45.148005 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mynwzf16'
[0m14:04:45.148447 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:45.202112 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:45.202731 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:45.226125 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:45.230180 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:04:45.325761 [info ] [MainThread]: Installed from version 1.2.0
[0m14:04:45.326478 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:04:45.327126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fd21bc0f-7611-4875-8b32-995ae42ff9a9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf932582c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf942f9520>]}
[0m14:04:45.327634 [info ] [MainThread]: 
[0m14:04:45.328226 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:04:45.343759 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41889602, "process_user_time": 1.594777, "process_kernel_time": 0.143529, "process_mem_max_rss": "93724", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m14:04:45.344415 [debug] [MainThread]: Command `dbt deps` succeeded at 14:04:45.344309 after 0.42 seconds
[0m14:04:45.344926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf93dc15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf932465a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf933d3c80>]}
[0m14:04:45.345383 [debug] [MainThread]: Flushing usage events
[0m14:04:46.965566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c2053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236ba143e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236aa120f0>]}


============================== 14:04:46.968543 | fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21 ==============================
[0m14:04:46.968543 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:46.969309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:47.213511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236a648380>]}
[0m14:04:47.273181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236a774800>]}
[0m14:04:47.275785 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m14:04:47.295380 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:04:47.296125 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:04:47.296646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236373d8e0>]}
[0m14:04:48.529176 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:04:48.529835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23635c8a10>]}
[0m14:04:48.712095 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m14:04:48.717482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236a774aa0>]}
[0m14:04:48.866121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23635b66f0>]}
[0m14:04:48.866694 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m14:04:48.867221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236317e5a0>]}
[0m14:04:48.869032 [info ] [MainThread]: 
[0m14:04:48.869769 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:04:48.874518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m14:04:48.910362 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m14:04:48.910830 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m14:04:48.911239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:49.390635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.392142 [debug] [ThreadPool]: On list_petro: Close
[0m14:04:49.394270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m14:04:49.394827 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m14:04:49.401933 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.402371 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m14:04:49.402833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:49.409027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.410440 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.410845 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m14:04:49.411379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.411773 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.412153 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m14:04:49.412727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.413673 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:49.414081 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m14:04:49.414492 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m14:04:49.415043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.415492 [debug] [ThreadPool]: On create_petro_main: Close
[0m14:04:49.417385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m14:04:49.423019 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:49.423438 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m14:04:49.423827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:04:49.429607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.430049 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m14:04:49.430458 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m14:04:49.451926 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:04:49.453477 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m14:04:49.454716 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m14:04:49.455117 [debug] [ThreadPool]: On list_petro_main: Close
[0m14:04:49.458624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23635fa420>]}
[0m14:04:49.459146 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:49.459539 [debug] [MainThread]: On master: BEGIN
[0m14:04:49.459911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:49.466975 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:49.467405 [debug] [MainThread]: On master: COMMIT
[0m14:04:49.467889 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:49.468572 [debug] [MainThread]: On master: COMMIT
[0m14:04:49.469323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:49.469953 [debug] [MainThread]: On master: Close
[0m14:04:49.471571 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:04:49.472081 [info ] [MainThread]: 
[0m14:04:49.486657 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m14:04:49.487257 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m14:04:49.487935 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m14:04:49.488373 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m14:04:49.519434 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m14:04:49.520217 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m14:04:49.555818 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m14:04:49.556662 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:57.214409 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.214928 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m14:04:57.215557 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.216007 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.216441 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m14:04:57.217240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.220114 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.220571 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m14:04:57.221335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.242319 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:57.242844 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.243294 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m14:04:57.245129 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.250221 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m14:04:57.250697 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m14:04:57.251902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.254334 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m14:04:57.283604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236b09a330>]}
[0m14:04:57.284375 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 7.79s]
[0m14:04:57.285192 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m14:04:57.286200 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m14:04:57.286774 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m14:04:57.287386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m14:04:57.287840 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m14:04:57.293106 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m14:04:57.293772 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m14:04:57.327582 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.328108 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241116140457321675"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m14:04:57.328596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:57.343712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.351538 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.352015 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m14:04:57.352708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.353195 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.353636 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241116140457321675'
      
      
      order by ordinal_position

  
[0m14:04:57.374229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.380687 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.381198 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:57.384042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.391723 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.392199 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m14:04:57.394995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.412939 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m14:04:57.413641 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.414116 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241116140457321675"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241116140457321675"
    )
  
[0m14:04:57.446628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.448656 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:57.449154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m14:04:57.449584 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m14:04:57.457398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:04:57.458316 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m14:04:57.593053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17da1b-bfaa-4fae-8eae-a8fd7b8cbe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f231b712ae0>]}
[0m14:04:57.593868 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.31s]
[0m14:04:57.594725 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m14:04:57.596158 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.596695 [debug] [MainThread]: On master: BEGIN
[0m14:04:57.597204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:57.603927 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.604410 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.604885 [debug] [MainThread]: Using duckdb connection "master"
[0m14:04:57.605331 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.605965 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:04:57.606427 [debug] [MainThread]: On master: Close
[0m14:04:57.607804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:57.608236 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m14:04:57.608643 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m14:04:57.609162 [info ] [MainThread]: 
[0m14:04:57.609700 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m14:04:57.610724 [debug] [MainThread]: Command end result
[0m14:04:57.638554 [info ] [MainThread]: 
[0m14:04:57.639191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:57.639707 [info ] [MainThread]: 
[0m14:04:57.640230 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:57.641260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.726796, "process_user_time": 5.049144, "process_kernel_time": 0.328074, "process_mem_max_rss": "283404", "process_in_blocks": "3808", "process_out_blocks": "113192"}
[0m14:04:57.641913 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:57.641790 after 10.73 seconds
[0m14:04:57.642406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c2053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236a6ef9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23635ed4f0>]}
[0m14:04:57.642895 [debug] [MainThread]: Flushing usage events
[0m14:04:59.359770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40db9cc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dcb55b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40da8736b0>]}


============================== 14:04:59.362734 | d7b2823d-f636-47ab-a8c7-76427c38dc39 ==============================
[0m14:04:59.362734 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:04:59.363420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:04:59.506568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b2823d-f636-47ab-a8c7-76427c38dc39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40db1d3140>]}
[0m14:04:59.523462 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2145698, "process_user_time": 1.499601, "process_kernel_time": 0.067981, "process_mem_max_rss": "92168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:04:59.524065 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:59.523959 after 0.22 seconds
[0m14:04:59.524516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dc8a8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40da670c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40db0538c0>]}
[0m14:04:59.525012 [debug] [MainThread]: Flushing usage events
[0m22:05:22.300458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cfc19e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ce58d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ce024d10>]}


============================== 22:05:22.308115 | f076b89e-1122-4461-8c0d-77a8b8ad9905 ==============================
[0m22:05:22.308115 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:22.308790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:22.449654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f076b89e-1122-4461-8c0d-77a8b8ad9905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cd697b90>]}
[0m22:05:22.463142 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-oac3wzps'
[0m22:05:22.463595 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:05:22.592173 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:05:22.592877 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:05:22.602152 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:05:22.606016 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:05:22.659407 [info ] [MainThread]: Installed from version 1.2.0
[0m22:05:22.659972 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:05:22.660552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f076b89e-1122-4461-8c0d-77a8b8ad9905', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cda3f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cd628260>]}
[0m22:05:22.661004 [info ] [MainThread]: 
[0m22:05:22.661583 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:05:22.663591 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4112259, "process_user_time": 1.598572, "process_kernel_time": 0.115033, "process_mem_max_rss": "93692", "process_in_blocks": "6296", "process_out_blocks": "4000"}
[0m22:05:22.664216 [debug] [MainThread]: Command `dbt deps` succeeded at 22:05:22.664108 after 0.41 seconds
[0m22:05:22.664647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cfc19e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cd65ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18cdc57e30>]}
[0m22:05:22.665070 [debug] [MainThread]: Flushing usage events
[0m22:05:24.202368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbee01670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbde91cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbde90860>]}


============================== 22:05:24.205305 | 5e344863-b0a9-46ba-979d-ddeb62f584ce ==============================
[0m22:05:24.205305 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:24.205980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:24.439753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbfb20380>]}
[0m22:05:24.498277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbe5d2c00>]}
[0m22:05:24.500826 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m22:05:24.516465 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:05:24.517172 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:05:24.517705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbd37fb90>]}
[0m22:05:25.746229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:25.746872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb61fb890>]}
[0m22:05:25.928380 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.petro.example
[0m22:05:25.933663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb5d1da30>]}
[0m22:05:26.101621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb6199af0>]}
[0m22:05:26.102215 [info ] [MainThread]: Found 2 models, 1 test, 522 macros
[0m22:05:26.102743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb5c50da0>]}
[0m22:05:26.104602 [info ] [MainThread]: 
[0m22:05:26.105356 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:05:26.110280 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_petro'
[0m22:05:26.146453 [debug] [ThreadPool]: Using duckdb connection "list_petro"
[0m22:05:26.146911 [debug] [ThreadPool]: On list_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"petro"'
    
  
  
[0m22:05:26.147316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:26.685984 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m22:05:26.687566 [debug] [ThreadPool]: On list_petro: Close
[0m22:05:26.689853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_petro, now create_petro_main)
[0m22:05:26.690462 [debug] [ThreadPool]: Creating schema "database: "petro"
schema: "main"
"
[0m22:05:26.697756 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:26.698208 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='petro'
        and type='sqlite'
    
  
[0m22:05:26.698603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:26.705113 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.706591 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:26.707003 [debug] [ThreadPool]: On create_petro_main: BEGIN
[0m22:05:26.707599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.707995 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:26.708419 [debug] [ThreadPool]: On create_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "create_petro_main"} */

    
    
        create schema if not exists "petro"."main"
    
[0m22:05:26.709001 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.709908 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:26.710313 [debug] [ThreadPool]: Using duckdb connection "create_petro_main"
[0m22:05:26.710688 [debug] [ThreadPool]: On create_petro_main: COMMIT
[0m22:05:26.711284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.711692 [debug] [ThreadPool]: On create_petro_main: Close
[0m22:05:26.713629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_petro_main, now list_petro_main)
[0m22:05:26.719343 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:26.719756 [debug] [ThreadPool]: On list_petro_main: BEGIN
[0m22:05:26.720161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:26.725909 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.726320 [debug] [ThreadPool]: Using duckdb connection "list_petro_main"
[0m22:05:26.726714 [debug] [ThreadPool]: On list_petro_main: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "connection_name": "list_petro_main"} */
select
      'petro' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'petro'
  
[0m22:05:26.750408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:05:26.751935 [debug] [ThreadPool]: On list_petro_main: ROLLBACK
[0m22:05:26.753187 [debug] [ThreadPool]: Failed to rollback 'list_petro_main'
[0m22:05:26.753589 [debug] [ThreadPool]: On list_petro_main: Close
[0m22:05:26.757636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb5d4a630>]}
[0m22:05:26.758167 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:26.758563 [debug] [MainThread]: On master: BEGIN
[0m22:05:26.758937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:26.765663 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:26.766090 [debug] [MainThread]: On master: COMMIT
[0m22:05:26.766487 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:26.766868 [debug] [MainThread]: On master: COMMIT
[0m22:05:26.767409 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:26.767812 [debug] [MainThread]: On master: Close
[0m22:05:26.769283 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:05:26.769807 [info ] [MainThread]: 
[0m22:05:26.779464 [debug] [Thread-1 (]: Began running node model.petro.stg_petro
[0m22:05:26.780107 [info ] [Thread-1 (]: 1 of 2 START python table model main.stg_petro ................................. [RUN]
[0m22:05:26.780861 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.petro.stg_petro'
[0m22:05:26.781306 [debug] [Thread-1 (]: Began compiling node model.petro.stg_petro
[0m22:05:26.807382 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.stg_petro"
[0m22:05:26.808167 [debug] [Thread-1 (]: Began executing node model.petro.stg_petro
[0m22:05:26.844191 [debug] [Thread-1 (]: Writing runtime python for node "model.petro.stg_petro"
[0m22:05:26.845059 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:33.280154 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.280689 [debug] [Thread-1 (]: On model.petro.stg_petro: BEGIN
[0m22:05:33.281331 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.281787 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.282230 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro" rename to "stg_petro__dbt_backup"
[0m22:05:33.282947 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.285853 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.286312 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
alter table "petro"."main"."stg_petro__dbt_tmp" rename to "stg_petro"
[0m22:05:33.287015 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.307759 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:33.308263 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.308706 [debug] [Thread-1 (]: On model.petro.stg_petro: COMMIT
[0m22:05:33.310576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.315474 [debug] [Thread-1 (]: Using duckdb connection "model.petro.stg_petro"
[0m22:05:33.315940 [debug] [Thread-1 (]: On model.petro.stg_petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.stg_petro"} */
drop table if exists "petro"."main"."stg_petro__dbt_backup" cascade
[0m22:05:33.317186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.319469 [debug] [Thread-1 (]: On model.petro.stg_petro: Close
[0m22:05:33.349397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbea463f0>]}
[0m22:05:33.350127 [info ] [Thread-1 (]: 1 of 2 OK created python table model main.stg_petro ............................ [[32mOK[0m in 6.57s]
[0m22:05:33.351008 [debug] [Thread-1 (]: Finished running node model.petro.stg_petro
[0m22:05:33.351986 [debug] [Thread-1 (]: Began running node model.petro.petro
[0m22:05:33.352586 [info ] [Thread-1 (]: 2 of 2 START sql incremental model main.petro .................................. [RUN]
[0m22:05:33.353259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.petro.stg_petro, now model.petro.petro)
[0m22:05:33.353711 [debug] [Thread-1 (]: Began compiling node model.petro.petro
[0m22:05:33.358810 [debug] [Thread-1 (]: Writing injected SQL for node "model.petro.petro"
[0m22:05:33.359462 [debug] [Thread-1 (]: Began executing node model.petro.petro
[0m22:05:33.393042 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.393552 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

    
  
    
    

    create temporary table
      "petro__dbt_tmp20241116220533386863"
  
    as (
      with petro_data as (

        select 
            retailer,
            brand,
            address,
            postcode,
            location_latitude as latitude,
            location_longitude as longitude,
            "prices_B7" as b7,
            "prices_E10" as e10,
            "prices_E5" as e5,
            "prices_SDV" as sdv,
            last_updated,
            -- row_number() over(partition by retailer, brand, strftime(DATE last_updated, '%d/%m/%Y'), address, postcode order by last_updated desc) as row_num,
            md5(cast(coalesce(cast(retailer as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(brand as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(last_updated as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as surrogate_key
        from "petro"."main"."stg_petro"

        

)
select *
from petro_data
    );
  
  
  
[0m22:05:33.394021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:33.408441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.416137 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.416612 [debug] [Thread-1 (]: On model.petro.petro: BEGIN
[0m22:05:33.417213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.417659 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.418095 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro__dbt_tmp20241116220533386863'
      
      
      order by ordinal_position

  
[0m22:05:33.439062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.445241 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.445725 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.448491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.455942 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.456454 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'petro'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'petro'
      
      order by ordinal_position

  
[0m22:05:33.459175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.477066 [debug] [Thread-1 (]: Writing runtime sql for node "model.petro.petro"
[0m22:05:33.477848 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.478356 [debug] [Thread-1 (]: On model.petro.petro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "petro", "target_name": "prod", "node_id": "model.petro.petro"} */

        
            delete from "petro"."main"."petro"
            where (
                surrogate_key) in (
                select (surrogate_key)
                from "petro__dbt_tmp20241116220533386863"
            );

        
    

    insert into "petro"."main"."petro" ("retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key")
    (
        select "retailer", "brand", "address", "postcode", "latitude", "longitude", "b7", "e10", "e5", "sdv", "last_updated", "surrogate_key"
        from "petro__dbt_tmp20241116220533386863"
    )
  
[0m22:05:33.512386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.514380 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.514837 [debug] [Thread-1 (]: Using duckdb connection "model.petro.petro"
[0m22:05:33.515265 [debug] [Thread-1 (]: On model.petro.petro: COMMIT
[0m22:05:33.524023 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:05:33.524958 [debug] [Thread-1 (]: On model.petro.petro: Close
[0m22:05:33.654076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e344863-b0a9-46ba-979d-ddeb62f584ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7a4cbfe0>]}
[0m22:05:33.654878 [info ] [Thread-1 (]: 2 of 2 OK created sql incremental model main.petro ............................. [[32mOK[0m in 0.30s]
[0m22:05:33.655626 [debug] [Thread-1 (]: Finished running node model.petro.petro
[0m22:05:33.656971 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.657456 [debug] [MainThread]: On master: BEGIN
[0m22:05:33.657891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:33.664475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.664947 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.665382 [debug] [MainThread]: Using duckdb connection "master"
[0m22:05:33.665815 [debug] [MainThread]: On master: COMMIT
[0m22:05:33.666392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:05:33.666839 [debug] [MainThread]: On master: Close
[0m22:05:33.668171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:33.668617 [debug] [MainThread]: Connection 'list_petro_main' was properly closed.
[0m22:05:33.669018 [debug] [MainThread]: Connection 'model.petro.petro' was properly closed.
[0m22:05:33.669474 [info ] [MainThread]: 
[0m22:05:33.670019 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 7.56 seconds (7.56s).
[0m22:05:33.671186 [debug] [MainThread]: Command end result
[0m22:05:33.698586 [info ] [MainThread]: 
[0m22:05:33.699279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:33.699868 [info ] [MainThread]: 
[0m22:05:33.700506 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:05:33.701578 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.54778, "process_user_time": 5.33626, "process_kernel_time": 0.356284, "process_mem_max_rss": "293148", "process_in_blocks": "3808", "process_out_blocks": "112712"}
[0m22:05:33.702220 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:33.702111 after 9.55 seconds
[0m22:05:33.702710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbee01670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc11bbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadbd984a40>]}
[0m22:05:33.703195 [debug] [MainThread]: Flushing usage events
[0m22:05:35.368114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563ca1fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563d3688f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563d0f6d20>]}


============================== 22:05:35.370913 | 60e1d421-27dc-489e-9065-d163d7ffda7f ==============================
[0m22:05:35.370913 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:05:35.371603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/runner/work/fuel_uk/fuel_uk/petro_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:35.514236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60e1d421-27dc-489e-9065-d163d7ffda7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563c3c8ad0>]}
[0m22:05:35.530577 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21080424, "process_user_time": 1.408833, "process_kernel_time": 0.107757, "process_mem_max_rss": "92160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:35.531163 [debug] [MainThread]: Command `dbt clean` succeeded at 22:05:35.531061 after 0.21 seconds
[0m22:05:35.531600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563c653800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563cdb7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f563c2a5fd0>]}
[0m22:05:35.532040 [debug] [MainThread]: Flushing usage events
